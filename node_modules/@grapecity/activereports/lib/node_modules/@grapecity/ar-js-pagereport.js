/*!
 * @grapecity/activereports 4.2.1
 * Description: ActiveReportsJS
 * https://www.npmjs.com/package/@grapecity/activereports
 * Copyright ©️ Respective Holders. All rights reserved.
 * Licensed under the Commercial license
 */
import{__awaiter,__rest as __rest$1}from"tslib";import{isValid as isValid$1,parseISO as parseISO$1,parse as parse$8,format,formatISO,isAfter,getYear,getMonth,getDay,getQuarter,getDate,getHours,getMinutes,getSeconds,startOfDay,add,addQuarters,addMilliseconds,differenceInSeconds,differenceInMinutes,differenceInHours,differenceInCalendarWeeks,differenceInDays,differenceInMonths,differenceInQuarters,differenceInYears,getWeekYear,getWeek,startOfWeek,getDayOfYear,endOfYear,startOfYear}from"date-fns";import DataFormatter from"excel-style-dataformatter";import kanjidate from"kanjidate";import xRegExp from"xregexp";import{pipe,forEach as forEach$1,zipWith as zipWith$1,uniqWith as uniqWith$1,findLast as findLast$3,range as range$1,sum as sum$1,take as take$1,uniq,equals,flatten as flatten$3,clone}from"ramda";import{h,create}from"virtual-dom";import dv from"../gc-dv";import Barcode from"../barcodejs";import i18next from"i18next";import{JSONPath}from"jsonpath-plus";const selectAll={selectAll:"$selectAll"},noValue=void 0;var ParameterStatus;!function(ParameterStatus){ParameterStatus[ParameterStatus.ok=0]="ok",ParameterStatus[ParameterStatus.expectValue=1]="expectValue",ParameterStatus[ParameterStatus.hasOutstandingDependencies=2]="hasOutstandingDependencies",ParameterStatus[ParameterStatus.validationFailed=3]="validationFailed",ParameterStatus[ParameterStatus.dynamicValuesUnavailable=4]="dynamicValuesUnavailable",ParameterStatus[ParameterStatus.communicating=5]="communicating",ParameterStatus[ParameterStatus.isValidation=6]="isValidation"}(ParameterStatus||(ParameterStatus={}));var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function getDefaultExportFromCjs(x){return x&&x.__esModule&&Object.prototype.hasOwnProperty.call(x,"default")?x.default:x}var immutabilityHelper={exports:{}};!function(module,exports){function stringifiable(obj){return"object"!=typeof obj||"toString"in obj?obj:Object.prototype.toString.call(obj).slice(8,-1)}Object.defineProperty(exports,"__esModule",{value:!0});var isProduction="object"==typeof process&&!0;function invariant(condition,message){if(!condition){if(isProduction)throw new Error("Invariant failed");throw new Error(message())}}exports.invariant=invariant;var hasOwnProperty=Object.prototype.hasOwnProperty,splice=Array.prototype.splice,toString=Object.prototype.toString;function type(obj){return toString.call(obj).slice(8,-1)}var assign=Object.assign||function(target,source){return getAllKeys(source).forEach((function(key){hasOwnProperty.call(source,key)&&(target[key]=source[key])})),target},getAllKeys="function"==typeof Object.getOwnPropertySymbols?function(obj){return Object.keys(obj).concat(Object.getOwnPropertySymbols(obj))}:function(obj){return Object.keys(obj)};function copy(object){return Array.isArray(object)?assign(object.constructor(object.length),object):"Map"===type(object)?new Map(object):"Set"===type(object)?new Set(object):object&&"object"==typeof object?assign(Object.create(Object.getPrototypeOf(object)),object):object}var Context=function(){function Context(){this.commands=assign({},defaultCommands),this.update=this.update.bind(this),this.update.extend=this.extend=this.extend.bind(this),this.update.isEquals=function(x,y){return x===y},this.update.newContext=function(){return(new Context).update}}return Object.defineProperty(Context.prototype,"isEquals",{get:function(){return this.update.isEquals},set:function(value){this.update.isEquals=value},enumerable:!0,configurable:!0}),Context.prototype.extend=function(directive,fn){this.commands[directive]=fn},Context.prototype.update=function(object,$spec){var _this=this,spec="function"==typeof $spec?{$apply:$spec}:$spec;Array.isArray(object)&&Array.isArray(spec)||invariant(!Array.isArray(spec),(function(){return"update(): You provided an invalid spec to update(). The spec may not contain an array except as the value of $set, $push, $unshift, $splice or any custom command allowing an array value."})),invariant("object"==typeof spec&&null!==spec,(function(){return"update(): You provided an invalid spec to update(). The spec and every included key path must be plain objects containing one of the following commands: "+Object.keys(_this.commands).join(", ")+"."}));var nextObject=object;return getAllKeys(spec).forEach((function(key){if(hasOwnProperty.call(_this.commands,key)){var objectWasNextObject=object===nextObject;nextObject=_this.commands[key](spec[key],nextObject,spec,object),objectWasNextObject&&_this.isEquals(nextObject,object)&&(nextObject=object)}else{var nextValueForKey="Map"===type(object)?_this.update(object.get(key),spec[key]):_this.update(object[key],spec[key]),nextObjectValue="Map"===type(nextObject)?nextObject.get(key):nextObject[key];_this.isEquals(nextValueForKey,nextObjectValue)&&(void 0!==nextValueForKey||hasOwnProperty.call(object,key))||(nextObject===object&&(nextObject=copy(object)),"Map"===type(nextObject)?nextObject.set(key,nextValueForKey):nextObject[key]=nextValueForKey)}})),nextObject},Context}();exports.Context=Context;var defaultCommands={$push:function(value,nextObject,spec){return invariantPushAndUnshift(nextObject,spec,"$push"),value.length?nextObject.concat(value):nextObject},$unshift:function(value,nextObject,spec){return invariantPushAndUnshift(nextObject,spec,"$unshift"),value.length?value.concat(nextObject):nextObject},$splice:function(value,nextObject,spec,originalObject){return function(value,spec){invariant(Array.isArray(value),(function(){return"Expected $splice target to be an array; got "+stringifiable(value)})),invariantSplice(spec.$splice)}(nextObject,spec),value.forEach((function(args){invariantSplice(args),nextObject===originalObject&&args.length&&(nextObject=copy(originalObject)),splice.apply(nextObject,args)})),nextObject},$set:function(value,_nextObject,spec){return function(spec){invariant(1===Object.keys(spec).length,(function(){return"Cannot have more than one key in an object with $set"}))}(spec),value},$toggle:function(targets,nextObject){invariantSpecArray(targets,"$toggle");var nextObjectCopy=targets.length?copy(nextObject):nextObject;return targets.forEach((function(target){nextObjectCopy[target]=!nextObject[target]})),nextObjectCopy},$unset:function(value,nextObject,_spec,originalObject){return invariantSpecArray(value,"$unset"),value.forEach((function(key){Object.hasOwnProperty.call(nextObject,key)&&(nextObject===originalObject&&(nextObject=copy(originalObject)),delete nextObject[key])})),nextObject},$add:function(values,nextObject,_spec,originalObject){return invariantMapOrSet(nextObject,"$add"),invariantSpecArray(values,"$add"),"Map"===type(nextObject)?values.forEach((function(_a){var key=_a[0],value=_a[1];nextObject===originalObject&&nextObject.get(key)!==value&&(nextObject=copy(originalObject)),nextObject.set(key,value)})):values.forEach((function(value){nextObject!==originalObject||nextObject.has(value)||(nextObject=copy(originalObject)),nextObject.add(value)})),nextObject},$remove:function(value,nextObject,_spec,originalObject){return invariantMapOrSet(nextObject,"$remove"),invariantSpecArray(value,"$remove"),value.forEach((function(key){nextObject===originalObject&&nextObject.has(key)&&(nextObject=copy(originalObject)),nextObject.delete(key)})),nextObject},$merge:function(value,nextObject,_spec,originalObject){var target,specValue;return target=nextObject,invariant((specValue=value)&&"object"==typeof specValue,(function(){return"update(): $merge expects a spec of type 'object'; got "+stringifiable(specValue)})),invariant(target&&"object"==typeof target,(function(){return"update(): $merge expects a target of type 'object'; got "+stringifiable(target)})),getAllKeys(value).forEach((function(key){value[key]!==nextObject[key]&&(nextObject===originalObject&&(nextObject=copy(originalObject)),nextObject[key]=value[key])})),nextObject},$apply:function(value,original){var fn;return invariant("function"==typeof(fn=value),(function(){return"update(): expected spec of $apply to be a function; got "+stringifiable(fn)+"."})),value(original)}},defaultContext=new Context;function invariantPushAndUnshift(value,spec,command){invariant(Array.isArray(value),(function(){return"update(): expected target of "+stringifiable(command)+" to be an array; got "+stringifiable(value)+"."})),invariantSpecArray(spec[command],command)}function invariantSpecArray(spec,command){invariant(Array.isArray(spec),(function(){return"update(): expected spec of "+stringifiable(command)+" to be an array; got "+stringifiable(spec)+". Did you forget to wrap your parameter in an array?"}))}function invariantSplice(value){invariant(Array.isArray(value),(function(){return"update(): expected spec of $splice to be an array of arrays; got "+stringifiable(value)+". Did you forget to wrap your parameters in an array?"}))}function invariantMapOrSet(target,command){var typeOfTarget=type(target);invariant("Map"===typeOfTarget||"Set"===typeOfTarget,(function(){return"update(): "+stringifiable(command)+" expects a target of type Set or Map; got "+stringifiable(typeOfTarget)}))}exports.isEquals=defaultContext.update.isEquals,exports.extend=defaultContext.extend,exports.default=defaultContext.update,exports.default.default=module.exports=assign(exports.default,exports)}(immutabilityHelper,immutabilityHelper.exports);var update=getDefaultExportFromCjs(immutabilityHelper.exports);const parseISO=parseISO$1;function isDate$2(v){return v instanceof Date}function isValid(v){return isValid$1(v)}const safeParseFloat=value=>{const parsed=parseFloat(value);return isNaN(value-parsed)?Number.NaN:parsed},safeParseInteger=value=>/^[-+]?\d+$/gi.test(value)?parseInt(value,10):Number.NaN;const isEqual=(v1,v2)=>isDate$2(v1)&&isDate$2(v2)?v1.valueOf()===v2.valueOf():v1===v2,variantToString=value=>isDate$2(value)?value.toISOString():`${value}`;function getParameterValue(values,isNullable){return values.length?values[0]:isNullable?null:undefined}function markAsValid(param,value){const updateObject={state:{$set:ParameterStatus.ok},error:{$set:null}};return null!=value&&(updateObject.values={$set:value}),update(param,updateObject)}function markAsInvalid(param,error){return update(param,{state:{$set:ParameterStatus.validationFailed},error:{$set:error}})}function markAsMissingValue(param,error){return update(param,{state:{$set:ParameterStatus.expectValue},error:{$set:error}})}const DATE_TIME_FORMATS={Date:{accepted:["yyyy-MM-dd","yyyyMMdd","M/d/yyyy","d.M.yyyy","yyyy-MM-dd'T'HH:mm:ss","yyyy-MM-dd'T'HH:mm:ssXX","yyyy-MM-dd'T'HH:mm:ssXXX","yyyy-MM-dd'T'HH:mm:ss.SSSXXX","yyyy-MM-dd'T'HH:mm:ss.SSSXX"],valid:"yyyy-MM-dd"},DateTime:{accepted:["yyyy-MM-dd'T'HH:mm:ss","yyyy-MM-dd'T'HH:mm:ssXX","yyyy-MM-dd'T'HH:mm:ssXXX","yyyy-MM-dd'T'HH:mm:ss.SSSXX","yyyy-MM-dd'T'HH:mm:ss.SSSXXX","yyyy-MM-dd'T'HH:mm:ss.SSSSSSS"],valid:"yyyy-MM-dd'T'HH:mm:ss"}};function validateByType(param,value){const{descriptor:{dataType:dataType,allowBlank:allowBlank}}=param;switch(dataType){case"Boolean":return"true"===value.toLowerCase()?markAsValid(param,[!0]):"false"===value.toLowerCase()?markAsValid(param,[!1]):markAsInvalid(param,"invalidBoolean");case"String":return""===value?allowBlank?markAsValid(param,[""]):markAsInvalid(param,"stringEmpty"):markAsValid(param,[value]);case"Integer":{const parsedInteger=safeParseInteger(value);return isNaN(parsedInteger)?markAsInvalid(param,"invalidInteger"):(int=parsedInteger,Math.abs(int)<=9007199254740991?markAsValid(param,[parsedInteger]):markAsInvalid(param,"integerTooBig"))}case"Float":{const parsedFloat=safeParseFloat(value);return isNaN(parsedFloat)?markAsInvalid(param,"invalidFloat"):markAsValid(param,[parsedFloat])}case"Date":case"DateTime":{const parsed=function(value,formats){try{if(!formats||Array.isArray(formats)&&0===formats.length)return parseISO$1(value);for(const form of formats){const parsed=parse$8(value,form,new Date);if(isValid$1(parsed))return parsed}}catch(error){return console.warn(error),new Date(NaN)}return new Date(NaN)}(value,DATE_TIME_FORMATS[dataType].accepted);return isValid(parsed)?markAsValid(param,[parsed]):markAsInvalid(param,"invalidDateTime")}default:return markAsInvalid(param,"unknown")}var int}function validateMultiValueParameter(param){function checkValue(value){if(null===value)return param.descriptor.nullable?{value:value}:{status:ParameterStatus.expectValue,error:"requiredValue"};if(null!=param.descriptor.selectAllValue&&value===param.descriptor.selectAllValue||value===selectAll){if(param.descriptor.hasValidValues){const invalidValue=param.validValues.map((v=>validateByType(param,variantToString(v.value)))).find((v=>null!=v.error));if(invalidValue&&invalidValue.error){const{state:state,error:error}=invalidValue;return{status:state,error:error}}}return{value:value}}if(undefined===value)return param.descriptor.allowBlank?{value:value}:{status:ParameterStatus.expectValue,error:"requiredValue"};const validated=validateByType(param,variantToString(value));if(validated.error){const{state:state,error:error}=validated;return{status:state,error:error}}const validatedValue=validated.values[0];if(param.descriptor.hasValidValues){return param.validValues.some((valid=>isEqual(valid.value,validatedValue)))?{value:validatedValue}:{status:ParameterStatus.validationFailed,error:"valueOutOfRange"}}return{value:validatedValue}}let values=param.values;values.length?param.descriptor.hasValidValues&&(values=values.map((value=>function(value,descriptor){if(null==value||""===value||value===selectAll||value===descriptor.selectAllValue)return value;switch(descriptor.dataType){case"Float":if("number"==typeof value)return value;if("string"==typeof value){const parsed=safeParseFloat(value);if(!isNaN(parsed))return parsed}break;case"Integer":if("number"==typeof value)return value;if("string"==typeof value){const parsed=safeParseInteger(value);if(!isNaN(parsed))return parsed}break;case"Boolean":if("boolean"==typeof value)return value;if("string"==typeof value){const lower=value.toLowerCase();if("true"===lower||"false"===lower)return"true"===lower}break;case"Date":case"DateTime":if(isDate$2(value))return value;if("string"==typeof value){const parsed=parseISO(value);if(isValid(parsed))return parsed}break;case"String":return isDate$2(value)?value.toISOString():`${value}`}return value}(value,param.descriptor)))):values=param.descriptor.nullable?[null]:[undefined];const result=[];for(let i=0;i<values.length;i++){const validated=checkValue(values[i]);if(validated.error)return validated.status===ParameterStatus.expectValue?values.length>1?markAsInvalid(param,validated.error):markAsMissingValue(param,validated.error):markAsInvalid(param,validated.error);result.push(validated.value)}const validValues=param.validValues.map((({value:value})=>value)),finalResult=validValues.length&&validValues.every((value=>result.some((v=>isEqual(v,value)))))?[param.descriptor.selectAllValue]:result;return markAsValid(param,finalResult)}const exponent=/^[0-9]+(?:\.[0-9]+)?e$/i,makePos=(line,column,character)=>({line:line,column:column,character:character});function tokenize$1(expression){const isExponent=s=>s&&exponent.test(s),tokens=[];let previous="",isStringConst=!1,isDateConst=!1,currentLine=0,currentColumn=-1,startLine=0,startColumn=0,startIndex=0;const resetIndex=i=>{previous||(startLine=currentLine,startColumn=currentColumn,startIndex=i)};for(let i=0;i<expression.length;i++){const current=expression[i];if(currentColumn+=1,'"'!==current)if(isStringConst)resetIndex(i),previous+=current,previous&&!isStringConst&&(tokens.push({token:previous,position:makePos(startLine,startColumn,startIndex),expression:expression}),previous=""),"\n"===current&&currentLine++,"\n"!==current&&"\r"!==current||(currentColumn=-1);else if("#"!==current||0!==previous.length&&"\\"===previous[previous.length-1]||(isDateConst=!isDateConst),isDateConst||"#"===current)previous+=current;else if(" "!==current&&"\t"!==current&&"\n"!==current&&"\r"!==current)if((s=current)&&"+-/*=<>&,()\\^".indexOf(s)>-1){if(("+"===current||"-"===current)&&isExponent(previous)){previous+=current;continue}if(""!==previous&&tokens.push({token:previous,position:makePos(startLine,startColumn,startIndex),expression:expression}),previous="","="!==current&&"<"!==current&&">"!==current||!(tokens.length>0)||"<"!==tokens[tokens.length-1].token&&">"!==tokens[tokens.length-1].token)if("("===current&&tokens.length>0){const lastToken=tokens[tokens.length-1],splitLocation=Math.max(lastToken.token.lastIndexOf("."),lastToken.token.lastIndexOf("!"));if(splitLocation>0){const lastTokenValue=lastToken.token;tokens[tokens.length-1].token=lastTokenValue.substr(0,splitLocation),tokens.push({token:lastTokenValue.substr(splitLocation),position:makePos(startLine,startColumn+splitLocation,startIndex+splitLocation),expression:expression})}tokens.push({token:current,position:makePos(currentLine,currentColumn,i),expression:expression})}else tokens.push({token:current,position:makePos(currentLine,currentColumn,i),expression:expression});else tokens[tokens.length-1].token+=current}else resetIndex(i),previous+=current;else""!==previous&&tokens.push({token:previous,position:makePos(startLine,startColumn,startIndex),expression:expression}),previous="","\n"===current&&currentLine++,"\n"!==current&&"\r"!==current||(currentColumn=-1),startLine=currentLine,startColumn=0;else if(isStringConst){const next=expression[i+1];next===current?(i+=1,currentColumn+=1,previous+=current+next):(isStringConst=!1,previous+=current,previous&&(tokens.push({token:previous,position:makePos(startLine,startColumn,startIndex),expression:expression}),previous=""),resetIndex(i))}else isStringConst=!0,previous&&(tokens.push({token:previous,position:makePos(startLine,startColumn,startIndex),expression:expression}),previous=""),resetIndex(i),previous+=current}var s;return""!==previous&&tokens.push({token:previous,position:makePos(startLine,startColumn,startIndex),expression:expression}),tokens}const patterns=["dddd","ddd","dd","d","fffffff","ffffff","fffff","ffff","fff","ff","f","FFFFFFF","FFFFFF","FFFFF","FFFF","FFF","FF","F","gg","g","hh","h","HH","H","K","mm","m","MMMM","MMM","MM","M","ss","s","tt","t","yyyyy","yyyy","yyy","yy","y","zzz","zz","z","YYYYY","YYYY","YYY","YY","Y","G"];function formatDateTimeWithPattern(value,pattern,locale,isUTC){function fn(val,digits,forceSign=!1){if("string"==typeof val)return val;const num=Math.abs(val).toString();return(val<0?"-":forceSign?"+":"")+(num.length<digits?"0".repeat(digits-num.length)+num:num)}const splittedPattern=parseDateTimeFormat(pattern,patterns),needDeclension=splittedPattern.indexOf("d")>-1||splittedPattern.indexOf("dd")>-1,date=value,year=isUTC?date.getUTCFullYear():date.getFullYear(),month=isUTC?date.getUTCMonth():date.getMonth(),day=isUTC?date.getUTCDate():date.getDate(),weekDay=isUTC?date.getUTCDay():date.getDay(),hours=isUTC?date.getUTCHours():date.getHours(),minutes=isUTC?date.getUTCMinutes():date.getMinutes(),seconds=isUTC?date.getUTCSeconds():date.getSeconds(),milliseconds=isUTC?date.getUTCMilliseconds():date.getMilliseconds(),timeZoneOffset=date.getTimezoneOffset(),timeZoneOffsetHours=Math.round(timeZoneOffset/60),timeZoneOffsetMinutes=Math.abs(timeZoneOffset)%60;return splittedPattern.map(((part,index)=>{const previousPart=splittedPattern[index-1];switch(part){case"d":return fn(day,1);case"dd":return fn(day,2);case"ddd":return locale.daysShort[weekDay];case"dddd":return locale.days[weekDay];case"f":return fn(Math.round(milliseconds/100),1);case"ff":return fn(Math.round(milliseconds/10),2);case"fff":return fn(milliseconds,3);case"ffff":return fn(milliseconds,4);case"fffff":return fn(milliseconds,5);case"ffffff":return fn(milliseconds,6);case"fffffff":return fn(milliseconds,7);case"F":return fn(Math.round(milliseconds/100)||"",0);case"FF":return fn(Math.round(milliseconds/10)||"",0);case"FFF":case"FFFF":case"FFFFF":case"FFFFFF":case"FFFFFFF":return fn(Math.round(milliseconds)||"",0);case"h":return fn(hours%12||12,1);case"hh":return fn(hours%12||12,2);case"H":return fn(hours,1);case"HH":return fn(hours,2);case"K":return timeZoneOffset?fn(timeZoneOffsetHours,2,!0)+":"+fn(timeZoneOffsetMinutes,2):"Z";case"m":return fn(minutes,1);case"mm":return fn(minutes,2);case"M":return fn(month+1,1);case"MM":return fn(month+1,2);case"MMM":return locale.monthsShort[month];case"MMMM":return needDeclension&&locale.monthsDeclined?locale.monthsDeclined[month]:locale.months[month];case"s":return fn(seconds,1);case"ss":return fn(seconds,2);case"t":return hours<12?locale.amPmShort[0]:locale.amPmShort[1];case"tt":return hours<12?locale.amPm[0]:locale.amPm[1];case"Y":case"YY":case"YYY":case"YYYY":case"YYYYY":case"y":case"yy":case"yyy":case"yyyy":case"yyyyy":return locale.getCustomYear?locale.getCustomYear(date,part,fn,previousPart):fn(part.length<=2?year%100:year,part.length);case"z":return fn(-timeZoneOffsetHours,1,!0);case"zz":return fn(-timeZoneOffsetHours,2,!0);case"zzz":return fn(-timeZoneOffsetHours,2,!0)+":"+fn(timeZoneOffsetMinutes,2);case"g":case"gg":return locale.getCustomEra?locale.getCustomEra(date,!1).substr(0,part.length):locale.era;case"G":return locale.getCustomEra?locale.getCustomEra(date,!0):"G";default:return part.replace(/\\(.)/g,"$1").replace(/"/g,"")}})).join("")}let patternCache=new Map;function parseDateTimeFormat(pattern,patterns){const cachedResult=patternCache.get(pattern);if(cachedResult)return cachedResult;const currentPattern=(pattern&&"%"===pattern[0]?pattern.replace("%",""):pattern)||"",endsWithPattern=val=>{for(let i=0;i<patterns.length;i++)if(val.endsWith(patterns[i])){if(!(val.length>patterns[i].length&&"\\"===val[val.length-1-patterns[i].length]))return patterns[i];{const shortenedPattern=patterns.find((p=>p===patterns[i].substr(1,patterns[i].length-1)));if(shortenedPattern)return shortenedPattern}}return""},splitPatterns=patternPart=>{const p=[];let pat=endsWithPattern(patternPart);for(;pat;)patternPart=patternPart.substr(0,patternPart.length-pat.length),p.push(pat),pat=endsWithPattern(patternPart);return patternPart&&p.push(patternPart),p.reverse(),p},parts=[];let last,previous="",isString=!1;for(let i=0;i<currentPattern.length;i++){if('"'===currentPattern[i]){isString=!isString,isString||(previous+='"'),last=endsWithPattern(previous),last?parts.push(...splitPatterns(previous)):(parts.push(previous),previous=""),isString&&(previous='"');continue}if(isString){previous+=currentPattern[i];continue}const prevPat=endsWithPattern(previous),curPat=endsWithPattern(previous+currentPattern[i]);prevPat&&!curPat&&(parts.push(...splitPatterns(previous)),previous=""),previous+=currentPattern[i]}var key,value;return isString&&previous&&!previous.endsWith('"')&&(previous+='"'),last=endsWithPattern(previous),last?parts.push(...splitPatterns(previous)):previous&&parts.push(previous),key=pattern,value=parts,patternCache.set(key,value),patternCache.size>1e4&&(patternCache=new Map(function(map){const pairs=[];for(let kvp of map)pairs.push([kvp[0],kvp[1]]);return pairs}(patternCache).slice(patternCache.size-1e3))),parts}class DateTime{constructor(m){this.dt=m}format(format$1){return format$1?format(this.dt,convertToDateFnsFormat(format$1)):formatISO(this.dt)}toDate(){return this.dt}clone(){return new DateTime(new Date(this.dt))}valueOf(){return this.dt.valueOf()}toISOString(){return isValid$1(this.dt)?this.dt.toISOString():""}isAfter(inp){return isAfter(this.dt,inp.dt)}year(){return getYear(this.dt)}month(){return getMonth(this.dt)}day(){return getDay(this.dt)}quarter(){return getQuarter(this.dt)}date(){return getDate(this.dt)}hour(){return getHours(this.dt)}minute(){return getMinutes(this.dt)}second(){return getSeconds(this.dt)}startOfDay(){return new DateTime(startOfDay(this.dt))}add(amount,unit){switch(unit){case"milliseconds":return new DateTime(addMilliseconds(this.dt,amount));case"seconds":return new DateTime(add(this.dt,{seconds:amount}));case"minutes":return new DateTime(add(this.dt,{minutes:amount}));case"hours":return new DateTime(add(this.dt,{hours:amount}));case"days":return new DateTime(add(this.dt,{days:amount}));case"weeks":return new DateTime(add(this.dt,{weeks:amount}));case"months":return new DateTime(add(this.dt,{months:amount}));case"quarters":return new DateTime(addQuarters(this.dt,amount));case"years":return new DateTime(add(this.dt,{years:amount}));default:throw new Error(`add ${unit} is not implemented`)}}getTime(){const date=new Date(this.dt);return date.setFullYear(1,0,1),new DateTime(date)}dateDiff(interval,date,firstDayOfWeek){const earlyDate=date.dt;switch(interval){case"yyyy":return differenceInYears(this.dt,earlyDate);case"q":return differenceInQuarters(this.dt,earlyDate);case"m":return differenceInMonths(this.dt,earlyDate);case"y":case"d":case"w":return differenceInDays(this.dt,earlyDate);case"ww":return isAfter(earlyDate,this.dt)?-1:differenceInCalendarWeeks(this.dt,earlyDate,{weekStartsOn:this.getStartOfWeek(firstDayOfWeek)});case"h":return differenceInHours(this.dt,earlyDate);case"n":return differenceInMinutes(this.dt,earlyDate);case"s":return differenceInSeconds(this.dt,earlyDate);default:throw new Error(`"${interval}" is not valid interval value for DateDiff() function`)}}datePart(interval,firstDayOfWeek,firstWeekOfYear){switch(interval){case"yyyy":return getYear(this.dt);case"q":return getQuarter(this.dt);case"m":return getMonth(this.dt)+1;case"y":return getDayOfYear(this.dt);case"d":return getDate(this.dt);case"w":return differenceInDays(this.dt,startOfWeek(this.dt,{weekStartsOn:this.getStartOfWeek(firstDayOfWeek)}))+1;case"ww":const sow=this.getStartOfWeek(firstDayOfWeek);let firstWeekContainsDate=1;2===firstWeekOfYear?firstWeekContainsDate=4:3===firstWeekOfYear&&(firstWeekContainsDate=7);return getWeekYear(this.dt,{weekStartsOn:sow,firstWeekContainsDate:firstWeekContainsDate})>getYear(this.dt)?this.getWeeksInYear(sow)+1:getWeek(this.dt,{weekStartsOn:sow,firstWeekContainsDate:firstWeekContainsDate});case"h":return getHours(this.dt);case"n":return getMinutes(this.dt);case"s":return getSeconds(this.dt);default:throw new Error(`"${interval}" is not valid interval value for DatePart() function`)}}getWeeksInYear(weekStartsOn){return differenceInCalendarWeeks(endOfYear(this.dt),startOfYear(this.dt),{weekStartsOn:weekStartsOn})}getStartOfWeek(firstDayOfWeek){const sow=firstDayOfWeek?firstDayOfWeek-1:0;if([0,1,2,3,4,5,6].includes(sow))return sow;throw new Error("firstDayOfWeek must be integer [1..7]")}}const dateTimeFactory_create=()=>new DateTime(new Date),dateTimeFactory_createFromString=(str,formats,isStrict)=>{const value=function(date,formats){try{if(!formats||Array.isArray(formats)&&0===formats.length)return parseISO$1(date);for(const form of formats){const parsed=isISO_8601format(form)?parseISO$1(date):parse$8(date,convertToDateFnsFormat(form),new Date);if(isValid$1(parsed))return parsed}}catch(error){return console.warn(error),null}return null}(str,formats);return null!=value?new DateTime(value):null},dateTimeFactory_createFromArray=args=>{if(!function(args){return(!args[1]||!(args[1]<1||args[1]>12))&&((!args[2]||!(args[2]<1||args[2]>31))&&((!args[3]||!(args[3]<0||args[3]>24))&&((!args[4]||!(args[4]<0||args[4]>59))&&(!args[5]||!(args[5]<0||args[5]>59)))))}(args))return null;const date=new Date(args[0],args[1],args[2],args[3],args[4],args[5]);return date.setFullYear(args[0]),new DateTime(date)},dateTimeFactory_createFromJsDate=date=>isValid$1(date)?new DateTime(date):null,dateTimeFactory_isDateTime=m=>m&&m.dt&&m.dt instanceof Date;function isISO_8601format(format){return"object"==typeof format&&format.ISO_8601}const parseDictionary={dd:"dd",d:"d",DD:"dd",D:"d",fffffff:"SSSSSSS",ffffff:"SSSSSS",fffff:"SSSSS",ffff:"SSSS",fff:"SSS",ff:"SS",f:"S",hh:"hh",h:"h",HH:"HH",H:"H",mm:"mm",m:"m",ss:"ss",s:"s",tt:"aa",t:"a",a:"a",A:"aa",MM:"MM",M:"M",yyyy:"yyyy",yy:"yy",YYYY:"yyyy",YY:"yy",zzz:"XXX",zz:"X",z:"X",Z:"XXX",X:"t",x:"T"};function convertToDateFnsFormat(format){return parseDateTimeFormat(format,Object.keys(parseDictionary)).map((t=>{var _a;return null!==(_a=parseDictionary[t])&&void 0!==_a?_a:`'${t}'`})).join("")}const dateTimeFormatMapping={d:"Short date",D:"Long date",f:"Full date/short time",F:"Full date/long time",g:"General date/short time",G:"General date/long time",M:"Month/day",m:"Month/day",O:"Round-trip date/time",o:"Round-trip date/time",R:"RFC1123",r:"RFC1123",s:"Sortable date/time",t:"Short time",T:"Long time",u:"Universal sortable date/time",U:"Universal full date/time",Y:"Year/month",y:"Year/month"},localeIndependentFormats={"Round-trip date/time":'yyyy"-"MM"-"dd"T"HH":"mm":"ss.fffffffK',RFC1123:'ddd, dd MMM yyyy HH":"mm":"ss "GMT"',"Sortable date/time":'yyyy"-"MM"-"dd"T"HH":"mm":"ss',"Universal sortable date/time":'yyyy"-"MM"-"dd HH":"mm":"ss"Z"'},complexFormats={"Full date/short time":["Long date","Short time"],"Full date/long time":["Long date","Long time"],"General date/short time":["Short date","Short time"],"General date/long time":["Short date","Long time"],"Universal full date/time":["Long date","Long time"]},dateTimeFormatKeys=Object.keys(dateTimeFormatMapping);function formatDateTime(value,pattern,locale){const patternKey=1===(pattern=pattern||"G").length?dateTimeFormatMapping[pattern]:void 0;let customPattern;if(patternKey){if(!function(patternKey){return Object.keys(localeIndependentFormats).includes(patternKey)}(patternKey))return function(patternKey){return Object.keys(complexFormats).includes(patternKey)}(patternKey)?complexFormats[patternKey].map((f=>locale.Format(value,f))).join(" "):locale.Format(value,patternKey);customPattern=localeIndependentFormats[patternKey]}else customPattern=pattern;return formatDateTimeWithPattern(value,customPattern,locale.FormatInfo,"U"===pattern)}const formatters={};function buildDateFormatterLocale(name,nfi){const{thousandSeparator:thousandSeparator,decimalSeparator:decimalSeparator}=nfi;return{name:name,thousandSeparator:thousandSeparator,decimalSeparator:decimalSeparator,formats:{}}}function formatNumberWithPattern(value,pattern,locale){var _a;const key=`${locale.decimalSeparator}<|>${locale.thousandSeparator}`,numberFormatter=null!==(_a=formatters[key])&&void 0!==_a?_a:formatters[key]=new DataFormatter({locale:key,locales:[buildDateFormatterLocale(key,locale)]});pattern=pattern.replace(/ /g,"\\ ").replace(/\.([^0\#])/g,"$1").replace(/['"]/g,"");const result=numberFormatter.format(value,"Number",pattern).value;return null!=result?result:""}function specifyPrecision(pattern,digits,forced=!0){return pattern.replace(/\.[0#]*/g,(digits?".":"")+(forced?"0":"#").repeat(digits))}const numberFormatMapping={p:"Percent",c:"Currency"},standardFormatRegex=/^[cdefgnprx][0-9]*$/i;function formatNumber(value,pattern,locale){if(isNaN(value))return value.toString();let fullPattern=pattern||"g";if(standardFormatRegex.test(fullPattern)){const formatSpecifier=fullPattern[0].toLowerCase(),precisionSpecifier=fullPattern.substr(1)?parseInt(fullPattern.substr(1),10)||0:void 0;switch(formatSpecifier){case"x":let hexValue=Math.round(value).toString(16).toLowerCase();return precisionSpecifier&&hexValue.length<precisionSpecifier&&(hexValue="0".repeat(precisionSpecifier-hexValue.length)+hexValue),"X"===fullPattern[0]&&(hexValue=hexValue.toUpperCase()),hexValue;case"r":return value.toString();case"g":fullPattern=function(value,precisionSpecifier){if(!value)return"0";const precision=precisionSpecifier||15,exponent=parseFloat(value.toExponential().toLowerCase().split("e")[1]);if(exponent>-5&&exponent<precision){const decimals=precision-exponent-1;return"0"+(!Number.isInteger(value)&&decimals>0&&!/\.0+$/.test(value.toFixed(decimals))?"."+"#".repeat(decimals):"")}return"0"+(precision>1?".0":"")+(precision>2?"#".repeat(precision-2):"")+"E+######00"}(value,null!=precisionSpecifier?precisionSpecifier:0);break;case"d":fullPattern="0".repeat(Math.max(null!=precisionSpecifier?precisionSpecifier:0,1));break;case"f":fullPattern="0.00";break;case"n":fullPattern="#,##0.##";break;case"e":fullPattern="0.000000E+000";break;default:return locale.Format(value,numberFormatMapping[formatSpecifier],precisionSpecifier)}["f","n","e"].includes(formatSpecifier)&&null!=precisionSpecifier&&(fullPattern=specifyPrecision(fullPattern,precisionSpecifier))}return formatNumberWithPattern(value,fullPattern,locale.FormatInfo)}const locales={};function addLocale(locale,...aliases){locales[locale.name]=locale,aliases.forEach((alias=>{if(alias){const newLocale=Object.assign({},locale);newLocale.name=alias.toLowerCase(),locales[newLocale.name]=newLocale}}))}addLocale({name:"be-by",months:["\u0441\u0442\u0443\u0434\u0437\u0435\u043d\u044c","\u043b\u044e\u0442\u044b","\u0441\u0430\u043a\u0430\u0432\u0456\u043a","\u043a\u0440\u0430\u0441\u0430\u0432\u0456\u043a","\u043c\u0430\u0439","\u0447\u044d\u0440\u0432\u0435\u043d\u044c","\u043b\u0456\u043f\u0435\u043d\u044c","\u0436\u043d\u0456\u0432\u0435\u043d\u044c","\u0432\u0435\u0440\u0430\u0441\u0435\u043d\u044c","\u043a\u0430\u0441\u0442\u0440\u044b\u0447\u043d\u0456\u043a","\u043b\u0456\u0441\u0442\u0430\u043f\u0430\u0434","\u0441\u043d\u0435\u0436\u0430\u043d\u044c",""],monthsDeclined:["\u0441\u0442\u0443\u0434\u0437\u0435\u043d\u044f","\u043b\u044e\u0442\u0430\u0433\u0430","\u0441\u0430\u043a\u0430\u0432\u0456\u043a\u0430","\u043a\u0440\u0430\u0441\u0430\u0432\u0456\u043a\u0430","\u043c\u0430\u044f","\u0447\u044d\u0440\u0432\u0435\u043d\u044f","\u043b\u0456\u043f\u0435\u043d\u044f","\u0436\u043d\u0456\u045e\u043d\u044f","\u0432\u0435\u0440\u0430\u0441\u043d\u044f","\u043a\u0430\u0441\u0442\u0440\u044b\u0447\u043d\u0456\u043a\u0430","\u043b\u0456\u0441\u0442\u0430\u043f\u0430\u0434\u0430","\u0441\u043d\u0435\u0436\u043d\u044f",""],monthsShort:["\u0441\u0442\u0443\u0434\u0437","\u043b\u044e\u0442","\u0441\u0430\u043a","\u043a\u0440\u0430\u0441","\u043c\u0430\u0439","\u0447\u044d\u0440\u0432","\u043b\u0456\u043f","\u0436\u043d","\u0432\u0435\u0440","\u043a\u0430\u0441\u0442\u0440","\u043b\u0456\u0441\u0442","\u0441\u043d\u0435\u0436",""],days:["\u043d\u044f\u0434\u0437\u0435\u043b\u044f","\u043f\u0430\u043d\u044f\u0434\u0437\u0435\u043b\u0430\u043a","\u0430\u045e\u0442\u043e\u0440\u0430\u043a","\u0441\u0435\u0440\u0430\u0434\u0430","\u0447\u0430\u0446\u0432\u0435\u0440","\u043f\u044f\u0442\u043d\u0456\u0446\u0430","\u0441\u0443\u0431\u043e\u0442\u0430"],daysShort:["\u043d\u0434","\u043f\u043d","\u0430\u045e\u0442","\u0441\u0440","\u0447\u0446","\u043f\u0442","\u0441\u0431"],quarters:["1","2","3","4"],amPm:["",""],amPmShort:["",""],era:"\u043d.\u044d.",thousandSeparator:"\xa0",decimalSeparator:",",formats:{Percent:"###,###,##0.00 %;-###,###,##0.00 %",Currency:"###,###,##0.00 Br;-###,###,##0.00 Br","Short date":"dd.MM.yy","Long date":"d MMMM yyyy","Month/day":"d MMMM","Short time":"HH:mm","Long time":"HH:mm:ss","Year/month":"MMMM yyyy \u0433."}},"be"),addLocale({name:"de-de",months:["Januar","Februar","M\xe4rz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember",""],monthsDeclined:["Januar","Februar","M\xe4rz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember",""],monthsShort:["Jan","Feb","Mrz","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez",""],days:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],daysShort:["So","Mo","Di","Mi","Do","Fr","Sa"],quarters:["1","2","3","4"],amPm:["",""],amPmShort:["",""],era:"n. Chr.",thousandSeparator:".",decimalSeparator:",",formats:{Percent:"###,###,##0.00%;-###,###,##0.00%",Currency:"###,###,##0.00 \u20ac;-###,###,##0.00 \u20ac","Short date":"dd.MM.yyyy","Long date":"dddd, d. MMMM yyyy","Month/day":"dd MMMM","Short time":"HH:mm","Long time":"HH:mm:ss","Year/month":"MMMM yyyy"}},"de"),addLocale({name:"en-ca",months:["January","February","March","April","May","June","July","August","September","October","November","December",""],monthsDeclined:["January","February","March","April","May","June","July","August","September","October","November","December",""],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],quarters:["Q1","Q2","Q3","Q4"],amPm:["AM","PM"],amPmShort:["A","P"],era:"A.D.",thousandSeparator:",",decimalSeparator:".",formats:{Percent:"###,###,##0.00 %;-###,###,##0.00 %",Currency:"$###,###,##0.00;-$###,###,##0.00","Short date":"dd/MM/yyyy","Long date":"MMMM-dd-yy","Month/day":"MMMM dd","Short time":"h:mm tt","Long time":"h:mm:ss tt","Year/month":"MMMM, yyyy"}}),addLocale({name:"en-gb",months:["January","February","March","April","May","June","July","August","September","October","November","December",""],monthsDeclined:["January","February","March","April","May","June","July","August","September","October","November","December",""],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],quarters:["Q1","Q2","Q3","Q4"],amPm:["AM","PM"],amPmShort:["A","P"],era:"A.D.",thousandSeparator:",",decimalSeparator:".",formats:{Percent:"###,###,##0.00 %;-###,###,##0.00 %",Currency:"\xa3###,###,##0.00;-\xa3###,###,##0.00","Short date":"dd/MM/yyyy","Long date":"dd MMMM yyyy","Month/day":"dd MMMM","Short time":"HH:mm","Long time":"HH:mm:ss","Year/month":"MMMM yyyy"}}),addLocale({name:"en-us",months:["January","February","March","April","May","June","July","August","September","October","November","December",""],monthsDeclined:["January","February","March","April","May","June","July","August","September","October","November","December",""],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],quarters:["Q1","Q2","Q3","Q4"],amPm:["AM","PM"],amPmShort:["A","P"],era:"A.D.",thousandSeparator:",",decimalSeparator:".",formats:{Percent:"###,###,##0.00 %;-###,###,##0.00 %",Currency:"$###,###,##0.00;($###,###,##0.00)","Short date":"M/d/yyyy","Long date":"dddd, MMMM dd, yyyy","Month/day":"MMMM dd","Short time":"h:mm tt","Long time":"h:mm:ss tt","Year/month":"MMMM, yyyy"}},"en"),addLocale({name:"es-es",months:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre",""],monthsDeclined:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre",""],monthsShort:["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","sep.","oct.","nov.","dic.",""],days:["domingo","lunes","martes","mi\xe9rcoles","jueves","viernes","s\xe1bado"],daysShort:["do.","lu.","ma.","mi.","ju.","vi.","s\xe1."],quarters:["1","2","3","4"],amPm:["",""],amPmShort:["",""],era:"d. C.",thousandSeparator:".",decimalSeparator:",",formats:{Percent:"###,###,##0.00 %;-###,###,##0.00 %",Currency:"###,###,##0.00 \u20ac;-###,###,##0.00 \u20ac","Short date":"dd/MM/yyyy","Long date":'dddd, d" de "MMMM" de "yyyy',"Month/day":'d "de" MMMM',"Short time":"H:mm","Long time":"H:mm:ss","Year/month":'MMMM" de "yyyy'}},"es"),addLocale({name:"ja-jp",months:["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708",""],monthsDeclined:["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708",""],monthsShort:["1","2","3","4","5","6","7","8","9","10","11","12",""],days:["\u65e5\u66dc\u65e5","\u6708\u66dc\u65e5","\u706b\u66dc\u65e5","\u6c34\u66dc\u65e5","\u6728\u66dc\u65e5","\u91d1\u66dc\u65e5","\u571f\u66dc\u65e5"],daysShort:["\u65e5","\u6708","\u706b","\u6c34","\u6728","\u91d1","\u571f"],quarters:["Q1","Q2","Q3","Q4"],amPm:["\u5348\u524d","\u5348\u5f8c"],amPmShort:["\u5348","\u5348"],era:"\u897f\u66a6",thousandSeparator:",",decimalSeparator:".",formats:{Percent:"###,###,##0.00%;-###,###,##0.00%",Currency:"\xa5###,###,##0.;-\xa5###,###,##0.","Short date":"yyyy/MM/dd","Long date":'yyyy"\u5e74"M"\u6708"d"\u65e5"',"Month/day":'M"\u6708"d"\u65e5"',"Short time":"H:mm","Long time":"H:mm:ss","Year/month":'yyyy"\u5e74"M"\u6708"'}},"ja"),addLocale({name:"ko-kr",months:["1\uc6d4","2\uc6d4","3\uc6d4","4\uc6d4","5\uc6d4","6\uc6d4","7\uc6d4","8\uc6d4","9\uc6d4","10\uc6d4","11\uc6d4","12\uc6d4",""],monthsDeclined:["1\uc6d4","2\uc6d4","3\uc6d4","4\uc6d4","5\uc6d4","6\uc6d4","7\uc6d4","8\uc6d4","9\uc6d4","10\uc6d4","11\uc6d4","12\uc6d4",""],monthsShort:["1","2","3","4","5","6","7","8","9","10","11","12",""],days:["\uc77c\uc694\uc77c","\uc6d4\uc694\uc77c","\ud654\uc694\uc77c","\uc218\uc694\uc77c","\ubaa9\uc694\uc77c","\uae08\uc694\uc77c","\ud1a0\uc694\uc77c"],daysShort:["\uc77c","\uc6d4","\ud654","\uc218","\ubaa9","\uae08","\ud1a0"],quarters:["1","2","3","4"],amPm:["\uc624\uc804","\uc624\ud6c4"],amPmShort:["\uc624","\uc624"],era:"\uc11c\uae30",thousandSeparator:",",decimalSeparator:".",formats:{Percent:"###,###,##0.00%;-###,###,##0.00%",Currency:"\u20a9###,###,##0.;-\u20a9###,###,##0.","Short date":"yyyy-MM-dd","Long date":'yyyy"\ub144" M"\uc6d4" d"\uc77c" dddd',"Month/day":"M\uc6d4 d\uc77c","Short time":"tt h:mm","Long time":"tt h:mm:ss","Year/month":'yyyy"\ub144" M"\uc6d4"'}},"ko"),addLocale({name:"nl-be",months:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december",""],monthsDeclined:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december",""],monthsShort:["jan","feb","mrt","apr","mei","jun","jul","aug","sep","okt","nov","dec",""],days:["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"],daysShort:["zo","ma","di","wo","do","vr","za"],quarters:["1","2","3","4"],amPm:["",""],amPmShort:["",""],era:"A.D.",thousandSeparator:".",decimalSeparator:",",formats:{Percent:"###,###,##0.00%;-###,###,##0.00%",Currency:"\u20ac ###,###,##0.00;\u20ac -###,###,##0.00","Short date":"d/MM/yyyy","Long date":"dddd d MMMM yyyy","Month/day":"d MMMM","Short time":"H:mm","Long time":"H:mm:ss","Year/month":"MMMM yyyy"}},"nl"),addLocale({name:"nl-nl",months:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december",""],monthsDeclined:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december",""],monthsShort:["jan","feb","mrt","apr","mei","jun","jul","aug","sep","okt","nov","dec",""],days:["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"],daysShort:["zo","ma","di","wo","do","vr","za"],quarters:["1","2","3","4"],amPm:["",""],amPmShort:["",""],era:"n.Chr.",thousandSeparator:".",decimalSeparator:",",formats:{Percent:"###,###,##0.00%;-###,###,##0.00%",Currency:"\u20ac ###,###,##0.00;\u20ac -###,###,##0.00","Short date":"d-M-yyyy","Long date":"dddd d MMMM yyyy","Month/day":"d MMMM","Short time":"HH:mm","Long time":"HH:mm:ss","Year/month":"MMMM yyyy"}}),addLocale({name:"pt-br",months:["janeiro","fevereiro","mar\xe7o","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro",""],monthsDeclined:["janeiro","fevereiro","mar\xe7o","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro",""],monthsShort:["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez",""],days:["domingo","segunda-feira","ter\xe7a-feira","quarta-feira","quinta-feira","sexta-feira","s\xe1bado"],daysShort:["dom","seg","ter","qua","qui","sex","s\xe1b"],quarters:["Q1","Q2","Q3","Q4"],amPm:["",""],amPmShort:["",""],era:"d.C.",thousandSeparator:".",decimalSeparator:",",formats:{Percent:"###,###,##0.00%;-###,###,##0.00%",Currency:"R$ ###,###,##0.00;-R$ ###,###,##0.00","Short date":"dd/MM/yyyy","Long date":'dddd, d" de "MMMM" de "yyyy',"Month/day":'d "de" MMMM',"Short time":"HH:mm","Long time":"HH:mm:ss","Year/month":'MMMM" de "yyyy'}}),addLocale({name:"ru-ru",months:["\u042f\u043d\u0432\u0430\u0440\u044c","\u0424\u0435\u0432\u0440\u0430\u043b\u044c","\u041c\u0430\u0440\u0442","\u0410\u043f\u0440\u0435\u043b\u044c","\u041c\u0430\u0439","\u0418\u044e\u043d\u044c","\u0418\u044e\u043b\u044c","\u0410\u0432\u0433\u0443\u0441\u0442","\u0421\u0435\u043d\u0442\u044f\u0431\u0440\u044c","\u041e\u043a\u0442\u044f\u0431\u0440\u044c","\u041d\u043e\u044f\u0431\u0440\u044c","\u0414\u0435\u043a\u0430\u0431\u0440\u044c",""],monthsDeclined:["\u044f\u043d\u0432\u0430\u0440\u044f","\u0444\u0435\u0432\u0440\u0430\u043b\u044f","\u043c\u0430\u0440\u0442\u0430","\u0430\u043f\u0440\u0435\u043b\u044f","\u043c\u0430\u044f","\u0438\u044e\u043d\u044f","\u0438\u044e\u043b\u044f","\u0430\u0432\u0433\u0443\u0441\u0442\u0430","\u0441\u0435\u043d\u0442\u044f\u0431\u0440\u044f","\u043e\u043a\u0442\u044f\u0431\u0440\u044f","\u043d\u043e\u044f\u0431\u0440\u044f","\u0434\u0435\u043a\u0430\u0431\u0440\u044f",""],monthsShort:["\u044f\u043d\u0432","\u0444\u0435\u0432","\u043c\u0430\u0440","\u0430\u043f\u0440","\u043c\u0430\u0439","\u0438\u044e\u043d","\u0438\u044e\u043b","\u0430\u0432\u0433","\u0441\u0435\u043d","\u043e\u043a\u0442","\u043d\u043e\u044f","\u0434\u0435\u043a",""],days:["\u0432\u043e\u0441\u043a\u0440\u0435\u0441\u0435\u043d\u044c\u0435","\u043f\u043e\u043d\u0435\u0434\u0435\u043b\u044c\u043d\u0438\u043a","\u0432\u0442\u043e\u0440\u043d\u0438\u043a","\u0441\u0440\u0435\u0434\u0430","\u0447\u0435\u0442\u0432\u0435\u0440\u0433","\u043f\u044f\u0442\u043d\u0438\u0446\u0430","\u0441\u0443\u0431\u0431\u043e\u0442\u0430"],daysShort:["\u0412\u0441","\u041f\u043d","\u0412\u0442","\u0421\u0440","\u0427\u0442","\u041f\u0442","\u0421\u0431"],quarters:["1","2","3","4"],amPm:["",""],amPmShort:["",""],era:"A.D.",thousandSeparator:"\xa0",decimalSeparator:",",formats:{Percent:"###,###,##0.00%;-###,###,##0.00%",Currency:"###,###,##0.00 \u20bd;-###,###,##0.00 \u20bd","Short date":"dd.MM.yyyy","Long date":'d MMMM yyyy "\u0433."',"Month/day":"MMMM dd","Short time":"H:mm","Long time":"H:mm:ss","Year/month":"MMMM yyyy"}},"ru"),addLocale({name:"zh-cn",months:["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708",""],monthsDeclined:["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708",""],monthsShort:["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708",""],days:["\u661f\u671f\u65e5","\u661f\u671f\u4e00","\u661f\u671f\u4e8c","\u661f\u671f\u4e09","\u661f\u671f\u56db","\u661f\u671f\u4e94","\u661f\u671f\u516d"],daysShort:["\u5468\u65e5","\u5468\u4e00","\u5468\u4e8c","\u5468\u4e09","\u5468\u56db","\u5468\u4e94","\u5468\u516d"],quarters:["\u4e00\u5b63\u5ea6","\u4e8c\u5b63\u5ea6","\u4e09\u5b63\u5ea6","\u56db\u5b63\u5ea6"],amPm:["\u4e0a\u5348","\u4e0b\u5348"],amPmShort:["\u4e0a","\u4e0b"],era:"\u516c\u5143",thousandSeparator:",",decimalSeparator:".",formats:{Percent:"###,###,##0.00%;-###,###,##0.00%",Currency:"\xa5###,###,##0.00;\xa5-###,###,##0.00","Short date":"yyyy/M/d","Long date":'yyyy"\u5e74"M"\u6708"d"\u65e5"',"Month/day":'M"\u6708"d"\u65e5"',"Short time":"H:mm","Long time":"H:mm:ss","Year/month":'yyyy"\u5e74"M"\u6708"'}},"zh","cn"),addLocale({name:"zh-hk",months:["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708",""],monthsDeclined:["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708",""],monthsShort:["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708",""],days:["\u661f\u671f\u65e5","\u661f\u671f\u4e00","\u661f\u671f\u4e8c","\u661f\u671f\u4e09","\u661f\u671f\u56db","\u661f\u671f\u4e94","\u661f\u671f\u516d"],daysShort:["\u9031\u65e5","\u9031\u4e00","\u9031\u4e8c","\u9031\u4e09","\u9031\u56db","\u9031\u4e94","\u9031\u516d"],quarters:["1","2","3","4"],amPm:["\u4e0a\u5348","\u4e0b\u5348"],amPmShort:["\u4e0a","\u4e0b"],era:"\u516c\u5143",thousandSeparator:",",decimalSeparator:".",formats:{Percent:"###,###,##0.00%;-###,###,##0.00%",Currency:"HK$###,###,##0.00;(HK$###,###,##0.00)","Short date":"d/M/yyyy","Long date":'yyyy"\u5e74"M"\u6708"d"\u65e5"',"Month/day":"M\u6708d\u65e5","Short time":"H:mm","Long time":"H:mm:ss","Year/month":'yyyy"\u5e74"M"\u6708"'}}),addLocale({name:"zh-mo",months:["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708",""],monthsDeclined:["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708",""],monthsShort:["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708",""],days:["\u661f\u671f\u65e5","\u661f\u671f\u4e00","\u661f\u671f\u4e8c","\u661f\u671f\u4e09","\u661f\u671f\u56db","\u661f\u671f\u4e94","\u661f\u671f\u516d"],daysShort:["\u9031\u65e5","\u9031\u4e00","\u9031\u4e8c","\u9031\u4e09","\u9031\u56db","\u9031\u4e94","\u9031\u516d"],quarters:["1","2","3","4"],amPm:["\u4e0a\u5348","\u4e0b\u5348"],amPmShort:["\u4e0a","\u4e0b"],era:"\u516c\u5143",thousandSeparator:",",decimalSeparator:".",formats:{Percent:"###,###,##0.00%;-###,###,##0.00%",Currency:"MOP###,###,##0.00;-MOP###,###,##0.00","Short date":"d/M/yyyy","Long date":'yyyy"\u5e74"M"\u6708"d"\u65e5"',"Month/day":"M\u6708d\u65e5","Short time":"H:mm","Long time":"H:mm:ss","Year/month":'yyyy"\u5e74"M"\u6708"'}}),addLocale({name:"zh-sg",months:["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708",""],monthsDeclined:["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708",""],monthsShort:["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708",""],days:["\u661f\u671f\u65e5","\u661f\u671f\u4e00","\u661f\u671f\u4e8c","\u661f\u671f\u4e09","\u661f\u671f\u56db","\u661f\u671f\u4e94","\u661f\u671f\u516d"],daysShort:["\u5468\u65e5","\u5468\u4e00","\u5468\u4e8c","\u5468\u4e09","\u5468\u56db","\u5468\u4e94","\u5468\u516d"],quarters:["1","2","3","4"],amPm:["\u4e0a\u5348","\u4e0b\u5348"],amPmShort:["\u4e0a","\u4e0b"],era:"\u516c\u5143",thousandSeparator:",",decimalSeparator:".",formats:{Percent:"###,###,##0.00%;-###,###,##0.00%",Currency:"$###,###,##0.00;-$###,###,##0.00","Short date":"d/M/yyyy","Long date":'yyyy"\u5e74"M"\u6708"d"\u65e5"',"Month/day":"M\u6708d\u65e5","Short time":"tt h:mm","Long time":"tt h:mm:ss","Year/month":'yyyy"\u5e74"M"\u6708"'}}),addLocale({name:"zh-tw",months:["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708",""],monthsDeclined:["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708",""],monthsShort:["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708",""],days:["\u661f\u671f\u65e5","\u661f\u671f\u4e00","\u661f\u671f\u4e8c","\u661f\u671f\u4e09","\u661f\u671f\u56db","\u661f\u671f\u4e94","\u661f\u671f\u516d"],daysShort:["\u9031\u65e5","\u9031\u4e00","\u9031\u4e8c","\u9031\u4e09","\u9031\u56db","\u9031\u4e94","\u9031\u516d"],quarters:["1","2","3","4"],amPm:["\u4e0a\u5348","\u4e0b\u5348"],amPmShort:["\u4e0a","\u4e0b"],era:"\u897f\u5143",thousandSeparator:",",decimalSeparator:".",formats:{Percent:"###,###,##0.00%;-###,###,##0.00%",Currency:"NT$###,###,##0.00;-NT$###,###,##0.00","Short date":"yyyy/M/d","Long date":'yyyy"\u5e74"M"\u6708"d"\u65e5"',"Month/day":"M\u6708d\u65e5","Short time":"tt hh:mm","Long time":"tt hh:mm:ss","Year/month":'yyyy"\u5e74"M"\u6708"'}});"undefined"==typeof navigator||(navigator.language||navigator.userLanguage||"en-us").toLowerCase();const GENGOU_DATE_START=new Date(Date.UTC(1868,8,7)),KANJIDATE_MIN_SUPPORTED=new Date(Date.UTC(1873,0,1)),jpDate={getEra(date,isAplhabeticalEra){if(date<GENGOU_DATE_START)throw new Error(`${date} is incorrect gengou date. The Gengou calendar begins on September 8, 1868.`);return date<KANJIDATE_MIN_SUPPORTED&&(date=KANJIDATE_MIN_SUPPORTED),isAplhabeticalEra?kanjidate.format("{G:a}",date.getFullYear(),date.getMonth()+1,date.getDate()):kanjidate.toGengou(date.getFullYear(),date.getMonth()+1,date.getDate()).gengou},getYear(date,pattern,fn,previousPattern){let jpYear=date.getFullYear();if(previousPattern&&(previousPattern.startsWith("g")||previousPattern.startsWith("G"))){if(date<GENGOU_DATE_START)throw new Error(`${date} is incorrect gengou date. The Gengou calendar begins on September 8, 1868.`);if(jpYear=date<KANJIDATE_MIN_SUPPORTED?jpYear-GENGOU_DATE_START.getFullYear()+1:kanjidate.toGengou(date.getFullYear(),date.getMonth()+1,date.getDate()).nen,1===jpYear&&pattern.startsWith("Y")&&previousPattern.startsWith("g"))return"\u5143"}return fn(pattern.length<=2?jpYear%100:jpYear,pattern.length)}},currencyCodes={"ar-AE":"AED","ps-AF":"AFN","sq-AL":"ALL","hy-AM":"AMD","nl-CW":"ANG","ln-AO":"AOA","es-AR":"ARS","en-AU":"AUD","nl-AW":"AWG","az-Cyrl-AZ":"AZN","bs-Cyrl-BA":"BAM","en-BB":"BBD","bn-BD":"BDT","bg-BG":"BGN","ar-BH":"BHD","rn-BI":"BIF","en-BM":"BMD","ms-BN":"BND","es-BO":"BOB","pt-BR":"BRL","en-BS":"BSD","dz-BT":"BTN","en-BW":"BWP","ru-BY":"BYR","en-BZ":"BZD","fr-CA":"CAD","lu-CD":"CDF","rm-CH":"CHF","es-CL":"CLP","ii-CN":"CNY","es-CO":"COP","es-CR":"CRC","es-CU":"CUP","pt-CV":"CVE","en-CZ":"CZK","ar-DJ":"DJF","da-DK":"DKK","es-DO":"DOP","kab-DZ":"DZD","ar-EG":"EGP","ar-ER":"ERN","om-ET":"ETB","en-DE":"EUR","en-FJ":"FJD","en-FK":"FKP","en-GB":"GBP","ka-GE":"GEL","ak-GH":"GHS","en-GG":"GGP","en-GI":"GIP","en-GM":"GMD","fr-GN":"GNF","es-GT":"GTQ","en-GY":"GYD","zh-HK":"HKD","es-HN":"HNL","hr-HR":"HRK","fr-HT":"HTG","en-HU":"HUF","id-ID":"IDR","ar-IL":"ILS","kok-IN":"INR","ar-IQ":"IQD","fa-IR":"IRR","en-IS":"ISK","en-JM":"JMD","ar-JO":"JOD","ja-JP":"JPY","saq-KE":"KES","ru-KG":"KGS","km-KH":"KHR","ar-KM":"KMF","ko-KP":"KPW","ko-KR":"KRW","ar-KW":"KWD","en-KY":"KYD","kk-KZ":"KZT","lo-LA":"LAK","ar-LB":"LBP","ta-LK":"LKR","vai-Latn-LR":"LRD","en-LT":"LTL","en-LV":"LVL","ar-LY":"LYD","ar-MA":"MAD","ru-MD":"MDL","mg-MG":"MGA","sq-MK":"MKD","my-MM":"MMK","mn-Cyrl-MN":"MNT","zh-Hant-MO":"MOP","ar-MR":"MRO","en-MU":"MUR","en-MW":"MWK","es-MX":"MXN","ms-Latn-MY":"MYR","mgh-MZ":"MZN","naq-NA":"NAD","ha-Latn-NG":"NGN","es-NI":"NIO","nn-NO":"NOK","ne-NP":"NPR","en-NZ":"NZD","ar-OM":"OMR","es-PA":"PAB","es-PE":"PEN","en-PG":"PGK","es-PH":"PHP","pa-Arab-PK":"PKR","en-PL":"PLN","es-PY":"PYG","ar-QA":"QAR","en-RO":"RON","sr-Latn-RS":"RSD","ru-RU":"RUB","rw-RW":"RWF","ar-SA":"SAR","en-SB":"SBD","en-SC":"SCR","ar-SD":"SDG","sv-SE":"SEK","ms-Latn-SG":"SGD","en-SH":"SHP","en-SL":"SLL","ar-SO":"SOS","nl-SR":"SRD","pt-ST":"STD","ar-SY":"SYP","en-SZ":"SZL","th-TH":"THB","tg-Cyrl-TJ":"TJS","tk-TM":"TMT","ar-TN":"TND","to-TO":"TOP","tr-TR":"TRY","en-TT":"TTD","zh-Hant-TW":"TWD","sw-TZ":"TZS","ru-UA":"UAH","teo-UG":"UGX","en-US":"USD","es-UY":"UYU","uz-Cyrl-UZ":"UZS","es-VE":"VEF","vi-VN":"VND","en-VU":"VUV","en-WS":"WST","ar-YE":"YER","en-LS":"ZAR","af-ZA":"ZMW","am-ET":"ETB","ar-DZ":"DZD","bn-IN":"INR","bo-CN":"CNY","br-FR":"EUR","ca-ES":"EUR","co-FR":"EUR","cs-CZ":"CZK","cy-GB":"GBP","de-AT":"EUR","de-CH":"CHF","de-DE":"EUR","de-LI":"CHF","de-LU":"EUR","el-GR":"EUR","en-CA":"CAD","en-IE":"EUR","en-IN":"INR","en-MY":"MYR","en-PH":"PHP","en-SG":"SGD","en-ZA":"ZAR","en-ZW":"USD","es-EC":"USD","es-ES":"EUR","es-PR":"USD","es-SV":"USD","es-US":"USD","es-EE":"USD","fi-FI":"EUR","fil-PH":"PHP","fo-FO":"DKK","fr-BE":"EUR","fr-CH":"EUR","fr-FR":"EUR","fr-LU":"EUR","fr-MC":"EUR","fy-NL":"EUR","ga-IE":"EUR","gl-ES":"EUR","gu-IN":"INR","he-IL":"ILS","hi-IN":"INR","hr-BA":"BAM","hu-HU":"HUF","ig-NG":"NGN","is-IS":"ISK","it-CH":"EUR","it-IT":"EUR","kl-GL":"DKK","kn-IN":"INR","ky-KG":"KGS","lb-LU":"EUR","lt-LT":"EUR","lv-LV":"EUR","mi-NZ":"NZD","mk-MK":"MKD","ml-IN":"INR","mr-IN":"INR","ms-MY":"MYR","mt-MT":"EUR","nb-NO":"NOK","nl-BE":"EUR","nl-NL":"EUR","oc-FR":"EUR","or-IN":"INR","pa-IN":"INR","pl-PL":"PLN","pt-PT":"EUR","rp-RO":"USD","sa-IN":"INR","se-FI":"EUR","se-NO":"NOK","se-SE":"SEK","si-LK":"LKR","sk-SK":"EUR","sl-SL":"EUR","sv-FI":"EUR","sw-KE":"KES","syr-SY":"SYP","ta-IN":"INR","te-IN":"INR","tn-ZA":"ZAR","ug-CN":"CNY","uk-UA":"UAH","ur-PK":"PKR","wo-SN":"XOF","xh-ZA":"ZAR","yo-NG":"NGN","zh-CN":"CNY","zh-MO":"CNY","zh-SG":"SGD","zh-TW":"TWD","zu-ZA":"ZAR"};function buildDateTimeFormatInfo(locale){var _a,_b;const dateFormats={weekDay:Intl.DateTimeFormat(locale,{weekday:"long"}),weekDayShort:Intl.DateTimeFormat(locale,{weekday:"short"}),monthDay:Intl.DateTimeFormat(locale,{month:"long"}),monthDayShort:Intl.DateTimeFormat(locale,{month:"short"}),dateLong:Intl.DateTimeFormat(locale,{dateStyle:"long"}),timeShort:Intl.DateTimeFormat(locale,{timeStyle:"short"}),hours12:Intl.DateTimeFormat(locale,{hour12:!0,hour:"numeric"}),yearEra:Intl.DateTimeFormat("ja-JP"===locale?"ja-JP-u-ca-japanese":locale,{year:"numeric",era:"short"})},customDate=locale.startsWith("ja-JP")?{getCustomEra:date=>{var _a,_b;return null!==(_b=null===(_a=dateFormats.yearEra.formatToParts(date).find((p=>"era"===p.type)))||void 0===_a?void 0:_a.value)&&void 0!==_b?_b:""},getCustomYear:(date,pattern,fn,previousPattern)=>jpDate.getYear(date,pattern,fn,previousPattern)}:{},januarySunday=dateTimeFactory_createFromJsDate(new Date("2022-01-02T00:00:00Z")),weekDays=[...Array(7).keys()].map((d=>januarySunday.add(d,"days").toDate())),yearMonths=[...Array(12).keys()].map((d=>januarySunday.add(d,"months").toDate())),amPm=[januarySunday.startOfDay().add(1,"hours").toDate(),januarySunday.startOfDay().add(13,"hours").toDate()];return Object.assign({months:yearMonths.map((date=>dateFormats.monthDay.format(date))),monthsDeclined:yearMonths.map((date=>{var _a,_b;return null!==(_b=null===(_a=dateFormats.dateLong.formatToParts(date).find((obj=>"month"===obj.type)))||void 0===_a?void 0:_a.value)&&void 0!==_b?_b:""})),monthsShort:yearMonths.map((date=>dateFormats.monthDayShort.format(date))),days:weekDays.map((date=>dateFormats.weekDay.format(date))),daysShort:weekDays.map((date=>dateFormats.weekDayShort.format(date))),quarters:getQuarters(locale),amPm:amPm.map((date=>{var _a,_b;return null!==(_b=null===(_a=dateFormats.hours12.formatToParts(date).find((p=>"dayPeriod"===p.type)))||void 0===_a?void 0:_a.value)&&void 0!==_b?_b:""})),amPmShort:amPm.map((date=>{var _a,_b;return null!==(_b=null===(_a=dateFormats.hours12.formatToParts(date).find((p=>"dayPeriod"===p.type)))||void 0===_a?void 0:_a.value.charAt(0))&&void 0!==_b?_b:""})),era:null!==(_b=null===(_a=dateFormats.yearEra.formatToParts(new Date).find((p=>"era"===p.type)))||void 0===_a?void 0:_a.value)&&void 0!==_b?_b:""},customDate)}function getQuarters(locale){switch(locale){case"en-US":case"ja-JP":case"en-GB":case"pt-BR":case"en-CA":return["Q1","Q2","Q3","Q4"];case"zh-CN":return["\u4e00\u5b63\u5ea6","\u4e8c\u5b63\u5ea6","\u4e09\u5b63\u5ea6","\u56db\u5b63\u5ea6"];default:return["1","2","3","4"]}}function buildNumberFormatInfo(locale){var _a,_b;const parts=Intl.NumberFormat(locale).formatToParts(1000.1),decimalSeparator=null===(_a=parts.find((p=>"decimal"===p.type)))||void 0===_a?void 0:_a.value,thousandSeparator=null===(_b=parts.find((p=>"group"===p.type)))||void 0===_b?void 0:_b.value;return{decimalSeparator:null!=decimalSeparator?decimalSeparator:"."!==thousandSeparator?".":",",thousandSeparator:null!=thousandSeparator?thousandSeparator:""}}const localesCache={},localeProvider=(providers=[{getLocale(locale){const localeData=locales[locale.toLowerCase()];if(!localeData)return null;const dateFormats={"Short date":localeData.formats["Short date"],"Long date":localeData.formats["Long date"],"Month/day":localeData.formats["Month/day"],"Short time":localeData.formats["Short time"],"Long time":localeData.formats["Long time"],"Year/month":localeData.formats["Year/month"]},numberFormats={Percent:localeData.formats.Percent,Currency:localeData.formats.Currency},customDate=locale.startsWith("ja-JP")?{getCustomEra:(date,isAplhabeticalEra)=>jpDate.getEra(date,isAplhabeticalEra),getCustomYear:(date,pattern,fn,previousPattern)=>jpDate.getYear(date,pattern,fn,previousPattern)}:{};return{DateTime:{FormatInfo:Object.assign(Object.assign({},localeData),customDate),Format(value,formatKey){const pattern=dateFormats[formatKey];if(!pattern)throw new Error("Invalid DateTime format alias.");return formatDateTimeWithPattern(value,pattern,localeData,!1)}},Number:{FormatInfo:localeData,Format(value,formatKey,precision){const pattern=numberFormats[formatKey];if(!pattern)throw new Error("Invalid Number format alias.");return formatNumberWithPattern(value,null!=precision?specifyPrecision(pattern,precision):pattern,localeData)}}}}},{getLocale(locale){var _a,_b;const cached=localesCache[locale.toLowerCase()];if(cached)return cached;try{if(0===Intl.DateTimeFormat.supportedLocalesOf([locale],{localeMatcher:"lookup"}).length||0===Intl.NumberFormat.supportedLocalesOf([locale],{localeMatcher:"lookup"}).length)return null}catch(_c){return null}const dateFormats={dateLong:Intl.DateTimeFormat(locale,{dateStyle:"full"}),dateShort:Intl.DateTimeFormat(locale,{dateStyle:"short"}),timeLong:Intl.DateTimeFormat(locale,{timeStyle:"medium"}),timeShort:Intl.DateTimeFormat(locale,{timeStyle:"short"}),monthDay:Intl.DateTimeFormat(locale,{month:"long",day:"numeric"}),yearMonth:Intl.DateTimeFormat(locale,{year:"numeric",month:"long"})},currencyCode=null!==(_b=null===(_a=Object.entries(currencyCodes).find((kvPair=>locale.toLowerCase().startsWith(kvPair[0].toLowerCase()))))||void 0===_a?void 0:_a[1])&&void 0!==_b?_b:"USD",result={DateTime:{FormatInfo:buildDateTimeFormatInfo(locale),Format(value,formatKey){switch(formatKey){case"Short date":return dateFormats.dateShort.format(value);case"Long date":return dateFormats.dateLong.format(value);case"Short time":return dateFormats.timeShort.format(value);case"Long time":return dateFormats.timeLong.format(value);case"Month/day":return dateFormats.monthDay.format(value);case"Year/month":return dateFormats.yearMonth.format(value);default:throw new Error("Invalid DateTime format alias.")}}},Number:{FormatInfo:buildNumberFormatInfo(locale),Format(value,formatKey,precision){const precisionFormat={minimumFractionDigits:null!=precision?precision:2,maximumFractionDigits:null!=precision?precision:2};switch(formatKey){case"Currency":return Intl.NumberFormat(locale,Object.assign(Object.assign({},precisionFormat),{style:"currency",currency:currencyCode})).format(value);case"Percent":return Intl.NumberFormat(locale,Object.assign(Object.assign({},precisionFormat),{style:"percent"})).format(value);default:throw new Error("Invalid Number format alias.")}}}};return localesCache[locale.toLowerCase()]=result,result}}],{getLocale(locale){for(const provider of providers){const loc=provider.getLocale(locale);if(loc)return loc}return null}});var providers;const browserLocale="undefined"!=typeof navigator&&(navigator.language||navigator.userLanguage)||"en-US",fallbackLocales="en-US"===browserLocale?["en-US"]:[browserLocale,"en-US"];function formatValue(value,locale,format){if(Array.isArray(value))return value.map((val=>formatValue(val,locale,format))).join(", ");if(null==value)return"";const localesList="r"===(null==format?void 0:format.toLowerCase())?["en-US"]:locale?[locale,...fallbackLocales.filter((l=>l!==locale))]:fallbackLocales;let localeInfo=null;for(const l of localesList)if(localeInfo=localeProvider.getLocale(l),localeInfo)break;if(null==localeInfo)throw new Error(`Unable to format value: none of locales '${localesList}' can be resolved.`);if(isVariant$2(value))switch(value.Type){case"Date":case"TimeSpan":return formatDateTime(value.Value.toDate(),format,localeInfo.DateTime);case"Decimal":case"Double":case"Float":case"Int32":case"Int64":return formatNumber(value.Value,format,localeInfo.Number);default:return Convert$2.toString(value)}return format&&"string"==typeof value&&shouldTreatAsDate(value,format)&&(value=dateTimeFactory_createFromString(value)),dateTimeFactory_isDateTime(value)?formatDateTime(value.toDate(),format,localeInfo.DateTime):"string"==typeof value?value||"":"number"==typeof value?formatNumber(value,format,localeInfo.Number):"boolean"==typeof value?value?"True":"False":`${value}`}const iso8601=/^(-?(?:[1-9][0-9]*)?[0-9]{4})-(1[0-2]|0[1-9])-(3[01]|0[1-9]|[12][0-9])T(2[0-3]|[01][0-9]):([0-5][0-9]):([0-5][0-9])(.[0-9]+)?(Z)?$/;function shouldTreatAsDate(value,format){return pattern=format,dateTimeFormatKeys.includes(pattern)&&(value=>value&&value.length>11&&"-"===value[4]&&"-"===value[7]&&"T"===value[10]&&iso8601.test(value))(value);var pattern}const ISOformat$1={ISO_8601:!0},dateTimeFormats=[ISOformat$1,"MM/dd/YYYY","MM/dd/YYYY HH:mm","MM/dd/YYYY HH:mm:ss","YYYY-MM-ddTHH:mm:ss.fffffff","YYYY-MM-dd HH:mm:sszzz","YYYY-MM-ddTHH:mm:ss","HH:mm","HH:mm:ss"],timeFormats=["H:m","H:m:s","htt","h tt","h:mtt","h:m tt","h:m:stt","h:m:s tt"];function vbRound(n){const v=Math.trunc(n);return v+(Math.abs(n-v)>.5?1:0)*Math.sign(n)}function getNumberValue(v,integer=!1){switch(v.Type){case"Bool":return v.Value?-1:0;case"Int32":case"Int64":case"UInt64":case"Float":case"Double":case"Decimal":return v.Value;case"String":return function(s,integer=!1){if(!(integer?/^\-?[0-9]+$/:/^\-?[0-9]+(\.[0-9]*)?$/).test(s))throw new Error(`Invalid number format: ${s}`);const result=parseFloat(s);if(isNaN(result))throw new Error(`Invalid number format: ${s}`);if(!isFinite(result))throw new Error(`Number overflow: ${s}`);return result}(v.Value,integer);case"Object":case"Date":case"TimeSpan":throw new Error(`Invalid conversion: ${v.Type} to number`);default:return 0}}function getBooleanValue(v){switch(v.Type){case"Bool":return v.Value;case"Int32":case"Int64":case"UInt64":case"Float":case"Double":case"Decimal":return 0!==v.Value;case"Null":return!1;case"String":return function(s){const t=s.trim();if("False"===t)return!1;if("True"===t)return!0;const n=parseFloat(t);if(!isNaN(n)&&isFinite(n))return 0!==n;throw new Error(`Invalid boolean format: ${s}`)}(v.Value);case"Object":return null!==v.Value;case"TimeSpan":case"Date":return 0!==v.Value.valueOf();default:return!1}}function getStringValue$2(v){switch(v.Type){case"Null":return"";case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":return formatValue(v,null,null);case"String":return v.Value;case"TimeSpan":case"Date":return formatValue(v,null,null);case"Bool":return v.Value?"True":"False";default:return""}}var operators$1=Object.freeze({__proto__:null,Not:function(v){switch(v.Type){case"Null":return Create$5(-1);case"Bool":return Create$5(0==getNumberValue(v));case"Int32":case"Int64":case"UInt64":return Create$5(~v.Value);case"Float":case"Double":case"Decimal":return Create$5(~vbRound(v.Value));case"String":return Create$5(~getNumberValue(v));case"TimeSpan":case"Date":case"Object":default:throw new Error(`Invalid operation: ! ${v.Type}`)}},BitwiseShiftLeft:function(v,shift){switch(v.Type){case"Null":case"Bool":case"Int32":case"Int64":case"UInt64":case"Float":case"Double":case"Decimal":case"String":return Create$5(getNumberValue(v)<<getNumberValue(shift));case"TimeSpan":case"Date":case"Object":default:throw new Error(`Invalid operation: << ${v.Type}`)}},BitwiseShiftRight:function(v,shift){switch(v.Type){case"Null":case"Bool":case"Int32":case"Int64":case"UInt64":case"Float":case"Double":case"Decimal":case"String":return Create$5(getNumberValue(v)>>getNumberValue(shift));case"TimeSpan":case"Date":case"Object":default:throw new Error(`Invalid operation: >> ${v.Type}`)}},UnaryMinus:function(v){switch(v.Type){case"Null":return Zero$3;case"Bool":case"Int32":case"Int64":case"UInt64":case"Float":case"Double":case"Decimal":case"String":case"TimeSpan":case"Date":return Create$5(-getNumberValue(v));case"Object":default:throw new Error(`Invalid operation: - ${v.Type}`)}},UnaryPlus:function(v){switch(v.Type){case"Null":return Zero$3;case"Bool":case"Int32":case"Int64":case"UInt64":case"Float":case"Double":case"Decimal":case"String":case"TimeSpan":case"Date":return Create$5(getNumberValue(v));case"Object":default:throw new Error(`Invalid operation: + ${v.Type}`)}},Plus:function(a,b){switch(a.Type){case"Null":switch(b.Type){case"Null":return Zero$3;case"Bool":case"String":case"Enum":return Create$5(getNumberValue(b));case"Int32":case"Int64":case"UInt64":case"Double":case"Float":case"Decimal":case"TimeSpan":return b;default:throw new Error(`Invalid operation: ${a.Type} + ${b.Type}`)}case"Bool":case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":switch(b.Type){case"Null":return Create$5(getNumberValue(a));case"Bool":case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":case"String":return Create$5(getNumberValue(a)+getNumberValue(b));default:throw new Error(`Invalid operation: ${a.Type} + ${b.Type}`)}case"TimeSpan":switch(b.Type){case"Null":return a;default:throw new Error(`Invalid operation: ${a.Type} + ${b.Type}`)}case"Date":switch(b.Type){case"Date":case"String":return Create$5(getStringValue$2(a)+getStringValue$2(b));default:throw new Error(`Invalid operation: ${a.Type} + ${b.Type}`)}case"String":switch(b.Type){case"Null":case"Bool":case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":return Create$5(getNumberValue(a)+getNumberValue(b));case"Date":return Create$5(a.Value+getStringValue$2(b));default:return Create$5(getStringValue$2(a)+getStringValue$2(b))}default:throw new Error(`Invalid operation: ${a.Type} + ${b.Type}`)}},Minus:function(a,b){switch(a.Type){case"Null":switch(b.Type){case"Null":return Zero$3;case"Bool":case"String":case"Enum":case"Int32":case"Int64":case"UInt64":case"Double":case"Float":case"Decimal":case"TimeSpan":return Create$5(-getNumberValue(b));default:throw new Error(`Invalid operation: ${a.Type} - ${b.Type}`)}case"Bool":case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":switch(b.Type){case"Null":return Create$5(getNumberValue(a));case"Bool":case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":case"String":return Create$5(getNumberValue(a)-getNumberValue(b));default:throw new Error(`Invalid operation: ${a.Type} - ${b.Type}`)}case"TimeSpan":switch(b.Type){case"Null":return a;default:throw new Error(`Invalid operation: ${a.Type} - ${b.Type}`)}case"Date":throw b.Type,new Error(`Invalid operation: ${a.Type} - ${b.Type}`);case"String":switch(b.Type){case"Null":case"Bool":case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":case"String":return Create$5(getNumberValue(a)-getNumberValue(b));default:throw new Error(`Invalid operation: ${a.Type} - ${b.Type}`)}default:throw new Error(`Invalid operation: ${a.Type} - ${b.Type}`)}},Mult:function(a,b){switch(a.Type){case"Null":switch(b.Type){case"Null":case"Bool":case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":return Zero$3;case"String":return Create$5(0*getNumberValue(b));default:throw new Error(`Invalid operation: ${a.Type} * ${b.Type}`)}case"Bool":case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":case"String":switch(b.Type){case"Null":case"Bool":case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":case"String":return Create$5(getNumberValue(a)*getNumberValue(b));default:throw new Error(`Invalid operation: ${a.Type} * ${b.Type}`)}default:throw new Error(`Invalid operation: ${a.Type} * ${b.Type}`)}},Divide:function(a,b){if(0===getNumberValue(b))throw new Error("Invalid operation: division by zero");switch(a.Type){case"Null":switch(b.Type){case"Null":return Create$5(Number.NaN);case"Bool":case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":case"String":return Create$5(0/getNumberValue(b));default:throw new Error(`Invalid operation: ${a.Type} / ${b.Type}`)}case"Bool":case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":case"String":switch(b.Type){case"Null":case"Bool":case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":case"String":return Create$5(getNumberValue(a)/getNumberValue(b));default:throw new Error(`Invalid operation: ${a.Type} / ${b.Type}`)}default:throw new Error(`Invalid operation: ${a.Type} / ${b.Type}`)}},IntegralDivide:function(a,b){if(0===getNumberValue(b))throw new Error("Invalid operation: division by zero");switch(a.Type){case"Null":switch(b.Type){case"Null":return Create$5(Number.NaN);case"Bool":case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":case"String":return Create$5(0/getNumberValue(b));default:throw new Error(`Invalid operation: ${a.Type}  ${b.Type}`)}case"Bool":case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":case"String":switch(b.Type){case"Null":case"Bool":case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":case"String":return Create$5(Math.trunc(vbRound(getNumberValue(a))/vbRound(getNumberValue(b))));default:throw new Error(`Invalid operation: ${a.Type} / ${b.Type}`)}default:throw new Error(`Invalid operation: ${a.Type}  ${b.Type}`)}},Mod:function(a,b){if(0===getNumberValue(b))throw new Error("Invalid operation: division by zero");switch(a.Type){case"Null":switch(b.Type){case"Bool":if(b.Value)return Zero$3;throw new Error(`Invalid operation: ${a.Type} % ${b.Type}`);case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":return Zero$3;case"String":return Create$5(0*getNumberValue(b));default:throw new Error(`Invalid operation: ${a.Type} % ${b.Type}`)}case"Bool":case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":case"String":switch(b.Type){case"Null":case"Bool":case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":case"String":return Create$5(getNumberValue(a)%getNumberValue(b));default:throw new Error(`Invalid operation: ${a.Type} % ${b.Type}`)}default:throw new Error(`Invalid operation: ${a.Type} % ${b.Type}`)}},Pow:function(a,b){switch(a.Type){case"Null":switch(b.Type){case"Null":case"Bool":case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":return Zero$3;case"String":return Create$5(0*getNumberValue(b));default:throw new Error(`Invalid operation: ${a.Type} ^ ${b.Type}`)}case"Bool":case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":case"String":switch(b.Type){case"Null":case"Bool":case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":case"String":return Create$5(Math.pow(getNumberValue(a),getNumberValue(b)));default:throw new Error(`Invalid operation: ${a.Type} ^ ${b.Type}`)}default:throw new Error(`Invalid operation: ${a.Type} ^ ${b.Type}`)}},Xor:function(a,b){return"Bool"===a.Type&&"Bool"===b.Type?a.Value!==b.Value?True:False:Create$5(getNumberValue(a)^getNumberValue(b))},Or:function(a,b){return"Bool"===a.Type&&"Bool"===b.Type?a.Value||b.Value?True:False:Create$5(getNumberValue(a)|getNumberValue(b))},And:function(a,b){return"Bool"===a.Type&&"Bool"===b.Type?a.Value&&b.Value?True:False:Create$5(getNumberValue(a)&getNumberValue(b))}});function compareBoolean(a,b){return!a&&b?-1:a&&!b?1:0}function compareString(a,b){const i=a.localeCompare(b);return i<0?-1:i>0?1:0}function Compare$1(a,b){switch(a.Type){case"Null":switch(b.Type){case"Null":return 0;case"Bool":case"Int32":case"Int64":case"UInt64":case"Float":case"Double":case"Decimal":return-getNumberValue(b);case"TimeSpan":case"Date":return-b.Value.valueOf();case"String":return compareString("",b.Value);default:return-1}case"Bool":switch(b.Type){case"Null":case"Bool":case"Int32":case"Int64":case"UInt64":case"Float":case"Double":case"Decimal":return getNumberValue(a)-getNumberValue(b);case"String":return compareBoolean(a.Value,getBooleanValue(b));default:throw new Error(`Invalid comparison: ${a.Type} and ${b.Type}`)}case"Int32":case"Int64":case"UInt64":case"Float":case"Double":case"Decimal":switch(b.Type){case"Null":case"Bool":case"Int32":case"Int64":case"UInt64":case"Float":case"Double":case"Decimal":case"String":return getNumberValue(a)-getNumberValue(b);default:throw new Error(`Invalid comparison: ${a.Type} and ${b.Type}`)}case"Object":switch(b.Type){case"Null":case"Object":return 1;default:throw new Error(`Invalid comparison: ${a.Type} and ${b.Type}`)}case"String":switch(b.Type){case"Null":return a.Value.localeCompare("");case"Bool":return compareBoolean(getBooleanValue(a),b.Value);case"Int32":case"Int64":case"UInt64":case"Float":case"Double":case"Decimal":return getNumberValue(a)-getNumberValue(b);case"String":return compareString(a.Value,b.Value);default:throw new Error(`Invalid comparison: ${a.Type} and ${b.Type}`)}case"Date":switch(b.Type){case"Date":return a.Value.valueOf()-b.Value.valueOf();default:throw new Error(`Invalid comparison: ${a.Type} and ${b.Type}`)}case"TimeSpan":case"Enum":default:throw new Error(`Invalid comparison: ${a.Type} and ${b.Type}`)}}var comparison=Object.freeze({__proto__:null,Compare:Compare$1,Equals:(a,b)=>Create$5(0===Compare$1(a,b)),NotEquals:(a,b)=>Create$5(0!==Compare$1(a,b)),LessThan:(a,b)=>Create$5(Compare$1(a,b)<0),GreaterThan:(a,b)=>Create$5(Compare$1(a,b)>0),LessOrEqual:(a,b)=>Create$5(Compare$1(a,b)<=0),GreaterOrEqual:(a,b)=>Create$5(Compare$1(a,b)>=0)});const Operators=Object.assign({},operators$1),Comparison$1=Object.assign({},comparison),Null$3={Type:"Null",Value:null},DBNull={Type:"Object",Value:{}},Zero$3={Type:"Int32",Value:0},True={Type:"Bool",Value:!0},False={Type:"Bool",Value:!1},IsNull=v=>"Null"===v.Type;function isVariant$2(v){return void 0!==v.Type&&void 0!==v.Value&&(isNumericVariant(v)||"Null"===v.Type&&null===v.Value||"Bool"===v.Type&&"boolean"==typeof v.Value||("TimeSpan"===v.Type||"Date"===v.Type)&&dateTimeFactory_isDateTime(v.Value)||("String"===v.Type||"Enum"===v.Type)&&"string"==typeof v.Value||"Object"===v.Type&&"object"==typeof v.Value)}function isNumericVariant(v){return void 0!==v.Type&&void 0!==v.Value&&("Int32"===v.Type||"Int64"===v.Type||"UInt64"===v.Type||"Float"===v.Type||"Double"===v.Type||"Decimal"===v.Type)&&"number"==typeof v.Value}function isObjectVariant(v){return void 0!==v.Type&&void 0!==v.Value&&"Object"===v.Type&&"object"==typeof v.Value}function isStringVariant(v){return void 0!==v.Type&&void 0!==v.Value&&"String"===v.Type&&"string"==typeof v.Value}function isTimeVariant(v){return void 0!==v.Type&&void 0!==v.Value&&("TimeSpan"===v.Type||"Date"===v.Type)&&dateTimeFactory_isDateTime(v.Value)}function Create$5(value,exactType=null,forceCast=!1){if(exactType){if("Bool"!==exactType&&"Date"!==exactType&&"Decimal"!==exactType&&"Double"!==exactType&&"Enum"!==exactType&&"Float"!==exactType&&"Int32"!==exactType&&"Int64"!==exactType&&"Null"!==exactType&&"Object"!==exactType&&"String"!==exactType&&"TimeSpan"!==exactType&&"UInt64"!==exactType)throw new Error(`Unknown variant Type: ${exactType}`);const v={Type:exactType,Value:value};if(isVariant$2(v))return v;{if(!forceCast)throw new Error(`Type mismatch: ${value} is not instance of ${exactType}`);const source=Create$5(value);switch(exactType){case"Bool":return Create$5(Convert$2.toBoolean(source),exactType);case"Null":return Null$3;case"Int32":case"Int64":case"UInt64":return Create$5(Convert$2.toInteger(source),exactType);case"Float":case"Double":case"Decimal":return Create$5(Convert$2.toDouble(source),exactType);case"String":return Create$5(Convert$2.toString(source),exactType);case"Date":return Create$5(Convert$2.toDate(source),exactType);case"TimeSpan":return Create$5(Convert$2.toTimeSpan(source),exactType);default:throw new Error(`Type mismatch: cannot convert ${value} to type ${exactType}`)}}}if(null==value)return Null$3;if(isVariant$2(value))return value;if("boolean"==typeof value)return{Type:"Bool",Value:value};if("object"==typeof value){if(dateTimeFactory_isDateTime(value))return{Type:"Date",Value:value};if(value instanceof Date){const dateValue=dateTimeFactory_createFromJsDate(value);return null!=dateValue?{Type:"Date",Value:dateValue}:Null$3}return{Type:"Object",Value:value}}if("string"==typeof value)return{Type:"String",Value:value};if("number"==typeof value)return Number.isInteger(value)?{Type:"Int64",Value:value}:{Type:"Double",Value:value};throw new Error(`Invalid argument: unable to create variant from '${typeof value}'.`)}const toSafeValue=v=>{switch(v.Type){case"Date":case"TimeSpan":return v.Value;case"Object":if(v===DBNull)return null;if(v.Value instanceof Array)return v.Value.map((val=>toSafeValue(Create$5(val))));throw new Error("Cannot convert Object to safe value");default:return v.Value}},Convert$2={toBoolean:v=>{if("String"===v.Type){const t=v.Value.trim().toLowerCase();if("false"===t)return!1;if("true"===t)return!0;const n=parseFloat(t);if(!isNaN(n)&&isFinite(n))return 0!==n}return getBooleanValue(v)},toString:v=>getStringValue$2(v),toChar:v=>isStringVariant(v)?v.Value[0]||"":String.fromCharCode(getNumberValue(v)),toInteger:v=>vbRound(getNumberValue(v,!0)),toDouble:v=>getNumberValue(v),toDate:v=>{switch(v.Type){case"Date":return v.Value;case"String":return function(s){if(s){const m=dateTimeFactory_createFromString(s,[ISOformat$1],!0);if(null!=m)return m}throw new Error(`Invalid date format: ${s}`)}(v.Value);case"Object":if(v.Value instanceof Date){const dateValue=dateTimeFactory_createFromJsDate(v.Value);if(null!=dateValue)return dateValue}default:throw new Error(`Invalid conversion: ${v.Type} to date`)}},toTimeSpan:v=>{switch(v.Type){case"TimeSpan":return v.Value;case"String":throw new Error("Not implemented");default:throw new Error(`Invalid conversion: ${v.Type} to timespan`)}},toSafeValue:toSafeValue};var VariantUtils=Object.freeze({__proto__:null,Operators:Operators,Comparison:Comparison$1,Null:Null$3,DBNull:DBNull,Zero:Zero$3,True:True,False:False,IsNull:IsNull,IsNullOrEmptyString:v=>IsNull(v)||"String"===v.Type&&""===v.Value,isVariant:isVariant$2,isNumericVariant:isNumericVariant,isBoolVariant:function(v){return void 0!==v.Type&&void 0!==v.Value&&"Bool"===v.Type&&"boolean"==typeof v.Value},isObjectVariant:isObjectVariant,isStringVariant:isStringVariant,isTimeVariant:isTimeVariant,Create:Create$5,Convert:Convert$2});class ExpressionNode{constructor(evaluate,Children,Token){this.evaluate=evaluate,this.Children=Children,this.Token=Token,this.Eval=function(ctx){return this.evaluate(ctx,this.Children)},this.EvalConst=function(){return this.evaluate({Data:{}},this.Children)},this.Contains=function(tokenName,tokenType){return!((!tokenType||this.Token.type!==tokenType)&&tokenType||!(null===tokenName||"string"==typeof tokenName&&this.Token.value===tokenName||"object"==typeof tokenName&&"value"!==this.Token.type&&this.Token.value.match(tokenName)))||this.Children.some((c=>c.Contains(tokenName,tokenType)))},this.ToString=function(){switch(this.Token.type){case"variable":case"constant":return this.Token.value;case"function":const functionName=this.Token.value;return functionName&&"."===functionName[0]?`${this.Children[0].ToString()}${this.Token.value}(${this.Children.slice(1).map((c=>c.ToString())).join(",")})`:`${this.Token.value}(${this.Children.map((c=>c.ToString())).join(",")})`;case"operator":return 1===this.Token.arity?`(${this.Token.value}(${this.Children[0].ToString()}))`:`((${this.Children[0].ToString()})${this.Token.value}(${this.Children[1].ToString()}))`;case"value":switch(this.Token.value.Type){case"String":return`"${this.Token.value.Value.replace(/"/g,'""')}"`;case"Date":return`#${Convert$2.toString(this.Token.value)}#`;case"Object":throw new Error(`[expression] cannot serialize object to string: ${this.Token.value.Value}`);default:return`${this.Token.value.Value}`}default:return""}},this.ReplaceChildren=function(childern){return new ExpressionNode(this.evaluate,childern,this.Token)},this.Simplify=function(){if("function"===this.Token.type||"operator"===this.Token.type){if(!this.Contains(null,"variable")){const result=this.EvalConst();return new ExpressionNode((()=>result),[],{value:result,type:"value"})}return new ExpressionNode(this.evaluate,this.Children.map((child=>child.Simplify())),this.Token)}return this}}}function mapValues$2(obj,callback){const result={};return Object.keys(obj||{}).forEach((key=>{result[key]=callback(obj[key])})),result}function mapKeys(obj,callback){const result={};return Object.keys(obj||{}).forEach((key=>{result[callback(key)]=obj[key]})),result}function mapKeysDeep$1(obj,callback){if(null==obj||"object"!=typeof obj)return obj;if(isVariant$2(obj))return obj===DBNull?obj:{Type:obj.Type,Value:Array.isArray(obj.Value)?obj.Value.map((item=>mapKeysDeep$1(item,callback))):mapKeysDeep$1(obj.Value,callback)};const result={};return Object.keys(obj||{}).forEach((key=>{result[callback(key)]=Array.isArray(obj[key])?obj[key].map((item=>mapKeysDeep$1(item,callback))):mapKeysDeep$1(obj[key],callback)})),result}const getValueByKey=(obj,key)=>obj[key];function isPositive(n){if(n<0)throw new Error(`Can not convert ${n} to unsigned`);return n}const convert$1={ToBoolean:args=>Create$5(Convert$2.toBoolean(args[1]),"Bool"),ToByte:args=>Create$5(isPositive(convertToNumber(args[1],Convert$2.toInteger)),"Int32"),ToInt16:args=>Create$5(convertToNumber(args[1],Convert$2.toInteger),"Int32"),ToInt32:args=>Create$5(convertToNumber(args[1],Convert$2.toInteger),"Int32"),ToInt64:args=>Create$5(convertToNumber(args[1],Convert$2.toInteger),"Int64"),ToUInt16:args=>Create$5(isPositive(convertToNumber(args[1],Convert$2.toInteger)),"UInt64"),ToUInt32:args=>Create$5(isPositive(convertToNumber(args[1],Convert$2.toInteger)),"UInt64"),ToUInt64:args=>Create$5(isPositive(convertToNumber(args[1],Convert$2.toInteger)),"UInt64"),ToDecimal:args=>Create$5(convertToNumber(args[1],Convert$2.toDouble),"Decimal"),ToDouble:args=>Create$5(convertToNumber(args[1],Convert$2.toDouble),"Double"),ToSingle:args=>Create$5(convertToNumber(args[1],Convert$2.toDouble),"Float"),ToString:args=>Create$5(Convert$2.toString(args[1]),"String"),ToDateTime:args=>Create$5(Convert$2.toDate(args[1]),"Date"),ToChar:args=>Create$5(Convert$2.toChar(args[1]),"String"),IsDBNull:args=>args[1]===DBNull?True:False};function convertToNumber(val,conversionFunc){return"Bool"===val.Type?val.Value?1:0:conversionFunc(val)}function getNumericValue$2(v){if(isNumericVariant(v))return Convert$2.toDouble(v);throw new Error(`Type mismatch: ${v.Value} is not a number`)}const math={Abs:args=>Create$5(Math.abs(getNumericValue$2(args[1]))),Ceiling:args=>Create$5(Math.ceil(getNumericValue$2(args[1]))),Floor:args=>Create$5(Math.floor(getNumericValue$2(args[1]))),Truncate:args=>Create$5(Math.trunc(getNumericValue$2(args[1]))),Round:args=>Create$5(2===args.length?Math.round(getNumericValue$2(args[1])):Math.round(getNumericValue$2(args[1])*Math.pow(10,getNumericValue$2(args[2])))/Math.pow(10,getNumericValue$2(args[2]))),Sign:args=>Create$5(Math.sign(getNumericValue$2(args[1]))),Sin:args=>Create$5(Math.sin(getNumericValue$2(args[1]))),Cos:args=>Create$5(Math.cos(getNumericValue$2(args[1]))),Tan:args=>Create$5(Math.tan(getNumericValue$2(args[1]))),Sinh:args=>Create$5(Math.sinh(getNumericValue$2(args[1]))),Cosh:args=>Create$5(Math.cosh(getNumericValue$2(args[1]))),Tanh:args=>Create$5(Math.tanh(getNumericValue$2(args[1]))),Asin:args=>Create$5(Math.asin(getNumericValue$2(args[1]))),Acos:args=>Create$5(Math.acos(getNumericValue$2(args[1]))),Atan:args=>Create$5(Math.atan(getNumericValue$2(args[1]))),Pow:args=>Create$5(Math.pow(getNumericValue$2(args[1]),getNumericValue$2(args[2]))),Min:args=>Create$5(Math.min(...args.slice(1).map(getNumericValue$2))),Max:args=>Create$5(Math.max(...args.slice(1).map(getNumericValue$2))),Sqrt:args=>Create$5(Math.sqrt(getNumericValue$2(args[1]))),Log:args=>Create$5(2===args.length?Math.log(getNumericValue$2(args[1])):Math.log(getNumericValue$2(args[1]))/Math.log(getNumericValue$2(args[2]))),Log10:args=>Create$5(Math.log10(getNumericValue$2(args[1]))),Exp:args=>Create$5(Math.exp(getNumericValue$2(args[1]))),Atan2:args=>Create$5(Math.atan2(getNumericValue$2(args[1]),getNumericValue$2(args[2]))),IEEERemainder:args=>{return Create$5((dividend=getNumericValue$2(args[1]),divisor=getNumericValue$2(args[2]),dividend-divisor*Math.round(dividend/divisor)));var dividend,divisor},BigMul:args=>Create$5(getNumericValue$2(args[1])*getNumericValue$2(args[2]),"Int64",!0),Fix:args=>Create$5(Math.trunc(getNumericValue$2(args[1])),args[1].Type)};const information={IsNumeric:args=>function(v){if(IsNull(v))return False;try{return Convert$2.toDouble(v),True}catch(_a){return False}}(args[1]),IsDate:args=>function(v){try{return Convert$2.toDate(v),True}catch(_a){return False}}(args[1]),IsNothing:args=>{return v=args[1],IsNull(v)?True:False;var v},IsError:args=>(args[1],False),IsArray:args=>{return(v=args[1])&&"Object"===v.Type&&Array.isArray(v.Value)?True:False;var v}};const ISOformat={ISO_8601:!0},Locale=localeProvider.getLocale("en-US").DateTime.FormatInfo;function getTimeValue(v){if(isVariant$2(v))return Convert$2.toDate(v).clone();throw new Error(`Type mismatch: ${v} is not a valid value`)}function getNumericValue$1(v){if(isVariant$2(v))return Convert$2.toDouble(v);throw new Error(`Type mismatch: ${v} is not a valid number`)}function getStringValue$1(v){if(isVariant$2(v))return Convert$2.toString(v);throw new Error(`Type mismatch: ${v} is not a valid value`)}const classFunctionsImpl$1={Year:args=>Create$5(getTimeValue(args[1]).year()),Month:args=>Create$5(getTimeValue(args[1]).month()+1),Day:args=>Create$5(getTimeValue(args[1]).date()),Weekday:args=>function(dateTime,firstDayOfWeek){const firstDay=firstDayOfWeek?getNumericValue$1(firstDayOfWeek):1;if(firstDay<1||firstDay>7)throw new Error("FirstDayOfWeek is less than 1 or greater than 7");const temp=getTimeValue(dateTime).day()-firstDay+2;return Create$5(temp>0?temp:temp+7)}(args[1],args[2]),Hour:args=>Create$5(getTimeValue(args[1]).hour()),Minute:args=>Create$5(getTimeValue(args[1]).minute()),Second:args=>Create$5(getTimeValue(args[1]).second()),DateValue:args=>Create$5(getTimeValue(args[1]).startOfDay()),TimeValue:args=>Create$5(parse$5(args[1],[...dateTimeFormats,...timeFormats]).Value.getTime()),AddDays:args=>Create$5(getTimeValue(args[1]).add(getNumericValue$1(args[2]),"days")),AddHours:args=>Create$5(getTimeValue(args[1]).add(getNumericValue$1(args[2]),"hours")),AddMilliseconds:args=>Create$5(getTimeValue(args[1]).add(getNumericValue$1(args[2]),"milliseconds")),AddMinutes:args=>Create$5(getTimeValue(args[1]).add(getNumericValue$1(args[2]),"minutes")),AddMonths:args=>Create$5(getTimeValue(args[1]).add(getNumericValue$1(args[2]),"months")),AddSeconds:args=>Create$5(getTimeValue(args[1]).add(getNumericValue$1(args[2]),"seconds")),AddYears:args=>Create$5(getTimeValue(args[1]).add(getNumericValue$1(args[2]),"years"))},values={Now:()=>Create$5(dateTimeFactory_create()),TimeOfDay:()=>Create$5(dateTimeFactory_create()),Today:()=>Create$5(dateTimeFactory_create().startOfDay()),TimeString:()=>Create$5(dateTimeFactory_create().format("HH:mm:ss")),DateString:()=>Create$5(dateTimeFactory_create().format("YYYY-MM-dd")),Timer:()=>Create$5(dateTimeFactory_create().dateDiff("s",dateTimeFactory_create().startOfDay()))},functions$1=Object.assign(Object.assign(Object.assign({},values),classFunctionsImpl$1),{TimeSerial:args=>Create$5(dateTimeFactory_createFromArray([1,0,1,getNumericValue$1(args[1]),getNumericValue$1(args[2]),getNumericValue$1(args[3])]),"Date",!0),DateSerial:args=>Create$5(dateTimeFactory_createFromArray([getNumericValue$1(args[1]),getNumericValue$1(args[2])-1,getNumericValue$1(args[3]),0,0,0]),"Date",!0),MonthName:args=>function(monthVar,abbrevateVar){const month=getNumericValue$1(monthVar);if(month<1||month>12)throw new Error("Month is less than 1 or greater than 12");return Create$5((abbrevateVar&&Convert$2.toBoolean(abbrevateVar)?Locale.monthsShort:Locale.months)[month-1])}(args[1],args[2]),WeekdayName:args=>function(weekdayVar,abbrevateVar,firstDayOfWeek){const dayNumber=getNumericValue$1(weekdayVar),firstDay=firstDayOfWeek?getNumericValue$1(firstDayOfWeek):1;if(dayNumber<1||dayNumber>7)throw new Error("Weekday is less than 1 or greater than 7");if(firstDay<1||firstDay>7)throw new Error("FirstDayOfWeek is less than 1 or greater than 7");const temp=dayNumber+firstDay-1,weekday=temp>7?temp-7:temp;return Create$5((abbrevateVar&&Convert$2.toBoolean(abbrevateVar)?Locale.daysShort:Locale.days)[weekday-1])}(args[1],args[2],args[3]),Parse:args=>function(variant,format){return parse$5(variant,format?[getStringValue$1(format)]:dateTimeFormats)}(args[1],args[2]),DatePart:args=>Create$5(function(intervalVar,dateVar,firstDayOfWeek,firstWeekOfYear){const interval=getStringValue$1(intervalVar),firstDay=firstDayOfWeek?getNumericValue$1(firstDayOfWeek):void 0,firstWeek=firstWeekOfYear?getNumericValue$1(firstWeekOfYear):void 0;return getTimeValue(dateVar).datePart(interval,firstDay,firstWeek)}(args[1],args[2],args[3],args[4])),DateAdd:args=>Create$5(function(intervalVar,numberVar,dateVar){const interval=getStringValue$1(intervalVar),num=getNumericValue$1(numberVar),date=getTimeValue(dateVar);switch(interval){case"yyyy":return date.add(num,"years");case"q":return date.add(num,"quarters");case"m":return date.add(num,"months");case"y":case"d":case"w":return date.add(num,"days");case"ww":return date.add(num,"weeks");case"h":return date.add(num,"hours");case"n":return date.add(num,"minutes");case"s":return date.add(num,"seconds");default:throw new Error(`"${intervalVar.Value}" is not valid interval value for DateAdd() function`)}}(args[1],args[2],args[3])),DateDiff:args=>Create$5(function(intervalVar,date1Var,date2Var,firstDayOfWeek){const interval=getStringValue$1(intervalVar),firstDay=firstDayOfWeek?getNumericValue$1(firstDayOfWeek):void 0,date1=getTimeValue(date1Var);return getTimeValue(date2Var).dateDiff(interval,date1,firstDay)}(args[1],args[2],args[3],args[4])),Quarter:args=>Create$5(quarter(args[1])),QuarterName:args=>{return Create$5((dateVar=args[1],Locale.quarters[quarter(dateVar)-1]));var dateVar}}),classFunctions$1=mapKeys(mapValues$2(classFunctionsImpl$1,(f=>args=>f(((args,functionName)=>{if("Date"!==args[1].Type)throw new Error(`[expression evaluator] function ${functionName}() not found in ${args[1].Type}`);return args})(args,f.name)))),(key=>`.${key}`));function parse$5(str,formats){if("Date"===str.Type)return str;const value=dateTimeFactory_createFromString(getStringValue$1(str),formats,!0);if(null==value)throw new Error(`Cannot parse date "${str.Value}"`);return Create$5(value)}function quarter(dateVar){const month=getTimeValue(dateVar).month();return Math.floor(month/3)+1}const maxValue=Create$5(dateTimeFactory_createFromString("9999-12-31T23:59:59.9999999Z",[ISOformat])),minValue=Create$5(dateTimeFactory_createFromString("0001-01-01T00:00:00.0000000Z",[ISOformat])),variables=Object.assign(Object.assign(Object.assign({},values),mapKeys(values,(name=>`DateTime.${name}`))),{"DateTime.MaxValue":()=>maxValue,"DateTime.MinValue":()=>minValue});function getStringValue(v){if(isVariant$2(v))return Convert$2.toString(v);throw new Error(`Type mismatch: ${v} is not a valid value`)}function getNumericValue(v){if(isNumericVariant(v))return Convert$2.toDouble(v);throw new Error(`Type mismatch: ${v.Value} is not a number`)}const escapeSymbols$1=/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,classFunctionsImpl={Trim:args=>Create$5(getStringValue(args[1]).trim()),TrimStart:args=>Create$5(getStringValue(args[1]).replace(/^[\s\uFEFF\xA0]+/g,"")),TrimEnd:args=>Create$5(getStringValue(args[1]).replace(/[\s\uFEFF\xA0]+$/g,"")),Substring:args=>Create$5(getStringValue(args[1]).substr(getNumericValue(args[2]),args[3]?getNumericValue(args[3]):void 0)),ToLower:args=>Create$5(getStringValue(args[1]).toLowerCase()),ToUpper:args=>Create$5(getStringValue(args[1]).toUpperCase()),StartsWith:args=>Create$5(getStringValue(args[1]).startsWith(getStringValue(args[2]))),EndsWith:args=>Create$5(getStringValue(args[1]).endsWith(getStringValue(args[2]))),IndexOf:args=>Create$5(getStringValue(args[1]).indexOf(getStringValue(args[2]),args[3]?getNumericValue(args[3]):void 0)),LastIndexOf:args=>Create$5(getStringValue(args[1]).lastIndexOf(getStringValue(args[2]),args[3]?getNumericValue(args[3]):void 0)),Replace:args=>Create$5(getStringValue(args[1]).replace(new RegExp(getStringValue(args[2]).replace(escapeSymbols$1,"\\$&"),"g"),getStringValue(args[3])))},functions={Trim:classFunctionsImpl.Trim,TrimStart:classFunctionsImpl.TrimStart,TrimEnd:classFunctionsImpl.TrimEnd,Substring:classFunctionsImpl.Substring,ToLower:classFunctionsImpl.ToLower,ToUpper:classFunctionsImpl.ToUpper,StartsWith:classFunctionsImpl.StartsWith,EndsWith:classFunctionsImpl.EndsWith,LastIndexOf:classFunctionsImpl.LastIndexOf,Replace:classFunctionsImpl.Replace},classFunctions=mapKeys(mapValues$2(classFunctionsImpl,(f=>args=>f(((args,functionName)=>{if("String"!==args[1].Type)throw new Error(`[expression evaluator] function ${functionName}() not found in ${args[1].Type}`);return args})(args,f.name)))),(key=>`.${key}`));const padLeft=(value,length)=>{let str=value.toString();for(;str.length<length;)str=" "+str;return str};class Record{constructor(Index,FieldNameIndex,data){this.Index=Index,this.FieldNameIndex=FieldNameIndex,this.data=data}get Count(){return this.data.length}MakeCopy(index){return new Record(index,this.FieldNameIndex,this.data)}GetByIndex(index){const result=this.data[index];if(!result)throw new Error(`Index out of range: ${index}`);return result}GetByName(name){const fieldIndex=getValueByKey(this.FieldNameIndex,name);return void 0===fieldIndex?Null$3:this.data[fieldIndex]||Null$3}*[Symbol.iterator](){const fieldNames=Object.keys(this.FieldNameIndex);for(let i=0;i<this.data.length;i++){const key=fieldNames.find((f=>this.FieldNameIndex[f]===i))||"";yield{Key:key,Value:this.data[i]}}}}function getValueFromContainer(path,data){if(0===path.length)return Create$5(data);const id=path.shift();if(!data)return Null$3;if("value"===id&&0===path.length&&isObjectVariant(data)&&Array.isArray(data.Value))return data;if(isVariant$2(data)){const propertyValue=function(propertyName,obj){const propertyNameLower=propertyName.toLowerCase();switch(obj.Type){case"String":if("length"===propertyNameLower)return Create$5(Convert$2.toString(obj).length);break;case"Object":if("length"===propertyNameLower&&Array.isArray(obj.Value))return Create$5(obj.Value.length)}return}(id,data);if(propertyValue)return propertyValue}const container=isObjectVariant(data)?data.Value:data;if(container instanceof Record){const value=container.GetByName(id);return value?getValueFromContainer(path,Create$5({Value:value,Name:id})):Null$3}return getValueFromContainer(path,Create$5("value"===id&&"Value"in container?container.Value:"name"===id&&"Name"in container?container.Name:"type"===id&&"Type"in container?container.Type:getValueByKey(container,id)))}Record.Empty=new Record(0,{},[]);const checkArgsCount=(count,args,result)=>{if(args.length!==count)throw new Error(`[syntax error] ${1===count?"u":"bi"}nary operator used as unary`);return result},boolOpArg=v=>{if("String"===v.Type)throw new Error(`Invalid operation: ${v.Value} is not boolean`);return Convert$2.toBoolean(v)},operators=mapValues$2({"^":{priority:3.6,calc:args=>checkArgsCount(2,args,Operators.Pow(args[0],args[1]))},"*":{priority:3.5,calc:args=>checkArgsCount(2,args,Operators.Mult(args[0],args[1]))},"/":{priority:3.5,calc:args=>checkArgsCount(2,args,Operators.Divide(args[0],args[1]))},"\\":{priority:3.4,calc:args=>checkArgsCount(2,args,Operators.IntegralDivide(args[0],args[1]))},mod:{priority:3.3,calc:args=>checkArgsCount(2,args,Operators.Mod(args[0],args[1]))},"+":{priority:3.2,calc:args=>1===args.length?Operators.UnaryPlus(args[0]):Operators.Plus(args[0],args[1])},"-":{priority:3.2,calc:args=>1===args.length?Operators.UnaryMinus(args[0]):Operators.Minus(args[0],args[1])},"&":{priority:3.1,calc:args=>checkArgsCount(2,args,Create$5(`${Convert$2.toString(args[0])}${Convert$2.toString(args[1])}`))},"<<":{priority:3,calc:args=>checkArgsCount(2,args,Operators.BitwiseShiftLeft(args[0],args[1]))},">>":{priority:3,calc:args=>checkArgsCount(2,args,Operators.BitwiseShiftRight(args[0],args[1]))},"<":{priority:2,calc:args=>checkArgsCount(2,args,Comparison$1.LessThan(args[0],args[1]))},">":{priority:2,calc:args=>checkArgsCount(2,args,Comparison$1.GreaterThan(args[0],args[1]))},"<=":{priority:2,calc:args=>checkArgsCount(2,args,Comparison$1.LessOrEqual(args[0],args[1]))},">=":{priority:2,calc:args=>checkArgsCount(2,args,Comparison$1.GreaterOrEqual(args[0],args[1]))},"=":{priority:2,calc:args=>checkArgsCount(2,args,Comparison$1.Equals(args[0],args[1]))},"<>":{priority:2,calc:args=>checkArgsCount(2,args,Comparison$1.NotEquals(args[0],args[1]))},is:{priority:2,calc:args=>checkArgsCount(2,args,Comparison$1.Equals(args[0],args[1]))},like:{priority:2,calc:args=>{if(2!==args.length)throw new Error("[syntax error] binary operator LIKE is used as unary");if(args.some((a=>"String"!==a.Type)))throw new Error("[expression evaluator] invalid operation: LIKE arguments must be string");return function(pattern){let regex="^",isGroup=!1,isEmptyGroup=!1;for(let i=0;i<pattern.length;i++){const c=pattern[i];"]"!==c?(isEmptyGroup=!1,"["!==c?regex+="?"!==c||isGroup?"*"!==c||isGroup?"#"!==c||isGroup?(".{}()?/\\*+^$".indexOf(c)>-1?"\\":"")+c:"\\d":".*":".":isGroup?regex+="\\"+c:(regex+=c,isGroup=!0,isEmptyGroup=!0,"!"===pattern[i+1]&&(regex+="^",isEmptyGroup=!1,i++))):isGroup?(regex+=c,isGroup=!1,isEmptyGroup&&(regex=regex.substr(0,regex.length-2))):(regex+="\\"+c,isEmptyGroup=!1)}return regex+="$",new RegExp(regex)}(Convert$2.toString(args[1])).test(Convert$2.toString(args[0]))?True:False}},not:{priority:1.3,calc:args=>checkArgsCount(1,args,Operators.Not(args[0]))},and:{priority:1.2,calc:args=>checkArgsCount(2,args,Operators.And(args[0],args[1]))},andalso:{priority:1.2,calc:args=>checkArgsCount(2,args,boolOpArg(args[0])&&boolOpArg(args[1])?True:False)},or:{priority:1.1,calc:args=>checkArgsCount(2,args,Operators.Or(args[0],args[1]))},orelse:{priority:1.1,calc:args=>checkArgsCount(2,args,boolOpArg(args[0])||boolOpArg(args[1])?True:False)},xor:{priority:1,calc:args=>checkArgsCount(2,args,Operators.Xor(args[0],args[1]))}},(o=>({priority:o.priority,calc:(ctx,args)=>o.calc(args.map((arg=>arg.Eval(ctx))))}))),mapFunctions=f=>(ctx,args)=>f(args.map((arg=>arg.Eval(ctx)))),toStringFunction=(ctx,args)=>{if(null!==args[0]&&void 0!==args[0]){const argsValues=args.map((a=>a.Eval(ctx)));return Create$5(formatValue(argsValues[0],null,null!==argsValues[1]&&void 0!==argsValues[1]?Convert$2.toString(argsValues[1]):null))}return""},containsFunction=args=>Create$5(Convert$2.toString(args[0]).indexOf(Convert$2.toString(args[1]))>=0),predefinedFunctions=mapKeys(Object.assign(Object.assign({},mapValues$2(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({InStr:args=>Create$5(Convert$2.toString(args[0]).indexOf(Convert$2.toString(args[1]))+1),Contains:containsFunction,".Contains":containsFunction,".GetLength":args=>{if("Object"!==args[0].Type&&!Array.isArray(args[0].Value))throw new Error(`[expression evaluator] ${args[0].Value} is not array`);if(args[1]&&0!==Convert$2.toInteger(args[1]))throw new Error("[expression evaluator] multi-dimensional arrays not supported");return Create$5(args[0].Value.length)},Len:args=>IsNull(args[0])?Null$3:Create$5(Convert$2.toString(args[0]).length),Partition:function(args){if(4!==args.length)throw new Error("[syntax error] Partition function: must have 4 arguments");if(args.some(IsNull))return Null$3;const number=Convert$2.toDouble(args[0]),start=Convert$2.toInteger(args[1]),stop=Convert$2.toInteger(args[2]),interval=Convert$2.toInteger(args[3]);if(start<0)throw new Error("[expression evaluator] Partition function: Start cannot be less than 0");if(stop<=start)throw new Error("[expression evaluator] Partition function: Stop cannot be less than or equal to Start");if(interval<1)throw new Error("[expression evaluator] Partition function: Interval cannot be less than 1");const digits=stop.toString().length;if(number<start)return Create$5(`:${padLeft(start-1,digits)}`);if(number>stop)return Create$5(`${padLeft(stop+1,digits)}:`);const first=Math.trunc((number-start)/interval)*interval+start;return Create$5(`${padLeft(first,digits)}:${padLeft(first+interval-1,digits)}`)},Chr:args=>{const charCode=Convert$2.toInteger(args[0]);if(charCode>=0&&charCode<=255)return Create$5(String.fromCharCode(charCode));throw new Error(`[expression evaluator] Char code must be from 0 to 255 but was ${charCode}`)},Join:args=>{if("Object"!==args[0].Type)return Create$5(Convert$2.toString(args[0]));const values=args[0].Value;if(!Array.isArray(values))throw new Error("First argument of Join() function must be array");const delimeter=args.length>1?Convert$2.toString(args[1]):" ";return Create$5(values.map((value=>Convert$2.toString(Create$5(value)))).join(delimeter))},Split:args=>{const expression=Convert$2.toString(args[0]),delimiter=args.length>1?Convert$2.toString(args[1]):" ",limit=args.length>2?Convert$2.toInteger(args[2]):-1;if(0===expression.length)return Create$5([]);if(0===delimiter.length)return Create$5([expression]);return Create$5(-1===limit?expression.split(delimiter):expression.split(delimiter,limit))},CStr:args=>{const arg=args[0];if(isTimeVariant(arg)){if(1===arg.Value.year()&&0===arg.Value.month()&&1===arg.Value.date())return Create$5(formatValue(arg,null,"T"));if(0===arg.Value.hour()&&0===arg.Value.minute()&&0===arg.Value.second())return Create$5(formatValue(arg,null,"d"))}return Create$5(Convert$2.toString(arg))},IndexOf:args=>{const arg=args[0];switch(arg.Type){case"String":return classFunctions[".IndexOf"]([Null$3,...args]);case"Object":if(Array.isArray(arg.Value))return function(args){var _a,_b;const arr=args[0].Value,target=args[1],start=null!==(_b=null===(_a=args[2])||void 0===_a?void 0:_a.Value)&&void 0!==_b?_b:0;if("number"!=typeof start)throw new Error("[expression evaluator] start argument of IndexOf function must be number");for(let i=start;i<arr.length;i++)if(Comparison$1.Equals(Create$5(arr[i]),target).Value)return Create$5(i);return Create$5(-1)}(args);default:throw new Error("[expression evaluator] IndexOf function must be called on String or Array")}}},mapValues$2(convert$1,(f=>args=>f([staticLibs.Convert,...args])))),mapValues$2(math,(f=>args=>f([staticLibs.Math,...args])))),mapValues$2(information,(f=>args=>f([staticLibs.Information,...args])))),mapValues$2(functions$1,(f=>args=>f([staticLibs.DateTime,...args])))),mapValues$2(classFunctions$1,(f=>args=>f([staticLibs.DateTime,...args])))),mapValues$2(functions,(f=>args=>f([staticLibs.String,...args])))),mapValues$2(classFunctions,(f=>args=>f([staticLibs.String,...args])))),mapFunctions)),{Format:toStringFunction,ToString:toStringFunction,".ToString":toStringFunction,".Item":(ctx,args)=>{if(2!==args.length)throw new Error("[syntax error] Item function must have 1 argument");const source=args[0].Eval(ctx),key=`${args[1].Eval(ctx).Value}`.toLowerCase();if(!key)throw new Error("[expression evaluator] Item function argument must be not empty");if(!isObjectVariant(source)&&!isStringVariant(source))throw new Error("[expression evaluator] Item function must be called on container");return getValueFromContainer([key],source)},Fields:(ctx,args)=>{if(!ctx.Data.fields)throw new Error("[expression evaluator] Fields collection is not provided");const fieldName=`${args[0].Eval(ctx).Value}`.toLowerCase();if(!fieldName)throw new Error("[expression evaluator] Field name must be not empty");return getValueFromContainer([fieldName],ctx.Data.fields)},IIf:(ctx,args)=>Convert$2.toBoolean(args[0].Eval(ctx))?args[1].Eval(ctx):args[2].Eval(ctx),Choose:(ctx,args)=>args[Convert$2.toInteger(args[0].Eval(ctx))].Eval(ctx),Switch:(ctx,args)=>{for(let i=0;i<args.length;i+=2)if(!0===Convert$2.toBoolean(args[i].Eval(ctx)))return args[i+1].Eval(ctx);return Null$3}}),(name=>name.toLowerCase())),staticLibs=mapKeys({Math:mapKeys(mapValues$2(math,mapFunctions),(name=>name.toLowerCase())),Convert:mapKeys(mapValues$2(convert$1,mapFunctions),(name=>name.toLowerCase())),Information:mapKeys(mapValues$2(information,mapFunctions),(name=>name.toLowerCase())),DateTime:mapKeys(mapValues$2(functions$1,mapFunctions),(name=>name.toLowerCase())),String:mapKeys(mapValues$2(classFunctions,mapFunctions),(name=>name.toLowerCase().replace(/^\./,"")))},(name=>name.toLowerCase())),predefinedConstants=mapKeys(Object.assign(Object.assign({},mapValues$2(staticLibs,(lib=>Create$5(lib)))),{E:Create$5(Math.E),PI:Create$5(Math.PI),"Math.E":Create$5(Math.E),"Math.PI":Create$5(Math.PI),Nothing:Null$3,Null:Null$3,"DBNull.Value":DBNull,"System.DBNull.Value":DBNull,"Double.MinValue":Create$5(-Infinity),"Double.MaxValue":Create$5(17976931348623157e292),"Decimal.MinValue":Create$5(-7922816251426434e13),"Decimal.MaxValue":Create$5(7922816251426434e13),"Int32.MinValue":Create$5(-2147483648),"Int32.MaxValue":Create$5(2147483647),vbCrLf:Create$5("\r\n")}),(name=>name.toLowerCase())),predefinedVariables=mapKeys(Object.assign({},variables),(name=>name.toLowerCase()));let customCodeStoreInstance={};const CustomCodeInternal_getFunctions=()=>customCodeStoreInstance,CustomCodeInternal_registerFunctions=customCode=>{customCodeStoreInstance=Object.assign(Object.assign({},customCodeStoreInstance),customCode)};function parse$4(stringTokens,functions,constants,variables,unescapeQuotes=!0){const peek=a=>a[a.length-1],stack=[],wereValues=[],argCount=[];let previousToken;return function(tokens){const remixedTokensInt=[],remixedTokens=[];for(let i=0;i<tokens.length;i++){const token=tokens[i];"variable"===token.type&&".!".includes(token.value[0])?(remixedTokensInt.push({type:"function",value:".item",arity:1,raw:token.raw}),remixedTokensInt.push({type:"left_bracket",value:"("}),remixedTokensInt.push({type:"value",value:Create$5(token.value.replace(/^[\.!]/,"")),raw:token.raw}),remixedTokensInt.push({type:"right_bracket",value:")"})):remixedTokensInt.push(token)}for(let i=0;i<remixedTokensInt.length-1;i++){const token=remixedTokensInt[i];if("function"===token.type&&".!".includes(token.value[0])){const parents=[];let stop=!1,brackets=0;for(;!stop;){const current=remixedTokens.pop();if(!current){stop=!0;continue}"left_bracket"===current.type?brackets++:"right_bracket"===current.type&&brackets--;const next=remixedTokens[remixedTokens.length-1];0!==brackets||next&&"function"===next.type||(stop=!0),parents.push(current)}parents.reverse(),remixedTokens.push(remixedTokensInt[i]),remixedTokens.push(remixedTokensInt[i+1]),parents.length&&(remixedTokens.push(...parents),"right_bracket"!==remixedTokensInt[i+2].type&&remixedTokens.push({type:"separator",value:","})),i++}else remixedTokens.push(token)}return remixedTokensInt.length>0&&remixedTokens.push(remixedTokensInt[remixedTokensInt.length-1]),remixedTokens}(stringTokens.map(((tokenName,i,a)=>function(lexem,nextLexem,functions,constants,variables,unescapeQuotes=!0){const tokenNameLower=lexem.token.toLowerCase(),wrap=type=>{let value=lexem.token;("variable"===type||type.includes("function"))&&(value=value.replace(/\!/g,"."));const valueFloat=parseFloat(value);if(isNaN(valueFloat)){if("true"===tokenNameLower||"false"===tokenNameLower)value="true"===tokenNameLower;else if(lexem&&'"'===lexem.token[0])value=lexem.token.replace(/^"|"$/g,""),unescapeQuotes&&(value=value.replace(/""/g,'"'));else if(lexem&&"#"===lexem.token[0]){const date=dateTimeFactory_createFromString(lexem.token.replace(/^#|#$/g,""),dateTimeFormats,!0);value=null!=date?date:lexem.token}}else value=valueFloat;switch(type){case"value":return{value:Create$5(value),type:type,raw:lexem};case"operator":case"function":return{value:value.toLowerCase(),type:type,arity:0,raw:lexem};default:return{value:value.toLowerCase(),type:type,raw:lexem}}};return(t=>null==t||"string"!=typeof t||!(isNaN(parseFloat(t))||!isFinite(parseFloat(t)))||"true"===t.toLowerCase()||"false"===t.toLowerCase()||t.length>0&&('"'===t[0]||"#"===t[0]))(lexem.token)?wrap("value"):tokenNameLower in constants?wrap("constant"):!(tokenNameLower.replace(/\!/g,".")in functions)||tokenNameLower.replace(/\!/g,".")in variables||nextLexem&&"("===nextLexem.token||nextLexem&&"."===nextLexem.token[0]?tokenNameLower in operators?wrap("operator"):","===lexem.token?wrap("separator"):"("===lexem.token?wrap("left_bracket"):")"===lexem.token?wrap("right_bracket"):nextLexem&&"("===nextLexem.token?wrap("function"):wrap("variable"):wrap("value")}(tokenName,a[i+1],functions,constants,variables,unescapeQuotes)))).reduce(((output,t,i)=>{if(0===i&&"="===t.value)return output;const token=t;switch(token.type){case"variable":case"constant":case"value":output.push(token),wereValues.length>0&&(wereValues.pop(),wereValues.push(!0));break;case"function":token.arity=1,stack.push(token),argCount.push(0),wereValues.length>0&&(wereValues.pop(),wereValues.push(!0)),wereValues.push(!1);break;case"separator":for(;stack.length>0&&"left_bracket"!==peek(stack).type;){const v=stack.pop();void 0!==v&&output.push(v)}if(wereValues.pop()){let a=argCount.pop();void 0!==a&&(a++,argCount.push(a))}wereValues.push(!1);break;case"operator":if(previousToken&&"operator"!==previousToken.type&&"left_bracket"!==previousToken.type&&"separator"!==previousToken.type)for(token.arity=2;stack.length>0&&"operator"===peek(stack).type&&operators[token.value.toString().toLowerCase()].priority<=operators[peek(stack).value.toString().toLowerCase()].priority;){const v=stack.pop();void 0!==v&&output.push(v)}else token.arity=1;stack.push(token);break;case"left_bracket":if(previousToken&&"variable"===previousToken.type)throw new Error(`[expression compiler] Syntax error at token: ${previousToken.value.toString()}`);stack.push(token);break;case"right_bracket":for(;stack.length>0&&"left_bracket"!==peek(stack).type;){const v=stack.pop();void 0!==v&&output.push(v)}if(stack.pop(),stack.length>0&&"function"===peek(stack).type){const f=stack.pop();let a=argCount.pop();wereValues.pop()&&void 0!==a&&a++,void 0!==f&&void 0!==a&&(f.arity=a,output.push(f))}}return previousToken=token,output}),[]).concat(stack.reverse())}function getValue(name,values,specialVariables){const path=name.split(".");if(specialVariables){const byFullName=getValueByKey(specialVariables,name);if(byFullName)return byFullName(values,name);const byRootName=getValueByKey(specialVariables,path[0]);if(byRootName)return byRootName(values,name)}return getValueFromContainer(name.split("."),values.Data)}const makeExpressionNode=(evaluate,children,token)=>new ExpressionNode(evaluate,children,token);function createTreeBuilder(customFunctions,customVariables,customConstants){const functions=mapKeysDeep$1(Object.assign(Object.assign({},predefinedFunctions),customFunctions),(key=>key.toLowerCase())),constants=mapKeysDeep$1(Object.assign(Object.assign({},predefinedConstants),customConstants),(key=>key.toLowerCase())),variables=mapKeysDeep$1(Object.assign(Object.assign({},predefinedVariables),customVariables),(key=>key.toLowerCase()));return expression=>{if(expression&&"string"==typeof expression&&expression.trim().startsWith("=")){const constantsWithCustomCode=Object.assign(Object.assign({},constants),function(){const mappedFunctions={};return Object.entries(customCodeStoreInstance).forEach((([functionName,func])=>{mappedFunctions[functionName.toLowerCase()]=(ctx,args)=>{const evaluatedArgs=args.slice(1).map((arg=>arg.Eval(ctx).Value)).map((arg=>Array.isArray(arg)?arg.map((value=>isVariant$2(value)?value.Value:value)):arg));let result=null;try{result=func(...evaluatedArgs)}catch(e){throw new Error(`[custom code expression]: Code.${functionName}()\nexception: ${e instanceof Error?e.message:`${e}`}`)}switch(typeof result){case"boolean":case"number":case"string":case"undefined":return Tools.Variant.Create(result);case"object":if(Array.isArray(result))return Tools.Variant.Create(result.map((value=>Tools.Variant.Create(value))));if(result instanceof Promise)throw new Error(`[custom code expression]: Code.${functionName}()\nasync functions are not supported`);return Tools.Variant.Create(result);default:throw new Error(`[custom code expression]: Code.${functionName}()\nunsupported return value type: ${typeof result}`)}}})),{code:Tools.Variant.Create(mappedFunctions)}}());return function(rpnTokens,functions,constants,specialVariables){const stack=[];for(let i=0;i<rpnTokens.length;i++){const token=rpnTokens[i];switch(token.type){case"value":stack.push(makeExpressionNode((()=>token.value),[],token));break;case"variable":stack.push(makeExpressionNode((ctx=>{const value=getValue(token.value,ctx,specialVariables);if(void 0===value)throw new Error(`[expression evaluator] Variable value not provided: ${token.value}`);return value}),[],token));break;case"constant":stack.push(makeExpressionNode((()=>constants[token.value.toLowerCase()]),[],token));break;case"function":const functionArgs=[];for(let j=0;j<token.arity;j++)functionArgs.push(stack.pop());functionArgs.reverse();const functionName=token.value;functionName.startsWith(".")?stack.push(makeExpressionNode(((ctx,args)=>{const firstArg=args[0]&&args[0].Eval(ctx);let func="Object"===firstArg.Type&&getValueByKey(firstArg.Value,functionName.replace(/^\./,""));if(!func||"function"!=typeof func){if(!functions[functionName])throw new Error(`[expression evaluator] Function ${functionName} not found in ${args[0]&&args[0].Token.value}`);func=functions[functionName]}return func(ctx,args)}),functionArgs,token)):stack.push(makeExpressionNode(((ctx,fa)=>{if(!functions[functionName])throw new Error(`[expression compiler] Function not found: ${functionName}`);return functions[functionName](ctx,fa)}),functionArgs,token));break;case"operator":const operatorArgs=[];for(let j=0;j<token.arity;j++)operatorArgs.push(stack.pop());operatorArgs.reverse();const operatorName=token.value;if(!operators[operatorName])throw new Error(`[expression compiler] Operator not found: ${token.value}`);stack.push(makeExpressionNode(((ctx,args)=>operators[operatorName].calc(ctx,args)),operatorArgs,token));break;default:throw new Error(`[expression compiler] Unexpected token type: ${token.type}`)}}if(1===stack.length)return stack[0];throw new Error("[expression compiler] Compilation error")}(parse$4(tokenize$1(expression),functions,constantsWithCustomCode,variables),functions,constantsWithCustomCode,variables)}return makeExpressionNode((()=>Create$5(expression)),[],{type:"value",value:Create$5(expression)})}}class RecordSet{constructor(Records=[],getAggregateDataProvider=null){this.Records=Records,this.getAggregateDataProvider=getAggregateDataProvider}get AggregateDataProvider(){return this._aggregateDataProvider||(this._aggregateDataProvider=null!==this.getAggregateDataProvider?this.getAggregateDataProvider():null)}FirstOrDefault(){for(let record of this.Records)return record;return Record.Empty}Any(){for(let record of this.Records)return!!record;return!1}*[Symbol.iterator](){for(let record of this.Records)yield record}}RecordSet.Empty=new RecordSet([]);const Tools={tokenize:tokenize$1,mergeTokens:function(tokens){return tokens.reduce(((p,c)=>p+(c&&".!".includes(c[0])||!p?"":" ")+c),"")},Variant:VariantUtils,replaceNode:function replaceNode(tree,predicate,replace){return predicate(tree)?replace(tree):tree.ReplaceChildren(tree.Children.map((n=>replaceNode(n,predicate,replace))))},containsNode:function containsNode(tree,predicate){return!!predicate(tree)||tree.Children.map((n=>containsNode(n,predicate))).filter((n=>!0===n)).length>0},getValueByKey:getValueByKey},emptyCtx={Data:{}};function Format(value,locale,format){try{return formatValue(value,locale,format)}catch(error){return console.warn(error.message),"ERROR!"}}function createCompiler(customFunctions,customVariables,customConstants){const treeBuilder=createTreeBuilder(customFunctions,customVariables,customConstants);return expression=>{const expressionTree=treeBuilder(expression);return(rootNode=expressionTree).Contains(null,"variable")||rootNode.Contains(null,"function")?ctx=>expressionTree.Eval(ctx):expressionTree.Eval(emptyCtx);var rootNode}}function LazyMap(source,mapFunction){return{*[Symbol.iterator](){let index=0;for(let item of source)yield mapFunction(item,index),index++}}}function LazyMapMany(source,mapFunction){return{*[Symbol.iterator](){for(let item of source)yield*mapFunction(item)}}}function LazyFilter(source,predicate){return{*[Symbol.iterator](){for(let item of source)predicate(item)&&(yield item)}}}function IterableOrderBy(source,keySelector,comparer){return{*[Symbol.iterator](){for(let item of Array.from(source).sort(((a,b)=>comparer(keySelector(a),keySelector(b)))))yield item}}}function LazyZipEx(first,second,selector){return{*[Symbol.iterator](){let index=0;const it1=(first||[])[Symbol.iterator](),it2=(second||[])[Symbol.iterator]();let r1=it1.next(),r2=it2.next();for(;!r1.done&&!r2.done;)yield selector(index++,r1.value,r2.value),r1=it1.next(),r2=it2.next()}}}function LazyTakeWhile(source,predicate){return{*[Symbol.iterator](){for(let item of source){if(!predicate(item))return;yield item}}}}function IterableFirst(iterable){if(!iterable)return null;for(let item of iterable)return item;return null}function IterableLast(iterable){if(!iterable)return null;let lastItem=null;for(let item of iterable)lastItem=item;return lastItem}function IterableAny(iterable,predicate){if(!iterable)return!1;for(let item of iterable)if(!predicate||predicate(item))return!0;return!1}function IterableFind(iterable,predicate){let index=0;for(let item of iterable){if(predicate(item))return{Item:item,Index:index};index++}return{Item:null,Index:-1}}function IterableToArray(iterable){return Array.from(iterable)}function IterableGroupBy(source,keyFunction){const groups=new Map;for(let item of source){const key=keyFunction(item);groups.has(key)?groups.get(key).push(item):groups.set(key,[item])}return{*[Symbol.iterator](){for(let group of groups.entries())yield group}}}function IterableCount(iterable){let count=0;for(let _ of iterable)count++;return count}function Memoize$2(iterable){const iterator=iterable[Symbol.iterator](),cache=[];return{*[Symbol.iterator](){let index=-1;for(;;)if(index++,index<cache.length)yield cache[index];else{const next=iterator.next();if(next.done)return;cache[index]=next.value,yield next.value}}}}function toMemoizeList(source){const _list=[],_enumerator=source[Symbol.iterator]();let _cached=!1;function*getIterator(){if(_cached){for(const item of _list)yield item;return}let index=0;for(;;)if(index<_list.length)yield _list[index++];else if(cacheItem(),index<_list.length)yield _list[index++];else if(_cached)return}function cacheItem(){if(_cached)return;const next=_enumerator.next();next.done?_cached=!0:_list.push(next.value)}function count(){return _cached?_list.length:IterableCount({[Symbol.iterator]:getIterator})}return{getItem:function(i){if(_cached||i<_list.length)return _list[i];for(;;){if(cacheItem(),i<_list.length)return _list[i];if(_cached)break}throw new Error('ArgumentOutOfRangeException: "index"')},get length(){return count()},[Symbol.iterator]:getIterator}}var DataTree;!function(DataTree){DataTree.IsTablix=dataRegion=>!!(dataRegion&&dataRegion.Body&&dataRegion.ColumnMembers&&dataRegion.RowMembers),DataTree.IsList=dataRegion=>!!dataRegion&&!!dataRegion.Groups,DataTree.IsEmpty=scope=>!(scope&&(scope.Regions&&0!==scope.Regions.length||scope["@"]&&0!==scope["@"].length)),DataTree.Makers={Scope:(values,regions,id=0)=>({Id:id,"@":values,get Regions(){return"function"==typeof regions&&(regions=regions()),regions||[]}}),List:(scope,groups,name=null)=>{let groupsValue=null;return{Name:name,Scope:scope,get Groups(){return groupsValue||(groupsValue=("function"==typeof groups?toMemoizeList(groups()):groups)||[]),groupsValue}}},TablixMember:(header,isCollection,id,members)=>{let membersValue=null;return{Header:header||{"@":[],Regions:[],Id:0},Id:id>-1?id:void 0,IsCollection:isCollection,get Members(){return membersValue||(membersValue=("function"==typeof members?toMemoizeList(members()):members)||[]),membersValue}}},TablixRow:cells=>({Cells:cells}),Tablix:(corner,columnMembers,rowMembers,body,name=null)=>{let bodyValue=null;return{Scope:corner,ColumnMembers:columnMembers,RowMembers:rowMembers,Name:name,get Body(){return bodyValue||(bodyValue=("function"==typeof body?toMemoizeList(body()):body)||[]),bodyValue}}}}}(DataTree||(DataTree={}));const GetCollectionItem$1=(collection,index)=>Array.isArray(collection)?collection[index]:collection.getItem(index);var Def;!function(Def){Def.EmptyContent={Fields:[],Regions:[]},Def.IsEmptyContent=content=>!(content.Fields&&0!==content.Fields.length||content.Regions&&0!==content.Regions.length),Def.Makers={Report:(name,content)=>({type:"report",Name:name,Content:content,Filters:[]}),DataSet:(name,filters,content,fieldNames=[],parameters=[])=>({type:"dataset",Name:name,Filters:filters,Content:content,FieldNames:fieldNames,Parameters:parameters}),Parameter:(name,value)=>({Name:name,Value:value}),SimpleRegion:(name,filters,content)=>({type:"simpleregion",Name:name,Filters:filters,Content:content}),Content:(fields,regions=[])=>({Fields:fields,Regions:regions}),ContentEmpty:{Fields:[],Regions:[]},List:(name,content,filters,group,sort,groupContent,hasEmptyGroups)=>{const list={type:"list",Name:name,Filters:filters,Sort:sort,Content:content,GroupContent:groupContent,Group:group};return hasEmptyGroups&&(list.HandleEmptyGroups=hasEmptyGroups),list},Sort:(expression,direction)=>({Expression:expression,Direction:direction}),Filter:(expression,op,values)=>({Expression:expression,Op:op,Values:values}),Group:(name,groupExpressions,filters,parent="")=>({Name:name,GroupExpressions:groupExpressions||[],Filters:filters||[],Parent:parent}),Subreport:(name,report,parameters,content)=>({type:"subreport",Name:name,Filters:[],Content:content,Report:report,Parameters:parameters}),Tablix:(name,filters,columnMembers,rowMembers,content,body,sorts=null)=>({type:"tablix",Name:name,Filters:filters||[],Content:content||Def.EmptyContent,ColumnMembers:columnMembers||[],RowMembers:rowMembers||[],Body:body||[],Sorts:sorts}),TablixMember:(group,sort,header,members)=>({Group:group,Sort:sort,Header:header,Members:members}),TablixRow:cells=>({Cells:cells||[]})}}(Def||(Def={}));const AggregateFunctionNames=["Sum","Avg","Max","Min","Count","CountDistinct","CountRows","StDev","StDevP","Var","VarP","First","Last","Aggregate","Median","Mode","DistinctSum","AggregateIf","ToArray"],AggregateFunctionNamesLower=AggregateFunctionNames.map((f=>f.toLowerCase()));function ParseAggregateFunction(functionName){const index=AggregateFunctionNamesLower.indexOf(functionName.toLowerCase().trim());return index<0?"Empty":AggregateFunctionNames[index]}const map$4=transform=>function*(source){let counter=0;for(const item of source)yield transform(item,counter++)},filter$4=predicate=>function*(source){for(const item of source)predicate(item)&&(yield item)};function first$2(source){for(let item of source)return item;return null}function last$1(source){let lastItem=null;for(let item of source)lastItem=item;return lastItem}function any$1(source){for(let _ of source)return!0;return!1}const zip$3=selector=>function*(first,second){let index=0;const it1=(first||[])[Symbol.iterator](),it2=(second||[])[Symbol.iterator]();let r1=it1.next(),r2=it2.next();for(;!r1.done&&!r2.done;)yield selector(r1.value,r2.value,index++),r1=it1.next(),r2=it2.next()},zipTuple$2=zip$3(((f,t)=>[f,t])),asIndexed$1=map$4(((item,index)=>({index:index,item:item}))),toArray$1=Array.from;const iterable$2={map:map$4,mapMany:transform=>function*(source){for(let item of source)yield*transform(item)},filter:filter$4,first:first$2,last:last$1,any:any$1,findFirst:predicate=>source=>first$2(filter$4(predicate)(source)),findLast:predicate=>source=>last$1(filter$4(predicate)(source)),findAny:predicate=>source=>any$1(filter$4(predicate)(source)),zip:zip$3,zipTuple:zipTuple$2,asIndexed:asIndexed$1,orderBy:(keySelector,comparer)=>function*(source){for(let item of Array.from(source).sort(((a,b)=>comparer(keySelector(a),keySelector(b)))))yield item},takeWhile:predicate=>function*(source){for(let item of source){if(!predicate(item))return;yield item}},toArray:toArray$1,groupBy:keyFunction=>function*(source){const groups=new Map;for(let item of source){const key=keyFunction(item);groups.has(key)?groups.get(key).push(item):groups.set(key,[item])}for(let group of groups.entries())yield group},count:function(source){let count=0;for(let _ of source)count++;return count},memoize:function*(iterable){const iterator=iterable[Symbol.iterator](),cache=[];let index=-1;for(;;)if(index++,index<cache.length)yield cache[index];else{const next=iterator.next();if(next.done)return;cache[index]=next.value,yield next.value}},skip:skipCount=>function*(source){let counter=0;for(const item of source)counter++>=skipCount&&(yield item)}};class MapEx{constructor(comparer=((a,b)=>a===b)){this.comparer=comparer,this.map=new Map}hasKey(key){return null!==this.getKey(key)}set(key,value){const existingKey=this.getKey(key);this.map.set(null!==existingKey?existingKey:key,value)}get(key){const existingKey=this.getKey(key);return existingKey&&this.map.get(existingKey)||null}entries(){return this.map.entries()}values(){return this.map.values()}clear(){this.map.clear()}size(){return this.map.size}getKey(key){for(const v of this.map.keys())if(this.comparer(v,key))return v;return null}}function isNotNull$2(x){return null!==x}function mapDictionary$1(d1,map){return Object.keys(d1).reduce(((res,pName)=>{const val=d1[pName];return res[pName]=map(val,pName),res}),{})}class VariantSet{constructor(){this._values=[]}has(value){for(let v of this._values)if(Tools.Variant.Comparison.Equals(v,value).Value)return!0;return!1}add(value){this.has(value)||this._values.push(value)}values(){return this._values}size(){return this._values.length}clear(){this._values=[]}}class VariantMap extends MapEx{constructor(){super(((a,b)=>Tools.Variant.Comparison.Equals(a,b).Value))}}const Create$4=Tools.Variant.Create,Null$2=Tools.Variant.Null,Zero$2=Tools.Variant.Zero,op=Tools.Variant.Operators,con=Tools.Variant.Convert,checkAggrType=(aggr,fn)=>{if(!aggr)throw new Error("incompatible aggregates combine: aggregate is null");if(aggr.Function!==fn)throw new Error(`incompatible aggregates combine: "${fn}" and "${aggr.Function}"`)};function MakeAggregate(aggrFunc){switch(aggrFunc){case"AggregateIf":return makeAggregateIf();case"Avg":return makeAverage();case"Count":return makeCount();case"CountDistinct":return makeCountDistinct();case"CountRows":return makeCountRows();case"DistinctSum":return makeDistinctSum();case"First":return makeFirst();case"Last":return makeLast();case"Max":return makeMax();case"Median":return makeMedian();case"Min":return makeMin();case"Mode":return makeMode();case"StDev":return makeStDev();case"StDevP":return makeStDevP();case"Sum":return makeSum();case"ToArray":return makeToArray();case"Var":return makeVar();case"VarP":return makeVarP();case"Aggregate":default:return{Function:"Empty",GetValue:()=>Tools.Variant.Null,Accumulate:()=>{},Combine:aggregate=>(checkAggrType(aggregate,"Empty"),aggregate),GetState:()=>[],SetState:()=>{}}}}function makeFirst(){let value=Null$2;return{Function:"First",GetValue:()=>value,Accumulate:arg=>{"Null"===value.Type&&arg[0]&&(value=arg[0])},Combine:aggregate=>{checkAggrType(aggregate,"First");const newAggr=makeFirst();return newAggr.SetState(["Null"===value.Type?aggregate.GetState()[0]:value]),newAggr},GetState:()=>"Null"===value.Type?[]:[value],SetState:values=>{values.length>0&&(value=values[0])}}}function makeLast(){let value=Null$2;return{Function:"Last",GetValue:()=>value,Accumulate:arg=>{arg[0]&&(value=arg[0])},Combine:aggregate=>{checkAggrType(aggregate,"Last");const newAggr=makeLast(),v=aggregate.GetState()[0];return newAggr.SetState(["Null"===v.Type?value:v]),newAggr},GetState:()=>"Null"===value.Type?[]:[value],SetState:values=>{values.length>0&&(value=values[0])}}}function makeSum(){let value=Null$2;return{Function:"Sum",GetValue:()=>value,Accumulate:arg=>{arg[0]&&null!==arg[0].Value&&""!==arg[0].Value&&(value=op.Plus(value,arg[0]))},Combine:aggregate=>{checkAggrType(aggregate,"Sum");const newAggr=makeSum();return newAggr.SetState([op.Plus(value,aggregate.GetValue())]),newAggr},GetState:()=>"Null"===value.Type?[]:[value],SetState:values=>{values.length>0&&(value=values[0])}}}function makeAverage(){let sum=Null$2,count=Create$4(0);return{Function:"Avg",GetValue:()=>count.Value>0?op.Divide(sum,count):Null$2,Accumulate:arg=>{arg[0]&&null!==arg[0].Value&&""!==arg[0].Value&&(sum=op.Plus(sum,arg[0]),count=Create$4(count.Value+1))},Combine:aggregate=>{checkAggrType(aggregate,"Avg");const newAggr=makeAverage(),state=aggregate.GetState();return newAggr.SetState([op.Plus(sum,state[0]),op.Plus(count,state[1])]),newAggr},GetState:()=>[sum,count],SetState:values=>{sum=values[0],count=values[1]}}}function makeMax(){let value=Null$2;return{Function:"Max",GetValue:()=>value,Accumulate:arg=>{arg[0]&&null!==arg[0].Value&&""!==arg[0].Value&&("Null"===value.Type||Tools.Variant.Comparison.LessThan(value,arg[0]).Value)&&(value=arg[0])},Combine:aggregate=>{if(checkAggrType(aggregate,"Max"),"Null"===value.Type)return aggregate;const newAggr=makeMax();return newAggr.SetState([Tools.Variant.Comparison.LessThan(value,aggregate.GetValue()).Value?aggregate.GetValue():value]),newAggr},GetState:()=>"Null"===value.Type?[]:[value],SetState:values=>{values.length>0&&(value=values[0])}}}function makeMin(){let value=Null$2;return{Function:"Min",GetValue:()=>value,Accumulate:arg=>{arg[0]&&null!==arg[0].Value&&""!==arg[0].Value&&("Null"===value.Type||Tools.Variant.Comparison.GreaterThan(value,arg[0]).Value)&&(value=arg[0])},Combine:aggregate=>{if(checkAggrType(aggregate,"Min"),"Null"===value.Type)return aggregate;const newAggr=makeMin();return newAggr.SetState([Tools.Variant.Comparison.LessThan(value,aggregate.GetValue()).Value?value:aggregate.GetValue()]),newAggr},GetState:()=>"Null"===value.Type?[]:[value],SetState:values=>{values.length>0&&(value=values[0])}}}function makeCount(){let value=Zero$2;return{Function:"Count",GetValue:()=>value,Accumulate:arg=>{arg[0]&&null!==arg[0].Value&&""!==arg[0].Value&&(value=Create$4(con.toDouble(value)+1))},Combine:aggregate=>{checkAggrType(aggregate,"Count");const newAggr=makeCount();return newAggr.SetState([op.Plus(value,aggregate.GetValue())]),newAggr},GetState:()=>[value],SetState:values=>{value=values[0]}}}function makeCountDistinct(){const distinctValues=new VariantSet;return{Function:"CountDistinct",GetValue:()=>Create$4(distinctValues.size()),Accumulate:arg=>{arg[0]&&null!==arg[0].Value&&""!==arg[0].Value&&distinctValues.add(arg[0])},Combine:aggregate=>{checkAggrType(aggregate,"CountDistinct");const newAggr=makeCountDistinct();return newAggr.SetState(distinctValues.values().concat(aggregate.GetState())),newAggr},GetState:()=>distinctValues.values(),SetState:values=>{distinctValues.clear(),values.forEach((v=>distinctValues.add(v)))}}}function makeCountRows(){let value=Zero$2;return{Function:"CountRows",GetValue:()=>value,Accumulate:()=>{value=Create$4(value.Value+1)},Combine:aggregate=>{checkAggrType(aggregate,"CountRows");const newAggr=makeCountRows();return newAggr.SetState([op.Plus(value,aggregate.GetValue())]),newAggr},GetState:()=>[value],SetState:values=>{value=values[0]}}}function makeDistinctSum(){const distinctValues=new VariantMap;let value=Null$2;return{Function:"DistinctSum",GetValue:()=>0===distinctValues.size()?Null$2:("Null"===value.Type&&(value=Array.from(distinctValues.values()).reduce(((p,c)=>op.Plus(p,c)),Zero$2)),value),Accumulate:data=>{const key=data[0],val=data[1];key&&null!==key.Value&&val&&null!==val.Value&&""!==val.Value&&(distinctValues.hasKey(key)||(distinctValues.set(key,val),value=Null$2))},Combine:aggregate=>{checkAggrType(aggregate,"DistinctSum");const newAggr=makeDistinctSum(),arr=[];for(let p of distinctValues.entries())arr.push(p[0],p[1]);return newAggr.SetState(arr.concat(aggregate.GetState())),newAggr},GetState:()=>{const arr=[];for(let p of distinctValues.entries())arr.push(p[0],p[1]);return arr},SetState:state=>{distinctValues.clear();for(let i=0;i+1<state.length;i+=2)distinctValues.set(state[i],state[i+1])}}}function makeMedian(){let unsorted=!0,values=[];return{Function:"Median",GetValue:()=>{unsorted&&(values.sort(Tools.Variant.Comparison.Compare),unsorted=!1);const n=values.length;if(0===n)return Null$2;if(0!=(1&n))return values[(n-1)/2];const i=n/2|0;return op.Divide(op.Plus(values[i-1],values[i]),Create$4(2))},Accumulate:arg=>{arg[0]&&null!==arg[0].Value&&""!==arg[0].Value&&(values.push(arg[0]),unsorted=!0)},Combine:aggregate=>{checkAggrType(aggregate,"Median");const newAggr=makeMedian();return newAggr.SetState(values.concat(aggregate.GetState())),newAggr},GetState:()=>(unsorted&&(values.sort(Tools.Variant.Comparison.Compare),unsorted=!1),values),SetState:vals=>{values=[...vals],values.sort(Tools.Variant.Comparison.Compare),unsorted=!1}}}function makeMode(){let _mostFrequentItem={Key:Null$2,Value:0};const values=new VariantMap,checkValue=(key,value)=>{_mostFrequentItem.Value<value&&(_mostFrequentItem={Key:key,Value:value})};return{Function:"Mode",GetValue:()=>_mostFrequentItem.Key,Accumulate:arg=>{arg[0]&&null!==arg[0].Value&&(values.hasKey(arg[0])?(values.set(arg[0],(values.get(arg[0])||0)+1),checkValue(arg[0],values.get(arg[0])||0)):(values.set(arg[0],1),checkValue(arg[0],1)))},Combine:aggregate=>{checkAggrType(aggregate,"Mode");const newAggr=makeMode(),arr=[];for(let p of values.entries())arr.push(p[0],Create$4(p[1]));return newAggr.SetState(arr.concat(aggregate.GetState())),newAggr},GetState:()=>{const arr=[];for(let p of values.entries())arr.push(p[0],Create$4(p[1]));return arr},SetState:state=>{_mostFrequentItem={Key:Null$2,Value:0},values.clear();for(let i=0;i+1<state.length;i+=2){const key=state[i],value=con.toDouble(state[i+1]);values.set(key,value),checkValue(key,value)}}}}function makeToArray(){let values=[];return{Function:"ToArray",GetValue:()=>Create$4(values.map((v=>v.Value))),Accumulate:arg=>{arg[0]&&null!==arg[0].Value&&values.push(arg[0])},Combine:aggregate=>{checkAggrType(aggregate,"ToArray");const newAggr=makeToArray();return newAggr.SetState(values.concat(aggregate.GetState())),newAggr},GetState:()=>values,SetState:state=>{values=[...state]}}}function makeAggregateIf(){let aggregate=null;return{Function:"AggregateIf",GetValue:()=>aggregate?aggregate.GetValue():Null$2,Accumulate:data=>{con.toBoolean(data[0])&&(aggregate||(aggregate=MakeAggregate(ParseAggregateFunction(con.toString(data[1])))),aggregate.Accumulate(data.slice(2)))},Combine:aggr=>{checkAggrType(aggr,"AggregateIf");const newAggr=makeAggregateIf();return aggregate?(newAggr.SetState([Create$4(aggr.Function),...aggregate.Combine(aggr).GetState()]),newAggr):aggr},GetState:()=>aggregate?[Create$4(aggregate.Function),...aggregate.GetState()]:[],SetState:state=>{if(state&&0!==state.length){const fn=ParseAggregateFunction(con.toString(state[0]));aggregate=MakeAggregate(fn),aggregate.SetState(state.slice(1))}else aggregate=null}}}function makeVar(){let sum=Zero$2,sumOfSquares=Zero$2,count=0;return{Function:"Var",GetValue:()=>calcVariance(sum,sumOfSquares,count),Accumulate:arg=>{const value=arg[0];value&&"Null"!==value.Type&&""!==value.Value&&(sum=op.Plus(sum,value),sumOfSquares=op.Plus(sumOfSquares,op.Mult(value,value)),count++)},Combine:aggregate=>{checkAggrType(aggregate,"Var");const newAggr=makeVar(),state=aggregate.GetState();return newAggr.SetState([op.Plus(sum,state[0]),op.Plus(sumOfSquares,state[1]),op.Plus(Create$4(count),state[2])]),newAggr},GetState:()=>0===count?[]:[sum,sumOfSquares,Create$4(count)],SetState:state=>{state&&0!==state.length?(sum=state[0],sumOfSquares=state[1],count=con.toDouble(state[2])):(sum=Zero$2,sumOfSquares=Zero$2,count=0)}}}function makeVarP(){let sum=Zero$2,sumOfSquares=Zero$2,count=0;return{Function:"VarP",GetValue:()=>calcPopulationVariance(sum,sumOfSquares,count),Accumulate:arg=>{const value=arg[0];value&&"Null"!==value.Type&&""!==value.Value&&(sum=op.Plus(sum,value),sumOfSquares=op.Plus(sumOfSquares,op.Mult(value,value)),count++)},Combine:aggregate=>{checkAggrType(aggregate,"VarP");const newAggr=makeVarP(),state=aggregate.GetState();return newAggr.SetState([op.Plus(sum,state[0]),op.Plus(sumOfSquares,state[1]),op.Plus(Create$4(count),state[2])]),newAggr},GetState:()=>0===count?[]:[sum,sumOfSquares,Create$4(count)],SetState:state=>{state&&0!==state.length?(sum=state[0],sumOfSquares=state[1],count=con.toDouble(state[2])):(sum=Zero$2,sumOfSquares=Zero$2,count=0)}}}function makeStDev(){let sum=Zero$2,sumOfSquares=Zero$2,count=0;return{Function:"StDev",GetValue:()=>{const v=calcVariance(sum,sumOfSquares,count);return"Null"===v.Type?v:Create$4(Math.sqrt(con.toDouble(v)))},Accumulate:arg=>{const value=arg[0];value&&"Null"!==value.Type&&""!==value.Value&&(sum=op.Plus(sum,value),sumOfSquares=op.Plus(sumOfSquares,op.Mult(value,value)),count++)},Combine:aggregate=>{checkAggrType(aggregate,"StDev");const newAggr=makeStDev(),state=aggregate.GetState();return newAggr.SetState([op.Plus(sum,state[0]),op.Plus(sumOfSquares,state[1]),op.Plus(Create$4(count),state[2])]),newAggr},GetState:()=>0===count?[]:[sum,sumOfSquares,Create$4(count)],SetState:state=>{state&&0!==state.length?(sum=state[0],sumOfSquares=state[1],count=con.toDouble(state[2])):(sum=Zero$2,sumOfSquares=Zero$2,count=0)}}}function makeStDevP(){let sum=Zero$2,sumOfSquares=Zero$2,count=0;return{Function:"StDevP",GetValue:()=>{const v=calcPopulationVariance(sum,sumOfSquares,count);return"Null"===v.Type?v:Create$4(Math.sqrt(con.toDouble(v)))},Accumulate:arg=>{const value=arg[0];value&&"Null"!==value.Type&&""!==value.Value&&(sum=op.Plus(sum,value),sumOfSquares=op.Plus(sumOfSquares,op.Mult(value,value)),count++)},Combine:aggregate=>{checkAggrType(aggregate,"StDevP");const newAggr=makeStDevP(),state=aggregate.GetState();return newAggr.SetState([op.Plus(sum,state[0]),op.Plus(sumOfSquares,state[1]),op.Plus(Create$4(count),state[2])]),newAggr},GetState:()=>0===count?[]:[sum,sumOfSquares,Create$4(count)],SetState:state=>{state&&0!==state.length?(sum=state[0],sumOfSquares=state[1],count=con.toDouble(state[2])):(sum=Zero$2,sumOfSquares=Zero$2,count=0)}}}function calcVariance(sum,sumOfSquares,count){if(0===count||1===count)return Null$2;const vCount=Create$4(count);return op.Divide(op.Minus(op.Mult(vCount,sumOfSquares),op.Mult(sum,sum)),Create$4(count*(count-1)))}function calcPopulationVariance(sum,sumOfSquares,count){if(0===count)return Null$2;if(1===count)return Create$4(0);const vCount=Create$4(count);return op.Divide(op.Minus(op.Mult(vCount,sumOfSquares),op.Mult(sum,sum)),Create$4(count*count))}function MakeIndexedFilter(def,dataSet,parentDataSet){const filters=def.Filters||[],emptyContent=Def.Makers.Content([]);if(filters.length>0&&filters.every((x=>"Equal"===x.Op&&1===x.Values.length))){const mem=new WeakMap,fieldsFns=MakeFieldsFn$1(filters.map((x=>x.Expression)),emptyContent,dataSet),valueExprsFns=MakeFieldsFn$1(filters.map((x=>x.Values[0])),emptyContent,parentDataSet);return members=>{let index=mem.get(members);if(index||(index=function(members,indexExprs){const idx=new MapEx(ArrayComparer);for(const member of members){const key=indexExprs(member);idx.hasKey(key)?idx.get(key).push(member):idx.set(key,[member])}return idx}(members,fieldsFns),mem.set(members,index)),0===index.size())return[];const firstMember=IterableFirst(members),key=firstMember&&valueExprsFns(firstMember.ParentQueryContext);return key&&index.hasKey(key)?index.get(key):[]}}return Make(filters,(f=>MakeFieldsFn$1(f,emptyContent,dataSet)),(infos=>{const fns=MakeFieldsFn$1(infos,emptyContent,parentDataSet);return scope=>fns(scope.ParentQueryContext)}))}function ArrayComparer(a,b){return a.length===b.length&&a.every(((value,index)=>Tools.Variant.Comparison.Equals(value,b[index]).Value))}function Validate(filters,scope){if(filters)switch(scope){case"DataSet":case"DataRegion":if(IterableAny(filters,IsInvalidForRegion)){throw new Error(`Aggregate functions cannot be used in ${"DataSet"===scope?"data set":"data region"} filters`)}break;case"Group":if(IterableAny(filters,IsInvalidForGroup))throw new Error("Invalid expressions used in group filters.");break;default:throw new Error("filters validation: scope")}}const IsInvalidForRegion=filter=>[filter.Expression].concat(filter.Values).some(IsInvalidForRegionExpr),IsInvalidForRegionExpr=e=>IsInvalid(e,UnsupportedRegionFuncs),IsInvalidForGroup=filter=>[filter.Expression].concat(filter.Values).some(IsInvalidForGroupExpr),IsInvalidForGroupExpr=e=>IsInvalid(e,UnsupportedGroupFuncs),UnsupportedRegionFuncs=new RegExp("^"+AggregateFunctionNames.concat(["CumulativeTotal"]).join("|")+"$","gi"),UnsupportedGroupFuncs=/^CumulativeTotal$/gi;function IsInvalid(e,unsupportedFuncs){const node=compiler$5(e);return node.Contains(unsupportedFuncs,"function")||node.Contains(/^ReportItems(\.|!|$)/i,"variable")}const Comparison=Tools.Variant.Comparison,Convert$1=Tools.Variant.Convert,compiler$6=createCompiler(),Empty$2=members=>members;function Apply$2(data,filter){if(null===filter)return data;const items=filter(LazyMap(data.Data.Records,(rec=>data.MakeContextWithData(new RecordSet([rec])))));return data.MakeContextWithData(new RecordSet(LazyMap(items,(m=>m.Data.FirstOrDefault()))))}function MakeRegionFilter(def,dataSet=null,parentDataSet=null){return def&&def.Filters&&0!==def.Filters.length?(Validate(def.Filters,"DataRegion"),parentDataSet&&dataSet&&parentDataSet!==dataSet?MakeIndexedFilter(def,dataSet,parentDataSet):Make(def.Filters,(f=>MakeFieldsFn$1(f,Def.Makers.Content([]),dataSet)))):null}function MakeGroupFilter(def,content,dataSet){return def&&def.Filters&&0!==def.Filters.length?function(filter,content,dataSet=null){return null==filter||0==filter.length?Empty$2:Make(filter,(f=>MakeFieldsFn$1(f,content,dataSet)))}(def.Filters,content,dataSet):Empty$2}function MakeFieldsFn$1(fields,content,dataSet){const cc=MakeCompileContext(dataSet),fns=fields.map((f=>compile$u(f,cc)));return ctx=>fns.map((fn=>fn(ctx)))}function Make(filters,compile,compileRight=null){if(!filters||0===filters.length)return Empty$2;if(1===filters.length)return MakeSingle(filters[0],compile,compileRight);const fns=filters.map((filter=>MakeSingle(filter,compile,compileRight)));return members=>fns.reduce(((current,fn)=>fn(current)),members)}function MakeSingle(filter,compileLeft,compileRight=null){compileRight||(compileRight=compileLeft);const evalLeft=compileLeft([filter.Expression]),evalRight=compileRight(filter.Values.map((v=>v)));return fn=function(op,evalFn){switch(op){case"Equal":case"NotEqual":case"GreaterThan":case"GreaterThanOrEqual":case"LessThan":case"LessThanOrEqual":case"Like":case"NotLike":case"In":case"Between":case"NotBetween":case"BetweenExclusive":const predicate=(fn=function(op){switch(op){case"Equal":return args=>Comparison.Equals(args[0],args[1]).Value;case"NotEqual":return args=>{try{return!Comparison.Equals(args[0],args[1]).Value}catch(err){return!0}};case"GreaterThan":return args=>Comparison.GreaterThan(args[0],args[1]).Value;case"GreaterThanOrEqual":return args=>Comparison.GreaterOrEqual(args[0],args[1]).Value;case"LessThan":return args=>Comparison.LessThan(args[0],args[1]).Value;case"LessThanOrEqual":return args=>Comparison.LessOrEqual(args[0],args[1]).Value;case"Like":return args=>{const compiled=compiler$6(`="${Convert$1.toString(args[0]).toLowerCase()}" Like "${Convert$1.toString(args[1]).toLowerCase()}"`);return Convert$1.toBoolean("function"==typeof compiled?compiled({Data:{}}):compiled)};case"NotLike":return args=>{const compiled=compiler$6(`="${Convert$1.toString(args[0]).toLowerCase()}" Like "${Convert$1.toString(args[1]).toLowerCase()}"`);return!Convert$1.toBoolean("function"==typeof compiled?compiled({Data:{}}):compiled)};case"In":return args=>{const values=[];return args.slice(1).forEach((arg=>{"Object"===arg.Type&&Array.isArray(arg.Value)?values.push(...arg.Value.map((v=>Tools.Variant.Create(v)))):values.push(arg)})),values.some((t=>{try{return Comparison.Equals(t,args[0]).Value}catch(err){return!1}}))};case"Between":return args=>Comparison.GreaterOrEqual(args[0],args[1]).Value&&Comparison.LessOrEqual(args[0],args[2]).Value;case"NotBetween":return args=>!(Comparison.GreaterOrEqual(args[0],args[1]).Value&&Comparison.LessOrEqual(args[0],args[2]).Value);case"BetweenExclusive":return args=>Comparison.GreaterThan(args[0],args[1]).Value&&Comparison.LessThan(args[0],args[2]).Value;default:throw new Error(`Operator ${op} is not supported`)}}(op),args=>{try{return fn(args)}catch(err){return!1}});return members=>LazyFilter(members,(member=>predicate(evalFn(member))));case"TopN":return members=>TopN(members,evalFn,!1);case"BottomN":return members=>BottomN(members,evalFn,!1);case"TopPercent":return members=>TopN(members,evalFn,!0);case"BottomPercent":return members=>BottomN(members,evalFn,!0);default:throw new Error(`Operator ${op} is not supported`)}var fn}(filter.Op,(ctx=>evalLeft(ctx).concat(evalRight(ctx)))),members=>{try{return fn(members)}catch(err){return[]}};var fn}function TopN(set,selector,percent){return CapacityFilter(set,selector,!0,percent)}function BottomN(set,selector,percent){return CapacityFilter(set,selector,!1,percent)}function CapacityFilter(set,selector,top,percent){const buffer=[],bufferComparer=(a,b)=>top?Comparison.Compare(b.Key,a.Key):Comparison.Compare(a.Key,b.Key);let index=0,n=0,first=!0,count=0;if(percent){const list=IterableToArray(set);count=list.length,set=list}for(const item of set){const vals=selector(item);if(first){if(percent){const p=Convert$1.toDouble(vals[1]);n=Math.round(p*count/100)}else n=Convert$1.toInteger(vals[1]);if(n<=0)return[];first=!1}buffer.push({Key:vals[0],Value:{Index:index++,Item:item}}),buffer.sort(bufferComparer),buffer.length>n&&buffer.splice(buffer.length-1,1)}return LazyMap(IterableOrderBy(buffer,(it=>it.Value.Index),((a,b)=>a-b)),(it=>it.Value.Item))}const Compare=Tools.Variant.Comparison.Compare,NoSort=members=>members,MakeCompareFn=getDirection=>(x,y)=>{for(let i=0;i<x.length;i++){const t=Compare(x[i],y[i]);if(0!==t)return"Descending"===getDirection(i)?-1*t:t}return 0};function MakeSortContextFn(sort,groupContent=null,dataSet=null){if(!sort||0===sort.length)return NoSort;if(null==groupContent&&(groupContent=Def.Makers.ContentEmpty),1===sort.length&&Def.IsEmptyContent(groupContent))return function(sort,dataSet=null){var cc=MakeCompileContext(dataSet),fn=compile$u(sort.Expression,cc);return function(sort,evalFn){switch(sort.Direction){case"Ascending":return members=>IterableOrderBy(members,evalFn,Compare);case"Descending":return members=>IterableOrderBy(members,evalFn,((x,y)=>-Compare(x,y)));default:throw new Error("ArgumentOutOfRangeException")}}(sort,(ctx=>fn(ctx)))}(sort[0],dataSet);const fields=sort.map((s=>s.Expression));return MakeSortFn$2(sort,MakeFieldsFn$1(fields,0,dataSet))}function MakeSortFn$2(sort,evalFn){return 0===sort.length?NoSort:members=>{const comparer=MakeCompareFn((i=>sort[i].Direction));return IterableOrderBy(members,evalFn,comparer)}}function Apply$1(data,sort){if(!sort)return data;const items=sort(LazyMap(data.Data.Records,(rec=>data.MakeContextWithData(new RecordSet([rec]))))),recs=LazyMap(items,(m=>m.Data.FirstOrDefault()));return data.MakeContextWithData(new RecordSet(LazyMap(recs,((r,i)=>r.MakeCopy(i)))))}function MakeFn$2(grp){if(!grp||!grp.Parent)return null;if(!grp.GroupExpressions||0===grp.GroupExpressions.length)throw new Error("No group expression.");const keyIdx=IndexOfAggregate(grp.GroupExpressions[0]),parentIdx=IndexOfAggregate(grp.Parent);return keyIdx==parentIdx?null:(items,scope)=>function(items,keyFn,parentKeyFn){let list=Array.from(LazyMap(items,(t=>({Key:keyFn(t),ParentKey:parentKeyFn(t),Data:t}))));if(list.length<=1)return list.map((t=>[0,t.Data]));list=Array.from(function(items){const list=Array.from(items),loopItemKeys=function(items){const list=Array.from(items),tree=new Map(list.map((t=>[t.Key,t]))),handledItemKeys=[],loopItemKeys=[];for(const item of list){let current=item;const history=[current.Key];for(;null!==current.ParentKey&&tree.has(current.ParentKey)&&!(handledItemKeys.indexOf(current.ParentKey)>=0);){if(history.indexOf(current.ParentKey)>=0){loopItemKeys.push(item.Key);break}current=tree.get(current.ParentKey),history.push(current.Key)}for(const key of history)handledItemKeys.push(key)}return loopItemKeys}(list);for(let i=0;i<list.length;i++)if(loopItemKeys.indexOf(list[i].Key)>=0){const oldItem=list[i];list[i]={Key:oldItem.Key,ParentKey:null,Data:oldItem.Data}}return list}(list));const kidmap=new Map(LazyMap(LazyFilter(IterableGroupBy(list,(t=>t.ParentKey)),(([tKey,_])=>null!==tKey)),(([tKey,t])=>[tKey,Array.from(t)]))),lookup=new Map(list.map((t=>[t.Key,t])));return OrderByLevelPrivate(list.filter((it=>null===it.ParentKey||!lookup.has(it.ParentKey))),kidmap,0)}(items,MakeKeyFn(scope,keyIdx),MakeKeyFn(scope,parentIdx))}function MakeKeyFn(getScope,fieldIndex){return t=>getScope(t)["@"][fieldIndex].GetValue().Value}function IndexOfAggregate(defExpr){const expr=compiler$5(defExpr),fnToken="function"===expr.Token.type?expr.Token:null,fn=null!==fnToken?expr:null;if(null===fnToken||"."===fnToken.value[0])throw new Error("InvalidOperationException");if(fnToken.value.toLowerCase()!=="GetAggregate".toLowerCase())throw new Error("InvalidOperationException");return SafeEval$2(fn.Children[0]).Value}function*OrderByLevelPrivate(items,kidmap,level){for(const it of items){yield[level,it.Data];const kids=kidmap.get(it.Key)||[];for(const t of OrderByLevelPrivate(kids,kidmap,level+1))yield t}}const IsLeafMember=member=>!member.Members||0===member.Members.length;function MakeIdFn(getLeafMembers){let iterator=null;const map=new Map;let index=0;return member=>{if(iterator||(iterator=getLeafMembers()[Symbol.iterator]()),map.has(member))return map.get(member);let current=iterator.next();for(;!current.done;){if(current.value===member)return index++;map.set(current.value,index++),current=iterator.next()}throw new Error("Bad code path")}}function GetLeafsFn(getRoots,isLeaf,getChildren,leavesFirst=!1){let leafs=null;return()=>(leafs||(leafs=Memoize$2(CollectLeafNodes(getRoots(),isLeaf,getChildren,leavesFirst))),leafs)}function CollectLeafNodes(members,isLeaf,getChildren,leavesFirst=!1){return{*[Symbol.iterator](){if(leavesFirst){for(let leaf of LazyFilter(members,(m=>isLeaf(m))))yield leaf;for(let branch of LazyFilter(members,(m=>!isLeaf(m))))for(let dataMember of CollectLeafNodes(getChildren(branch),isLeaf,getChildren,!0))yield dataMember}else for(let tablixDataMember of members)if(isLeaf(tablixDataMember))yield tablixDataMember;else for(let dataMember of CollectLeafNodes(getChildren(tablixDataMember),isLeaf,getChildren))yield dataMember}}}function FlattenMembers(members,arr=[]){return arr.push(...members),members.forEach((m=>FlattenMembers(m.Members||[],arr))),arr}function Intersect(first,second,indexSelector){return 0===first.length||0===second.length?[]:{*[Symbol.iterator](){yield*Math.abs(first.length-second.length)<=100?function*(first,second,indexSelector){let i1=0,i2=0,i=0,index=0;for(;i1<first.length&&i2<second.length;){const a=first[i1],b=second[i2],ai=indexSelector(a),bi=indexSelector(b);ai==bi?(0!=i&&ai==index||(i++,index=ai,yield a),i1++,i2++):ai<bi?i1++:i2++}}(first,second,indexSelector):function*(first,second,indexSelector){if(first.length>second.length){const t=first;first=second,second=t}const compare=(x,y)=>{const a=indexSelector(x),b=indexSelector(y);return Tools.Variant.isVariant(a)&&Tools.Variant.isVariant(b)?Tools.Variant.Comparison.Compare(a,b):a<b?-1:a>b?1:0};let start=0;for(let i=0;i<first.length;i++){const it=first[i],j=BinarySearch(second,start,second.length-start,it,compare);j>=0&&(start=j,0!==i&&indexSelector(first[i-1])==indexSelector(it)||(yield it))}}(first,second,indexSelector)}}}function BinarySearch(array,index,length,value,compare){let lower=index,upper=index+length-1;for(;lower<=upper;){const middle=lower+(upper-lower>>1),result=compare(array[middle],value);if(0===result)return middle;result<0?lower=middle+1:upper=middle-1}return~lower}function Apply(items,sort,getItem){if(null==sort||0==sort.length)return items;const comparer=MakeCompareFn((i=>sort[i].Direction));return Array.from(IterableOrderBy(items,(g=>sort.map((t=>getItem(g)["@"][t.FieldIndex].GetValue()))),comparer))}function DataTreeSortApply(groups,sort){return Apply(groups,sort,(g=>g))}function DataTreeSortApplyTablix(members,sort){return Apply(members,sort,(m=>m.Header))}function GetLastTablixContext$1(ctx){let result=null,context=ctx;for(;context.Parent;)context=context.Parent,DataTree.IsTablix(context.Region)&&(result=context);return result}function FindCellScope(nearestContext,distance){let currentContext=nearestContext;for(let i=0;i<distance;i++)currentContext=currentContext&&currentContext.Parent;return currentContext}const MakeCellAggregateKey=(index,row,col)=>`CellAggregateKey(${index},${row},${col})`,MakeCellAggregateKeyByScopeCell=key=>`CellAggregateKey(${ScopeCellAggregateKey.getIndex(key)},${ScopeCellAggregateKey.getRow(key)},${ScopeCellAggregateKey.getCol(key)})`,ScopeCellAggregateKey={getIndex:key=>+key.slice("ScopeCellAggregateKey(".length).split(",")[0],getRow:key=>+key.slice("ScopeCellAggregateKey(".length).split(",")[1],getCol:key=>+key.slice("ScopeCellAggregateKey(".length).split(",")[2]};function MakeCellFn(dtg,compileContext,content,original){const runningValues=[],scopeFn=MakeScopeFn$1(dtg,compileContext,content,original,runningValues);return ctx=>(function(ctx,cellRunningValues){for(let key of cellRunningValues){let scopeContext=null;if(ScopeCellAggregateKey.getRow(key)>-1&&(scopeContext=FindCellScope(ctx.Parent,ScopeCellAggregateKey.getRow(key))),ScopeCellAggregateKey.getCol(key)>-1&&(scopeContext=FindCellScope(ctx.Column,ScopeCellAggregateKey.getCol(key))),scopeContext||(scopeContext=GetLastTablixContext$1(ctx)),scopeContext&&scopeContext.ScopeCellRunningValues[key]){const aggKey=MakeCellAggregateKeyByScopeCell(key);if(!ctx.CellRunningValues[aggKey]){const value=scopeContext.ScopeCellRunningValues[key].Combine(ctx.Scope["@"][ScopeCellAggregateKey.getIndex(key)]);ctx.CellRunningValues[aggKey]=value,scopeContext.ScopeCellRunningValues[key]=value}}else{const value=ctx.Scope["@"][ScopeCellAggregateKey.getIndex(key)];ctx.CellRunningValues[MakeCellAggregateKeyByScopeCell(key)]=value,scopeContext.ScopeCellRunningValues[key]=value}}}(ctx,runningValues),scopeFn(ctx))}const MakeMemberIndexFn=()=>{let index=0;return member=>IsLeafMember(member)?index++:-1};function MakeTablixFn(dtg,compileContext,def,original){const columnIdx=MakeMemberIndexFn(),rowIdx=MakeMemberIndexFn(),scopeFn=MakeScopeFn$1(dtg,compileContext,def.Content,original.Content),columnFns=MakeMemberFns(dtg,compileContext,def.ColumnMembers,original.ColumnMembers,columnIdx),rowFns=MakeMemberFns(dtg,compileContext,def.RowMembers,original.RowMembers,rowIdx),bodyFns=IterableToArray(LazyZipEx(def.Body,original.Body,((i,row1,row2)=>IterableToArray(LazyZipEx(row1.Cells,row2.Cells,((j,cell1,cell2)=>MakeCellFn(dtg,Object.assign(Object.assign({},MakeCompileContext$1(compileContext)),{Row:i,Column:j,Tablix:compileContext,Name:def.Name}),cell1,cell2)))))));return ctx=>{let columnMembers=[],rowMembers=[];const getColumnLeafs=GetLeafsFn((()=>columnMembers),(m=>IsLeafTxMember$1(m)),(m=>m.MakeMembers()),!1),getRowLeafs=GetLeafsFn((()=>rowMembers),(m=>IsLeafTxMember$1(m)),(m=>m.MakeMembers()),!0),columnIdFn=MakeIdFn(getColumnLeafs),rowIdFn=MakeIdFn(getRowLeafs),tablix=ctx.Region,scope=scopeFn(ctx);return columnMembers=IterableToArray(LazyZipEx(columnFns,tablix.ColumnMembers,((i,fn,m)=>fn(MakeEvalContextByMember(m,ctx),columnIdFn)))),rowMembers=IterableToArray(LazyZipEx(rowFns,tablix.RowMembers,((i,fn,m)=>fn(MakeEvalContextByMember(m,ctx),rowIdFn)))),DataTree.Makers.Tablix(scope,columnMembers.map(MakeTablixMember$1),rowMembers.map(MakeTablixMember$1),(()=>{const columnLeafs=IterableToArray(getColumnLeafs());return LazyMap(getRowLeafs(),(rowMember=>function(tablix,rowMember,columnLeafs,bodyFns){const row=GetCollectionItem$1(tablix.Body,rowMember.AggregateId),cells=new Array(columnLeafs.length);let prevCell=null;for(let j=0;j<cells.length;j++){const columnMember=columnLeafs[j],ex=MakeEvalContextByScope(row.Cells[columnMember.AggregateId],rowMember.Context,prevCell,columnMember.Context);cells[j]=bodyFns[rowMember.DefIndex][columnMember.DefIndex](ex),prevCell=ex}return DataTree.Makers.TablixRow(cells)}(tablix,rowMember,columnLeafs,bodyFns)))}),def.Name)}}function CreateTxMember$1(context,header,isCollection,defIndex,aggregateId,idFn,makeMembers){return{Context:context,DefIndex:defIndex,Header:header,IsCollection:isCollection,IdFn:idFn,MakeMembers:Once$1(makeMembers),AggregateId:aggregateId,_id:-1}}function Once$1(fn){let result=null;return()=>(result||(result=Memoize$2(fn())),result)}const IsLeafTxMember$1=m=>!m.IsCollection&&m.DefIndex>=0;function MakeTablixMember$1(m){return DataTree.Makers.TablixMember(m.Header,m.IsCollection,(m=>IsLeafTxMember$1(m)?(m._id<0&&(m._id=m.IdFn(m)),m._id):-1)(m),(()=>LazyMap(m.MakeMembers(),MakeTablixMember$1)))}function MakeMemberFns(dtg,compileContext,members,original,idx){return IterableToArray(LazyZipEx(members,original,((i,m1,m2)=>function(dtg,compileContext,def,original,idx){const defIndex=idx(def),filterFn=MakeFilterFn(dtg,compileContext,def.Group||null),sortFn=MakeSortFn$1(dtg,compileContext,def.Sort||[]),headerFn=MakeScopeFn$1(dtg,compileContext,def.Header||Def.EmptyContent,original.Header||Def.EmptyContent),membersFn=IterableToArray(MakeMemberFns(dtg,compileContext,def.Members||[],original.Members||[],idx)),levelFn=def.Group?MakeFn$2(def.Group):null,isDetail=original.Group&&0===(original.Group.GroupExpressions||[]).length;return(ctx,idFn)=>{const member=ctx.Member;if(member.IsCollection){const makeMembers=()=>{let members=member.Members;if(dtg.InteractiveSort){const sort=GetSort(ctx,dtg.InteractiveSort,original.Header||Def.EmptyContent);sort&&(members=DataTreeSortApplyTablix(IterableToArray(members),isDetail?sort.filter((s=>!s.SortExpressionScope)):sort.filter((s=>def.Group&&s.SortExpressionScope===def.Group.Name))))}let levels=null;if(null!==levelFn){const pairs=IterableToArray(levelFn(members,(m=>m.Header)));members=pairs.map((([_,value])=>value)),levels=pairs.map((([key,_])=>key))}let contexts=function(parent,members,levels){return{*[Symbol.iterator](){let prev=null,i=0;for(let m of members){const level=levels?levels[i]:0,current=MakeEvalContextByMember(m,parent,prev);if(current.Level=level,current.GroupIndex=i,levels){const index=i;current.GetDescendants=()=>GetDescendants$1(members,levels,index)}yield current,prev=current,i++}}}}(ctx.Parent,members,levels);contexts=sortFn(filterFn(contexts));let prevCell=null;return LazyMap(contexts,(mx=>{const m=mx.Member;return CreateTxMember$1(mx,headerFn(mx),!1,defIndex,void 0===m.Id?-1:m.Id,idFn,(()=>LazyZipEx(membersFn,m.Members,((i,fn,t)=>fn(prevCell=MakeEvalContextByMember(t,mx,prevCell),idFn)))))}))};return CreateTxMember$1(ctx,null,!0,-1,-1,idFn,makeMembers)}const header=headerFn(ctx);return CreateTxMember$1(ctx,header,!1,defIndex,void 0===member.Id?-1:member.Id,idFn,(()=>LazyZipEx(membersFn,member.Members,((i,fn,m)=>fn(MakeEvalContextByMember(m,ctx),idFn)))))}}(dtg,MakeCompileContext$1(compileContext),m1,m2,idx))))}function GetDescendants$1(members,levels,index){return{*[Symbol.iterator](){const level=levels[index];for(let i=index+1;i<members.length&&!(levels[i]<=level);i++)yield GetCollectionItem$1(members,i).Header}}}function FindPreviousImpl(current,path){if(path.length>0&&"Tablix"===path[0].Type)return function(expressionContext,path){var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l,_m,_o,_p,_q,_r;const tablix=GetTablix(expressionContext);path=path.slice(1);const isColumn="Column"==(null===(_a=path[0])||void 0===_a?void 0:_a.Type),isHeader=!expressionContext.Column;isColumn&&isHeader&&(path=path.slice(1));const scopePath=[];let currentContext=expressionContext,scopeFound=!1,parentFound=!1;for(const pathItem of path){switch(pathItem.Type){case"Scope":scopeFound=!0;break;case"Member":scopePath.push(ScopePathItemIdx(pathItem.Indexes[0]));break;case"Group":if(scopeFound){if(null==currentContext?void 0:currentContext.Previous){currentContext=currentContext.Previous,parentFound=!0;break}scopePath.push(ScopePathItemLast()),currentContext=null!==(_c=null==currentContext?void 0:currentContext.Parent)&&void 0!==_c?_c:null}else{const currentMember=null==currentContext?void 0:currentContext.Member;if((null==currentMember?void 0:currentMember.Header)&&currentMember.Header["@"].length>0){const scopeGroupingValues=currentMember.Header["@"].map((x=>x.GetValue()));scopePath.push(ScopePathItemValues(scopeGroupingValues))}currentContext=null!==(_b=null==currentContext?void 0:currentContext.Parent)&&void 0!==_b?_b:null}break;case"Column":currentContext=null!==(_d=null==currentContext?void 0:currentContext.Column)&&void 0!==_d?_d:null;break;default:currentContext=null!==(_e=null==currentContext?void 0:currentContext.Parent)&&void 0!==_e?_e:null}if(parentFound)break}if(!parentFound)return null;let curMem=null!==(_f=null==currentContext?void 0:currentContext.Member)&&void 0!==_f?_f:null;for(;scopePath.length>0;){const pathItem=scopePath.pop(),members=curMem?IterableToArray(curMem.Members):isColumn?tablix.ColumnMembers:tablix.RowMembers;switch(pathItem.Type){case"Index":curMem=members[pathItem.Index];break;case"Last":curMem=members[members.length-1];break;case"Values":curMem=null!==(_g=members.find((x=>pathItem.ScopeValues.length===x.Header["@"].length&&x.Header["@"].every(((y,i)=>Tools.Variant.Comparison.Equals(y.GetValue(),pathItem.ScopeValues[i]).Value)))))&&void 0!==_g?_g:null}curMem&&!curMem.IsCollection&&(currentContext=MakeEvalContextByMember(curMem,currentContext))}return curMem?isHeader?MakeEvalContextByScope(curMem.Header,currentContext):(null!==(_h=curMem.Id)&&void 0!==_h?_h:-1)<0?null:isColumn?MakeEvalContextByScope(GetCollectionItem$1(tablix.Body,null!==(_l=null===(_k=null===(_j=expressionContext.Parent)||void 0===_j?void 0:_j.Member)||void 0===_k?void 0:_k.Id)&&void 0!==_l?_l:-1).Cells[null!==(_m=curMem.Id)&&void 0!==_m?_m:-1],expressionContext.Parent,null,currentContext):MakeEvalContextByScope(GetCollectionItem$1(tablix.Body,null!==(_o=curMem.Id)&&void 0!==_o?_o:-1).Cells[null!==(_r=null===(_q=null===(_p=expressionContext.Column)||void 0===_p?void 0:_p.Member)||void 0===_q?void 0:_q.Id)&&void 0!==_r?_r:-1],currentContext):null}(current,path);let{previous:parent,searchKeys:searchKeys}=function(scope,path){const searchKeys=[];for(let param of path){if(!scope)break;const keys=[];param.IsRegion||keys.push(...param.Indexes.filter((_=>scope&&scope.Scope)).map((t=>scope.Scope["@"][t].GetValue()))),searchKeys.push(keys),scope=scope.Parent}return{previous:scope,searchKeys:searchKeys}}(current,path);if(!parent)return null;const previous=function(ctx){let previous=ctx.Previous;if(previous)return previous;let level=1,parent=ctx.Parent;for(;parent&&(previous=parent.Previous,!previous);)parent=parent.Parent,(null==parent?void 0:parent.Region)&&level++;if(previous){for(;level>0;){const last=previous?IterableLast(previous.Children):null;if(!last)break;previous=last,level--}return previous}return null}(parent);if(!previous)return null;searchKeys.reverse(),path=[...path].reverse();let evalContext=previous,scope=previous.Scope,region=previous.Region;for(var i=0;i<path.length;i++){const param=path[i];if(param.IsRegion){if(!scope)return null;if(region=DataTree.IsList(scope.Regions[param.Indexes[0]])?scope.Regions[param.Indexes[0]]:null,!region)return null;evalContext=MakeEvalContextByRegion(region,evalContext)}else{if(!region)return null;if(scope=IterableFind(region.Groups,(g=>{var ctx=MakeEvalContextByScope(g,evalContext);return Eq(param.Indexes.map((t=>ctx.Scope["@"][t].GetValue())),searchKeys[i])})).Item,!scope)return null;evalContext=MakeEvalContextByScope(scope,evalContext)}}return scope?evalContext:null}const ScopePathItemValues=values=>({Type:"Values",ScopeValues:values,Index:-1}),ScopePathItemLast=()=>({Type:"Last",ScopeValues:[],Index:-1}),ScopePathItemIdx=idx=>({Type:"Index",ScopeValues:[],Index:idx});function Eq(arr,other){if(!arr)return null===other;if(!other)return!1;if(arr.length!==other.length)return!1;for(let i=0;i<arr.length;i++){const ieq=arr[i];if(isVariant(ieq)){if(!Tools.Variant.Comparison.Equals(ieq,other[i]).Value)return!1;if(!ieq.Equals(other[i]))return!1}else if(arr[i]===other[i])return!1}return!0}const toExprSafeValue=Tools.Variant.Convert.toSafeValue;function stringifyDates(value){return dateTimeFactory_isDateTime(value)?{DataType:"Date",Value:value.toISOString()}:value instanceof Array?value.map((v=>stringifyDates(v))):"object"==typeof value&&null!=value?mapDictionary$1(value,(v=>stringifyDates(v))):value}const deserialize=value=>function(value){return null!=value&&"object"==typeof value&&"Date"===value.DataType}(value)?dateTimeFactory_createFromJsDate(new Date(value.Value)):Array.isArray(value)?value.map((v=>deserialize(v))):"object"==typeof value&&null!=value?mapDictionary$1(value,(v=>deserialize(v))):value,variantSerializer={serialize:value=>value===Tools.Variant.DBNull?null:stringifyDates(value.Value),deserialize:deserialize},Zero$1=Tools.Variant.Zero,Null$1=Tools.Variant.Null,CreateVariant=Tools.Variant.Create;function MakeCompileContext$1(parent=null){return parent?{Parent:parent,Tablix:null,Name:"",Row:parent.Row,Column:parent.Column,RunningValues:[],ScopeRunningValues:[]}:{Parent:null,Tablix:null,Name:"",Row:0,Column:0,RunningValues:[],ScopeRunningValues:[]}}function MakeEvalContextByScope(scope,parent=null,previous=null,column=null,expressionContext=null,scopeRunningValues=null){const ec={Scope:scope,Parent:parent,Previous:previous,Column:column,Member:null,RunningValues:{},CellRunningValues:{},ScopeCellRunningValues:{},ScopeRunningValues:previous?previous.ScopeRunningValues:scopeRunningValues,App:!expressionContext&&parent?parent&&parent.App||null:expressionContext,Children:[],Data:RecordSet.Empty,GetDescendants:()=>[],Level:0,Region:null,GroupIndex:-1};return ec.Children=LazyMapMany(scope?scope.Regions:[],(r=>LazyMap(r.Groups,(g=>MakeEvalContextByScope(g,ec))))),function(ctx){if(ctx.Previous)for(let key in ctx.Previous.RunningValues){const numKey=parseInt(key),runningValue=ctx.Previous.RunningValues[key];if(null===ctx.ScopeRunningValues||ctx.ScopeRunningValues.indexOf(numKey)>-1){const prevAggregateValue=runningValue,thisValue=ctx.Scope["@"][numKey],thisAggValue=prevAggregateValue.Combine(thisValue);ctx.RunningValues[key]=thisAggValue}else{const thisValue=ctx.Scope["@"][numKey];ctx.RunningValues[key]=thisValue}}}(ec),ec}function MakeEvalContextByRegion(region,parent=null,previous=null,expressionContext=null,scopeRunningValues=null){return Object.assign(Object.assign({},MakeEvalContextByScope(region.Scope,parent,previous,null,expressionContext,scopeRunningValues)),{Region:region})}function MakeEvalContextByMember(member,parent=null,previous=null){return Object.assign(Object.assign({},MakeEvalContextByScope(member.Header,parent,previous)),{Member:member})}function GetLevel(ctx,parent,axis){if(null==axis&&null==parent&&ctx.Column){const colLevel=GetLevel(ctx.Column,0,0);if(0!==colLevel.Value)return colLevel}parent=null!=parent?parent:0;let scope=0===(axis=null!=axis?axis:0)?ctx:ctx.Column;for(;null!==scope&&parent-- >0;)scope=scope.Parent;return null===scope||DataTree.IsEmpty(scope.Scope)?null!==ctx.Column?CreateVariant(function(column){let level=column.Level;var context=column.Parent;for(;0===level&&null!==context;)level=context.Level,context=context.Parent;return level}(ctx.Column)):Zero$1:CreateVariant(scope.Level)}function GetTablix(ctx){return pipe(iterable$2.map((x=>x.Region)),iterable$2.filter(DataTree.IsTablix),iterable$2.first)(Recursive(ctx,(p=>p.Parent)))}function GetLeaf(currentMember){for(;currentMember.Members.length>0;)currentMember=GetCollectionItem$1(currentMember.Members,0);return currentMember}function FindParent(parent,ctx){return pipe(iterable$2.filter((p=>{var _a;return!(null===(_a=p.Member)||void 0===_a?void 0:_a.IsCollection)})),iterable$2.skip(parent),iterable$2.first)(Recursive(ctx,(p=>p.Parent)))}function Generate(report,original,tree,interactiveSort=null,ctx=null,makeContext=null){return MakeRegionFn$1({InteractiveSort:interactiveSort,MakeContext:makeContext},MakeCompileContext$1(),report,original)(MakeEvalContextByRegion(tree,null,null,ctx))}function MakeRegionFn$1(dtg,compileContext,region,original){switch(region.type){case"list":return function(dtg,compileContext,def,original){const scopeFn=MakeScopeFn$1(dtg,compileContext,def.Content,original.Content),itemCompileContext=MakeCompileContext$1(compileContext),itemFn=MakeScopeFn$1(dtg,itemCompileContext,def.GroupContent,original.GroupContent),isDetail=null!=def.Group&&0===(def.Group.GroupExpressions||[]).length,filterFn=MakeFilterFn(dtg,compileContext,def.Group),sortFn=MakeSortFn$1(dtg,compileContext,def.Sort),levelFn=MakeFn$2(def.Group);return ctx=>{const list=ctx.Region,scope=scopeFn(ctx);return DataTree.Makers.List(scope,(()=>{let items=list.Groups;if(null!==dtg.InteractiveSort){const sort=GetSort(ctx,dtg.InteractiveSort,original.GroupContent);null!=sort&&(items=DataTreeSortApply(Array.from(items),isDetail?sort.filter((s=>!s.SortExpressionScope)):sort.filter((s=>s.SortExpressionScope===def.Group.Name))))}let levels=null;if(null!==levelFn){const pairs=Array.from(levelFn(items,(t=>t)));items=pairs.map((([_,value])=>value)),levels=pairs.map((([key,_])=>key))}return LazyMap(sortFn(filterFn(function*(parent,items,levels,scopeRunningValues){let prev=null,i=0;for(let item of items){const level=null!==levels?levels[i]:0,current=MakeEvalContextByScope(item,parent,prev,null,null,scopeRunningValues);if(current.Level=level,current.GroupIndex=i,null!==levels){const index=i;current.GetDescendants=()=>GetDescendants(items,levels,index)}yield current,prev=current,i++}}(ctx,items,levels,itemCompileContext.ScopeRunningValues))),(c=>itemFn(c)))}),list.Name)}}(dtg,compileContext,region,original);case"tablix":return MakeTablixFn(dtg,compileContext,region,original);case"subreport":return function(dtg,compileContext,def,original){const scopeFn=MakeScopeFn$1(dtg,compileContext,def.Content,original.Content),reportFn=MakeRegionFn$1(dtg,MakeCompileContext$1(compileContext),def.Report,original.Report);return ctx=>{const region=ctx.Region,scope=scopeFn(ctx);let groups=[];const rptScope=GetCollectionItem$1(region.Groups,0);if(rptScope){const args=def.Parameters.map((p=>({Name:p.Name,Eval:compile$u(p.Value)}))).map((p=>({Name:p.Name,Value:p.Eval(ctx)}))),subReportContext=dtg.MakeContext&&dtg.MakeContext(def.Report,args),rptRegion=DataTree.Makers.List(rptScope,[],def.Name);groups=[reportFn(MakeEvalContextByRegion(rptRegion,null,null,subReportContext&&subReportContext.ExpressionContext)).Scope]}return DataTree.Makers.List(scope,groups,region.Name)}}(dtg,compileContext,region,original);default:return function(dtg,compileContext,def,original){const scopeFn=MakeScopeFn$1(dtg,compileContext,def.Content,original.Content);return ctx=>{const scope=scopeFn(ctx);return DataTree.Makers.List(scope,[],ctx.Region.Name)}}(dtg,compileContext,region,original)}}function MakeScopeFn$1(dtg,compileContext,content,original,cellRunningValues=null){if(!content||Def.IsEmptyContent(content))return ctx=>DataTree.Makers.Scope([],[],ctx.Scope.Id);const fieldFns=content.Fields.map((f=>function(compileContext,expression,cellRunningValues){return function(compileContext,exp,cellRunningValues){if(null===exp)return;const expression=compiler$5(exp);CompileNode(compileContext,expression,cellRunningValues)}(compileContext,expression,cellRunningValues),compile$u(expression)}(compileContext,f,cellRunningValues))),regionFns=Array.from(LazyZipEx(content.Regions,original.Regions,((i,r1,r2)=>MakeRegionFn$1(dtg,MakeCompileContext$1(compileContext),r1,r2))));return ctx=>{if(!ctx.Previous)for(let i of compileContext.RunningValues)if(ctx.Scope){const startValue=ctx.Scope["@"][i];ctx.RunningValues[i]=startValue}const values=fieldFns.map((fn=>fn(ctx))).map((v=>(v=>stringifyDates(toExprSafeValue(v)))(v)));return DataTree.Makers.Scope(values,(()=>IterableToArray(LazyZipEx(regionFns,ctx.Scope.Regions,((i,fn,r)=>fn(MakeEvalContextByRegion(r,ctx,null,null,compileContext.ScopeRunningValues)))))),ctx.Scope.Id)}}function CompileNode(compileContext,expression,cellRunningValues){var index,rowScopeDistance,colScopeDistance,row,col,name;if(expression)if("function"===expression.Token.type&&"."!==expression.Token.value[0]&&"getrunningvalue"==expression.Token.value.toLowerCase()){let currentConext=compileContext;const aggregateIndexes=expression.Children.map((a=>Tools.Variant.Convert.toInteger(SafeEval$2(a))));for(let i=0;i<aggregateIndexes.length;i++){const index=aggregateIndexes[i];if(currentConext.RunningValues.push(index),i<aggregateIndexes.length-1&&currentConext.ScopeRunningValues.push(index),currentConext=currentConext.Parent,!currentConext)break}}else if("function"===expression.Token.type&&"."!==expression.Token.value[0]&&"getcellrunningvalue"==expression.Token.value.toLowerCase()&&cellRunningValues){const args=expression.Children.map((a=>Tools.Variant.Convert.toInteger(SafeEval$2(a))));if(cellRunningValues.push((index=args[0],rowScopeDistance=args[1],colScopeDistance=args[2],row=compileContext.Row,col=compileContext.Column,name=compileContext.Name,`ScopeCellAggregateKey(${index},${rowScopeDistance},${colScopeDistance},${row},${col},${name})`)),args.length>3&&compileContext.Tablix){let currentConext=compileContext.Tablix.Parent;const aggregateIndexes=expression.Children.slice(3).map((a=>Tools.Variant.Convert.toInteger(SafeEval$2(a))));for(let index of aggregateIndexes){if(!currentConext)break;currentConext.RunningValues.push(index),currentConext.ScopeRunningValues.push(index),currentConext=currentConext.Parent}}}else if("function"===expression.Token.type||"operator"===expression.Token.type)for(let arg of expression.Children)CompileNode(compileContext,arg,cellRunningValues)}function*GetDescendants(items,levels,index){const level=levels[index];for(let i=index+1;i<items.length&&!(levels[i]<=level);i++)yield GetCollectionItem$1(items,i)}function MakeFilterFn(dtg,compileContext,grp){return null!==grp&&grp.Filters&&0!=grp.Filters.length?Make(grp.Filters,(f=>MakeFieldsFn(dtg,compileContext,f))):Empty$2}function MakeSortFn$1(dtg,compileContext,sort){if(0==sort.length)return NoSort;const fieldsFn=MakeFieldsFn(dtg,compileContext,sort.map((s=>s.Expression)));return MakeSortFn$2(sort,fieldsFn)}function MakeFieldsFn(dtg,compileContext,fields){const content={Fields:fields,Regions:[]},scopeFn=MakeScopeFn$1(dtg,compileContext,content,content);return ctx=>scopeFn(ctx)["@"].map((t=>CreateVariant(t)))}function GetSort(ctx,store,details){if(null==store||0==Object.keys(store).length)return null;const fields=[],list=[];let scope=ctx;for(;null!=scope;){if(null==scope.Scope)throw new Error("Scope undefined.");const sort=store[scope.Scope.Id];if(sort)for(const f of sort){const sortExpr=compiler$5(f.SortExpression),agg="function"===sortExpr.Token.type?Describe(sortExpr):null;if(null!=agg&&agg.IsScopeSpecified&&agg.ScopeName!=f.SortExpressionScope)continue;if(fields.indexOf(f.SortExpression)>=0)continue;const detailsFields=details.Fields.map(compiler$5),i=null==agg||null==agg.Arguments||0==agg.Arguments.length?IndexOfListField(detailsFields,sortExpr):detailsFields.findIndex((fld=>{const fnToken="function"===fld.Token.type?fld.Token:null;return null!==fnToken&&0===fnToken.value.localeCompare(agg.Func,void 0,{sensitivity:"accent"})&&fld.Children.length>0&&fld.Children[0].ToString()===agg.Arguments[0].ToString()}));i>=0&&(list.push({SortExpressionScope:f.SortExpressionScope,FieldIndex:i,Direction:f.Direction}),fields.push(f.SortExpression))}scope=scope.Parent}return 0===list.length?null:list}function IndexOfListField(fields,field){return fields.findIndex((f=>{const functionEx="function"===f.Token.type?f:null;return null!==functionEx&&functionEx.Children.length>0?functionEx.Children[0].ToString()===field.ToString():f.ToString()===field.ToString()}))}function*Recursive(obj,getNext){for(;null!=obj;)yield obj,obj=getNext(obj)}const Create$3=Tools.Variant.Create,isVariant$1=Tools.Variant.isVariant,Null=Tools.Variant.Null,MakeEvaluationContext=(data,ctx)=>({Data:{fields:data,parameters:ctx.App&&ctx.App.Parameters},Context:ctx});function MakeCompileContext(dataSet){if(null===dataSet||null===dataSet.FieldNames)return null;return{FiledNameIndex:dataSet.FieldNames.reduce(((o,exp,i)=>Object.assign(Object.assign({},o),{[i]:exp})),{}),AggregateDataProvider:null}}const customFunctions$1={GetAggregate:(ctx,args)=>{const resolvedArgs=args.map((a=>SafeEval$2(a,ctx))).map((v=>v.Value));return function(ctx,index,parent,axis,recursive){let scope=0==axis?ctx:ctx.Column;for(;null!=scope&&parent-- >0;)scope=scope.Parent;if(null==scope||null==scope.Scope)return Null$1;let agg=scope.Scope["@"][index];return recursive&&(agg=IterableToArray(scope.GetDescendants()).reduce(((a,b)=>a.Combine(b["@"][index])),agg)),agg.GetValue()}(ctx.Context,resolvedArgs[0]||0,resolvedArgs[1]||0,resolvedArgs[2]||0,!!resolvedArgs[3]||!1)},GetRegionAggregate:(ctx,args)=>{const resolvedArgs=args.map((a=>SafeEval$2(a,ctx).Value));return function(ctx,index,parent,region){let scope=ctx;for(;scope&&parent-- >0;)scope=scope.Parent;return scope&&scope.Scope?scope.Scope.Regions[region].Scope["@"][index].GetValue():Null$1}(ctx.Context,resolvedArgs[0]||0,resolvedArgs[1]||0,resolvedArgs[2]||0)},GetRunningValue:(ctx,args)=>{const resolvedArgs=args.map((a=>SafeEval$2(a,ctx).Value));return ctx.Context?function(scope,aggregateIndexes){if(0===aggregateIndexes.length)return Tools.Variant.Null;let valueAggregate=scope.RunningValues[aggregateIndexes[0]],currentScope=scope.Parent;return aggregateIndexes.slice(1,Math.max(aggregateIndexes.length-1,1)).forEach((i=>{if(currentScope){const aggregate=currentScope.Previous?currentScope.Previous.RunningValues[i]:null;currentScope=currentScope.Parent,aggregate&&(valueAggregate=valueAggregate?valueAggregate.Combine(aggregate):aggregate)}})),null===valueAggregate?Tools.Variant.Null:valueAggregate.GetValue()}(ctx.Context,resolvedArgs):Null},GetCellRunningValue:(ctx,args)=>{const resolvedArgs=args.map((a=>SafeEval$2(a,ctx).Value));return ctx.Context?function(scope,data){let currentScope=scope,valueAggregate=null;return currentScope=GetLastTablixContext$1(currentScope),currentScope=currentScope&&currentScope.Parent,currentScope&&currentScope.Previous&&data.slice(3).forEach((i=>{if(currentScope){const aggregate=currentScope.Previous?currentScope.RunningValues[i]:null;currentScope=currentScope.Parent,aggregate&&(valueAggregate=valueAggregate?valueAggregate.Combine(aggregate):aggregate)}})),valueAggregate?valueAggregate.Combine(scope.CellRunningValues[MakeCellAggregateKey(data[0],data[1],data[2])]).GetValue():scope.CellRunningValues[MakeCellAggregateKey(data[0],data[1],data[2])].GetValue()}(ctx.Context,resolvedArgs):Null},GetCrossAggregate:(ctx,args)=>{const resolvedArgs=args.map((a=>SafeEval$2(a,ctx))).map((v=>v.Value));if(5!==resolvedArgs.length)throw new Error("Invalid arguments list for CrossAggregate function");return function(ctx,rowMemberId,rowDistance,colMemberId,colDistance,exprIndex){const tablix=GetTablix(ctx);if(null===tablix)return Null$1;const rowParentContext=FindParent(rowDistance,ctx.Parent);if(null===rowParentContext)return Null$1;const colParentContext=FindParent(colDistance,ctx.Column);if(null===colParentContext)return Null$1;const rowId=0===rowDistance?ctx.Parent.Member.Id:GetLeaf(GetCollectionItem$1(rowParentContext.Member.Members,rowMemberId)).Id,colId=0===colDistance?ctx.Column.Member.Id:GetLeaf(GetCollectionItem$1(colParentContext.Member.Members,colMemberId)).Id;return GetCollectionItem$1(tablix.Body,rowId).Cells[colId]["@"][exprIndex].GetValue()}(ctx.Context,resolvedArgs[0],resolvedArgs[1],resolvedArgs[2],resolvedArgs[3],resolvedArgs[4])},RowNumber:ctx=>ctx.Context?Create$3(ctx.Context.RowNumber):Null,Level:(ctx,args)=>{const resolvedArgs=args.map((a=>SafeEval$2(a,ctx))).map((v=>v.Value));return GetLevel(ctx.Context,resolvedArgs[0],resolvedArgs[1])},Previous:(ctx,args)=>{const resolvedArgs=args.map((a=>SafeEval$2(a,ctx))),path=(1<args.length&&resolvedArgs[1].Value||"").split(";").map((s=>s.trim())).filter((ts=>ts.length>0)).map((ts=>(ts=>{const arg=ts.split("_"),type="R"===arg[0]?"Region":"C"===arg[0]?"Column":"G"===arg[0]?"Group":"M"===arg[0]?"Member":"S"===arg[0]?"Scope":"T"===arg[0]?"Tablix":"Parent";return{IsRegion:"Region"===type,Indexes:"Region"===type||"Group"===type||"Member"===type?arg[1].split(",").filter((a=>a.length>0)).map((a=>parseInt(a))):[],Type:type}})(ts)));if(null===ctx.Context)return Null;const prev=function(ctx,path){return FindPreviousImpl(ctx,path)}(ctx.Context,path);return null!==prev?SafeEval$2(args[0],MakeEvaluationContext(prev.Data.FirstOrDefault(),prev)):Null},Lookup:(ctx,args)=>{if(4!==args.length)throw new Error("Invalid arguments list for Lookup function");const dataSetName=Tools.Variant.Convert.toString(SafeEval$2(args[3])),sourceKeyFn=args[0],valueFn=args[2],context=ctx.Context;if(context&&context.LookupStore){const sourceKey=SafeEval$2(sourceKeyFn,ctx),targetKeyFn=r=>SafeEval$2(args[1],MakeEvaluationContext(r,context)),lookupRecord=context.LookupStore.LookupRecord(dataSetName,args[1].ToString(),targetKeyFn,sourceKey);if(lookupRecord)return SafeEval$2(valueFn,MakeEvaluationContext(lookupRecord,context))}return Null},LookupSet:(ctx,args)=>{if(4!==args.length)throw new Error("Invalid arguments list for LookupSet function");const dataSetName=Tools.Variant.Convert.toString(SafeEval$2(args[3])),sourceKeyFn=args[0],valueFn=args[2],context=ctx.Context;if(context&&context.LookupStore){const sourceKey=SafeEval$2(sourceKeyFn,ctx),targetKeyFn=r=>SafeEval$2(args[1],MakeEvaluationContext(r,context)),lookupRecords=context.LookupStore.LookupRecords(dataSetName,targetKeyFn,sourceKey);if(lookupRecords)return Create$3(Array.from(lookupRecords).map((record=>SafeEval$2(valueFn,MakeEvaluationContext(record,context)))))}return Null},GetGroupIndex:(ctx,args)=>{var _a;const indexes=args.map((a=>SafeEval$2(a,ctx))).map((v=>v.Value)),distance=indexes.length>0?indexes[0]:-1,axis=indexes.length>1?indexes[1]:-1;return null!==(_a=function(ctx,distance,axis){if(!ctx.Parent)return Null$1;const result=function(ctx,distance,axis){let context=0===axis?ctx:null==ctx?void 0:ctx.Column;if(distance<0||!context)return null;let step=0;for(;context.Parent;){if(step==distance)return context;context=context.Parent,step++}return null}(ctx,distance,axis);return!result||result.GroupIndex<0?Null$1:Tools.Variant.Create(result.GroupIndex)}(ctx.Context,distance,axis))&&void 0!==_a?_a:Null}};AggregateFunctionNames.concat(["RunningValue"]).forEach((aggFunction=>customFunctions$1[aggFunction]=(ctx,args)=>function(fn,args){return ctx=>{const scope=ctx.Data;if(!scope||"Empty"===fn)return Tools.Variant.Null;switch(fn){case"First":const first=IterableFirst(scope.Records);return null==first?Tools.Variant.Null:SafeEval$2(args[0],MakeEvaluationContext(first,ctx));case"Last":const last=IterableLast(scope.Records);return null==last?Tools.Variant.Null:SafeEval$2(args[0],MakeEvaluationContext(last,ctx));case"ToArray":const arrayValues=LazyFilter(LazyMap(scope.Records,(r=>SafeEval$2(args[0],MakeEvaluationContext(r,ctx)))),(val=>"Null"!==val.Type));return Tools.Variant.Create(IterableToArray(arrayValues).map((v=>v.Value)));case"CountRows":return Tools.Variant.Create(IterableCount(scope.Records));case"Count":const values=LazyFilter(LazyMap(scope.Records,(r=>SafeEval$2(args[0],MakeEvaluationContext(r,ctx)))),(val=>"Null"!==val.Type));return Tools.Variant.Create(IterableToArray(values).length);case"Sum":case"Avg":case"Min":case"Max":case"Median":case"Mode":case"CountDistinct":case"Var":case"VarP":case"StDev":case"StDevP":{const context=ctx,evaluate=(arg,dataScope)=>{const aggregate=MakeAggregate(fn),data=LazyMap(dataScope.Records,(record=>{const recordScope=MakeContext(record,context,ctx.App);return SafeEval$2(arg,MakeEvaluationContext(recordScope.Data.FirstOrDefault(),ctx))}));for(let val of data)aggregate.Accumulate([val]);return aggregate.GetValue()};if(context&&context.ParentContext){if(context.ParentContext.Cache.has(args[0]))return context.ParentContext.Cache.get(args[0]);const result=evaluate(args[0],context.ParentContext.Data);return context.ParentContext.Cache.set(args[0],result),result}return evaluate(args[0],scope)}default:{const aggregate=MakeAggregate(fn),data=LazyMap(scope.Records,(record=>{const recordScope=MakeContext(record,null,ctx.App);return args.map((a=>SafeEval$2(a,MakeEvaluationContext(recordScope.Data.FirstOrDefault(),ctx))))}));for(let vals of data)aggregate.Accumulate(vals);return aggregate.GetValue()}}}}(aggFunction,args)(ctx.Context)));const compilerImpl=createTreeBuilder(customFunctions$1),compiler$5=expression=>{try{return compilerImpl(`${expression}`)}catch(err){return console.warn(err.message),compilerImpl("=Null")}};function compile$u(expression,cc=null){if(null===expression)return()=>Null;if(isVariant$1(expression))return()=>expression;if("string"!=typeof expression||"="!==expression.trim()[0])return()=>Create$3(expression);const compiled=compiler$5(expression);return ctx=>SafeEval$2(compiled,MakeEvaluationContext(ctx.Data.FirstOrDefault(),ctx))}function SafeEval$2(node,ctx){try{return ctx?node.Eval(ctx):node.EvalConst()}catch(err){return console.warn(err.message),Null}}function MakeContext(record,parentContext=null,app=null,lookupStore=null,rowNumber=0){return{App:app,Data:new RecordSet(null===record?[]:[record]),RowNumber:rowNumber,Cache:new Map,ParentContext:parentContext,LookupStore:lookupStore}}const MakeAggregateInfo=(func,args,scopeName=null,isNothingScope=!1,isRecursive=!1)=>({Func:func,Arguments:args,ScopeName:scopeName,IsNothingScope:isNothingScope,IsRecursive:isRecursive,IsScopeSpecified:isNothingScope||!!scopeName});function ToExpressionString(aggregateInfo){const args=aggregateInfo.Arguments.map((t=>t.ToString())).join(","),scopeArg=aggregateInfo.IsScopeSpecified?aggregateInfo.IsNothingScope?",Nothing":","+(aggregateInfo.ScopeName||""):"",recursiveArg=aggregateInfo.IsRecursive?",Recursive":"";return`=${aggregateInfo.Func}(${args}${scopeArg}${recursiveArg})`}const First=expr=>MakeAggregateInfo("First",[expr]);function Describe(expr){if(null===expr)return null;const functionName=ParseAggregateFunction(expr.Token.value.toString());return"Empty"===functionName||AggregateFunctionNames.indexOf(functionName)<0?null:DescribeImpl(functionName,expr.Children)}function DescribeImpl(functionName,args,isRunningValue=!1){if("Empty"===functionName||AggregateFunctionNames.indexOf(functionName)<0)return null;const count=function(fn,args,evalString){switch(fn){case"CountRows":return 0;case"DistinctSum":return 2;case"AggregateIf":if(args.length<2)return-1;const a=evalString(args[1]);return AggregateFunctionNames.indexOf(a)<0||"AggregateIf"===a?-1:"CountRows"===a?2:"DistinctSum"===a?4:3;default:return 1}}(functionName,args,EvalScopeName);if(count<0||count>0&&args.length<count)return null;const params=function(args,index){let isRecursive=!1,isNothingScope=!1,scopeName="";for(let state=0;state<3&&index<args.length;index++){const s=EvalScopeName(args[index]),sLower=s.toLowerCase();switch(state){case 0:"simple"===sLower||"recursive"===sLower?(isRecursive="recursive"===sLower,state=1):(isNothingScope="constant"===args[index].Token.type&&"nothing"===args[index].Token.value.toString().toLowerCase(),scopeName=isNothingScope?"":s,state=2);break;case 1:isNothingScope="constant"===args[index].Token.type&&"nothing"===args[index].Token.value.toString().toLowerCase(),scopeName=isNothingScope?"":s,state=3;break;case 2:isRecursive="recursive"===sLower,state=3}}return{isRecursive:isRecursive,isNothingScope:isNothingScope,scopeName:scopeName}}(args,count);if(isRunningValue){if(params.isRecursive)return null;params.isNothingScope=!params.scopeName}return{Func:functionName,Arguments:count===args.length?args:args.slice(0,count),ScopeName:params.scopeName,IsNothingScope:params.isNothingScope,IsRecursive:params.isRecursive,IsScopeSpecified:params.isNothingScope||!!params.scopeName}}function DescribeRowNumber(expr){const{scope:scope,isNothingScope:isNothingScope}=function(expression){let scope="",isNothingScope=!1;!expression||"constant"===expression.Token.type&&"nothing"===expression.Token.value.toLowerCase()?(scope="",isNothingScope=!0):scope=EvalScopeName(expression);return{scope:scope,isNothingScope:isNothingScope}}(expr.Children.length>0?expr.Children[0]:null);return{Func:"Count",Arguments:[compiler$5("=1")],ScopeName:scope,IsNothingScope:isNothingScope,IsRecursive:!1,IsScopeSpecified:isNothingScope||!!scope}}function EvalScopeName(e){return"constant"===e.Token.type||"variable"===e.Token.type?e.Token.value:Tools.Variant.Convert.toString(SafeEval$2(e))}const DefaultCrossScope={Member:{},Index:-1,Fields:[]};const MakeAggregateScope_ByRegion=(region,parent=null,index=0,adp=null)=>({Region:region,Name:region.Name,Parent:parent,Index:index,AggregateDataProvider:adp,Aggregates:[],Regions:[],Column:null,Group:null,TablixPosition:"None",MemberIndex:-1,IsDetail:!1,CrossScope:null,SkipInResult:!1}),MakeAggregateScope_ByColumn=(name,parent=null,column=null,position="None",memberIndex=-1)=>({Region:null,Name:name,Parent:parent,Index:0,AggregateDataProvider:null,Aggregates:[],Regions:[],Column:column,Group:null,TablixPosition:position,MemberIndex:memberIndex,IsDetail:!1,CrossScope:null,SkipInResult:!1}),MakeAggregateScope_ByGroup=(grp,parent=null,crossScope=null,skipInResult=!1,position="None",memberIndex=-1)=>({Region:null,Name:grp?grp.Name:"",Parent:parent,Index:0,AggregateDataProvider:parent?parent.AggregateDataProvider:null,Aggregates:[],Regions:[],Column:null,Group:grp||null,TablixPosition:position,MemberIndex:memberIndex,IsDetail:!!grp&&0===(grp.GroupExpressions||[]).length,CrossScope:crossScope,SkipInResult:skipInResult});function InsertAggregate(aggregateScope,agg){let i=aggregateScope.Aggregates.findIndex((a=>((a,b)=>a&&b&&a.Func===b.Func&&a.IsNothingScope===b.IsNothingScope&&a.IsRecursive===b.IsRecursive&&a.IsScopeSpecified===b.IsScopeSpecified&&a.ScopeName===b.ScopeName&&a.Arguments.length===b.Arguments.length&&a.Arguments.every(((arg,i)=>b.Arguments[i].ToString()===arg.ToString())))(a,agg)));return i>=0||(i=aggregateScope.Aggregates.length,aggregateScope.Aggregates.push(agg)),i}function MakeFields(aggregateScope){return aggregateScope.Aggregates.map(ToExpressionString)}function ResolveScope(current,name,makeResult){return[current,current.Column].map(((from,axis)=>ResolveScopeByPredicate(from,(t=>t.Name.toLowerCase()===(name||"").toLowerCase()),((scope,steps)=>makeResult(scope,steps,axis))))).find((t=>null!=t))}function ResolveScopeByPredicate(scope,predicate,makeResult){let steps=0;for(;null!=scope;){if(predicate(scope))return makeResult(scope,steps);scope=scope.Parent,steps++}return null}function SelfAndAncestors(scope){return{*[Symbol.iterator](){for(;scope;)yield scope,scope=scope.Parent}}}function ResolveAggregateFunction(provider,expr){if(null===provider)return"Empty";if("variable"===expr.Token.type){const match=expr.Token.value.toString().match(/^Fields[\.!](.+)\.Value$/i);match&&match[0]&&provider.GetAggregateFunction(match[0])}return"Empty"}function RequestRunningValue(scope,aggregate){if(scope.Region&&"report"===scope.Region.type)return RequestAggregate(scope,aggregate);if(scope.Column)return function(scope,agg){if(!agg.IsScopeSpecified||agg.IsNothingScope){let parent=scope.Parent;parent=function(scope){let result=null,context=scope;for(;context&&context.Parent;)context=context.Parent,context.Region&&"tablix"===context.Region.type&&(result=context);return result}(parent);const scopes=IterableToArray(LazyTakeWhile(SelfAndAncestors(parent.Parent),(t=>!(t.Region&&"dataset"===t.Region.type))));return scopes.length>0?`=GetCellRunningValue(${InsertAggregate(scope,agg)},-1,-1,${MakeArgs(scopes,agg)})`:`=GetCellRunningValue(${InsertAggregate(scope,agg)},-1,-1)`}const rowHeight=DistanceToScope(scope.Parent,agg.ScopeName||""),colHeight=DistanceToScope(scope.Column,agg.ScopeName||"");return-1==rowHeight&&-1==colHeight?"=Nothing":`=GetCellRunningValue(${InsertAggregate(scope,agg)},${rowHeight},${colHeight})`}(scope,aggregate);return`=GetRunningValue(${MakeArgs(function(scope,agg){if(!agg.IsScopeSpecified)return[scope];if(agg.IsNothingScope)return IterableToArray(LazyTakeWhile(SelfAndAncestors(scope),(t=>!(t.Region&&"dataset"===t.Region.type))));const list=[];let tempScope=scope;for(;tempScope;){if(list.push(tempScope),tempScope.Name.toLowerCase()===(agg.ScopeName||"").toLowerCase()||tempScope.Regions.some((r=>r.Name.toLowerCase()===(agg.ScopeName||"").toLowerCase())))return list;tempScope=tempScope.Parent}return[scope]}(scope,aggregate),aggregate)})`}function MakeArgs(scopes,agg){return IterableToArray(LazyMap(scopes,(t=>InsertAggregate(t,agg).toString()))).join(", ")}function DistanceToScope(scope,name){let distance=0;for(;scope;){if(scope.Name.toLowerCase()===name.toLowerCase())return distance;scope=scope.Parent,distance++}return-1}function RequestPrevious(scope,fn){var _a;const firstArg=fn.Children[0];!function(fn){if("function"!==fn.Token.type)return;if("previous"===fn.Token.value.toLowerCase())throw new Error("Previous function cannot contain nested Previous function.");if("aggregate"===fn.Token.value.toLowerCase())throw new Error("Previous function cannot contain nested Aggregate function.");if("level"===fn.Token.value.toLowerCase())throw new Error("Previous function cannot contain nested Level function.");if("inscope"===fn.Token.value.toLowerCase())throw new Error("Previous function cannot contain nested InScope function.");const agg=Describe(fn);if(agg){if(agg.IsRecursive)throw new Error("Previous function cannot contain nested recursive aggregates.");if("Aggregate"===agg.Func)throw new Error("Previous function cannot contain nested Aggregate function.")}}(firstArg);const nestedAgg=ContainsAggregates(firstArg)?RequestAggregates(scope,firstArg):RequestAggregate(scope,(expr=>MakeAggregateInfo("Last",[expr]))(firstArg)),scopeName=fn.Children[1]?EvalScopeName(fn.Children[1]):null;let path=scopeName||"None"!==scope.TablixPosition?null!==(_a=BuildPath(scope,scopeName))&&void 0!==_a?_a:BuildPath(scope,scopeName,!0):"";return"ColumnHeader"===scope.TablixPosition&&(path=`C;${null!=path?path:""}`),"None"!==scope.TablixPosition&&(path=`T;${null!=path?path:""}`),`=${fn.Token.value}(${clearExp(nestedAgg)},"${path}")`}function BuildPath(scope,scopeName,vertical=!1){var _a,_b;let path="";if(vertical&&(path+="C;",scope=null!==(_a=null==scope?void 0:scope.Column)&&void 0!==_a?_a:null),!scope)return null;let scopeFound=!1;for(let current of SelfAndAncestors(scope)){if(!(scopeFound||scopeName&&current.Name.toLowerCase()!==scopeName.toLowerCase())){if(scopeFound=!0,"None"===scope.TablixPosition)break;path+="S;"}if("tablix"===(null===(_b=current.Region)||void 0===_b?void 0:_b.type))break;current.Group?path+=`G_${MakeGroupKey(current,current.Group)};`:current.Region?path+=`R_${current.Index};`:path+="P;",current.MemberIndex>=0&&(path+=`M_${current.MemberIndex};`)}return scopeFound?path:null}function MakeGroupKey(parent,grp){return(grp.GroupExpressions||[]).map((expr=>RequestAggregate(parent,First(compiler$5(expr))))).filter((keyFn=>null!==keyFn)).map((keyFn=>compiler$5(keyFn).Children[0])).filter((arg=>!!arg)).map((arg=>arg.ToString())).join(",")}function FindScope(scope,aggScopeName){let distance=0;for(;null!==scope&&scope.Name.toLowerCase()!==aggScopeName.toLowerCase();)scope=scope.Parent,distance++;return{scope:scope,distance:distance}}const Exprs={Zero:"=0",Level:"=Level()",EmptyString:'=""',Nothing:"=Nothing"};function RequestExpression(scope,expr){return RequestExpressionNode(scope,compiler$5(expr))}function RequestExpressionNode(scope,expressionNode){return ContainsAggregates(expressionNode,!1,scope)||!function(e){return!!e&&e.Contains(fieldsRefRegexp,"variable")}(expressionNode)?RequestAggregates(scope,expressionNode):RequestAggregate(scope,First(expressionNode))}function RequestAggregates(scope,expr){if(null!==scope){const func=ResolveAggregateFunction(scope.AggregateDataProvider,expr);if("Empty"!==func)return RequestAggregate(scope,MakeAggregateInfo(func,[expr],scope.Name))}if("function"===expr.Token.type){const functionName=expr.Token.value.toLowerCase();if("."===functionName[0]){const target=RequestExpressionNode(scope,expr.Children[0]),args=expr.Children.slice(1).map((a=>RequestExpressionNode(scope,a)));return`=${clearExp(target)}${expr.Token.value}(${args.map(clearExp).join(",")})`}{let agg=Describe(expr);if(null!==agg){if(scope&&scope.IsDetail&&!agg.IsScopeSpecified&&null!==scope.Parent){let parent=scope.Parent;for(;parent&&!parent.Name;)parent=parent.Parent;parent&&parent.Name&&(agg=MakeAggregateInfo(agg.Func,agg.Arguments,parent.Name,!1,agg.IsRecursive))}return RequestAggregate(scope,agg)}if("previous"===functionName)return RequestPrevious(scope,expr);if("level"===functionName){const scopeName=expr.Children.length>0?EvalScopeName(expr.Children[0]):"";return function(current,scopeName){if(!scopeName){const t=pipe(SelfAndAncestors,iterable$2.asIndexed,iterable$2.findFirst((p=>null!==p.item.Group&&!!p.item.Group.Parent)))(current);return null!==t?`=Level(${t.index})`:Exprs.Level}const expr=ResolveScope(current,scopeName,((scope,steps,axis)=>`=Level(${steps}, ${axis})`));return null==expr?Exprs.Zero:expr}(scope,scopeName)}if("runningvalue"===functionName)return agg=function(expr){if(expr.Children.length<2)return null;const fn=ParseAggregateFunction(EvalScopeName(expr.Children[1]));switch(fn){case"Empty":case"Aggregate":case"First":case"Last":return null}return DescribeImpl(fn,"DistinctSum"===fn?[expr.Children[0],expr.Children[0]].concat(expr.Children.slice(2)):[expr.Children[0]].concat(expr.Children.slice(2)),!0)}(expr),agg?RequestRunningValue(scope,agg):"=Nothing";if("rownumber"===functionName)return agg=DescribeRowNumber(expr),RequestRunningValue(scope,agg);if("crossaggregate"===functionName)return function(scope,fn){var _a,_b,_c,_d;if(fn.Children.length<4)return console.warn(`The CrossAggregate function must be invoked with 4 arguments but invoked with ${fn.Children.length}: ${null===(_a=fn.Token.raw)||void 0===_a?void 0:_a.expression}`),Exprs.Nothing;const aggType=fn.Children[1].EvalConst().Value,aggExpression=fn.Children[0].ToString(),columnScopeName=EvalScopeName(fn.Children[2]),rowScopeName=EvalScopeName(fn.Children[3]),{scope:rowScope,distance:rowDistance}=FindScope(scope.Parent,rowScopeName),{scope:columnScope,distance:colDistance}=FindScope(scope.Column,columnScopeName);if(null==rowScope||null==columnScope)return console.warn(`Invalid scope specified for the CrossAggregate function: ${null===(_b=fn.Token.raw)||void 0===_b?void 0:_b.expression}`),Exprs.Nothing;if("tablix"===(null===(_c=rowScope.Region)||void 0===_c?void 0:_c.type)){const agg=Describe(compiler$5(`=${aggType}(${aggExpression}, ${columnScopeName})`));return agg?RequestAggregate(scope,agg):Exprs.Nothing}if("tablix"===(null===(_d=columnScope.Region)||void 0===_d?void 0:_d.type)){const agg=Describe(compiler$5(`=${aggType}(${aggExpression}, ${rowScopeName})`));return agg?RequestAggregate(scope,agg):Exprs.Nothing}if(0===rowDistance&&0===colDistance){const agg=Describe(compiler$5(`=${aggType}(${aggExpression})`));return agg?RequestAggregate(scope,agg):Exprs.Nothing}if(null===rowScope.CrossScope||null===columnScope.CrossScope)return Exprs.EmptyString;const aggregateScope=0===rowDistance?columnScope:rowScope,exprIndex=function(expr,fields){const idx=fields.indexOf(expr);return idx>=0?idx:(fields.push(expr),fields.length-1)}(compiler$5(`=${aggType}(${aggExpression})`),aggregateScope.CrossScope.Fields);return`=GetCrossAggregate(${rowScope.CrossScope.Index},${rowDistance},${columnScope.CrossScope.Index},${colDistance},${exprIndex})`}(scope,expr);if("groupindex"===functionName){const groupName=expr.Children.length>0?EvalScopeName(expr.Children[0]):scope.Name;return function(currentScope,scopeName){let axis=0,distance=GetScopeDistance(currentScope,scopeName);distance<0&&scopeName&&currentScope.Column&&(axis=1,distance=GetScopeDistance(currentScope.Column,scopeName));return`=GetGroupIndex(${distance}, ${axis})`}(scope,groupName)}}const args=expr.Children.map((a=>RequestExpressionNode(scope,a)));return`=${expr.Token.value}(${args.map(clearExp).join(",")})`}if("operator"===expr.Token.type){if(1===expr.Token.arity){const right=expr.Children[0]&&RequestExpressionNode(scope,expr.Children[0]);return`=${expr.Token.value} (${clearExp(right)})`}{const left=expr.Children[0]&&RequestExpressionNode(scope,expr.Children[0]),right=expr.Children[1]&&RequestExpressionNode(scope,expr.Children[1]);return`=(${clearExp(left)}) ${expr.Token.value} (${clearExp(right)})`}}return`=${expr.ToString()}`}function RequestAggregate(current,agg){if(!agg.IsScopeSpecified)return InsertAndMakeExpr(agg,current);let expr;return agg.IsNothingScope?(expr=ResolveScopeByPredicate(current,(t=>null!==t.Region&&"dataset"===t.Region.type),((scope,steps)=>InsertAndMakeExpr(agg,scope,steps))),expr||InvalidScope(current,agg)):(expr=ResolveScope(current,agg.ScopeName,((scope,steps,axis)=>InsertAndMakeExpr(agg,scope,steps,axis))),null!=expr?expr:(expr=function(scope,name,makeResult){let steps=0;for(;null!==scope;){const i=scope.Regions.findIndex((t=>t.Name.toLowerCase()===(name||"").toLowerCase()));if(i>=0)return makeResult(scope.Regions[i],steps,i);scope=scope.Parent,steps++}return null}(current,agg.ScopeName,((scope,steps,region)=>`=GetRegionAggregate(${InsertAggregate(scope,agg)}, ${steps}, ${region})`)),expr||InvalidScope(current,agg)))}function InsertAndMakeExpr(agg,scope,steps=0,axis=0){const recursive=agg.IsRecursive?1:0,i=InsertAggregate(scope,agg=MakeAggregateInfo(agg.Func,agg.Arguments));let optionalArgs=[steps,axis,recursive];optionalArgs.reverse(),optionalArgs=optionalArgs.slice(optionalArgs.findIndex((t=>0!==t))),optionalArgs.reverse();return`=GetAggregate(${i}${optionalArgs.length>0?","+optionalArgs.join(","):""})`}function InvalidScope(scope,agg){return InsertAndMakeExpr(agg,scope)}const aggregateRegexp=new RegExp(`^(${AggregateFunctionNames.concat(["level","runningvalue","rownumber","previous","crossaggregate","groupindex"]).join("|")})$`,"i");function ContainsAggregates(e,withScope=!1,scope=null){return null!==e&&""!==e.Token.value&&!!e.Contains(aggregateRegexp,"function")}const fieldsRefRegexp=/^Fields(\.|!|$)/i;function GetScopeDistance(initialScope,scopeName){let distance=0,scope=initialScope;for(;scope;){if(!scopeName&&scope.Name||scope.Name&&scope.Name.toLowerCase()===scopeName.toLowerCase())return distance;scope=scope.Parent,distance++}return-1}function clearExp(expr){return expr&&"="===expr[0]?expr.replace("=",""):expr}function MakeLookupStore(getRecordSet){const _indexes={};return{LookupRecord:(dataSetName,indexId,keyFn,key)=>{if(!getRecordSet)return null;const index=((dataSetName,indexId,keyFn)=>{_indexes[dataSetName]||(_indexes[dataSetName]=new Map);const dataSetIndex=_indexes[dataSetName];if(!dataSetIndex.has(indexId)){const recordSet=getRecordSet(dataSetName);if(!recordSet)return null;const index=new VariantMap;for(const record of recordSet){const key=keyFn(record);Tools.Variant.IsNull(key)||index.hasKey(key)||index.set(key,record)}dataSetIndex.set(indexId,index)}return dataSetIndex.get(indexId)||null})(dataSetName,indexId,keyFn);return index&&index.get(key)},LookupRecords:function(dataSetName,keyFn,key){return getRecordSet?{*[Symbol.iterator](){const recordSet=getRecordSet(dataSetName);if(recordSet)for(const record of recordSet){const keyVal=keyFn(record);Tools.Variant.Comparison.Equals(keyVal,key).Value&&(yield record)}}}:null}}}function MakeRecordSetKey(name,parameters){return`[${name}>${parameters.map((p=>`(${p.Name}|${p.Value.Type}|${p.Value.Value})`)).join("#")}]`}function MakeRecordSetProvider(getDataSet,data=null,agg=null){return{GetDataSet:getDataSet,Data:data,Agg:agg,LookupStore:MakeLookupStore((x=>getDataSet(MakeRecordSetKey(x,[]))))}}function MakeRow(cells,skipInResult=!1){return{Cells:cells,SkipInResult:skipInResult}}const MakeIdxFn=()=>{let i=0;return member=>IsLeafMember(member)?i++:-1};function TablixImpl(tablix){const rowIdx=MakeIdxFn(),columnIdx=MakeIdxFn(),leafColumnScopes=[],body=[],crossMembersByGroupName=new Map;function ProcessColumnMember(parent,member,memberIndex,crossScope=!1){const scope=MakeAggregateScope_ByGroup(member.Group,parent,FindCrossContext(member),crossScope,"ColumnHeader",memberIndex),content=ProcessContent(scope,member.Header),kids=(member.Members||[]).map(((m,i)=>ProcessColumnMember(scope,m,i))),crossMemberCtx=crossMembersByGroupName.get(scope.Name);if(crossMemberCtx&&crossMemberCtx.Member!==member){const crossMember=ProcessColumnMember(scope,crossMemberCtx.Member,-1,!0);kids.push(crossMember)}return columnIdx(member)>=0&&leafColumnScopes.push(scope),{Scope:scope,Members:kids,Content:content,Group:member.Group?ProcessGroup(scope,member.Group):null,Sort:member.Group?ProcessSort(scope,member.Sort):null}}function ProcessRowMember(parent,member,memberIndex){const scope=MakeAggregateScope_ByGroup(member.Group,parent,FindCrossContext(member),!1,"RowHeader",memberIndex),content=ProcessContent(scope,member.Header);let kids=(member.Members||[]).map(((m,i)=>ProcessRowMember(scope,m,i)));const idx=rowIdx(member);if(idx>=0&&tablix.Body.length>0){const row=tablix.Body[idx];let columnCrossOffset=0;const cells=leafColumnScopes.map(((colScope,i)=>{if(colScope.SkipInResult)return columnCrossOffset++,NoResultContent(colScope.Parent.CrossScope.Fields);return ProcessContent(MakeAggregateScope_ByColumn("",scope,colScope,"Body"),row.Cells[i-columnCrossOffset])}));body.push(MakeRow(cells))}if(null!==scope.CrossScope&&member!==scope.CrossScope.Member){const crossMember=function(parent,member){const scope=MakeAggregateScope_ByGroup(member.Group,parent,FindCrossContext(member),!0),content=ProcessContent(scope,member.Header);return{Scope:scope,Members:[],Content:content,Group:member.Group?ProcessGroup(scope,member.Group):null,Sort:member.Group?ProcessSort(scope,member.Sort):null}}(scope,scope.CrossScope.Member),cells=leafColumnScopes.map(((colScope,i)=>NoResultContent(scope.CrossScope.Fields)));body.push(function(cells){return MakeRow(cells,!0)}(cells)),kids=kids.concat([crossMember])}return{Scope:scope,Members:kids,Content:content,Group:member.Group?ProcessGroup(scope,member.Group):null,Sort:member.Group?ProcessSort(scope,member.Sort):null}}const NoResultContent=fields=>({Aggregate:Def.Makers.Content(fields.map((f=>{var _a;return null===(_a=f.Token.raw)||void 0===_a?void 0:_a.expression}))),Result:null});function*Disassemble(expr){switch(yield expr,expr.Token.type){case"operator":for(const operand of expr.Children)for(const e of Disassemble(operand))yield e;break;case"function":{for(const e of flatten(expr.Children.map((a=>Disassemble(a)))))yield e;const functionName=expr.Token.value;if(functionName&&"."===functionName[0])for(const e of Disassemble(expr.Children[0]))yield e;break}}}function flatten(arr){const res=[];for(const subArr of arr)res.push(...subArr);return res}function FindMember(tablixColumnMembers,rowScopeName){var _a;for(const m of tablixColumnMembers){if((null===(_a=m.Group)||void 0===_a?void 0:_a.Name)===rowScopeName)return m;if(null!=m.Members){const child=FindMember(m.Members,rowScopeName);if(null!==child)return child}}return null}function FindCrossContext(member){var _a;const crossContext=!!(null===(_a=member.Group)||void 0===_a?void 0:_a.Name)&&crossMembersByGroupName.get(member.Group.Name);return crossContext||null}return function(parent,index){const scope=MakeAggregateScope_ByRegion(tablix,parent,index),content=ProcessContent(scope,tablix.Content),filters=tablix.Filters||[],sort=ProcessSort(scope,tablix.Sorts);!function(tablixBody){const fields=flatten(tablixBody.map((r=>r.Cells))).map((c=>{var _a;return null!==(_a=c.Fields)&&void 0!==_a?_a:[]})),exprNodes=flatten(fields).map((f=>compiler$5(f))),exprArr=flatten(exprNodes.map(Disassemble)),bodyExpressions=[];for(const expressionNode of exprArr)"function"===expressionNode.Token.type&&4===expressionNode.Children.length&&"crossaggregate"===expressionNode.Token.value&&bodyExpressions.push(expressionNode);for(const expr of bodyExpressions){const columnScopeName=EvalScopeName(expr.Children[2]),rowScopeName=EvalScopeName(expr.Children[3]),rowParent=FindMember(tablix.RowMembers,rowScopeName),columnParent=FindMember(tablix.ColumnMembers,columnScopeName);if(!(null===rowParent||null===columnParent||IsLeafMember(rowParent)&&IsLeafMember(columnParent))){if(!crossMembersByGroupName.has(rowScopeName))if(IsLeafMember(rowParent))crossMembersByGroupName.set(rowScopeName,Object.assign(Object.assign({},DefaultCrossScope),{Member:rowParent}));else{const member=Def.Makers.TablixMember(null,null,Def.Makers.Content([Exprs.EmptyString]),[]);crossMembersByGroupName.set(rowScopeName,{Member:member,Index:rowParent.Members.length,Fields:[]})}if(!crossMembersByGroupName.has(columnScopeName))if(IsLeafMember(columnParent))crossMembersByGroupName.set(columnScopeName,Object.assign(Object.assign({},DefaultCrossScope),{Member:columnParent}));else{const member=Def.Makers.TablixMember(null,null,Def.Makers.Content([Exprs.EmptyString]),[]);crossMembersByGroupName.set(columnScopeName,{Member:member,Index:columnParent.Members.length,Fields:[]})}}}}(tablix.Body);const columnMembers=tablix.ColumnMembers.map(((m,i)=>ProcessColumnMember(scope,m,i))),rowMembers=tablix.RowMembers.map(((m,i)=>ProcessRowMember(scope,m,i)));return{Aggregate:Def.Makers.Tablix(tablix.Name,filters,columnMembers.map(MakeAggregateMember),rowMembers.map(MakeAggregateMember),CompleteContent(scope,content.Aggregate),body.map((r=>Def.Makers.TablixRow(r.Cells.map((t=>t.Aggregate)).filter(isNotNull$2)))),sort.Aggregate),Result:Def.Makers.Tablix(tablix.Name,null,columnMembers.filter((m=>!m.Scope.SkipInResult)).map(MakeResultMember),rowMembers.filter((m=>!m.Scope.SkipInResult)).map(MakeResultMember),content.Result,body.filter((r=>!r.SkipInResult)).map((r=>Def.Makers.TablixRow(r.Cells.map((c=>c.Result)).filter(isNotNull$2)))),sort.Aggregate)}}}function MakeAggregateMember(mem){const header=CompleteContent(mem.Scope,mem.Content.Aggregate);return Def.Makers.TablixMember(mem.Group&&mem.Group.Aggregate,mem.Sort&&mem.Sort.Aggregate,header,mem.Members.map(MakeAggregateMember))}function MakeResultMember(mem){return Def.Makers.TablixMember(mem.Group&&mem.Group.Result,mem.Sort&&mem.Sort.Result,mem.Content.Result,mem.Members.filter((m=>!m.Scope.SkipInResult)).map(MakeResultMember))}function Process(report,rsp=null){const t=ProcessRegion(null,report,0,rsp);return{Aggregate:t.Aggregate,Result:t.Result}}function ProcessRegion(parent,region,index=0,rsp=null){if("tablix"===region.type){return TablixImpl(region)(parent,index)}let scope=null;parent&&(scope=parent.Regions.find((t=>t.Name==region.Name))||null),scope||(scope=MakeAggregateScope_ByRegion(region,parent,index,null!=rsp&&null!==rsp.Data?()=>rsp.Data.AggregateDataProvider:null)),scope.Regions.push(...(region.Content&&region.Content.Regions||[]).map(((r,i)=>MakeAggregateScope_ByRegion(r,scope,i,null!==rsp&&null!==r&&"dataset"===r.type?()=>function(provider,dataSetName){if(null!==provider.Agg)return provider.Agg(dataSetName);const ds=provider.GetDataSet(MakeRecordSetKey(dataSetName,[]));return ds&&ds.AggregateDataProvider?ds.AggregateDataProvider:null}(rsp,r.Name):null))));const filters=region.Filters||[],content=ProcessContent(scope,region.Content,rsp);if("list"===region.type){const groupScope=MakeAggregateScope_ByGroup(region.Group,scope),sort=ProcessSort(groupScope,region.Sort),grp=ProcessGroup(groupScope,region.Group),groupContent=ProcessContent(groupScope,region.GroupContent,rsp),listContent=CompleteContent(scope,content.Aggregate);return{Aggregate:Def.Makers.List(region.Name,listContent,filters,grp.Aggregate,sort.Aggregate,groupContent.Aggregate,!!region.HandleEmptyGroups),Result:Def.Makers.List(region.Name,content.Result,[],grp.Result,sort.Result,groupContent.Result,!!region.HandleEmptyGroups)}}if("dataset"===region.type){const parameterRes=(region.Parameters||[]).map((parameter=>Def.Makers.Parameter(parameter.Name,RequestExpression(scope,parameter.Value))));return{Aggregate:Def.Makers.DataSet(region.Name,filters,content.Aggregate,region.FieldNames,region.Parameters),Result:Def.Makers.DataSet(region.Name,[],content.Result,region.FieldNames,parameterRes)}}if("report"===region.type)return{Aggregate:Def.Makers.Report(region.Name,content.Aggregate),Result:Def.Makers.Report(region.Name,content.Result)};if("subreport"===region.type){const t=Process(region.Report),parameterRes=(region.Parameters||[]).map((parameter=>Def.Makers.Parameter(parameter.Name,RequestExpression(scope,parameter.Value))));return{Aggregate:Def.Makers.Subreport(region.Name,t.Aggregate,region.Parameters,Def.Makers.Content(content.Aggregate&&content.Aggregate.Fields||[])),Result:Def.Makers.Subreport(region.Name,t.Result,parameterRes,Def.Makers.Content(content.Result&&content.Result.Fields||[]))}}return{Aggregate:Def.Makers.SimpleRegion(region.Name,filters,content.Aggregate),Result:Def.Makers.SimpleRegion(region.Name,[],content.Result)}}function ProcessGroup(scope,grp){if(null==grp)return{Aggregate:null,Result:null};const filters=function(scope,grp){if(null===grp)return{Aggregate:null,Result:null};Validate(grp.Filters,"Group");const first=[],second=[];for(let f of grp.Filters||[])IsSimpleFilter(f)?first.push(f):second.push(Def.Makers.Filter(RequestExpression(scope,f.Expression),f.Op,f.Values.map((v=>RequestExpression(scope,v)))));return{Aggregate:first,Result:second}}(scope,grp);let groupBy=grp.GroupExpressions||[],parent=grp.Parent;if(parent){if(1!==groupBy.length)throw Error("Parent is only allowed if the grouping has exactly one group expression.");groupBy=[RequestExpression(scope,groupBy[0])],parent=RequestExpression(scope,parent)}return{Aggregate:Def.Makers.Group(grp.Name,grp.GroupExpressions,filters.Aggregate),Result:Def.Makers.Group(grp.Name,groupBy,filters.Result,parent)}}function IsSimpleFilter(filter){return!ContainsAggregates(compiler$5(filter.Expression),!0)&&filter.Values.every((e=>!ContainsAggregates(compiler$5(filter.Expression),!0)))}function ProcessSort(scope,sort){if(!sort)return{Aggregate:null,Result:null};const first=[],second=[];for(let s of sort)ContainsAggregates(compiler$5(s.Expression),!0)?second.push(Def.Makers.Sort(RequestExpression(scope,s.Expression),s.Direction)):first.push(s);return{Aggregate:first,Result:second}}function ProcessContent(scope,content,rsp=null){if(!content)return{Aggregate:null,Result:null};const fields=(content.Fields||[]).map((f=>RequestExpression(scope,f))),regions=(content.Regions||[]).map(((r,i)=>ProcessRegion(scope,r,i,rsp)));return{Aggregate:Def.Makers.Content(MakeFields(scope),regions.map((r=>r.Aggregate))),Result:Def.Makers.Content(fields,regions.map((r=>r.Result)))}}function CompleteContent(scope,content){return Def.Makers.Content(MakeFields(scope),content&&content.Regions||[])}function MakeFn$1(dataSet,def,handleEmptyGroups=!1){if(!def)return t=>[t];if(!def.GroupExpressions||0==def.GroupExpressions.length)return handleEmptyGroups?ctx=>[ctx.MakeContextWithData(new RecordSet(ctx.Data.Records))]:ctx=>LazyMap(ctx.Data.Records,(r=>ctx.MakeContextWithData(new RecordSet([r]))));const cc=MakeCompileContext(dataSet),fields=(def.GroupExpressions||[]).map((e=>compile$u(e,cc)));let rowNumber=1;return ctx=>LazyMap(IterableGroupBy(ctx.Data.Records,(record=>{let tx=MakeContext(record,null,ctx.ExpressionContext,null,rowNumber++),vals=fields.map((fn=>fn(tx)));return 1===vals.length?vals[0].Value:makeMultiKey(vals)})),(([_,g])=>ctx.MakeContextWithData(new RecordSet(g))))}const makeMultiKey=vals=>`MultiKey(${vals.map((v=>`{${v.Type}|${v.Value}}`)).join(";")})`;function MakeFn(context,fields){const aggrs=fields.map((f=>function(cc,expr){const fieldAggFunc=cc&&ResolveAggregateFunction(cc.AggregateDataProvider,expr)||"Empty";if("Empty"!==fieldAggFunc)return{Func:fieldAggFunc,Args:expr.Children,IsSingleArgument:isSingleArgument(fieldAggFunc)};const agg=Describe("function"===expr.Token.type?expr:compiler$5(`=First(${expr.ToString()})`));return{Func:agg.Func,Args:agg.Arguments,IsSingleArgument:isSingleArgument(agg.Func)}}(context,f)));if(0===aggrs.length)return()=>[];const onlyFirst=aggrs.every((a=>"First"===a.Func));return exc=>{const aggregates=aggrs.map((a=>MakeAggregate(a.Func))),parentContext=function(scope,app=null,lookupStore=null){if(!scope)throw new Error("scope is null");return{App:app,Data:scope,RowNumber:0,Cache:new Map,ParentContext:null,LookupStore:lookupStore}}(exc.Data,exc.ExpressionContext,exc.DataSets.LookupStore);if(IterableAny(exc.Data.Records)){for(let record of exc.Data.Records)if(Accumulate(MakeContext(record,parentContext,exc.ExpressionContext,exc.DataSets.LookupStore),aggrs,aggregates),onlyFirst)break}else Accumulate(MakeContext(null,parentContext,exc.ExpressionContext,exc.DataSets.LookupStore),aggrs,aggregates);return aggregates}}function Accumulate(ctx,aggrs,aggregates){const evalCtx=MakeEvaluationContext(ctx.Data.FirstOrDefault(),ctx);for(let i=0;i<aggrs.length;i++){const aggr=aggrs[i];if(ctx.Data.Any()||"First"===aggr.Func||"Last"===aggr.Func)if(aggr.IsSingleArgument){const val=SafeEval$2(aggr.Args[0],evalCtx);if("Object"==val.Type&&isAggregate(val.Value))aggregates[i]=aggregates[i].Combine(val.Value);else if("Object"===val.Type&&Array.isArray(val.Value))for(const item of val.Value)aggregates[i].Accumulate([item]);else aggregates[i].Accumulate([val])}else{const vals=aggr.Args.map((t=>SafeEval$2(t,evalCtx)));aggregates[i].Accumulate(vals)}}}const isAggregate=obj=>obj.Function&&obj.GetState&&obj.Accumulate&&obj.SetState&&obj.Combine,isSingleArgument=func=>"Sum"===func||"Avg"===func||"Max"===func||"Min"===func||"Count"===func||"CountDistinct"===func||"StDev"===func||"StDevP"===func||"Var"===func||"VarP"===func||"First"===func||"Last"===func||"Median"===func||"Mode"===func;const MakeIndexFn=()=>{let i=0;return member=>IsLeafMember(member)?i++:-1};function MakeTablix(dpu,dataSet,tablix,parentDataSet=null){const cornerFn=MakeScopeFn(dpu,dataSet,tablix.Content),tablixFilter=MakeRegionFilter(tablix,dataSet,parentDataSet),sortFn=MakeSortContextFn(tablix.Sorts||[],null,dataSet),colLeafIndex=MakeIndexFn(),rowLeafIndex=MakeIndexFn(),colFns=MakeMembers(dpu,dataSet,tablix.ColumnMembers,colLeafIndex),rowFns=MakeMembers(dpu,dataSet,tablix.RowMembers,rowLeafIndex),bodyFns=tablix.Body.map((row=>row.Cells.map((cell=>MakeScopeFn(dpu,dataSet,cell))))),is2D=FlattenMembers(tablix.ColumnMembers).some((t=>!!t&&!!t.Group));return exc=>{exc=Apply$1(exc=Apply$2(exc,tablixFilter),sortFn);const corner=cornerFn(exc),rootCtx=exc.MakeContext(corner.Id);let columnMembers=[],rowMembers=[];const getColumnLeafs=GetLeafsFn((()=>columnMembers),IsLeafTxMember,(m=>m.MakeMembers(m.Data)),!1),getRowLeafs=GetLeafsFn((()=>rowMembers),IsLeafTxMember,(m=>m.MakeMembers(m.Data)),!0),colId=MakeIdFn(getColumnLeafs),rowId=MakeIdFn(getRowLeafs);columnMembers=colFns.map((fn=>fn(rootCtx,colId))),rowMembers=rowFns.map((fn=>fn(rootCtx,rowId)));const columnsData=columnMembers.map((m=>MakeTablixMember(m,rootCtx))),rowsData=rowMembers.map((m=>MakeTablixMember(m,rootCtx))),colScopes=LazyMap(GetLeafsFn((()=>columnsData),(m=>void 0!==m.Id&&m.Id>=0),(m=>m.Members),!1)(),(m=>m.Header.Id)),rowScopes=LazyMap(GetLeafsFn((()=>rowsData),(m=>void 0!==m.Id&&m.Id>=0),(m=>m.Members),!0)(),(m=>m.Header.Id)),rootScopeId=corner.Id;return DataTree.Makers.Tablix(corner,columnsData,rowsData,(()=>{const columns=IterableToArray(LazyZipEx(getColumnLeafs(),colScopes,((i,m,c)=>({Member:m,ScopeId:c}))));return LazyMap(LazyZipEx(getRowLeafs(),rowScopes,((i,m,c)=>({Member:m,ScopeId:c}))),(rowLeaf=>{const rowMember=rowLeaf.Member,rowMemberData=is2D?rowMember.Data:null,cells=columns.map((column=>{const columnMember=column.Member,cellFn=bodyFns[rowMember.DefIndex][columnMember.DefIndex],data=is2D?function(rowMember,colMember){const rs1=rowMember?IterableToArray(rowMember.Records):[],rs2=colMember?IterableToArray(colMember.Records):[],records=Intersect(rs1,rs2,(t=>t.Index));return new RecordSet(records)}(rowMemberData,columnMember.Data):rowMember.Data;var rowScopeId,colScopeId;return cellFn(exc.MakeContextWithData(data,(rowScopeId=rowLeaf.ScopeId,colScopeId=column.ScopeId,rowScopeId===rootScopeId?colScopeId:colScopeId===rootScopeId?rowScopeId:null)))}));return DataTree.Makers.TablixRow(cells)}))}),tablix.Name)}}function Once(fn){let result=null;return d=>(result||(result=Memoize$2(fn(d))),result)}function CreateTxMember(idFn,def,data,makeMembers){return{Data:data,DefIndex:def.DefIndex,Header:def.HeaderFn,IsCollection:def.IsCollection,IdFn:idFn,MakeMembers:Once(makeMembers),_id:-1}}const IsLeafTxMember=m=>!m.IsCollection&&m.DefIndex>=0;function MakeTablixMember(m,ctx){const header=m.Header?m.Header(ctx.MakeContextWithData(m.Data,ctx.ScopeId)):null,childScopeId=header?header.Id:null,childCtx=Object.assign(Object.assign({},MakeExecutionContext(ctx,ctx.Data)),{ScopeId:childScopeId});return DataTree.Makers.TablixMember(header,m.IsCollection,(m=>IsLeafTxMember(m)?(m._id<0&&(m._id=m.IdFn(m)),m._id):-1)(m),(()=>LazyMap(m.MakeMembers(m.Data),(mb=>MakeTablixMember(mb,childCtx)))))}const MakeMembers=(dpu,dataSet,members,idx)=>IterableToArray(LazyMap(members,(m=>function(dpu,dataSet,def,idx){const isDynamic=!!def.Group,groupFn=MakeFn$1(dataSet,def.Group),filter=MakeGroupFilter(def.Group||null,def.Header||Def.EmptyContent,dataSet),sort=MakeSortContextFn(def.Sort,def.Header||Def.EmptyContent,dataSet),childFns=MakeMembers(dpu,dataSet,def.Members||[],idx),memberDef={DefIndex:idx(def),HeaderFn:MakeScopeFn(dpu,dataSet,def.Header||Def.EmptyContent),IsCollection:!1},collectionDef={DefIndex:-1,HeaderFn:null,IsCollection:!0};return(ctx,idFn)=>isDynamic?CreateTxMember(null,collectionDef,null,(()=>LazyMap(sort(filter(groupFn(ctx))),(member=>CreateTxMember(idFn,memberDef,member.Data,(d=>childFns.map((fn=>fn(ctx.MakeContextWithData(d),idFn))))))))):(def.Sort&&def.Sort.length>0&&(ctx=Apply$1(ctx,sort)),CreateTxMember(idFn,memberDef,ctx.Data,(d=>childFns.map((fn=>fn(ctx,idFn))))))}(dpu,dataSet,m,idx))));const toLowerCaseParameters=dataParameters=>dataParameters.map((p=>Object.assign(Object.assign({},p),{Name:p.Name.toLowerCase()})));function Run(report,makeContext,dataParameters,sortState=null){if(!report)throw new Error("Report is null");const reportCtx=makeContext(report,toLowerCaseParameters(dataParameters)),defs=Process(report,reportCtx.DataSets),agg=function(report,makeContext,rc){if(null===report)throw new Error("Report is null");let scopeId=0;return MakeReportRegionFn({makeContext:makeContext,nextScopeId:()=>++scopeId},null,report)(rc,null)}(defs.Aggregate,makeContext,reportCtx),data=Generate(defs.Result,defs.Aggregate,agg,sortState,reportCtx.ExpressionContext,makeContext);return{AggregateTree:{Definition:defs.Aggregate,Data:agg.Scope},DataTree:{Definition:defs.Result,Data:data.Scope}}}function MakeExecutionContextByRecordSet(dataSets,data,expressionContext,parentQueryContext=null){const exprContext=expressionContext||{Culture:"",Parameters:{}},ec={App:exprContext,ScopeId:null,DataSets:dataSets||MakeRecordSetProvider((()=>null)),Data:data||RecordSet.Empty,ExpressionContext:exprContext,ParentQueryContext:parentQueryContext,MakeContextWithData:(data,scopeId=null)=>Object.assign(Object.assign({},MakeExecutionContext(ec,data)),{ScopeId:scopeId}),MakeContext:(scopeId=null)=>Object.assign(Object.assign({},MakeExecutionContext(ec,ec.Data)),{ScopeId:scopeId})};return ec}function MakeExecutionContext(current,data){const ec={App:current.App,ScopeId:null,DataSets:current.DataSets,Data:data,ExpressionContext:current.ExpressionContext,ParentQueryContext:current.ParentQueryContext,MakeContextWithData:(data,scopeId=null)=>Object.assign(Object.assign({},MakeExecutionContext(ec,data)),{ScopeId:scopeId}),MakeContext:(scopeId=null)=>Object.assign(Object.assign({},MakeExecutionContext(ec,ec.Data)),{ScopeId:scopeId})};return ec}function MakeReportRegionFn(dpu,dataSet,def){const regionFn=MakeSimpleRegionFn(dpu,dataSet,def);return(rc,ctx)=>{let exectx=MakeExecutionContextByRecordSet(rc.DataSets,rc.DataSets.Data,rc.ExpressionContext,ctx);if(null!==rc.DataSets.Data){exectx=Apply$2(exectx,MakeRegionFilter(def.Content.Regions.filter((region=>"dataset"===region.type))[0]))}return regionFn(exectx)}}function MakeSimpleRegionFn(dpu,dataSet,def){const scopeFn=MakeScopeFn(dpu,dataSet,def.Content),filter=MakeRegionFilter(def,dataSet);return exc=>{const data=Apply$2(exc,filter);return{Scope:scopeFn(data),Name:def.Name,Groups:[]}}}function MakeScopeFn(dpu,dataSet,cell,parentDataSet=null){if(!cell||Def.IsEmptyContent(cell))return ctx=>({Id:ctx&&null!==ctx.ScopeId?ctx.ScopeId:dpu.nextScopeId(),"@":[],Regions:[]});const fields=MakeFn(MakeCompileContext(dataSet),cell.Fields.map((f=>compiler$5(f)))),regions=cell.Regions.map((r=>function(dpu,dataSet,def,parentDataSet){return"list"===def.type?function(dpu,dataSet,def,parentDataSet=null){const scopeFn=MakeScopeFn(dpu,dataSet,def.Content),groupScopeFn=MakeScopeFn(dpu,dataSet,def.GroupContent),listFilter=MakeRegionFilter(def,dataSet,parentDataSet),sortFn=MakeSortFn(dpu,dataSet,def);return exc=>{let data=Apply$2(exc,listFilter);const members=LazyFilter(sortFn(data),(d=>d.Data.Any()));data=MergeContexts(members,data.DataSets,data.ExpressionContext);const scope=scopeFn(data);return DataTree.Makers.List(scope,(()=>{let groups=LazyMap(members,(member=>groupScopeFn(member)));return def.HandleEmptyGroups&&!IterableAny(groups)&&(groups=[groupScopeFn(data)]),groups}),def.Name)}}(dpu,dataSet,def,parentDataSet):"tablix"===def.type?MakeTablix(dpu,dataSet,def,parentDataSet):"subreport"===def.type?function(dpu,dataSet,def){const scopeFn=MakeScopeFn(dpu,dataSet,def.Content),cc=MakeCompileContext(dataSet),parameters=(def.Parameters||[]).map((p=>({Name:p.Name,Eval:compile$u(p.Value,cc)}))),reportFn=MakeReportRegionFn(dpu,null,def.Report);return exc=>{const args=parameters.map((p=>({Name:p.Name,Value:p.Eval(exc)}))),scope=scopeFn(exc);try{const rc=dpu.makeContext(def.Report,args),report=reportFn(rc,exc);return DataTree.Makers.List(scope,[report.Scope],def.Name)}catch(err){return DataTree.Makers.List(scope,[],def.Name)}}}(dpu,dataSet,def):"dataset"===def.type?function(dpu,def,parentDataSet){const scopeFn=MakeScopeFn(dpu,def,def.Content,parentDataSet);if(Def.IsEmptyContent(def.Content))return()=>DataTree.Makers.List(scopeFn(null),[],def.Name);const filter=MakeRegionFilter(def,def),cc=MakeCompileContext(parentDataSet),parameters=def.Parameters.map((p=>({Name:p.Name,Eval:compile$u(p.Value,cc)})));return exc=>{const args=parameters.map((p=>({Name:p.Name,Value:p.Eval(exc)}))),dataSet=exc.DataSets.GetDataSet(MakeRecordSetKey(def.Name,args),exc.Data,null==parentDataSet?void 0:parentDataSet.Name),data=Apply$2(MakeExecutionContextByRecordSet(exc.DataSets,dataSet,exc.ExpressionContext,exc),filter),scope=scopeFn(data);return DataTree.Makers.List(scope,[],def.Name)}}(dpu,def,dataSet):MakeSimpleRegionFn(dpu,dataSet,def)}(dpu,dataSet,r,parentDataSet)));return ctx=>{const id=ctx.ScopeId||dpu.nextScopeId();return DataTree.Makers.Scope(fields(ctx),(()=>regions.map((fn=>fn(ctx.MakeContext(id))))),id)}}function MakeSortFn(dpu,dataSet,def){const groupFn=MakeFn$1(dataSet,def.Group,def.HandleEmptyGroups),groupFilter=MakeGroupFilter(def.Group,def.GroupContent,dataSet),sort=MakeSortContextFn(def.Sort,def.GroupContent,dataSet);return exc=>{let data=groupFilter(groupFn(exc));const lists=def.GroupContent.Regions.filter((r=>"list"===r.type));return 1==lists.length&&lists[0].GroupContent.Regions.length>0&&(data=Array.from(LazyMap(data,(d=>MergeContexts(MakeSortFn(dpu,dataSet,lists[0])(d),exc.DataSets,exc.ExpressionContext))))),sort(data)}}function MergeContexts(contexts,dataSets,expressionContext){return MakeExecutionContextByRecordSet(dataSets,new RecordSet(LazyMapMany(contexts,(ctx=>ctx.Data))),expressionContext)}const Create$2=Tools.Variant.Create,isVariant=Tools.Variant.isVariant;function saveParameterValues(parameter,recordset,dataset,labelField,valueField,exprContext){let result=execData(recordset,dataset,[labelField,valueField],exprContext).map((([label,value])=>({label:label,value:value})));return parameter&&!parameter.multiValue||(result=result.filter((p=>null!==p.value))),result}function execData(recordset,dataset,fields,expressionContext){const reportDef=Def.Makers.Report("Parameter",Def.Makers.Content([],[Def.Makers.List("",Def.EmptyContent,getFilter(dataset),Def.Makers.Group(""),[],Def.Makers.Content(fields.map(makeExpression)))])),dataSets={dataset:recordset},data=Run(reportDef,(()=>({DataSets:MakeRecordSetProvider((name=>dataSets[name]),recordset),ExpressionContext:expressionContext})),[]).DataTree.Data.Regions[0];return Array.from(data.Groups).map((record=>record["@"].map((v=>variantSerializer.deserialize(v)))))}const makeExpression=fieldName=>fieldName&&"="!==fieldName[0]?`=Fields!${fieldName}.Value`:`${fieldName}`;function getFilter(dataset){const filters=[];for(let i=0;i<(dataset.Filters||[]).length;i++){const filter=dataset.Filters[i],filterOperator=filter.Operator,newFilter=Def.Makers.Filter(filter.FilterExpression,filterOperator,filter.FilterValues);filters.push(newFilter)}return filters}const compiler$4=createTreeBuilder();function resolveParameters(expr,params){if(!expr.trimLeft().startsWith("="))return expr;const initialTree=compiler$4(expr),newTree=Tools.replaceNode(initialTree,(node=>"variable"===node.Token.type&&node.Token.value.startsWith("parameters.")&&node.Token.value.endsWith(".value")),(node=>{var _a;if("variable"!==node.Token.type)return node;const paramNameLower=node.Token.value.substring("parameters.".length,node.Token.value.length-".value".length),paramName=Object.keys(params).find((key=>key.toLowerCase()===paramNameLower));return void 0===paramName?node:compiler$4(null!==(_a=params[paramName])&&void 0!==_a?_a:null)})).Simplify();try{return(rootNode=newTree).Contains(null,"variable")||rootNode.Contains(null,"function")?"="+newTree.ToString():null!=(value=newTree.EvalConst().Value)?`${value}`:""}catch(_a){return expr}var value,rootNode}function flatten$2(input){return Array.prototype.concat(...input)}function isEqualCaseIns(str1,str2){return 0===str1.localeCompare(str2,void 0,{sensitivity:"accent"})}function SafeEval$1(node,ctx){try{return ctx?node.Eval(ctx):node.EvalConst()}catch(err){return console.warn(err instanceof Error?err.message:`${err}`),Tools.Variant.Null}}function parseSeparatedString(connectionString,parsingSettings){const settings=Object.assign({separator:";",lowerCaseKeys:!0,ignoreQuotes:!1,trimValues:!0},parsingSettings),trimSpaces=s=>settings.trimValues?s.trim():s,trimQuotes=s=>settings.trimValues?s.replace(/([^\\])["']$/g,"$1").replace(/^['"]/g,""):s,splitProp=ps=>{const parts=ps.split("="),key=trimQuotes(trimSpaces(settings.lowerCaseKeys?parts[0].toLowerCase():parts[0])),value=trimQuotes(parts.slice(1).join("="));return{[key]:trimSpaces(value)}};if(!connectionString)return{};let singleQuoted=!1,doubleQuoted=!1,braces=0,props={},prop="";for(let i=0;i<connectionString.length;i++){const chr=connectionString[i],isEscaped="\\"===connectionString[i-1];settings.ignoreQuotes||(isEscaped||'"'!==chr||singleQuoted||(doubleQuoted=!doubleQuoted),isEscaped||"'"!==chr||doubleQuoted||(singleQuoted=!singleQuoted)),isEscaped||"{"!==chr||doubleQuoted||singleQuoted||braces++,isEscaped||"}"!==chr||doubleQuoted||singleQuoted||braces--,singleQuoted||doubleQuoted||braces>0?prop+=chr:isEscaped||chr!==settings.separator?prop+=chr:(prop&&(props=Object.assign(Object.assign({},props),splitProp(prop))),prop="")}return prop&&(props=Object.assign(Object.assign({},props),splitProp(prop))),props}const getByInvariantCaseKey=(obj,key)=>obj[Object.keys(obj).find((k=>k.toLowerCase()===key.toLowerCase()))];function mapDictionary(d1,map){return Object.keys(d1).reduce(((res,pName)=>{const val=d1[pName];return res[pName]=map(val,pName),res}),{})}function isNotNull$1(x){return null!=x}function toDictionary(arr,getKey,getValue){return arr.map((it=>[getKey(it),getValue(it)])).reduce(((res,kvPair)=>(res[kvPair[0]]=kvPair[1],res)),{})}const compiler$3=createTreeBuilder();function makeExpressionEvaluator(evalContext){return expr=>`${expr}`.trim().startsWith("=")?Tools.Variant.Convert.toString(compiler$3(expr).Eval(evalContext)):expr}const success=value=>({kind:"success",value:value}),failure=error=>({kind:"failure",error:error});function parseDateFormats(dateFormatsProp){return!dateFormatsProp||!dateFormatsProp.startsWith("{")||!dateFormatsProp.endsWith("}")||dateFormatsProp.length<3?[]:Object.keys(parseSeparatedString(dateFormatsProp.substring(1,dateFormatsProp.length-1),{lowerCaseKeys:!1,separator:","}))}const parseBoolean=value=>"true"===(null==value?void 0:value.trim().toLowerCase());function fetchText(uri,options={},webResProvider){return __awaiter(this,void 0,void 0,(function*(){const result=yield webResProvider.getData(Object.assign(Object.assign({method:"get"},options),{uri:uri}));if("failure"===result.kind){const error=result.error;return failure({key:"fetch-failed",uri:uri,responseStatus:error.status,responseText:error.message})}return success(result.value)}))}function fetchTextSync(uri,options={},webResProvider){const result=webResProvider.getDataSync(Object.assign(Object.assign({method:"get"},options),{uri:uri}));if("failure"===result.kind){const error=result.error;return failure({key:"fetch-failed",uri:uri,responseStatus:error.status,responseText:error.message})}return success(result.value)}function toFetchOptions(httpSource){const{kind:kind,endpoint:endpoint,method:method}=httpSource,requestInit=__rest$1(httpSource,["kind","endpoint","method"]);return Object.assign({method:null==method?void 0:method.type,body:"post"===(null==method?void 0:method.type)?method.body:void 0},requestInit)}const dataFieldPattern=/(.+?)(\[(.+?)(\|(.+))?\])?$/;function toDataFieldDescriptor(value){var _a;const parts=value.match(dataFieldPattern);if(!parts)return{Name:value,LowerCaseName:value.toLowerCase(),Type:null};const name=(parts[1]||"").trim();return{Name:name,LowerCaseName:name.toLowerCase(),Type:mapDataType(parts[3]),Format:null!==(_a=parts[5])&&void 0!==_a?_a:void 0}}function mapDataType(type){let variantType=function(type){switch(type){case"Null":case"Bool":case"Int32":case"Int64":case"UInt64":case"Float":case"Double":case"Decimal":case"TimeSpan":case"Date":case"String":case"Enum":case"Object":return type;default:return null}}(type);if(null===variantType)switch(type){case"Number":variantType="Double"}return variantType}function getParseDateFieldsFn(descriptors,defaultDateFormats){const dateFieldsFormats=toDictionary(descriptors.map(((d,index)=>"Date"===d.Type?{index:index,format:d.Format}:null)).filter(isNotNull$1),(({index:index})=>index),(({format:format})=>format?[format]:defaultDateFormats));return Object.keys(dateFieldsFormats).length>0?(fieldsDateFormats=dateFieldsFormats,dataFieldsRow=>dataFieldsRow.map(((value,index)=>{const dateFormats=fieldsDateFormats[index];if(!dateFormats)return value;const dateValue=dateTimeFactory_isDateTime(value)?value:dateTimeFactory_createFromString(`${value}`,dateFormats,!0);return null==dateValue?void 0:dateValue.toDate()}))):a=>a;var fieldsDateFormats}const compiler$2=createTreeBuilder(),isConstantExpression=rootNode=>!rootNode.Contains(/^fields($|\..*$)|^parameters($|\..*$)/i,"variable")&&!rootNode.Contains(/^fields$/i,"function");function toVariant(value,descriptor){if(null==value||Tools.Variant.isVariant(value)&&Tools.Variant.IsNull(value))return Tools.Variant.Null;if(Array.isArray(value))return Tools.Variant.Create(value);let type="String";switch(descriptor.dataType){case"Integer":type="Int64";break;case"Float":type="Float";break;case"Boolean":type="Bool";break;case"Date":case"DateTime":type="Date"}try{return Tools.Variant.Create(value,type,!0)}catch(e){return Tools.Variant.Create(value)}}function mapDescriptors(reportParameters,dataSources,dataSets){const depends=function(reportParameters,dataSources,dataSets){const map=new Map;return reportParameters.forEach((p=>{const dependsOn=new Set;function collectDataSetRefs(dataSetRef){const dataSet=getDataSet(dataSets,dataSetRef.DataSetName),dataSource=function(dataSources,dataSourceName){const result=dataSources.find((ds=>ds&&ds.Name.toLowerCase()===dataSourceName.toLowerCase()));if(!result)throw new Error(`Unable to resolve DataSource '${dataSourceName}'.`);return result}(dataSources,dataSet.Query.DataSourceName);[dataSet.Query.CommandText,...flatten$2(dataSet.Filters.map((f=>[f.FilterExpression,...f.FilterValues]))),dataSource.ConnectionProperties.ConnectString].forEach((expr=>{getReferencedParameters(compiler$2(expr),reportParameters).forEach((pn=>dependsOn.add(pn)))}))}(p.DefaultValue&&!isDataSetRefDefault(p.DefaultValue)&&p.DefaultValue.Values||[]).forEach((v=>getReferencedParameters(compiler$2(v),reportParameters).forEach((pn=>dependsOn.add(pn))))),p.DefaultValue&&isDataSetRefDefault(p.DefaultValue)&&collectDataSetRefs(p.DefaultValue.DataSetReference),(p.ValidValues&&!isDataSetRefValid(p.ValidValues)&&p.ValidValues.ParameterValues||[]).forEach((vv=>{var _a,_b;getReferencedParameters(compiler$2(null!==(_a=vv.Label)&&void 0!==_a?_a:null),reportParameters).forEach((pn=>dependsOn.add(pn))),getReferencedParameters(compiler$2(null!==(_b=vv.Value)&&void 0!==_b?_b:null),reportParameters).forEach((pn=>dependsOn.add(pn)))})),p.ValidValues&&isDataSetRefValid(p.ValidValues)&&collectDataSetRefs(p.ValidValues.DataSetReference),map.set(p,dependsOn)})),map}(reportParameters,dataSources,dataSets);return reportParameters.map((p=>{const parameterValidValues=p.ValidValues;let validValues=[];parameterValidValues&&!isDataSetRefValid(parameterValidValues)&&parameterValidValues.ParameterValues&&parameterValidValues.ParameterValues.length>0?validValues=parameterValidValues.ParameterValues.map((vv=>{return{value:(rawValue=vv.Value,type=p.DataType,void 0===rawValue&&"String"===type?"":void 0===rawValue?null:rawValue),label:vv.Label};var rawValue,type})):parameterValidValues&&isDataSetRefValid(parameterValidValues)&&(validValues={dataSet:parameterValidValues.DataSetReference.DataSetName,valueField:parameterValidValues.DataSetReference.ValueField,labelField:parameterValidValues.DataSetReference.LabelField});const parameterDefaultValues=p.DefaultValue;let defaultValue=[];return parameterDefaultValues&&!isDataSetRefDefault(parameterDefaultValues)&&parameterDefaultValues.Values&&parameterDefaultValues.Values.length>0?defaultValue=parameterDefaultValues.Values:parameterDefaultValues&&isDataSetRefDefault(parameterDefaultValues)&&parameterDefaultValues.DataSetReference&&(defaultValue={dataSet:parameterDefaultValues.DataSetReference.DataSetName,valueField:parameterDefaultValues.DataSetReference.ValueField,labelField:parameterDefaultValues.DataSetReference.LabelField}),{name:p.Name,dataType:p.DataType,multiValue:!!p.MultiValue,nullable:!!p.Nullable,allowBlank:!!p.AllowBlank,selectAllValue:""===p.SelectAllValue?selectAll:p.SelectAllValue,validValues:validValues,orderBy:p.ValidValues.OrderBy,dependsOn:Array.from(depends.get(p)||[]),defaultValue:defaultValue,hidden:!!p.Hidden,prompt:p.Prompt,multiline:!!p.Multiline,displayFormat:p.DisplayFormat}}))}const parameterRegExp=/^parameters[\.!](.+?)\..*/i;function getReferencedParameters(expr,reportParameters){const result=[];if("variable"===expr.Token.type){const matches=expr.Token.value.match(parameterRegExp);if(matches&&matches[1]){const parameter=reportParameters.find((p=>p.Name.toLowerCase()===matches[1].toLowerCase()));parameter&&result.push(parameter.Name)}}return result.concat(...expr.Children.map((c=>getReferencedParameters(c,reportParameters))))}function valueToString(value,descriptor){if(null==value)return"";if("Date"===descriptor.dataType||"DateTime"===descriptor.dataType){const dateTime="string"==typeof value?dateTimeFactory_createFromString(value,[{ISO_8601:!0}],!0):dateTimeFactory_isDateTime(value)?value:value instanceof Date?dateTimeFactory_createFromJsDate(value):null;if(null!==dateTime){if(descriptor.displayFormat)return Format(dateTime,null,descriptor.displayFormat);{const jsDate=dateTime.toDate();return"Date"===descriptor.dataType?jsDate.toLocaleDateString():jsDate.toLocaleString()}}}return Format(value,null,null)}const getScalarValue=(values,descriptor)=>descriptor.multiValue?values:values[0],getVariantValue=value=>(Array.isArray(value.Value)?value.Value.map((v=>Tools.Variant.isVariant(v)?v.Value:v)):[value.Value]).map((v=>dateTimeFactory_isDateTime(v)?v.toDate():v)),variantToParameterVariant=value=>dateTimeFactory_isDateTime(value.Value)?value.Value.toDate():value.Value,isParameterVariants=obj=>!!obj&&Array.isArray(obj),isRdlDataSetRef=obj=>!!obj&&!!obj.dataSet&&!!obj.valueField;function getParametersValues(descriptors,dataSets,report,values,requiredParams){var _a,_b,_c,_d,_e,_f;return __awaiter(this,void 0,void 0,(function*(){const result={},defaultParameters=(yield function(descriptors,getDataSet,values={}){return __awaiter(this,void 0,void 0,(function*(){const resolvedDescriptors=[],sortedParams=sortByDependencies(descriptors),evalContext={Data:{parameters:{}}},parametersEvalContext=evalContext.Data.parameters,exprContext={Culture:"",Parameters:parametersEvalContext};for(let i=0;i<sortedParams.length;i++){const descriptor=descriptors.find((d=>d.name===sortedParams[i])),descriptorName=descriptor.name.toLowerCase();let defaultValue=descriptor.defaultValue;if(values[descriptor.name])parametersEvalContext[descriptorName]={Name:descriptor.name,Value:toVariant(values[descriptor.name][0],descriptor)},defaultValue=values[descriptor.name];else if(isParameterVariants(defaultValue)){const defaultValues=defaultValue.map((dv=>SafeEval$1(compiler$2(dv),evalContext)));parametersEvalContext[descriptorName]={Name:descriptor.name,Value:defaultValues[0]},defaultValue=defaultValues.map((dv=>Tools.Variant.Convert.toSafeValue(dv))).map((dv=>dateTimeFactory_isDateTime(dv)?dv.toDate():dv))}else if(isRdlDataSetRef(defaultValue)){const ds=yield getDataSet(defaultValue.dataSet);defaultValue=saveParameterValues(descriptor,ds.recordSet,ds.dataSet,defaultValue.labelField,defaultValue.valueField,exprContext).map((dv=>dv.value)).map((v=>toVariant(v,descriptor))).map((v=>variantToParameterVariant(v))),parametersEvalContext[descriptorName]={Name:descriptor.name,Value:toVariant(defaultValue[0],descriptor)}}let selectAllValue=descriptor.selectAllValue;if(selectAllValue&&"string"==typeof selectAllValue&&"="===selectAllValue.trim()[0]){const initialTree=compiler$2(selectAllValue);if(isConstantExpression(initialTree))selectAllValue=initialTree.EvalConst().Value;else{const ds=yield getDataSet(),values=saveParameterValues(descriptor,ds.recordSet,ds.dataSet,"",selectAllValue,exprContext).map((v=>({label:valueToString(v.label,descriptor),value:v.value})));selectAllValue=values.length>0?values[0].value:null}}resolvedDescriptors.push(Object.assign(Object.assign({},descriptor),{defaultValue:defaultValue,selectAllValue:selectAllValue}))}return resolvedDescriptors}))}(descriptors,function(dataSets,report){return name=>__awaiter(this,void 0,void 0,(function*(){const dataSet=getDataSet(dataSets,name),recordSet=yield report.getRecordSet(dataSet?dataSet.Name:"",[]);if(null===recordSet)throw new Error(`Unable to resolve DataSet '${dataSet&&dataSet.Name}'.`);return{dataSet:dataSet,recordSet:recordSet}}))}(dataSets,report),values)).filter((d=>isParameterVariants(d.defaultValue)&&d.defaultValue.length>0)).reduce(((p,c)=>(p[c.name.toLowerCase()]={Name:c.name,Value:toVariant(getScalarValue(values[c.name]||c.defaultValue,c),c)},p)),{}),evalContext={Data:{parameters:defaultParameters}},sortedParams=sortByDependencies(descriptors);for(let i=0;i<sortedParams.length;i++){const parameterName=sortedParams[i],descriptor=descriptors.find((rp=>rp.name===parameterName)),isSelectAllValue=(null===(_a=values[parameterName])||void 0===_a?void 0:_a[0])===(null!==(_b=null==descriptor?void 0:descriptor.selectAllValue)&&void 0!==_b?_b:selectAll)&&1===values[parameterName].length;if(!requiredParams.hasOwnProperty(parameterName)&&!isSelectAllValue)continue;if(!descriptor)throw new Error(`Parameter descriptor "${parameterName}" not found`);let validValues=[],validValuesInternal=[];if((obj=descriptor.validValues)&&Array.isArray(obj))validValuesInternal=descriptor.validValues.map((vv=>{const variantValue=toVariant(SafeEval$1(compiler$2(vv.value),evalContext),descriptor);return{label:valueToString(Tools.Variant.Convert.toSafeValue(SafeEval$1(compiler$2(vv.label),evalContext))||Tools.Variant.Convert.toSafeValue(variantValue),descriptor),value:variantValue}}));else if(isRdlDataSetRef(descriptor.validValues)){const dataSet=getDataSet(dataSets,descriptor.validValues.dataSet),recordSet=yield report.getRecordSet(dataSet?dataSet.Name:"",Object.keys(defaultParameters).map((k=>defaultParameters[k])));if(null===recordSet)throw new Error(`Unable to resolve DataSet '${dataSet&&dataSet.Name}'.`);let execResult=execData(recordSet,dataSet,[descriptor.validValues.labelField,descriptor.validValues.valueField].concat(...null!==(_d=null===(_c=requiredParams[parameterName])||void 0===_c?void 0:_c.fields)&&void 0!==_d?_d:[]),{Culture:"",Parameters:evalContext.Data.parameters});descriptor&&!descriptor.multiValue||(execResult=execResult.filter((p=>null!==p[1]))),validValuesInternal=execResult.map(null!==(_f=null===(_e=requiredParams[parameterName])||void 0===_e?void 0:_e.fields.length)&&void 0!==_f&&_f?vv=>({label:valueToString(vv[0],descriptor),value:toVariant(vv[1],descriptor),fields:vv.slice(2)}):vv=>({label:valueToString(vv[0],descriptor),value:toVariant(vv[1],descriptor)}))}if("None"!==descriptor.orderBy.Condition){const direction="Ascending"===descriptor.orderBy.Direction?1:-1;"Label"===descriptor.orderBy.Condition?validValuesInternal.sort(((a,b)=>a.label.localeCompare(b.label)*direction)):validValuesInternal.sort(((a,b)=>Tools.Variant.Comparison.Compare(a.value,b.value)*direction))}if(validValues=validValuesInternal.map((vvi=>Object.assign(Object.assign({},vvi),{value:variantToParameterVariant(vvi.value)}))),isSelectAllValue&&(defaultParameters[parameterName.toLowerCase()]={Name:parameterName,Value:toVariant(getScalarValue(validValues.map((vv=>vv.value)),descriptor),descriptor)},!requiredParams.hasOwnProperty(parameterName)))continue;const value=values[parameterName]||(defaultParameters[parameterName.toLowerCase()]?getVariantValue(defaultParameters[parameterName.toLowerCase()].Value):[]);result[parameterName]={validValues:validValues,values:value},defaultParameters[parameterName]={Name:parameterName,Value:toVariant(getScalarValue(value,descriptor),descriptor)}}var obj;return result}))}function getDataSet(dataSets,dataSetName){const result=dataSetName?dataSets.find((ds=>ds&&ds.Name===dataSetName)):dataSets[0];if(!result)throw new Error(`Unable to resolve DataSet '${dataSetName}'.`);return result}function sortByDependencies(descriptors){const unsorted=[...descriptors],sorted=[];for(;sorted.length<unsorted.length;){const originalLength=unsorted.length;for(let i=0;i<unsorted.length;i++)unsorted[i].dependsOn.every((dep=>sorted.findIndex((name=>name.toLowerCase()===dep.toLowerCase()))>-1))&&(sorted.push(unsorted[i].name),unsorted.splice(i,1),i--);if(originalLength===unsorted.length)throw new Error("Circular dependency in parameters")}return sorted}function isDataSetRefDefault(param){return!!param.DataSetReference.DataSetName}function isDataSetRefValid(param){return!!param.DataSetReference.DataSetName}const isArray$1=Array.isArray,extend=Object.assign;function flatten$1(array){const result=[];return array.forEach((item=>{if(isArray$1(item))for(const element of item)result.push(element);else item&&result.push(item)})),result}function uniqWith(list,pred){return uniqWith$1(pred,list)}function range(start,end){return void 0!==end?range$1(start,end):range$1(0,start)}function zipWith(arrays1,arrays2,iteratee){return zipWith$1(iteratee,arrays1,arrays2)}function sum(array){return sum$1(array.map((v=>v||0)))}function mapValues$1(obj,fn){return Object.keys(obj).reduce(((newObj,key)=>(newObj[key]=fn(obj[key],key),newObj)),{})}function keyBy(collection,key){return(collection||[]).reduce(((obj,value)=>(obj[value[key]]=value,obj)),{})}const zip$2=selector=>function*(first,second){const it1=(first||[])[Symbol.iterator](),it2=(second||[])[Symbol.iterator]();let r1=it1.next(),r2=it2.next();for(;!r1.done&&!r2.done;)yield selector(r1.value,r2.value),r1=it1.next(),r2=it2.next()},zipTuple$1=zip$2(((f,t)=>[f,t]));const iterable$1={map:transform=>function*(iterable){let counter=0;for(const item of iterable)yield transform(item,counter++)},filter:predicate=>function*(iterable){for(const item of iterable)predicate(item)&&(yield item)},first:function(iterable){if(!iterable)return null;for(let item of iterable)return item;return null},zip:zip$2,zipTuple:zipTuple$1,memoize:function(iterable){const iterator=iterable[Symbol.iterator](),cache=[];return{*[Symbol.iterator](){let index=-1;for(;;)if(index++,index<cache.length)yield cache[index];else{const next=iterator.next();if(next.done)return;cache[index]=next.value,yield next.value}}}}};const sumRange=(array,start,range)=>sum(array.slice(start,start+range));function*map$2(iterable,transform){let counter=0;for(const item of iterable)yield transform(item,counter++)}function isNotNull(x){return null!==x}function isDefined(x){return void 0!==x}function isVNode$2(x){return"VirtualNode"===x.type}function toBoolean(value){return"string"==typeof value?"true"===value.toLowerCase():!!value}function toNumber$1(value){const res=+value;return isNaN(res)?0:res}function toString$1(value){return null!=value?`${value}`:""}const stringEquals=(s1,s2)=>s1.toLowerCase()===s2.toLowerCase();function flatten(input){return Array.prototype.concat(...input)}const GetCollectionItem=(collection,index)=>Array.isArray(collection)?collection[index]:collection.getItem(index);function mapKeysDeep(dic,callback){return function mapKeysDeepImpl(obj,callback){if("object"!=typeof obj||null==obj)return obj;const result={};return Object.keys(obj).forEach((key=>{const value=obj[key];result[callback(key)]=Array.isArray(value)?value.map((item=>mapKeysDeepImpl(item,callback))):mapKeysDeepImpl(value,callback)})),result}(dic,callback)}function buildRenderTree(node){if(node.properties.GroupType){const currentGroupContent=[];if(node.children&&node.children.length>0){const childNodes=node.children.filter(isVNode$2);for(let i=0;i<childNodes.length;i++)currentGroupContent.push(...buildRenderTree(childNodes[i]))}const groupContent={Type:"group",GroupType:node.properties.GroupType,Content:currentGroupContent};currentGroupContent.forEach((c=>c.Parent=groupContent));return[groupContent]}const currentContent=node&&node.properties&&node.properties.itemContent?[node.properties.itemContent]:[];if(!node.children||0===node.children.length)return currentContent;const childNodes=node.children.filter((c=>"VirtualNode"===c.type));for(let i=0;i<childNodes.length;i++)currentContent.push(...buildRenderTree(childNodes[i]));return currentContent}function collectReportItemsValues(reportItems,targetItemName,targetItemValue,currentItemName,currentScopeId){return collectReportItems(reportItems,reportItems,targetItemName,targetItemValue,currentItemName,currentScopeId,!0).map((ri=>ri.Value))}function collectReportItems(reportItems,rootReportItems,targetItemName,targetItemValue,currentItemName,currentScopeId,inPageSection){if(void 0===currentScopeId)return getReportItemsContents(rootReportItems,targetItemName,targetItemValue,!0);const result=[];for(let i=0;i<reportItems.length;i++){const reportItem=reportItems[i];if("group"===reportItem.Type){const inPageSectionChild=inPageSection&&"group"!==reportItem.GroupType;result.push(...collectReportItems(reportItem.Content,rootReportItems,targetItemName,targetItemValue,currentItemName,currentScopeId,inPageSectionChild))}else if(reportItem.ScopeId===currentScopeId&&stringEquals(reportItem.FullName,currentItemName))return inPageSection?getReportItemsContents(rootReportItems,targetItemName,targetItemValue,!0):getReportItemsContents(reportItems,targetItemName,targetItemValue,!1)}return result}function getSelfValue(reportItems,selfName,selfScopeID){for(let i=0;i<reportItems.length;i++){const reportItem=reportItems[i];if("group"===reportItem.Type){const r=getSelfValue(reportItem.Content,selfName,selfScopeID);if(r)return r}else if(stringEquals(reportItem.FullName,selfName)&&reportItem.ScopeId===selfScopeID)return reportItem}return null}function isReportItemContent(x){return"textbox"===x.Type}function getReportItemsContents(reportItems,reportItemName,reportItemValue,collectInChildrenGroups){const current=reportItems.filter(isReportItemContent).filter((ri=>stringEquals(ri.Name,reportItemName||"")||ri.OriginalValue===reportItemValue));if((collectInChildrenGroups?reportItems.filter((ri=>"group"===ri.Type)):[]).forEach((g=>current.push(...getReportItemsContents(g.Content,reportItemName,reportItemValue,collectInChildrenGroups)))),0===current.length&&!collectInChildrenGroups&&reportItems[0].Parent){const thisGroup=reportItems[0].Parent;thisGroup&&thisGroup.Parent&&current.push(...getReportItemsContents(thisGroup.Parent.Content,reportItemName,reportItemValue,collectInChildrenGroups))}return current}class InvalidReportDefinitionError extends Error{constructor(message){super(message),Object.setPrototypeOf(this,InvalidReportDefinitionError.prototype)}}class ExpressionEvaluationError extends Error{constructor(message){super(message),Object.setPrototypeOf(this,ExpressionEvaluationError.prototype)}}class VDomRendererError extends Error{constructor(message){super(message),Object.setPrototypeOf(this,VDomRendererError.prototype)}}class ReportCompilationError extends Error{constructor(message){super(message),Object.setPrototypeOf(this,ReportCompilationError.prototype)}}function isRange(x){return!("object"!=typeof x||Array.isArray(x)||!x||!x.isRange)}function isNumber(x){return"number"==typeof x&&!Number.isNaN(x)&&Number.isFinite(x)}function isStringOrNumber(x){return"string"==typeof x||isNumber(x)}function isNotEmpty$1(x){return null!==x&&""!==x}const nullAggregate={GetCurrentValue:()=>null,Accumulate:()=>{}},getRangeValue$1=value=>isRange(value)?value.getScopedValues():Array.isArray(value)?value:[value],stdev=arg=>{const values=getRangeValue$1(arg).filter(isNumber);if(values.length<=1)return 0;const aa=values.reduce(((p,c)=>p+c),0)/values.length;return Math.sqrt(values.reduce(((p,c)=>p+Math.pow(c-aa,2)),0)/(values.length-1))},stdevp=arg=>{const values=getRangeValue$1(arg).filter(isNumber);if(values.length<=1)return 0;const aa=values.reduce(((p,c)=>p+c),0)/values.length;return Math.sqrt(values.reduce(((p,c)=>p+Math.pow(c-aa,2)),0)/values.length)},aggregates={sum:arg=>{const values=getRangeValue$1(arg).filter(isNumber);return values.length>0?values.reduce(((p,c)=>p+c),0):null},first:arg=>{const values=getRangeValue$1(arg);return values.length>0?values[0]:null},last:arg=>{const values=getRangeValue$1(arg);return values.length>0?values[values.length-1]:null},avg:arg=>{const values=getRangeValue$1(arg).filter(isNumber);return values.length>0?values.reduce(((p,c)=>p+c),0)/values.length:null},max:arg=>{const result=Math.max(...getRangeValue$1(arg).filter(isNumber));return Number.isFinite(result)?result:null},min:arg=>{const result=Math.min(...getRangeValue$1(arg).filter(isNumber));return Number.isFinite(result)?result:null},count:arg=>getRangeValue$1(arg).filter(isNotEmpty$1).length,distinctsum:arg=>{const values=getRangeValue$1(arg).filter(isNumber),uniqueValues=[];return values.forEach((v=>{-1===uniqueValues.indexOf(v)&&uniqueValues.push(v)})),uniqueValues.reduce(((p,c)=>p+c),0)},countdistinct:arg=>{const values=getRangeValue$1(arg).filter(isNotEmpty$1),uniqueValues=[];return values.forEach((v=>{-1===uniqueValues.indexOf(v)&&uniqueValues.push(v)})),uniqueValues.length},median:arg=>{const values=getRangeValue$1(arg).filter(isNumber).sort(((a,b)=>a-b));return 0===values.length?null:1===values.length?values[0]:values.length%2==1?values[Math.floor(values.length/2)]:(values[Math.floor(values.length/2)-1]+values[Math.floor(values.length/2)])/2},stdev:stdev,stdevp:stdevp,var:arg=>Math.pow(stdev(arg),2),varp:arg=>Math.pow(stdevp(arg),2),mode:arg=>{const values=getRangeValue$1(arg).filter(isStringOrNumber);if(0===values.length)return null;if(1===values.length)return values[0];const modeMap={};let maxEl=values[0],maxCount=1;for(let i=0;i<values.length;i++){var el=values[i];modeMap[el]?modeMap[el]++:modeMap[el]=1,modeMap[el]>maxCount&&(maxEl=el,maxCount=modeMap[el])}return maxEl}};function getCumulativeTotalValue(range,agg,ctx){if(ctx.CumulativeTotals&&void 0!==ctx.PaginationService){const aggregateName=agg||"sum",pageIndex=ctx.PaginationService.GetMain().PageIndex,store=ctx.CumulativeTotals,hash=`${aggregateName}_${range.id}`;if((store[pageIndex]||{})[hash])return store[pageIndex][hash].Value;store[pageIndex]||(store[pageIndex]={});const aggregate=store[pageIndex-1]&&store[pageIndex-1][hash]&&store[pageIndex-1][hash].Aggregate||function(aggregateName){switch(aggregateName.toLowerCase()){case"sum":let sumValue=null;return{GetCurrentValue:()=>sumValue,Accumulate:args=>{null===aggregates.sum(args)&&null===sumValue||(sumValue=(sumValue||0)+(aggregates.sum(args)||0))}};case"max":let maxValue=null;return{GetCurrentValue:()=>maxValue,Accumulate:args=>maxValue=aggregates.max([...args,maxValue])};case"min":let minValue=null;return{GetCurrentValue:()=>minValue,Accumulate:args=>minValue=aggregates.min([...args,minValue])};case"count":let countValue=0;return{GetCurrentValue:()=>countValue,Accumulate:args=>countValue+=aggregates.count(args)};case"first":let firstValue=null;return{GetCurrentValue:()=>firstValue,Accumulate:args=>firstValue=firstValue||aggregates.first(args)};case"last":let lastValue=null;return{GetCurrentValue:()=>lastValue,Accumulate:args=>lastValue=aggregates.last(args)||lastValue};case"avg":let avgValue=null,valuesAvgCount=0;return{GetCurrentValue:()=>avgValue,Accumulate:args=>{const numVals=args.filter(isNumber);numVals.length>0&&(avgValue=(numVals.reduce(((p,c)=>p+c),0)+(avgValue?valuesAvgCount*avgValue:0))/(valuesAvgCount+numVals.length||1),valuesAvgCount+=numVals.length)}};case"distinctsum":let dsumValue=0;const allDSValues=[];return{GetCurrentValue:()=>dsumValue,Accumulate:args=>{allDSValues.push(...args),dsumValue=aggregates.distinctsum(allDSValues)}};case"countdistinct":let dcountValue=0;const allDCValues=[];return{GetCurrentValue:()=>dcountValue,Accumulate:args=>{allDCValues.push(...args),dcountValue=aggregates.countdistinct(allDCValues)}};case"median":let medianValue=null;const allMedValues=[];return{GetCurrentValue:()=>medianValue,Accumulate:args=>{allMedValues.push(...args),medianValue=aggregates.median(allMedValues)}};case"stdev":let stdevValue=0;const allStDevValues=[];return{GetCurrentValue:()=>stdevValue,Accumulate:args=>{allStDevValues.push(...args),stdevValue=aggregates.stdev(allStDevValues)}};case"stdevp":let stdevpValue=0;const allStDevPValues=[];return{GetCurrentValue:()=>stdevpValue,Accumulate:args=>{allStDevPValues.push(...args),stdevpValue=aggregates.stdevp(allStDevPValues)}};case"var":let varValue=0;const allVarValues=[];return{GetCurrentValue:()=>varValue,Accumulate:args=>{allVarValues.push(...args),varValue=aggregates.var(allVarValues)}};case"varp":let varpValue=0;const allVarPValues=[];return{GetCurrentValue:()=>varpValue,Accumulate:args=>{allVarPValues.push(...args),varpValue=aggregates.varp(allVarPValues)}};case"mode":let modeValue=null;const allModeValues=[];return{GetCurrentValue:()=>modeValue,Accumulate:args=>{allModeValues.push(...args),modeValue=aggregates.mode(allModeValues)}}}return nullAggregate}(aggregateName);aggregate.Accumulate(range.getAllValues());const value=aggregate.GetCurrentValue();return store[pageIndex][hash]={Aggregate:aggregate,Value:value},value}throw new ExpressionEvaluationError("CumulativeTotals store or PageIndex is not provided")}var colorName={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},colors=Object.freeze(Object.assign(Object.create(null),colorName,{default:colorName}));const colorToString=color=>color?`#${color.map((x=>Math.round(x).toString(16))).map((x=>1===x.length?`0${x}`:x)).join("")}`:"#000000",stringToColor=color=>color?"#"===color[0]?(color.replace(/#/,"").match(/.{1,2}/g)||[]).map((c=>parseInt(c,16))):colors[color.toLowerCase()]:[0,0,0],darken=(color,percent)=>colorToString(stringToColor(color).map((x=>x-x*percent))),lighten=(color,percent)=>colorToString(stringToColor(color).map((x=>x+(255-x)*percent))),BaseColorEnum={0:"dark1",1:"light1",2:"dark2",3:"light2",4:"accent1",5:"accent2",6:"accent3",7:"accent4",8:"accent5",9:"accent6",10:"hyperlink",11:"hyperlinkfollowed"},ColorDerivationEnum_base=0,ColorDerivationEnum_tint20percent=1,ColorDerivationEnum_tint40percent=2,ColorDerivationEnum_tint60percent=3,ColorDerivationEnum_shade75percent=4,ColorDerivationEnum_shade50percent=5,GetColor2=(colorsData,derivation,baseColorIndex)=>function(baseColor,derivation){if(!baseColor)return baseColor;switch(derivation){case ColorDerivationEnum_tint20percent:return lighten(baseColor,.75);case ColorDerivationEnum_tint40percent:return lighten(baseColor,.5);case ColorDerivationEnum_tint60percent:return lighten(baseColor,.25);case ColorDerivationEnum_shade75percent:return darken(baseColor,.25);case ColorDerivationEnum_shade50percent:return darken(baseColor,.5);case ColorDerivationEnum_base:return baseColor}return baseColor}(colorsData[BaseColorEnum[baseColorIndex]],derivation);function fillTheme(theme){var _a,_b;const lowerCaseTheme=mapKeysDeep(theme,(key=>key.toLowerCase())),themeImages={};Array.isArray(lowerCaseTheme.images)&&lowerCaseTheme.images.filter((image=>"string"==typeof image.name&&""!==image.name)).forEach((image=>{themeImages[image.name.toLowerCase()]={mimetype:image.mimetype,imagedata:image.imagedata}}));const themeConstants=lowerCaseTheme.constantsdictionary||{};return Array.isArray(lowerCaseTheme.constants)&&lowerCaseTheme.constants.filter((constant=>"string"==typeof constant.key&&""!==constant.key)).forEach((constant=>{themeConstants[constant.key.toLowerCase()]=constant})),Object.assign(Object.assign(Object.assign({},defaultTheme),lowerCaseTheme),{images:themeImages,constantsdictionary:themeConstants,fonts:{majorfont:Object.assign(Object.assign({},defaultTheme.fonts.majorfont),null===(_a=null==lowerCaseTheme?void 0:lowerCaseTheme.fonts)||void 0===_a?void 0:_a.majorfont),minorfont:Object.assign(Object.assign({},defaultTheme.fonts.minorfont),null===(_b=null==lowerCaseTheme?void 0:lowerCaseTheme.fonts)||void 0===_b?void 0:_b.minorfont)}})}const defaultTheme={colors:{dark1:"Black",dark2:"Black",light1:"White",light2:"White",accent1:"Gray",accent2:"Gray",accent3:"Gray",accent4:"Gray",accent5:"Gray",accent6:"Gray",hyperlink:"Blue",hyperlinkfollowed:"Purple"},fonts:{majorfont:{family:"Arial",style:"Normal",size:"12pt",weight:"Normal"},minorfont:{family:"Arial",style:"Normal",size:"10pt",weight:"Normal"}},images:{},constantsdictionary:{}},emptyTheme={colors:{dark1:null,dark2:null,light1:null,light2:null,accent1:null,accent2:null,accent3:null,accent4:null,accent5:null,accent6:null,hyperlink:null,hyperlinkfollowed:null},fonts:{majorfont:{family:null,style:null,size:null,weight:null},minorfont:{family:null,style:null,size:null,weight:null}},images:{},constantsdictionary:{}},Colors=(theme,a,b)=>void 0===b?theme.colors[BaseColorEnum[a]]:GetColor2(theme.colors,a,b);let twipsPerPx$1=0;function getTwipsPerPx$1(){return twipsPerPx$1||(twipsPerPx$1=twipsPer$3.in/function(){if("undefined"==typeof document)return 96;const elem=document.body.appendChild(document.createElement("div"));elem.style.width="1in",elem.style.padding="0";const dpi=elem.clientWidth;return document.body.removeChild(elem),dpi}(),twipsPerPx$1)}const twipsPer$3={in:1440,pt:20,pc:240,cm:566.9291338582677,mm:56.69291338582677};function parseWithUnits(length){const trimmed=length.trim(),units=trimmed.substr(-2).toLowerCase();if(!twipsPer$3[units])throw new InvalidReportDefinitionError(`Unable to parse length: ${length}`);const stringVal=trimmed.substr(0,trimmed.length-2);if(!(value=>!isNaN(value-parseFloat(value)))(stringVal))throw new InvalidReportDefinitionError(`Unable to parse length: ${length}`);return{value:parseFloat(stringVal),units:units}}var Length={parse:function(length){const parsedVal=parseWithUnits(length);return Math.trunc(parsedVal.value*twipsPer$3[parsedVal.units])},parseWithUnits:parseWithUnits,fromPixels:function(pixels){return Math.trunc(pixels*getTwipsPerPx$1())},toCss:function(twips){return Math.round(1e4*twips/20)/1e4+"pt"},toPixels:function(twips){return twips/getTwipsPerPx$1()}};const Values={ReportItems:getReportItems$1,SubExpressions:function(values,target){if(!values.SubExpressions)throw new ExpressionEvaluationError("SubExpressions collection is not provided");return values.SubExpressions[target.split(".")[1]]},Me:function(values,target){if(!values.ReportItems||void 0===values.SelfID||void 0===values.ScopeID)throw new ExpressionEvaluationError("Report items data is not provided");const reportItem=getSelfValue(values.ReportItems,values.SelfID,values.ScopeID);if(reportItem)switch(target.split(".")[1]){case"value":return"function"==typeof reportItem.Value?reportItem.Value(exctractGlobals(values)):reportItem.Value;case"name":return reportItem.Name;default:return null}return null},Globals:function(values,target){if(!values.Data||!values.Data.globals)throw new ExpressionEvaluationError("Globals data is not provided");const varName=target.split(".")[1];switch(varName){case"pagenumber":return(values.PaginationService?values.PaginationService.GetMain().PageIndex:0)+(values.StartPageNumber||1);case"cumulativepagenumber":return(values.PaginationService?values.PaginationService.GetCumulative().PageIndex:0)+(values.StartPageNumber||1);case"totalpages":{const total=values.PaginationService?values.PaginationService.GetMain().TotalPages:"?";return"?"===total?"?":total+(values.StartPageNumber||1)-1}case"cumulativetotalpages":{const total=values.PaginationService?values.PaginationService.GetCumulative().TotalPages:"?";return"?"===total?"?":total+(values.StartPageNumber||1)-1}case"pagenumberinsection":{const pagination=values.PaginationService;return pagination?pagination.GetSection(values.SectionId).PageIndex+1:1}case"totalpagesinsection":{const pagination=values.PaginationService;return pagination?pagination.GetSection(values.SectionId).TotalPages:"?"}default:return Tools.getValueByKey(values.Data.globals,varName)}},DocumentMap:function(values,target){if("path"===target.split(".")[1])return values.GetDocumentPath?values.GetDocumentPath():"";return""}},Functions={cumulativetotal:(ctx,args)=>getCumulativeTotalValue(isRange(args[0])?args[0]:getReportItems$1(ctx,args[0]),args[1],ctx),".colors":(ctx,args)=>args[0]?Colors(args[0],args[1],args[2]):"",".constants":(ctx,args)=>{return args[0]?(theme=args[0],key=args[1],(theme.constantsdictionary[key.toLowerCase()]||{value:""}).value):"";var theme,key},".images":(ctx,args)=>{return args[0]?(theme=args[0],key=args[1],theme.images[key.toLowerCase()]||{imagedata:"",mimetype:""}):"";var theme,key},".topoints":(ctx,args)=>Length.parse(args[0])/20};function getReportItems$1(values,target){if(!values.ReportItems||void 0===values.SelfID||void 0===values.ScopeID)throw new ExpressionEvaluationError("Report items data is not provided");const name=target.match(/^ReportItems\./i)?target.split(".")[1]:null,value=null===name?target:null,getter=scopeId=>collectReportItemsValues(values.ReportItems,name,value,values.SelfID,scopeId).map((r=>"function"==typeof r?r(exctractGlobals(values)):r));return{isRange:!0,id:name||value||"id",getAllValues:()=>getter(),getScopedValues:()=>getter(values.ScopeID)}}Functions.runningvalue=Functions.cumulativetotal;const specials={Values:Values,Functions:Functions},toScalar=value=>{const finalValue=value&&isRange(value)?value.getScopedValues():value;return Array.isArray(finalValue)?finalValue.length>0?finalValue[0]:null:finalValue},Create$1=Tools.Variant.Create,toSafe=Tools.Variant.Convert.toSafeValue;function getRangeValue(v){return v.Range?v.Range:toSafe(v)}function getCumulativeTotalArgs(ctx,args){const resolved=args.map((a=>a.Eval(ctx)));return isRange(getRangeValue(resolved[0]))?[getRangeValue(resolved[0]),...resolved.slice(1).map((v=>toSafe(v)))]:[args[0].ToString(),...resolved.slice(1).map((v=>toSafe(v)))]}const customFunctions=Object.assign({cumulativetotal:(ctx,args)=>Create$1(specials.Functions.cumulativetotal(ctx,getCumulativeTotalArgs(ctx,args))),runningvalue:(ctx,args)=>Create$1(specials.Functions.runningvalue(ctx,getCumulativeTotalArgs(ctx,args))),".colors":(ctx,args)=>Create$1(specials.Functions[".colors"](ctx,args.map((a=>a.Eval(ctx).Value)))),".constants":(ctx,args)=>Create$1(specials.Functions[".constants"](ctx,args.map((a=>a.Eval(ctx).Value)))),".images":(ctx,args)=>Create$1(specials.Functions[".images"](ctx,args.map((a=>a.Eval(ctx).Value)))),".topoints":(ctx,args)=>Create$1(specials.Functions[".topoints"](ctx,args.map((a=>toSafe(a.Eval(ctx))))))},mapValues$1(aggregates,(agg=>(ctx,args)=>Create$1(agg(getRangeValue(args[0].Eval(ctx))))))),customVariables={Globals:(ctx,name)=>Create$1(specials.Values.Globals(ctx,name)),DocumentMap:(ctx,name)=>Create$1(specials.Values.DocumentMap(ctx,name)),ReportItems:(ctx,name)=>{const result=specials.Values.ReportItems(ctx,name),variantExt=Create$1(toScalar(result));return variantExt.Range=result,variantExt},SubExpressions:(ctx,name)=>Create$1(specials.Values.SubExpressions(ctx,name)),Me:(ctx,name)=>Create$1(specials.Values.Me(ctx,name))},customConstants={},compiler$1=createCompiler(customFunctions,customVariables,customConstants),treeBuilder$2=createTreeBuilder(customFunctions,customVariables,customConstants);function replaceExpressionNode(tree,predicate,replace){return Tools.replaceNode(tree,predicate,replace)}const tokenize=expression=>Tools.tokenize(expression).map((lexem=>lexem.token));var global$1=void 0!==global$1?global$1:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};function compileClientExpression(expression){return function(expression){try{const compiled=compiler$1(expression),prepareResult=result=>result&&"Object"===result.Type&&isRange(result.Value)?toScalar(result.Value):toSafe(result);if(isConstValue$1(compiled))try{return prepareResult(compiled)}catch(evx){return console.warn("[expression evaluator]",evx.message),"ERROR!"}return ctx=>{try{return prepareResult(compiled(ctx))}catch(evx){return console.warn("[expression evaluator]",evx.message),"ERROR!"}}}catch(ex){return console.warn("[expression compiler]",ex.message),()=>"ERROR!"}}(expression)}const isDataTreeVariableRegExp=/^(?:Fields|Parameters)(?:\.|!|$)/i,isEnvironmentVariableRegExp=/^(?:System|UserContext)(?:\.|!|$)/i,isRenderTimeVariableRegExp=/^(?:(?:ReportItems|Me|DocumentMap)(?:\.|!|$))|(?:Globals(?:\.|!|$)(?!ReportName|ReportFolder|ExecutionTime))/i,isInstantVariableRegExp=/^(?:(?:Theme(?:\.|!|$))|(?:Globals(?:\.|!|$)(?:ReportName|ReportFolder|ExecutionTime)))/i;const datatreeFunctions=["AggregateIf","Avg","Count","CountDistinct","CountRows","DistinctSum","First","Last","Max","Median","Min","Mode","RunningValue","StDev","StDevP","Sum","Var","VarP","GetFields","InScope","Level","Lookup","Previous","RowNumber"].map((f=>f.toLowerCase())),isDataTreeFunctionRegExp=new RegExp(datatreeFunctions.map((func=>`^${func}$`)).join("|"),"i"),renderTimeFunctions=["CumulativeTotal"].map((f=>f.toLowerCase())),isRenderTimeFunctionRegExp=new RegExp(renderTimeFunctions.map((func=>`^${func}$`)).join("|"),"i");const isCleanDataTreeExpression=node=>"function"===node.Token.type&&isDataTreeFunctionRegExp.test(node.Token.value)&&!node.Contains(isInstantVariableRegExp,"variable")&&!node.Contains(isRenderTimeVariableRegExp,"variable")&&!node.Contains(isRenderTimeFunctionRegExp,"function");function exctractGlobals(evaluationContext){return{Data:evaluationContext.Data,ReportItems:evaluationContext.ReportItems,CumulativeTotals:evaluationContext.CumulativeTotals,PaginationService:evaluationContext.PaginationService}}function isConstValue$1(value){return"function"!=typeof value}const makeDataMapper=parentRef=>nested=>{const dataMap=combineDataQuery(parentRef,nested);return function(fun){return(data,...args)=>fun(dataMap(data),...args)}};function combineDataQuery(parentRef,nested){const fieldsMap=[];for(const f of nested.Fields){const index=parentRef.Fields.indexOf(f);fieldsMap.push(index>=0?index:parentRef.Fields.push(f)-1)}const dataSetsIndex={};parentRef.Regions.forEach(((r,i)=>{"dataset"===r.type&&(dataSetsIndex[r.Name.toLowerCase()]=i)}));const dataSetNames=Object.keys(dataSetsIndex),regionsMap=[];for(const region of nested.Regions){const regName=region.Name.toLowerCase();if("dataset"!==region.type||dataSetNames.indexOf(regName)<0){const index=parentRef.Regions.push(region)-1;regionsMap.push((data=>data.Regions.length>0?data.Regions[index]:"tablix"===region.type?DataTree.Makers.Tablix(DataTree.Makers.Scope([],[]),[],[],[]):DataTree.Makers.List(DataTree.Makers.Scope([],[]),[])))}else{const dataSetIndex=dataSetsIndex[regName],dataSetContentMap=combineDataQuery(parentRef.Regions[dataSetIndex].Content,region.Content);regionsMap.push((data=>{const ds=data.Regions[dataSetIndex];return Object.assign(Object.assign({},ds),{Scope:dataSetContentMap(ds.Scope)})}))}}return data=>({Id:data.Id,"@":fieldsMap.map((i=>data["@"][i])),Regions:regionsMap.map((rm=>rm(data)))})}function isExpression(value){return!!value&&value.startsWith("=")}function compileExpression(value,fieldsRef,evaluationContext={Data:{}}){if("string"!=typeof value)return value;let val=value.trim();return function(value){return!!value&&'=""'===value}(val)?"":isExpression(val)?compileExpressionInfo({Definition:val},(fieldsRef=>expr=>{let index=fieldsRef.indexOf(expr.Definition);return index=index>=0?index:fieldsRef.push(expr.Definition)-1,data=>{const val=data["@"][index];return variantSerializer.deserialize(val)}})(fieldsRef),evaluationContext):value}function compileExpressionInfo(exprInfo,compileDataExpr,evaluationContext={Data:{}}){const expressionType=function(expression){try{const expressionTree=treeBuilder$2(expression),isInstant=expressionTree.Contains(isInstantVariableRegExp,"variable");return{isInstant:isInstant,isRenderTime:expressionTree.Contains(isRenderTimeVariableRegExp,"variable")||expressionTree.Contains(isRenderTimeFunctionRegExp,"function"),isDataTree:expressionTree.Contains(isDataTreeVariableRegExp,"variable")||expressionTree.Contains(isEnvironmentVariableRegExp,"variable")||expressionTree.Contains(isDataTreeFunctionRegExp,"function"),isError:!1}}catch(ex){return{isInstant:!1,isRenderTime:!1,isDataTree:!1,isError:!0}}}(exprInfo.Definition);if(expressionType.isError)return null;if(expressionType.isDataTree&&(expressionType.isInstant||expressionType.isRenderTime)){const convertedExpression=function(mixedExpression){const expressionTree=treeBuilder$2(mixedExpression),dataTreeExpressions=[];return{Expression:`=${replaceExpressionNode(expressionTree,(node=>"function"===node.Token.type&&"cumulativetotal"===node.Token.value||isCleanDataTreeExpression(node)||"variable"===node.Token.type&&(isDataTreeVariableRegExp.test(node.Token.value)||isEnvironmentVariableRegExp.test(node.Token.value))),(node=>{if("function"===node.Token.type&&("cumulativetotal"===node.Token.value||"runningvalue"===node.Token.value&&!node.Contains(isDataTreeVariableRegExp,"variable")&&!node.Contains(isEnvironmentVariableRegExp,"variable")))return node;if(node.Contains(isInstantVariableRegExp,"variable")||node.Contains(isRenderTimeVariableRegExp,"variable"))return node;const key=`n${dataTreeExpressions.length}`;return dataTreeExpressions.push({Key:key,Value:`=${node.ToString()}`}),treeBuilder$2(`=SubExpressions!${key}`)})).ToString()}`,SubExpressions:dataTreeExpressions}}(exprInfo.Definition),compiledExpression=compileClientExpression(convertedExpression.Expression),compiledSubExpressions=convertedExpression.SubExpressions.map((subExpression=>compileExpressionInfo({Definition:subExpression.Value},compileDataExpr,evaluationContext)));return data=>{const SubExpressions={};return convertedExpression.SubExpressions.forEach(((subExpression,i)=>SubExpressions[subExpression.Key]=resolveCompiled$1(compiledSubExpressions[i],data))),isConstValue$1(compiledExpression)?compiledExpression:expressionType.isRenderTime?globals=>compiledExpression(Object.assign(Object.assign(Object.assign(Object.assign({},evaluationContext),{SubExpressions:SubExpressions}),globals),{Data:Object.assign(Object.assign({},globals.Data),{globals:joinGlobals(evaluationContext,globals)}),ScopeID:data.Id})):compiledExpression(Object.assign(Object.assign({},evaluationContext),{SubExpressions:SubExpressions,ScopeID:data.Id}))}}if(!expressionType.isInstant&&!expressionType.isRenderTime&&!expressionType.isDataTree){const compiled=compileClientExpression(exprInfo.Definition);if("function"!=typeof compiled)return compiled}if(!expressionType.isInstant&&!expressionType.isRenderTime)return compileDataExpr(exprInfo);if(expressionType.isRenderTime&&!expressionType.isDataTree){const compiledRenderExpression=compileClientExpression(exprInfo.Definition);return data=>isConstValue$1(compiledRenderExpression)?compiledRenderExpression:globals=>compiledRenderExpression(Object.assign(Object.assign(Object.assign({},evaluationContext),globals),{Data:Object.assign(Object.assign({},globals.Data),{globals:joinGlobals(evaluationContext,globals)}),ScopeID:data.Id}))}const clientCompiled=compileClientExpression(exprInfo.Definition);return isConstValue$1(clientCompiled)?clientCompiled:clientCompiled(evaluationContext)}const joinGlobals=(ctx1,ctx2)=>Object.assign(Object.assign({},ctx1.Data.globals),ctx2.Data.globals);function mapValue(compiledValue,convert){return"function"!=typeof compiledValue?convert(compiledValue):(data,ctx)=>{const resolvedDynamic=compiledValue(data,ctx);return isConstValue$1(resolvedDynamic)?convert(resolvedDynamic):globals=>convert(resolvedDynamic(globals))}}function resolveCompiled$1(val,data,ctx){const renderTimeValue="function"==typeof val?val(data,ctx):val;return!isConstValue$1(renderTimeValue)&&ctx?globals=>ctx.EvalDynamicRuntime(renderTimeValue,globals):renderTimeValue}function safeResolveCompiledData(val,data,expressionSource,ctx){const resolved=resolveCompiled$1(val,data,ctx);return"function"==typeof resolved?(console.warn(`Render time expression is not supported'${expressionSource?" in "+expressionSource:""}'.`),null):resolved}function isRegion(content){return"list"===content.Type||"tablix"===content.Type||"table"===content.Type||"subreport"===content.Type||"bandedlist"===content.Type}function wrapRuntimeValue(value,wrapper){return"function"==typeof value?globals=>wrapper(value(globals)):wrapper(value)}var cjs$1={},cjs={},dsl={},lodash={};!function(exports){function isObjectLike(value){return null!=value&&"object"==typeof value}Object.defineProperty(exports,"__esModule",{value:!0}),exports.isEqual=exports.isObjectLike=exports.isObject=exports.isArray=void 0,exports.isArray=Array.isArray,exports.isObject=function(value){var type=typeof value;return null!=value&&("object"==type||"function"==type)},exports.isObjectLike=isObjectLike,exports.isEqual=function isEqual(value,other){if(value===other)return!0;if(null==value||null==other||!isObjectLike(value)&&!isObjectLike(other))return value!=value&&other!=other;if(typeof value!=typeof other)return!1;switch(typeof value){case"object":return(0,exports.isArray)(value)?value.length===other.length&&value.every((function(v,i){return isEqual(v,other[i])})):isEqual(Object.keys(value).sort(),Object.keys(other).sort())&&Object.keys(value).every((function(key){return isEqual(value[key],other[key])}));default:return!1}}}(lodash),function(exports){var __assign=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},__spreadArray=commonjsGlobal&&commonjsGlobal.__spreadArray||function(to,from,pack){if(pack||2===arguments.length)for(var ar,i=0,l=from.length;i<l;i++)!ar&&i in from||(ar||(ar=Array.prototype.slice.call(from,0,i)),ar[i]=from[i]);return to.concat(ar||Array.prototype.slice.call(from))};Object.defineProperty(exports,"__esModule",{value:!0}),exports.orElse=exports.getLastRecordedFailures=exports.recordFailures=exports.upcast=exports.makeDefaultOf=exports.omit=exports.pick=exports.Enum=exports.members=exports.lazy=exports.iif=exports.alt=exports.intersectWith=exports.mapInput=exports.map=exports.arrayDef=exports.array=exports.typeDefReq=exports.typeReq=exports.required=exports.typeDef=exports.type=exports.withDefaultOf=exports.literalInit=exports.initValue=exports.DefaultOf=exports.Default=exports.nullable=exports.justRead=exports.optional=exports.boolean=exports.number=exports.string=exports.literal=exports.Temp=exports.Const=exports.unknown=exports.resultOf=exports.failure=exports.success=exports.pipe=exports.recordFailure=void 0;var lodash_1=lodash,failures=[];function clearFailures(){failures=[]}function recordFailure(error){failures.push(__assign(__assign({},error),{context:getContext()}))}function pipe(a,ab,bc,cd){for(var rest=[],_i=4;_i<arguments.length;_i++)rest[_i-4]=arguments[_i];switch(arguments.length){case 0:return;case 1:return a;case 2:return ab(a);case 3:return bc(ab(a));case 4:return cd(bc(ab(a)));default:return pipe.apply(null,__spreadArray([cd(bc(ab(a)))],rest,!0))}}exports.recordFailure=recordFailure,exports.pipe=pipe;exports.success=function(value,warnings){return void 0===warnings&&(warnings=[]),{type:"success",value:value,warnings:warnings}};exports.failure=function(message){return{type:"error",reason:message}};exports.resultOf=function(result){return"success"===result.type?result.value:void 0},exports.unknown={decode:function(u){return(0,exports.success)(u)},encode:function(v){return v}};exports.Const=function(d){return{decode:function(){return(0,exports.success)(d)},encode:function(){}}};var currentEncodeContext;function within(part,action){var startContext=currentEncodeContext;currentEncodeContext={part:part,next:startContext};try{return action()}finally{currentEncodeContext=startContext}}function getContext(){for(var parts=[],p=currentEncodeContext;null!=p&&p.part;p=p.next)parts.unshift(p.part);return"".concat.apply("",parts)}exports.Temp=function(d){return{decode:function(){return(0,exports.success)(d)},encode:function(){}}};var is=function(u){for(var values=[],_i=1;_i<arguments.length;_i++)values[_i-1]=arguments[_i];return-1!==values.findIndex((function(a){return a===u}))};exports.literal=function(){for(var values=[],_i=0;_i<arguments.length;_i++)values[_i]=arguments[_i];return{decode:function(u){return is.apply(void 0,__spreadArray([u],values,!1))?(0,exports.success)(u):(0,exports.failure)("expected ".concat(values.map((function(value){return JSON.stringify(value)})).join(" | "),", got: '").concat(u,"'"))},encode:function(v){return"string"==typeof v||"number"==typeof v||null===v?v:(recordFailure({type:"error",message:"expected a string value"}),null==v?void 0:v.toString())}}},exports.string={decode:function(u){return"string"==typeof u?(0,exports.success)(u):(0,exports.failure)("expected string")},encode:function(v){return"string"==typeof v?v:(recordFailure({type:"error",message:"expected a string value"}),null==v?void 0:v.toString())}},exports.number={decode:function(u){return"number"!=typeof u||Number.isNaN(u)?(0,exports.failure)("expected number"):(0,exports.success)(u)},encode:function(v){return"number"==typeof v?v:(recordFailure({type:"error",message:"expected a numeric value"}),null==v||Number.isNaN(+v)?void 0:+v)}},exports.boolean={decode:function(u){return"boolean"==typeof u?(0,exports.success)(u):(0,exports.failure)("expected boolean")},encode:function(v){return"boolean"==typeof v?v:(recordFailure({type:"error",message:"expected a bool value"}),null==v?void 0:!!v)}};exports.optional=function(or){return{decode:function(u){return null==u?(0,exports.success)(void 0):or.decode(u)},encode:function(v){return void 0===v?void 0:or.encode(v)}}};exports.justRead=function(or){return{decode:or.decode,encode:function(){}}};exports.nullable=function(or){return{decode:function(u){return null==u?(0,exports.success)(null):or.decode(u)},encode:function(v){return null==v?null:or.encode(v)}}};exports.Default=function(d,or){return{decode:function(u){return void 0===u?(0,exports.success)(d):or.decode(u)},encode:function(v){if(!Array.isArray(v)||0!==v.length||!Array.isArray(d)||0!==d.length)return(0,lodash_1.isEqual)(v,d)?void 0:or.encode(v)}}};exports.DefaultOf=function(d,or){var defaultResult=or.decode(d);if("error"===defaultResult.type)throw new Error("Failed to create a default result");var defaultValue=Object.freeze(defaultResult.value);return{decode:function(u){return void 0===u?(0,exports.success)(defaultValue):or.decode(u)},encode:function(v){var u=or.encode(v);return(0,lodash_1.isEqual)(u,d)?void 0:u}}};exports.initValue=function(d,or){return{decode:function(u){return void 0===u?(0,exports.success)(d):or.decode(u)},encode:or.encode}};exports.literalInit=function(val){return(0,exports.initValue)(val,(0,exports.literal)(val))};exports.withDefaultOf=function(d){return function(or){return(0,exports.DefaultOf)(d,or)}};exports.type=function(properties){return{decode:function(u){if(null==u)return(0,exports.failure)("non-null expected");var result={};for(var k in properties)if({}.hasOwnProperty.call(properties,k)){if(!properties[k])return(0,exports.failure)("".concat(k,": missing property"));var propResult=properties[k].decode(u[k]);if("error"===propResult.type)return(0,exports.failure)("".concat(k,": ").concat(propResult.reason));result[k]=propResult.value}return(0,exports.success)(result)},encode:function(v){if(null!=v){var result={},_loop_1=function(k){if(!{}.hasOwnProperty.call(properties,k))return"continue";within(".",(function(){var propResult=within(k,(function(){return properties[k].encode(v[k])}));void 0!==propResult&&(result[k]=propResult)}))};for(var k in properties)_loop_1(k);return result}recordFailure({type:"error",message:"non-null value is expected"})}}};exports.typeDef=function(properties){return(0,exports.DefaultOf)({},(0,exports.type)(properties))};exports.required=function(){for(var req=[],_i=0;_i<arguments.length;_i++)req[_i]=arguments[_i];return function(d){return{decode:function(u){var missingProp=req.find((function(propName){return void 0===u[propName]}));return null!=missingProp&&recordFailure({type:"error",message:"Property ".concat(String(missingProp)," is marked as required, but not provided")}),d.decode(u)},encode:function(v){return d.encode(v)}}}};exports.typeReq=function(properties,req){return pipe((0,exports.type)(properties),exports.required.apply(void 0,req))};exports.typeDefReq=function(properties,d,req){return(0,exports.DefaultOf)(d,(0,exports.typeReq)(properties,req))};exports.array=function(element){return{decode:function(u){if(!(0,lodash_1.isArray)(u))return(0,exports.failure)("array expected");var results=u.map(element.decode),firstFailed=results.find((function(r){return"error"===r.type}));return firstFailed&&"error"===firstFailed.type?(0,exports.failure)(firstFailed.reason):(0,exports.success)(results.map(exports.resultOf))},encode:function(v){if(null!=v)return(0,lodash_1.isArray)(v)?v.map((function(e,idx){return within("[".concat(idx,"]"),(function(){return element.encode(e)}))})):(recordFailure({type:"error",message:"array is expected"}),[])}}};exports.arrayDef=function(element){return(0,exports.Default)([],(0,exports.array)(element))};exports.map=function(fn,fnrev){return function(d){return{decode:function(u){var a=d.decode(u);return"error"===a.type?a:(0,exports.success)(fn(a.value))},encode:function(v){return d.encode(fnrev(v))}}}};exports.mapInput=function(fnrev,fn){return function(d){return{decode:function(u){return d.decode(fn(u))},encode:function(v){return fnrev(d.encode(v))}}}};exports.intersectWith=function(right){return function(left){return{decode:function(u){var l=left.decode(u);if("error"===l.type)return(0,exports.failure)(l.reason);var r=right.decode(u);return"success"===r.type?(0,exports.success)(__assign(__assign({},l.value),r.value)):(0,exports.failure)(r.reason)},encode:function(v){return __assign(__assign({},left.encode(v)),right.encode(v))}}}};exports.alt=function(desc,descRev,dmap){return{decode:function(u){var itemType=desc(u)||"",decoder=dmap[itemType];return null==decoder?(0,exports.failure)('Unknown or unsupported item type "'.concat(itemType,'"')):decoder.decode(u)},encode:function(v){var decoder=dmap[descRev(v)];if(null==decoder)throw new Error("unknown item type '".concat(descRev(v),"'"));return decoder.encode(v)}}};exports.iif=function(condition,conditionRev,iftrue,iffalse){return{decode:function(u){return condition(u)?iftrue.decode(u):iffalse.decode(u)},encode:function(v){return conditionRev(v)?iftrue.encode(v):iffalse.encode(v)}}};exports.lazy=function(){var raiseError=function(){throw new Error("Cannot get here")},decoder={decode:raiseError,encode:raiseError};return[decoder,function(d){decoder.decode=d.decode,decoder.encode=d.encode}]};exports.members=function(){for(var values=[],_i=0;_i<arguments.length;_i++)values[_i]=arguments[_i];var lookup={};values.forEach((function(v){lookup[v]=v,lookup[v.toLowerCase()]=v}));var expectedMsg="expected ".concat(values.map((function(value){return JSON.stringify(value)})).join(" | "));return{decode:function(u){var v="string"==typeof u?lookup[u]||lookup[u.toLowerCase()]:void 0;return void 0!==v?(0,exports.success)(v):(0,exports.failure)("".concat(expectedMsg,", got: '").concat(u,"'"))},encode:function(v){return"string"==typeof v?v:(recordFailure({type:"error",message:"expected a string value"}),null==v?void 0:v.toString())}}};exports.Enum=function(d,or){return{decode:function(u){if(void 0===u)return(0,exports.success)(d);var result=or.decode(u);return"success"===result.type?result:(recordFailure({type:"error",message:result.reason}),(0,exports.success)(d))},encode:function(v){return v===d?void 0:or.encode(v)}}},exports.pick=function(props){for(var names=[],_i=1;_i<arguments.length;_i++)names[_i-1]=arguments[_i];for(var result={},_a=0,names_1=names;_a<names_1.length;_a++){var name=names_1[_a];result[name]=props[name]}return result},exports.omit=function(props){for(var names=[],_i=1;_i<arguments.length;_i++)names[_i-1]=arguments[_i];for(var result={},keys=Object.keys(props),_loop_2=function(key){names.find((function(n){return n===key}))||(result[key]=props[key])},_a=0,keys_1=keys;_a<keys_1.length;_a++){var key=keys_1[_a];_loop_2(key)}return result},exports.makeDefaultOf=function(decoder,empty){return void 0===empty&&(empty={}),Object.freeze((0,exports.resultOf)(decoder.decode(empty)))};exports.upcast=function(){return function(d){return d}};exports.recordFailures=function(decoder){return{decode:function(u){clearFailures();var r=decoder.decode(u),errors=failures;return"success"===r.type?(0,exports.success)(r.value,errors):r},encode:function(v){return clearFailures(),decoder.encode(v)}}};exports.getLastRecordedFailures=function(){return __spreadArray([],failures,!0)};exports.orElse=function(elseDecoder,isElse){return function(defaultDecoder){return{decode:function(u){var r=defaultDecoder.decode(u);return"error"===r.type?(recordFailure({type:"warning",message:r.reason}),elseDecoder.decode(u)):r},encode:function(v){return isElse(v)?elseDecoder.encode(v):defaultDecoder.encode(v)}}}}}(dsl);var lenses={},__assign$3=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign$3=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},__rest=commonjsGlobal&&commonjsGlobal.__rest||function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};Object.defineProperty(lenses,"__esModule",{value:!0}),lenses.identity=lenses.mapOfLens=lenses.iif=lenses.combine5=lenses.combine4=lenses.combine3=lenses.combine=lenses.replace=lenses.array=lenses.nullable=lenses.prop=lenses.make=void 0;var exports,__createBinding,__exportStar,dsl_1=dsl;lenses.make=function(encode,decode){return{f:encode,frev:decode}},lenses.prop=function(propName,lens){return{f:function(_a){var _b,_c=propName,propValue=_a[_c],rest=__rest(_a,["symbol"==typeof _c?_c:_c+""]);return __assign$3(__assign$3({},rest),((_b={})[propName]=lens.f(propValue),_b))},frev:function(_a){var _b,_c=propName,propValue=_a[_c],rest=__rest(_a,["symbol"==typeof _c?_c:_c+""]);return __assign$3(__assign$3({},rest),((_b={})[propName]=lens.frev(propValue),_b))}}},lenses.nullable=function(lens){return{f:function(value){return null===value?null:lens.f(value)},frev:function(value){return null===value?null:lens.frev(value)}}},lenses.array=function(lens){return{f:function(value){return value.map(lens.f)},frev:function(value){return value.map(lens.frev)}}},lenses.replace=function(a,b){return{f:function(){return b},frev:function(){return a}}},lenses.combine=function(ab,bc){return{f:function(a){return bc.f(ab.f(a))},frev:function(c){return ab.frev(bc.frev(c))}}},lenses.combine3=function(ab,bc,cd){return{f:function(a){return cd.f(bc.f(ab.f(a)))},frev:function(d){return ab.frev(bc.frev(cd.frev(d)))}}},lenses.combine4=function(ab,bc,cd,de){return{f:function(a){return de.f(cd.f(bc.f(ab.f(a))))},frev:function(e){return ab.frev(bc.frev(cd.frev(de.frev(e))))}}},lenses.combine5=function(ab,bc,cd,de,ef){return{f:function(a){return ef.f(de.f(cd.f(bc.f(ab.f(a)))))},frev:function(e){return ab.frev(bc.frev(cd.frev(de.frev(ef.frev(e)))))}}},lenses.iif=function(condition,conditionRev,lensT,lensF){return{f:function(value){return condition(value)?lensT.f(value):lensF.f(value)},frev:function(value){return conditionRev(value)?lensT.frev(value):lensF.frev(value)}}},lenses.mapOfLens=function(lens){return(0,dsl_1.map)(lens.f,lens.frev)},lenses.identity=function(){return{f:function(x){return x},frev:function(x){return x}}},exports=cjs,__createBinding=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k);var desc=Object.getOwnPropertyDescriptor(m,k);desc&&!("get"in desc?!m.__esModule:desc.writable||desc.configurable)||(desc={enumerable:!0,get:function(){return m[k]}}),Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__exportStar=commonjsGlobal&&commonjsGlobal.__exportStar||function(m,exports){for(var p in m)"default"===p||Object.prototype.hasOwnProperty.call(exports,p)||__createBinding(exports,m,p)},Object.defineProperty(exports,"__esModule",{value:!0}),exports.Helpers=exports.Lenses=void 0,__exportStar(dsl,exports),exports.Lenses=lenses,exports.Helpers=lodash;var rdlx={},commonTypes={},expr={};Object.defineProperty(expr,"__esModule",{value:!0}),expr.ExprColor=expr.ExprLength=expr.ExprVariant=expr.ExprNum=expr.ExprBool=expr.ExprStr=expr.c=expr.e=void 0;var ar_js_modsl_1$1=cjs;expr.e=function(r){return isEmptyExpression(r)?"":"=".concat(r)};expr.c=function(r){return r};var isEmptyExpression=function(expr){return""===expr||"="===expr||'=""'===expr},ExprDumb=function(){return{decode:function(s){return"string"==typeof s?isEmptyExpression(s)?(0,ar_js_modsl_1$1.success)(""):(0,ar_js_modsl_1$1.success)(s):null==s?(0,ar_js_modsl_1$1.failure)("non-null expected"):(0,ar_js_modsl_1$1.success)("".concat(s))},encode:function(v){return"string"==typeof v?v:((0,ar_js_modsl_1$1.recordFailure)({type:"error",message:"expected a enum/string value"}),null==v?void 0:v.toString())}}};expr.ExprStr=ExprDumb(),expr.ExprBool=ExprDumb(),expr.ExprNum=ExprDumb(),expr.ExprVariant=ExprDumb(),expr.ExprLength=ExprDumb(),expr.ExprColor=ExprDumb();var decoders$1={};!function(exports){var __assign=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},__rest=commonjsGlobal&&commonjsGlobal.__rest||function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};Object.defineProperty(exports,"__esModule",{value:!0}),exports.StoreUndefinedAsNull=exports.TreatNullAsUndefined=exports.TreatNullAs=exports.AcceptBlankString=exports.orElse=exports.changeType=exports.EnumExpr=exports.Enum=exports.members=void 0;var ar_js_modsl_1=cjs;exports.members=function(){for(var values=[],_i=0;_i<arguments.length;_i++)values[_i]=arguments[_i];var lookup={};values.forEach((function(v){lookup[v]=v,lookup[v.toLowerCase()]=v}));var expectedMsg="expected ".concat(values.map((function(value){return JSON.stringify(value)})).join(" | "));return{decode:function(u){var v="string"==typeof u?lookup[u]||lookup[u.toLowerCase()]:void 0;return void 0!==v?(0,ar_js_modsl_1.success)(v):(0,ar_js_modsl_1.failure)("".concat(expectedMsg,", got: '").concat(u,"'"))},encode:function(v){return"string"==typeof v?v:((0,ar_js_modsl_1.recordFailure)({type:"error",message:"expected a string value"}),null==v?void 0:v.toString())}}};exports.Enum=function(d,or){return{decode:function(u){if(void 0===u)return(0,ar_js_modsl_1.success)(d);var result=or.decode(u);return"success"===result.type?result:((0,ar_js_modsl_1.recordFailure)({type:"error",message:result.reason}),(0,ar_js_modsl_1.success)(d))},encode:function(v){return v===d?void 0:or.encode(v)}}};exports.EnumExpr=function(d,or){var enumDecoder=(0,exports.Enum)(d,or);return{decode:function(u){return void 0===u?(0,ar_js_modsl_1.success)(d):"string"==typeof u&&u.startsWith("=")?(0,ar_js_modsl_1.success)(u):enumDecoder.decode(u)},encode:function(v){if(v!==d)return"string"==typeof v&&v.startsWith("=")?v:or.encode(v)}}};exports.changeType=function(fromType,Type){return function(d){return(0,ar_js_modsl_1.pipe)(d,(0,ar_js_modsl_1.map)((function(_a){var rest=__rest(_a,[]);return __assign(__assign({},rest),{Type:Type})}),(function(_a){var rest=__rest(_a,[]);return __assign(__assign({},rest),{Type:fromType})})))}};exports.orElse=function(elseDecoder,isElse){return function(defaultDecoder){return{decode:function(u){var r=defaultDecoder.decode(u);return"error"===r.type?((0,ar_js_modsl_1.recordFailure)({type:"warning",message:r.reason}),elseDecoder.decode(u)):r},encode:function(v){return isElse(v)?elseDecoder.encode(v):defaultDecoder.encode(v)}}}};exports.AcceptBlankString=function(or){return{decode:function(u){return"string"==typeof u&&""===u?or.decode(void 0):or.decode(u)},encode:or.encode}};exports.TreatNullAs=function(to){return function(or){return{decode:function(u){return null===u?or.decode(to):or.decode(u)},encode:or.encode}}},exports.TreatNullAsUndefined=(0,exports.TreatNullAs)(void 0);exports.StoreUndefinedAsNull=function(or){return{decode:function(u){return or.decode(null===u?void 0:u)},encode:function(v){var r=or.encode(v);return void 0===r?null:r}}}}(decoders$1),function(exports){var __assign=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},__rest=commonjsGlobal&&commonjsGlobal.__rest||function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t},__spreadArray=commonjsGlobal&&commonjsGlobal.__spreadArray||function(to,from,pack){if(pack||2===arguments.length)for(var ar,i=0,l=from.length;i<l;i++)!ar&&i in from||(ar||(ar=Array.prototype.slice.call(from,0,i)),ar[i]=from[i]);return to.concat(ar||Array.prototype.slice.call(from))};Object.defineProperty(exports,"__esModule",{value:!0}),exports.CustomProperty=exports.QueryParameter=exports.Filters=exports.Filter=exports.FilterOperator=exports.TextProps=exports.PaddingProps=exports.FontProps=exports.BorderProps=exports.CommonStyle=exports.style=exports.Action=exports.ApplyParameterStep=exports.SubreportParameter=exports.Visibility=exports.SideStyle=exports.BorderStyle=exports.Enums=exports.Length=void 0;var expr_1=expr,ar_js_modsl_1=cjs,decoders_1=decoders$1;exports.Length=ar_js_modsl_1.string,exports.Enums={FontStyle:(0,decoders_1.members)("Default","Normal","Italic"),FontWeight:(0,decoders_1.members)("Default","Lighter","Thin","ExtraLight","Light","Normal","Medium","SemiBold","Bold","ExtraBold","Heavy","Bolder"),BackgroundGradientType:(0,decoders_1.members)("None","LeftRight","TopBottom","Center","DiagonalLeft","DiagonalRight","HorizontalCenter","VerticalCenter"),TextDecoration:(0,decoders_1.members)("Default","None","Underline","DoubleUnderline","Overline","LineThrough"),TextAlign:(0,decoders_1.members)("General","Left","Center","Right","Justify"),VerticalAlign:(0,decoders_1.members)("Default","Top","Middle","Bottom"),VerticalImageAlign:(0,decoders_1.members)("Top","Middle","Bottom"),HorizontalImageAlign:(0,decoders_1.members)("Left","Center","Right"),WrapMode:(0,decoders_1.members)("NoWrap","CharWrap","WordWrap"),Direction:(0,decoders_1.members)("Default","LTR","RTL"),LayoutDirection:(0,decoders_1.members)("LTR","RTL"),WritingMode:(0,decoders_1.members)("lr-tb","tb-rl"),Calendar:(0,decoders_1.members)("Default","Gregorian","GregorianArabic","GregorianMiddleEastFrench","GregorianTransliteratedEnglish","GregorianTransliteratedFrench","GregorianUSEnglish","Hebrew","Hijri","Japanese","Korean","Taiwan","ThaiBuddhist"),UnicodeBiDi:(0,decoders_1.members)("Normal","Embed","BidiOverride"),UprightInVerticalText:(0,decoders_1.members)("None","Digits","DigitsAndLatinLetters"),TextJustify:(0,decoders_1.members)("Auto","Distribute","DistributeAllLines"),BorderStyle:(0,decoders_1.members)("Default","None","Dotted","Dashed","Solid","Double","DashDot","DashDotDot","Groove","Ridge","Inset","WindowInset","Outset"),BorderSideStyle:(0,decoders_1.members)("","Default","None","Dotted","Dashed","Solid","Double","DashDot","DashDotDot","Groove","Ridge","Inset","WindowInset","Outset"),BreakLocation:(0,decoders_1.members)("Start","End","StartAndEnd","Between","None"),NewPage:(0,decoders_1.members)("Next","Odd","Even"),DataElementOutput:(0,decoders_1.members)("Auto","Output","NoOutput","ContentsOnly"),DataElementStyle:(0,decoders_1.members)("Auto","AttributeNormal","ElementNormal"),ImageSource:(0,decoders_1.members)("External","Embedded","Database"),ImageRepeat:(0,decoders_1.members)("Repeat","NoRepeat","RepeatX","RepeatY"),ShapeStyle:(0,decoders_1.members)("Rectangle","RoundRect","Ellipse"),ApplyValueCmd:(0,decoders_1.members)("Set","Reset","Toggle"),RectangleOverflow:(0,decoders_1.members)("Scroll","Clip","Auto","Grow"),BulletLabelFontStyles:(0,decoders_1.members)("Regular","Bold","Italic","Underline","Strikeout"),ParagraphTextAlign:(0,decoders_1.members)("Left","Center","Right","Justify")},exports.BorderStyle=(0,ar_js_modsl_1.typeDef)({Color:(0,ar_js_modsl_1.DefaultOf)("Black",expr_1.ExprColor),Style:(0,decoders_1.EnumExpr)("None",exports.Enums.BorderStyle),Width:(0,ar_js_modsl_1.DefaultOf)("1pt",expr_1.ExprLength)}),exports.SideStyle=(0,ar_js_modsl_1.typeDef)({Color:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprColor),Style:(0,decoders_1.EnumExpr)("",exports.Enums.BorderSideStyle),Width:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprLength)});var BackgroundImage=(0,ar_js_modsl_1.typeDef)({Source:(0,decoders_1.Enum)("External",exports.Enums.ImageSource),Value:(0,ar_js_modsl_1.Default)("",expr_1.ExprStr),MIMEType:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprStr),BackgroundRepeat:(0,decoders_1.EnumExpr)("Repeat",exports.Enums.ImageRepeat)});exports.Visibility=(0,ar_js_modsl_1.typeDef)({Hidden:(0,ar_js_modsl_1.Default)("False",expr_1.ExprBool),ToggleItem:(0,ar_js_modsl_1.Default)("",ar_js_modsl_1.string)}),exports.SubreportParameter=(0,ar_js_modsl_1.pipe)((0,ar_js_modsl_1.type)({Type:(0,ar_js_modsl_1.Const)("parameter"),ParameterName:ar_js_modsl_1.string,Value:(0,ar_js_modsl_1.Default)("",expr_1.ExprVariant),Omit:(0,ar_js_modsl_1.Default)("false",expr_1.ExprBool)}),(0,ar_js_modsl_1.required)("ParameterName")),exports.ApplyParameterStep=(0,ar_js_modsl_1.pipe)((0,ar_js_modsl_1.type)({Name:(0,ar_js_modsl_1.Default)("",ar_js_modsl_1.string),Type:(0,decoders_1.Enum)("Set",exports.Enums.ApplyValueCmd),Value:(0,ar_js_modsl_1.Default)("",expr_1.ExprVariant)}),(0,ar_js_modsl_1.required)("Name")),exports.Action=(0,ar_js_modsl_1.pipe)((0,ar_js_modsl_1.type)({Hyperlink:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprStr),Drillthrough:(0,ar_js_modsl_1.typeDef)({ReportName:(0,ar_js_modsl_1.Default)("",expr_1.ExprStr),Parameters:(0,ar_js_modsl_1.arrayDef)(exports.SubreportParameter)}),BookmarkLink:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprStr),ApplyParameters:(0,ar_js_modsl_1.typeDef)({Parameters:(0,ar_js_modsl_1.arrayDef)(exports.ApplyParameterStep)})}),(0,ar_js_modsl_1.withDefaultOf)({}),decoders_1.TreatNullAsUndefined);var styleDecoders={Border:exports.BorderStyle,TopBorder:exports.SideStyle,RightBorder:exports.SideStyle,BottomBorder:exports.SideStyle,LeftBorder:exports.SideStyle,BackgroundColor:(0,ar_js_modsl_1.DefaultOf)("Transparent",expr_1.ExprColor),BackgroundGradientEndColor:(0,ar_js_modsl_1.DefaultOf)("Transparent",expr_1.ExprColor),BackgroundGradientType:(0,decoders_1.EnumExpr)("None",exports.Enums.BackgroundGradientType),BackgroundImage:BackgroundImage,FontStyle:(0,decoders_1.EnumExpr)("Normal",exports.Enums.FontStyle),FontFamily:(0,ar_js_modsl_1.DefaultOf)("Arial",expr_1.ExprStr),FontSize:(0,ar_js_modsl_1.DefaultOf)("10pt",expr_1.ExprLength),FontWeight:(0,decoders_1.EnumExpr)("Normal",exports.Enums.FontWeight),LineHeight:(0,ar_js_modsl_1.Default)("1pt",expr_1.ExprLength),LineSpacing:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprLength),CharacterSpacing:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprLength),Format:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprStr),TextDecoration:(0,decoders_1.EnumExpr)("None",exports.Enums.TextDecoration),TextAlign:(0,decoders_1.EnumExpr)("General",exports.Enums.TextAlign),VerticalAlign:(0,decoders_1.EnumExpr)("Top",exports.Enums.VerticalAlign),WrapMode:(0,decoders_1.EnumExpr)("WordWrap",exports.Enums.WrapMode),Color:(0,ar_js_modsl_1.DefaultOf)("Black",expr_1.ExprColor),PaddingLeft:(0,ar_js_modsl_1.DefaultOf)("0pt",expr_1.ExprLength),PaddingRight:(0,ar_js_modsl_1.DefaultOf)("0pt",expr_1.ExprLength),PaddingTop:(0,ar_js_modsl_1.DefaultOf)("0pt",expr_1.ExprLength),PaddingBottom:(0,ar_js_modsl_1.DefaultOf)("0pt",expr_1.ExprLength),Direction:(0,decoders_1.EnumExpr)("LTR",exports.Enums.Direction),WritingMode:(0,decoders_1.EnumExpr)("lr-tb",exports.Enums.WritingMode),Language:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprStr),Calendar:(0,decoders_1.EnumExpr)("Gregorian",exports.Enums.Calendar),NumeralLanguage:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprStr),NumeralVariant:(0,ar_js_modsl_1.Default)("1",expr_1.ExprNum),UnicodeBiDi:(0,decoders_1.EnumExpr)("Normal",exports.Enums.UnicodeBiDi),UprightInVerticalText:(0,decoders_1.EnumExpr)("None",exports.Enums.UprightInVerticalText),TextIndent:(0,ar_js_modsl_1.DefaultOf)("0.5in",exports.Length),LeadingChar:(0,ar_js_modsl_1.Default)("",expr_1.ExprStr),MaxLevel:(0,ar_js_modsl_1.DefaultOf)("0",expr_1.ExprNum),HeadingLevel:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprNum),ShrinkToFit:(0,ar_js_modsl_1.Default)("False",expr_1.ExprBool),TextJustify:(0,decoders_1.Enum)("Auto",exports.Enums.TextJustify),Angle:(0,ar_js_modsl_1.Default)("0",ar_js_modsl_1.string),MinCondenseRate:(0,ar_js_modsl_1.Default)(100,expr_1.ExprNum)};exports.style=function(){for(var names=[],_i=0;_i<arguments.length;_i++)names[_i]=arguments[_i];return ar_js_modsl_1.pick.apply(void 0,__spreadArray([styleDecoders],names,!1))},exports.CommonStyle=(0,ar_js_modsl_1.type)(styleDecoders),exports.BorderProps=(0,exports.style)("Border","TopBorder","BottomBorder","LeftBorder","RightBorder"),exports.FontProps=(0,exports.style)("FontFamily","FontSize","FontStyle","FontWeight"),exports.PaddingProps=(0,exports.style)("PaddingLeft","PaddingRight","PaddingTop","PaddingBottom"),exports.TextProps=__assign(__assign(__assign({},exports.FontProps),exports.PaddingProps),(0,exports.style)("Color","Format","LineHeight","TextAlign","TextDecoration","VerticalAlign","Calendar","Direction","Language","NumeralLanguage","NumeralVariant","UnicodeBiDi","UprightInVerticalText","WritingMode")),exports.FilterOperator=(0,decoders_1.members)("Equal","Like","NotEqual","GreaterThan","GreaterThanOrEqual","LessThan","LessThanOrEqual","TopN","BottomN","TopPercent","BottomPercent","In","Between"),exports.Filter=(0,ar_js_modsl_1.pipe)((0,ar_js_modsl_1.type)({FilterExpression:(0,ar_js_modsl_1.initValue)("",expr_1.ExprVariant),Operator:(0,ar_js_modsl_1.initValue)("Equal",exports.FilterOperator),FilterValues:(0,ar_js_modsl_1.arrayDef)(expr_1.ExprVariant)}),(0,ar_js_modsl_1.required)("FilterExpression","Operator","FilterValues")),exports.Filters=(0,ar_js_modsl_1.arrayDef)(exports.Filter);var QueryParameterLegacyDecoder={encode:function(){return{}},decode:function(x){x.Name,x.Value;var $legacy=__rest(x,["Name","Value"]);return 0===Object.keys($legacy).length?(0,ar_js_modsl_1.success)({}):(0,ar_js_modsl_1.success)({$legacy:$legacy})}};exports.QueryParameter=(0,ar_js_modsl_1.pipe)((0,ar_js_modsl_1.type)({Name:ar_js_modsl_1.string,Value:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprVariant)}),(0,ar_js_modsl_1.intersectWith)(QueryParameterLegacyDecoder),(0,ar_js_modsl_1.required)("Name","Value")),exports.CustomProperty=(0,ar_js_modsl_1.pipe)((0,ar_js_modsl_1.type)({Name:ar_js_modsl_1.string,Value:(0,ar_js_modsl_1.initValue)("",expr_1.ExprVariant)}),(0,ar_js_modsl_1.required)("Name","Value"))}(commonTypes);var data$1={};!function(exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.DataSet=exports.Field=exports.DataSource=exports.ReportParameter=exports.Filters=void 0;var ar_js_modsl_1=cjs,expr_1=expr,commonTypes_1=commonTypes,decoders_1=decoders$1,commonTypes_2=commonTypes;Object.defineProperty(exports,"Filters",{enumerable:!0,get:function(){return commonTypes_2.Filters}});var boolean_false=(0,ar_js_modsl_1.Default)(!1,ar_js_modsl_1.boolean),string_empty=(0,ar_js_modsl_1.Default)("",ar_js_modsl_1.string),ThreeStateBool=(0,decoders_1.members)("Auto","True","False"),DataSetReference=(0,ar_js_modsl_1.typeDefReq)({DataSetName:ar_js_modsl_1.string,ValueField:ar_js_modsl_1.string,LabelField:string_empty},{DataSetName:"",ValueField:""},["DataSetName","ValueField"]),ParameterValue=(0,ar_js_modsl_1.type)({Value:(0,ar_js_modsl_1.optional)(expr_1.ExprVariant),Label:(0,ar_js_modsl_1.optional)(expr_1.ExprVariant)}),OrderBy=(0,ar_js_modsl_1.DefaultOf)({},(0,ar_js_modsl_1.type)({Condition:(0,ar_js_modsl_1.initValue)("None",(0,decoders_1.members)("None","Label","Value")),Direction:(0,decoders_1.Enum)("Ascending",(0,decoders_1.members)("Ascending","Descending"))})),ReportParameterValidValue=(0,ar_js_modsl_1.DefaultOf)({},(0,ar_js_modsl_1.type)({ParameterValues:(0,ar_js_modsl_1.arrayDef)(ParameterValue),DataSetReference:DataSetReference,OrderBy:OrderBy})),ReportParameterDefaultValue=(0,ar_js_modsl_1.DefaultOf)({},(0,ar_js_modsl_1.type)({Values:(0,ar_js_modsl_1.arrayDef)(expr_1.ExprVariant),DataSetReference:DataSetReference}));exports.ReportParameter=(0,ar_js_modsl_1.pipe)((0,ar_js_modsl_1.type)({Type:(0,ar_js_modsl_1.Const)("reportparameter"),AllowBlank:boolean_false,DataType:(0,ar_js_modsl_1.initValue)("String",(0,decoders_1.members)("Boolean","Date","DateTime","Integer","Float","String")),DefaultValue:ReportParameterDefaultValue,Hidden:boolean_false,Multiline:boolean_false,MultiValue:boolean_false,Name:ar_js_modsl_1.string,Nullable:boolean_false,Prompt:(0,ar_js_modsl_1.Default)("",expr_1.ExprStr),SelectAllValue:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprVariant),UsedInQuery:(0,decoders_1.Enum)("Auto",ThreeStateBool),ValidValues:ReportParameterValidValue,DisplayFormat:(0,ar_js_modsl_1.Default)("",ar_js_modsl_1.string)}),(0,ar_js_modsl_1.required)("Name","DataType")),exports.DataSource=(0,ar_js_modsl_1.pipe)((0,ar_js_modsl_1.type)({Name:ar_js_modsl_1.string,Transaction:boolean_false,DataSourceReference:string_empty,ConnectionProperties:(0,ar_js_modsl_1.typeDefReq)({DataProvider:ar_js_modsl_1.string,ConnectString:(0,ar_js_modsl_1.Default)("",expr_1.ExprStr),IntegratedSecurity:boolean_false,Prompt:string_empty},{DataProvider:""},["DataProvider"])})),exports.Field=(0,ar_js_modsl_1.pipe)((0,ar_js_modsl_1.type)({Name:string_empty,DataField:string_empty,Value:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprVariant)}),(0,ar_js_modsl_1.required)("Name")),exports.DataSet=(0,ar_js_modsl_1.pipe)((0,ar_js_modsl_1.type)({Name:ar_js_modsl_1.string,Fields:(0,ar_js_modsl_1.arrayDef)(exports.Field),Query:(0,ar_js_modsl_1.typeDefReq)({DataSourceName:ar_js_modsl_1.string,CommandType:(0,decoders_1.Enum)("Text",(0,decoders_1.members)("Text","StoredProcedure","TableDirect")),CommandText:(0,decoders_1.TreatNullAsUndefined)((0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprStr)),QueryParameters:(0,ar_js_modsl_1.arrayDef)(commonTypes_1.QueryParameter),Timeout:(0,ar_js_modsl_1.Default)(0,ar_js_modsl_1.number)},{DataSourceName:""},["DataSourceName"]),Filters:commonTypes_1.Filters,CaseSensitivity:(0,ar_js_modsl_1.initValue)("Auto",ThreeStateBool),Collation:string_empty,KanatypeSensitivity:(0,ar_js_modsl_1.initValue)("Auto",ThreeStateBool),AccentSensitivity:(0,ar_js_modsl_1.initValue)("Auto",ThreeStateBool),WidthSensitivity:(0,ar_js_modsl_1.initValue)("Auto",ThreeStateBool)}),(0,ar_js_modsl_1.required)("Name"))}(data$1);var reportItems={},common={};!function(exports){var __assign=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0}),exports.Length_0in=exports.string_empty=exports.boolean_true=exports.boolean_false=exports.ReportItemProps=exports.ReportItemProperties=void 0;var ar_js_modsl_1=cjs,expr_1=expr,commonTypes_1=commonTypes;exports.ReportItemProperties={Name:ar_js_modsl_1.string,ZIndex:(0,ar_js_modsl_1.Default)(0,ar_js_modsl_1.number),Visibility:commonTypes_1.Visibility,ToolTip:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprStr),Bookmark:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprStr),DataElementName:(0,ar_js_modsl_1.Default)("",ar_js_modsl_1.string),DataElementOutput:(0,ar_js_modsl_1.Default)("Auto",commonTypes_1.Enums.DataElementOutput),Label:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprStr),LayerName:(0,ar_js_modsl_1.Default)("default",ar_js_modsl_1.string),CustomProperties:(0,ar_js_modsl_1.arrayDef)(commonTypes_1.CustomProperty)};exports.ReportItemProps=function(itemType){return __assign({Type:(0,ar_js_modsl_1.literalInit)(itemType)},exports.ReportItemProperties)},exports.boolean_false=(0,ar_js_modsl_1.Default)(!1,ar_js_modsl_1.boolean),exports.boolean_true=(0,ar_js_modsl_1.Default)(!0,ar_js_modsl_1.boolean),exports.string_empty=(0,ar_js_modsl_1.Default)("",ar_js_modsl_1.string),exports.Length_0in=(0,ar_js_modsl_1.DefaultOf)("0in",commonTypes_1.Length)}(common);var richtext={},__assign$2=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign$2=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};Object.defineProperty(richtext,"__esModule",{value:!0}),richtext.RichText=void 0;var ar_js_modsl_1=cjs,expr_1=expr,commonTypes_1=commonTypes,decoders_1=decoders$1,common_1=common,TextItemStyle={FontFamily:(0,ar_js_modsl_1.optional)(expr_1.ExprStr),FontSize:(0,ar_js_modsl_1.optional)(expr_1.ExprLength),FontStyle:(0,ar_js_modsl_1.optional)(commonTypes_1.Enums.FontStyle),FontWeight:(0,ar_js_modsl_1.optional)(commonTypes_1.Enums.FontWeight),Color:(0,ar_js_modsl_1.optional)(expr_1.ExprColor),LineSpacing:(0,ar_js_modsl_1.optional)(expr_1.ExprLength),BackgroundColor:(0,ar_js_modsl_1.optional)(expr_1.ExprColor),TextDecoration:(0,ar_js_modsl_1.optional)(commonTypes_1.Enums.TextDecoration)},TextRun=(0,ar_js_modsl_1.pipe)((0,ar_js_modsl_1.type)({Type:(0,ar_js_modsl_1.literalInit)("text"),Action:commonTypes_1.Action,Label:common_1.string_empty,Value:(0,ar_js_modsl_1.Default)("",expr_1.ExprStr),StyleName:common_1.string_empty,Style:(0,ar_js_modsl_1.typeDef)(__assign$2(__assign$2({},TextItemStyle),{Subscript:(0,ar_js_modsl_1.optional)(expr_1.ExprBool),Superscript:(0,ar_js_modsl_1.optional)(expr_1.ExprBool)})),ToolTip:(0,ar_js_modsl_1.Default)("",expr_1.ExprStr)}),(0,ar_js_modsl_1.required)("Type")),ImageRun=(0,ar_js_modsl_1.pipe)((0,ar_js_modsl_1.type)({Type:(0,ar_js_modsl_1.literalInit)("image"),Action:commonTypes_1.Action,Label:common_1.string_empty,Source:(0,decoders_1.Enum)("External",commonTypes_1.Enums.ImageSource),Value:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprStr),Width:(0,ar_js_modsl_1.DefaultOf)("1in",expr_1.ExprLength),Height:(0,ar_js_modsl_1.DefaultOf)("1in",expr_1.ExprLength),MIMEType:(0,decoders_1.TreatNullAsUndefined)((0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprStr)),ToolTip:(0,ar_js_modsl_1.Default)("",expr_1.ExprStr)}),(0,ar_js_modsl_1.required)("Type")),ParaRun=(0,ar_js_modsl_1.alt)((function(i){return i.Type||"text"}),(function(o){return o.Type}),{text:TextRun,image:ImageRun}),Paragraph=(0,ar_js_modsl_1.type)({TextRuns:(0,ar_js_modsl_1.arrayDef)(ParaRun),LeftIndent:(0,ar_js_modsl_1.optional)(expr_1.ExprLength),RightIndent:(0,ar_js_modsl_1.optional)(expr_1.ExprLength),HangingIndent:(0,ar_js_modsl_1.optional)(expr_1.ExprLength),StyleName:common_1.string_empty,Style:(0,ar_js_modsl_1.typeDef)(__assign$2(__assign$2({},TextItemStyle),{TextAlign:(0,ar_js_modsl_1.optional)(commonTypes_1.Enums.ParagraphTextAlign)})),ListStyle:(0,decoders_1.Enum)("None",(0,decoders_1.members)("None","Numbered","Bullet")),ListLevel:(0,ar_js_modsl_1.Default)(0,ar_js_modsl_1.number),ListItemIndex:(0,ar_js_modsl_1.Default)(0,ar_js_modsl_1.number),SpaceBefore:(0,ar_js_modsl_1.optional)(expr_1.ExprLength),SpaceAfter:(0,ar_js_modsl_1.optional)(expr_1.ExprLength),ListStyleType:(0,ar_js_modsl_1.optional)((0,decoders_1.Enum)("None",(0,decoders_1.members)("None","Disc","Circle","Square","Decimal","DecimalLeadingZero","CircledNumber","LowerRoman","UpperRoman","LowerLatin","UpperLatin","LowerGreek","UpperGreek","Katakana","KatakanaBrackets","KatakanaIrohaBrackets","KatakanaIroha","KatakanaLower","KatakanaIrohaLower")))}),RichTextBase=(0,ar_js_modsl_1.pipe)((0,ar_js_modsl_1.type)(__assign$2(__assign$2({},(0,common_1.ReportItemProps)("richtext")),{CanGrow:common_1.boolean_false,DataElementStyle:(0,ar_js_modsl_1.Default)("Auto",commonTypes_1.Enums.DataElementStyle),KeepTogether:common_1.boolean_false,Style:(0,ar_js_modsl_1.typeDef)(__assign$2(__assign$2(__assign$2(__assign$2({},commonTypes_1.BorderProps),commonTypes_1.FontProps),commonTypes_1.PaddingProps),(0,commonTypes_1.style)("Color","LineHeight","BackgroundColor","BackgroundImage")))})),(0,ar_js_modsl_1.required)("Name"));richtext.RichText=(0,ar_js_modsl_1.alt)((function(p){return p.MarkupType||"None"}),(function(r){return r.MarkupType}),{None:(0,ar_js_modsl_1.pipe)(RichTextBase,(0,ar_js_modsl_1.intersectWith)((0,ar_js_modsl_1.type)({MarkupType:(0,ar_js_modsl_1.Const)("None"),Paragraphs:(0,ar_js_modsl_1.arrayDef)(Paragraph)}))),HTML:(0,ar_js_modsl_1.pipe)(RichTextBase,(0,ar_js_modsl_1.intersectWith)((0,ar_js_modsl_1.type)({MarkupType:(0,ar_js_modsl_1.literalInit)("HTML"),Value:expr_1.ExprVariant})))}),function(exports){var __assign=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},__createBinding=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k);var desc=Object.getOwnPropertyDescriptor(m,k);desc&&!("get"in desc?!m.__esModule:desc.writable||desc.configurable)||(desc={enumerable:!0,get:function(){return m[k]}}),Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__exportStar=commonjsGlobal&&commonjsGlobal.__exportStar||function(m,exports){for(var p in m)"default"===p||Object.prototype.hasOwnProperty.call(exports,p)||__createBinding(exports,m,p)},__rest=commonjsGlobal&&commonjsGlobal.__rest||function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};Object.defineProperty(exports,"__esModule",{value:!0}),exports.UnknownReportItem=exports.InputField=exports.FormattedText=exports.Bullet=exports.Image=exports.Barcode=exports.TableOfContents=exports.Shape=exports.Subreport=exports.Sparkline=exports.DvChart=exports.DVPlotConfig=exports.DVTextsEncoding=exports.DVValueAggregateEncoding=exports.DVAggregateEncoding=exports.DVEncodingField=exports.BandedList=exports.Tablix=exports.recChildrenLens=exports.Table=exports.List=exports.DataRegionProps=exports.GroupDef=exports.Group=exports.SortExpressions=exports.SortExpression=exports.Rectangle=exports.Line=exports.CheckBox=exports.TextBox=exports.ReportItemProperties=void 0;var decoders_1=decoders$1,ar_js_modsl_1=cjs,expr_1=expr,commonTypes_1=commonTypes,decoders_2=decoders$1,common_1=common;Object.defineProperty(exports,"ReportItemProperties",{enumerable:!0,get:function(){return common_1.ReportItemProperties}}),__exportStar(richtext,exports),exports.TextBox=(0,ar_js_modsl_1.pipe)((0,ar_js_modsl_1.type)(__assign(__assign({},(0,common_1.ReportItemProps)("textbox")),{Action:commonTypes_1.Action,CanGrow:common_1.boolean_false,CanShrink:common_1.boolean_false,DataElementStyle:(0,ar_js_modsl_1.Default)("Auto",commonTypes_1.Enums.DataElementStyle),KeepTogether:common_1.boolean_false,ToggleImage:(0,ar_js_modsl_1.typeDefReq)({InitialState:expr_1.ExprBool},{InitialState:"False"},["InitialState"]),UserSort:(0,ar_js_modsl_1.typeDefReq)({SortExpression:expr_1.ExprStr,SortExpressionScope:common_1.string_empty,SortTarget:common_1.string_empty},{SortExpression:""},["SortExpression"]),Value:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprVariant),Style:(0,ar_js_modsl_1.typeDef)(__assign(__assign(__assign({},commonTypes_1.BorderProps),commonTypes_1.TextProps),(0,commonTypes_1.style)("BackgroundColor","BackgroundImage","TextJustify","WrapMode","ShrinkToFit","LineSpacing","LineHeight","CharacterSpacing","Angle","HeadingLevel","MinCondenseRate")))})),(0,ar_js_modsl_1.required)("Name"));var CheckAlignment=(0,decoders_2.Enum)("MiddleLeft",(0,decoders_2.members)("TopLeft","TopCenter","TopRight","MiddleLeft","MiddleCenter","MiddleRight","BottomLeft","BottomCenter","BottomRight")),AutoMergeMode=(0,decoders_2.Enum)("Never",(0,decoders_2.members)("Never","Always","Restricted")),SparklineGradient=(0,decoders_2.Enum)("None",(0,decoders_2.members)("None","LeftRight","TopBottom","Center","DiagonalLeft","DiagonalRight","HorizontalCenter","VerticalCenter"));exports.CheckBox=(0,ar_js_modsl_1.pipe)((0,ar_js_modsl_1.type)(__assign(__assign({},(0,common_1.ReportItemProps)("checkbox")),{CheckAlignment:CheckAlignment,Text:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprStr),Checked:(0,ar_js_modsl_1.Default)("False",expr_1.ExprBool),DataElementStyle:(0,ar_js_modsl_1.DefaultOf)("Auto",commonTypes_1.Enums.DataElementStyle),Style:(0,ar_js_modsl_1.typeDef)(__assign(__assign(__assign(__assign({},commonTypes_1.BorderProps),commonTypes_1.PaddingProps),commonTypes_1.FontProps),(0,commonTypes_1.style)("BackgroundColor","BackgroundImage","Color","WrapMode","TextDecoration")))})),(0,ar_js_modsl_1.required)("Name"));var LinePoint=(0,ar_js_modsl_1.initValue)({X:"0in",Y:"0in"},(0,ar_js_modsl_1.type)({X:(0,ar_js_modsl_1.initValue)("0in",commonTypes_1.Length),Y:(0,ar_js_modsl_1.initValue)("0in",commonTypes_1.Length)}));exports.Line=(0,ar_js_modsl_1.pipe)((0,ar_js_modsl_1.type)(__assign(__assign({},(0,ar_js_modsl_1.omit)((0,common_1.ReportItemProps)("line"),"DataElementName","DataElementOutput","ToolTip")),{StartPoint:LinePoint,EndPoint:LinePoint,LineWidth:(0,ar_js_modsl_1.DefaultOf)("1pt",expr_1.ExprLength),LineStyle:(0,decoders_2.EnumExpr)("Solid",commonTypes_1.Enums.BorderStyle),LineColor:(0,ar_js_modsl_1.DefaultOf)("Black",expr_1.ExprColor)})),(0,ar_js_modsl_1.required)("Name"));exports.Rectangle=function(reportItem){return(0,ar_js_modsl_1.pipe)((0,ar_js_modsl_1.type)(__assign(__assign({},(0,common_1.ReportItemProps)("rectangle")),{PageBreak:(0,ar_js_modsl_1.Default)("None",commonTypes_1.Enums.BreakLocation),NewPage:(0,ar_js_modsl_1.Default)("Next",commonTypes_1.Enums.NewPage),KeepTogether:common_1.boolean_false,PageName:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprStr),RoundingRadius:(0,ar_js_modsl_1.typeDef)({Default:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprLength),TopLeft:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprLength),TopRight:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprLength),BottomLeft:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprLength),BottomRight:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprLength)}),ConsumeWhiteSpace:common_1.boolean_false,Overflow:(0,decoders_2.Enum)("Auto",commonTypes_1.Enums.RectangleOverflow),LinkToChild:common_1.string_empty,Style:(0,ar_js_modsl_1.typeDef)(__assign(__assign({},commonTypes_1.BorderProps),(0,commonTypes_1.style)("BackgroundColor","BackgroundImage"))),ReportItems:(0,ar_js_modsl_1.arrayDef)(reportItem)})),(0,ar_js_modsl_1.required)("Name"))},exports.SortExpression=(0,ar_js_modsl_1.type)({Value:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprVariant),Direction:(0,decoders_2.Enum)("Ascending",(0,decoders_2.members)("Ascending","Descending"))}),exports.SortExpressions=(0,ar_js_modsl_1.arrayDef)(exports.SortExpression);var GroupProps={Name:common_1.string_empty,DocumentMapLabel:(0,ar_js_modsl_1.Default)("",expr_1.ExprStr),GroupExpressions:(0,ar_js_modsl_1.arrayDef)(expr_1.ExprVariant),PageBreak:(0,ar_js_modsl_1.Default)("None",commonTypes_1.Enums.BreakLocation),PageBreakDisabled:(0,ar_js_modsl_1.Default)("False",expr_1.ExprBool),NewPage:(0,ar_js_modsl_1.Default)("Next",commonTypes_1.Enums.NewPage),Filters:commonTypes_1.Filters,ParentGroup:(0,ar_js_modsl_1.Default)("",expr_1.ExprVariant),DataElementName:common_1.string_empty,DataElementOutput:(0,ar_js_modsl_1.Default)("Output",commonTypes_1.Enums.DataElementOutput),DataCollectionName:common_1.string_empty,NewSection:common_1.boolean_false};exports.Group=(0,ar_js_modsl_1.type)(GroupProps),exports.GroupDef=(0,ar_js_modsl_1.DefaultOf)({},exports.Group),exports.DataRegionProps={NoRowsMessage:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprStr),DataSetName:common_1.string_empty,DataSetParameters:(0,ar_js_modsl_1.arrayDef)(commonTypes_1.QueryParameter),PageBreak:(0,ar_js_modsl_1.Default)("None",commonTypes_1.Enums.BreakLocation),NewPage:(0,ar_js_modsl_1.Default)("Next",commonTypes_1.Enums.NewPage),Filters:commonTypes_1.Filters,PageName:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprStr),NewSection:common_1.boolean_false};exports.List=function(reportItem){return(0,ar_js_modsl_1.pipe)((0,ar_js_modsl_1.type)(__assign(__assign(__assign({},(0,common_1.ReportItemProps)("list")),exports.DataRegionProps),{Action:commonTypes_1.Action,SortExpressions:exports.SortExpressions,KeepTogether:common_1.boolean_false,ConsumeWhiteSpace:common_1.boolean_false,DataInstanceName:common_1.string_empty,DataInstanceElementOutput:(0,decoders_2.Enum)("Output",(0,decoders_2.members)("Output","NoOutput")),Group:exports.GroupDef,RowsOrColumnsCount:(0,ar_js_modsl_1.Default)(1,ar_js_modsl_1.number),GrowDirection:(0,decoders_2.Enum)("Column",(0,decoders_2.members)("Column","ColumnReverse","Row","RowReverse")),Style:(0,ar_js_modsl_1.typeDef)(__assign(__assign(__assign({},commonTypes_1.BorderProps),commonTypes_1.TextProps),(0,commonTypes_1.style)("BackgroundColor","BackgroundImage"))),ReportItems:(0,ar_js_modsl_1.arrayDef)(reportItem)})),(0,ar_js_modsl_1.required)("Name"))};exports.Table=function(reportItem){var TableColumn=(0,ar_js_modsl_1.type)({Type:(0,ar_js_modsl_1.Const)("tablecolumn"),Width:common_1.Length_0in,FixedHeader:common_1.boolean_false,Visibility:commonTypes_1.Visibility,AutoWidth:(0,decoders_2.Enum)("None",(0,decoders_2.members)("None","Proportional"))}),TableCell=(0,ar_js_modsl_1.pipe)((0,ar_js_modsl_1.type)({Item:reportItem,ColSpan:(0,ar_js_modsl_1.Default)(1,ar_js_modsl_1.number),RowSpan:(0,ar_js_modsl_1.Default)(1,ar_js_modsl_1.number),AutoMergeMode:AutoMergeMode}),(0,ar_js_modsl_1.required)("Item")),TableRow=(0,ar_js_modsl_1.type)({Action:commonTypes_1.Action,Type:(0,ar_js_modsl_1.Const)("tablerow"),Height:common_1.Length_0in,Visibility:commonTypes_1.Visibility,TableCells:(0,ar_js_modsl_1.arrayDef)((0,ar_js_modsl_1.nullable)(TableCell))}),TableHeader=(0,ar_js_modsl_1.type)({Type:(0,ar_js_modsl_1.Const)("tableheader"),FixedHeader:common_1.boolean_false,TableRows:(0,ar_js_modsl_1.arrayDef)(TableRow),RepeatOnNewPage:common_1.boolean_false}),TableFooter=(0,ar_js_modsl_1.type)({Type:(0,ar_js_modsl_1.Const)("tablefooter"),PrintAtBottom:common_1.boolean_false,TableRows:(0,ar_js_modsl_1.arrayDef)(TableRow),RepeatOnNewPage:common_1.boolean_false}),TableDetails=(0,ar_js_modsl_1.type)({Type:(0,ar_js_modsl_1.Const)("tabledetails"),TableRows:(0,ar_js_modsl_1.arrayDef)(TableRow),Group:exports.GroupDef,SortExpressions:exports.SortExpressions,Visibility:commonTypes_1.Visibility}),TableGroup=(0,ar_js_modsl_1.type)({Type:(0,ar_js_modsl_1.Const)("tablegroup"),Group:exports.GroupDef,SortExpressions:exports.SortExpressions,Header:(0,ar_js_modsl_1.Default)(null,(0,ar_js_modsl_1.nullable)(TableHeader)),Footer:(0,ar_js_modsl_1.Default)(null,(0,ar_js_modsl_1.nullable)(TableFooter)),Visibility:commonTypes_1.Visibility,KeepTogether:common_1.boolean_false,PreventOrphanedFooter:common_1.boolean_true});return(0,ar_js_modsl_1.pipe)((0,ar_js_modsl_1.type)(__assign(__assign(__assign({},(0,common_1.ReportItemProps)("table")),exports.DataRegionProps),{KeepTogether:common_1.boolean_false,FillPage:common_1.boolean_false,DetailDataElementName:common_1.string_empty,DetailDataCollectionName:common_1.string_empty,DetailDataElementOutput:(0,ar_js_modsl_1.Default)("Auto",commonTypes_1.Enums.DataElementOutput),FrozenRows:(0,ar_js_modsl_1.Default)(0,ar_js_modsl_1.number),FrozenColumns:(0,ar_js_modsl_1.Default)(0,ar_js_modsl_1.number),RepeatToFill:common_1.boolean_false,RepeatBlankRows:(0,decoders_2.Enum)("None",(0,decoders_2.members)("None","FillPage","FillGroup")),PreventOrphanedFooter:common_1.boolean_true,SortExpressions:exports.SortExpressions,Style:(0,ar_js_modsl_1.typeDef)(__assign(__assign(__assign({},commonTypes_1.BorderProps),commonTypes_1.TextProps),(0,commonTypes_1.style)("BackgroundColor","BackgroundImage"))),TableColumns:(0,ar_js_modsl_1.arrayDef)(TableColumn),Header:(0,ar_js_modsl_1.Default)(null,(0,ar_js_modsl_1.nullable)(TableHeader)),TableGroups:(0,ar_js_modsl_1.arrayDef)(TableGroup),Details:(0,ar_js_modsl_1.Default)(null,(0,ar_js_modsl_1.nullable)(TableDetails)),Footer:(0,ar_js_modsl_1.Default)(null,(0,ar_js_modsl_1.nullable)(TableFooter))})),(0,ar_js_modsl_1.required)("Name"))};var addRecChildren=function(d){var _a=(0,ar_js_modsl_1.lazy)(),decoder=_a[0],setDecoder=_a[1],result=(0,ar_js_modsl_1.pipe)(d,(0,ar_js_modsl_1.intersectWith)((0,ar_js_modsl_1.type)({Children:(0,ar_js_modsl_1.arrayDef)(decoder)})));return setDecoder(result),result};exports.recChildrenLens=function(d){var result=ar_js_modsl_1.Lenses.make((function(_a){var Children=_a.Children,rest=__rest(_a,["Children"]);return __assign(__assign({},d.f(rest)),{Children:Children.map(result.f)})}),(function(_a){var Children=_a.Children,rest=__rest(_a,["Children"]);return __assign(__assign({},d.frev(rest)),{Children:Children.map(result.frev)})}));return result};exports.Tablix=function(reportItem){var TablixHeader=(0,ar_js_modsl_1.type)({Item:reportItem,LevelCount:(0,ar_js_modsl_1.Default)(0,ar_js_modsl_1.number)}),TablixMember=(0,ar_js_modsl_1.pipe)((0,ar_js_modsl_1.type)({Header:(0,ar_js_modsl_1.Default)(null,(0,ar_js_modsl_1.nullable)(TablixHeader)),BodyIndex:(0,ar_js_modsl_1.Default)(-1,ar_js_modsl_1.number),BodyCount:(0,ar_js_modsl_1.Default)(1,ar_js_modsl_1.number),Visibility:commonTypes_1.Visibility,DataElementName:common_1.string_empty,DataElementOutput:(0,ar_js_modsl_1.Default)("Auto",commonTypes_1.Enums.DataElementOutput),KeepTogether:common_1.boolean_false,Group:(0,ar_js_modsl_1.nullable)((0,ar_js_modsl_1.type)(__assign(__assign({},GroupProps),{PrintFooterAtBottom:common_1.boolean_false}))),KeepWithGroup:(0,decoders_2.Enum)("None",(0,decoders_2.members)("None","Before","After")),RepeatOnNewPage:common_1.boolean_false,SortExpressions:exports.SortExpressions}),addRecChildren),TablixCellProps={RowSpan:(0,ar_js_modsl_1.Default)(1,ar_js_modsl_1.number),ColSpan:(0,ar_js_modsl_1.Default)(1,ar_js_modsl_1.number),Item:(0,ar_js_modsl_1.Default)(null,(0,ar_js_modsl_1.nullable)(reportItem))},TablixCornerCell=(0,ar_js_modsl_1.type)(TablixCellProps),TablixBodyCell=(0,ar_js_modsl_1.type)(__assign(__assign({},TablixCellProps),{AutoMergeMode:AutoMergeMode})),TablixBodyRow=(0,ar_js_modsl_1.type)({Height:common_1.Length_0in,Cells:(0,ar_js_modsl_1.arrayDef)((0,ar_js_modsl_1.nullable)(TablixBodyCell))}),TablixHierarchy=(0,ar_js_modsl_1.typeDef)({LevelSizes:(0,ar_js_modsl_1.arrayDef)(commonTypes_1.Length),Members:(0,ar_js_modsl_1.arrayDef)(TablixMember)}),TablixCornerRow=(0,ar_js_modsl_1.array)((0,ar_js_modsl_1.nullable)(TablixCornerCell));return(0,ar_js_modsl_1.pipe)((0,ar_js_modsl_1.type)(__assign(__assign(__assign({},(0,common_1.ReportItemProps)("tablix")),exports.DataRegionProps),{SortExpressions:exports.SortExpressions,KeepTogether:common_1.boolean_false,FrozenRows:(0,ar_js_modsl_1.Default)(0,ar_js_modsl_1.number),FrozenColumns:(0,ar_js_modsl_1.Default)(0,ar_js_modsl_1.number),RepeatColumnHeaders:common_1.boolean_false,RepeatRowHeaders:common_1.boolean_false,GroupsBeforeRowHeaders:(0,ar_js_modsl_1.Default)(0,ar_js_modsl_1.number),LayoutDirection:(0,ar_js_modsl_1.Default)("LTR",commonTypes_1.Enums.LayoutDirection),RowHierarchy:TablixHierarchy,ColumnHierarchy:TablixHierarchy,Corner:(0,ar_js_modsl_1.arrayDef)(TablixCornerRow),Body:(0,ar_js_modsl_1.typeDef)({Columns:(0,ar_js_modsl_1.arrayDef)(commonTypes_1.Length),Rows:(0,ar_js_modsl_1.arrayDef)(TablixBodyRow)}),Style:(0,ar_js_modsl_1.typeDef)(__assign(__assign(__assign({},commonTypes_1.BorderProps),commonTypes_1.TextProps),(0,commonTypes_1.style)("BackgroundColor","BackgroundImage")))})),(0,ar_js_modsl_1.required)("Name"))};exports.BandedList=function(reportItem){var BandedListBandProps={Name:(0,ar_js_modsl_1.nullable)(ar_js_modsl_1.string),Action:commonTypes_1.Action,CanShrink:common_1.boolean_false,CanGrow:common_1.boolean_true,KeepTogether:common_1.boolean_true,Height:common_1.Length_0in,Visibility:commonTypes_1.Visibility,PageBreak:(0,ar_js_modsl_1.Default)("None",commonTypes_1.Enums.BreakLocation),NewPage:(0,ar_js_modsl_1.Default)("Next",commonTypes_1.Enums.NewPage)},BandedListDetails=(0,ar_js_modsl_1.type)(__assign(__assign({Type:(0,ar_js_modsl_1.Const)("bandedlistdetails")},BandedListBandProps),{ReportItems:(0,ar_js_modsl_1.arrayDef)(reportItem)})),BandedListHeader=(0,ar_js_modsl_1.type)(__assign(__assign({Type:(0,ar_js_modsl_1.Const)("bandedlistheader")},BandedListBandProps),{RepeatOnNewPage:common_1.boolean_false,ReportItems:(0,ar_js_modsl_1.arrayDef)(reportItem)})),BandedListFooter=(0,ar_js_modsl_1.type)(__assign(__assign({Type:(0,ar_js_modsl_1.Const)("bandedlistfooter")},BandedListBandProps),{RepeatOnNewPage:common_1.boolean_false,PrintAtBottom:common_1.boolean_false,ReportItems:(0,ar_js_modsl_1.arrayDef)(reportItem)})),BandedListGroup=(0,ar_js_modsl_1.type)({Type:(0,ar_js_modsl_1.Const)("bandedlistgroup"),Group:exports.GroupDef,SortExpressions:exports.SortExpressions,Visibility:commonTypes_1.Visibility,KeepTogether:common_1.boolean_false,PreventOrphanedHeader:common_1.boolean_false,PreventOrphanedFooter:common_1.boolean_false,Header:(0,ar_js_modsl_1.Default)(null,(0,ar_js_modsl_1.nullable)(BandedListHeader)),Footer:(0,ar_js_modsl_1.Default)(null,(0,ar_js_modsl_1.nullable)(BandedListFooter))});return(0,ar_js_modsl_1.pipe)((0,ar_js_modsl_1.type)(__assign(__assign(__assign({},(0,common_1.ReportItemProps)("bandedlist")),(0,ar_js_modsl_1.omit)(exports.DataRegionProps,"NoRowsMessage")),{KeepTogether:common_1.boolean_false,ConsumeWhiteSpace:common_1.boolean_false,PreventOrphanedHeader:common_1.boolean_false,PreventOrphanedFooter:common_1.boolean_false,Header:(0,ar_js_modsl_1.Default)(null,(0,ar_js_modsl_1.nullable)(BandedListHeader)),Details:(0,ar_js_modsl_1.Default)(null,(0,ar_js_modsl_1.nullable)(BandedListDetails)),Footer:(0,ar_js_modsl_1.Default)(null,(0,ar_js_modsl_1.nullable)(BandedListFooter)),Groups:(0,ar_js_modsl_1.arrayDef)(BandedListGroup)})),(0,ar_js_modsl_1.required)("Name"))};var DVAggregate=(0,decoders_2.Enum)("None",(0,decoders_2.members)("None","Average","Count","CountOfAll","List","Max","Min","PopulationStandardDeviation","PopulationVariance","Range","StandardDeviation","Sum","Variance")),DVChartPalette=(0,decoders_2.Enum)("Office",(0,decoders_2.members)("Aspect","Blue","Blue2","BlueGreen","BlueWarm","Cerulan","Cocoa","Coral","Cyborg","Dark","Darkly","Flatly","Grayscale","Green","GreenYellow","HighContrast","Light","Marquee","Median","Midnight","Modern","Office","Office2010","Orange","OrangeRed","Organic","Paper","Red","RedOrange","RedViolet","Slate","Slipstream","Standard","Superhero","Violet","Violet2","Yellow","YellowOrange","Zen","Custom")),DvTextStyleProps=__assign(__assign({},commonTypes_1.FontProps),(0,commonTypes_1.style)("Color","TextDecoration")),DVLegendCommonOptionProps={Hidden:common_1.boolean_false,Orientation:(0,decoders_2.Enum)("Horizontal",(0,decoders_2.members)("Horizontal","Vertical")),Position:(0,decoders_2.Enum)("Right",(0,decoders_2.members)("Left","Right","Top","Bottom")),Style:(0,ar_js_modsl_1.typeDef)(__assign(__assign({},commonTypes_1.PaddingProps),(0,commonTypes_1.style)("BackgroundColor","Border"))),TextStyle:(0,ar_js_modsl_1.typeDef)(DvTextStyleProps),TitleStyle:(0,ar_js_modsl_1.typeDef)(DvTextStyleProps)},DVHeaderFooterProps={Style:(0,ar_js_modsl_1.typeDef)(__assign(__assign({},commonTypes_1.PaddingProps),(0,commonTypes_1.style)("BackgroundColor","Border"))),TextStyle:(0,ar_js_modsl_1.typeDef)(DvTextStyleProps),Title:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprStr),Height:(0,decoders_2.AcceptBlankString)((0,ar_js_modsl_1.optional)(ar_js_modsl_1.number)),HAlign:(0,decoders_2.Enum)("Center",(0,decoders_2.members)("Center","Left","Right")),VAlign:(0,decoders_2.Enum)("Middle",(0,decoders_2.members)("Middle","Bottom","Top"))},DvLineElementStyle=(0,ar_js_modsl_1.typeDef)((0,commonTypes_1.style)("Border")),DVAxis=(0,ar_js_modsl_1.typeDef)({Type:(0,ar_js_modsl_1.Const)("dvchartaxis"),AxisLine:common_1.boolean_true,AxisType:(0,decoders_2.Enum)("X",(0,decoders_2.members)("X","Y")),DateMode:(0,decoders_2.Enum)("Default",(0,decoders_2.members)("Default","Millisecond","Second","Minute","Hour","Day","Week","Month","Year")),Format:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprStr),LabelAngle:(0,ar_js_modsl_1.Default)(0,ar_js_modsl_1.number),LabelField:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprStr),Labels:common_1.boolean_true,LabelStyle:(0,ar_js_modsl_1.typeDef)(__assign(__assign(__assign({},DvTextStyleProps),commonTypes_1.PaddingProps),(0,commonTypes_1.style)("WritingMode"))),LineStyle:DvLineElementStyle,LogBase:(0,ar_js_modsl_1.Default)(10,ar_js_modsl_1.number),MajorGrid:common_1.boolean_false,MajorGridStyle:DvLineElementStyle,MajorTicks:(0,decoders_2.Enum)("None",(0,decoders_2.members)("Inside","Outside","Cross","None")),MajorTickSize:(0,ar_js_modsl_1.DefaultOf)("4pt",expr_1.ExprLength),MajorTickStyle:DvLineElementStyle,MajorUnit:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprNum),Max:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprNum),Min:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprNum),MinorGrid:common_1.boolean_false,MinorGridStyle:DvLineElementStyle,MinorTicks:(0,decoders_2.Enum)("None",(0,decoders_2.members)("Inside","Outside","Cross","None")),MinorTickSize:(0,ar_js_modsl_1.DefaultOf)("2pt",expr_1.ExprLength),MinorTickStyle:DvLineElementStyle,MinorUnit:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprNum),Origin:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprNum),OverlappingLabels:(0,decoders_2.Enum)("Auto",(0,decoders_2.members)("Auto","Show")),Plots:(0,ar_js_modsl_1.arrayDef)(ar_js_modsl_1.string),Position:(0,decoders_2.Enum)("Near",(0,decoders_2.members)("Near","Far","None")),Reversed:common_1.boolean_false,Scale:(0,decoders_2.Enum)("Linear",(0,decoders_2.members)("Linear","Logarithmic","Ordinal","Percentage")),Style:DvLineElementStyle,TextStyle:(0,ar_js_modsl_1.typeDef)(__assign(__assign({},DvTextStyleProps),commonTypes_1.PaddingProps)),Title:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprStr),TitleStyle:(0,ar_js_modsl_1.typeDef)(__assign(__assign({},DvTextStyleProps),commonTypes_1.PaddingProps)),MaxHeight:(0,ar_js_modsl_1.Default)(1,ar_js_modsl_1.number),MaxWidth:(0,ar_js_modsl_1.Default)(1,ar_js_modsl_1.number),Width:(0,ar_js_modsl_1.Default)(null,(0,ar_js_modsl_1.nullable)(ar_js_modsl_1.number)),Height:(0,ar_js_modsl_1.Default)(null,(0,ar_js_modsl_1.nullable)(ar_js_modsl_1.number))}),DVLegendOption=(0,ar_js_modsl_1.typeDef)(__assign(__assign({Type:(0,ar_js_modsl_1.Const)("dvchartlegend")},DVLegendCommonOptionProps),{MaxHeight:(0,ar_js_modsl_1.Default)(1,ar_js_modsl_1.number),MaxWidth:(0,ar_js_modsl_1.Default)(1,ar_js_modsl_1.number),Title:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprStr),LegendType:(0,decoders_2.Enum)("Color",(0,decoders_2.members)("Color","Shape","Size")),IconColor:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprColor),RangeOptions:(0,ar_js_modsl_1.arrayDef)((0,ar_js_modsl_1.type)({Title:common_1.string_empty,To:ar_js_modsl_1.number}))})),SimpleEncodingField=(0,ar_js_modsl_1.typeDef)({FieldType:(0,ar_js_modsl_1.literalInit)("Simple"),Value:(0,ar_js_modsl_1.arrayDef)(expr_1.ExprVariant),Captions:(0,ar_js_modsl_1.arrayDef)((0,ar_js_modsl_1.pipe)(ar_js_modsl_1.string,(0,decoders_1.TreatNullAs)("")))}),ComplexEncodingField=(0,ar_js_modsl_1.typeDef)({FieldType:(0,ar_js_modsl_1.literalInit)("Complex"),Subfields:(0,ar_js_modsl_1.arrayDef)((0,ar_js_modsl_1.type)({Key:ar_js_modsl_1.string,Value:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprVariant),Caption:common_1.string_empty}))});exports.DVEncodingField=(0,ar_js_modsl_1.iif)((function(value){return"Complex"===(null==value?void 0:value.FieldType)}),(function(v){return"Complex"===v.FieldType}),ComplexEncodingField,SimpleEncodingField);var DVCategoryEncoding=(0,ar_js_modsl_1.typeDef)({Type:(0,ar_js_modsl_1.Const)("dvchartcategoryencoding"),Field:SimpleEncodingField,Sort:(0,decoders_2.Enum)("None",(0,decoders_2.members)("None","Ascending","Descending")),SortingField:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprVariant),SortingAggregate:DVAggregate}),DVDetailEncoding=(0,ar_js_modsl_1.typeDef)({Type:(0,ar_js_modsl_1.Const)("dvchartdetailsencoding"),Field:SimpleEncodingField,Group:(0,decoders_2.Enum)("None",(0,decoders_2.members)("None","Cluster","Stack")),ExcludeNulls:common_1.boolean_false,Sort:(0,decoders_2.Enum)("None",(0,decoders_2.members)("None","Ascending","Descending")),SortingField:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprVariant),SortingAggregate:DVAggregate});exports.DVAggregateEncoding=(0,ar_js_modsl_1.typeDef)({Type:(0,ar_js_modsl_1.Const)("dvchartaggregateencoding"),Field:SimpleEncodingField,Aggregate:DVAggregate,Action:commonTypes_1.Action}),exports.DVValueAggregateEncoding=(0,ar_js_modsl_1.typeDef)({Type:(0,ar_js_modsl_1.Const)("dvchartvalueaggregateencoding"),Field:exports.DVEncodingField,Aggregate:DVAggregate}),exports.DVTextsEncoding=(0,ar_js_modsl_1.typeDef)({Type:(0,ar_js_modsl_1.Const)("dvcharttextencoding"),Field:SimpleEncodingField,Target:(0,decoders_2.Enum)("Label",(0,decoders_2.members)("Label","ToolTip")),Aggregate:DVAggregate});var DVRule=(0,ar_js_modsl_1.type)({Name:(0,ar_js_modsl_1.initValue)("",ar_js_modsl_1.string),Type:(0,ar_js_modsl_1.Const)("dvchartrule"),Condition:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprStr),RuleProperties:(0,ar_js_modsl_1.arrayDef)((0,ar_js_modsl_1.type)({TargetProperty:(0,decoders_2.Enum)("BackgroundColor",(0,decoders_2.members)("BackgroundColor","LineColor","LineStyle","LineWidth","SymbolBackgroundColor","SymbolLineColor","SymbolLineStyle","SymbolLineWidth","LabelTemplate","TooltipTemplate")),Value:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprVariant)}))}),DVOverlay=(0,ar_js_modsl_1.type)({Name:ar_js_modsl_1.string,Type:(0,ar_js_modsl_1.Const)("dvchartoverlay"),OverlayType:(0,decoders_2.Enum)("ReferenceLine",(0,decoders_2.members)("ReferenceLine","ReferenceBand","LinearTrendline","ExponentialTrendline","PowerTrendline","LogarithmicTrendline","PolynomialTrendline","FourierTrendline","MovingAverageTrendline","CumulativeMovingAverageTrendline","ExponentialMovingAverageTrendline","WeightedMovingAverageTrendline","MovingAnnualTotalTrendline")),Display:(0,decoders_2.Enum)("Front",(0,decoders_2.members)("Front","Back")),Style:(0,ar_js_modsl_1.typeDef)((0,commonTypes_1.style)("Border","BackgroundColor")),Field:common_1.string_empty,DetailLevel:(0,decoders_2.Enum)("Total",(0,decoders_2.members)("Group","Total")),LegendLabel:common_1.string_empty,Value:common_1.string_empty,Axis:(0,decoders_2.Enum)("Y",(0,decoders_2.members)("X","Y")),AggregateType:(0,decoders_2.Enum)("Average",(0,decoders_2.members)("Sum","Count","Average","Max","Min","Median","Percentile")),Start:(0,ar_js_modsl_1.Default)(0,ar_js_modsl_1.number),End:(0,ar_js_modsl_1.Default)(0,ar_js_modsl_1.number),Order:(0,ar_js_modsl_1.Default)(2,ar_js_modsl_1.number),Period:(0,ar_js_modsl_1.Default)(2,ar_js_modsl_1.number),ForwardForecastPeriod:(0,ar_js_modsl_1.Default)(0,ar_js_modsl_1.number),BackwardForecastPeriod:(0,ar_js_modsl_1.Default)(0,ar_js_modsl_1.number),Intercept:(0,ar_js_modsl_1.Default)(null,(0,ar_js_modsl_1.nullable)(ar_js_modsl_1.number))});exports.DVPlotConfig=(0,ar_js_modsl_1.pipe)((0,ar_js_modsl_1.typeDef)({Action:commonTypes_1.Action,AxisMode:(0,decoders_2.Enum)("Cartesian",(0,decoders_2.members)("Cartesian","Radial","Polygonal")),Bar:(0,ar_js_modsl_1.typeDef)({BottomWidth:(0,ar_js_modsl_1.optional)(ar_js_modsl_1.number),NeckHeight:(0,ar_js_modsl_1.optional)(ar_js_modsl_1.number),Overlap:(0,ar_js_modsl_1.optional)(ar_js_modsl_1.number),TopWidth:(0,ar_js_modsl_1.optional)(ar_js_modsl_1.number),Width:(0,ar_js_modsl_1.optional)(ar_js_modsl_1.number)}),BarLines:common_1.boolean_false,BarLineStyle:(0,ar_js_modsl_1.typeDef)({Color:(0,ar_js_modsl_1.DefaultOf)("Black",expr_1.ExprColor),Style:(0,decoders_2.EnumExpr)("Solid",commonTypes_1.Enums.BorderStyle),Width:(0,ar_js_modsl_1.DefaultOf)("1pt",expr_1.ExprLength)}),ClippingMode:(0,decoders_2.Enum)("Clip",(0,decoders_2.members)("Clip","Fit","None")),CustomLabels:(0,ar_js_modsl_1.arrayDef)((0,ar_js_modsl_1.pipe)((0,ar_js_modsl_1.typeDef)({Type:(0,ar_js_modsl_1.Const)("dvchartplotcustomlabel"),Style:(0,ar_js_modsl_1.typeDef)(__assign(__assign({},(0,commonTypes_1.style)("TextDecoration","Color","WritingMode")),commonTypes_1.FontProps)),Text:(0,ar_js_modsl_1.Default)("",expr_1.ExprStr),OffsetX:(0,ar_js_modsl_1.Default)("0in",commonTypes_1.Length),OffsetY:(0,ar_js_modsl_1.Default)("0.5in",commonTypes_1.Length)}),decoders_1.StoreUndefinedAsNull)),InnerRadius:(0,ar_js_modsl_1.Default)(0,ar_js_modsl_1.number),LineAspect:(0,decoders_2.Enum)("Default",(0,decoders_2.members)("Default","Spline","StepCenter","StepLeft","StepRight")),LineStyle:(0,ar_js_modsl_1.typeDef)({Color:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprColor),Style:(0,decoders_2.EnumExpr)("None",commonTypes_1.Enums.BorderStyle),Width:(0,ar_js_modsl_1.DefaultOf)("1pt",expr_1.ExprLength)}),Offset:(0,ar_js_modsl_1.Default)(0,ar_js_modsl_1.number),Opacity:(0,ar_js_modsl_1.Default)(1,ar_js_modsl_1.number),Overlays:(0,ar_js_modsl_1.arrayDef)(DVOverlay),Pointers:(0,ar_js_modsl_1.arrayDef)((0,ar_js_modsl_1.pipe)((0,ar_js_modsl_1.typeDef)({Type:(0,ar_js_modsl_1.Const)("dvchartplotpointer"),Style:(0,ar_js_modsl_1.typeDef)({BackgroundColor:(0,ar_js_modsl_1.DefaultOf)("Black",expr_1.ExprColor)}),NeedleWidth:(0,ar_js_modsl_1.Default)("0in",commonTypes_1.Length),NeedlePinWidth:(0,ar_js_modsl_1.Default)("0in",commonTypes_1.Length),End:(0,ar_js_modsl_1.Default)("",expr_1.ExprStr)}),decoders_1.StoreUndefinedAsNull)),Radial:common_1.boolean_false,ShowNulls:(0,decoders_2.Enum)("Gaps",(0,decoders_2.members)("Connected","Gaps","Zeros")),StartAngle:(0,ar_js_modsl_1.Default)(0,ar_js_modsl_1.number),Style:(0,ar_js_modsl_1.typeDef)({BackgroundColor:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprColor)}),SwapAxes:common_1.boolean_false,Sweep:(0,ar_js_modsl_1.Default)(360,ar_js_modsl_1.number),SymbolOpacity:(0,ar_js_modsl_1.Default)(1,ar_js_modsl_1.number),Symbols:common_1.boolean_false,SymbolShape:(0,decoders_2.Enum)("Auto",(0,decoders_2.members)("Auto","Dot","Box","Diamond","Triangle","X","Dash","Plus")),SymbolStyle:(0,ar_js_modsl_1.typeDef)(__assign({BackgroundColor:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprColor)},(0,commonTypes_1.style)("Border"))),Text:(0,ar_js_modsl_1.typeDef)({ConnectingLine:DvLineElementStyle,LinePosition:(0,decoders_2.Enum)("Auto",(0,decoders_2.members)("Auto","Center")),Offset:(0,ar_js_modsl_1.Default)(0,ar_js_modsl_1.number),OverlappingLabels:(0,decoders_2.Enum)("Auto",(0,decoders_2.members)("Auto","Show","Hide")),TextPosition:(0,decoders_2.Enum)("Auto",(0,decoders_2.members)("Auto","Center","Inside","Outside")),Template:common_1.string_empty,Style:(0,ar_js_modsl_1.typeDef)(__assign(__assign({},DvTextStyleProps),(0,commonTypes_1.style)("BackgroundColor","Border")))}),Tooltip:(0,ar_js_modsl_1.typeDef)({Template:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprStr)}),Rules:(0,ar_js_modsl_1.arrayDef)(DVRule),UnpivotData:common_1.boolean_false}),(0,ar_js_modsl_1.map)((function(config){return __assign(__assign({},config),{AxisMode:"Cartesian"===config.AxisMode&&config.Radial?"Radial":config.AxisMode})}),(function(config){return __assign(__assign({},config),{Radial:"Radial"===config.AxisMode})})));var DVPlot=(0,ar_js_modsl_1.typeDef)({Type:(0,ar_js_modsl_1.Const)("dvchartplot"),PlotType:(0,decoders_2.Enum)("Bar",(0,decoders_2.members)("Bar","Line","Area","Scatter","HighLowOpenClose","Candlestick")),PlotName:(0,ar_js_modsl_1.Default)("p1",ar_js_modsl_1.string),Encodings:(0,ar_js_modsl_1.typeDef)({Values:(0,ar_js_modsl_1.arrayDef)((0,decoders_1.StoreUndefinedAsNull)(exports.DVValueAggregateEncoding)),Category:DVCategoryEncoding,Details:(0,ar_js_modsl_1.arrayDef)((0,decoders_1.StoreUndefinedAsNull)(DVDetailEncoding)),Color:exports.DVAggregateEncoding,Shape:exports.DVAggregateEncoding,Size:exports.DVAggregateEncoding,Texts:(0,ar_js_modsl_1.arrayDef)((0,decoders_1.StoreUndefinedAsNull)(exports.DVTextsEncoding))}),Config:exports.DVPlotConfig,PlotChartType:(0,decoders_2.Enum)("Custom",(0,decoders_2.members)("Custom","Column","Bar","Line","Pie","Area","Pyramid","Funnel","Scatter","Bubble","Gantt","Candlestick","HighLowClose","HighLowOpenClose","PolarColumn","PolarBar","RadarArea","RadarBubble","RadarScatter","RadarLine","RangeArea","RangeBar","RangeColumn","Gauge")),PlotChartSubtype:(0,decoders_2.Enum)("Plain",(0,decoders_2.members)("Plain","Clustered","Stacked"))});exports.DvChart=(0,ar_js_modsl_1.pipe)((0,ar_js_modsl_1.type)(__assign(__assign(__assign({},(0,common_1.ReportItemProps)("dvchart")),exports.DataRegionProps),{Style:(0,ar_js_modsl_1.typeDef)(__assign(__assign(__assign({},commonTypes_1.BorderProps),commonTypes_1.TextProps),(0,commonTypes_1.style)("BackgroundColor","BackgroundImage","BackgroundGradientType","BackgroundGradientEndColor"))),Bar:(0,ar_js_modsl_1.typeDef)({BottomWidth:(0,ar_js_modsl_1.Default)(.55,ar_js_modsl_1.number),NeckHeight:(0,ar_js_modsl_1.Default)(1,ar_js_modsl_1.number),Overlap:(0,ar_js_modsl_1.Default)(0,ar_js_modsl_1.number),TopWidth:(0,ar_js_modsl_1.Default)(.55,ar_js_modsl_1.number),Width:(0,ar_js_modsl_1.Default)(.55,ar_js_modsl_1.number)}),Header:(0,ar_js_modsl_1.typeDef)(__assign({Type:(0,ar_js_modsl_1.Const)("dvchartheader")},DVHeaderFooterProps)),Footer:(0,ar_js_modsl_1.typeDef)(__assign({Type:(0,ar_js_modsl_1.Const)("dvchartfooter")},DVHeaderFooterProps)),Palette:DVChartPalette,CustomPalette:(0,ar_js_modsl_1.arrayDef)(expr_1.ExprColor),Legend:(0,ar_js_modsl_1.typeDef)(__assign(__assign({Type:(0,ar_js_modsl_1.Const)("dvchartgloballegend")},DVLegendCommonOptionProps),{Wrapping:common_1.boolean_true})),PlotArea:(0,ar_js_modsl_1.typeDef)({Type:(0,ar_js_modsl_1.Const)("dvchartplotarea"),Axes:(0,ar_js_modsl_1.arrayDef)((0,decoders_1.StoreUndefinedAsNull)(DVAxis)),Legends:(0,ar_js_modsl_1.arrayDef)((0,decoders_1.StoreUndefinedAsNull)(DVLegendOption)),Style:(0,ar_js_modsl_1.typeDef)(__assign(__assign({},commonTypes_1.PaddingProps),(0,commonTypes_1.style)("BackgroundColor","Border")))}),Plots:(0,ar_js_modsl_1.arrayDef)((0,decoders_1.StoreUndefinedAsNull)(DVPlot))})),(0,ar_js_modsl_1.required)("Name")),exports.Sparkline=(0,ar_js_modsl_1.pipe)((0,ar_js_modsl_1.type)(__assign(__assign({},(0,common_1.ReportItemProps)("sparkline")),{DataSetName:common_1.string_empty,DataSetParameters:(0,ar_js_modsl_1.arrayDef)(commonTypes_1.QueryParameter),Filters:commonTypes_1.Filters,SortExpressions:exports.SortExpressions,Group:exports.GroupDef,FillColor:(0,ar_js_modsl_1.Default)("Black",expr_1.ExprColor),GradientStyle:SparklineGradient,GradientEndColor:(0,ar_js_modsl_1.Default)("White",expr_1.ExprColor),LineColor:(0,ar_js_modsl_1.Default)("Black",expr_1.ExprColor),LineWidth:(0,ar_js_modsl_1.Default)("1pt",expr_1.ExprLength),MarkerColor:(0,ar_js_modsl_1.Default)("Black",expr_1.ExprColor),MarkerVisibility:common_1.boolean_true,MaximumColumnWidth:(0,ar_js_modsl_1.Default)("",expr_1.ExprLength),RangeFillColor:(0,ar_js_modsl_1.Default)("Gray",expr_1.ExprColor),RangeGradientStyle:SparklineGradient,RangeGradientEndColor:(0,ar_js_modsl_1.Default)("White",expr_1.ExprColor),RangeLowerBound:(0,ar_js_modsl_1.Default)("",expr_1.ExprNum),RangeUpperBound:(0,ar_js_modsl_1.Default)("",expr_1.ExprNum),RangeVisibility:common_1.boolean_false,SparklineType:(0,decoders_2.Enum)("Line",(0,decoders_2.members)("Line","Columns","Whiskers","Area","StackedBar")),SeriesValue:(0,ar_js_modsl_1.Default)("",expr_1.ExprNum)})),(0,ar_js_modsl_1.required)("Name"));var SubreportParameter=(0,ar_js_modsl_1.type)({ParameterName:common_1.string_empty,Value:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprVariant),Omit:(0,ar_js_modsl_1.DefaultOf)("false",expr_1.ExprBool)});exports.Subreport=(0,ar_js_modsl_1.pipe)((0,ar_js_modsl_1.type)(__assign(__assign({},(0,common_1.ReportItemProps)("subreport")),{ReportName:common_1.string_empty,NoRowsMessage:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprStr),KeepTogether:common_1.boolean_false,MergeTransactions:common_1.boolean_false,SubstituteThemeOnSubreport:common_1.boolean_false,InheritStyleSheet:common_1.boolean_true,Parameters:(0,ar_js_modsl_1.arrayDef)(SubreportParameter),Style:(0,ar_js_modsl_1.typeDef)(__assign(__assign({},commonTypes_1.BorderProps),commonTypes_1.TextProps)),PageName:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprStr)})),(0,ar_js_modsl_1.required)("Name")),exports.Shape=(0,ar_js_modsl_1.pipe)((0,ar_js_modsl_1.type)(__assign(__assign({},(0,common_1.ReportItemProps)("shape")),{Style:(0,ar_js_modsl_1.typeDef)(__assign(__assign({},commonTypes_1.BorderProps),(0,commonTypes_1.style)("BackgroundColor","BackgroundImage"))),RoundingRadius:(0,ar_js_modsl_1.typeDef)({Default:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprLength),TopLeft:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprLength),TopRight:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprLength),BottomLeft:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprLength),BottomRight:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprLength)}),ShapeStyle:(0,decoders_2.EnumExpr)("Rectangle",commonTypes_1.Enums.ShapeStyle)})),(0,ar_js_modsl_1.required)("Name"));var TableOfContentsLevel=(0,ar_js_modsl_1.type)({Type:(0,ar_js_modsl_1.Const)("tableofcontentslevel"),LevelName:(0,ar_js_modsl_1.Default)("",ar_js_modsl_1.string),DataElementName:common_1.string_empty,DisplayFillCharacters:common_1.boolean_true,DisplayPageNumber:common_1.boolean_true,Style:(0,ar_js_modsl_1.typeDef)(__assign(__assign(__assign({},commonTypes_1.FontProps),commonTypes_1.PaddingProps),(0,commonTypes_1.style)("BackgroundColor","Color","TextDecoration","TextAlign","LeadingChar","TextIndent")))});exports.TableOfContents=(0,ar_js_modsl_1.pipe)((0,ar_js_modsl_1.type)(__assign(__assign({},(0,common_1.ReportItemProps)("tableofcontents")),{Style:(0,ar_js_modsl_1.typeDef)(__assign(__assign({},commonTypes_1.BorderProps),(0,commonTypes_1.style)("BackgroundColor","MaxLevel"))),Levels:(0,ar_js_modsl_1.arrayDef)(TableOfContentsLevel),PageBreak:(0,ar_js_modsl_1.Default)("None",commonTypes_1.Enums.BreakLocation),NewPage:(0,ar_js_modsl_1.Default)("Next",commonTypes_1.Enums.NewPage)})),(0,ar_js_modsl_1.required)("Name"));var symbologyMembers=(0,decoders_2.members)("None","Ansi39","Ansi39x","Aztec","BC412","Codabar","Code_11","Code_128_A","Code_128_B","Code_128_C","Code_128auto","Code_2_of_5","Code_93","Code25intlv","Code39","Code39x","Code49","Code93x","DataMatrix","EAN_13","EAN_8","EAN128FNC1","GS1DataMatrix","GS1QRCode","HIBCCode128","HIBCCode39","IATA_2_of_5","IntelligentMail","IntelligentMailPackage","ISBN","ISMN","ISSN","ITF14","JapanesePostal","Matrix_2_of_5","MaxiCode","MicroPDF417","MicroQRCode","MSI","Pdf417","Pharmacode","Plessey","PostNet","PZN","QRCode","RM4SCC","RSS14","RSS14Stacked","RSS14StackedOmnidirectional","RSS14Truncated","RSSExpanded","RSSExpandedStacked","RSSLimited","SSCC_18","Telepen","UCCEAN128","UPC_A","UPC_E0","UPC_E1"),ecc200SymbolSizeMembers=(0,decoders_2.members)("SquareAuto","RectangularAuto","Square10","Square12","Square14","Square16","Square18","Square20","Square22","Square24","Square26","Square32","Square36","Square40","Square44","Square48","Square52","Square64","Square72","Square80","Square88","Square96","Square104","Square120","Square132","Square144","Rectangular8x18","Rectangular8x32","Rectangular12x26","Rectangular12x36","Rectangular16x36","Rectangular16x48"),ecc000SymbolSizeMembers=(0,decoders_2.members)("Auto","Square9","Square11","Square13","Square15","Square17","Square19","Square21","Square23","Square25","Square27","Square29","Square31","Square33","Square35","Square37","Square39","Square41","Square43","Square45","Square47","Square49"),barcodeMicroPdf417VersionMembers=(0,decoders_2.members)("ColumnPriorAuto","RowPriorAuto","Version1X11","Version1X14","Version1X17","Version1X20","Version1X24","Version1X28","Version2X8","Version2X11","Version2X14","Version2X17","Version2X20","Version2X23","Version2X26","Version3X6","Version3X8","Version3X10","Version3X12","Version3X15","Version3X20","Version3X26","Version3X32","Version3X38","Version3X44","Version4X4","Version4X6","Version4X8","Version4X10","Version4X12","Version4X15","Version4X20","Version4X26","Version4X32","Version4X38","Version4X44");exports.Barcode=(0,ar_js_modsl_1.pipe)((0,ar_js_modsl_1.type)(__assign(__assign({},(0,common_1.ReportItemProps)("barcode")),{Value:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprVariant),InvalidBarcodeText:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprStr),Symbology:(0,decoders_2.Enum)("Ansi39",symbologyMembers),CheckSum:common_1.boolean_true,BarHeight:common_1.Length_0in,CaptionGrouping:common_1.boolean_true,CaptionLocation:(0,decoders_2.Enum)("None",(0,decoders_2.members)("None","Above","Below")),AztecOptions:(0,ar_js_modsl_1.typeDef)({ErrorCorrection:(0,ar_js_modsl_1.Default)(33,ar_js_modsl_1.number),Layers:(0,ar_js_modsl_1.Default)(0,ar_js_modsl_1.number),Encoding:(0,ar_js_modsl_1.Default)("65001",ar_js_modsl_1.string)}),Code49Options:(0,ar_js_modsl_1.typeDef)({Grouping:common_1.boolean_false,GroupNumber:(0,ar_js_modsl_1.Default)(0,ar_js_modsl_1.number)}),DataMatrixOptions:(0,ar_js_modsl_1.typeDef)({EccMode:(0,decoders_2.Enum)("ECC200",(0,decoders_2.members)("ECC000","ECC050","ECC080","ECC100","ECC140","ECC200")),Ecc200SymbolSize:(0,decoders_2.Enum)("SquareAuto",ecc200SymbolSizeMembers),Ecc200EncodingMode:(0,decoders_2.Enum)("Auto",(0,decoders_2.members)("Auto","ASCII","C40","Text","X12","EDIFACT","Base256")),Ecc000_140SymbolSize:(0,decoders_2.Enum)("Auto",ecc000SymbolSizeMembers),StructuredAppend:common_1.boolean_false,StructureNumber:(0,ar_js_modsl_1.Default)(0,ar_js_modsl_1.number),FileIdentifier:(0,ar_js_modsl_1.Default)(0,ar_js_modsl_1.number),Encoding:(0,ar_js_modsl_1.Default)("65001",ar_js_modsl_1.string)}),Ean128Fnc1Options:(0,ar_js_modsl_1.typeDef)({Resolution:(0,ar_js_modsl_1.Default)(96,ar_js_modsl_1.number),ModuleSize:(0,ar_js_modsl_1.Default)(0,ar_js_modsl_1.number),BarAdjust:(0,ar_js_modsl_1.Default)(0,ar_js_modsl_1.number)}),Gs1CompositeOptions:(0,ar_js_modsl_1.typeDef)({CompositeType:(0,decoders_2.Enum)("None",(0,decoders_2.members)("None","CCA")),Value:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprStr)}),MaxiCodeOptions:(0,ar_js_modsl_1.typeDef)({Mode:(0,decoders_2.Enum)("Mode4",(0,decoders_2.members)("Mode2","Mode3","Mode4","Mode5","Mode6"))}),MicroPdf417Options:(0,ar_js_modsl_1.typeDef)({CompactionMode:(0,decoders_2.Enum)("Auto",(0,decoders_2.members)("Auto","TextCompactionMode","NumericCompactionMode","ByteCompactionMode")),Version:(0,decoders_2.Enum)("ColumnPriorAuto",barcodeMicroPdf417VersionMembers),SegmentIndex:(0,ar_js_modsl_1.Default)(0,ar_js_modsl_1.number),SegmentCount:(0,ar_js_modsl_1.Default)(0,ar_js_modsl_1.number),FileID:(0,ar_js_modsl_1.Default)(0,ar_js_modsl_1.number)}),MicroQrCodeOptions:(0,ar_js_modsl_1.typeDef)({Version:(0,decoders_2.Enum)("Auto",(0,decoders_2.members)("Auto","M1","M2","M3","M4")),ErrorLevel:(0,decoders_2.Enum)("L",(0,decoders_2.members)("L","M","Q")),Mask:(0,decoders_2.Enum)("Auto",(0,decoders_2.members)("Auto","Mask00","Mask01","Mask10","Mask11")),Encoding:(0,ar_js_modsl_1.Default)("65001",ar_js_modsl_1.string)}),NarrowBarWidth:(0,ar_js_modsl_1.Default)("",commonTypes_1.Length),NWRation:(0,ar_js_modsl_1.Default)(0,ar_js_modsl_1.number),Pdf417Options:(0,ar_js_modsl_1.typeDef)({Columns:(0,ar_js_modsl_1.Default)(-1,ar_js_modsl_1.number),Rows:(0,ar_js_modsl_1.Default)(-1,ar_js_modsl_1.number),ErrorCorrectionLevel:(0,decoders_2.Enum)("Level0",(0,decoders_2.members)("Level0","Level1","Level2","Level3","Level4","Level5","Level6","Level7","Level8")),Pdf417Type:(0,decoders_2.Enum)("Normal",(0,decoders_2.members)("Normal","Simple"))}),QrCodeOptions:(0,ar_js_modsl_1.typeDef)({Connection:common_1.boolean_false,ConnectionNumber:(0,ar_js_modsl_1.Default)(0,ar_js_modsl_1.number),Version:(0,ar_js_modsl_1.Default)(-1,ar_js_modsl_1.number),ErrorLevel:(0,decoders_2.Enum)("L",(0,decoders_2.members)("M","L","H","Q")),Mask:(0,decoders_2.Enum)("Auto",(0,decoders_2.members)("Auto","Mask000","Mask001","Mask010","Mask011","Mask100","Mask101","Mask110","Mask111")),Model:(0,decoders_2.Enum)("Model2",(0,decoders_2.members)("Model1","Model2")),Encoding:(0,ar_js_modsl_1.Default)("65001",ar_js_modsl_1.string)}),QuietZone:(0,ar_js_modsl_1.typeDef)({Left:common_1.Length_0in,Right:common_1.Length_0in,Top:common_1.Length_0in,Bottom:common_1.Length_0in}),Rotation:(0,ar_js_modsl_1.Default)("None",ar_js_modsl_1.string),RssExpandedStacked:(0,ar_js_modsl_1.typeDef)({RowCount:(0,ar_js_modsl_1.Default)(2,ar_js_modsl_1.number)}),SupplementOptions:(0,ar_js_modsl_1.typeDef)({Value:common_1.string_empty,BarHeight:common_1.Length_0in,CaptionLocation:(0,ar_js_modsl_1.Default)("Above",ar_js_modsl_1.string),Spacing:common_1.Length_0in}),Style:(0,ar_js_modsl_1.typeDef)(__assign(__assign(__assign(__assign({},commonTypes_1.BorderProps),commonTypes_1.FontProps),commonTypes_1.PaddingProps),(0,commonTypes_1.style)("BackgroundColor","Color","Format","TextAlign","TextDecoration"))),DataElementStyle:(0,ar_js_modsl_1.Default)("Auto",commonTypes_1.Enums.DataElementStyle)})),(0,ar_js_modsl_1.required)("Name")),exports.Image=(0,ar_js_modsl_1.pipe)((0,ar_js_modsl_1.type)(__assign(__assign({},(0,ar_js_modsl_1.omit)((0,common_1.ReportItemProps)("image"),"DataElementName","DataElementOutput")),{Action:commonTypes_1.Action,Source:(0,decoders_2.Enum)("External",commonTypes_1.Enums.ImageSource),Value:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprStr),MIMEType:(0,decoders_2.TreatNullAsUndefined)((0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprStr)),Sizing:(0,decoders_2.Enum)("AutoSize",(0,decoders_2.members)("AutoSize","Fit","FitProportional","Clip")),HorizontalAlignment:(0,decoders_2.EnumExpr)("Left",commonTypes_1.Enums.HorizontalImageAlign),VerticalAlignment:(0,decoders_2.EnumExpr)("Top",commonTypes_1.Enums.VerticalImageAlign),Style:(0,ar_js_modsl_1.typeDef)(__assign(__assign({},commonTypes_1.BorderProps),commonTypes_1.PaddingProps))})),(0,ar_js_modsl_1.required)("Name")),exports.Bullet=(0,ar_js_modsl_1.pipe)((0,ar_js_modsl_1.type)(__assign(__assign({},(0,common_1.ReportItemProps)("bullet")),{LabelFormat:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprStr),LabelFontFamily:(0,ar_js_modsl_1.DefaultOf)("Arial",expr_1.ExprStr),LabelFontSize:(0,ar_js_modsl_1.DefaultOf)("10pt",expr_1.ExprLength),LabelFontStyle:(0,decoders_2.EnumExpr)("Regular",commonTypes_1.Enums.BulletLabelFontStyles),LabelFontColor:(0,ar_js_modsl_1.DefaultOf)("Black",expr_1.ExprColor),Orientation:(0,decoders_2.Enum)("Horizontal",(0,decoders_2.members)("Horizontal","Vertical")),ShowLabels:common_1.boolean_true,TargetShape:(0,decoders_2.Enum)("Line",(0,decoders_2.members)("Line","Square","Dot")),TargetLineColor:(0,ar_js_modsl_1.DefaultOf)("Black",expr_1.ExprColor),TargetLineWidth:(0,ar_js_modsl_1.DefaultOf)("3pt",expr_1.ExprLength),TickMarks:(0,decoders_2.Enum)("Outside",(0,decoders_2.members)("None","Inside","Outside")),TicksLineColor:(0,ar_js_modsl_1.DefaultOf)("LightGray",expr_1.ExprColor),TicksLineWidth:(0,ar_js_modsl_1.DefaultOf)("1pt",expr_1.ExprLength),ValueColor:(0,ar_js_modsl_1.DefaultOf)("Black",expr_1.ExprColor),BestValue:(0,ar_js_modsl_1.Default)("",expr_1.ExprNum),Interval:(0,ar_js_modsl_1.Default)("",expr_1.ExprNum),Range1Boundary:(0,ar_js_modsl_1.Default)("",expr_1.ExprNum),Range2Boundary:(0,ar_js_modsl_1.Default)("",expr_1.ExprNum),TargetValue:(0,ar_js_modsl_1.Default)("",expr_1.ExprNum),Value:(0,ar_js_modsl_1.Default)("",expr_1.ExprNum),WorstValue:(0,ar_js_modsl_1.Default)("",expr_1.ExprNum)})),(0,ar_js_modsl_1.required)("Name")),exports.FormattedText=(0,ar_js_modsl_1.pipe)((0,ar_js_modsl_1.type)(__assign(__assign({},(0,common_1.ReportItemProps)("formattedtext")),{EncodeMailMergeFields:common_1.boolean_true,Html:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprStr),MailMergeFields:(0,ar_js_modsl_1.arrayDef)((0,ar_js_modsl_1.type)({Name:ar_js_modsl_1.string,Value:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprStr)})),Style:(0,ar_js_modsl_1.typeDef)(__assign(__assign({},commonTypes_1.BorderProps),(0,commonTypes_1.style)("BackgroundColor","BackgroundImage")))})),(0,ar_js_modsl_1.required)("Name"));var InputFieldBase=(0,ar_js_modsl_1.pipe)((0,ar_js_modsl_1.type)(__assign(__assign({},(0,common_1.ReportItemProps)("inputfield")),{FieldName:common_1.string_empty,Readonly:common_1.boolean_false,Required:common_1.boolean_false})),(0,ar_js_modsl_1.required)("Name"));exports.InputField=(0,ar_js_modsl_1.iif)((function(input){return!input.InputType||"Text"===input.InputType}),(function(rout){return"Text"===rout.InputType}),(0,ar_js_modsl_1.pipe)(InputFieldBase,(0,ar_js_modsl_1.intersectWith)((0,ar_js_modsl_1.type)({InputType:(0,ar_js_modsl_1.Const)("Text"),Password:common_1.boolean_false,Multiline:common_1.boolean_false,SpellCheck:common_1.boolean_false,MaxLength:(0,ar_js_modsl_1.Default)(null,(0,ar_js_modsl_1.nullable)(ar_js_modsl_1.number)),Value:(0,ar_js_modsl_1.Default)("",expr_1.ExprStr),Style:(0,ar_js_modsl_1.typeDef)(__assign(__assign(__assign({},commonTypes_1.BorderProps),commonTypes_1.FontProps),(0,commonTypes_1.style)("BackgroundColor","Color","TextAlign","Format")))}))),(0,ar_js_modsl_1.pipe)(InputFieldBase,(0,ar_js_modsl_1.intersectWith)((0,ar_js_modsl_1.type)({InputType:(0,ar_js_modsl_1.literalInit)("CheckBox"),Checked:(0,ar_js_modsl_1.Default)("False",expr_1.ExprBool),CheckStyle:(0,decoders_2.Enum)("Check",(0,decoders_2.members)("Check","Circle","Cross","Diamond","Square","Star")),CheckSize:(0,ar_js_modsl_1.DefaultOf)("10pt",expr_1.ExprLength),Style:(0,ar_js_modsl_1.typeDef)(__assign(__assign({},commonTypes_1.BorderProps),(0,commonTypes_1.style)("BackgroundColor","Color","TextAlign")))}))));var UnknownItemDecoder={encode:function(_a){return _a.Item},decode:function(v){return(0,ar_js_modsl_1.success)({Item:v})}};exports.UnknownReportItem=(0,ar_js_modsl_1.pipe)(UnknownItemDecoder,(0,ar_js_modsl_1.intersectWith)((0,ar_js_modsl_1.type)(__assign({Type:(0,ar_js_modsl_1.Const)("unknown")},common_1.ReportItemProperties))),(0,ar_js_modsl_1.required)("Name"))}(reportItems);var report={};!function(exports){var __assign=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0}),exports.FixedPage=exports.ReportCommonProps=exports.ReportSectionProps=exports.Layer=exports.PageSection=exports.BodySection=exports.Page=void 0;var ar_js_modsl_1=cjs,expr_1=expr,decoders_1=decoders$1,commonTypes_1=commonTypes,data_1=data$1,index_1=reportItems,_a=[(0,ar_js_modsl_1.Default)(!1,ar_js_modsl_1.boolean),(0,ar_js_modsl_1.Default)(!0,ar_js_modsl_1.boolean),(0,ar_js_modsl_1.Default)("",ar_js_modsl_1.string)],falseBoolean=_a[0],trueBoolean=_a[1],emptyString=_a[2],DataElementStyle=(0,decoders_1.Enum)("AttributeNormal",(0,decoders_1.members)("Auto","AttributeNormal","ElementNormal")),DocumentMapSource=(0,decoders_1.Enum)("Labels",(0,decoders_1.members)("None","Labels","Headings","All")),NumberingStyleMembers=(0,decoders_1.members)("None","Decimal","DecimalLeadingZero","LowerRoman","UpperRoman","LowerLatin","UpperLatin","CircledNumber","KatakanaBrackets","KatakanaIrohaBrackets","Katakana","KatakanaIroha","KatakanaLower","KatakanaIrohaLower","LowerGreek","UpperGreek","LowerArmenian","UpperArmenian","Georgian");exports.Page=(0,ar_js_modsl_1.type)({PageWidth:(0,ar_js_modsl_1.initValue)("8.5in",commonTypes_1.Length),PageHeight:(0,ar_js_modsl_1.initValue)("11in",commonTypes_1.Length),RightMargin:(0,ar_js_modsl_1.initValue)("0in",commonTypes_1.Length),LeftMargin:(0,ar_js_modsl_1.initValue)("0in",commonTypes_1.Length),TopMargin:(0,ar_js_modsl_1.initValue)("0in",commonTypes_1.Length),BottomMargin:(0,ar_js_modsl_1.initValue)("0in",commonTypes_1.Length),Columns:(0,ar_js_modsl_1.initValue)(1,ar_js_modsl_1.number),ColumnSpacing:(0,ar_js_modsl_1.initValue)("0.5in",commonTypes_1.Length)});var SectionStyle=(0,ar_js_modsl_1.DefaultOf)({},(0,ar_js_modsl_1.type)(__assign(__assign({},commonTypes_1.BorderProps),(0,commonTypes_1.style)("BackgroundColor","BackgroundImage"))));exports.BodySection=function(reportItem){return(0,ar_js_modsl_1.type)({Type:(0,ar_js_modsl_1.Const)("section"),Height:(0,ar_js_modsl_1.initValue)("0in",commonTypes_1.Length),ReportItems:(0,ar_js_modsl_1.arrayDef)(reportItem),Style:SectionStyle})};exports.PageSection=function(reportItem){return(0,ar_js_modsl_1.type)({Type:(0,ar_js_modsl_1.Const)("pagesection"),Height:(0,ar_js_modsl_1.DefaultOf)("0.25in",commonTypes_1.Length),ReportItems:(0,ar_js_modsl_1.arrayDef)(reportItem),Style:SectionStyle,PrintOnFirstPage:trueBoolean,PrintOnLastPage:trueBoolean})},exports.Layer=(0,ar_js_modsl_1.pipe)((0,ar_js_modsl_1.type)({Type:(0,ar_js_modsl_1.Const)("layer"),Name:ar_js_modsl_1.string,DesignerLock:falseBoolean,DesignerTransparency:(0,ar_js_modsl_1.Default)(0,ar_js_modsl_1.number),DesignerVisible:trueBoolean,DesignerDataFieldVisible:trueBoolean,TargetDevice:(0,ar_js_modsl_1.Default)("All",ar_js_modsl_1.string)}),(0,ar_js_modsl_1.required)("Name"),(0,ar_js_modsl_1.withDefaultOf)({Name:""}),decoders_1.StoreUndefinedAsNull),exports.ReportSectionProps={Name:ar_js_modsl_1.string,DisplayName:(0,ar_js_modsl_1.DefaultOf)("",ar_js_modsl_1.string),Page:(0,ar_js_modsl_1.DefaultOf)({},exports.Page),Width:(0,ar_js_modsl_1.initValue)("6.5in",commonTypes_1.Length),DataElementName:emptyString,DataElementOutput:(0,ar_js_modsl_1.Default)("Auto",commonTypes_1.Enums.DataElementOutput)},exports.ReportCommonProps={Name:emptyString,Description:emptyString,Author:emptyString,Page:(0,ar_js_modsl_1.DefaultOf)({},exports.Page),Width:(0,ar_js_modsl_1.initValue)("6.5in",commonTypes_1.Length),Language:(0,ar_js_modsl_1.DefaultOf)("",expr_1.ExprStr),ConsumeContainerWhitespace:falseBoolean,DataElementName:(0,ar_js_modsl_1.Default)("Report",ar_js_modsl_1.string),DataElementStyle:DataElementStyle,DocumentMap:(0,ar_js_modsl_1.typeDef)({Source:DocumentMapSource,NumberingStyle:(0,decoders_1.Enum)("None",NumberingStyleMembers),Levels:(0,ar_js_modsl_1.arrayDef)((0,ar_js_modsl_1.pipe)((0,decoders_1.Enum)("Decimal",NumberingStyleMembers),decoders_1.StoreUndefinedAsNull))}),ReportParameters:(0,ar_js_modsl_1.arrayDef)(data_1.ReportParameter),DataSources:(0,ar_js_modsl_1.arrayDef)(data_1.DataSource),DataSets:(0,ar_js_modsl_1.arrayDef)(data_1.DataSet),EmbeddedImages:(0,ar_js_modsl_1.arrayDef)((0,ar_js_modsl_1.type)({Name:ar_js_modsl_1.string,ImageData:ar_js_modsl_1.string,MIMEType:ar_js_modsl_1.string})),LayoutOrder:(0,decoders_1.Enum)("ZOrder",(0,decoders_1.members)("NOrder","ZOrder")),StartPageNumber:(0,ar_js_modsl_1.Default)(1,ar_js_modsl_1.number),Layers:(0,ar_js_modsl_1.initValue)([(0,ar_js_modsl_1.makeDefaultOf)(exports.Layer,{Name:"default"})],(0,ar_js_modsl_1.array)(exports.Layer)),ThemeUri:emptyString,Code:emptyString,Classes:(0,ar_js_modsl_1.arrayDef)((0,ar_js_modsl_1.type)({ClassName:emptyString,InstanceName:emptyString})),CodeModules:(0,ar_js_modsl_1.arrayDef)(ar_js_modsl_1.string),CustomProperties:(0,ar_js_modsl_1.arrayDef)(commonTypes_1.CustomProperty),LocalizationResources:(0,ar_js_modsl_1.arrayDef)((0,ar_js_modsl_1.type)({Language:ar_js_modsl_1.string,Data:(0,ar_js_modsl_1.arrayDef)((0,ar_js_modsl_1.type)({Name:ar_js_modsl_1.string,Value:ar_js_modsl_1.string}))}))};exports.FixedPage=function(reportItem){var pageItem=(0,ar_js_modsl_1.type)({Type:(0,ar_js_modsl_1.Const)("fixedpagesection"),ReportItems:(0,ar_js_modsl_1.arrayDef)(reportItem),Style:SectionStyle,ThrowIfPlaceHoldersEmpty:falseBoolean,Visibility:commonTypes_1.Visibility,Width:(0,ar_js_modsl_1.optional)(commonTypes_1.Length),Height:(0,ar_js_modsl_1.optional)(commonTypes_1.Length),LeftMargin:(0,ar_js_modsl_1.optional)(commonTypes_1.Length),RightMargin:(0,ar_js_modsl_1.optional)(commonTypes_1.Length),TopMargin:(0,ar_js_modsl_1.optional)(commonTypes_1.Length),BottomMargin:(0,ar_js_modsl_1.optional)(commonTypes_1.Length)});return(0,ar_js_modsl_1.type)({Type:(0,ar_js_modsl_1.Const)("fixedpage"),Pages:(0,ar_js_modsl_1.Default)([(0,ar_js_modsl_1.makeDefaultOf)(pageItem)],(0,ar_js_modsl_1.array)(pageItem)),Group:index_1.GroupDef,DataSetName:emptyString,Filters:commonTypes_1.Filters,SortExpressions:index_1.SortExpressions,DataElementName:emptyString,DataElementOutput:(0,ar_js_modsl_1.Default)("Auto",commonTypes_1.Enums.DataElementOutput)})}}(report),function(exports){var __createBinding=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k);var desc=Object.getOwnPropertyDescriptor(m,k);desc&&!("get"in desc?!m.__esModule:desc.writable||desc.configurable)||(desc={enumerable:!0,get:function(){return m[k]}}),Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__exportStar=commonjsGlobal&&commonjsGlobal.__exportStar||function(m,exports){for(var p in m)"default"===p||Object.prototype.hasOwnProperty.call(exports,p)||__createBinding(exports,m,p)};Object.defineProperty(exports,"__esModule",{value:!0}),exports.Decoders=void 0,__exportStar(commonTypes,exports),__exportStar(data$1,exports),__exportStar(reportItems,exports),__exportStar(report,exports),__exportStar(expr,exports),exports.Decoders=decoders$1}(rdlx);var model={},decoders={},length$2={};Object.defineProperty(length$2,"__esModule",{value:!0}),length$2.compare=length$2.getCss=length$2.abs=length$2.subtract=length$2.convert=length$2.parse=void 0;var LENGTH_REGEX=/^([-+]?[0-9]*\.?[0-9]+)\s*(cm|mm|in|pt|pc)$/i,twipsPer$2={in:1440,pt:20,pc:240,cm:566.9291338582677,mm:56.69291338582677},digitsAfterDot={in:4,pt:2,pc:3,cm:3,mm:2};function convert(val,unit){if(val.unit===unit)return val;if(!twipsPer$2[unit])throw new Error("Specified targetUnits (".concat(unit,") is invalid."));return{value:twipsPer$2[val.unit]/twipsPer$2[unit]*val.value,unit:unit}}length$2.parse=function(sourceString){if(!sourceString)throw new Error("Unable to parse Length, non-empty value expected");var value,matchResult=LENGTH_REGEX.exec(sourceString);if(!matchResult||isNaN(value=parseFloat(matchResult[1])))throw new Error('Unable to parse Length: "'.concat(sourceString,'", valid string format: <number><').concat(Object.keys(twipsPer$2).join("|"),">"));return{value:value,unit:matchResult[2]}},length$2.convert=convert,length$2.subtract=function(val1,val2){var val2c=convert(val2,val1.unit).value;return{value:val1.value-val2c,unit:val1.unit}},length$2.abs=function(val){return{value:Math.abs(val.value),unit:val.unit}},length$2.getCss=function(len){var val,fractionDigits,multiplier,digits=digitsAfterDot[len.unit],roundValue=(val=len.value,fractionDigits=digits,multiplier=Math.pow(10,fractionDigits),Math.round(val*multiplier)/multiplier);return"".concat(roundValue).concat(len.unit)},length$2.compare=function(len1,len2){var l1=len1.value*twipsPer$2[len1.unit],l2=len2.value*twipsPer$2[len2.unit];return l1<l2?-1:l1>l2?1:0},function(exports){var __assign=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0}),exports.Report=exports.ReportItem=exports.getLineBoundaries=void 0;var ar_js_modsl_1=cjs,index_1=rdlx,Basic=rdlx,decoders_1=decoders$1,LenModule=length$2,Place=(0,ar_js_modsl_1.type)({Left:(0,ar_js_modsl_1.DefaultOf)("0in",index_1.Length),Top:(0,ar_js_modsl_1.DefaultOf)("0in",index_1.Length),Width:(0,ar_js_modsl_1.initValue)("0in",index_1.Length),Height:(0,ar_js_modsl_1.initValue)("0in",index_1.Length)}),OverflowName=(0,ar_js_modsl_1.Default)("",ar_js_modsl_1.string),FixedPlace=(0,ar_js_modsl_1.type)({FixedWidth:(0,ar_js_modsl_1.Default)(null,(0,ar_js_modsl_1.nullable)(ar_js_modsl_1.string)),FixedHeight:(0,ar_js_modsl_1.Default)(null,(0,ar_js_modsl_1.nullable)(ar_js_modsl_1.string)),OverflowName:OverflowName}),FixedJustOverflow=(0,ar_js_modsl_1.type)({OverflowName:OverflowName}),TocFixedPlace=(0,ar_js_modsl_1.type)({FixedHeight:(0,ar_js_modsl_1.DefaultOf)("0in",ar_js_modsl_1.string),OverflowName:(0,ar_js_modsl_1.Default)("",ar_js_modsl_1.string)});(0,ar_js_modsl_1.type)(Basic.ReportItemProperties);var _a=(0,ar_js_modsl_1.lazy)(),ReportItemLazy=_a[0],setReportItemLazy=_a[1],OverflowPlaceHolder=(0,ar_js_modsl_1.pipe)((0,ar_js_modsl_1.type)({Type:(0,ar_js_modsl_1.literalInit)("overflowplaceholder"),Name:ar_js_modsl_1.string,LayerName:(0,ar_js_modsl_1.Default)("default",ar_js_modsl_1.string)}),(0,ar_js_modsl_1.intersectWith)(Place),(0,ar_js_modsl_1.intersectWith)(FixedJustOverflow),(0,ar_js_modsl_1.required)("Name"));function getLineBoundaries(_a){var StartPoint=_a.StartPoint,EndPoint=_a.EndPoint,p1={x:LenModule.parse(StartPoint.X),y:LenModule.parse(StartPoint.Y)},p2={x:LenModule.parse(EndPoint.X),y:LenModule.parse(EndPoint.Y)},min=function(p1,p2){return LenModule.compare(p1,p2)<=0?p1:p2};return{Top:LenModule.getCss(min(p1.y,p2.y)),Left:LenModule.getCss(min(p1.x,p2.x)),Height:(0,ar_js_modsl_1.pipe)(LenModule.subtract(p1.y,p2.y),LenModule.abs,LenModule.getCss),Width:(0,ar_js_modsl_1.pipe)(LenModule.subtract(p1.x,p2.x),LenModule.abs,LenModule.getCss)}}exports.getLineBoundaries=getLineBoundaries,exports.ReportItem=(0,ar_js_modsl_1.alt)((function(i){return i.Type}),(function(o){return o.Type}),{textbox:(0,ar_js_modsl_1.pipe)(Basic.TextBox,(0,ar_js_modsl_1.intersectWith)(Place)),checkbox:(0,ar_js_modsl_1.pipe)(Basic.CheckBox,(0,ar_js_modsl_1.intersectWith)(Place)),list:(0,ar_js_modsl_1.pipe)(Basic.List(ReportItemLazy),(0,ar_js_modsl_1.intersectWith)(Place),(0,ar_js_modsl_1.intersectWith)(FixedPlace)),table:(0,ar_js_modsl_1.pipe)(Basic.Table(ReportItemLazy),(0,ar_js_modsl_1.intersectWith)(Place),(0,ar_js_modsl_1.intersectWith)(FixedPlace)),tablix:(0,ar_js_modsl_1.pipe)(Basic.Tablix(ReportItemLazy),(0,ar_js_modsl_1.intersectWith)(Place),(0,ar_js_modsl_1.intersectWith)(FixedPlace)),line:(0,ar_js_modsl_1.pipe)(Basic.Line,(0,ar_js_modsl_1.map)((function(line){return __assign(__assign({},line),getLineBoundaries(line))}),(function(line){return line}))),rectangle:(0,ar_js_modsl_1.pipe)(Basic.Rectangle(ReportItemLazy),(0,ar_js_modsl_1.intersectWith)(Place)),bandedlist:(0,ar_js_modsl_1.pipe)(Basic.BandedList(ReportItemLazy),(0,ar_js_modsl_1.intersectWith)(Place),(0,ar_js_modsl_1.intersectWith)(FixedPlace)),subreport:(0,ar_js_modsl_1.pipe)(Basic.Subreport,(0,ar_js_modsl_1.intersectWith)(Place),(0,ar_js_modsl_1.intersectWith)(FixedJustOverflow)),shape:(0,ar_js_modsl_1.pipe)(Basic.Shape,(0,ar_js_modsl_1.intersectWith)(Place)),tableofcontents:(0,ar_js_modsl_1.pipe)(Basic.TableOfContents,(0,ar_js_modsl_1.intersectWith)(Place),(0,ar_js_modsl_1.intersectWith)(TocFixedPlace)),barcode:(0,ar_js_modsl_1.pipe)(Basic.Barcode,(0,ar_js_modsl_1.intersectWith)(Place)),dvchart:(0,ar_js_modsl_1.pipe)(Basic.DvChart,(0,ar_js_modsl_1.intersectWith)(Place)),image:(0,ar_js_modsl_1.pipe)(Basic.Image,(0,ar_js_modsl_1.intersectWith)(Place)),bullet:(0,ar_js_modsl_1.pipe)(Basic.Bullet,(0,ar_js_modsl_1.intersectWith)(Place)),formattedtext:(0,ar_js_modsl_1.pipe)(Basic.FormattedText,(0,ar_js_modsl_1.intersectWith)(Place)),inputfield:(0,ar_js_modsl_1.pipe)(Basic.InputField,(0,ar_js_modsl_1.intersectWith)(Place)),sparkline:(0,ar_js_modsl_1.pipe)(Basic.Sparkline,(0,ar_js_modsl_1.intersectWith)(Place)),richtext:(0,ar_js_modsl_1.pipe)(Basic.RichText,(0,ar_js_modsl_1.intersectWith)(Place)),overflowplaceholder:OverflowPlaceHolder});var reportItemUnknown=(0,ar_js_modsl_1.pipe)(Basic.UnknownReportItem,(0,ar_js_modsl_1.intersectWith)(Place)),ReportItemOrUnknown=(0,ar_js_modsl_1.pipe)(exports.ReportItem,(0,decoders_1.orElse)(reportItemUnknown,(function(item){return"unknown"===item.Type})));setReportItemLazy(ReportItemOrUnknown);var PageSection=(0,ar_js_modsl_1.optional)(Basic.PageSection(ReportItemOrUnknown)),ContinuousSection=(0,ar_js_modsl_1.pipe)((0,ar_js_modsl_1.type)(__assign(__assign({Type:(0,ar_js_modsl_1.literalInit)("Continuous")},Basic.ReportSectionProps),{PageHeader:(0,ar_js_modsl_1.optional)(Basic.PageSection(ReportItemOrUnknown)),Body:(0,ar_js_modsl_1.optional)(Basic.BodySection(ReportItemOrUnknown)),PageFooter:(0,ar_js_modsl_1.optional)(Basic.PageSection(ReportItemOrUnknown))})),(0,ar_js_modsl_1.required)("Type","Name")),FixedPageSection=(0,ar_js_modsl_1.pipe)((0,ar_js_modsl_1.type)(__assign(__assign({Type:(0,ar_js_modsl_1.literalInit)("FixedPage")},Basic.ReportSectionProps),{FixedPage:(0,ar_js_modsl_1.optional)(Basic.FixedPage(ReportItemOrUnknown))})),(0,ar_js_modsl_1.required)("Type","Name")),ReportSection=(0,ar_js_modsl_1.alt)((function(i){return i.Type}),(function(o){return o.Type}),{Continuous:ContinuousSection,FixedPage:FixedPageSection});exports.Report=(0,ar_js_modsl_1.pipe)((0,ar_js_modsl_1.type)(__assign(__assign({},Basic.ReportCommonProps),{PageHeader:PageSection,Body:(0,ar_js_modsl_1.optional)(Basic.BodySection(ReportItemOrUnknown)),PageFooter:PageSection,FixedPage:(0,ar_js_modsl_1.optional)(Basic.FixedPage(ReportItemOrUnknown)),CollateBy:(0,decoders_1.Enum)("Simple",(0,decoders_1.members)("Simple","ValueIndex","Value")),Themes:(0,ar_js_modsl_1.arrayDef)(ar_js_modsl_1.string),ReportSections:(0,ar_js_modsl_1.optional)((0,ar_js_modsl_1.array)(ReportSection))})),ar_js_modsl_1.recordFailures)}(decoders);var reified={};Object.defineProperty(reified,"__esModule",{value:!0});var romtypes={};Object.defineProperty(romtypes,"__esModule",{value:!0}),Object.defineProperty(model,"__esModule",{value:!0}),model.Rom=model.Rdl=model.D=void 0,model.D=decoders,model.Rdl=reified,model.Rom=romtypes,function(exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.Model=exports.Rom=exports.Rdl=exports.Lenses=exports.Dsl=exports.BasicModel=void 0;var Dsl=cjs;exports.Dsl=Dsl,exports.BasicModel=rdlx,exports.Lenses=Dsl.Lenses;var index_1=model;Object.defineProperty(exports,"Rdl",{enumerable:!0,get:function(){return index_1.Rdl}}),Object.defineProperty(exports,"Rom",{enumerable:!0,get:function(){return index_1.Rom}}),Object.defineProperty(exports,"Model",{enumerable:!0,get:function(){return index_1.D}})}(cjs$1);function createReport(){const d=cjs$1.Model.Report.decode({});if("error"===d.type)throw new Error(`Fatal Error: can't create empty report: ${d.reason}`);return d.value}function createCplReport(){const d=cjs$1.Model.Report.decode({Body:{}});if("error"===d.type)throw new Error(`Fatal Error: can't create empty CPL report: ${d.reason}`);return d.value}function createFplReport(){const d=cjs$1.Model.Report.decode({FixedPage:{Pages:[{}]}});if("error"===d.type)throw new Error(`Fatal Error: can't create empty FPL report: ${d.reason}`);return d.value}function createTextBox(name){const d=cjs$1.Model.ReportItem.decode({Type:"textbox",Name:name});if("error"===d.type)throw new Error(`Fatal Error: can't create empty textbox: ${d.reason}`);return d.value}function createRectangle(name){const d=cjs$1.Model.ReportItem.decode({Type:"rectangle",Name:name});if("error"===d.type)throw new Error(`Fatal Error: can't create empty rectangle: ${d.reason}`);return d.value}function createGroup(name){const d=cjs$1.BasicModel.Group.decode({Name:name});if("error"===d.type)throw new Error(`Fatal Error: can't create empty list: ${d.reason}`);return d.value}function createTableOfContentsLevel(){const d=cjs$1.Model.ReportItem.decode({Type:"tableofcontents",Name:"",Levels:[{}]});if("error"===d.type)throw new Error(`Fatal Error: can't create empty table: ${d.reason}`);return d.value.Levels[0]}function createVisibility(){const d=cjs$1.BasicModel.Visibility.decode({});if("error"===d.type)throw new Error(`Fatal Error: can't create empty textbox: ${d.reason}`);return d.value}function createBorderStyle(){const d=cjs$1.BasicModel.BorderStyle.decode({});if("error"===d.type)throw new Error(`Fatal Error: can't create empty textbox: ${d.reason}`);return d.value}function createAction(){const d=cjs$1.BasicModel.Action.decode({});if("error"===d.type)throw new Error(`Fatal Error: can't create empty textbox: ${d.reason}`);return d.value}function createParagraph(){const d=cjs$1.Model.ReportItem.decode({Type:"richtext",Name:"",Paragraphs:[{}]});if("error"===d.type)throw new Error(`Fatal Error: can't create richtext item: ${d.reason}`);return d.value.Paragraphs[0]}function createTextRun(){const d=cjs$1.Model.ReportItem.decode({Type:"richtext",Name:"",Paragraphs:[{TextRuns:[{Type:"text",Style:{}}]}]});if("error"===d.type)throw new Error(`Fatal Error: can't create richtext item: ${d.reason}`);return d.value.Paragraphs[0].TextRuns[0]}function decodeReport(reportDef){const decodeResult=cjs$1.Model.Report.decode(function(item){if(!item.Pages)return item;const{Pages:Pages,DataSetName:DataSetName,Group:Group,Filters:Filters,SortExpressions:SortExpressions}=item,report=__rest$1(item,["Pages","DataSetName","Group","Filters","SortExpressions"]);return report.FixedPage={Type:"fixedpage",Name:"FixedPage1",Pages:Pages,DataSetName:DataSetName,Group:Group,Filters:Filters,SortExpressions:SortExpressions},report}(reportDef));if("error"===decodeResult.type)throw new Error(`Failed to decode report: ${decodeResult.reason}`);return decodeResult.warnings,decodeResult.value}function createReportItem(type,name){const d=cjs$1.Model.ReportItem.decode(Object.assign(Object.assign({},type),{Name:name}));if("error"===d.type)throw new Error(`Fatal Error: can't create empty report item: ${d.reason}`);return d.warnings,d.value}const emptyToggles={Controllers:[],Receivers:[],SortExpressions:{}},emptyItems={Scope:[],Regions:[],UserSorts:[]};function joinItems(arr){return arr.reduce(((prev,curr)=>({Scope:prev.Scope.concat(curr.Scope),Regions:prev.Regions.concat(curr.Regions),UserSorts:uniqWith(prev.UserSorts.concat(curr.UserSorts),equals)})),emptyItems)}function joinToggles(arr){return arr.reduce(((prev,curr)=>({Controllers:prev.Controllers.concat(curr.Controllers),Receivers:uniq(prev.Receivers.concat(curr.Receivers)),SortExpressions:Object.assign(Object.assign({},prev.SortExpressions),curr.SortExpressions)})),emptyToggles)}function getContainerDescriptor(rect){var _a;const items=joinItems(rect.ReportItems.map(convertDataRegion)),toggleItem=rect.Visibility.ToggleItem&&!isItemSelfToggled(rect.Visibility.ToggleItem,items.Scope)?rect.Visibility.ToggleItem:"",rectItem={Name:null!==(_a=rect.Name)&&void 0!==_a?_a:"",Type:"simpleitem",Visibility:{Hidden:rect.Visibility.Hidden,ToggleItem:toggleItem}};return items.Scope.push(rectItem),items}function getBandedListDescriptor(list){const children=getBandedListGroupItem(list.Groups,list.Details),item={Name:list.Name,Type:"dataregion",ReportItems:joinItems([list.Header&&getContainerDescriptor(list.Header),list.Footer&&getContainerDescriptor(list.Footer),children].filter(isNotNull)),Visibility:list.Visibility,IsDetails:!1};return Object.assign(Object.assign({},emptyItems),{Regions:[item]})}function getBandedListGroupItem(groups,details){if(!groups.length)return details?function(details){var _a;const item={Name:null!==(_a=details.Name)&&void 0!==_a?_a:"",Type:"dataregion",ReportItems:joinItems(details.ReportItems.map(convertDataRegion)),Visibility:details.Visibility,IsDetails:!0};return Object.assign(Object.assign({},emptyItems),{Regions:[item]})}(details):emptyItems;const[group,...restGroups]=groups,children=getBandedListGroupItem(restGroups,details),item={Name:group.Group.Name||"",Type:"dataregion",ReportItems:joinItems([group.Header&&getContainerDescriptor(group.Header),group.Footer&&getContainerDescriptor(group.Footer),children].filter(isNotNull)),Visibility:group.Visibility,IsDetails:!1};return Object.assign(Object.assign({},emptyItems),{Regions:[item]})}function getTableColumns(cols){const columns=cols.map((tc=>({Type:"simpleitem",Name:"",Visibility:tc.Visibility})));return Object.assign(Object.assign({},emptyItems),{Scope:columns})}function getTableRows(hf){return joinItems((hf&&hf.TableRows||[]).map(getTableRow))}function getTableRow(row){const scopeItems=joinItems(row.TableCells.map((cell=>null==cell?void 0:cell.Item)).filter(isNotNull).filter(isDefined).map(convertDataRegion)),toggleItem=row.Visibility.ToggleItem&&!isItemSelfToggled(row.Visibility.ToggleItem,scopeItems.Scope)?row.Visibility.ToggleItem:"",tRow={Type:"simpleitem",Name:"",Visibility:{Hidden:row.Visibility.Hidden,ToggleItem:toggleItem}};return scopeItems.Scope.push(tRow),scopeItems}function getTableGroupItem(groups,details){if(!groups.length)return details?function(details){const item={Name:details.Group.Name,Type:"dataregion",ReportItems:getTableRows(details),Visibility:details.Visibility,IsDetails:!0};return Object.assign(Object.assign({},emptyItems),{Regions:[item]})}(details):emptyItems;const[group,...restGroups]=groups,children=getTableGroupItem(restGroups,details),item={Name:group.Group.Name||"",Type:"dataregion",ReportItems:joinItems([getTableRows(group.Header),getTableRows(group.Footer),children]),Visibility:group.Visibility,IsDetails:!1};return Object.assign(Object.assign({},emptyItems),{Regions:[item]})}function getSimpleItem(reportItem){const controller={Type:"simpleitem",Name:reportItem.Name,Visibility:"overflowplaceholder"!==reportItem.Type?reportItem.Visibility:createVisibility()};return Object.assign(Object.assign({},emptyItems),{Scope:[controller]})}function convertDataRegion(reportItem){if("tablixmember"===reportItem.Type)throw new ReportCompilationError('"tablixmember" must be handled within "tablix"');switch(reportItem.Type){case"rectangle":return getContainerDescriptor(reportItem);case"fixedpagesection":return getContainerDescriptor(Object.assign(Object.assign({},reportItem),{ReportItems:reportItem.ReportItems,Name:null}));case"list":return function(list){const item={Name:list.Name,Type:"dataregion",ReportItems:joinItems(list.ReportItems.map(convertDataRegion)),Visibility:list.Visibility,IsDetails:isDetailRegion(list)};return Object.assign(Object.assign({},emptyItems),{Regions:[item]})}(reportItem);case"bandedlist":return getBandedListDescriptor(reportItem);case"table":return function(table){const details=table.Details&&!table.Details.Group.Name?Object.assign(Object.assign({},table.Details),{Group:Object.assign(Object.assign({},table.Details.Group),{Name:`${table.Name}###Details`})}):table.Details;return{Scope:[],Regions:[{Name:table.Name,Type:"dataregion",ReportItems:joinItems([getTableColumns(table.TableColumns),getTableRows(table.Header),getTableRows(table.Footer),getTableGroupItem(table.TableGroups,details)]),Visibility:table.Visibility,IsDetails:!1}],UserSorts:[]}}(reportItem);case"tablix":return function(tablix){const item={Type:"dataregion",Name:tablix.Name,ReportItems:getTablixItems(tablix),Visibility:tablix.Visibility,IsDetails:!1};return Object.assign(Object.assign({},emptyItems),{Regions:[item]})}(reportItem);case"textbox":return function(textbox){const controller={Type:"controller",Name:textbox.Name,UserSort:textbox.UserSort,Visibility:textbox.Visibility};return Object.assign(Object.assign({},emptyItems),{Scope:[controller]})}(reportItem);case"checkbox":case"inputfield":case"image":case"line":case"subreport":case"tableofcontents":case"shape":case"bullet":case"sparkline":case"barcode":case"dvchart":return getSimpleItem(reportItem);case"overflowplaceholder":return emptyItems;default:return getSimpleItem(stubUnsupportedItem$1(reportItem))}}function isDetailRegion(region){return void 0!==region.Group&&null!==region.Group&&0===region.Group.GroupExpressions.length}function namesEqual(name1,name2){return name1.toLowerCase()===name2.toLowerCase()}function collectScopeToggles(dataregion){const items=dataregion.ReportItems,textBoxes=items.Scope.filter(isController),userSorts=uniqWith(textBoxes.map((it=>it.UserSort)).filter((s=>""!==s.SortExpression)).concat(items.UserSorts),equals),scopeUserSorts=uniq(userSorts.filter((s=>namesEqual(s.SortExpressionScope,dataregion.Name)||dataregion.IsDetails&&!s.SortExpressionScope)).map((s=>s.SortExpression))),childRegions=items.Regions.map((r=>r.Name)),orphanedSorts=userSorts.filter((s=>!childRegions.find((r=>namesEqual(r,s.SortTarget))))),childrenToggles=joinToggles(items.Regions.map((r=>{return Object.assign(Object.assign({},r),{ReportItems:Object.assign(Object.assign({},r.ReportItems),{UserSorts:(regionName=r.Name,userSorts.filter((s=>!s.SortTarget||namesEqual(s.SortTarget,regionName)||orphanedSorts.indexOf(s)>=0)))})});var regionName})).map(collectScopeToggles)),toggles=joinToggles([childrenToggles,{Controllers:[],Receivers:[...items.Scope,...items.Regions].filter((it=>it.Visibility.ToggleItem)).map((it=>it.Visibility.ToggleItem.toLowerCase())),SortExpressions:{}}]),scopeControllers=textBoxes.filter((it=>toggles.Receivers.indexOf(it.Name.toLowerCase())>=0));return joinToggles([toggles,{Controllers:scopeControllers.map((c=>c.Name)),Receivers:[],SortExpressions:scopeUserSorts.length?Object.assign(Object.assign({},childrenToggles.SortExpressions),{[dataregion.Name]:scopeUserSorts}):childrenToggles.SortExpressions}])}function collectToggles(items){const result=collectScopeToggles({Type:"dataregion",Name:"reportContent",ReportItems:joinItems(items.map(convertDataRegion)),Visibility:{Hidden:!1,ToggleItem:""},IsDetails:!1});return{Toggles:result.Controllers,SortExpressions:result.SortExpressions}}const stubUnsupportedItem$1=item=>{const textBox=createTextBox(item.Name);return textBox.Value=`"${item.Type}" report item is not supported`,textBox.Visibility="overflowplaceholder"!==item.Type?item.Visibility:createVisibility(),textBox};function getTablixItems(region){const noGroupCols=getScopeLeafMembers(region.ColumnHierarchy.Members).map((l=>l.BodyIndex)),rowCells=region.Body.Rows.map((r=>noGroupCols.map((col=>r.Cells[col])))),rowMembers=region.RowHierarchy.Members.map((m=>convertTablixMember(m,rowCells))),colCells=getScopeLeafMembers(region.RowHierarchy.Members).map((l=>l.BodyIndex)).map((row=>region.Body.Rows[row].Cells)).reduce(((prev,next)=>prev.map(((p,i)=>p.concat(next[i])))),region.Body.Rows[0].Cells.map((()=>[]))),colMembers=region.ColumnHierarchy.Members.map((m=>convertTablixMember(m,colCells)));return joinItems([...(region.Corner?flatten$1(region.Corner).filter(isNotNull).map((c=>c.Item)).filter(isNotNull):[]).map(convertDataRegion),...colMembers,...rowMembers])}function getScopeLeafMembers(members){return getLeafNodes(members,(m=>m.Children.filter((c=>null===c.Group))),(m=>m.BodyIndex>=0))}function getLeafNodes(items,getChildren,isLeaf){return flatten$1(items.map((item=>isLeaf(item)?[item]:getLeafNodes(getChildren(item),getChildren,isLeaf))))}function convertTablixMember(m,bodyCells){var _a,_b,_c;const scopeItems=joinItems([(null===(_a=m.Header)||void 0===_a?void 0:_a.Item)?convertDataRegion(m.Header.Item):null,...m.Children.map((c=>convertTablixMember(c,bodyCells))),...m.BodyIndex>=0?bodyCells[m.BodyIndex].filter(isNotNull).map((c=>c.Item)).filter(isNotNull).map(convertDataRegion):[]].filter(isNotNull)),toggleItem=m.Visibility.ToggleItem&&!isItemSelfToggled(m.Visibility.ToggleItem,scopeItems.Scope)?m.Visibility.ToggleItem:"",visibility={Hidden:m.Visibility.Hidden,ToggleItem:toggleItem};if(m.Group){const member={Type:"dataregion",Name:null!==(_c=null===(_b=m.Group)||void 0===_b?void 0:_b.Name)&&void 0!==_c?_c:"",ReportItems:scopeItems,Visibility:visibility,IsDetails:isDetailRegion(m)};return Object.assign(Object.assign({},emptyItems),{Regions:[member]})}{const member={Type:"simpleitem",Name:"",Visibility:visibility};return scopeItems.Scope.push(member),Object.assign(Object.assign({},scopeItems),{Scope:[...scopeItems.Scope,member]})}}function isController(it){return"controller"===it.Type}function isItemSelfToggled(toggleItem,scopeItems){return!!scopeItems.filter(isController).find((tb=>tb.Name.toLowerCase()===toggleItem.toLowerCase()))}function getScopeActions(parent,scopeId){return Object.assign(Object.assign({},parent),{ScopeToggles:(parent.ScopeToggles||[]).concat(parent.Toggles.filter((a=>a.ScopeId===scopeId)))})}function getPeerScopes(defRegions,dataRegions){const map={};return defRegions.forEach(((r,i)=>{const regionData=dataRegions[i].Scope;"dataset"===r.type?r.Content.Regions.forEach(((r1,i1)=>map[r1.Name]=regionData.Regions[i1].Scope.Id)):map[r.Name]=regionData.Id})),map}function getDataSetScopes(defRegions,dataRegions){const map={};return defRegions.forEach(((r,i)=>{const regionData=dataRegions[i].Scope;"dataset"===r.type&&(map[r.Name]=regionData.Id)})),map}function buildAnchorNodes(resolvedModel){const result=[];return resolvedModel.ToCAnchor&&result.push(h("a",{type:"toc_label",name:resolvedModel.ToCAnchor},[])),resolvedModel.Bookmark&&result.push(h("a",{type:"bookmark",name:resolvedModel.Bookmark},[])),result}function decodeEnum(decode){return value=>{const result=decode(value);return"success"===result.type?result.value:null}}const tryConvertToEnum={WritingMode:decodeEnum(cjs$1.BasicModel.Enums.WritingMode.decode),TextAlign:decodeEnum(cjs$1.BasicModel.Enums.TextAlign.decode),VerticalAlign:decodeEnum(cjs$1.BasicModel.Enums.VerticalAlign.decode),TextDecoration:decodeEnum(cjs$1.BasicModel.Enums.TextDecoration.decode),FontStyle:decodeEnum(cjs$1.BasicModel.Enums.FontStyle.decode),FontWeight:decodeEnum(cjs$1.BasicModel.Enums.FontWeight.decode),Direction:decodeEnum(cjs$1.BasicModel.Enums.Direction.decode),WrapMode:decodeEnum(cjs$1.BasicModel.Enums.WrapMode.decode),UprightInVerticalText:decodeEnum(cjs$1.BasicModel.Enums.UprightInVerticalText.decode),BorderStyle:decodeEnum(cjs$1.BasicModel.Enums.BorderStyle.decode),ShapeStyle:decodeEnum(cjs$1.BasicModel.Enums.ShapeStyle.decode),BackgroundGradientType:decodeEnum(cjs$1.BasicModel.Enums.BackgroundGradientType.decode),HorizontalImageAlign:decodeEnum(cjs$1.BasicModel.Enums.HorizontalImageAlign.decode),VerticalImageAlign:decodeEnum(cjs$1.BasicModel.Enums.VerticalImageAlign.decode),BulletLabelFontStyles:decodeEnum(cjs$1.BasicModel.Enums.BulletLabelFontStyles.decode),ParagraphTextAlign:decodeEnum(cjs$1.BasicModel.Enums.ParagraphTextAlign.decode)};function splitExpression(tokens){if(tokens.length<3)return null;const parts=[];let part="",brackets=0;for(let i=3;i<tokens.length-1;i++)","!==tokens[i]||0!==brackets?("("===tokens[i]?brackets++:")"===tokens[i]&&brackets--,part+=tokens[i],tokens[i+1]&&!".!".includes(tokens[i+1][0])&&(part+=" ")):(parts.push(`=${part}`),part="");return part&&parts.push(`=${part}`),parts}const convertColor=color=>color&&"string"==typeof color?"#"===color[0]?(color.replace(/#/,"").match(/.{1,2}/g)||[]).map((c=>parseInt(c,16))):colors[color.toLowerCase()]:null,defaultColors2=["Silver","WhiteSmoke"],defaultColors3=["Silver","Gainsboro","WhiteSmoke"];function getColorScale2(colorScale,defaultColors=defaultColors2){const fromColor=convertColor(colorScale.StartColor)||convertColor(defaultColors[0]),toColor=convertColor(colorScale.EndColor)||convertColor(defaultColors[1]);if(colorScale.Value>colorScale.Maximum||colorScale.Value<colorScale.Minimum)return null;if(colorScale.Maximum===colorScale.Minimum)return colorScale.Value===colorScale.Minimum&&fromColor&&`rgb(${fromColor.map((c=>c.toString(10))).join(", ")})`||null;const percent=Math.max(0,Math.min(1,(colorScale.Value-colorScale.Minimum)/(colorScale.Maximum-colorScale.Minimum)));if(fromColor&&toColor){return`rgb(${fromColor.map(((c,i)=>Math.floor(fromColor[i]+percent*(toColor[i]-fromColor[i])))).map((c=>c.toString(10))).join(", ")})`}return fromColor||toColor?`rgba(${(fromColor||toColor).map((c=>c.toString(10))).join(", ")}, ${percent.toFixed(2)})`:null}const numberOrZero=value=>"number"==typeof value?value:0,makeTryConvertToColor=comp=>colorData=>{if("string"!=typeof colorData)return null;const tokens=colorData?tokenize(colorData):[];if(colorData&&"="===colorData[0]&&tokens.length>1&&["colorscale2","colorscale3"].indexOf(tokens[1].toLowerCase())>-1){const splitted=splitExpression(tokens),compiledParts=splitted&&splitted.map((ex=>comp(ex)))||[];switch(tokens[1].toLowerCase()){case"colorscale2":return data=>5!==compiledParts.length?null:getColorScale2({Value:numberOrZero(resolveCompiled$1(compiledParts[0],data)),Minimum:numberOrZero(resolveCompiled$1(compiledParts[1],data)),Maximum:numberOrZero(resolveCompiled$1(compiledParts[2],data)),StartColor:resolveCompiled$1(compiledParts[3],data),EndColor:resolveCompiled$1(compiledParts[4],data)});case"colorscale3":return data=>7!==compiledParts.length?null:function(colorScale){if(colorScale.Middle>colorScale.Maximum||colorScale.Middle<colorScale.Minimum)return null;const isFirst=colorScale.Value<colorScale.Middle;return getColorScale2({Value:colorScale.Value,Minimum:isFirst?colorScale.Minimum:colorScale.Middle,Maximum:isFirst?colorScale.Middle:colorScale.Maximum,StartColor:isFirst?colorScale.StartColor:colorScale.MiddleColor,EndColor:isFirst?colorScale.MiddleColor:colorScale.EndColor},isFirst?defaultColors3.slice(0,2):defaultColors3.slice(1,3))}({Value:numberOrZero(resolveCompiled$1(compiledParts[0],data)),Minimum:numberOrZero(resolveCompiled$1(compiledParts[1],data)),Middle:numberOrZero(resolveCompiled$1(compiledParts[2],data)),Maximum:numberOrZero(resolveCompiled$1(compiledParts[3],data)),StartColor:resolveCompiled$1(compiledParts[4],data),MiddleColor:resolveCompiled$1(compiledParts[5],data),EndColor:resolveCompiled$1(compiledParts[6],data)})}}return comp(colorData)},Create=Tools.Variant.Create,withDefault$1=defaultValue=>compiledValue=>mapValue(compiledValue,(value=>null!=value?value:defaultValue)),toBooleanOrNull=compiledValue=>mapValue(compiledValue,(value=>(value=>{try{return null==value||value===1/0||value===-1/0||"object"==typeof value||Number.isNaN(value)?null:Create(value,"Bool",!0).Value}catch(error){return error instanceof Error&&error.message,null}})(value)));const toNumberOrNull=compiledValue=>mapValue(compiledValue,(value=>(value=>{try{return null==value||value===1/0||value===-1/0||"object"==typeof value||Number.isNaN(value)?null:Create(value,"Double",!0).Value}catch(error){return error instanceof Error&&error.message,null}})(value)));const toStringOrNull=compiledValue=>mapValue(compiledValue,(value=>(value=>{try{return null==value||value===1/0||value===-1/0||"object"==typeof value&&!dateTimeFactory_isDateTime(value)||Number.isNaN(value)?null:Create(value,"String",!0).Value}catch(error){return error instanceof Error&&error.message,null}})(value)));const toLengthOrNull=compiledValue=>mapValue(compiledValue,(value=>(value=>{try{if("string"!=typeof value)return null;const trimmedValue=Length.parseWithUnits(value);return`${trimmedValue.value}${trimmedValue.units}`}catch(error){return error instanceof Error&&error.message,null}})(value)));const makeValidateEnum=tryParseEnum=>{const toEnumOrNull=(tryParseEnum=>compiledValue=>mapValue(compiledValue,(value=>tryParseEnum(value))))(tryParseEnum);return defaultValue=>void 0===defaultValue?toEnumOrNull:pipe(toEnumOrNull,withDefault$1(defaultValue))},createTypedCompiler=comp=>{const tryConvertToColor=makeTryConvertToColor(comp);const makeCompileEnum=tryParseEnum=>{const validateEnum=makeValidateEnum(tryParseEnum);return function(expr,defaultValue){return validateEnum(defaultValue)(comp(expr))}};return{compileBoolean:function(expr,defaultValue){return function(defaultValue){return void 0===defaultValue?toBooleanOrNull:pipe(toBooleanOrNull,withDefault$1(defaultValue))}(defaultValue)(comp(expr))},compileNumber:function(expr,defaultValue){return function(defaultValue){return void 0===defaultValue?toNumberOrNull:pipe(toNumberOrNull,withDefault$1(defaultValue))}(defaultValue)(comp(expr))},compileString:function(expr,defaultValue){return function(defaultValue){return void 0===defaultValue?toStringOrNull:pipe(toStringOrNull,withDefault$1(defaultValue))}(defaultValue)(comp(expr))},compileLength:function(expr,defaultValue){return function(defaultValue){return void 0===defaultValue?toLengthOrNull:pipe(toLengthOrNull,withDefault$1(defaultValue))}(defaultValue)(comp(expr))},compileColor:function(expr,defaultValue){const convertedValue=tryConvertToColor(expr);return void 0===defaultValue?convertedValue:withDefault$1(defaultValue)(convertedValue)},compileEnum:{WritingMode:makeCompileEnum(tryConvertToEnum.WritingMode),TextAlign:makeCompileEnum(tryConvertToEnum.TextAlign),VerticalAlign:makeCompileEnum(tryConvertToEnum.VerticalAlign),TextDecoration:makeCompileEnum(tryConvertToEnum.TextDecoration),FontStyle:makeCompileEnum(tryConvertToEnum.FontStyle),FontWeight:makeCompileEnum(tryConvertToEnum.FontWeight),Direction:makeCompileEnum(tryConvertToEnum.Direction),WrapMode:makeCompileEnum(tryConvertToEnum.WrapMode),UprightInVerticalText:makeCompileEnum(tryConvertToEnum.UprightInVerticalText),BorderStyle:makeCompileEnum(tryConvertToEnum.BorderStyle),ShapeStyle:makeCompileEnum(tryConvertToEnum.ShapeStyle),BackgroundGradientType:makeCompileEnum(tryConvertToEnum.BackgroundGradientType),HorizontalImageAlign:makeCompileEnum(tryConvertToEnum.HorizontalImageAlign),VerticalImageAlign:makeCompileEnum(tryConvertToEnum.VerticalImageAlign),BulletLabelFontStyles:makeCompileEnum(tryConvertToEnum.BulletLabelFontStyles),ParagraphTextAlign:makeCompileEnum(tryConvertToEnum.ParagraphTextAlign)}}},defaultSubreportParameter=function(parameterName){const decodeResult=cjs$1.BasicModel.SubreportParameter.decode({ParameterName:parameterName});if("error"===decodeResult.type)throw new Error(`Fatal Error: can't create subreport parameter: ${decodeResult.reason}`);return decodeResult.value}("");function compileAction$1(action,fieldsRef){const exprCompiler=createTypedCompiler((function(value){return compileExpression(value,fieldsRef)}));return{BookmarkLink:exprCompiler.compileString(action.BookmarkLink),Hyperlink:exprCompiler.compileString(action.Hyperlink),Drillthrough:{ReportName:exprCompiler.compileString(action.Drillthrough.ReportName),Parameters:action.Drillthrough.Parameters.map((p=>({ParameterName:p.ParameterName,Value:compileExpression(p.Value,fieldsRef),Omit:exprCompiler.compileBoolean(p.Omit,defaultSubreportParameter.Omit)})))},ApplyParameters:{Parameters:action.ApplyParameters.Parameters.map((p=>Object.assign(Object.assign({},p),{Value:compileExpression(p.Value,fieldsRef)})))}}}function resolveAction$1(compiledAction,data){const bookmarkLink=safeResolveCompiledData(compiledAction.BookmarkLink,data,"BookmarkLink"),hyperlink=safeResolveCompiledData(compiledAction.Hyperlink,data,"Hyperlink");return{BookmarkLink:bookmarkLink?`bm_${encodeURIComponent(bookmarkLink)}`:null,Hyperlink:hyperlink?encodeURI(hyperlink):null,Drillthrough:{ReportName:safeResolveCompiledData(compiledAction.Drillthrough.ReportName,data,"Drillthrough.ReportName"),Parameters:compiledAction.Drillthrough.Parameters.map((p=>({ParameterName:p.ParameterName,Value:safeResolveCompiledData(p.Value,data,"Value"),Omit:safeResolveCompiledData(p.Omit,data,"Omit")})))},ApplyParameters:{Parameters:compiledAction.ApplyParameters.Parameters.map((p=>Object.assign(Object.assign({},p),{Value:safeResolveCompiledData(p.Value,data,"Value")})))}}}function resolveItemCommon(compiledModel,data,ctx){var _a;const label=compiledModel.Label?resolveCompiled$1(compiledModel.Label,data,ctx):"",headingLevel=compiledModel.HeadingLevel?safeResolveCompiledData(compiledModel.HeadingLevel,data,"HeadingLevel",ctx):null,value=compiledModel.Value?resolveCompiled$1(compiledModel.Value,data,ctx):"";return{Action:compiledModel.Action?resolveAction$1(compiledModel.Action,data):null,Bookmark:compiledModel.Bookmark?`bm_${encodeURIComponent(null!==(_a=safeResolveCompiledData(compiledModel.Bookmark,data,"Bookmark",ctx))&&void 0!==_a?_a:"")}`:null,HeadingLevel:null!==headingLevel?headingLevel:null,Label:label,Value:value,ToCAnchor:""!==label||headingLevel&&headingLevel>0?generateTocAnchor(compiledModel.Name,data&&data.Id):null,Tooltip:compiledModel.Tooltip?toString$1(safeResolveCompiledData(compiledModel.Tooltip,data,"Tooltip",ctx)):void 0}}function generateTocAnchor(itemName,dataScopeId){return encodeURIComponent(`toc_${dataScopeId}_${itemName}`)}function buildActionAttr(action){return action.BookmarkLink?{Type:"bookmark",Target:action.BookmarkLink}:action.Hyperlink?{Type:"hyperlink",Target:action.Hyperlink}:action.Drillthrough.ReportName?{Type:"drillthrough",Target:action.Drillthrough.ReportName,Parameters:action.Drillthrough.Parameters.map((p=>({Name:p.ParameterName,Value:p.Value})))}:action.ApplyParameters.Parameters.length?{Type:"apply-parameters",Parameters:action.ApplyParameters.Parameters}:{}}const LowerLatinAlphabet="ABCDEFGHIJKLMNOPQRSTUVWXYZ".toLowerCase(),LowerRomanDigits="IVXLCDM".toLowerCase();function formatLevel(number,style){switch((style||"None").toLowerCase()){case"none":return"";case"decimal-leading-zero":case"decimalleadingzero":return(number<10?"0":"")+number.toString();case"roman":case"upper-roman":case"upperroman":return ToRoman(number,"IVXLCDM");case"lower-roman":case"lowerroman":return ToRoman(number,LowerRomanDigits);case"latin":case"lower-latin":case"lowerlatin":case"lower-alpha":case"loweralpha":return Alpha(number,LowerLatinAlphabet);case"upper-latin":case"upperlatin":case"upper-alpha":case"upperalpha":return Alpha(number,"ABCDEFGHIJKLMNOPQRSTUVWXYZ");case"greek":case"lower-greek":case"lowergreek":return ToLowerGreek(number);case"upper-greek":case"uppergreek":return ToUpperGreek(number);case"katakanabrackets":return ToKatakanaBrackets(number);case"katakanairohabrackets":return ToKatakanaIrohaBrackets(number);case"katakana":return ToKatakana(number);case"katakanairoha":return ToKatakanaIroha(number);case"katakanalower":return ToKatakanaLower(number);case"katakanairohalower":return ToKatakanaIrohaLower(number);case"circlednumber":return ToCircledNumber(number);case"decimal":default:return number.toString()}}const ToRoman=(value,digits)=>{let v=value;if(v<1||v>3999)return value.toString();const letters=[];let length=0,d=0;do{const num=v%10;if(num%5<4)for(let i=num%5;i>0;i--)letters[15-++length]=digits[d];num>=4&&num<=8&&(letters[15-++length]=digits[d+1]),9===num&&(letters[15-++length]=digits[d+2]),num%5==4&&(letters[15-++length]=digits[d]),v=Math.floor(v/10),d+=2}while(0!==v);return letters.slice(15-length,15).join("")},Alpha=(value,alphabet)=>{let v=value;const numberBase=alphabet.length;let index=0;const sb=[];v<0?(sb.push("-"),index=1):value>=1&&--v;do{const i=Math.abs(v%numberBase);sb.splice(index,0,alphabet[i]),v=Math.floor(v/numberBase)}while(v>0);return sb.join("")},ToLowerGreek=value=>Alpha(value,"\u03b1\u03b2\u03b3\u03b4\u03b5\u03b6\u03b7\u03b8\u03b9\u03ba\u03bb\u03bc\u03bd\u03be\u03bf\u03c0\u03c1\u03c3\u03c4\u03c5\u03c6\u03c7\u03c8\u03c9"),ToUpperGreek=value=>Alpha(value,"\u0391\u0392\u0393\u0394\u0395\u0396\u0397\u0398\u0399\u039a\u039b\u039c\u039d\u039e\u039f\u03a0\u03a1\u03a3\u03a4\u03a5\u03a6\u03a7\u03a8\u03a9"),ToKatakana=arg=>Alpha(arg,"\u30a2\u30a4\u30a6\u30a8\u30aa\u30ab\u30ad\u30af\u30b1\u30b3\u30b5\u30b7\u30b9\u30bb\u30bd\u30bf\u30c1\u30c4\u30c6\u30c8\u30ca\u30cb\u30cc\u30cd\u30ce\u30cf\u30d2\u30d5\u30d8\u30db\u30de\u30df\u30e0\u30e1\u30e2\u30e4\u30e6\u30e8\u30e9\u30ea\u30eb\u30ec\u30ed\u30ef\u30f2\u30f3"),ToKatakanaIroha=arg=>Alpha(arg,"\u30a4\u30ed\u30cf\u30cb\u30db\u30d8\u30c8\u30c1\u30ea\u30cc\u30eb\u30f2\u30ef\u30ab\u30e8\u30bf\u30ec\u30bd\u30c4\u30cd\u30ca\u30e9\u30e0\u30a6\u30f0\u30ce\u30aa\u30af\u30e4\u30de\u30b1\u30d5\u30b3\u30a8\u30c6\u30a2\u30b5\u30ad\u30e6\u30e1\u30df\u30b7\u30f1\u30d2\u30e2\u30bb\u30b9\u30f3"),ToKatakanaBrackets=val=>`(${ToKatakana(val)})`,ToKatakanaIrohaBrackets=val=>`${ToKatakanaIroha(val)})`,ToKatakanaLower=val=>Alpha(val,"\uff71\uff72\uff73\uff74\uff75\uff76\uff77\uff78\uff79\uff7a\uff7b\uff7c\uff7d\uff7e\uff7f\uff80\uff81\uff82\uff83\uff84\uff85\uff86\uff87\uff88\uff89\uff8a\uff8b\uff8c\uff8d\uff8e\uff8f\uff90\uff91\uff92\uff93\uff94\uff95\uff96\uff97\uff98\uff99\uff9a\uff9b\uff9c\uff66\uff9d"),ToKatakanaIrohaLower=val=>Alpha(val,"\uff68\uff9b\uff8a\uff86\uff8e\uff8d\uff84\uff81\uff98\uff87\uff99\uff66\uff9c\uff76\uff96\uff80\uff9a\uff7f\uff82\uff88\uff85\uff97\uff91\uff73\u30f0\uff89\uff75\uff78\uff94\uff8f\uff79\uff8c\uff7a\uff6a\uff83\uff71\uff7b\uff77\uff6d\uff92\uff90\uff7c\u30f1\uff8b\uff93\uff7e\uff7d\uff9d"),ToCircledNumber=val=>val>=1&&val<=20?String.fromCharCode(9311+val):val.toString();function makeNode(itemId,label,toCAnchor,path,formatLevelNumber){if("function"==typeof label){label=label({Data:{},GetDocumentPath:()=>path.map(((l,idx)=>formatLevelNumber(idx,l+1))).join(".")})}return{anchor:toCAnchor,name:`${label}`,level:path.length-1,path:path,itemId:itemId}}const documentMapStrategies={None:()=>null,Labels:(itemId,resolvedModel,prevPath,level,formatLevelNumber)=>{if(!resolvedModel.ToCAnchor)return null;if(!resolvedModel.Label)return null;const path=nextPath(prevPath,level);return makeNode(itemId,resolvedModel.Label,resolvedModel.ToCAnchor,path,formatLevelNumber)},Headings:(itemId,resolvedModel,prevPath,_,formatLevelNumber)=>{if(!resolvedModel.ToCAnchor)return null;if(!resolvedModel.HeadingLevel)return null;const path=nextPath(prevPath,resolvedModel.HeadingLevel-1);return makeNode(itemId,resolvedModel.Label||resolvedModel.Value||"",resolvedModel.ToCAnchor,path,formatLevelNumber)},All:(itemId,resolvedModel,prevPath,level,formatLevelNumber)=>{if(!resolvedModel.ToCAnchor)return null;if(!resolvedModel.HeadingLevel&&!resolvedModel.Label)return null;const headingLevel=resolvedModel.HeadingLevel,path=nextPath(prevPath,null!==headingLevel&&headingLevel>0?headingLevel-1:level);return makeNode(itemId,resolvedModel.Label||resolvedModel.Value||"",resolvedModel.ToCAnchor,path,formatLevelNumber)}};function nextPath(path,level){return level<path.length-1&&(path=path.slice(0,level+1)),level>path.length-1&&(path=[...path,-1]),[...path.slice(0,-1),path[path.length-1]+1]}function buildDocumentMap(itemName,compiled,config,childNodes){return buildNestedDocMap(config)((d=>d))(itemName,compiled,childNodes)}const buildNestedDocMap=config=>getScope=>(itemName,compiled,childNodes)=>(data,parentCtx)=>actions=>{const dataScope=getScope(data),resolvedModel=resolveItemCommon(Object.assign({Name:itemName},compiled),dataScope,parentCtx);let ctx=setDocMapNode({Name:itemName,ScopeId:dataScope.Id},config,parentCtx,resolvedModel);const result=ctx.DocumentMap.node?[ctx.DocumentMap.node]:[];for(const child of childNodes){const c=child(data,ctx)(actions);c.length&&(result.push(...c),ctx=setPrevDocPath(ctx,c[c.length-1].path))}return result};function buildGroupDocumentMap(itemName,compiled,config,childNodes){return buildNestedGroupDocMap(config)((d=>({Scope:d.Scope,Groups:Array.from(d.Groups||[])})),(d=>d))(itemName,compiled,childNodes)}const buildNestedGroupDocMap=config=>(getGroupData,getChildScope)=>(itemName,compiled,childNodes)=>(parentData,parentCtx)=>actions=>{const{Scope:dataScope,Groups:dataGroups}=getGroupData(parentData),resolvedModel=resolveItemCommon(Object.assign({Name:itemName},compiled),dataScope,parentCtx);let ctx=setDocMapNode({Name:itemName,ScopeId:dataScope.Id},config,parentCtx,resolvedModel);const result=ctx.DocumentMap.node?[ctx.DocumentMap.node]:[];for(const gData of dataGroups){const c=childNodes(gData,ctx)(getScopeActions(actions,getChildScope(gData).Id));c.length&&(result.push(...c),ctx=setPrevDocPath(ctx,c[c.length-1].path))}return result};function setDocMapNode(id,config,ctx,item){const node=config.MakeDocMapNode(id,item,ctx.DocumentMap.lastPath,ctx.DocumentMap.level,config.FormatLevelNumber);return ctx=Object.assign(Object.assign({},ctx),{DocumentMap:Object.assign(Object.assign({},ctx.DocumentMap),{node:node}),GetDocumentPath:()=>node?node.path.map(((l,idx)=>config.FormatLevelNumber(idx,l+1))).join("."):""}),node&&(ctx=function(ctx){return Object.assign(Object.assign({},ctx),{DocumentMap:Object.assign(Object.assign({},ctx.DocumentMap),{level:ctx.DocumentMap.level+1})})}(ctx=setPrevDocPath(ctx,node.path))),ctx}function setPrevDocPath(ctx,path){return Object.assign(Object.assign({},ctx),{DocumentMap:Object.assign(Object.assign({},ctx.DocumentMap),{lastPath:path})})}function collectAnchors(node){const currentAnchor=node&&node.properties&&("toc_label"===node.properties.type||"bookmark"===node.properties.type)&&node.properties.name?[node.properties.name]:[];if(!node.children||0===node.children.length)return currentAnchor;const childNodes=node.children.filter((c=>"VirtualNode"===c.type));for(let i=0;i<childNodes.length;i++)currentAnchor.push(...collectAnchors(childNodes[i]));return currentAnchor}function addValueHeadingLevel(value,label,heading){try{if(toString$1(label)||!+heading)return value;const valueExpr=null===value?null:treeBuilder$2(value.toString()).ToString();if(null===valueExpr)return null;const headingExpr=null===heading?null:treeBuilder$2(heading.toString()).ToString();return heading?`=IIF(${headingExpr}, DocumentMap.Path & "\t", "") & ${valueExpr}`:value}catch(ex){return value}}function buildDocumentMapConfig(settings){return{AddHeadingLevel:"Labels"===settings.Source||"None"===settings.Source||"None"===settings.NumberingStyle&&0===settings.Levels.length?value=>value:addValueHeadingLevel,MakeDocMapNode:documentMapStrategies[settings.Source],FormatLevelNumber:(levelIndex,levelNumber)=>formatLevel(levelNumber,settings.Levels.length>levelIndex?settings.Levels[levelIndex]:settings.NumberingStyle)}}class LayoutError extends Error{constructor(message){super(message),Object.setPrototypeOf(this,LayoutError.prototype)}}function cons(head,tail){return new LazyList(head,tail||null)}function reverse(list){if(null===list.Tail)return list;let res=LazyList.nil,remaining=list;do{res=cons(remaining.Head,res),remaining=remaining.Tail}while(null!==remaining);return res}function zip$1(first,second,selector){const head=selector(first.Head,second.Head);if(null===first.Tail&&null===second.Tail)return cons(head);if(null===first.Tail||null===second.Tail)throw new LayoutError("InvalidOperationException: The lists must have same length.");return cons(head,(()=>zip$1(first.Tail,second.Tail,selector)))}function select(list,selector){return cons(selector(list.Head),(()=>null===list.Tail?null:select(list.Tail,selector)))}function fromIterator(items){const next=items.next();return next.done?null:LazyList.cons(next.value,(()=>fromIterator(items)))}class LazyList{constructor(head,tail){this.Head=head,this._tail=tail}get Tail(){return"function"==typeof this._tail&&(this._tail=this._tail()),this._tail}Reverse(){return reverse(this)}map(selector){return select(this,selector)}select(selector){return select(this,selector)}filter(predicate){return LazyList.filter(this,predicate)}where(predicate){return LazyList.where(this,predicate)}concat(second){return LazyList.concat(this,second)}selectMany(selector){return LazyList.selectMany(this,selector)}toArray(){return LazyList.toArray(this)}get count(){return LazyList.count(this)}Take(count){return LazyList.take(this,count)}skip(count){return LazyList.skip(this,count)}zip(second,selector){return zip$1(this,second,selector)}fold(seed,accumulate){return LazyList.fold(this,seed,accumulate)}static Reverse(list){return null==list?null:reverse(list)}static select(list,selector){return null==list?null:select(list,selector)}static map(list,selector){return LazyList.select(list,selector)}static where(list,predicate){return null==list?null:predicate(list.Head)?cons(list.Head,(()=>null==list?null:LazyList.filter(list.Tail,predicate))):LazyList.filter(list.Tail,predicate)}static filter(list,predicate){return LazyList.where(list,predicate)}static concat(first,second){if(!first&&!second)return null;if(!second)return first;if(null==first)return"function"==typeof second?second():second;const tail=first.Tail;return cons(first.Head,null===tail?second:()=>LazyList.concat(tail,second))}static toArray(list){const arr=[];for(let it=list;null!=it;it=it.Tail)arr.push(it.Head);return arr}static fromArray(items,index=0){return index>=items.length?null:LazyList.cons(items[index],(()=>LazyList.fromArray(items,index+1)))}static fromIterable(items){return fromIterator(items[Symbol.iterator]())}static cons(head,tail){return cons(head,tail)}static zip(first,second,selector){if(!first&&!second)return LazyList.nil;if(!first||!second)throw new LayoutError("InvalidOperationException: The lists must have same length.");return zip$1(first,second,selector)}static fold(list,seed,accumulate){let result=seed;for(let i=list;i;i=i.Tail)result=accumulate(result,i.Head);return result}static fold2(sourceList,accumulator){return null==sourceList?null:LazyList.fold(sourceList.Tail,sourceList.Head,((result,item)=>result.zip(item,accumulator)))}static flatten(sourceList){return sourceList?sourceList.Head?cons(sourceList.Head.Head,(()=>sourceList.Head.Tail?LazyList.flatten(cons(sourceList.Head.Tail,sourceList.Tail)):LazyList.flatten(sourceList.Tail))):LazyList.flatten(sourceList.Tail):null}static selectMany(list,selector){if(null===list)return null;let head=selector(list.Head);isArray$1(head)?head=LazyList.fromArray(head):head instanceof LazyList||(head=cons(head));return null===list.Tail?head:LazyList.concat(head,(()=>LazyList.selectMany(list.Tail,selector)))}static forEach(list,action){isArray$1(list)&&function(array,fn){forEach$1(fn,array)}(list,action);for(let it=list;null!==it;it=it.Tail)action(it.Head)}static count(list){if(null==list)return 0;let count=0,remain=list;for(;null!=remain;remain=remain.Tail)count++;return count}static indexed(list,index=0){return null==list?null:cons(extend({index:index},list.Head),(()=>null==list?null:LazyList.indexed(list.Tail,index+1)))}static take(list,count){return null==list||count<=0?null:cons(list.Head,LazyList.take(list.Tail,count-1))}static skip(list,count){return null==list||count<=0?list:LazyList.skip(list.Tail,count-1)}static get nil(){return null}}class LResult{static Complete(size,slice){return new Result(size,slice,null)}static Split(size,slice,reminder){if(null===reminder)throw new LayoutError("ArgumentNullException: reminder");return new Result(size,slice,reminder)}static Fail(){return Result.FailInstance}static SplitOrComplete(size,slice,reminder){return reminder?LResult.Split(size,slice,reminder):LResult.Complete(size,slice)}static PageBreak(tail){return LResult.Split(0,null,tail)}static PageBreakAfter(size,head){return LResult.Split(size,head,Zero())}}class Result{constructor(size,body,tail){this.Size=size,this.Body=body,this.Tail=tail}IsFailed(){return 0===this.Size&&null===this.Body&&IsZero(this.Tail)}IsSplit(){return!IsZero(this.Tail)}IsCompleted(){return!this.IsFailed()&&IsZero(this.Tail)}IsPageBreak(){return this.IsSplit()&&!this.Size&&!this.Body}IsPageBreakAfter(){return this.IsCompleted()&&!!this.Tail}IsEmpty(){return this.IsFailed()||this.IsPageBreak()}}function ZeroLayout(){return LResult.Complete(0,null)}function IsZero(layout){return null===layout||layout===ZeroLayout}function Zero(){return ZeroLayout}function PrintAtBottom(body,filler,footer,options,combine){if(null==filler)throw new LayoutError("ArgumentNullException: filler");if(null==footer)throw new LayoutError("ArgumentNullException: footer");return space=>{let spaceLeft=space;const fr=footer(spaceLeft);if(fr.IsFailed())return LResult.Fail();spaceLeft-=fr.Size;let br=body(spaceLeft);if(spaceLeft-=br.Size,br.IsPageBreak())return LResult.PageBreak(PrintAtBottom(br.Tail||Zero(),filler,footer,options,combine));if(!br.IsCompleted()&&!IsZero(body)&&!options.RepeatFooter)return br=body(space),LResult.Split(br.Size,combine(br.Size,null==br.Body?null:br,null,null),PrintAtBottom(br.Tail||Zero(),filler,footer,options,combine));if(br.IsFailed()&&!IsZero(body))return LResult.Fail();let placeholder=filler(spaceLeft);placeholder.IsFailed()&&(placeholder=null);const size=br.Size+(null!=placeholder?placeholder.Size:0)+fr.Size;return LResult.SplitOrComplete(size,combine(size,null==br.Body?null:br,placeholder,fr),br.IsSplit()?PrintAtBottom(br.Tail,filler,footer,options,combine):null)}}function BodyFooterStack(body,footer,combine){return null==body?Stack$1(null,footer,((sz,f,_)=>combine(sz,null,f))):space=>{var bodyResult=body(space);if(bodyResult.IsFailed())return LResult.Fail();if(bodyResult.IsSplit()){var tail=BodyFooterStack(bodyResult.Tail,footer,combine);return bodyResult.IsPageBreak()?LResult.PageBreak(tail):LResult.Split(bodyResult.Size,combine(bodyResult.Size,bodyResult,null),tail)}var footerResult=footer(space-bodyResult.Size);if(footerResult.IsFailed()){tail=BodyFooterStack(null,footer,combine);return LResult.Split(bodyResult.Size,combine(bodyResult.Size,bodyResult,null),tail)}var size=bodyResult.Size+footerResult.Size;if(footerResult.IsSplit()){tail=BodyFooterStack(null,footerResult.Tail,combine);return LResult.Split(size,combine(size,bodyResult,footerResult.IsPageBreak()?null:footerResult),tail)}return LResult.Complete(size,combine(size,bodyResult,footerResult))}}function RepeatFooter(body,footer,makeResult,takeAllSpace=!1){return Repeat(footer,body,((size,footerSlice,bodySlice)=>makeResult(size,bodySlice,footerSlice)),takeAllSpace)}function Repeat(header,body,makeResult,takeAllSpace=!1,attempts=0){if(!body)throw new LayoutError("ArgumentNullException: body");let theader=header;return null==theader?Convert(body,(result2=>makeResult(result2.Size,null,result2))):(theader=function(layout){if(!layout)throw new LayoutError("ArgumentNullException: layout");let memo=null;return space=>{if(memo)return space>=memo.Size?memo:LResult.Fail();const slice=layout(space);return slice.IsCompleted()?memo=slice:slice}}(theader),space=>{let sliceSize=0;if(!theader)return LResult.Fail();const headerSlice=theader(space);if(headerSlice.IsFailed())return LResult.Fail();if(headerSlice.IsPageBreak())return LResult.PageBreak(Repeat(headerSlice.Tail,body,makeResult,takeAllSpace,attempts));sliceSize+=headerSlice.Size;const bodySlice=headerSlice.IsSplit()||space<=sliceSize?LResult.Fail():body(space-sliceSize),nobody=bodySlice.IsFailed()||bodySlice.IsPageBreak();if(nobody&&0===attempts)return LResult.PageBreak(Repeat(theader,bodySlice.Tail||body,makeResult,takeAllSpace,bodySlice.IsPageBreak()?attempts:attempts+1));sliceSize+=nobody?0:bodySlice.Size,takeAllSpace&&space!==1/0&&(sliceSize=space);const slice=makeResult(sliceSize,headerSlice,nobody?null:bodySlice),continueRepeat=headerSlice.IsCompleted()&&!nobody,tattempts=attempts<=1&&continueRepeat?0:attempts+1;return headerSlice.IsCompleted()&&bodySlice.IsCompleted()?bodySlice.IsPageBreakAfter()?LResult.PageBreakAfter(sliceSize,slice):LResult.Complete(sliceSize,slice):LResult.Split(sliceSize,slice,Repeat(headerSlice.Tail||(0===tattempts?theader:null),bodySlice.Tail||body,makeResult,takeAllSpace,tattempts))})}function Convert(layout,cnv){if(!layout)throw new LayoutError("ArgumentNullException: layout");return space=>ConvertResult(layout(space),cnv)}function ConvertResult(result,cnv){return result.IsFailed()?LResult.Fail():result.IsPageBreak()?LResult.PageBreak(Convert(result.Tail,cnv)):result.IsPageBreakAfter()?LResult.PageBreakAfter(result.Size,cnv(result)):result.IsCompleted()?LResult.Complete(result.Size,cnv(result)):LResult.Split(result.Size,cnv(result),Convert(result.Tail,cnv))}function ConvertResultBody(result,cnv){return ConvertResult(result,(res=>cnv(res.Body)))}function ConvertFirst(layout,cnv){return space=>{const result=layout(space);if(result.IsFailed())return LResult.Fail();if(result.IsPageBreak())return LResult.PageBreak(ConvertFirst(result.Tail,cnv));const body=cnv(result);return result.IsPageBreakAfter()?LResult.PageBreakAfter(result.Size,body):result.IsCompleted()?LResult.Complete(result.Size,body):LResult.Split(result.Size,body,result.Tail)}}function ConvertLast(layout,cnv){return space=>{const result=layout(space);return result.IsFailed()?LResult.Fail():result.IsPageBreak()?LResult.PageBreak(ConvertLast(result.Tail,cnv)):result.IsPageBreakAfter()?LResult.PageBreakAfter(result.Size,cnv(result)):result.IsCompleted()?LResult.Complete(result.Size,cnv(result)):LResult.Split(result.Size,result.Body,ConvertLast(result.Tail,cnv))}}function Chop(items,getReminders,makeResult){return space=>{if(space<=0)return LResult.Fail();let taken=LazyList.nil;if(!items)return LResult.Complete(0,makeResult(0,taken));let allCompleted=!0,pageBreakBefore=!1,pageBreakAfter=!1;for(let list=items;null!=list;list=list&&list.Tail){const slice=(0,list.Head)(space);if(null==slice)return ZeroLayout();if(slice.IsFailed())return LResult.Fail();pageBreakBefore=pageBreakBefore||slice.IsPageBreak(),pageBreakAfter=pageBreakAfter||slice.IsPageBreakAfter(),allCompleted=allCompleted&&slice.IsCompleted(),taken=LazyList.cons(slice,taken)}if(!taken)return LResult.Fail();if(taken=taken.Reverse(),pageBreakBefore){const rem1=items.zip(taken,((i,t)=>t.Tail&&t.IsPageBreak()?t.Tail:i));return LResult.PageBreak(Chop(rem1,getReminders,makeResult))}const size=Math.max(...taken.toArray().map((tr=>tr.Size))),head=makeResult(size,taken);if(allCompleted)return pageBreakAfter?LResult.PageBreakAfter(size,head):LResult.Complete(size,head);const reminder=LazyList.filter(getReminders(taken),isNotNull);return LResult.Split(size,head,Chop(reminder,getReminders,makeResult))}}function Stack$1(head,tail,combine){return StackLazyList(LazyList.fromArray([head,tail].filter(isNotNull)),((sz,list)=>list?combine(sz,list.Head,list.Tail&&list.Tail.Head):combine(sz,null,null)))}function PageBreakBefore(layout){return()=>LResult.PageBreak(layout)}function PageBreakAfter(layout){if(!layout)throw new LayoutError("ArgumentNullException: layout");return space=>{const slice=layout(space);return slice.IsFailed()?slice:slice.IsCompleted()||slice.IsPageBreakAfter()?LResult.PageBreakAfter(slice.Size,slice.Body):LResult.Split(slice.Size,slice.Body,PageBreakAfter(slice.Tail))}}function StackLazyList(items,makeResult){return space=>{if(space<=0)return LResult.Fail();let size=0,taken=LazyList.nil,reminder=LazyList.nil,pageBreakAfter=!1;if(!items)return LResult.Complete(0,makeResult(0,taken));for(let list=items;null!=list;list=list&&list.Tail){if(IsZero(list.Head))continue;const slice=list.Head(space-size);if(null!=slice){if(slice.IsFailed()){reminder=list;break}if(slice.IsEmpty()){if(slice.Tail&&slice.IsPageBreak()&&!taken)return LResult.PageBreak(StackLazyList(LazyList.cons(slice.Tail,list.Tail),makeResult))}else taken=LazyList.cons(slice,taken),size+=slice.Size;if(slice.Tail&&slice.IsSplit()){reminder=LazyList.cons(slice.Tail,list&&list.Tail);break}if(slice.IsPageBreakAfter()){pageBreakAfter=!0,reminder=list&&list.Tail;break}}}if(null==taken)return reminder?LResult.Fail():ZeroLayout();const head=makeResult(size,taken.Reverse());return reminder?LResult.Split(size,head,StackLazyList(reminder,makeResult)):pageBreakAfter?LResult.PageBreakAfter(size,head):LResult.Complete(size,head)}}function PreventOrphans$1(l1,l2,stepback,makeResult){if(null==l1)throw new LayoutError("ArgumentNullException: l1");if(null==l2)throw new LayoutError("ArgumentNullException: l2");const cl1=l1,cl2=l2;return space=>{if(space<=0)return LResult.Fail();const r1=cl1(space);if(r1.IsFailed())return LResult.Fail();if(r1.Tail&&r1.IsPageBreak())return LResult.PageBreak(PreventOrphans$1(r1.Tail,l2,stepback,makeResult));if(r1.IsPageBreakAfter(),r1.Tail&&r1.IsSplit()){const reminder=PreventOrphans$1(r1.Tail,l2,stepback,makeResult);return LResult.Split(r1.Size,makeResult(r1.Size,r1,null),reminder)}const r2=cl2(space-r1.Size);if(!r2.IsEmpty()){const tail=r2.IsPageBreakAfter()?Zero():r2.IsCompleted()?null:Convert(r2.Tail,(r=>makeResult(r.Size,r,null)));return LResult.SplitOrComplete(r1.Size+r2.Size,makeResult(r1.Size+r2.Size,r1,r2),tail)}if(r2.IsPageBreak()&&l2(1/0).IsPageBreak())return PreventOrphans$1(l1,r2.Tail,stepback,makeResult)(space);if(r1.Size>stepback){const rr=cl1(r1.Size-stepback);if(rr.IsCompleted(),!rr.IsFailed()){if(rr.IsSplit()&&rr.IsCompleted(),rr.Tail&&rr.IsPageBreak())return LResult.PageBreak(PreventOrphans$1(rr.Tail,l2,stepback,makeResult));const head1=makeResult(rr.Size,rr,null);return rr.Tail&&rr.IsSplit()?LResult.Split(rr.Size,head1,PreventOrphans$1(rr.Tail,l2,stepback,makeResult)):LResult.SplitOrComplete(rr.Size,head1,Convert(l2,(r=>makeResult(r.Size,r,null))))}}return LResult.PageBreak(StackLazyList(LazyList.cons(l1,LazyList.cons(l2)),((size,list)=>makeResult(size,list&&list.Head,list&&list.Tail?list.Tail.Head:null))))}}function PageBreakList(pageBreak){switch(pageBreak){case"Start":return ll=>LazyList.map(ll,PageBreakBefore);case"End":return ll=>LazyList.map(ll,PageBreakAfter);case"StartAndEnd":return ll=>{const withLeadingPb=LazyList.cons(PageBreakBefore(ll.Head),ll.Tail);return LazyList.map(withLeadingPb,PageBreakAfter)};case"Between":return ll=>LazyList.cons(ll.Head,LazyList.map(ll.Tail,PageBreakBefore));default:return ll=>ll}}function PageBreakIterable(pageBreak){if("None"===pageBreak)return ll=>ll;const withLazyPb=PageBreakList(pageBreak);return ll=>{const lazyLayout=LazyList.fromIterable(ll),lazyResult=lazyLayout&&withLazyPb(lazyLayout);return lazyResult?lazyResult.toArray():[]}}Result.FailInstance=new Result(0,null,null);var L={Static:function Static(size,limitSplitSize,padStart,offset,makeResult,firstPass=!0){return space=>{const spaceCorrected=space-(firstPass&&(padStart||0===padStart)?padStart:0);return size<=space?LResult.Complete(size,makeResult({First:firstPass,Last:!0},size,offset)):(limitSplitSize||0===limitSplitSize)&&size<=limitSplitSize?LResult.Fail():LResult.Split(space,makeResult({First:firstPass,Last:!1},space,offset),Static(size-spaceCorrected,limitSplitSize,padStart,offset+spaceCorrected,makeResult,!1))}},Fixed:function(size,result){return space=>space<size?LResult.Fail():LResult.Complete(size,result(size))},Cut:function Cut(size,lFunc){return space=>{const slice=lFunc(space<size?space:size);if(slice.IsFailed())return slice;if(slice.IsCompleted())return slice;if(slice.IsPageBreak())return LResult.PageBreak(Cut(size,slice.Tail));if(slice.IsSplit())return space<size?LResult.Split(slice.Size,slice.Body,Cut(size-slice.Size,slice.Tail)):LResult.Complete(slice.Size,slice.Body);throw new Error("Internal Layout Error: this line must be unreacheable.")}},Empty:function(result,size=0){return()=>LResult.Complete(size,result)},EndlessLoopPreventer:function(layout){return space=>{const layoutResult=layout(space);if(layoutResult.IsFailed())throw new LayoutError("Endless loop detected");return layoutResult}},Group:function(header,body,footer,makeResult){return Repeat(header,RepeatFooter(body,footer,((size1,bs,fs)=>({bs:bs,fs:fs}))),((size2,hs,bfs)=>makeResult(size2,{Header:hs,Body:bfs&&bfs.Body&&bfs.Body.bs,Footer:bfs&&bfs.Body&&bfs.Body.fs})))},GroupAdvanced:function(header,body,footer,filler,options,combine){if(!combine)throw new LayoutError("ArgumentNullException: combine");const combineHeader=(sz,h,b)=>combine(sz,h,b,null),combineFooter=(sz,b,f)=>combine(sz,null,b,f),combineWithoutBody=(sz,h,f)=>combine(sz,h,null,f);if(null===body){if(null===header&&null===footer)throw new LayoutError("ArgumentNullException: body");return Stack$1(header,footer,combineWithoutBody)}if(null===header&&null===footer)return body;if(options.RepeatHeader&&options.RepeatFooter&&!options.PrintFooterAtBottom)return Repeat(header,RepeatFooter(body,footer,combineFooter),combineHeader);var stepback=options.PreventOrphanStepback;return 0==stepback&&(stepback=5),null!=header&&(body=options.PreventOrphanedHeader||options.RepeatHeader?options.RepeatHeader?Repeat(header,body,combineHeader):PreventOrphans$1(header,body,stepback,combineHeader):Stack$1(header,body,combineHeader)),null!=footer&&(body=options.PrintFooterAtBottom?PrintAtBottom(body,filler,footer,options,combine):options.PreventOrphanedFooter||options.RepeatFooter?options.RepeatFooter?RepeatFooter(body,footer,combineFooter):PreventOrphans$1(body,footer,stepback,combineFooter):options.MoveFooterToNextPage?Stack$1(body,footer,combineFooter):BodyFooterStack(body,footer,combineFooter)),body},FillSpace:function FillSpace(layout,isLast,fill,fillEmpty,fillEmptyLast,makeResult){return space=>{const last=isLast(),isZero=IsZero(layout),slice=layout(space);if(slice.IsFailed()&&!isZero)return LResult.Fail();let result,size=slice.Size;const fillSlice=(isZero&&(last?fillEmptyLast:fillEmpty)||fill)(space-slice.Size),fillBody=fillSlice.Body;if(size+=fillSlice.Size,isZero||!slice.IsPageBreakAfter()){if(result=makeResult(size,slice.Body,fillSlice.Body),(isZero||slice.IsCompleted())&&last)return LResult.Complete(size,result)}else result=makeResult(size,slice.Body,slice.IsCompleted()?fillBody:null);if((isZero||slice.IsCompleted())&&last)return LResult.Complete(size,result);const tail=FillSpace(slice.Tail||Zero(),isLast,fill,fillEmpty,fillEmptyLast,makeResult);return LResult.Split(size,result,tail)}},SuppressPageBreaks:function SuppressPageBreaks(layout,suppressLeading=!1){if(!layout)throw new LayoutError("ArgumentNullException: layout");return space=>{let slice=layout(space);if(suppressLeading)for(;slice.IsPageBreak()&&slice.Tail;)slice=slice.Tail(space);else if(slice.IsPageBreak()&&slice.Tail)return LResult.PageBreak(SuppressPageBreaks(slice.Tail,!0));if(!slice.IsSplit())return slice;if(!slice.Tail)throw new LayoutError("Slice tail must be not empty");return LResult.Split(slice.Size,slice.Body,SuppressPageBreaks(slice.Tail,!0))}},Chop:Chop,ChopSplit:function(items,makeResult){return Chop(items,(slices=>slices.map((slice=>slice.IsSplit()?slice.Tail:null)).filter(isNotNull)),makeResult)},Stack:Stack$1,StackLazyList:StackLazyList,KeepTogether:function(content,pageSize,makeResult){return space=>{if(!content)throw new LayoutError("ArgumentNullException: content");const slice=content(space);return slice.IsFailed()?LResult.Fail():slice.IsCompleted()?slice.IsPageBreakAfter()?LResult.PageBreakAfter(slice.Size,makeResult(slice)):LResult.Complete(slice.Size,makeResult(slice)):pageSize>0&&!slice.IsPageBreak()&&(pageSize<space||!content(pageSize).IsCompleted())?LResult.Split(slice.Size,makeResult(slice),Convert(slice.Tail,makeResult)):LResult.PageBreak(Convert(content,makeResult))}},PageBreakBefore:PageBreakBefore,PageBreakAfter:PageBreakAfter,Arrange:function Arrange(layout,makeResult,firstPass=!1){if(!layout)throw new LayoutError("ArgumentNullException: layout");return space=>{const result=layout(space);if(result.IsFailed())return LResult.Fail();if(result.IsPageBreak())return LResult.PageBreak(Arrange(result.Tail,makeResult,firstPass));const isCompleted=result.IsCompleted(),head=makeResult({First:firstPass,Last:isCompleted},result.Body);return isCompleted?result.IsPageBreakAfter()?LResult.PageBreakAfter(result.Size,head):LResult.Complete(result.Size,head):LResult.Split(result.Size,head,Arrange(result.Tail,makeResult))}},PreventOrphans:PreventOrphans$1,WithFooter:function WithFooter(head,footer,makeResult){if(!head)throw new LayoutError("ArgumentNullException: head");if(!footer)throw new LayoutError("ArgumentNullException: footer");return space=>{const tailSlice=footer(space);if(!tailSlice.IsCompleted())return LResult.Fail();let headSlice=head(space-tailSlice.Size);for(;headSlice&&headSlice.Tail&&headSlice.IsPageBreak();)headSlice=headSlice.Tail(space-tailSlice.Size);if(headSlice.IsCompleted()){const size=headSlice.Size+tailSlice.Size;return LResult.Complete(size,makeResult(size,headSlice,tailSlice))}for(headSlice=head(space);headSlice&&headSlice.Tail&&headSlice.IsPageBreak();)headSlice=headSlice.Tail(space);const size2=headSlice.Size,tail=headSlice.Tail&&headSlice.IsSplit()?WithFooter(headSlice.Tail,footer,makeResult):Convert(footer,(tr=>makeResult(tr.Size,null,tr)));return LResult.Split(size2,makeResult(size2,headSlice,null),tail)}},TakeAtLeast:function TakeAtLeast(layout,size,updateResult){if(!layout)throw new LayoutError("ArgumentNullException: layout");return space=>{const result=layout(space);if(result.IsFailed())return LResult.Fail();if(result.Size>=size)return ConvertResultBody(result,(d=>updateResult(null,d)));if(result.Tail&&result.IsPageBreak())return LResult.PageBreak(TakeAtLeast(result.Tail,size,updateResult));const sliceSize=Math.min(space,size),head=updateResult(sliceSize,result.Body),tail=result.Tail&&TakeAtLeast(result.Tail,size-sliceSize,updateResult);return LResult.SplitOrComplete(sliceSize,head,tail)}},Replicate:function(makeLayout,makeResult){let index=0;return space=>{let availableSpace=space,fillers=LazyList.nil,size=0;for(;availableSpace>0;){const slice=makeLayout(index)(availableSpace);if(!slice.IsCompleted())break;fillers=slice.Body?LazyList.cons(slice.Body,fillers):fillers,availableSpace-=slice.Size,size+=slice.Size,index++}fillers=fillers&&fillers.Reverse();const head=0===LazyList.count(fillers)?null:makeResult(size,fillers);return LResult.Complete(size,head)}},Clip:function Clip(size,layout,makeResult){if(!layout)throw new LayoutError("ArgumentNullException: layout");return space=>{if(space<size){const slice=layout(space);return slice.IsFailed()?LResult.Fail():slice.IsPageBreak()?LResult.PageBreak(Clip(size,slice.Tail,makeResult)):slice.IsCompleted()?slice.IsPageBreakAfter()?LResult.PageBreakAfter(slice.Size,makeResult(slice.Size,!1,slice.Body)):LResult.Complete(slice.Size,makeResult(slice.Size,!1,slice.Body)):LResult.Split(slice.Size,makeResult(slice.Size,!1,slice.Body),Clip(size-slice.Size,slice.Tail,makeResult))}const slice=layout(space);if(slice.IsPageBreakAfter())return slice.Size<=size?LResult.PageBreakAfter(slice.Size,makeResult(slice.Size,!1,slice.Body)):LResult.PageBreakAfter(size,makeResult(size,!0,slice.Body));if(slice.IsCompleted())return slice.Size<=size?LResult.Complete(slice.Size,makeResult(slice.Size,!1,slice.Body)):LResult.Complete(size,makeResult(size,!0,slice.Body));if(slice.IsPageBreak())return LResult.PageBreak(Clip(size,slice.Tail,makeResult));const forcedSlice=layout(1/0);return forcedSlice.IsFailed()?LResult.Fail():forcedSlice.IsPageBreakAfter()?forcedSlice.Size<=size?LResult.Fail():LResult.PageBreakAfter(size,makeResult(size,!0,forcedSlice.Body)):forcedSlice.IsCompleted()?forcedSlice.Size<=size?LResult.Fail():LResult.Complete(size,makeResult(size,!0,forcedSlice.Body)):forcedSlice.IsPageBreak()?LResult.PageBreak(Clip(size,forcedSlice.Tail,makeResult)):forcedSlice.Size<=size?LResult.Split(forcedSlice.Size,makeResult(forcedSlice.Size,!1,forcedSlice.Body),Clip(size-forcedSlice.Size,forcedSlice.Tail,makeResult)):LResult.Complete(size,makeResult(size,!0,forcedSlice.Body))}},Divisible:function Divisible(size,makeResult){return space=>space<0?LResult.Fail():space<size?LResult.Split(space,makeResult(space),Divisible(size-space,makeResult)):LResult.Complete(size,makeResult(size))},Zero:Zero,IsZero:IsZero,Convert:Convert,ConvertBody:function(layout,cnv){return Convert(layout,(res=>cnv(res.Body)))},Repeat:Repeat,RepeatFooter:RepeatFooter,ConvertSlice:function ConvertSlice(layout,cnv){if(!layout)throw new LayoutError("ArgumentNullException: layout");return space=>{const result=layout(space);if(result.IsFailed())return LResult.Fail();const tail=null!==result.Tail?ConvertSlice(result.Tail,cnv):null;if(result.IsPageBreak())return LResult.PageBreak(tail);const converted=cnv(result,space);return result.IsPageBreakAfter()?LResult.PageBreakAfter(converted.Size,converted.Body):result.IsCompleted()?LResult.Complete(converted.Size,converted.Body):LResult.Split(converted.Size,converted.Body,tail)}},ConvertFirstBody:function(layout,cnv){return ConvertFirst(layout,(r=>cnv(r.Body)))},ConvertLastBody:function(layout,cnv){return ConvertLast(layout,(r=>cnv(r.Body)))},PlaceAtEnd:function(layout,isSliced,shiftResult,makeResult){return space=>{const slice=layout(space);return slice.IsCompleted()?LResult.Complete(isSliced?0:space,shiftResult(space-slice.Size,slice.Body)):ConvertResultBody(slice,makeResult)}},PageBreakList:PageBreakList,PageBreakIterable:PageBreakIterable};class L2{static VerticalStack(list,makeStack,makeEmpty){return function(list,horzfiller,combine){return L.StackLazyList(list,((height,list1)=>L.Chop(list1&&list1.map((l1=>l1.Body)),(slices=>slices.map((slice=>slice.Tail||horzfiller(slice.Body.Height)))),((width,list2)=>combine(width,height,list2&&list2.map((lr=>lr.Body)).filter(isNotNull))))))}(list,(size=>()=>LResult.Complete(0,makeEmpty(0,size))),((w,h,items)=>makeStack("Vertical",w,h,items&&items.toArray())))}static HorizontalStack(list,makeStack){return function(list,combine){return L.ChopSplit(list,((height,list1)=>L.StackLazyList(list1&&list1.map((l1=>l1.Body)),((width,list2)=>combine(width,height,list2&&list2.map((lr=>lr.Body)))))))}(list,((w,h,items)=>makeStack("Horizontal",w,h,items&&items.toArray())))}static FixedLayout(item,width,height,makeFixed){return L2.Fixed(width,height,((w,h)=>makeFixed(item,w,h)))}static Fixed(width,height,result){return L.Fixed(height,(()=>L.Fixed(width,(()=>result(width,height)))))}static Page(header,body,footer,makeResult){if(!body)throw Error('ArgumentNullException("body")');return L.Group(header,body,footer,((height,result)=>L2.PageChop(result.Header&&result.Header.Body,result.Body.Body,result.Footer&&result.Footer.Body,((width,header2,body2,footer2)=>makeResult(width,height,[header2&&header2.Body,body2.Body,footer2&&footer2.Body].filter(isNotNull))))))}static PageBreak(layout,breakLocation){let l=layout;return"Start"!==breakLocation&&"StartAndEnd"!==breakLocation||(l=L.PageBreakBefore(l)),"End"!==breakLocation&&"StartAndEnd"!==breakLocation||(l=L.PageBreakAfter(l)),l}static Clip(layout,width,height,makeResult){return L.Clip(height,layout,((h,hClip,l)=>L.Clip(width,l,((w,wClip,f)=>hClip||wClip?makeResult(w,h,f):f))))}static ClipVertical(layout,height,makeResult){return L.Clip(height,layout,((h,hClip,l)=>hClip?L.ConvertBody(l,(t=>makeResult(h,t))):l))}static KeepTogether(pageSize){return layout=>L.KeepTogether(layout,pageSize.Height,(r=>L.KeepTogether(r.Body,pageSize.Width,(result2=>result2.Body))))}static PageChop(header,body,footer,makeResult){return space=>{if(space<=0)return LResult.Fail();const h=header?header(space):null;if(h&&h.IsFailed())return LResult.Fail();const b=body?body(space):null;if(null==b||b&&b.IsFailed())return LResult.Fail();const f=footer?footer(space):null;if(f&&f.IsFailed())return LResult.Fail();const pageSize=Math.max(Math.max(b.Size,h?h.Size:0),f?f.Size:0),result=makeResult(pageSize,h,b,f);return b.IsCompleted()?LResult.Complete(pageSize,result):LResult.Split(pageSize,result,L2.PageChop(header,b.Tail,footer,makeResult))}}static Arrange(layout,makeResult){return L.Arrange(layout,((vArrangement,layout2)=>L.Arrange(layout2,((hArrangement,fragment)=>{return makeResult(fragment,(vertical=vArrangement,{HFirst:(horizontal=hArrangement).First,VFirst:vertical.First,HLast:horizontal.Last,VLast:vertical.Last}));var vertical,horizontal}),!0)),!0)}static ArrangeAll(layout,makeResult){return L2.ConvertBody(layout,(f=>makeResult(f,{HFirst:!0,HLast:!0,VFirst:!0,VLast:!0})))}static Divisible(width,height,result){return L.Divisible(height,(h=>L.Divisible(width,(w=>result(w,h)))))}static ConvertBody(layout,cnv){return L.ConvertBody(layout,(lfunc=>lfunc&&L.ConvertBody(lfunc,cnv)))}static ConvertFirstBody(layout,cnv){return L.ConvertFirstBody(layout,(lfunc=>L.ConvertFirstBody(lfunc,cnv)))}static ConvertLastBody(layout,cnv){return L.ConvertLastBody(layout,(lfunc=>L.ConvertLastBody(lfunc,cnv)))}static Static(width,height,makeResult){return L.Static(height,null,null,0,((vArrangement,vspace,hoffset)=>L.Static(width,null,null,0,((hArrangement,hspace,voffset)=>makeResult(hspace,vspace,hoffset,voffset)))))}static StaticClipped(width,height,makeResult){return L.Static(height,null,null,0,((vArrangement,vspace,voffset)=>L.Static(width,null,null,0,((hArrangement,hspace,hoffset)=>makeResult({VisibleWidth:hspace,VisibleHeight:vspace,FullWidth:width,FullHeight:height,HOffset:hoffset,VOffset:voffset})))))}}function makeGetLayerClassName(rDef){return layerName=>{var _a;const targetDevices=(null===(_a=rDef.Layers.find((layer=>(layerName||"default")===layer.Name)))||void 0===_a?void 0:_a.TargetDevice.toLowerCase())||"";return targetDevices.includes("all")?"":["screen","paper","export"].filter((targetDevice=>!targetDevices.includes(targetDevice))).map((targetDevice=>`arjs-hide-${targetDevice}`)).join(" ")||""}}function CalculateColumnSize(columnCount,columnSpacing,containerWidth){if(columnSpacing<0)throw new InvalidReportDefinitionError("ArgumentException: columnSpacing");if(columnCount<2)throw new InvalidReportDefinitionError("ArgumentException: columnCount");const columnWidth=Math.floor((containerWidth-(columnCount-1)*columnSpacing)/columnCount);if(columnWidth<=columnSpacing)throw new InvalidReportDefinitionError("ArgumentException: containerWidth. Column width must be greater than zero and greater than column spacing.");return columnWidth}function Slice(cols,content,options){for(;null!==content&&cols.length<options.Count;){const col=content(options.Width);if(col.IsFailed())break;cols.push(col),content=col.Tail}return content}function layout$b(item,text,width,height,makeResult,measureHeight){let textBoxHeight=height;if(item.CanGrow||item.CanShrink){const textHeight=measureHeight();(textHeight>height&&item.CanGrow||textHeight<height&&item.CanShrink)&&(textBoxHeight=textHeight)}return L.Static(textBoxHeight,null,null,0,((vArrangement,vspace,voffset)=>L.Static(width,null,null,0,((hArrangement,hspace,hoffset)=>makeResult({VisibleWidth:hspace,VisibleHeight:vspace,FullWidth:width,FullHeight:textBoxHeight,HOffset:hoffset,VOffset:voffset},text)))))}function styleBuilder(){const staticStyle={},dynamicStyle={};return{add:(styleProp,args,modificator)=>{if(!modificator&&1!==args.length)throw new ReportCompilationError("Invalid style value");if(args.some((arg=>"function"==typeof arg)))dynamicStyle[styleProp]=modificator?(data,ctx)=>{const resolvedArgs=args.map((a=>resolveCompiled$1(a,data,ctx)));return resolvedArgs.some((arg=>"function"==typeof arg))?globals=>modificator&&modificator(...resolvedArgs.map((a=>"function"==typeof a?a(globals):a))):modificator&&modificator(...resolvedArgs)}:(data,ctx)=>{const resolvedArg=resolveCompiled$1(args[0],data,ctx);return"function"==typeof resolvedArg?globals=>resolvedArg(globals):resolvedArg};else{const value=modificator?modificator(...args):args[0];null!==value&&(staticStyle[styleProp]=value)}},get style(){return{static:staticStyle,dynamic:(data,ctx)=>{const resolvedDynamic=function(compiledStyle,data,ctx){const style={style:{},renderTimeStyle:{}};for(const propName of Object.keys(compiledStyle)){const value=compiledStyle[propName](data,ctx);null!==value&&("function"!=typeof value?style.style[propName]=value:style.renderTimeStyle[propName]=value)}return style}(dynamicStyle,data,ctx);return{style:resolvedDynamic.style,renderTimeStyle:Object.keys(resolvedDynamic.renderTimeStyle).length>0?globals=>function(compiledStyle,globals){const style={};for(const propName of Object.keys(compiledStyle)){const value=compiledStyle[propName];if(null!==value&&"function"==typeof value){const resolved=value(globals);null!==resolved&&(style[propName]=resolved)}}return style}(resolvedDynamic.renderTimeStyle,globals):null}}}}}}var es5={exports:{}};es5.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=90)}({17:function(e,t,r){t.__esModule=!0,t.default=void 0;var n=r(18),i=function(){function e(){}return e.getFirstMatch=function(e,t){var r=t.match(e);return r&&r.length>0&&r[1]||""},e.getSecondMatch=function(e,t){var r=t.match(e);return r&&r.length>1&&r[2]||""},e.matchAndReturnConst=function(e,t,r){if(e.test(t))return r},e.getWindowsVersionName=function(e){switch(e){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},e.getMacOSVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),10===t[0])switch(t[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},e.getAndroidVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),!(1===t[0]&&t[1]<5))return 1===t[0]&&t[1]<6?"Cupcake":1===t[0]&&t[1]>=6?"Donut":2===t[0]&&t[1]<2?"Eclair":2===t[0]&&2===t[1]?"Froyo":2===t[0]&&t[1]>2?"Gingerbread":3===t[0]?"Honeycomb":4===t[0]&&t[1]<1?"Ice Cream Sandwich":4===t[0]&&t[1]<4?"Jelly Bean":4===t[0]&&t[1]>=4?"KitKat":5===t[0]?"Lollipop":6===t[0]?"Marshmallow":7===t[0]?"Nougat":8===t[0]?"Oreo":9===t[0]?"Pie":void 0},e.getVersionPrecision=function(e){return e.split(".").length},e.compareVersions=function(t,r,n){void 0===n&&(n=!1);var i=e.getVersionPrecision(t),s=e.getVersionPrecision(r),a=Math.max(i,s),o=0,u=e.map([t,r],(function(t){var r=a-e.getVersionPrecision(t),n=t+new Array(r+1).join(".0");return e.map(n.split("."),(function(e){return new Array(20-e.length).join("0")+e})).reverse()}));for(n&&(o=a-Math.min(i,s)),a-=1;a>=o;){if(u[0][a]>u[1][a])return 1;if(u[0][a]===u[1][a]){if(a===o)return 0;a-=1}else if(u[0][a]<u[1][a])return-1}},e.map=function(e,t){var r,n=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(r=0;r<e.length;r+=1)n.push(t(e[r]));return n},e.find=function(e,t){var r,n;if(Array.prototype.find)return Array.prototype.find.call(e,t);for(r=0,n=e.length;r<n;r+=1){var i=e[r];if(t(i,r))return i}},e.assign=function(e){for(var t,r,n=e,i=arguments.length,s=new Array(i>1?i-1:0),a=1;a<i;a++)s[a-1]=arguments[a];if(Object.assign)return Object.assign.apply(Object,[e].concat(s));var o=function(){var e=s[t];"object"==typeof e&&null!==e&&Object.keys(e).forEach((function(t){n[t]=e[t]}))};for(t=0,r=s.length;t<r;t+=1)o();return e},e.getBrowserAlias=function(e){return n.BROWSER_ALIASES_MAP[e]},e.getBrowserTypeByAlias=function(e){return n.BROWSER_MAP[e]||""},e}();t.default=i,e.exports=t.default},18:function(e,t,r){t.__esModule=!0,t.ENGINE_MAP=t.OS_MAP=t.PLATFORMS_MAP=t.BROWSER_MAP=t.BROWSER_ALIASES_MAP=void 0,t.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},t.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},t.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},t.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},t.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(e,t,r){t.__esModule=!0,t.default=void 0;var n,i=(n=r(91))&&n.__esModule?n:{default:n},s=r(18);function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(){}var t,r,n;return e.getParser=function(e,t){if(void 0===t&&(t=!1),"string"!=typeof e)throw new Error("UserAgent should be a string");return new i.default(e,t)},e.parse=function(e){return new i.default(e).getResult()},t=e,n=[{key:"BROWSER_MAP",get:function(){return s.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return s.ENGINE_MAP}},{key:"OS_MAP",get:function(){return s.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return s.PLATFORMS_MAP}}],(r=null)&&a(t.prototype,r),n&&a(t,n),e}();t.default=o,e.exports=t.default},91:function(e,t,r){t.__esModule=!0,t.default=void 0;var n=u(r(92)),i=u(r(93)),s=u(r(94)),a=u(r(95)),o=u(r(17));function u(e){return e&&e.__esModule?e:{default:e}}var d=function(){function e(e,t){if(void 0===t&&(t=!1),null==e||""===e)throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},!0!==t&&this.parse()}var t=e.prototype;return t.getUA=function(){return this._ua},t.test=function(e){return e.test(this._ua)},t.parseBrowser=function(){var e=this;this.parsedResult.browser={};var t=o.default.find(n.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.browser=t.describe(this.getUA())),this.parsedResult.browser},t.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},t.getBrowserName=function(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},t.getBrowserVersion=function(){return this.getBrowser().version},t.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},t.parseOS=function(){var e=this;this.parsedResult.os={};var t=o.default.find(i.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.os=t.describe(this.getUA())),this.parsedResult.os},t.getOSName=function(e){var t=this.getOS().name;return e?String(t).toLowerCase()||"":t||""},t.getOSVersion=function(){return this.getOS().version},t.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},t.getPlatformType=function(e){void 0===e&&(e=!1);var t=this.getPlatform().type;return e?String(t).toLowerCase()||"":t||""},t.parsePlatform=function(){var e=this;this.parsedResult.platform={};var t=o.default.find(s.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.platform=t.describe(this.getUA())),this.parsedResult.platform},t.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},t.getEngineName=function(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},t.parseEngine=function(){var e=this;this.parsedResult.engine={};var t=o.default.find(a.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.engine=t.describe(this.getUA())),this.parsedResult.engine},t.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},t.getResult=function(){return o.default.assign({},this.parsedResult)},t.satisfies=function(e){var t=this,r={},n=0,i={},s=0;if(Object.keys(e).forEach((function(t){var a=e[t];"string"==typeof a?(i[t]=a,s+=1):"object"==typeof a&&(r[t]=a,n+=1)})),n>0){var a=Object.keys(r),u=o.default.find(a,(function(e){return t.isOS(e)}));if(u){var d=this.satisfies(r[u]);if(void 0!==d)return d}var c=o.default.find(a,(function(e){return t.isPlatform(e)}));if(c){var f=this.satisfies(r[c]);if(void 0!==f)return f}}if(s>0){var l=Object.keys(i),h=o.default.find(l,(function(e){return t.isBrowser(e,!0)}));if(void 0!==h)return this.compareVersion(i[h])}},t.isBrowser=function(e,t){void 0===t&&(t=!1);var r=this.getBrowserName().toLowerCase(),n=e.toLowerCase(),i=o.default.getBrowserTypeByAlias(n);return t&&i&&(n=i.toLowerCase()),n===r},t.compareVersion=function(e){var t=[0],r=e,n=!1,i=this.getBrowserVersion();if("string"==typeof i)return">"===e[0]||"<"===e[0]?(r=e.substr(1),"="===e[1]?(n=!0,r=e.substr(2)):t=[],">"===e[0]?t.push(1):t.push(-1)):"="===e[0]?r=e.substr(1):"~"===e[0]&&(n=!0,r=e.substr(1)),t.indexOf(o.default.compareVersions(i,r,n))>-1},t.isOS=function(e){return this.getOSName(!0)===String(e).toLowerCase()},t.isPlatform=function(e){return this.getPlatformType(!0)===String(e).toLowerCase()},t.isEngine=function(e){return this.getEngineName(!0)===String(e).toLowerCase()},t.is=function(e,t){return void 0===t&&(t=!1),this.isBrowser(e,t)||this.isOS(e)||this.isPlatform(e)},t.some=function(e){var t=this;return void 0===e&&(e=[]),e.some((function(e){return t.is(e)}))},e}();t.default=d,e.exports=t.default},92:function(e,t,r){t.__esModule=!0,t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},s=/version\/(\d+(\.?_?\d+)+)/i,a=[{test:[/googlebot/i],describe:function(e){var t={name:"Googlebot"},r=i.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,e)||i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/opera/i],describe:function(e){var t={name:"Opera"},r=i.default.getFirstMatch(s,e)||i.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/opr\/|opios/i],describe:function(e){var t={name:"Opera"},r=i.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,e)||i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/SamsungBrowser/i],describe:function(e){var t={name:"Samsung Internet for Android"},r=i.default.getFirstMatch(s,e)||i.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/Whale/i],describe:function(e){var t={name:"NAVER Whale Browser"},r=i.default.getFirstMatch(s,e)||i.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/MZBrowser/i],describe:function(e){var t={name:"MZ Browser"},r=i.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/focus/i],describe:function(e){var t={name:"Focus"},r=i.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/swing/i],describe:function(e){var t={name:"Swing"},r=i.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/coast/i],describe:function(e){var t={name:"Opera Coast"},r=i.default.getFirstMatch(s,e)||i.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(e){var t={name:"Opera Touch"},r=i.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/yabrowser/i],describe:function(e){var t={name:"Yandex Browser"},r=i.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/ucbrowser/i],describe:function(e){var t={name:"UC Browser"},r=i.default.getFirstMatch(s,e)||i.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/Maxthon|mxios/i],describe:function(e){var t={name:"Maxthon"},r=i.default.getFirstMatch(s,e)||i.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/epiphany/i],describe:function(e){var t={name:"Epiphany"},r=i.default.getFirstMatch(s,e)||i.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/puffin/i],describe:function(e){var t={name:"Puffin"},r=i.default.getFirstMatch(s,e)||i.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/sleipnir/i],describe:function(e){var t={name:"Sleipnir"},r=i.default.getFirstMatch(s,e)||i.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/k-meleon/i],describe:function(e){var t={name:"K-Meleon"},r=i.default.getFirstMatch(s,e)||i.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/micromessenger/i],describe:function(e){var t={name:"WeChat"},r=i.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/qqbrowser/i],describe:function(e){var t={name:/qqbrowserlite/i.test(e)?"QQ Browser Lite":"QQ Browser"},r=i.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/msie|trident/i],describe:function(e){var t={name:"Internet Explorer"},r=i.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/\sedg\//i],describe:function(e){var t={name:"Microsoft Edge"},r=i.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/edg([ea]|ios)/i],describe:function(e){var t={name:"Microsoft Edge"},r=i.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/vivaldi/i],describe:function(e){var t={name:"Vivaldi"},r=i.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/seamonkey/i],describe:function(e){var t={name:"SeaMonkey"},r=i.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/sailfish/i],describe:function(e){var t={name:"Sailfish"},r=i.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,e);return r&&(t.version=r),t}},{test:[/silk/i],describe:function(e){var t={name:"Amazon Silk"},r=i.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/phantom/i],describe:function(e){var t={name:"PhantomJS"},r=i.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/slimerjs/i],describe:function(e){var t={name:"SlimerJS"},r=i.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t={name:"BlackBerry"},r=i.default.getFirstMatch(s,e)||i.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t={name:"WebOS Browser"},r=i.default.getFirstMatch(s,e)||i.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/bada/i],describe:function(e){var t={name:"Bada"},r=i.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/tizen/i],describe:function(e){var t={name:"Tizen"},r=i.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/qupzilla/i],describe:function(e){var t={name:"QupZilla"},r=i.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/firefox|iceweasel|fxios/i],describe:function(e){var t={name:"Firefox"},r=i.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/electron/i],describe:function(e){var t={name:"Electron"},r=i.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/MiuiBrowser/i],describe:function(e){var t={name:"Miui"},r=i.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/chromium/i],describe:function(e){var t={name:"Chromium"},r=i.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/chrome|crios|crmo/i],describe:function(e){var t={name:"Chrome"},r=i.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/GSA/i],describe:function(e){var t={name:"Google Search"},r=i.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:function(e){var t=!e.test(/like android/i),r=e.test(/android/i);return t&&r},describe:function(e){var t={name:"Android Browser"},r=i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/playstation 4/i],describe:function(e){var t={name:"PlayStation 4"},r=i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/safari|applewebkit/i],describe:function(e){var t={name:"Safari"},r=i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/.*/i],describe:function(e){var t=-1!==e.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:i.default.getFirstMatch(t,e),version:i.default.getSecondMatch(t,e)}}}];t.default=a,e.exports=t.default},93:function(e,t,r){t.__esModule=!0,t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},s=r(18),a=[{test:[/Roku\/DVP/],describe:function(e){var t=i.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,e);return{name:s.OS_MAP.Roku,version:t}}},{test:[/windows phone/i],describe:function(e){var t=i.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,e);return{name:s.OS_MAP.WindowsPhone,version:t}}},{test:[/windows /i],describe:function(e){var t=i.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,e),r=i.default.getWindowsVersionName(t);return{name:s.OS_MAP.Windows,version:t,versionName:r}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(e){var t={name:s.OS_MAP.iOS},r=i.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,e);return r&&(t.version=r),t}},{test:[/macintosh/i],describe:function(e){var t=i.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,e).replace(/[_\s]/g,"."),r=i.default.getMacOSVersionName(t),n={name:s.OS_MAP.MacOS,version:t};return r&&(n.versionName=r),n}},{test:[/(ipod|iphone|ipad)/i],describe:function(e){var t=i.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,e).replace(/[_\s]/g,".");return{name:s.OS_MAP.iOS,version:t}}},{test:function(e){var t=!e.test(/like android/i),r=e.test(/android/i);return t&&r},describe:function(e){var t=i.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,e),r=i.default.getAndroidVersionName(t),n={name:s.OS_MAP.Android,version:t};return r&&(n.versionName=r),n}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t=i.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,e),r={name:s.OS_MAP.WebOS};return t&&t.length&&(r.version=t),r}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t=i.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,e)||i.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,e)||i.default.getFirstMatch(/\bbb(\d+)/i,e);return{name:s.OS_MAP.BlackBerry,version:t}}},{test:[/bada/i],describe:function(e){var t=i.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,e);return{name:s.OS_MAP.Bada,version:t}}},{test:[/tizen/i],describe:function(e){var t=i.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,e);return{name:s.OS_MAP.Tizen,version:t}}},{test:[/linux/i],describe:function(){return{name:s.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:s.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(e){var t=i.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,e);return{name:s.OS_MAP.PlayStation4,version:t}}}];t.default=a,e.exports=t.default},94:function(e,t,r){t.__esModule=!0,t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},s=r(18),a=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(e){var t=i.default.getFirstMatch(/(can-l01)/i,e)&&"Nova",r={type:s.PLATFORMS_MAP.mobile,vendor:"Huawei"};return t&&(r.model=t),r}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:s.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:s.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:s.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:s.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:s.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:s.PLATFORMS_MAP.tablet}}},{test:function(e){var t=e.test(/ipod|iphone/i),r=e.test(/like (ipod|iphone)/i);return t&&!r},describe:function(e){var t=i.default.getFirstMatch(/(ipod|iphone)/i,e);return{type:s.PLATFORMS_MAP.mobile,vendor:"Apple",model:t}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:s.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:s.PLATFORMS_MAP.mobile}}},{test:function(e){return"blackberry"===e.getBrowserName(!0)},describe:function(){return{type:s.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(e){return"bada"===e.getBrowserName(!0)},describe:function(){return{type:s.PLATFORMS_MAP.mobile}}},{test:function(e){return"windows phone"===e.getBrowserName()},describe:function(){return{type:s.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(e){var t=Number(String(e.getOSVersion()).split(".")[0]);return"android"===e.getOSName(!0)&&t>=3},describe:function(){return{type:s.PLATFORMS_MAP.tablet}}},{test:function(e){return"android"===e.getOSName(!0)},describe:function(){return{type:s.PLATFORMS_MAP.mobile}}},{test:function(e){return"macos"===e.getOSName(!0)},describe:function(){return{type:s.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(e){return"windows"===e.getOSName(!0)},describe:function(){return{type:s.PLATFORMS_MAP.desktop}}},{test:function(e){return"linux"===e.getOSName(!0)},describe:function(){return{type:s.PLATFORMS_MAP.desktop}}},{test:function(e){return"playstation 4"===e.getOSName(!0)},describe:function(){return{type:s.PLATFORMS_MAP.tv}}},{test:function(e){return"roku"===e.getOSName(!0)},describe:function(){return{type:s.PLATFORMS_MAP.tv}}}];t.default=a,e.exports=t.default},95:function(e,t,r){t.__esModule=!0,t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},s=r(18),a=[{test:function(e){return"microsoft edge"===e.getBrowserName(!0)},describe:function(e){if(/\sedg\//i.test(e))return{name:s.ENGINE_MAP.Blink};var t=i.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,e);return{name:s.ENGINE_MAP.EdgeHTML,version:t}}},{test:[/trident/i],describe:function(e){var t={name:s.ENGINE_MAP.Trident},r=i.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:function(e){return e.test(/presto/i)},describe:function(e){var t={name:s.ENGINE_MAP.Presto},r=i.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:function(e){var t=e.test(/gecko/i),r=e.test(/like gecko/i);return t&&!r},describe:function(e){var t={name:s.ENGINE_MAP.Gecko},r=i.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:s.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(e){var t={name:s.ENGINE_MAP.WebKit},r=i.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}}];t.default=a,e.exports=t.default}});const isBrowser="undefined"!=typeof window&&window.document,browserEngineName=isBrowser?es5.exports.parse(window.navigator.userAgent).engine.name:null,environment=isBrowser?(null==browserEngineName?void 0:browserEngineName.match(/Gecko/i))?"firefox":(null==browserEngineName?void 0:browserEngineName.match(/Blink/i))?"chrome":(null==browserEngineName?void 0:browserEngineName.match(/WebKit/i))?"safari":"other":"node",buildSizeStyle=itemViewSize=>({width:Length.toCss(itemViewSize.FullWidth),height:Length.toCss(itemViewSize.FullHeight),left:`-${Length.toCss(itemViewSize.HOffset)}`,top:`-${Length.toCss(itemViewSize.VOffset)}`});function wrapSplittedItem(itemViewSize,content){return itemViewSize.VisibleWidth===itemViewSize.FullWidth&&itemViewSize.VisibleHeight===itemViewSize.FullHeight?content:h("div",{className:"arjs-hideOverflow",style:{width:Length.toCss(itemViewSize.VisibleWidth),height:Length.toCss(itemViewSize.VisibleHeight)},patcher:content.properties.patcher},[content])}function fillLineBreaks(value){const lines=(null!=value?value:"").toString().replace(/ +/g," ").replace("\r","").split("\n");for(let i=lines.length-1;i>0;i--)lines.splice(i,""===lines[i]?1:0,h("br",[]));return""===lines[0]&&lines.splice(0,1),lines}const makeRenderTabs=makeTabFragment=>{const renderTabsImpl=(text,tabSize="0.5in")=>{const tabIndex=text.indexOf("\t");if(tabIndex<0)return[text];const preTabText=text.substr(0,tabIndex),tabWordIndex=preTabText.lastIndexOf(" ")+1,resultParts=0===tabWordIndex?[]:[preTabText.substr(0,tabWordIndex)],tabText=0===tabWordIndex?preTabText:preTabText.substr(tabWordIndex);resultParts.push(makeTabFragment(tabText,tabSize));const postSpanText=text.substr(tabIndex+1);return postSpanText.length>0&&resultParts.push(...renderTabsImpl(postSpanText,tabSize)),resultParts};return renderTabsImpl},wrapUpright=(regex,makeChild)=>(str,index)=>{if("string"!=typeof str)return str;const result=[];let prevIndex=0,matches=regex.exec(str);for(;matches;)prevIndex!==matches.index&&result.push(str.slice(prevIndex,matches.index)),result.push(makeChild(matches[0])),prevIndex=regex.lastIndex,matches=regex.exec(str);return prevIndex<str.length&&result.push(str.slice(prevIndex)),result},getDisplayValue=(textContent,writingMode,uprightInVerticalText,makeChild)=>{if("tb-rl"===writingMode){if("Digits"===uprightInVerticalText)return flatten(textContent.map(wrapUpright(/(-|\+|\(|\[|\{)*[\d.,]*[\d]+[\d.,]*(%|\)|\]|\})*/g,makeChild)));if("DigitsAndLatinLetters"===uprightInVerticalText)return flatten(textContent.map(wrapUpright(/(-|\+|\(|\[|\{)*[\w.,]*[\d]+[\w.,]*(%|\)|\]|\})*/g,makeChild)))}return textContent},joinClassNames=(...classNames)=>classNames.filter(Boolean).join(" "),addActionAttribute=(vnode,action)=>{if(action){const dataAttrValue=buildActionAttr(action);dataAttrValue.Type&&(vnode.properties.className=joinClassNames(vnode.properties.className,"arjs-action"),vnode.properties.attributes=Object.assign(Object.assign({},vnode.properties.attributes),{"data-action":JSON.stringify(dataAttrValue)}))}},zeroRect={width:0,height:0};let measurerInstance=null;const renderTabs$3=makeRenderTabs((function(tabText,tabSize){const span=document.createElement("span");return span.className="arjs-text-tab",span.textContent=0===tabText.length?tabText:`${tabText}\xa0`,span.style.minWidth=tabSize,span}));function getMeasurer(){return null!=measurerInstance?measurerInstance:measurerInstance=function(){const doc=document,wrapper=doc.createElement("div");wrapper.style.position="absolute",wrapper.style.display="none",wrapper.style.width="9999px",wrapper.style.left="0px",wrapper.style.top="0px",wrapper.style.visibility="hidden";const container=doc.createElement("div");container.style.position="absolute",container.style.left="0px",container.style.top="0px",container.style.textRendering="optimizeSpeed",wrapper.appendChild(container),doc.body.appendChild(wrapper);let currentContent=null;const clearContent=()=>{currentContent&&(container.removeChild(currentContent),currentContent=null)};return{enable:()=>{wrapper.style.display="block"},disable:()=>{wrapper.style.display="none"},setContent:content=>{clearContent(),currentContent=content,container.appendChild(currentContent)},clearContent:clearContent,setMaxWidth:cssWidth=>{container.style.maxWidth=cssWidth},getRect:()=>{var _a;return null!==(_a=null==currentContent?void 0:currentContent.getBoundingClientRect())&&void 0!==_a?_a:zeroRect}}}()}function withMeasurer(content,fn){const measurer=getMeasurer();measurer.setContent(content),measurer.enable();const result=fn(measurer);return measurer.disable(),measurer.clearContent(),result}let sortIconSize=null;function getSortIconSize(){return null===sortIconSize&&(sortIconSize=getIconSize("arjs-action arjs-control arjs-sort-placeholder")),sortIconSize}let toggleIconSize=null;function getToggleIconSize(){return null===toggleIconSize&&(toggleIconSize=getIconSize("arjs-action arjs-control arjs-toggle-placeholder")),toggleIconSize}function getIconSize(className){const icon=document.createElement("span");return icon.className=className,withMeasurer(icon,(measurer=>{measurer.setMaxWidth("none");const rect=measurer.getRect();return{Width:Length.fromPixels(rect.width),Height:Length.fromPixels(rect.height)}}))}function MeasureTextBoxSizeDOM$1(style,text,width,isToggle,isSorter,tabSize){const innerContent=text.replace("\r","").split("\n");for(let i=innerContent.length-1;i>0;i--)innerContent.splice(i,0,document.createElement("br"));for(let i=innerContent.length-1;i>=0;i--){const item=innerContent[i];"string"==typeof item&&innerContent.splice(i,1,...renderTabs$3(item,tabSize))}const splittedInnerContent=getDisplayValue(innerContent,style.writingMode,style.uprightInVerticalText,(value=>{const span=document.createElement("span");return span.className="arjs-upright",span.appendChild(document.createTextNode(value)),span})),div=document.createElement("div");splittedInnerContent.forEach((c=>div.appendChild("string"==typeof c?document.createTextNode(c):c))),Object.assign(div.style,style,{position:""});let reservedWidth=0,minHeight=0;isSorter&&(reservedWidth+=getSortIconSize().Width,minHeight=Math.max(minHeight,getSortIconSize().Height)),isToggle&&(reservedWidth+=getToggleIconSize().Width,minHeight=Math.max(minHeight,getToggleIconSize().Height));const size=(content=div,areaWidth=null!==width?Math.max(0,width-reservedWidth):null,withMeasurer(content,(measurer=>{measurer.setMaxWidth(null!==areaWidth?Length.toCss(areaWidth):"none");const rect=measurer.getRect();return{Height:Length.fromPixels(rect.height),Width:Length.fromPixels(rect.width)}})));var content,areaWidth;return{Height:Math.max(minHeight,size.Height),Width:Math.max(reservedWidth,size.Width)}}let cache=new Map;const emptySize={Width:0,Height:0};function MeasureTextBoxSize(style,text,width,isToggle=!1,isSorter=!1,tabSize){if("node"===environment)return emptySize;const key=function(style,text,width,isToggle,isSorter){const styleHash=`${style.paddingLeft}${style.paddingTop}${style.paddingRight}${style.paddingBottom}${style.fontFamily}${style.fontStyle}${style.fontSize}${style.fontWeight}${style.lineHeight}${style.letterSpacing}${style.wordWrap}${style.wordBreak}${style.transform}${style.writingMode}${style.uprightInVerticalText}`;return`${text}_${width}_${styleHash}_${isToggle?"t":""}${isSorter?"s":""}`}(style,text,width,isToggle,isSorter),cachedResult=cache.get(key);if(cachedResult)return cachedResult;const size=MeasureTextBoxSizeDOM$1(style,text,width,isToggle,isSorter,tabSize);return function(key,value){cache.set(key,value),cache.size>1e4&&(cache=new Map(function(map){return[...map.entries()]}(cache).slice(cache.size-1e3)))}(key,size),size}function MeasureTextBoxHeight(style,text,width,isToggle=!1,isSorter=!1,tabSize){return MeasureTextBoxSize(style,text,width,isToggle,isSorter,tabSize).Height}const getFontStyle$1=value=>value&&toString$1(value).toLowerCase(),getFlexVerticalAlign=(value,angle,writingMode,minCondenseRate)=>{const swap=isVerticalText(writingMode,minCondenseRate);if(0!==Number(angle))return swap?"flex-end":"flex-start";switch(toString$1(value).toLowerCase()){case"middle":return"center";case"bottom":return swap?"flex-start":"flex-end";default:return swap?"flex-end":"flex-start"}},getFlexDirection=(writingMode,minCondenseRate)=>isVerticalText(writingMode,minCondenseRate)?"column":"row",getFontWeight$3=value=>{if(!value)return"normal";const lowerValue=toString$1(value).toLowerCase(),id=fontWeightMap$1[lowerValue];if(400===id||0===id||1e3===id)return lowerValue;if(id)return id.toString();const numericValue=parseInt(lowerValue);return isNaN(numericValue)?"normal":numericValue.toString()},fontWeightMap$1={lighter:0,thin:100,extralight:200,light:300,normal:400,medium:500,semibold:600,bold:700,extrabold:800,heavy:900,bolder:1e3},getTextDecoration$3=value=>{if(!value)return"none";const lowerValue=toString$1(value).toLowerCase();return"linethrough"===lowerValue?"line-through":"doubleunderline"===lowerValue?"underline":lowerValue},getTextDecorationStyle=value=>"doubleunderline"===toString$1(value).toLowerCase()?"double":null,getTextAlign$1=(textAlign,direction,format,value)=>{let result=toString$1(textAlign).toLowerCase();if("general"===result&&(result=((value,format)=>"number"==typeof value||!(!value||!dateTimeFactory_isDateTime(value)&&!shouldTreatAsDate(value,format)))(value,format)?"right":"left"),"rtl"===toString$1(direction).toLowerCase()){if("left"===result)return"right";if("right"===result)return"left"}return result},getTextAlignLast=(textAlign,direction,textJustify,format,value)=>"distributealllines"===toString$1(textJustify).toLowerCase()&&"justify"===getTextAlign$1(textAlign,direction,format,value)?"justify":null,getTextJustify=textJustify=>"distributealllines"===toString$1(textJustify).toLowerCase()?"distribute":textJustify,getLineHeight=(lineSpacing,fontSize)=>{if(!lineSpacing)return"firefox"===environment?"1.15em":null;const fontLineSpacingPx=1.15*Length.parse(fontSize),lineSpacingPx=Length.parse(lineSpacing);return`${Math.round(100*(1+lineSpacingPx/fontLineSpacingPx))}%`},getWordWrap=wrapMode=>"WordWrap"===wrapMode?"break-word":"normal",getWordBreak=wrapMode=>"CharWrap"===wrapMode?"break-all":"normal",getWhiteSpace=wrapMode=>"NoWrap"===wrapMode?"nowrap":"normal",wrapWithQuotes=value=>value&&value.match(/"/)?`'${value.trim()}'`:`"${value.trim()}"`,isVerticalText=(writingMode,minCondenseRate)=>{const value=getWritingMode(writingMode,minCondenseRate).toLowerCase();return value.startsWith("tb")||value.startsWith("vertical")},getWritingMode=(writingMode,minCondenseRate)=>minCondenseRate&&1!==minCondenseRate?"lr-tb":toString$1(writingMode);function getFontSizeStyle(style,size,value,isToggle,isSorter){return{fontSize:getShrinkedFontSize({Width:size.FullWidth,Height:size.FullHeight},style.fontSize,(fontSize=>"nowrap"===style.whiteSpace?MeasureTextBoxSize(Object.assign(Object.assign({},style),{fontSize:fontSize}),value||"",null,isToggle,isSorter):MeasureTextBoxSize(Object.assign(Object.assign({},style),{fontSize:fontSize}),value||"",size.FullWidth,isToggle,isSorter).Height))}}function getShrinkedFontSize(layoutAreaSize,initialFontSize,shrinkMeasurer){let counter=0;const isTooSmall=size=>"number"!=typeof size?size.Height<=layoutAreaSize.Height&&size.Width<=layoutAreaSize.Width:size<=layoutAreaSize.Height;let fontSize=initialFontSize,measuredSize=shrinkMeasurer(fontSize);if(isTooSmall(measuredSize))return fontSize;let fontSizeTwips=Length.parse(fontSize);for(;("number"!=typeof(size=measuredSize)?size.Height>layoutAreaSize.Height||size.Width>layoutAreaSize.Width:size>layoutAreaSize.Height)&&counter<100&&fontSizeTwips>=40;)fontSizeTwips-=20,fontSize=Length.toCss(fontSizeTwips),measuredSize=shrinkMeasurer(fontSize),counter++;var size;let previousSize=fontSize;for(;isTooSmall(measuredSize)&&counter<100;)previousSize=fontSize,fontSizeTwips+=5,fontSize=Length.toCss(fontSizeTwips),measuredSize=shrinkMeasurer(fontSize),counter++;return previousSize}function getCondenseRateStyle(style,size,minCondenseRate,value,isToggle,isSorter){const paddingsWidth=Length.parse(style.paddingLeft||"0pt")+Length.parse(style.paddingRight||"0pt"),iconsWidth=(isToggle?getToggleIconSize().Width:0)+(isSorter?getSortIconSize().Width:0),itemWidth=size.FullWidth-paddingsWidth-iconsWidth,originalSize=MeasureTextBoxSize(Object.assign(Object.assign({},style),{paddingLeft:"0pt",paddingRight:"0pt",paddingTop:"0pt",paddingBottom:"0pt"}),value||"",itemWidth/minCondenseRate,isToggle,isSorter),condenseRate=Math.floor(itemWidth/originalSize.Width*100)/100;return Math.max(condenseRate,minCondenseRate)}function createTranslation(xPosition,yPosition){return{M11:1,M12:0,M21:0,M22:1,M31:xPosition,M32:yPosition}}function multiply(value1,value2){return{M11:value1.M11*value2.M11+value1.M12*value2.M21,M12:value1.M11*value2.M12+value1.M12*value2.M22,M21:value1.M21*value2.M11+value1.M22*value2.M21,M22:value1.M21*value2.M12+value1.M22*value2.M22,M31:value1.M31*value2.M11+value1.M32*value2.M21+value2.M31,M32:value1.M31*value2.M12+value1.M32*value2.M22+value2.M32}}function getTransform(textAngle,horAlignment,verAlignment,reportItemBounds,textBounds){let angle=textAngle%360;angle<0&&(angle+=360);const radians=angle*Math.PI/180;let minWidth,minHeight;if(Math.abs(angle)%180==90)return{angle:angle};{minWidth=Math.min(textBounds.Width,reportItemBounds.Width),minHeight=Math.min(textBounds.Height,reportItemBounds.Height);const bounds=function(source,rad){const sin=Math.sin(rad),cos=Math.cos(rad),points=[{x:0,y:0},{x:0,y:source.Height},{x:source.Width,y:0},{x:source.Width,y:source.Height}].map((p=>({x:p.x*cos-p.y*sin,y:p.x*sin+p.y*cos}))),hor=[...points].sort(((a,b)=>a.x-b.x)),ver=[...points].sort(((a,b)=>a.y-b.y));return{Left:hor[0].x,Top:ver[0].y,Width:hor[3].x-hor[0].x,Height:ver[3].y-ver[0].y}}({Width:minWidth,Height:minHeight},radians),horizontalAlignment=getHorAlignment(horAlignment),verticalAlignment=getVerAlignment(verAlignment),transOrigin={Left:0,Top:0},topLeftMost={Left:bounds.Left,Top:bounds.Top};let offsetY=0,offsetX=0;if("Near"!==verticalAlignment){const cosval=Math.cos(-radians),sinval=Math.sin(-radians),outRect=reportItemBounds;"Far"===verticalAlignment?offsetY=outRect.Height-bounds.Height:"Center"===verticalAlignment&&(offsetY=(outRect.Height-bounds.Height)/2),offsetX=-offsetY*sinval,offsetY*=cosval}const alignmentOffset={Left:"Far"===horizontalAlignment?reportItemBounds.Width-bounds.Width:"Center"===horizontalAlignment?(reportItemBounds.Width-bounds.Width)/2:0,Top:0};let transform={M11:1,M12:0,M21:0,M22:1,M31:0,M32:0};return transform=multiply(transform,createTranslation(-transOrigin.Left,-transOrigin.Top)),transform=multiply(transform,function(rad){const sin=Math.sin(rad),cos=Math.cos(rad);return{M11:cos,M12:sin,M21:-sin,M22:cos,M31:0,M32:0}}(radians)),transform=multiply(transform,createTranslation(transOrigin.Left-topLeftMost.Left+alignmentOffset.Left-offsetX,transOrigin.Top-topLeftMost.Top-offsetY)),{offsetX:Length.toCss(transform.M31),offsetY:Length.toCss(transform.M32),angle:angle}}}const getHorAlignment=value=>{if("string"!=typeof value)return"Near";switch(value.toLowerCase()){case"right":return"Far";case"center":return"Center";default:return"Near"}},getVerAlignment=value=>{if("string"!=typeof value)return"Near";switch(value.toLowerCase()){case"bottom":return"Far";case"middle":return"Center";default:return"Near"}};class PaginationService{constructor(pageIndex,sections={},totals={Main:"?",Cumulative:"?",Sections:{}}){this.pageIndex=pageIndex,this.sections=sections,this.totals=totals,this.GetMain=()=>({PageIndex:this.pageIndex,TotalPages:this.totals.Main}),this.GetCumulative=()=>this.GetMain(),this.GetSection=sectionId=>{const sectionKeys=Object.keys(this.sections);if(void 0===sectionId&&1===sectionKeys.length)sectionId=sectionKeys[0];else if(void 0===sectionId)return this.GetMain();const sectionInfo=this.sections[sectionId];return sectionInfo?{PageIndex:sectionInfo.PageIndex,TotalPages:this.totals.Sections[sectionId]||"?"}:this.GetMain()},this.Next=(openedSections=[],closedSections=[])=>{const toNext=function(dictionary,predicate){const filtered={};for(const key in dictionary)predicate(key,dictionary[key])&&(filtered[key]=dictionary[key]);return filtered}(this.sections,((k,v)=>!v.IsComplete));for(const sect of openedSections)toNext[sect]={PageIndex:-1,IsComplete:!1};const nextSections=mapValues$1(toNext,((v,k)=>({PageIndex:v.PageIndex+1,IsComplete:closedSections.indexOf(k)>=0})));for(const section of closedSections)this.totals.Sections[section]=nextSections[section].PageIndex+1;return new PaginationService(this.pageIndex+1,nextSections,this.totals)},this.Complete=()=>(this.totals.Main=this.pageIndex+1,this)}static init(){return new PaginationService(-1)}}const baseSortIcon="arjs-action arjs-control ",sortControllerClassName={NoSort:baseSortIcon+"arjs-sort-variant",Ascending:baseSortIcon+"arjs-sort-ascending",Descending:baseSortIcon+"arjs-sort-descending"},renderTabs$2=makeRenderTabs(((tabText,tabSize)=>h("span",{className:"arjs-text-tab",style:{minWidth:tabSize}},tabText.length>0?[`${tabText}\xa0`]:[])));function render$e(style,text,idGenerator,model,toggle,sortIcon,itemContent,createPatch){const createInnerTextNode=value=>h("div",{className:"arjs-textBoxContent",style:style.contentStyle},createActionHref(value)),createActionHref=value=>{if(!model||!model.Action)return value;const dataAttrValue=buildActionAttr(model.Action);return dataAttrValue.Type?[h("span",{className:"arjs-action",attributes:{"data-action":JSON.stringify(dataAttrValue)}},value)]:value},anchorNodes=buildAnchorNodes(model),makeChildren=(textContent,rawValue)=>{const textNode=(value=textContent,style.verticalTextStyle?h("div",{style:style.verticalTextStyle},[createInnerTextNode(value)]):createInnerTextNode(value));var value;return textNode.properties.meta={rawValue:"function"==typeof rawValue?null:rawValue},[...anchorNodes,toggle,textNode,sortIcon].filter(isNotNull)},id=idGenerator(),langProps={};return"firefox"===environment&&style.languageAttribute&&(langProps.lang=style.languageAttribute),h("div",Object.assign(Object.assign({},langProps),{id:id,className:`arjs-itemContent arjs-textBoxItem ${style.className}`,style:style.style,patcher:createPatch(id,makeChildren),itemContent:itemContent,title:model.Tooltip}),makeChildren(text,itemContent.UnformattedValue))}function makeRender$f(model,toggleController,sortController,getResourceUri){const style=model.Style,sb=styleBuilder();sb.add("color",[style.Color]),sb.add("textAlign",[style.TextAlign,style.Direction,style.Format,model.ValueUnformatted],getTextAlign$1),sb.add("textAlignLast",[style.TextAlign,style.Direction,style.TextJustify,style.Format,model.ValueUnformatted],getTextAlignLast),sb.add("alignItems",[style.VerticalAlign,style.Angle,style.WritingMode],getFlexVerticalAlign),sb.add("flex-direction",[style.WritingMode,style.MinCondenseRate],getFlexDirection),sb.add("textDecorationLine",[style.TextDecoration],getTextDecoration$3),sb.add("textDecorationStyle",[style.TextDecoration],getTextDecorationStyle),sb.add("textJustify",[style.TextJustify],getTextJustify),sb.add("fontFamily",[style.FontFamily],wrapWithQuotes),sb.add("fontSize",[style.FontSize]),sb.add("fontStyle",[style.FontStyle],getFontStyle$1),sb.add("fontWeight",[style.FontWeight],getFontWeight$3),sb.add("paddingLeft",[style.PaddingLeft]),sb.add("paddingRight",[style.PaddingRight]),sb.add("paddingTop",[style.PaddingTop]),sb.add("paddingBottom",[style.PaddingBottom]),sb.add("direction",[style.Direction]),sb.add("letterSpacing",[style.CharacterSpacing]),sb.add("wordWrap",[style.WrapMode],getWordWrap),sb.add("wordBreak",[style.WrapMode],getWordBreak),sb.add("whiteSpace",[style.WrapMode],getWhiteSpace),sb.add("lineHeight",[style.LineSpacing,style.FontSize],getLineHeight);const contentStyle=sb.style,contentClassName=`${model.Name}Style`;return{render:(data,ctx)=>{const dynamicDataStyle=contentStyle.dynamic(data,ctx),itemCommon=resolveItemCommon(model,data,ctx),minCondenseRate=model.Style.MinCondenseRate(data),shrinkToFit=1===minCondenseRate&&model.ShrinkToFit(data),writingMode=safeResolveCompiledData(style.WritingMode,data),uprightInVerticalText=safeResolveCompiledData(style.UprightInVerticalText,data),unformattedValue=resolveCompiled$1(model.ValueUnformatted,data,ctx),resolvedLanguage=safeResolveCompiledData(style.Language,data),language=resolvedLanguage||("Default"!==ctx.Language?ctx.Language:void 0);return actions=>resolvedValue=>{const toggle=toggleController(data,ctx)(actions),sort=sortController(data,ctx)(actions),content={Type:"textbox",Name:model.OriginalName,FullName:model.Name,Value:resolvedValue,OriginalValue:model.OriginalValue,UnformattedValue:unformattedValue,ScopeId:data.Id};return(originalItemViewSize,text)=>{const itemViewSize=Object.assign(Object.assign({},originalItemViewSize),{FullHeight:originalItemViewSize.FullHeight+1,VisibleHeight:originalItemViewSize.VisibleHeight+1}),dynamicStyle=Object.assign({},dynamicDataStyle);if(shrinkToFit){const renderTimeStyle=dynamicStyle.renderTimeStyle,fontSize=function(style,renderTimeStyle,isToggle,isSorter){return(size,value)=>"function"==typeof value||renderTimeStyle?globals=>{const finalValue="function"==typeof value?value(globals):value;return getFontSizeStyle(renderTimeStyle?Object.assign(Object.assign({},style),renderTimeStyle(globals)):style,size,finalValue,isToggle,isSorter)}:getFontSizeStyle(style,size,value,isToggle,isSorter)}(Object.assign(Object.assign({},contentStyle.static),dynamicStyle.style),renderTimeStyle,!!toggle,!!sort)(itemViewSize,text);"function"==typeof fontSize?dynamicStyle.renderTimeStyle=globals=>Object.assign(Object.assign({},null==renderTimeStyle?void 0:renderTimeStyle(globals)),fontSize(globals)):dynamicStyle.style=Object.assign(Object.assign({},dynamicStyle.style),fontSize)}const transformationStyle={},resolvedStyle=Object.assign(Object.assign({},contentStyle.static),dynamicStyle.style),topPadding=Length.parse(resolvedStyle.paddingTop||"0pt"),leftPadding=Length.parse(resolvedStyle.paddingLeft||"0pt"),topBottomPadding=topPadding+Length.parse(resolvedStyle.paddingBottom||"0pt"),leftRightPadding=leftPadding+Length.parse(resolvedStyle.paddingRight||"0pt");if(minCondenseRate<1){const renderTimeStyle=dynamicStyle.renderTimeStyle,condenseRate=function(style,renderTimeStyle,minCondenseRate,isToggle,isSorter){return(size,value)=>"function"==typeof value||renderTimeStyle?globals=>{const finalValue="function"==typeof value?value(globals):value;return getCondenseRateStyle(renderTimeStyle?Object.assign(Object.assign({},style),renderTimeStyle(globals)):style,size,minCondenseRate,finalValue,isToggle,isSorter)}:getCondenseRateStyle(style,size,minCondenseRate,value,isToggle,isSorter)}(Object.assign(Object.assign({},contentStyle.static),dynamicStyle.style),renderTimeStyle,minCondenseRate,!!toggle,!!sort)(itemViewSize,text);"function"!=typeof condenseRate&&condenseRate&&condenseRate<1&&(transformationStyle.transform=`scaleX(${condenseRate})`,transformationStyle.position="absolute",transformationStyle.width=Length.toCss((itemViewSize.FullWidth-leftRightPadding)/condenseRate),transformationStyle.maxWidth=transformationStyle.width,toggle&&(transformationStyle.left=Length.toCss(getToggleIconSize().Width+leftPadding)))}const angle=1===minCondenseRate?toNumber$1(style.Angle):0;let verticalTextStyle=null;if(0!==angle){const fullStyle=Object.assign(Object.assign({},resolvedStyle),{paddingBottom:"0pt",paddingTop:"0pt",paddingLeft:"0pt",paddingRight:"0pt"}),swapWidthHeight=Math.abs(angle)%180==90,contentSize={Width:itemViewSize.FullWidth-leftRightPadding,Height:itemViewSize.FullHeight-topBottomPadding},textSize=MeasureTextBoxSize(fullStyle,resolveTextForMeasure(text,ctx)||"",swapWidthHeight?contentSize.Height:contentSize.Width),verticalAlign=toString$1(resolveCompiled$1(style.VerticalAlign,data)).toLowerCase(),translation=getTransform(-angle,fullStyle.textAlign,verticalAlign,contentSize,textSize);swapWidthHeight?verticalTextStyle=function(angle,parentTextAlign,verticalAlign,contentSize){const minHeight=Length.toCss(contentSize.Width),minWidth=Length.toCss(contentSize.Height),transform=`translate(${90===angle?minHeight:"0pt"}, ${90===angle?"0pt":minWidth}) rotate(${angle}deg)`;let alignItems="";switch(parentTextAlign){case"center":alignItems="center";break;case"right":alignItems=90===angle?"flex-start":"flex-end";break;default:alignItems=90===angle?"flex-end":"flex-start"}let textAlign="";switch(verticalAlign){case"middle":textAlign="center";break;case"bottom":textAlign=90===angle?"right":"left";break;default:textAlign=90===angle?"left":"right"}return{alignItems:alignItems,display:"flex",minHeight:minHeight,minWidth:minWidth,transform:transform,transformOrigin:"left top",textAlign:textAlign,width:minWidth,height:minHeight}}(translation.angle,fullStyle.textAlign,verticalAlign,contentSize):transformationStyle.transform=`translate(${translation.offsetX}, ${translation.offsetY}) rotate(${translation.angle}deg)`}const isVerticalText$1=isVerticalText(writingMode,minCondenseRate);isVerticalText$1&&(verticalTextStyle=verticalTextStyle||{},verticalTextStyle.writingMode=getWritingMode(writingMode,minCondenseRate),verticalTextStyle.height=Length.toCss(itemViewSize.FullHeight-topBottomPadding));const itemStyle={className:contentClassName,style:Object.assign(Object.assign({},dynamicStyle.style),buildSizeStyle(itemViewSize)),contentStyle:transformationStyle,verticalTextStyle:verticalTextStyle,languageAttribute:language};if("double"===resolvedStyle.textDecorationStyle){const targetPadding=isVerticalText$1?"paddingLeft":"paddingBottom",paddingLength=Length.parse(resolvedStyle[targetPadding]||"0pt"),paddingShift=Length.fromPixels(1);itemStyle.style[targetPadding]=Length.toCss(paddingLength>=paddingShift?paddingLength-paddingShift:0),"firefox"===environment&&isVerticalText$1?(itemStyle.style["text-underline-position"]="left",itemStyle.contentStyle[targetPadding]=Length.toCss(paddingLength>=paddingShift?4*paddingShift:0)):itemStyle.contentStyle[targetPadding]="safari"===environment&&isVerticalText$1?Length.toCss(paddingLength>=paddingShift?4*paddingShift:0):Length.toCss(paddingLength>=paddingShift?paddingShift:0)}const makeTextContent=textValue=>getDisplayValue(flatten(fillLineBreaks(textValue).map((t=>"string"==typeof t?renderTabs$2(t):t))),writingMode,uprightInVerticalText,(value=>h("span",{className:"arjs-upright"},value))),textContent="function"==typeof text?globals=>makeTextContent(text(globals)):makeTextContent(text),patcher=function(textContent,rawValue,style,evalExpr){return(id,makeChildren)=>{if("function"==typeof textContent||null!==style){const getNewContent="function"==typeof textContent&&"function"==typeof rawValue?globals=>{var _a;return makeChildren(null!==(_a=evalExpr(textContent,globals))&&void 0!==_a?_a:[],evalExpr(rawValue,globals))}:null;return globals=>({id:id,style:style?evalExpr(style,globals):null,children:getNewContent?evalExpr(getNewContent,globals):null})}return null}}(textContent,unformattedValue,dynamicStyle.renderTimeStyle,((v,g)=>v(Object.assign(Object.assign({},g),{GetDocumentPath:ctx.GetDocumentPath}))));return wrapSplittedItem(itemViewSize,render$e(itemStyle,function(text,ctx){var _a;return null!==(_a="function"==typeof text?text({Data:{globals:{}},PaginationService:defaultPagination,GetDocumentPath:ctx.GetDocumentPath}):text)&&void 0!==_a?_a:[]}(textContent,ctx),(()=>ctx.IDGenerator.next()),itemCommon,toggle&&renderController(toggle),sort&&renderController(sort),content,patcher))}}},measure:(data,ctx)=>actions=>{var _a;const isToggleController=!!toggleController(data,ctx)(actions),isSortController=!!sortController(data,ctx)(actions),minCondenseRate=model.Style.MinCondenseRate(data),writingMode=getWritingMode(safeResolveCompiledData(style.WritingMode,data),minCondenseRate),uprightInVerticalText=null!==(_a=safeResolveCompiledData(style.UprightInVerticalText,data))&&void 0!==_a?_a:"",textStyle=Object.assign(Object.assign(Object.assign({},contentStyle.static),contentStyle.dynamic(data,ctx).style),{transform:(angle=style.Angle,`rotate(${-1*Number(angle)}deg)`),writingMode:writingMode,uprightInVerticalText:uprightInVerticalText});var angle;const paddingsWidth=Length.parse(textStyle.paddingLeft||"0pt")+Length.parse(textStyle.paddingRight||"0pt");return(text,width)=>MeasureTextBoxHeight(textStyle,text,paddingsWidth+(width-paddingsWidth)/minCondenseRate,isToggleController,isSortController)},styles:[{className:contentClassName,style:contentStyle.static}]}}function resolveTextForMeasure(text,ctx){return"function"==typeof text?text({Data:{globals:{}},PaginationService:defaultPagination,GetDocumentPath:ctx.GetDocumentPath}):text}const defaultPagination=PaginationService.init().Next();function renderController(controller){return"toggle"===controller.Type?(isExpanded=controller.IsExpanded,action=controller.Action,h("span",{className:"arjs-action arjs-control "+(isExpanded?"arjs-toggle-expanded":"arjs-toggle-collapsed"),attributes:{"data-action":JSON.stringify(action)}},[])):function(direction,action){return h("span",{className:sortControllerClassName[direction||"NoSort"],attributes:{"data-action":JSON.stringify(action)}},[])}(controller.SortDirection,controller.Action);var isExpanded,action}const locItemName=(itemName,prop)=>`${itemName}.${prop}`;function notLocalized(name,prop,defValue){return{DefaultValue:defValue,Locales:[]}}function compileLocalizedResources(language,localizationResources){if("Default"===language)return notLocalized;if(!isExpression(language)){const locale=localizationResources.find((lr=>lr.Language===language));return locale?(locale=>(name,prop,defValue)=>{const itemName=locItemName(name,prop).toLowerCase(),localized=locale.Data.find((d=>d.Name.toLowerCase()===itemName));return{DefaultValue:localized?localized.Value:defValue,Locales:[]}})(locale):notLocalized}return(locales=>(name,prop,defValue)=>{const itemName=locItemName(name,prop).toLowerCase();return{DefaultValue:defValue,Locales:locales.map((lr=>{const localized=lr.Data.find((d=>d.Name.toLowerCase()===itemName.toLowerCase()));return localized?{Language:lr.Language,Value:localized.Value}:null})).filter(isNotNull)}})(localizationResources)}const defaultTextBox=createTextBox("default");function wrapOriginalValue(value){try{return null===value?null:treeBuilder$2(value.toString()).ToString()}catch(ex){return value}}function compileShrinkToFit(shrinkToFit,writingMode){return data=>toBoolean(safeResolveCompiledData(shrinkToFit,data))&&!isVerticalText(resolveCompiled$1(writingMode,data))}function formatCompiledValue(value,format=null,language=null){return(data,ctx)=>{const resolvedLanguage=safeResolveCompiledData(language,data,void 0,ctx),languageValue=resolvedLanguage&&"Default"!==resolvedLanguage?Format(resolvedLanguage,null,null):ctx&&ctx.Language||null,formatValue=Format(safeResolveCompiledData(format,data,void 0,ctx),null,null),resolvedValue=resolveCompiled$1(value,data,ctx);return"function"==typeof resolvedValue?globals=>Format(resolvedValue(globals),languageValue,formatValue):Format(resolvedValue,languageValue,formatValue)}}class Item{constructor(body,position,size,position2,size2,ishelper=!1){if(null==body)throw new LayoutError("ArgumentNullException: body");this.Body=body,this.Position=position,this.Size=size,this.Position2=position2,this.Size2=size2,this.IsHelper=ishelper}get End(){return this.Position+this.Size}}class Node$1{constructor(idx,item,distance,outgoings){if(!outgoings)throw Error('ArgumentNullException("outgoings")');this.Idx=idx,this.CanvasItem=item,this.Distance=distance,this.Outgoings=outgoings}static New(idx,item){return new Node$1(idx,item,item.Position,[])}}function CanvasResizable(canvasItems,fillHorzSpace,fillVertSpace,width,height,canShrink,canGrow,consumeWhiteSpace,makeComposite,makeEmpty,makeClipResult){if(!canShrink){canvasItems=[{Bounds:{Location:{X:0,Y:0},Size:{Width:width,Height:height}},Body:L2.Divisible(width,height,((w,h)=>makeEmpty(0,0))),IsHelper:!0},...canvasItems]}const canvas=function(canvasItems,fillHorzSpace,fillVertSpace,width,height,consumeWhiteSpace,makeComposite,makeEmpty){const emptyLayout=L.Empty(L.Empty(makeEmpty(0,0))),bottomHelperItem=NewItem$1(emptyLayout,consumeWhiteSpace?Math.max(...canvasItems.filter((ci=>!ci.IsHelper)).map((c=>c.Bounds.Location.Y+c.Bounds.Size.Height))):height,0,0,0,!0),rightHelperItem=NewItem$1(emptyLayout(0).Body,consumeWhiteSpace?Math.max(...canvasItems.filter((ci=>!ci.IsHelper)).map((c=>c.Bounds.Location.X+c.Bounds.Size.Width))):width,0,0,0,!0),canvasHorz=TakeAllSpace(!fillHorzSpace);return TakeAllSpace(!fillVertSpace)(BuildGraph(canvasItems.map(VerticalPassNode).concat(bottomHelperItem)),((h1,items1)=>canvasHorz(BuildGraph(items1.map(HorizontalPassNode).concat(rightHelperItem)),((w1,items2)=>makeComposite(w1,h1,items2.filter((it=>!it.IsHelper)).sort(((ita,itb)=>ita.Position2-itb.Position2)).map((itr=>({Position:{X:itr.Position,Y:itr.Position2},Content:itr.Body}))))))))}(canvasItems,fillHorzSpace,fillVertSpace,width,height,consumeWhiteSpace,makeComposite,makeEmpty);return canGrow?canvas:L2.Clip(canvas,width,height,makeClipResult)}const TakeAllSpace=omitOnComplete=>(canvasGraph,makeResult)=>{const canvasImpl=CanvasImpl(canvasGraph,((size,items)=>items));return L.ConvertSlice(canvasImpl,((res,space)=>{const size=space===1/0||omitOnComplete&&res.IsCompleted()?res.Size:space;return{Size:size,Body:makeResult(size,res.Body)}}))};function CanvasImpl(canvasGraph,makeResult){return space=>{if(space<=0)return LResult.Fail();const takenItems=[],remainderNodes=[];let restGraph=null,size=0,breakPoint=null;const prevEndByNode=new Map,completedHelpers=[];for(let i=0;i<canvasGraph.length;i++){const node=canvasGraph[i];if(node===breakPoint){restGraph=canvasGraph.slice(i);break}const position=(prevEndByNode.get(node)||0)+node.Distance,slice=position>space?LResult.Fail():node.CanvasItem.Body(space-position);if(slice.IsFailed()){size=Math.max(size,Math.min(space,position));const distance=Math.max(0,position-space),itemLayout=position<=space?L.EndlessLoopPreventer(node.CanvasItem.Body):node.CanvasItem.Body;remainderNodes.push(CreateRemainderNode(node,itemLayout,distance)),breakPoint=UpdateBreakPos(node,breakPoint);continue}const end=position+slice.Size;if(size=Math.max(size,end),!slice.IsEmpty()&&slice.Body&&takenItems.push(Move(ReplaceBody$1(node.CanvasItem,slice.Body),position)),slice.IsCompleted()){node.CanvasItem.IsHelper&&completedHelpers.push(node),slice.IsPageBreakAfter()&&(breakPoint=UpdateBreakPos(node,breakPoint));for(const outgoing of node.Outgoings){const e=prevEndByNode.get(outgoing);prevEndByNode.set(outgoing,e||0===e?Math.max(e,end):end)}}else remainderNodes.push(CreateRemainderNode(node,slice.Tail,0)),breakPoint=UpdateBreakPos(node,breakPoint)}const complete=0===remainderNodes.length&&null==restGraph,head=makeResult(size,takenItems);if(complete)return LResult.Complete(size,head);const remainderGraph=remainderNodes.concat(restGraph||[]),tail=CanvasImpl([...completedHelpers,...remainderGraph],makeResult);return LResult.Split(size,head,tail)}}function BuildGraph(canvasItems){const nodes=canvasItems.sort(((a,b)=>a.Position-b.Position)).map(((x,i)=>Node$1.New(i,x)));for(let i=0;i<nodes.length;i++){const node=nodes[i],item=node.CanvasItem;if(item.IsHelper)continue;let outgoingsStartPosition=nodes.length;for(let j=i+1;j<nodes.length;j++){const outgoingCandidate=nodes[j].CanvasItem;if(IsBelow(outgoingCandidate,item)){outgoingsStartPosition=j,nodes[j].Distance=Math.min(nodes[j].Distance,GetDistance(outgoingCandidate,item)),node.Outgoings.push(nodes[j]);break}}for(let j=outgoingsStartPosition+1;j<nodes.length;j++){const outgoingCandidate=nodes[j].CanvasItem;if(node.Outgoings.some((outgoingId=>IsBelow(outgoingCandidate,outgoingId.CanvasItem))))break;nodes[j].Distance=Math.min(nodes[j].Distance,GetDistance(outgoingCandidate,item)),node.Outgoings.push(nodes[j])}}return nodes}function IsBelow(first,second){return GetDistance(first,second)>=0}function GetDistance(first,second){return first.Position-second.End}function CreateRemainderNode(node,layout,distance){return new Node$1(node.Idx,ReplaceBody$1(node.CanvasItem,layout),distance,node.Outgoings)}function UpdateBreakPos(canvasNode,oldBreak){const nextBreak=canvasNode.Outgoings[0]||null;return nextBreak&&(!oldBreak||nextBreak.Idx<oldBreak.Idx)?nextBreak:oldBreak}function ReplaceBody$1(item,body){return new Item(body,item.Position,item.Size,item.Position2,item.Size2,item.IsHelper)}function Move(item,position){return new Item(item.Body,position,item.Size,item.Position2,item.Size2,item.IsHelper)}function HorizontalPassNode(it){return NewItem$1(it.Body,it.Position2,it.Size2,it.Position,it.Size,it.IsHelper)}function VerticalPassNode(it){return NewItem$1(it.Body,it.Bounds.Location.Y,it.Bounds.Size.Height,it.Bounds.Location.X,it.Bounds.Size.Width,it.IsHelper)}function NewItem$1(body,position,size,position2,size2,ishelper=!1){return new Item(body,position,size,position2,size2,ishelper)}const VDomFragmentFactory={clip:(width,height,content)=>(content.properties.style.width=Length.toCss(width),content.properties.style.height=Length.toCss(height),content.properties.style.overflow="hidden",content),clipWithScroll:(width,height,content)=>(content.properties.style.width=Length.toCss(width),content.properties.style.height=Length.toCss(height),content.properties.style.overflow="auto",content),clipVertically:(height,content)=>(content.properties.style.height=Length.toCss(height),content.properties.style.overflow="hidden",content),clipVerticallyWithScroll:(height,content)=>(content.properties.style.height=Length.toCss(height),content.properties.style.overflow="auto",content)};function renderEmpty(width,height){return h("div",{style:{width:Length.toCss(width),height:Length.toCss(height)}},[])}function layout$a(rectangle,children,width,height,renderCanvas,renderEmpty){const canGrow="None"===rectangle.Clip;return CanvasResizable(children,rectangle.FillHorzSpace,rectangle.FillVertSpace,width,height,rectangle.CanShrink,canGrow,rectangle.ConsumeWhiteSpace,renderCanvas,renderEmpty,function(rectangle){switch(rectangle.Clip){case"None":return(w,h,f)=>f;case"Vertical":return(w,h,c)=>rectangle.Scrollable?VDomFragmentFactory.clipVerticallyWithScroll(h,c):VDomFragmentFactory.clipVertically(h,c);case"Both":return(w,h,c)=>rectangle.Scrollable?VDomFragmentFactory.clipWithScroll(w,h,c):VDomFragmentFactory.clip(w,h,c);default:throw new Error("Unknown rectangle layout")}}(rectangle))}function createStylePatcher(renderContext,style,nodeId){if(style&&style.renderTimeStyle&&renderContext){const id=null!=nodeId?nodeId:renderContext.IDGenerator.next();return{patcher:globals=>({id:id,style:style&&style.renderTimeStyle?renderContext.EvalDynamicRuntime(style.renderTimeStyle,globals):null}),id:id}}return{patcher:null,id:void 0}}function createClassNamePatcher(renderContext,className,nodeId){if("function"==typeof className&&renderContext){const id=null!=nodeId?nodeId:renderContext.IDGenerator.next();return{patcher:globals=>({id:id,className:className(globals)}),id:id}}return{patcher:null,id:void 0}}function joinPatchers(...patchers){return flatten$3(patchers).filter(isNotNull)}function renderChild(child){const content=child.Content;var x,y;return content.properties.style&&Object.assign(content.properties.style,(x=child.Position.X,y=child.Position.Y,{left:Length.toCss(x),top:Length.toCss(y)})),content.properties.className=content.properties.className?`${content.properties.className} arjs-canvasItem`:"arjs-canvasItem",content}function makeRender$e(model){const contentStyle={dynamic:data=>({style:{},renderTimeStyle:null}),static:{}};return{render:(data,ctx,width,height,children)=>function(contentClassName,contentStyle,width,height,children,renderContext,model,groupType){const childrenNodes=buildAnchorNodes(model),{patcher:patcher,id:id}=createStylePatcher(renderContext,contentStyle),rectPatcher=joinPatchers(patcher,children.map((c=>c.Content.properties.patcher))),rectangle=h("div",{id:id,GroupType:groupType,className:`arjs-itemContent arjs-container ${contentClassName}`.trim(),style:Object.assign({},contentStyle.style,{width:Length.toCss(width),height:Length.toCss(height)}),patcher:rectPatcher,title:model.Tooltip},childrenNodes.concat(children.map(renderChild)));return addActionAttribute(rectangle,model.Action),rectangle}("",contentStyle.dynamic(data),width,height,children,ctx,resolveItemCommon(model,data,ctx),model.Type),styles:[{className:"",style:contentStyle.static}]}}function render$c(width,height){return h("div",{style:{width:Length.toCss(width),height:Length.toCss(height)}},[])}const supportedItemTypes=["textbox","richtext","checkbox","inputfield","rectangle","tablix","table","list","bandedlist","line","tableofcontents","sparkline","subreport","image","shape","bullet","dvchart","barcode"];function isSupportedItem(item){return supportedItemTypes.indexOf(item.Type)>-1}const stubUnsupportedItem=(unsupportedItem,i18n)=>{const item="unknown"===unsupportedItem.Type?unsupportedItem.Item:unsupportedItem,textBox=createTextBox(item.Name);textBox.Value=i18n.t("core:report-item-not-supported",{defaultValue:'"{{itemType}}" report item is not supported',itemType:item.Type,interpolation:{escapeValue:!1}}),textBox.Left=item.Left,textBox.Top=item.Top,textBox.Height=item.Height,textBox.Width=item.Width,textBox.Visibility="overflowplaceholder"!==item.Type?item.Visibility:createVisibility(),textBox.Bookmark="overflowplaceholder"!==item.Type?item.Bookmark:"",textBox.Label="overflowplaceholder"!==item.Type?item.Label:"",textBox.CanGrow=!1,textBox.CanShrink=!1,textBox.LayerName=item.LayerName;const itemStyle=item.Style;if(itemStyle){const additionalStyles={};itemStyle.Border&&(additionalStyles.Border=itemStyle.Border),itemStyle.RightBorder&&(additionalStyles.RightBorder=itemStyle.RightBorder),itemStyle.LeftBorder&&(additionalStyles.LeftBorder=itemStyle.LeftBorder),itemStyle.TopBorder&&(additionalStyles.TopBorder=itemStyle.TopBorder),itemStyle.BottomBorder&&(additionalStyles.BottomBorder=itemStyle.BottomBorder),itemStyle.BackgroundColor&&(additionalStyles.BackgroundColor=itemStyle.BackgroundColor),textBox.Style=Object.assign(Object.assign({},textBox.Style),additionalStyles)}return function(reportItem){const decodeResult=cjs$1.Model.ReportItem.decode(reportItem);if("error"===decodeResult.type)throw new Error(`Failed to decode reportitem: ${decodeResult.reason}`);return decodeResult.warnings,decodeResult.value}(textBox)},defaultRectangle=createRectangle("default"),selfSitedItemTypes=["tablix","table","line","sparkline","bullet","overflowplaceholder"];function isSelfSited(rItem){return selfSitedItemTypes.indexOf(rItem.Type)>=0}const blankBorder=createBorderStyle();function wrapWithSite(def){if("overflowplaceholder"===def.Type||"tablix"===def.Type||"table"===def.Type||"line"===def.Type||"sparkline"===def.Type||"bullet"===def.Type)throw new ReportCompilationError(`${def.Type} is self sited.`);if(!isSupportedItem(def))throw new ReportCompilationError(`"${def.Type}" is not allowed in the rectangle.`);return{Name:`${def.Name}Site`,Type:"rectangleitemsite",Width:def.Width,Height:def.Height,BackgroundColor:"image"!==def.Type&&"subreport"!==def.Type&&"bandedlist"!==def.Type?def.Style.BackgroundColor:"Transparent",BackgroundImage:"tableofcontents"!==def.Type&&"image"!==def.Type&&"subreport"!==def.Type&&"bandedlist"!==def.Type&&"inputfield"!==def.Type&&"barcode"!==def.Type?def.Style.BackgroundImage&&{BackgroundRepeat:def.Style.BackgroundImage.BackgroundRepeat,Value:def.Style.BackgroundImage.Value,MIMEType:def.Style.BackgroundImage.MIMEType,Source:def.Style.BackgroundImage.Source}:null,Borders:{Border:"bandedlist"===def.Type?blankBorder:def.Style.Border,LeftBorder:"bandedlist"===def.Type?blankBorder:def.Style.LeftBorder,TopBorder:"bandedlist"===def.Type?blankBorder:def.Style.TopBorder,RightBorder:"bandedlist"===def.Type?blankBorder:def.Style.RightBorder,BottomBorder:"bandedlist"===def.Type?blankBorder:def.Style.BottomBorder},RoundingRadius:"shape"===def.Type||"rectangle"===def.Type?def.RoundingRadius:null,ShapeStyle:"shape"===def.Type?def.ShapeStyle:null,ZIndex:def.ZIndex,LayerName:def.LayerName,Content:def,Visibility:"list"!==def.Type?def.Visibility:createVisibility()}}function compile$s(definition,context){var _a;return __awaiter(this,void 0,void 0,(function*(){const query={Fields:[],Regions:[]},children=[],staticStyles=[],documentMapNodesCollection=[];for(const childItem of definition.ReportItems){const child=isSupportedItem(childItem)?childItem:stubUnsupportedItem(childItem,context.i18n),location={X:Length.parse(child.Left),Y:Length.parse(child.Top)};let size={Width:Length.parse(child.Width),Height:Length.parse(child.Height)};"line"!==child.Type&&(size={Width:size.Width||(context.ContainerSize?context.ContainerSize.Width-location.X:0),Height:size.Height||(context.ContainerSize?context.ContainerSize.Height-location.Y:0)});const bounds={Location:location,Size:size},itemSite=isSelfSited(child)?child:wrapWithSite(child),childComp=yield compile$2(itemSite,Object.assign(Object.assign({},context),{ContainerSize:bounds.Size}));if(null===childComp)continue;const dataMap=combineDataQuery(query,childComp.Query);children.push({Bounds:bounds,MakeL:(data,ctx)=>childComp.Layout(dataMap(data),ctx)}),staticStyles.push(...childComp.Styles),childComp.DocumentMap&&documentMapNodesCollection.push({DocMap:(data,ctx)=>childComp.DocumentMap(dataMap(data),ctx),Bounds:bounds})}const documentMapNodes=documentMapNodesCollection.sort(((a,b)=>a.Bounds.Location.Y-b.Bounds.Location.Y||a.Bounds.Location.X-b.Bounds.Location.X)).map((n=>n.DocMap));let clip,scrollable;if("rectangle"===definition.Type){const overflow="Auto"===definition.Overflow?context.DefaultOverflowBehavior:definition.Overflow;clip="Grow"===overflow?"None":"Both",scrollable="Scroll"===overflow}else clip="pagesection"===definition.Type?"Vertical":!1!==definition.CanGrow?"None":"Both",scrollable=!1;const consumeWhiteSpace=!scrollable&&("fixedpagesection"!==definition.Type&&"pagesection"!==definition.Type&&(context.ConsumeContainerWhitespace||definition.ConsumeWhiteSpace)),exprCompiler=createTypedCompiler((value=>compileExpression(value,query.Fields,context.EvaluationContext))),compiled={FillHorzSpace:"fixedpagesection"!==definition.Type&&!!definition.FillHorzSpace,FillVertSpace:"fixedpagesection"!==definition.Type&&!!definition.FillVertSpace,Clip:clip,Scrollable:scrollable,CanShrink:!1!==definition.CanShrink,ConsumeWhiteSpace:consumeWhiteSpace,Name:context.ReportID+definition.Name,Label:"rectangle"===definition.Type?exprCompiler.compileString(definition.Label):null,Bookmark:"fixedpagesection"!==definition.Type?exprCompiler.compileString(definition.Bookmark,defaultRectangle.Bookmark):null,Tooltip:"rectangle"===definition.Type?exprCompiler.compileString(definition.ToolTip,defaultRectangle.ToolTip):null,Type:definition.Type,Action:compileAction$1(null!==(_a=definition.Action)&&void 0!==_a?_a:createAction(),query.Fields)},{render:render,styles:styles}=makeRender$e(compiled);return{Query:query,Layout:(data,ctx)=>actions=>(width,height)=>function(model,width,height,data,ctx,render,children){return layout$a(model,children,width,height,((w,h,c)=>render(data,ctx,w,h,c)),render$c)}(compiled,width,height,data,ctx,render,((data,ctx)=>actions=>children.map((c=>({Bounds:c.Bounds,Body:c.MakeL(data,ctx)(actions)(c.Bounds.Size.Width,c.Bounds.Size.Height),IsHelper:!1}))))(data,ctx)(actions)),Styles:staticStyles.concat(...styles),DocumentMap:buildDocumentMap(definition.Name,compiled,context.DocumentMap,documentMapNodes)}}))}const defaultBorder=createBorderStyle();function compileBorders(defBorders,exprCompiler){const compileSideBorder=defBorder=>({Color:exprCompiler.compileColor(defBorder.Color),Style:exprCompiler.compileEnum.BorderStyle(defBorder.Style),Width:exprCompiler.compileLength(defBorder.Width)});return{Border:(defBorder=defBorders.Border,{Color:exprCompiler.compileColor(defBorder.Color,defaultBorder.Color),Style:exprCompiler.compileEnum.BorderStyle(defBorder.Style,null==defaultBorder?void 0:defaultBorder.Style),Width:exprCompiler.compileLength(defBorder.Width,defaultBorder.Width)}),LeftBorder:compileSideBorder(defBorders.LeftBorder),TopBorder:compileSideBorder(defBorders.TopBorder),RightBorder:compileSideBorder(defBorders.RightBorder),BottomBorder:compileSideBorder(defBorders.BottomBorder)};var defBorder}function isBorderSet(particularBorder){return null!==particularBorder.Style||null!==particularBorder.Color&&""!==particularBorder.Color||null!==particularBorder.Width}function populateBordersWithDefaults(particularBorder,commonBorder){return{Color:null!==particularBorder.Color&&""!==particularBorder.Color?particularBorder.Color:commonBorder.Color,Style:null!==particularBorder.Style?particularBorder.Style:commonBorder.Style,Width:null!==particularBorder.Width?particularBorder.Width:commonBorder.Width}}function createBordersOnlyStyle(style){if(!style.Border)return null;const sb=styleBuilder();!function(styleBuilderInstance,style){const defaults=Object.assign({},style.Border);function fillBorderStyle(prefix=""){const border=style[`${prefix}Border`];styleBuilderInstance.add(`border${prefix}Style`,[border.Style,defaults.Style],createStyleFallback("None",getBorderStyle)),styleBuilderInstance.add(`border${prefix}Width`,[border.Width,defaults.Width],createStyleFallback("1pt")),styleBuilderInstance.add(`border${prefix}Color`,[border.Color,defaults.Color],createStyleFallback("Black"))}isBorderSet(style.TopBorder)||isBorderSet(style.BottomBorder)||isBorderSet(style.LeftBorder)||isBorderSet(style.RightBorder)?(style=function(style){return{Border:{Color:"",Style:"None",Width:""},TopBorder:populateBordersWithDefaults(style.TopBorder,style.Border),BottomBorder:populateBordersWithDefaults(style.BottomBorder,style.Border),RightBorder:populateBordersWithDefaults(style.RightBorder,style.Border),LeftBorder:populateBordersWithDefaults(style.LeftBorder,style.Border)}}(style),fillBorderStyle("Left"),fillBorderStyle("Top"),fillBorderStyle("Right"),fillBorderStyle("Bottom")):fillBorderStyle()}(sb,style);const result=sb.style;return allBordersInvisible(result.static)?null:result}function createBackgroundOnlyStyle(style){const sb=styleBuilder();sb.add("backgroundColor",[style.BackgroundColor]),style.BackgroundImage&&(sb.add("backgroundImage",[style.BackgroundImage.Value]),sb.add("backgroundRepeat",[style.BackgroundImage.BackgroundRepeat],getBackgroundRepeat));const result=sb.style;return!backgroundInvisible(sb.style.static)||style.BackgroundImage&&style.BackgroundImage.Value?result:null}function createRoundingOnlyStyle(rounding,shapeStyle){if(!rounding)return null;const sb=styleBuilder();return rounding&&(sb.add("borderRadius",[rounding.Default,rounding.TopLeft,rounding.TopRight,rounding.BottomLeft,rounding.BottomRight,shapeStyle],getBorderRadius),sb.add("overflow",[rounding.Default,rounding.TopLeft,rounding.TopRight,rounding.BottomLeft,rounding.BottomRight,shapeStyle],getBorderRadiusOverflow)),roundingInvisible(sb.style.static)?null:sb.style}function createStyleFallback(fallbackValue,modificator){return(value,defaultValue)=>modificator?modificator("string"==typeof value?value:"string"==typeof defaultValue?defaultValue:fallbackValue):"string"==typeof value?value:"string"==typeof defaultValue?defaultValue:fallbackValue}function createBorderSizeAndLocation(style){const sb=styleBuilder();return sb.add("width",getWidthSet(style),getBackgroundSize),sb.add("height",getHeightSet(style),getBackgroundSize),sb.add("left",getLeftSet(style),getBackgroundPos),sb.add("top",getTopSet(style),getBackgroundPos),sb.style}function calcBorderWidth(commonWidth,commonStyle,exactWidth,exactStyle){return"None"===exactStyle||null===exactStyle&&"None"===commonStyle?"0pt":null===exactWidth?commonWidth:exactWidth}const getBackgroundPos=(borderWidth,borderStyle,borderCustomWidth,borderCustomStyle)=>`calc(-0.5 * ${calcBorderWidth(borderWidth,borderStyle,borderCustomWidth,borderCustomStyle)})`,getTablePos=(borderWidth,borderStyle,borderCustomWidth,borderCustomStyle)=>`-${calcBorderWidth(borderWidth,borderStyle,borderCustomWidth,borderCustomStyle)}`,getBackgroundSize=(borderWidth,borderStyle,border1Width,border1Style,border2Width,border2Style)=>`calc(100% + 0.5 * (${calcBorderWidth(borderWidth,borderStyle,border1Width,border1Style)} + ${calcBorderWidth(borderWidth,borderStyle,border2Width,border2Style)}))`,getBorderRadius=(defaultRadius,topLeft,topRight,bottomLeft,bottomRight,shapeStyle="Rectangle")=>{const defaultRadiusWithFallback=null!==defaultRadius?defaultRadius:"0pt",tl=null!==topLeft?topLeft:defaultRadiusWithFallback,tr=null!==topRight?topRight:defaultRadiusWithFallback,bl=null!==bottomLeft?bottomLeft:defaultRadiusWithFallback,br=null!==bottomRight?bottomRight:defaultRadiusWithFallback;switch(shapeStyle){case"Ellipse":return"50% / 50%";case"Rectangle":case"RoundRect":default:return`${tl} ${tr} ${br} ${bl}`}},getBorderRadiusOverflow=(defaultRadius,topLeft,topRight,bottomLeft,bottomRight,shapeStyle="Rectangle")=>"0pt 0pt 0pt 0pt"!==getBorderRadius(defaultRadius,topLeft,topRight,bottomLeft,bottomRight,shapeStyle)?"hidden":"visible",getCommonSet=style=>[style.Border.Width,style.Border.Style],getLeftSet=style=>getCommonSet(style).concat([style.LeftBorder.Width,style.LeftBorder.Style]),getTopSet=style=>getCommonSet(style).concat([style.TopBorder.Width,style.TopBorder.Style]),getBottomSet=style=>getCommonSet(style).concat([style.BottomBorder.Width,style.BottomBorder.Style]),getRightSet=style=>getCommonSet(style).concat([style.RightBorder.Width,style.RightBorder.Style]),getWidthSet=style=>getLeftSet(style).concat([style.RightBorder.Width,style.RightBorder.Style]),getHeightSet=style=>getTopSet(style).concat([style.BottomBorder.Width,style.BottomBorder.Style]),allBordersInvisible=style=>"None"===style.borderStyle&&!style.borderLeftStyle&&!style.borderTopStyle&&!style.borderRightStyle&&!style.borderBottomStyle||!style.borderStyle&&"None"===style.borderLeftStyle&&"None"===style.borderTopStyle&&"None"===style.borderRightStyle&&"None"===style.borderBottomStyle,backgroundInvisible=style=>"Transparent"===style.backgroundColor,roundingInvisible=style=>"0pt 0pt 0pt 0pt"===style.borderRadius,getBackgroundRepeat=repeat=>{switch(repeat.toLowerCase()){case"norepeat":return"no-repeat";case"repeatx":return"repeat-x";case"repeaty":return"repeat-y";default:return repeat}},getBorderStyle=borderStyle=>{switch(borderStyle.toLowerCase()){case"none":case"hidden":case"dotted":case"dashed":case"solid":case"double":case"groove":case"ridge":case"inset":case"outset":return borderStyle;case"dashdot":case"dashdotdot":return"dashed";default:return"solid"}};const svg='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="24" height="24"><g id="_root" style="shape-rendering:geometricPrecision;text-rendering:optimizeLegibility;">',blank=`${svg}</g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`,iconSets={"3trafficlights":[`${svg}<ellipse id="_2" cx="11" cy="11" rx="9" ry="9" clip-path="url(#_1)" style="fill:rgb(54,52,52);stroke:none;" /><ellipse id="_6" cx="11" cy="11" rx="9" ry="9" clip-path="url(#_1)" style="fill:url(#_3);" /><ellipse id="_10" cx="11" cy="11" rx="6" ry="6" clip-path="url(#_1)" style="fill:url(#_7);" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath><radialGradient id="_3" cx="5" cy="5" r="9" gradientUnits="userSpaceOnUse"><stop id="_4" offset="0%" style="stop-color:rgb(85,83,83);" /><stop id="_5" offset="100%" style="stop-color:rgb(54,52,52);" /></radialGradient><radialGradient id="_7" cx="8" cy="8" r="6" gradientUnits="userSpaceOnUse"><stop id="_8" offset="0%" style="stop-color:rgb(139,203,138);" /><stop id="_9" offset="100%" style="stop-color:rgb(36,144,9);" /></radialGradient></defs></svg>`,`${svg}<ellipse id="_2" cx="11" cy="11" rx="9" ry="9" clip-path="url(#_1)" style="fill:rgb(54,52,52);stroke:none;" /><ellipse id="_6" cx="11" cy="11" rx="9" ry="9" clip-path="url(#_1)" style="fill:url(#_3);" /><ellipse id="_10" cx="11" cy="11" rx="6" ry="6" clip-path="url(#_1)" style="fill:url(#_7);" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath><radialGradient id="_3" cx="5" cy="5" r="9" gradientUnits="userSpaceOnUse"><stop id="_4" offset="0%" style="stop-color:rgb(85,83,83);" /><stop id="_5" offset="100%" style="stop-color:rgb(54,52,52);" /></radialGradient><radialGradient id="_7" cx="8" cy="8" r="6" gradientUnits="userSpaceOnUse"><stop id="_8" offset="0%" style="stop-color:rgb(248,229,83);" /><stop id="_9" offset="100%" style="stop-color:rgb(243,205,42);" /></radialGradient></defs></svg>`,`${svg}<ellipse id="_2" cx="11" cy="11" rx="9" ry="9" clip-path="url(#_1)" style="fill:rgb(54,52,52);stroke:none;" /><ellipse id="_6" cx="11" cy="11" rx="9" ry="9" clip-path="url(#_1)" style="fill:url(#_3);" /><ellipse id="_10" cx="11" cy="11" rx="6" ry="6" clip-path="url(#_1)" style="fill:url(#_7);" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath><radialGradient id="_3" cx="5" cy="5" r="9" gradientUnits="userSpaceOnUse"><stop id="_4" offset="0%" style="stop-color:rgb(85,83,83);" /><stop id="_5" offset="100%" style="stop-color:rgb(54,52,52);" /></radialGradient><radialGradient id="_7" cx="8" cy="8" r="6" gradientUnits="userSpaceOnUse"><stop id="_8" offset="0%" style="stop-color:rgb(245,123,120);" /><stop id="_9" offset="100%" style="stop-color:rgb(240,46,47);" /></radialGradient></defs></svg>`,blank,blank],arrows:[`${svg}<path id="_2" d="M 9 19 L 15 19 15 11 19 11 12 5 5 11 9 11 z" clip-path="url(#_1)" style="fill:rgb(103,185,121);stroke:none;fill-rule:evenodd;" /><path id="_3" d="M 9 19 L 15 19 15 11 19 11 12 5 5 11 9 11 z" clip-path="url(#_1)" style="stroke:rgb(50,102,38);stroke-width:1;fill:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`,`${svg}<path id="_2" d="M 8 5 L 19 5 19 16 16 12 9 19 5 15 12 8 z" clip-path="url(#_1)" style="fill:rgb(240,213,108);stroke:none;fill-rule:evenodd;" /><path id="_3" d="M 8 5 L 19 5 19 16 16 12 9 19 5 15 12 8 z" clip-path="url(#_1)" style="stroke:rgb(207,119,17);stroke-width:1;fill:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`,`${svg}<path id="_2" d="M 5 9 L 5 15 12 15 12 19 19 12 12 5 12 9 z" clip-path="url(#_1)" style="fill:rgb(240,213,108);stroke:none;fill-rule:evenodd;" /><path id="_3" d="M 5 9 L 5 15 12 15 12 19 19 12 12 5 12 9 z" clip-path="url(#_1)" style="stroke:rgb(207,119,17);stroke-width:1;fill:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`,`${svg}<path id="_2" d="M 8 19 L 19 19 19 8 16 13 9 5 5 9 12 16 z" clip-path="url(#_1)" style="fill:rgb(240,213,108);stroke:none;fill-rule:evenodd;" /><path id="_3" d="M 8 19 L 19 19 19 8 16 13 9 5 5 9 12 16 z" clip-path="url(#_1)" style="stroke:rgb(207,119,17);stroke-width:1;fill:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`,`${svg}<path id="_2" d="M 9 5 L 15 5 15 13 19 13 12 19 5 13 9 13 z" clip-path="url(#_1)" style="fill:rgb(231,121,116);stroke:none;fill-rule:evenodd;" /><path id="_3" d="M 9 5 L 15 5 15 13 19 13 12 19 5 13 9 13 z" clip-path="url(#_1)" style="stroke:rgb(144,54,38);stroke-width:1;fill:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`],checkbox:[`${svg}<rect id="_2" x="6" y="6" width="12" height="12" clip-path="url(#_1)" style="fill:rgb(255,255,255);stroke:none;" /><rect id="_3" x="6" y="6" width="12" height="12" clip-path="url(#_1)" style="stroke:rgb(26,79,127);stroke-width:1;fill:none;" /><polyline id="_4" points="9 12 11 14 15 10" clip-path="url(#_1)" style="stroke:rgb(31,160,31);stroke-width:2;fill:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`,`${svg}<rect id="_2" x="6" y="6" width="12" height="12" clip-path="url(#_1)" style="fill:rgb(255,255,255);stroke:none;" /><rect id="_3" x="6" y="6" width="12" height="12" clip-path="url(#_1)" style="stroke:rgb(26,79,127);stroke-width:1;fill:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`,blank,blank,blank],flags:[`${svg}<path id="_2" d="M 6 6 C 11 2 12 12 18 10 17 12 15 13 13 13 12 13 11 12 8 11 z" clip-path="url(#_1)" style="fill:rgb(153,211,124);stroke:none;fill-rule:evenodd;" /><path id="_3" d="M 6 6 C 11 2 12 12 18 10 17 12 15 13 13 13 12 13 11 12 8 11 z" clip-path="url(#_1)" style="stroke:rgb(88,140,75);stroke-width:1;fill:none;" /><line id="_4" x1="5" y1="5" x2="11" y2="20" clip-path="url(#_1)" style="stroke:rgb(0,0,0);stroke-width:1;fill:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`,`${svg}<path id="_2" d="M 6 6 C 11 2 12 12 18 10 17 12 15 13 13 13 12 13 11 12 8 11 z" clip-path="url(#_1)" style="fill:rgb(247,218,121);stroke:none;fill-rule:evenodd;" /><path id="_3" d="M 6 6 C 11 2 12 12 18 10 17 12 15 13 13 13 12 13 11 12 8 11 z" clip-path="url(#_1)" style="stroke:rgb(176,160,117);stroke-width:1;fill:none;" /><line id="_4" x1="5" y1="5" x2="11" y2="20" clip-path="url(#_1)" style="stroke:rgb(0,0,0);stroke-width:1;fill:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`,`${svg}<path id="_2" d="M 6 6 C 11 2 12 12 18 10 17 12 15 13 13 13 12 13 11 12 8 11 z" clip-path="url(#_1)" style="fill:rgb(245,121,124);stroke:none;fill-rule:evenodd;" /><path id="_3" d="M 6 6 C 11 2 12 12 18 10 17 12 15 13 13 13 12 13 11 12 8 11 z" clip-path="url(#_1)" style="stroke:rgb(212,65,31);stroke-width:1;fill:none;" /><line id="_4" x1="5" y1="5" x2="11" y2="20" clip-path="url(#_1)" style="stroke:rgb(0,0,0);stroke-width:1;fill:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`,blank,blank],grayarrows:[`${svg}<path id="_2" d="M 9 19 L 15 19 15 11 19 11 12 5 5 11 9 11 z" clip-path="url(#_1)" style="fill:rgb(160,160,160);stroke:none;fill-rule:evenodd;" /><path id="_3" d="M 9 19 L 15 19 15 11 19 11 12 5 5 11 9 11 z" clip-path="url(#_1)" style="stroke:rgb(64,64,64);stroke-width:1;fill:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`,`${svg}<path id="_2" d="M 8 5 L 19 5 19 16 16 12 9 19 5 15 12 8 z" clip-path="url(#_1)" style="fill:rgb(160,160,160);stroke:none;fill-rule:evenodd;" /><path id="_3" d="M 8 5 L 19 5 19 16 16 12 9 19 5 15 12 8 z" clip-path="url(#_1)" style="stroke:rgb(64,64,64);stroke-width:1;fill:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`,`${svg}<path id="_2" d="M 5 9 L 5 15 12 15 12 19 19 12 12 5 12 9 z" clip-path="url(#_1)" style="fill:rgb(160,160,160);stroke:none;fill-rule:evenodd;" /><path id="_3" d="M 5 9 L 5 15 12 15 12 19 19 12 12 5 12 9 z" clip-path="url(#_1)" style="stroke:rgb(64,64,64);stroke-width:1;fill:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`,`${svg}<path id="_2" d="M 8 19 L 19 19 19 8 16 13 9 5 5 9 12 16 z" clip-path="url(#_1)" style="fill:rgb(160,160,160);stroke:none;fill-rule:evenodd;" /><path id="_3" d="M 8 19 L 19 19 19 8 16 13 9 5 5 9 12 16 z" clip-path="url(#_1)" style="stroke:rgb(64,64,64);stroke-width:1;fill:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`,`${svg}<path id="_2" d="M 9 5 L 15 5 15 13 19 13 12 19 5 13 9 13 z" clip-path="url(#_1)" style="fill:rgb(160,160,160);stroke:none;fill-rule:evenodd;" /><path id="_3" d="M 9 5 L 15 5 15 13 19 13 12 19 5 13 9 13 z" clip-path="url(#_1)" style="stroke:rgb(64,64,64);stroke-width:1;fill:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`],quarters:[`${svg}<ellipse id="_2" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="fill:rgb(255,255,255);stroke:none;" /><path id="_3" clip-path="url(#_1)" d="M 19 12 C 19 15.87 15.87 19 12 19 8.13 19 5 15.87 5 12 5 8.13 8.13 5 12 5 15.87 5 19 8.13 19 12 z" style="fill:rgb(0,0,0);stroke:none;fill-rule:evenodd;" /><ellipse id="_4" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="stroke:rgb(0,0,0);stroke-width:1;fill:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`,`${svg}<ellipse id="_2" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="fill:rgb(255,255,255);stroke:none;" /><path id="_3" clip-path="url(#_1)" d="M 12 5 C 15.87 5 19 8.13 19 12 19 15.87 15.87 19 12 19 8.13 19 5 15.87 5 12 L 12 12 z" style="fill:rgb(0,0,0);stroke:none;fill-rule:evenodd;" /><ellipse id="_4" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="stroke:rgb(0,0,0);stroke-width:1;fill:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`,`${svg}<ellipse id="_2" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="fill:rgb(255,255,255);stroke:none;" /><path id="_3" clip-path="url(#_1)" d="M 12 5 C 15.87 5 19 8.13 19 12 19 15.87 15.87 19 12 19 z" style="fill:rgb(0,0,0);stroke:none;fill-rule:evenodd;" /><ellipse id="_4" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="stroke:rgb(0,0,0);stroke-width:1;fill:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`,`${svg}<ellipse id="_2" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="fill:rgb(255,255,255);stroke:none;" /><path id="_3" clip-path="url(#_1)" d="M 12 5 C 15.87 5 19 8.13 19 12 L 12 12 z" style="fill:rgb(0,0,0);stroke:none;fill-rule:evenodd;" /><ellipse id="_4" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="stroke:rgb(0,0,0);stroke-width:1;fill:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`,`${svg}<ellipse id="_2" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="fill:rgb(255,255,255);stroke:none;" /><ellipse id="_3" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="stroke:rgb(0,0,0);stroke-width:1;fill:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`],ratings:[`${svg}<ellipse id="_2" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="fill:rgb(255,0,0);stroke:none;" /><ellipse id="_3" cx="12" cy="12" rx="2" ry="2" clip-path="url(#_1)" style="fill:rgb(255,255,255);stroke:none;" /><ellipse id="_4" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="stroke:rgb(214,0,0);stroke-width:1;fill:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`,`${svg}<ellipse id="_2" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="fill:rgb(255,255,255);stroke:none;" /><path id="_3" clip-path="url(#_1)" d="M 19 12 C 19 8.13 15.87 5 12 5 8.13 5 5 8.13 5 12" style="fill:rgb(255,0,0);stroke:none;fill-rule:evenodd;" /><ellipse id="_4" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="stroke:rgb(214,0,0);stroke-width:1;fill:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`,`${svg}<ellipse id="_2" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="fill:rgb(0,0,0);stroke:none;" /><ellipse id="_3" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="stroke:rgb(0,0,0);stroke-width:1;fill:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`,`${svg}<ellipse id="_2" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="fill:rgb(255,255,255);stroke:none;" /><path id="_3" clip-path="url(#_1)" d="M 19 12 C 19 8.13 15.87 5 12 5 8.13 5 5 8.13 5 12" style="fill:rgb(0,0,0);stroke:none;fill-rule:evenodd;" /><ellipse id="_4" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="stroke:rgb(0,0,0);stroke-width:1;fill:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`,`${svg}<ellipse id="_2" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="fill:rgb(255,255,255);stroke:none;" /><ellipse id="_3" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="stroke:rgb(0,0,0);stroke-width:1;fill:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`],redtoblack:[`${svg}<ellipse id="_2" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="fill:rgb(255,0,0);stroke:none;" /><ellipse id="_3" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="stroke:rgb(214,0,0);stroke-width:1;fill:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`,`${svg}<ellipse id="_2" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="fill:rgb(254,141,137);stroke:none;" /><ellipse id="_3" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="stroke:rgb(238,138,136);stroke-width:1;fill:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`,`${svg}<ellipse id="_2" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="fill:rgb(181,181,181);stroke:none;" /><ellipse id="_3" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="stroke:rgb(167,167,167);stroke-width:1;fill:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`,`${svg}<ellipse id="_2" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="fill:rgb(0,0,0);stroke:none;" /><ellipse id="_3" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="stroke:rgb(0,0,0);stroke-width:1;fill:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`,blank],signs:[`${svg}<ellipse id="_2" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="fill:rgb(97,189,122);stroke:none;" /><ellipse id="_3" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="stroke:rgb(39,94,29);stroke-width:1;fill:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`,`${svg}<path id="_2" d="M 12 5 L 5 19 19 19 z" clip-path="url(#_1)" style="fill:rgb(254,221,105);stroke:none;fill-rule:evenodd;" /><path id="_3" d="M 12 5 L 5 19 19 19 z" clip-path="url(#_1)" style="stroke:rgb(216,113,3);stroke-width:1;fill:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`,`${svg}<path id="_2" d="M 12 5 L 5 12 12 19 19 12 z" clip-path="url(#_1)" style="fill:rgb(245,130,130);stroke:none;fill-rule:evenodd;" /><path id="_3" d="M 12 5 L 5 12 12 19 19 12 z" clip-path="url(#_1)" style="stroke:rgb(144,39,27);stroke-width:1;fill:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`,blank,blank],symbols1:[`${svg}<ellipse id="_2" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="fill:rgb(114,196,136);stroke:none;" /><ellipse id="_3" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="stroke:rgb(38,93,28);stroke-width:1;fill:none;" /><polyline id="_4" points="9 12 11 14 15 10" clip-path="url(#_1)" style="stroke:rgb(255,255,255);stroke-width:2;fill:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`,`${svg}<ellipse id="_2" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="fill:rgb(248,210,126);stroke:none;" /><ellipse id="_3" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="stroke:rgb(212,113,5);stroke-width:1;fill:none;" /><line id="_4" x1="12" y1="8" x2="12" y2="13" clip-path="url(#_1)" style="stroke:rgb(255,255,255);stroke-width:2;fill:none;stroke-linecap:round;" /><ellipse id="_7" cx="12" cy="16" rx="1" ry="1" clip-path="url(#_1)" style="fill:rgb(255,255,255);stroke:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`,`${svg}<ellipse id="_2" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="fill:rgb(255,142,132);stroke:none;" /><ellipse id="_3" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="stroke:rgb(142,41,29);stroke-width:1;fill:none;" /><line id="_4" x1="9" y1="9" x2="15" y2="15" clip-path="url(#_1)" style="stroke:rgb(255,255,255);stroke-width:2;fill:none;" /><line id="_5" x1="9" y1="15" x2="15" y2="9" clip-path="url(#_1)" style="stroke:rgb(255,255,255);stroke-width:2;fill:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`,blank,blank],symbols2:[`${svg}<path id="_2" d="M 6.71 12.29 L 10.86 16.45 17.18 7.43 18.82 8.57 11.14 19.55 5.29 13.71 z" clip-path="url(#_1)" style="fill:rgb(114,196,136);stroke:none;fill-rule:evenodd;" /><path id="_3" d="M 6.71 12.29 L 10.86 16.45 17.18 7.43 18.82 8.57 11.14 19.55 5.29 13.71 z" clip-path="url(#_1)" style="stroke:rgb(38,93,28);stroke-width:1;fill:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`,`${svg}<path id="_2" d="M 13 5 L 13 14 11 14 11 5 z M 11 17 L 11 19 13 19 13 17 z" clip-path="url(#_1)" style="fill:rgb(248,210,126);stroke:none;fill-rule:evenodd;" /><path id="_3" d="M 13 5 L 13 14 11 14 11 5 z M 11 17 L 11 19 13 19 13 17 z" clip-path="url(#_1)" style="stroke:rgb(212,113,5);stroke-width:1;fill:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`,`${svg}<path id="_2" d="M 12 10 L 7 5 5 7 10 12 5 17 7 19 12 14 17 19 19 17 14 12 19 7 17 5 z" clip-path="url(#_1)" style="fill:rgb(255,142,132);stroke:none;fill-rule:evenodd;" /><path id="_3" d="M 12 10 L 7 5 5 7 10 12 5 17 7 19 12 14 17 19 19 17 14 12 19 7 17 5 z" clip-path="url(#_1)" style="stroke:rgb(142,41,29);stroke-width:1;fill:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`,blank,blank],trafficlights:[`${svg}<ellipse id="_2" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="fill:rgb(97,189,122);stroke:none;" /><ellipse id="_3" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="stroke:rgb(39,94,29);stroke-width:1;fill:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`,`${svg}<ellipse id="_2" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="fill:rgb(254,221,105);stroke:none;" /><ellipse id="_3" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="stroke:rgb(216,113,3);stroke-width:1;fill:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`,`${svg}<ellipse id="_2" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="fill:rgb(245,130,130);stroke:none;" /><ellipse id="_3" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="stroke:rgb(144,39,27);stroke-width:1;fill:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`,`${svg}<ellipse id="_2" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="fill:rgb(57,57,57);stroke:none;" /><ellipse id="_3" cx="12" cy="12" rx="7" ry="7" clip-path="url(#_1)" style="stroke:rgb(0,0,0);stroke-width:1;fill:none;" /></g><defs id="_res"><clipPath id="_1"><rect x="0" y="0" width="24" height="24" /></clipPath></defs></svg>`,blank],blank:[blank,blank,blank,blank,blank]},getImageUri=(source,MIMEType,valueRaw)=>{const value=toString$1(valueRaw);if(!value)return null;switch(source){case"External":return isDataUrl(url=value)&&/^.{0,100}base64/i.test(url)?decodeURIComponent(value):value;case"Database":case"Embedded":const decodedValue=decodeURIComponent(value),mimeType=toString$1(MIMEType).toLowerCase()||(value=>{if(value)switch(value.charAt(0)){case"i":return"image/png";case"Q":return"image/bmp";case"/":return"image/jpeg";case"R":return"image/gif";case"<":return"image/svg+xml"}return""})(value);return decodedValue.startsWith("<")?((MIMEType,value)=>`data:${MIMEType};charset=utf8,${encodeURIComponent(value)}`)(mimeType,decodedValue):((MIMEType,value)=>`data:${MIMEType};base64,${value}`)(mimeType,decodedValue);default:return null}var url};function renderIconSet(iconSetData){const imageIndex=iconSetData.Args.findIndex((a=>a)),iconSet=(name=iconSetData.Name,iconSets[name.toLowerCase()]||iconSets["3trafficlights"]);var name;const imageData=iconSet.length>imageIndex&&imageIndex>-1?iconSet[imageIndex]:"";return imageData?`url("data:image/svg+xml;charset=utf8,${encodeURIComponent(imageData)}")`:""}function compileImageData(bgImage,comp,getResourceUri){const source=bgImage.Source,compiledMimeType=comp(bgImage.MIMEType),tokens=bgImage.Value?tokenize(bgImage.Value):[];if(bgImage.Value&&"="===bgImage.Value[0]&&tokens.length>1&&["databar","rangebar","rangebarprogress","iconset"].indexOf(tokens[1].toLowerCase())>-1){if("Database"!==source)return{Source:source,MIMEType:compiledMimeType,Value:null};const splitted=splitExpression(tokens),compiledParts=splitted&&splitted.map((ex=>comp(ex)))||[];let Value;switch(tokens[1].toLowerCase()){case"databar":Value=data=>function(dataBar){const barColor=dataBar.Value>=dataBar.Zero?dataBar.Color:dataBar.NegativeColor,barLength=Math.abs((dataBar.Value-dataBar.Zero)/(dataBar.Maximum-dataBar.Minimum)),startPosition=dataBar.Value>=dataBar.Zero?(dataBar.Zero-dataBar.Minimum)/(dataBar.Maximum-dataBar.Minimum):(dataBar.Value-dataBar.Minimum)/(dataBar.Maximum-dataBar.Minimum),v1=100*Math.max(0,Math.min(1,startPosition)),v2=100*Math.max(0,Math.min(1,startPosition+barLength));return`url("data:image/svg+xml;charset=utf8,${encodeURIComponent(`<svg xmlns='http://www.w3.org/2000/svg' height='100%' width='100%'><rect x='${v1}%' y='0%' width='${v2-v1}%' height='100%' fill='${barColor}' /></svg>`)}")`}({Value:resolveCompiled$1(compiledParts[0],data),Minimum:resolveCompiled$1(compiledParts[1],data),Maximum:resolveCompiled$1(compiledParts[2],data),Zero:resolveCompiled$1(compiledParts[3],data),Color:(resolveCompiled$1(compiledParts[4],data)||"").toString(),NegativeColor:(resolveCompiled$1(compiledParts[compiledParts.length-1],data)||"").toString()});break;case"rangebar":Value=data=>function(rangeBar){const pbarLength=rangeBar.Length/(rangeBar.Maximum-rangeBar.Minimum),pbStartPosition=(rangeBar.StartValue-rangeBar.Minimum)/(rangeBar.Maximum-rangeBar.Minimum),v1=100*Math.max(0,Math.min(1,pbStartPosition)),v2=100*Math.max(0,Math.min(1,pbarLength));let barRect;return barRect=rangeBar.Maximum<=rangeBar.Minimum?"":v2>0&&v1<100?`<rect x='${v1}%' y='25%' width='${v2}%' height='50%' fill='${rangeBar.Color}' />`:`<svg xmlns='http://www.w3.org/2000/svg' width='100%' height='50%' x='${v1-50}%' y='25%' viewBox='0 0 2 2'><path fill='${rangeBar.Color}' d='M0,1 L1,0 L2,1 L1,2 L0,1 z'/></svg>`,`url("data:image/svg+xml;charset=utf8,${encodeURIComponent(`<svg xmlns='http://www.w3.org/2000/svg' height='100%' width='100%'>${barRect}</svg>`)}")`}({Minimum:resolveCompiled$1(compiledParts[0],data),Maximum:resolveCompiled$1(compiledParts[1],data),Color:(resolveCompiled$1(compiledParts[2],data)||"").toString(),StartValue:resolveCompiled$1(compiledParts[3],data),Length:resolveCompiled$1(compiledParts[4],data)});break;case"rangebarprogress":Value=data=>function(rangeBar){const progressLength=rangeBar.ProgressLength/(rangeBar.Maximum-rangeBar.Minimum),pbarLength=rangeBar.Length/(rangeBar.Maximum-rangeBar.Minimum),pbStartPosition=(rangeBar.StartValue-rangeBar.Minimum)/(rangeBar.Maximum-rangeBar.Minimum),v1=100*Math.max(0,Math.min(1,pbStartPosition)),v2=v1<100?100*Math.max(0,Math.min(1,progressLength)):0,v3=100*Math.max(0,Math.min(1,pbarLength));let progressRect,barRect;return rangeBar.Maximum<=rangeBar.Minimum?(progressRect="",barRect=""):(progressRect=v2>0&&v1<100?`<rect x='${v1}%' y='37.5%' width='${v2}%' height='25%' fill='${rangeBar.ProgressColor}' />`:`<svg xmlns='http://www.w3.org/2000/svg' width='100%' height='25%' x='${v1-50}%' y='37.5%' viewBox='0 0 2 2'><path fill='${rangeBar.ProgressColor}' d='M0,1 L1,0 L2,1 L1,2 L0,1 z'/></svg>`,barRect=v3>0&&v1<100?`<rect x='${v1}%' y='25%' width='${v3}%' height='50%' fill='${rangeBar.Color}' />`:`<svg xmlns='http://www.w3.org/2000/svg' width='100%' height='50%' x='${v1-50}%' y='25%' viewBox='0 0 2 2'><path fill='${rangeBar.Color}' d='M0,1 L1,0 L2,1 L1,2 L0,1 z'/></svg>`),`url("data:image/svg+xml;charset=utf8,${encodeURIComponent(`<svg xmlns='http://www.w3.org/2000/svg' height='100%' width='100%'>${barRect}${progressRect}</svg>`)}")`}({Minimum:resolveCompiled$1(compiledParts[0],data),Maximum:resolveCompiled$1(compiledParts[1],data),Color:(resolveCompiled$1(compiledParts[2],data)||"").toString(),StartValue:resolveCompiled$1(compiledParts[3],data),Length:resolveCompiled$1(compiledParts[4],data),ProgressColor:(resolveCompiled$1(compiledParts[5],data)||"").toString(),ProgressLength:resolveCompiled$1(compiledParts[6],data)});break;case"iconset":Value=data=>renderIconSet({Name:resolveCompiled$1(compiledParts[0],data),Args:[toBoolean(resolveCompiled$1(compiledParts[1],data)),toBoolean(resolveCompiled$1(compiledParts[2],data)),toBoolean(resolveCompiled$1(compiledParts[3],data)),toBoolean(resolveCompiled$1(compiledParts[4],data)),toBoolean(resolveCompiled$1(compiledParts[5],data))]});break;default:Value=()=>""}return{Source:source,MIMEType:compiledMimeType,Value:Value}}{const compiledValue=comp(bgImage.Value);if("embedded"===source.toLowerCase())return{Source:source,MIMEType:compiledMimeType,Value:compiledValue};const getValue=(mimeType,value)=>((source,MIMEType,valueRaw)=>{const uri=getImageUri(source,MIMEType,valueRaw);return uri?(uri=>`url("${uri}")`)(uri):null})(source,mimeType,"External"===source&&"string"==typeof value&&value.length>0&&!isDataUrl(value)?getResourceUri(value):value);return{Source:source,MIMEType:compiledMimeType,Value:"function"==typeof compiledValue||"function"==typeof compiledMimeType?data=>getValue(safeResolveCompiledData(compiledMimeType,data),safeResolveCompiledData(compiledValue,data)):getValue(compiledMimeType,compiledValue)}}}function compileBackgroundImageData(bgImage,comp,getResourceUri){return Object.assign(Object.assign({},compileImageData(bgImage,comp,getResourceUri)),{BackgroundRepeat:comp(bgImage.BackgroundRepeat)})}function getEmbeddedImageClass(backgroundImage,embeddedImageResolver){return data=>backgroundImage&&embeddedImageResolver(backgroundImage.Source,resolveCompiled$1(backgroundImage.Value,data))}const isDataUrl=url=>/^data:/i.test(url);function makeRender$d(compiledItem,embeddedImageResolver){const roundingStyle=createRoundingOnlyStyle(compiledItem.RoundingRadius,compiledItem.ShapeStyle),borderStyle=createBordersOnlyStyle(compiledItem),bgStyle=createBackgroundOnlyStyle(compiledItem),bgImageClassName=getEmbeddedImageClass(compiledItem.BackgroundImage,embeddedImageResolver),zIndex=compiledItem.ZIndex;if(!borderStyle&&!bgStyle&&!roundingStyle)return{styles:[],render:()=>item=>{var _a;return(null===(_a=null==item?void 0:item.properties)||void 0===_a?void 0:_a.style)&&(item.properties.style.zIndex=zIndex),item}};if(!borderStyle){const contentStyle=(bgStyle&&roundingStyle?joinStyles$2([bgStyle,roundingStyle]):bgStyle)||roundingStyle;return contentStyle.static.zIndex=zIndex,makeRenderWithBg(`${compiledItem.Name}`,contentStyle,bgImageClassName)}const bordersWithSize=joinStyles$2([borderStyle,createBorderSizeAndLocation(compiledItem),roundingStyle].filter(Boolean));return function(itemName,borderStyle,bgStyle,roundingStyle,zIndex,bgImageClassName,arrangeBSize){const contentStyle=bgStyle&&roundingStyle?joinStyles$2([bgStyle,roundingStyle]):bgStyle||roundingStyle,wrapContent=contentStyle&&makeRenderWithBg(itemName,contentStyle,bgImageClassName),contentStaticStyle=wrapContent&&wrapContent.styles[0],borderClassName=Object.keys(borderStyle.static).length>0?`${itemName}BordersStyle`:null,staticStyles=[];contentStaticStyle&&staticStyles.push(contentStaticStyle);borderClassName&&staticStyles.push({className:borderClassName,style:borderStyle.static});return{styles:staticStyles,render:(data,ctx)=>(content,arrangement)=>{const borderStyleDynamic=borderStyle.dynamic(data);borderStyleDynamic.style=Object.assign(Object.assign({},borderStyleDynamic.style),arrangeBSize(data,arrangement));const contentWithBg=wrapContent?wrapContent.render(data,ctx)(content):content;return function(borderClassName,borderStyle,zIndex,content,renderContext){if(null===content)return null;const width=content.properties.style.width,height=content.properties.style.height;content.properties.style.width="100%",content.properties.style.height="100%",content.properties.className=content.properties.className?`${content.properties.className} arjs-placeItem`:"arjs-placeItem";const borderPatcher=createStylePatcher(renderContext,borderStyle),contentPatcher=content?content.properties.patcher:null,patcher=joinPatchers(borderPatcher.patcher,contentPatcher);return h("div",{style:{width:width,height:height,zIndex:zIndex},patcher:patcher},[content,h("div",{id:borderPatcher.id,className:`arjs-placeItem ${borderClassName||""} arjs-bordersItem`,style:borderStyle&&borderStyle.style},[])])}(borderClassName,borderStyleDynamic,zIndex,contentWithBg,ctx)}}}(`${compiledItem.Name}`,bordersWithSize,bgStyle,roundingStyle,zIndex,bgImageClassName,arrangeBordersSize(compiledItem))}function makeRenderWithBg(itemName,style,bgImageClassName){const className=Object.keys(style.static).length>0?`${itemName}DecorStyle`:"";return{styles:[{className:className,style:style?style.static:{}}],render:(data,ctx)=>content=>function(className,style,content,renderContext){if(null===content)return null;"function"!=typeof className&&(content.properties.className=joinClassNames(content.properties.className,className)),content.properties.style=Object.assign(Object.assign({},content.properties.style),style.style);const contentPatcher=content?content.properties.patcher:null,stylePatcher=createStylePatcher(renderContext,style,content.properties.id);stylePatcher.patcher&&(content.properties.patcher=joinPatchers(stylePatcher.patcher,contentPatcher),content.properties.id=stylePatcher.id);const bgImageClassNamePatcher=createClassNamePatcher(renderContext,className,content.properties.id);return bgImageClassNamePatcher.patcher&&(content.properties.patcher=joinPatchers(bgImageClassNamePatcher.patcher,contentPatcher),content.properties.id=bgImageClassNamePatcher.id),content}(wrapRuntimeValue(resolveCompiled$1(bgImageClassName,data),(value=>joinClassNames(className,value))),style.dynamic(data),content,ctx)}}const arrangeBordersSize=originalBorders=>(data,arrangement)=>{if(arrangement.HLast&&arrangement.HFirst&&arrangement.VFirst&&arrangement.VLast)return{};const borders=clone(originalBorders);arrangement.HFirst||(borders.LeftBorder.Style="None"),arrangement.VFirst||(borders.TopBorder.Style="None"),arrangement.HLast||(borders.RightBorder.Style="None"),arrangement.VLast||(borders.BottomBorder.Style="None");const bordersSize=createBorderSizeAndLocation(borders),bStyle=Object.assign(Object.assign({},bordersSize.static),bordersSize.dynamic(data).style);return arrangement.HFirst||(bStyle.borderLeftStyle="none"),arrangement.VFirst||(bStyle.borderTopStyle="none"),arrangement.HLast||(bStyle.borderRightStyle="none"),arrangement.VLast||(bStyle.borderBottomStyle="none"),bStyle};function joinStyles$2(styles){return{static:Object.assign({},...styles.map((s=>s.static))),dynamic:data=>{const dynamics=styles.map((s=>s.dynamic(data)));return{style:Object.assign({},...dynamics.map((s=>s.style))),renderTimeStyle:dynamics.some((s=>null!==s.renderTimeStyle))?globals=>Object.assign({},...dynamics.map((s=>null===s.renderTimeStyle?{}:s.renderTimeStyle(globals)))):null}}}}function listLayout(list,listItems,width,height,fragmentFactory){const items=LazyList.fromIterable(listItems);if(!items){const empty=L2.Divisible(width,height,((w,h)=>fragmentFactory.createEmpty(w,h)));return L2.VerticalStack(LazyList.cons(empty),fragmentFactory.createStack,fragmentFactory.createEmpty)}const itemsWithPb=PageBreakList(list.GroupPageBreak)(items),layout=list.RowsOrColumnsCount<=1?L2.VerticalStack(itemsWithPb,fragmentFactory.createStack,fragmentFactory.createEmpty):function(items,options,fragmentFactory){return"Vertical"===options.Direction?GridVertical(items,options,fragmentFactory):GridHorizontal(items,options,fragmentFactory)}(itemsWithPb,{Count:list.RowsOrColumnsCount,Direction:"Row"===list.GrowDirection||"RowReverse"===list.GrowDirection?"Horizontal":"Vertical",Width:width,Reverse:"ColumnReverse"===list.GrowDirection||"RowReverse"===list.GrowDirection},fragmentFactory);return L.SuppressPageBreaks(layout,"Start"===list.PageBreak||"StartAndEnd"===list.PageBreak)}function GridVertical(items,options,fragmentFactory){return space=>{const fail=LResult.Fail();if(space<=0)return fail;const{rowsSlice:rows,remainder:remainder}=function(items,options,vspace,fragmentFactory){const rows=[];let list=items,remainder=list;for(;null!=list;){const rowTemp=[];for(;null!=list&&rowTemp.length<options.Count;){const slice=list.Head(vspace);rowTemp.push(slice),list=list.Tail}if(!rowTemp.every((it=>it.IsCompleted())))break;const rowHeight=Math.max(...rowTemp.map((it=>it.Size))),row=rowTemp.map((it=>LResult.Complete(rowHeight,L.ConvertBody(it.Body,(b=>fragmentFactory.setHeight(rowHeight,b))))));if(vspace-=rowHeight,row.length<options.Count){const empty=LResult.Complete(rowHeight,L.Empty(fragmentFactory.createEmpty(options.Width,rowHeight),options.Width));let n=options.Count-row.length;for(;n-- >0;)row.push(empty)}options.Reverse&&row.reverse(),rows.push(row),remainder=list}return{rowsSlice:rows,remainder:remainder}}(items,options,space,fragmentFactory),tail=null!=remainder?GridVertical(remainder,options,fragmentFactory):null;if(0===rows.length)return null!=tail?LResult.PageBreak(tail):LResult.Fail();const head=SliceRowsByWidth(rows,options,fragmentFactory.createStack),size=sum(rows.map((r=>r[0].Size)));return LResult.SplitOrComplete(size,head,tail)}}function SliceRowsByWidth(rows,options,renderStack){return space=>{const taken=[],remainder=[];let rowWidth=0;for(const row of rows){let pos=0;const rowsTaken=[],rowsReminder=[];for(const item of row){const nextPos=pos+options.Width;if(nextPos<=space){const slice=item.Body(space);rowsTaken.push({Width:slice.Size,Height:item.Size,Content:slice.Body}),pos=nextPos}else rowsReminder.push(item)}rowsTaken.length>0&&taken.push(rowsTaken),rowsReminder.length>0&&remainder.push(rowsReminder),rowWidth=Math.max(pos,rowWidth)}if(0==taken.length)return LResult.Fail();const stack=function(list,rowWidth,renderStack){const fragments=list.map((row=>MakeFragment(row,row[0].Height,rowWidth,"Horizontal",renderStack))),height=sum(list.map((r=>r[0].Height)));return renderStack("Vertical",rowWidth,height,fragments)}(taken,rowWidth,renderStack);return 0==remainder.length?LResult.Complete(rowWidth,stack):LResult.Split(rowWidth,stack,SliceRowsByWidth(remainder,options,renderStack))}}function GridHorizontal(items,options,fragmentFactory,isFirst=!0){return space=>{const fail=LResult.Fail();if(space<=0)return fail;const{columnsSlice:cols,remainder:remainder}=function(items,options,vspace,fragmentFactory,isFirst=!1){const remainder=[],tempCols=[];let list=items;for(;null!=list;){const col=[];for(;null!=list&&col.length<options.Count;)col.push(list.Head),list=list.Tail;if(tempCols.length>0&&tempCols[0].length>col.length&&isFirst){let n=tempCols[0].length-col.length;for(;n-- >0;)col.push(null)}isFirst&&options.Reverse&&col.reverse(),tempCols.push(col)}const cols=tempCols.map((()=>[]));for(let i=0;i<tempCols[0].length;i++){const row=tempCols.map((col=>{var _a;return null===(_a=col[i])||void 0===_a?void 0:_a.call(col,vspace)}));if(!row.every((r=>null==r||r.IsCompleted()))){const slicedRows=cols[0].length;for(const tempCol of tempCols)remainder.push(...tempCol.slice(slicedRows));break}{const rowHeight=Math.max(...row.map((cell=>{var _a;return null!==(_a=null==cell?void 0:cell.Size)&&void 0!==_a?_a:0})));cols.forEach(((c,i)=>c.push(LResult.Complete(rowHeight,row[i]?L.ConvertBody(row[i].Body,(b=>fragmentFactory.setHeight(rowHeight,b))):L.Empty(fragmentFactory.createEmpty(options.Width,rowHeight),options.Width))))),vspace-=rowHeight}}return{columnsSlice:cols,remainder:LazyList.fromArray(remainder)}}(items,options,space,fragmentFactory,isFirst),size=sum(cols[0].map((cell=>cell.Size)));let tail=null!=remainder?GridHorizontal(remainder,options,fragmentFactory,!1):null;if(void 0===cols.find((c=>c.length>0)))return null!=tail?LResult.PageBreak(tail):LResult.Fail();const head=SliceColsByWidth(cols,options,fragmentFactory);if(remainder&&cols.length>0&&cols[0].length<options.Count){tail=GridHorizontal(remainder,Object.assign(Object.assign({},options),{Count:options.Count-cols[0].length}),fragmentFactory,!1)}return LResult.SplitOrComplete(size,head,tail)}}function SliceColsByWidth(cols,options,fragmentFactory){return space=>{const taken=[];for(const col of cols){const cells=col.map((c=>{var _a;return{Height:c.Size,Cell:null===(_a=c.Body)||void 0===_a?void 0:_a.call(c,space)}}));let columnWidth=Math.max(...cells.map((c=>{var _a,_b;return null!==(_b=null===(_a=c.Cell)||void 0===_a?void 0:_a.Size)&&void 0!==_b?_b:0})));if(columnWidth>space&&(columnWidth=space),columnWidth>0&&(taken.push(cells.map((({Height:Height,Cell:Cell})=>{var _a;return{Height:Height,Width:columnWidth,Content:null!==(_a=null==Cell?void 0:Cell.Body)&&void 0!==_a?_a:fragmentFactory.createEmpty(columnWidth,Height)}}))),space-=columnWidth),0===columnWidth||cells.some((c=>{var _a;return null===(_a=c.Cell)||void 0===_a?void 0:_a.Tail})))break}const remainder=cols.slice(taken.length);if(0==taken.length)return LResult.Fail();const stack=function(list,options,fragmentFactory){const width=sum(list.map((r=>r[0].Width))),height=sum(list[0].map((r=>r.Height))),fragments=list.map((row=>MakeFragment(row,height,options.Width,"Vertical",fragmentFactory.createStack))),stack=fragmentFactory.createStack("Horizontal",width,height,fragments);return{Width:width,Body:stack}}(taken,options,fragmentFactory);return 0==remainder.length?LResult.Complete(stack.Width,stack.Body):LResult.Split(stack.Width,stack.Body,SliceColsByWidth(remainder,options,fragmentFactory))}}function MakeFragment(columns,height,width,direction,renderStack){return renderStack(direction,width,height,columns.map((col=>col.Content)).filter(isNotNull))}function setDataSet(def,ctx){if(null===ctx.ScopeDataSet||def.DataSetName&&def.DataSetName.toLowerCase()!==ctx.ScopeDataSet.toLowerCase()){const regionDataSet=ctx.GetDataSet(def.DataSetName);if("fixedpage"===def.Type&&!regionDataSet)return[compiled=>compiled,ctx];if(!regionDataSet)throw new Error(ctx.i18n.t("core:errors.invalid-datasetname",{defaultValue:'Invalid DataSetName: "{{dataSetName}}"',dataSetName:def.DataSetName,interpolation:{escapeValue:!1}}));const dataSetDef=__rest$1(regionDataSet,["ParentName"]),parameters="fixedpage"!==def.Type&&"dataset"!==def.Type?dataSetDef.Parameters.map((p=>def.DataSetParameters.find((ep=>ep.Name.toLowerCase()===p.Name.toLowerCase()))||p)):[];return[compiled=>(dataSetDef.Content=compiled.Query,dataSetDef.Parameters=parameters,{Query:{Fields:[],Regions:[dataSetDef]},Layout:(d,ctx)=>{const withData=compiled.Layout(d.Regions[0].Scope,ctx),scopeId=d.Regions[0].Scope.Id;return actions=>withData(getScopeActions(actions,scopeId))},DocumentMap:(d,ctx)=>{const withData=compiled.DocumentMap(d.Regions[0].Scope,ctx),scopeId=d.Regions[0].Scope.Id;return actions=>withData(getScopeActions(actions,scopeId))},Styles:compiled.Styles}),Object.assign(Object.assign({},ctx),{ScopeDataSet:dataSetDef.Name})]}return[compiled=>compiled,ctx]}function dataRegion(compileItem){return function(definition,parentContext){return __awaiter(this,void 0,void 0,(function*(){let nestedDataSets=function(dataSetName,ctx){const result=[];let dataSet,parentDataSet=dataSetName;for(;parentDataSet;){if(dataSet=ctx.GetDataSet(parentDataSet),!dataSet)throw new ReportCompilationError(`Invalid DataSet parent name "${parentDataSet}" .`);parentDataSet=dataSet.ParentName,parentDataSet&&result.unshift({Type:"dataset",Name:dataSet.Name,DataSetName:parentDataSet})}return result}(definition.DataSetName,parentContext);const setDsFns=[];let ctx=parentContext;if(null!=parentContext.ScopeDataSet){const scopeDataSetIndex=nestedDataSets.findIndex((nestedDS=>nestedDS.Name===parentContext.ScopeDataSet));-1!==scopeDataSetIndex&&(nestedDataSets=nestedDataSets.slice(scopeDataSetIndex+1))}for(const nestedDs of nestedDataSets){const[setParentDs,childCtx]=setDataSet(nestedDs,ctx);setDsFns.unshift(setParentDs),ctx=childCtx}const[setDs,context]=setDataSet(definition,ctx),dataRegionContext=Object.assign(Object.assign({},context),{Layout:Object.assign(Object.assign({},context.Layout),{CanChangeItemsSize:"fixedpage"!==definition.Type})}),item=yield compileItem(definition,dataRegionContext);let setHierarchyDataSet=setDs;for(const setDsFn of setDsFns){const setChildDs=setHierarchyDataSet;setHierarchyDataSet=ci=>setDsFn(setChildDs(ci))}return setHierarchyDataSet(item)}))}}function compileNoRowsMessage(itemCompiled,dataRegion,context){return __awaiter(this,void 0,void 0,(function*(){if(!dataRegion.NoRowsMessage)return itemCompiled;const tb=createTextBox(`__${dataRegion.Name}_NoRowsMessage__`);tb.Value=dataRegion.NoRowsMessage,tb.Style=Object.assign(Object.assign({},tb.Style),dataRegion.Style),tb.LayerName=dataRegion.LayerName;const tbSite=isSelfSited(dataRegion)?wrapWithSite(tb):tb,tbCompiled=yield compile$2(tbSite,context),regionQuery=itemCompiled.Query.Regions[0];regionQuery.Content||(regionQuery.Content={Fields:[],Regions:[]});const dataMap=combineDataQuery(regionQuery.Content,tbCompiled.Query),noRowsLayout=tbCompiled.Layout;return tbCompiled.Layout=(data,ctx)=>noRowsLayout(dataMap(data),ctx),{Query:itemCompiled.Query,Layout:(data,ctx)=>actions=>hasRows(regionQuery,data.Regions[0])?itemCompiled.Layout(data,ctx)(actions):tbCompiled.Layout(data.Regions[0].Scope,ctx)(actions),Styles:itemCompiled.Styles.concat(tbCompiled.Styles),DocumentMap:itemCompiled.DocumentMap}}))}function hasRows(query,regionData){switch(query.type){case"list":return(regionData.Groups||[]).length>0;case"tablix":{const data=regionData;if(tablixMembersNotEmpty(query.ColumnMembers,data.ColumnMembers)||tablixMembersNotEmpty(query.RowMembers,data.RowMembers))return!0;for(let r=0;r<(data.Body||[]).length;r++){const rd=GetCollectionItem(data.Body,r),rq=query.Body[r];for(let c=0;c<(rd.Cells||[]).length;c++){const cd=rd.Cells[c];if(scopeNotEmpty(rq.Cells[c],cd))return!0}}return!1}case"subreport":{const reportData=GetCollectionItem(regionData.Groups,0),reportQuery=query.Report.Content;return 0===reportQuery.Regions.length||scopeNotEmpty(reportQuery,Object.assign(Object.assign({},reportData),{"@":[]}))}case"dataset":return scopeNotEmpty(query.Content,Object.assign(Object.assign({},regionData.Scope),{"@":[]}))}return!1}function scopeNotEmpty(query,scope){return!(!scope["@"]||void 0===scope["@"].find((v=>null!==v)))||!!zipWith(scope.Regions,query.Regions,((d,r)=>[d,r])).find((dr=>hasRows(dr[1],dr[0])))}function tablixMembersNotEmpty(query,data){if(!query||!data)return!1;for(let i=0;i<query.length;i++)if(tablixMemberNotEmpty(query[i],GetCollectionItem(data,i)))return!0;return!1}function tablixMemberNotEmpty(query,data){if(data.IsCollection){for(const mcoldata of data.Members||[])if(tablixMemberNotEmpty(query,mcoldata))return!0;return!1}return!(!query.Header||!scopeNotEmpty(query.Header,data.Header))||!!tablixMembersNotEmpty(query.Members,data.Members)}const Arrangements={None:{First:!1,Last:!1},Both:{First:!0,Last:!0},First:{First:!0,Last:!1},Last:{First:!1,Last:!0}};function LayoutGridCells(stripes,options,makeLayoutResult){if(!stripes)throw new LayoutError("ArgumentNullException: stripes");return function(items){const rowsCount=items.map((col=>sum(col.Cells.map((c=>c.RowSpan))))).toArray(),columnCount=items.count;let cnt=0;if(Math.max(...items.map((c=>cnt+++Math.max(...c.Cells.map((cell=>cell.ColSpan))))).toArray())!==columnCount)throw new LayoutError("Last column hangs");if(Math.min(...rowsCount)!==Math.max(...rowsCount))throw new LayoutError("Rows count mismatch")}(stripes),space=>{if(space<=0)return LResult.Fail();let availableSpace=space;const taken=[];let remained=stripes,breakBefore=!1,breakAfter=!1;for(;null!==remained&&availableSpace>0;){const _a=LayoutStripe(availableSpace,remained.Head,taken.length,taken&&taken[taken.length-1]),{BreakBefore:brBefore,BreakAfter:brAfter}=_a,column=__rest$1(_a,["BreakBefore","BreakAfter"]);if(breakBefore=brBefore,breakAfter=brAfter,"y"===column.IsFailed){if(remained=UpdateRemainedColumns(availableSpace,remained,column),breakBefore&&0===taken.length)return LResult.PageBreak(LayoutGridCells(remained,options,makeLayoutResult));break}if(availableSpace-=column.Size,taken.push(column),remained.Head.PageBreakAfter){remained=remained.Tail;break}if(remained=remained.Tail,column.IsSplit)break;if(null!==remained&&remained.Head.PageBreakBefore&&taken.length>options.HeaderColumnCount)break}if(0===taken.length)return LResult.Fail();let lastStripe=taken[taken.length-1];const over=Math.max(...lastStripe.IncompletedSpans.map((s=>s.Over)).concat(0));if(lastStripe=function(column,over){if(0===over)return column;const cells=column.Cells.map((cell=>CellInfoF.AccumulateSize(cell,over)));return Col.UpdateSizeAndCells(column,column.Size+over,cells)}(lastStripe,over),lastStripe.IsSplit){lastStripe=UpdateLastStripeCells(lastStripe,!0),taken[taken.length-1]=lastStripe;const column=(lastColumn=lastStripe,fill=options.Filler,MakeStripe(lastColumn.Cells.map((lastCell=>CreateNextCell(lastCell,lastCell.EndColumn-lastColumn.Index+1,fill))),lastColumn.MinSize-lastColumn.Size));remained=LazyList.cons(column,remained)}else if(lastStripe.IncompletedSpans.length){if(null===remained)throw new LayoutError("Column/Row with holes for incompleted spans must exist.");lastStripe=UpdateLastStripeCells(lastStripe,!1),taken[taken.length-1]=lastStripe;const column=function(nextColumn,lastColumn,fill){const nextStartRows=nextColumn.Cells.reduce(((startRows,cell)=>LazyList.cons(cell.RowSpan+startRows.Head,startRows)),LazyList.cons(0)).Tail.Reverse(),lastCells=keyBy(lastColumn.Cells,"StartRow");return MakeStripe((array1=nextColumn.Cells,array2=nextStartRows.toArray(),fn=(nextCell,row)=>{const lastCell=lastCells[row],nextColSpan=void 0!==lastCell?lastCell.EndColumn-lastColumn.Index:0;return nextColSpan>0?CreateNextCell(lastCell,nextColSpan,fill):nextCell},array1.forEach(((v,i)=>array1[i]=fn(v,array2[i]))),array1),nextColumn.MinSize);var array1,array2,fn}(remained.Head,lastStripe,options.Filler);column.PageBreakAfter=remained.Head.PageBreakAfter,remained=LazyList.cons(column,remained.Tail)}var lastColumn,fill;const size=sum(taken.map((c=>c.Size))),head=taken.map((c=>{return col=c,columnCount=taken.length,MakeStripeLayoutResult(flatten$1(col.Cells.map((c=>{const colspan=Math.min(col.Index+c.ColSpan,columnCount)-col.Index,result=[c.StartColumn<col.Index?MakeResultCellHole(c.RowSpan,c.Item):MakeResultCell(c.Result.Body,c.RowSpan,colspan,c.Width,c.Item,c.Arrangement,c.ArrangementPrev)],holesCount=c.RowSpan-1;return holesCount>0?result.concat(range(holesCount).map((()=>MakeResultCellHole(0,null)))):result}))),col.Size);var col,columnCount}));return makeLayoutResult(size,lastStripe.IsSplit,breakAfter,head,remained)}}function LayoutStripe(space,inputColumn,columnIndex,previousColumn){const spans=keyBy(previousColumn&&previousColumn.IncompletedSpans,"StartRow"),cells=[];let row=0,columnSize=0;const columnMinSize=inputColumn.MinSize;let columnIsSplit=!1,breakBefore=!1,breakAfter=!1;for(let i=0;i<inputColumn.Cells.length;i++){const cell=inputColumn.Cells[i];if(cell.Layout){const slice=cell.Layout(space);if(slice.IsFailed()||slice.IsPageBreak())return breakBefore=slice.IsPageBreak(),Object.assign(Object.assign({},Col.Failed(i)),{BreakBefore:breakBefore,BreakAfter:breakAfter});slice.IsPageBreakAfter()&&(breakAfter=slice.IsPageBreakAfter());1===cell.ColSpan&&(columnIsSplit=columnIsSplit||slice.IsSplit(),columnSize=Math.max(columnSize,slice.Size)),cells.push(CellInfoF.New(columnIndex,row,cell,slice,slice.Size))}else{const span=spans[row];span.EndColumn===columnIndex&&(columnIsSplit=columnIsSplit||span.Result.IsSplit(),columnSize=Math.max(columnSize,span.Over)),cells.push(span)}row+=cell.RowSpan}if(!columnIsSplit){const minSize=Math.min(space,columnMinSize);columnSize=Math.max(columnSize,minSize),columnIsSplit=columnSize<columnMinSize}const columnCells=cells.map((cell=>CellInfoF.AccumulateSize(cell,columnSize)));return Object.assign(Object.assign({},Col.New(columnIndex,columnSize,columnMinSize,columnIsSplit,columnCells)),{BreakBefore:breakBefore,BreakAfter:breakAfter})}function UpdateLastStripeCells(lastColumn,splitLastColumn){const cells=lastColumn.Cells.map((lastCell=>{return lastCell.EndColumn-lastColumn.Index+(splitLastColumn?1:0)>0&&!lastCell.Repeat?(cell=lastCell,arrangement=lastCell.Arrangement,Object.assign(Object.assign({},cell),{Arrangement:arrangement})):lastCell;var cell,arrangement}));return Col.UpdateCells(lastColumn,cells)}function CreateNextCell(lastCell,nextColSpan,fill){var _a;const repeatCell=lastCell.Repeat,layout=repeatCell?lastCell.Layout:null!==(_a=lastCell.Result.Tail)&&void 0!==_a?_a:fill({colSpan:nextColSpan,rowSpan:lastCell.RowSpan,item:lastCell.Result.Body}),arrangement=repeatCell?Arrangements.Both:Arrangements.Last;return MakeCell(layout,lastCell.Item,lastCell.RowSpan,nextColSpan,lastCell.Width,arrangement,lastCell.ArrangementPrev,repeatCell)}function UpdateRemainedColumns(space,remained,failedColumn){const unchangedCells=function(array,n=1){return take$1(n,array)}(remained.Head.Cells,failedColumn.FirstFailedCellIndex),updatedCells=remained.Head.Cells.slice(failedColumn.FirstFailedCellIndex).map((cell=>{const slice=cell.Layout?cell.Layout(space):LResult.Fail();return slice.IsPageBreak()?function(cell,layout){return Object.assign(Object.assign({},cell),{Layout:layout})}(cell,slice.Tail):cell}));return LazyList.cons(MakeStripe(unchangedCells.concat(updatedCells),remained.Head.MinSize),remained.Tail)}function NewColumn(index,size,minSize,isSplit,cells){return{Index:index,Size:size,MinSize:minSize,IsSplit:isSplit,Cells:cells,IncompletedSpans:cells.filter((c=>index<c.EndColumn)),IsFailed:"n"}}const Col={New:(index,size,minSize,isSplit,cells)=>NewColumn(index,size,minSize,isSplit,cells),Failed:firstFailedCellIndex=>({IsFailed:"y",FirstFailedCellIndex:firstFailedCellIndex}),UpdateCells:(column,cells)=>NewColumn(column.Index,column.Size,column.MinSize,column.IsSplit,cells),UpdateSizeAndCells:(column,size,cells)=>NewColumn(column.Index,size,column.MinSize,column.IsSplit,cells)};const CellInfoF={New:(startColumn,startRow,cell,result,contentSize,cellSize=0,arrangement=Arrangements.None)=>function(startColumn,startRow,cell,result,contentSize,cellSize=0,arrangement=null){return{StartColumn:startColumn,StartRow:startRow,Result:result,CellSize:cellSize,ContentSize:contentSize,Arrangement:arrangement||cell.Arrangement,EndColumn:startColumn+cell.ColSpan-1,ColSpan:cell.ColSpan,RowSpan:cell.RowSpan,Width:cell.Width,Item:cell.Item,Layout:cell.Layout,ArrangementPrev:cell.ArrangementPrev,Repeat:!result.Tail&&cell.Repeatable,Over:Math.max(contentSize-cellSize,0)}}(startColumn,startRow,cell,result,contentSize,cellSize,arrangement),AccumulateSize:(source,size)=>Object.assign(Object.assign({},source),{CellSize:source.CellSize+size,Over:Math.max(source.ContentSize-(source.CellSize+size),0)})};function LayoutColumns(columns,options,makeResult){return options.ColumnsBeforeCount>0?function(columns,options,makeResult){const rtl=options.Rtl,headerColumnCount=options.HeaderColumnCount,columnsBeforeCount=options.ColumnsBeforeCount,columnsAfterCount=columns.count-headerColumnCount-columnsBeforeCount,gridCellsWithoutRepeating=GridCells(rtl?SwapColumnGroups(columns,columnsBeforeCount,columnsAfterCount):SwapColumnGroups(columns,headerColumnCount,0,columnsAfterCount),options,makeResult);if(!options.RepeatHeader)return gridCellsWithoutRepeating;const columnsStartingWithHeader=rtl?SwapColumnGroups(columns,columns.count-headerColumnCount):columns;let headerShift=rtl?columnsAfterCount:columnsBeforeCount;return GridCellsWithRepeating(columnsStartingWithHeader,options,((size,taken,skipHeaders,lastSplits)=>{const takenBodyColumnCount=taken.length-(skipHeaders?0:headerColumnCount)-(lastSplits?1:0);return skipHeaders||(headerShift>=0&&takenBodyColumnCount-headerShift>=0?taken=SwapColumnGroups(LazyList.fromArray(taken),headerColumnCount,0,takenBodyColumnCount-headerShift).toArray():rtl&&(taken=SwapColumnGroups(LazyList.fromArray(taken),headerColumnCount).toArray())),headerShift-=takenBodyColumnCount,makeResult(size,taken)}),gridCellsWithoutRepeating,options.PageSize)}(columns,options,makeResult):function(columns,options,makeResult){const gridCellsWithoutRepeating=GridCells(columns,options,makeResult);if(!options.RepeatHeader)return gridCellsWithoutRepeating;const rtl=options.Rtl,headerColumnCount=options.HeaderColumnCount;return GridCellsWithRepeating(rtl?SwapColumnGroups(columns,columns.count-headerColumnCount):columns,options,((size,taken,skipHeaders,lastSplits)=>makeResult(size,rtl?skipHeaders?taken:SwapColumnGroups(LazyList.fromArray(taken),headerColumnCount).toArray():taken)),gridCellsWithoutRepeating,options.PageSize,!1,!0)}(columns,options,makeResult)}function GridCells(columns,options,makeResult){return LayoutGridCells(columns,options,((size,lastColumnSplits,breakAfter,taken,remained)=>{const head=makeResult(size,taken);if(breakAfter)return LResult.PageBreakAfter(size,head);const nextPageTail=null!=remained?GridCells(remained,options,makeResult):null;return LResult.SplitOrComplete(size,head,nextPageTail)}))}function GridCellsWithRepeating(columns,options,makeResult,fallback,pageSize,skipHeader=!1,firstPass=!0){return space=>{const headerColumnCount=options.HeaderColumnCount;return LayoutGridCells(skipHeader?columns.skip(headerColumnCount):columns,options,((size,lastStripeSplits,breakAfter,taken,remained)=>{if(!skipHeader){const takenColumnCount=taken.length,headerIsSplit=takenColumnCount<headerColumnCount||takenColumnCount==headerColumnCount&&lastStripeSplits,onlyHeaderIsLayouted=takenColumnCount==headerColumnCount&&!lastStripeSplits;if(firstPass&&(headerIsSplit||onlyHeaderIsLayouted)){if(pageSize>0&&pageSize>space){const tail=GridCellsWithRepeating(columns,options,makeResult,fallback,0,!1,!0);return LResult.PageBreak(tail)}return fallback(space)}if(!firstPass&&onlyHeaderIsLayouted){return GridCellsWithRepeating(columns,options,makeResult,fallback,0,!0,!1)(space)}}const head=makeResult(size,taken,skipHeader,lastStripeSplits),nextTail=null==remained?null:GridCellsWithRepeating(LazyList.concat(columns.Take(headerColumnCount),remained),options,makeResult,fallback,0,!1,!1);return LResult.SplitOrComplete(size,head,nextTail)}))(space)}}function MakeCell(layout,item,rowSpan,colSpan,width=0,arrangement=Arrangements.Both,arrangementPrev=Arrangements.None,repeatable=!1){return{Layout:layout,Item:item,RowSpan:rowSpan,ColSpan:colSpan,Width:width,Arrangement:arrangement,ArrangementPrev:arrangementPrev,Repeatable:repeatable,IsEmpty:0===rowSpan&&0===colSpan}}function MakeResultCell(body,rowSpan,colSpan,width,item,arrangement,arrangementPrev){return{Body:body,ColSpan:colSpan,RowSpan:rowSpan,Width:width,Item:item,Arrangement:arrangement,ArrangementPrev:arrangementPrev,IsEmpty:colSpan<1||rowSpan<1,IsHole:colSpan<0}}function MakeResultCellHole(rowSpan,item){return MakeResultCell(null,rowSpan,-1,0,item,Arrangements.None,Arrangements.None)}function MakeStripe(cells,minSize){if(null==minSize||isNaN(minSize))throw new LayoutError("ArgumentNullException: minSize");return{Cells:cells,MinSize:minSize,PageBreakBefore:!1,PageBreakAfter:!1}}function MakeStripeLayoutResult(cells,size){return{Cells:cells,Size:size}}function MakeCollapseRepeatingCells(autoMergeItemNames,canMergeCells){return 0===Object.keys(autoMergeItemNames).length?makeResult=>makeResult:makeResult=>(size,stripes)=>{const collapsedStripes=new Array(stripes.length);for(let i=0;i<stripes.length;i++)collapsedStripes[i]=CollapseStripeRepeatingCells(stripes[i],canMergeCells,i>0?collapsedStripes[i-1]:void 0);return makeResult(size,collapsedStripes)}}function CollapseStripeRepeatingCells(stripe,canMergeCells,prevStripe){const repeatsInfo=function(stripe,canMergeCells,prevStripe){const repeatsInfo={};let prevCell,topRepeatedCellIndex=-1;for(let i=0;i<stripe.Cells.length;){const cell=stripe.Cells[i];let prevStripeCell=null;null!=prevStripe&&(prevStripeCell=prevStripe.Cells[i]),CanMergeCells(prevCell,cell,prevStripeCell,canMergeCells)?Object.keys(repeatsInfo).indexOf(topRepeatedCellIndex.toString())>=0?repeatsInfo[topRepeatedCellIndex]=repeatsInfo[topRepeatedCellIndex]+cell.RowSpan:repeatsInfo[topRepeatedCellIndex]=cell.RowSpan+(prevCell&&prevCell.RowSpan||0):(topRepeatedCellIndex=i,prevCell=cell),i+=cell.RowSpan}return repeatsInfo}(stripe,canMergeCells,prevStripe);if(0===Object.keys(repeatsInfo).length)return stripe;const collapsedCells=stripe.Cells;for(const riKey of Object.keys(repeatsInfo)){const numKey=Number(riKey),repeatsInfoPair={Key:numKey,Value:repeatsInfo[numKey]},repeatedCellIndex=repeatsInfoPair.Key,repeatsCnt=repeatsInfoPair.Value,repeatedCell=collapsedCells[repeatedCellIndex],holesCnt=repeatsCnt-1,arrangement=repeatedCell.Arrangement;let arrangementPrev=repeatedCell.ArrangementPrev;for(let i=1;i<=holesCnt;i++){if(collapsedCells[repeatedCellIndex+i].ArrangementPrev===Arrangements.First)switch(arrangementPrev){case Arrangements.Last:arrangementPrev=Arrangements.None;break;case Arrangements.Both:arrangementPrev=Arrangements.First}collapsedCells[repeatedCellIndex+i]=MakeResultCellHole(0,null)}collapsedCells[repeatedCellIndex]=MakeResultCell(repeatedCell.Body,repeatsCnt,repeatedCell.ColSpan,repeatedCell.Width,repeatedCell.Item,arrangement,arrangementPrev)}return MakeStripeLayoutResult(collapsedCells,stripe.Size)}function CanMergeCells(cell,otherCell,prevStripeCell,canMergeCells){return!(null==cell||cell.ColSpan<=0)&&canMergeCells(cell.Body,otherCell.Body,!(prevStripeCell&&!prevStripeCell.IsHole))}function SwapColumnGroups(columns,firstGroupColumnCount,startOffset=0,endOffset=0){var _a,_b;const secondGroupColumnCount=columns.count-startOffset-endOffset-firstGroupColumnCount,startColumns=columns.Take(startOffset),shiftForwardColumns=null===(_a=columns.skip(startOffset))||void 0===_a?void 0:_a.Take(firstGroupColumnCount);return[startColumns,null===(_b=columns.skip(startOffset+firstGroupColumnCount))||void 0===_b?void 0:_b.Take(secondGroupColumnCount),shiftForwardColumns,columns.skip(startOffset+firstGroupColumnCount+secondGroupColumnCount)].reduce(((acc,it)=>it&&acc?acc.concat(it):null!=it?it:acc),null)}function FillColumnData(data,widths,rtl=!1){const columns=range(data.ColSpan).map((()=>[]));return AddCellImpl(columns,0,0,data,rtl),LazyList.fromArray(zipWith(columns,widths,((list,width)=>MakeStripe(list,width))))}function AddCellImpl(columns,r,c,cell,rtl){if("gridcell"!==cell.Type)if("gridelementlist"!==cell.Type){if("gridheader"===cell.Type){!function(header,columns,mk,rtl){const headerRows=header.HeaderRows,cornerColumnCount=header.CornerColumnCount,columnsCount=sum(headerRows[0].Cells.map((cell=>cell.RowSpan))),rowsCount=headerRows.length,cellsMatrix=range(columnsCount).map((()=>[]));for(let i=0;i<columnsCount;i++)cellsMatrix[i]=new Array(rowsCount);for(let row=0;row<headerRows.length;row++){const rowStripe=headerRows[row];let column=0;for(const cell of rowStripe.Cells){if(!cell.IsHole){const mainColumn=rtl?columnsCount-(cell.RowSpan-1)-column-1:column;cellsMatrix[mainColumn][row]=MakeCell(mk(cell.Body),cell.Item,cell.ColSpan,cell.RowSpan,cell.Width,Arrangements.Both,cell.Arrangement,column>=cornerColumnCount);for(let i=1;i<cell.RowSpan;i++)cellsMatrix[mainColumn+i][row]=MakeCell(null,cell.Item,cell.ColSpan,1,cell.Width,Arrangements.Both,cell.Arrangement,column>=cornerColumnCount)}column+=cell.RowSpan}}for(let column=0;column<columnsCount;column++)for(let row=0;row<rowsCount;row++){const cell=cellsMatrix[column][row];null==cell||cell.IsEmpty||columns[column].push(cell)}}(cell,columns,(layout2=>layout2),rtl)}}else{const list=cell;for(const cell2 of list.Cells.toArray())AddCellImpl(columns,r,c,cell2,rtl),"Column"===list.Direction?r+=cell2.RowSpan:c+=cell2.ColSpan}else{if(cell.ColSpan<=0||c+cell.ColSpan>columns.length||cell.RowSpan<=0)throw new LayoutError("ArgumentOutOfRangeException: cell");const mainIndex=rtl?columns.length-(cell.ColSpan-1)-c-1:c;columns[mainIndex].push(MakeCell(cell.Content,cell.Item,cell.RowSpan,cell.ColSpan,cell.Width,Arrangements.Both,cell.Arrangement));const hole=MakeCell(null,cell.Item,cell.RowSpan,1,0,Arrangements.Both,cell.Arrangement);for(let i=1;i<cell.ColSpan;i++)columns[mainIndex+i].push(hole)}}function MakeGridElementList(cells,direction,size,rowSpan,colSpan,item){return{Type:"gridelementlist",Cells:cells,Direction:direction,Size:size,RowSpan:rowSpan,ColSpan:colSpan,Item:item}}function GridImpl_InCell(item,layout,hspan,minSize=0,filler=null,repeatable=!0,canShrink=!1){const cellLayout=L.Convert(layout,(r=>MakeGridCellElement(r.Body,r.Size,1,hspan,item,Arrangements.Both,repeatable)));return 0===minSize||canShrink?cellLayout:MinimalSize(cellLayout,filler||NoFiller,minSize)}function NoFiller(obj){return L.Empty(null)}function MinimalSize(layout,filler,minSize){return space=>{const slice=layout(space);if(slice.IsFailed())return slice;if(slice.IsPageBreak())return slice;const cell=slice.Body;if(cell.Size>=minSize)return slice;if(space<minSize){if(slice.IsCompleted()){const res=MinimalSize(L.Convert(filler(cell.Item),(r=>function(cell,content,size){return MakeGridCellElement(content,size,cell.RowSpan,cell.ColSpan,cell.Item,cell.Arrangement,cell.Repeatable)}(cell,r.Body,r.Size))),filler,minSize-space);return LResult.Split(space,UpdateCellSize(cell,space),slice.IsPageBreakAfter()?L.PageBreakAfter(res):res)}return LResult.Split(space,UpdateCellSize(cell,space),MinimalSize(slice.Tail,filler,minSize-space))}const resCell=UpdateCellSize(cell,minSize);return slice.IsCompleted()?slice.IsPageBreakAfter()?LResult.PageBreakAfter(minSize,resCell):LResult.Complete(minSize,resCell):LResult.Split(minSize,resCell,slice.Tail)}}function GridRow2(items,filler,item=null){return items?L.Chop(items,(slices=>LazyList.zip(slices,items,((slice,layout)=>{const cell=slice.Body;return"gridcell"===cell.Type?slice.IsSplit()?L.Convert(slice.Tail,(r=>function(cell,arrangement,repeatable){return MakeGridCellElement(cell.Content,cell.Size,cell.RowSpan,cell.ColSpan,cell.Item,arrangement,repeatable)}(r.Body,Arrangements.Last,!1))):cell.Repeatable?L.Convert(layout,(r=>r.Body)):L.Convert(filler(cell.Item),(r=>MakeGridCellElement(r.Body,r.Size,cell.RowSpan,cell.ColSpan,cell.Item,Arrangements.Last,!1))):slice.IsSplit()?slice.Tail:GridRow2(LazyList.fromArray(function(gridElement,filler){throw new LayoutError("Not implemented: CreateFillerCells")}(slice.Body)),filler)}))),((size,slices)=>{const slicesArray=slices.toArray().filter((s=>null!==s.Body)),colspan=sum(slicesArray.map((s=>s.Body.ColSpan))),rowspan=Math.max(...slicesArray.map((s=>s.Body.RowSpan))),allCompleted=slicesArray.every((r=>r.IsCompleted()));return MakeGridElementList(slices.map((s=>{const gridFragment=Object.assign(Object.assign({},s.Body),{RowSpan:rowspan});if("gridcell"===gridFragment.Type){const cell=gridFragment,repeatCell=!s.IsSplit&&cell.Repeatable;return allCompleted||repeatCell?cell:MakeGridCellElement(cell.Content,cell.Size,cell.RowSpan,cell.ColSpan,cell.Item,cell.Arrangement,cell.Repeatable)}return allCompleted||s.IsSplit,gridFragment})),"Row",size,rowspan,colspan,item)})):null}function CollectRowHeights(r){const heights=new Array(r.RowSpan).fill(0);return CollectHeights(r,heights,0),heights}function CollectHeights(r,heights,rowIndex){if("gridcell"===r.Type){if(1==r.RowSpan)heights[rowIndex]=Math.max(heights[rowIndex],r.Size);else if(r.RowSpan>1){const rowsHeight=sumRange(heights,rowIndex,r.RowSpan),extra=r.Size-rowsHeight;if(extra>0){heights[rowIndex+r.RowSpan-1]+=extra}}}else if("gridelementlist"===r.Type){const list=r;let row=rowIndex;switch(list.Direction){case"Row":for(const cell of list.Cells.Reverse().toArray())CollectHeights(cell,heights,row);break;case"Column":for(const cell of list.Cells.toArray())CollectHeights(cell,heights,row),row+=cell.RowSpan}}else if("gridheader"===r.Type){const header=r;heights.splice(rowIndex,header.HeaderRows.length,...header.HeaderRows.map((hr=>hr.Size)))}}function MakeGridCellElement(content,size,rowSpan,colSpan,item,arrangement,repeatable){return{Type:"gridcell",Content:content,Size:size,RowSpan:rowSpan,ColSpan:colSpan,Item:item,Arrangement:arrangement,Repeatable:repeatable,Width:0}}function UpdateCellSize(cell,size){return MakeGridCellElement(cell.Content,size,cell.RowSpan,cell.ColSpan,cell.Item,cell.Arrangement,cell.Repeatable)}function convertFirstGridCell(it,cnv){return L.ConvertFirstBody(it,(r=>convertFirstCell(r,cnv)))}function convertFirstCell(element,cnv){switch(element.Type){case"gridcell":return Object.assign(Object.assign({},element),{Content:L.ConvertFirstBody(element.Content,cnv)});case"gridelementlist":const head=convertFirstCell(element.Cells.Head,cnv);return Object.assign(Object.assign({},element),{Cells:LazyList.cons(head,element.Cells.Tail)});case"gridheader":const[firstRow,...restRows]=element.HeaderRows;if(!firstRow)return element;const[firstCell,...restCells]=firstRow.Cells;if(!firstCell)return element;const convertedFirst=Object.assign(Object.assign({},firstRow),{Cells:[Object.assign(Object.assign({},firstCell),{Body:L.ConvertFirstBody(firstCell.Body,cnv)}),...restCells]});return Object.assign(Object.assign({},element),{HeaderRows:[convertedFirst,...restRows]});default:return element}}function convertLastGridCell(it,cnv){return L.ConvertLastBody(it,(el=>convertLastCell(el,cnv)))}function convertLastCell(element,cnv){switch(element.Type){case"gridcell":return Object.assign(Object.assign({},element),{Content:L.ConvertLastBody(element.Content,cnv)});case"gridelementlist":const rev=element.Cells.Reverse(),head=convertLastCell(rev.Head,cnv);return Object.assign(Object.assign({},element),{Cells:LazyList.cons(head,rev.Tail).Reverse()});case"gridheader":if(!element.HeaderRows.length)return element;const lastRow=element.HeaderRows[element.HeaderRows.length-1];if(!lastRow.Cells.length)return element;const convertedCells=[];let isLastConverted=!1;for(let i=lastRow.Cells.length-1;i>=0;i--){const cell=lastRow.Cells[i];isLastConverted||!cell.Body?convertedCells[i]=cell:(convertedCells[i]=Object.assign(Object.assign({},cell),{Body:L.ConvertLastBody(cell.Body,cnv)}),isLastConverted=!0)}const convertedLast=Object.assign(Object.assign({},lastRow),{Cells:convertedCells});return Object.assign(Object.assign({},element),{HeaderRows:[...element.HeaderRows.slice(0,-1),convertedLast]});default:return element}}const inStackSection=(layout,getSectionId)=>(data,parentCtx)=>{const sectionId=getSectionId(data),ctx=Object.assign(Object.assign({},parentCtx),{EvalDynamicRuntime:evaluate(sectionId)}),withData=layout(data,ctx);return actions=>{const withActions=withData(actions);return(w,h)=>addStackSectionAttributes(withActions(w,h),sectionId)}},inHierarchyStackSection=(layout,getSectionId)=>(data,parentCtx)=>{const sectionId=getSectionId(data),ctx=Object.assign(Object.assign({},parentCtx),{EvalDynamicRuntime:evaluate(sectionId)}),withData=layout(data,ctx);return actions=>addStackSectionAttributes(withData(actions),sectionId)};function addStackSectionAttributes(layout,sectionId){return layout=L2.ConvertFirstBody(layout,startSectionAttribute(sectionId)),L2.ConvertLastBody(layout,endSectionAttribute(sectionId))}const inTableSection=(layout,getSectionId)=>(data,parentCtx)=>{const sectionId=getSectionId(data),ctx=Object.assign(Object.assign({},parentCtx),{EvalDynamicRuntime:evaluate(sectionId)}),withData=layout(data,ctx);return actions=>{const withActions=withData(actions);return withActions?cols=>{const withCols=withActions(cols);return withCols?addSectionAttributes(withCols,sectionId):withCols}:withActions}};function addSectionAttributes(layout,sectionId){return layout=convertLastGridCell(layout=convertFirstGridCell(layout,startSectionAttribute(sectionId)),endSectionAttribute(sectionId))}const startSectionAttribute=sectionId=>node=>{var _a;const sectionInfo={id:sectionId,position:"start"};return((null===(_a=node.properties.meta)||void 0===_a?void 0:_a.SectionMarks)||(node.properties.meta=Object.assign(Object.assign({},node.properties.meta),{SectionMarks:[]})).SectionMarks).push(sectionInfo),node},endSectionAttribute=sectionId=>node=>{var _a;const sectionInfo={id:sectionId,position:"end"};return((null===(_a=node.properties.meta)||void 0===_a?void 0:_a.SectionMarks)||(node.properties.meta=Object.assign(Object.assign({},node.properties.meta),{SectionMarks:[]})).SectionMarks).push(sectionInfo),node},evaluate=sectionId=>(value,evalCtx)=>value(Object.assign(Object.assign({},evalCtx),{SectionId:sectionId}));function collectSections(page){const sections=[];return visitPageElements(page,(node=>{var _a,_b;(null===(_b=null===(_a=node.properties)||void 0===_a?void 0:_a.meta)||void 0===_b?void 0:_b.SectionMarks)&&sections.push(...node.properties.meta.SectionMarks)})),sections}function collectBookmarks(page){const bookmarks=[];return visitPageElements(page,(node=>{const action=node.properties&&node.properties.attributes&&node.properties.attributes["data-action"];if(action){const actionObj=JSON.parse(action);"bookmark"===actionObj.Type&&actionObj.Target&&bookmarks.push(actionObj.Target)}})),bookmarks}const isVNode$1=node=>"VirtualNode"===node.type;function visitPageElements(page,action){action(page);for(const childNode of page.children.filter(isVNode$1))visitPageElements(childNode,action)}function compileVisibility$3(visibility,compiledItem,makeEmptyResult,ctx){if(!compiledItem)return null;const query={Fields:[],Regions:[]};const isHiddenComp=!!visibility&&compileExpression(visibility.Hidden,query.Fields,ctx.EvaluationContext);if(!visibility.ToggleItem&&"function"!=typeof isHiddenComp){const isHiddenStatic=toBoolean(isHiddenComp);if(!1===isHiddenStatic)return compiledItem;if(!0===isHiddenStatic)return{Query:{Fields:[],Regions:[]},Layout:()=>()=>(width,height)=>L2.Divisible(width,height,makeEmptyResult),Styles:[],DocumentMap:()=>()=>[]}}const dataMap=combineDataQuery(compiledItem.Query,query),getHiddenState=(isHiddenInitial,actions)=>{let isHidden=toBoolean(isHiddenInitial);if(visibility.ToggleItem){isHidden=isHidden!==actions.ScopeToggles.filter((a=>"toggle"===a.Type&&1===a.ItemPath.length&&visibility.ToggleItem.toLowerCase()===a.ItemPath[0].toLowerCase())).length%2>0}return isHidden};return{Query:compiledItem.Query,Layout:(itemData,ctx)=>{const data=dataMap(itemData),isHiddenInitial=resolveCompiled$1(isHiddenComp,data);return actions=>{const isHidden=isHiddenInitialValue=>getHiddenState(null!=isHiddenInitialValue&&isHiddenInitialValue,actions);if("function"==typeof isHiddenInitial){const isHiddenResolved=globals=>isHidden(isHiddenInitial(globals)),itemResult=compiledItem.Layout(itemData,ctx)(actions);return(w,h)=>L2.ConvertBody(itemResult(w,h),(content=>{if(!content)return content;const visibilityPatcher=function(renderContext,isHidden,nodeId){const id=null!=nodeId?nodeId:renderContext.IDGenerator.next();return{patcher:globals=>{const isHiddenValue=renderContext.EvalDynamicRuntime(isHidden,globals);return{id:id,style:isHiddenValue?{visibility:"hidden",border:"none"}:{},children:isHiddenValue?[]:null}},id:id}}(ctx,isHiddenResolved,content.properties.id),currentPatcher=content.properties.patcher;return content.properties.patcher=joinPatchers(currentPatcher,visibilityPatcher.patcher),content.properties.id=visibilityPatcher.id,content}))}return isHidden(isHiddenInitial)?(width,height)=>L2.Divisible(width,0,makeEmptyResult):compiledItem.Layout(itemData,ctx)(actions)}},Styles:compiledItem.Styles,DocumentMap:(itemData,ctx)=>{const data=dataMap(itemData),isHiddenInitial=resolveCompiled$1(isHiddenComp,data);return actions=>getHiddenState(isHiddenInitial,actions)?[]:compiledItem.DocumentMap(itemData,ctx)(actions)}}}const defaultList=createReportItem({Type:"list"},"default");var list=dataRegion((function(definition,context){return __awaiter(this,void 0,void 0,(function*(){const listContentDefinition=Object.assign(Object.assign({},createRectangle(`${definition.Name}Content`)),{ReportItems:definition.ReportItems,Label:definition.Group.DocumentMapLabel,KeepTogether:!0,Visibility:definition.Visibility,ConsumeWhiteSpace:definition.ConsumeWhiteSpace&&definition.RowsOrColumnsCount<=1,Action:definition.Action,Overflow:"Grow"}),compiledContent=yield compile$2(listContentDefinition,context),{Query:itemQuery,Layout:itemLayout,Styles:itemStyles,DocumentMap:itemDocumentMap}=compileVisibility$3(listContentDefinition.Visibility,compiledContent,(()=>null),context),contentQuery={Fields:context.Interactivity.SortExpressions[definition.Name]||[],Regions:[]},compiled=function(definition,context,exprCompiler){const exprComp=createTypedCompiler(exprCompiler);return{Type:"list",Name:context.ReportID+definition.Name,Label:exprComp.compileString(definition.Label),Bookmark:exprComp.compileString(definition.Bookmark,defaultList.Bookmark),Tooltip:exprComp.compileString(definition.ToolTip,defaultList.ToolTip),PageBreak:definition.PageBreak,GroupPageBreak:definition.RowsOrColumnsCount>1?"None":definition.Group.PageBreak,GrowDirection:definition.GrowDirection,RowsOrColumnsCount:definition.RowsOrColumnsCount}}(definition,context,(expr=>compileExpression(expr,contentQuery.Fields))),groupSortExpr=context.Interactivity.SortExpressions[definition.Group.Name],listDef=Def.Makers.List(definition.Name,contentQuery,(definition.Filters||[]).map((f=>({Expression:f.FilterExpression,Op:f.Operator,Values:f.FilterValues}))),Def.Makers.Group(definition.Group.Name,definition.Group.GroupExpressions,(definition.Group.Filters||[]).map((f=>({Expression:f.FilterExpression,Op:f.Operator,Values:f.FilterValues}))),definition.Group.ParentGroup||void 0),(definition.SortExpressions||[]).map((s=>({Direction:s.Direction,Expression:s.Value}))),groupSortExpr?Object.assign(Object.assign({},itemQuery),{Fields:uniq(itemQuery.Fields.concat(groupSortExpr))}):itemQuery);let makeChild=(data,ctx)=>{const withData=itemLayout(data,Object.assign(Object.assign({},ctx),{PeerScopes:getPeerScopes(listDef.GroupContent.Regions,data.Regions)}));return actions=>withData(getScopeActions(actions,data.Id))};definition.Group.NewSection&&(makeChild=inStackSection(makeChild,(data=>`${definition.Group.Name}#${data.Id}`)));const defWidth=Length.parse(definition.Width),defHeight=Length.parse(definition.Height);let result={Query:{Fields:[],Regions:[listDef]},Layout:(data,parentCtx)=>actions=>(width,height)=>{var _a,_b,_c,_d;const listData=data.Regions[0],ctx=Object.assign(Object.assign({},parentCtx),{ParentScopes:Object.assign(Object.assign({},parentCtx.ParentScopes),{[listDef.Name]:listData.Scope.Id})}),scopeActions=getScopeActions(actions,listData.Scope.Id),listGroups=listData.Groups||[],fullWidth=defWidth||(null!==(_b=null===(_a=context.ContainerSize)||void 0===_a?void 0:_a.Width)&&void 0!==_b?_b:width),fullHeight=defHeight||(null!==(_d=null===(_c=context.ContainerSize)||void 0===_c?void 0:_c.Height)&&void 0!==_d?_d:height),contentWidth="Column"===compiled.GrowDirection||"ColumnReverse"===compiled.GrowDirection?fullWidth/compiled.RowsOrColumnsCount:fullWidth,contentHeight="Row"===compiled.GrowDirection||"RowReverse"===compiled.GrowDirection?fullHeight/compiled.RowsOrColumnsCount:fullHeight,children=map$2(listGroups,(g=>{const groupItemCtx=listDef.Group.Name?Object.assign(Object.assign({},ctx),{ParentScopes:Object.assign(Object.assign({},ctx.ParentScopes),{[listDef.Group.Name]:g.Id})}):ctx;return makeChild(g,groupItemCtx)(scopeActions)(contentWidth,contentHeight)})),fragmentFactory={createEmpty:renderEmpty,createStack:(direction,width,height,content)=>function(model,direction,width,height,content){content&&content.forEach((item=>{item.properties.className+=" arjs-listItem",item.properties.GroupType="group"}));const patcher=content&&joinPatchers(content.map((c=>c.properties.patcher)));return h("div",{className:"arjs-stack_"+("Horizontal"===direction?"horz":"vert"),style:{width:Length.toCss(width),height:Length.toCss(height)},patcher:patcher,GroupType:"list",title:model.Tooltip},buildAnchorNodes(model).concat(content||[]))}(resolveItemCommon(compiled,listData.Scope,ctx),direction,width,height,content),setHeight:VDomFragmentFactory.clipVertically};return listLayout(compiled,children,contentWidth,contentHeight,fragmentFactory)},Styles:itemStyles,DocumentMap:(data,parentCtx)=>actions=>{const listData=data.Regions[0],ctx=Object.assign(Object.assign({},parentCtx),{ParentScopes:Object.assign(Object.assign({},parentCtx.ParentScopes),{[listDef.Name]:listData.Scope.Id})}),scopeActions=getScopeActions(actions,listData.Scope.Id);return buildGroupDocumentMap(definition.Name,compiled,context.DocumentMap,itemDocumentMap)(listData,ctx)(scopeActions)}};return result=yield compileNoRowsMessage(result,definition,context),definition.NewSection&&(result=Object.assign(Object.assign({},result),{Layout:inStackSection(result.Layout,(data=>`${compiled.Name}#${data.Regions[0].Scope.Id}`))})),result}))}));const defaultVisibility$2=createVisibility(),compileHierarchyToggle=(visibility,layoutItem,fieldsRef)=>{const exprComp=createTypedCompiler((function(value){return compileExpression(value,fieldsRef)})),levelComp=exprComp.compileNumber("=Level()"),level=data=>resolveCompiled$1(levelComp,data),isHidden=function(visibility,exprComp){const toggled=actions=>!!visibility.ToggleItem&&actions.ScopeToggles.filter((a=>"toggle"===a.Type&&1===a.ItemPath.length&&visibility.ToggleItem.toLowerCase()===a.ItemPath[0].toLowerCase())).length%2>0,hiddenComp=exprComp.compileBoolean(visibility.Hidden,defaultVisibility$2.Hidden),hiddenInit=data=>toBoolean(safeResolveCompiledData(hiddenComp,data));return data=>actions=>hiddenInit(data)!==toggled(actions)}(visibility,exprComp);return makeGroupItemsLayout(getRecInteractivity(visibility.ToggleItem,level),getListRecTail(isHidden,level),layoutItem)},makeGroupItemsLayout=(getItemInteractivity,getNextData,makeResult)=>{const layoutGroup=(lazyGroups,ctx)=>actions=>{var _a;let memberLayout=null,tail=lazyGroups;for(;!memberLayout;){if(!tail)return null;const rowData=tail;tail=getNextData(rowData,actions);const itemActions=getItemInteractivity(actions,rowData.Head,null===(_a=rowData.Tail)||void 0===_a?void 0:_a.Head);memberLayout=makeResult(rowData.Head,ctx)(itemActions)}return LazyList.cons(memberLayout,(()=>layoutGroup(tail,ctx)(actions)))};return layoutGroup};function isRecursiveHierarchy(groupItemDef){var _a;return(null===(_a=groupItemDef.Group)||void 0===_a?void 0:_a.ParentGroup)&&""!==groupItemDef.Visibility.ToggleItem||!1}const getRecInteractivity=(toggleName,level)=>(interactivity,data,nextData=null)=>Object.assign(Object.assign({},interactivity),{IsToggle:name=>{return interactivity.IsToggle(name)||name===toggleName&&(curr=data,!!(next=nextData)&&level(next)>level(curr));var curr,next}}),getRecTail=getScope=>(isHidden,level)=>(dataLazy,interactivity)=>{const data=getScope(dataLazy.Head),childInteractivity=getScopeActions(interactivity,data.Id);if(!isHidden(data)(childInteractivity))return dataLazy.Tail;const hiddenLevel=level(data)+1;let tail=dataLazy.Tail;for(;tail;){if(level(getScope(tail.Head))<hiddenLevel)return tail;tail=tail.Tail}return tail},getListRecTail=getRecTail((gData=>gData));function collectMembersDataMap(members,data,map){for(let i=0;i<members.length;i++)collectMemberDataMap(members[i],GetCollectionItem(data,i),map)}function collectMemberDataMap(member,data,map){if(void 0===data.Id)if(data.IsCollection){if(data.Members)for(const childData of data.Members)collectMemberDataMap(member,childData,map)}else collectMembersDataMap(member.Children,data.Members,map);else map[data.Id]=member.BodyIndex}function collectColsInfo(members,data,map,parentInfo){for(let i=0;i<members.length;i++){const member=members[i],mdata=GetCollectionItem(data,i),pageBreakDisabled=member.PageBreakDisabled(mdata.Header)(parentInfo.Interactivity),memberInfo={IsHidden:parentInfo.IsHidden||!mdata.IsCollection&&null===member.Level&&!!mdata.Header&&member.IsHidden(mdata.Header)(parentInfo.Interactivity),PageBreakBefore:0===i&&parentInfo.PageBreakBefore||hasStartBr(member.PageBreak)&&!pageBreakDisabled,PageBreakAfter:i===members.length-1&&parentInfo.PageBreakAfter||hasEndBr(member.PageBreak)&&!pageBreakDisabled,Interactivity:parentInfo.Interactivity};collectColInfo(member,mdata,map,memberInfo)}}function collectColInfo(member,data,map,memberInfo){if(void 0===data.Id)if(data.IsCollection){if(data.Members){let hiddenLevel=null;const pageBreakDisabled=member.PageBreakDisabled(data.Header)(memberInfo.Interactivity),breakBefore=hasStartBr(member.PageBreak)&&!pageBreakDisabled,breakAfter=hasEndBr(member.PageBreak)&&!pageBreakDisabled;let i=0;const dataMembers=Array.from(data.Members);for(const childData of dataMembers){const childActions=getMemberInteractivity(member,memberInfo.Interactivity,childData,dataMembers[i+1]),isHidden=memberInfo.IsHidden||null===member.Level&&childData.Header&&member.IsHidden(childData.Header)(memberInfo.Interactivity)||null!==member.Level&&null!==hiddenLevel&&member.Level(childData.Header)>=hiddenLevel;isHidden||(hiddenLevel=getRecHiddenLevel(member,childData.Header,childActions)),collectColInfo(member,childData,map,{IsHidden:isHidden,PageBreakBefore:breakBefore||0===i&&memberInfo.PageBreakBefore,PageBreakAfter:breakAfter||i===data.Members.length-1&&memberInfo.PageBreakAfter,Interactivity:childActions}),i++}}}else collectColsInfo(member.Children,data.Members,map,memberInfo);else map[data.Id]=memberInfo}function hasStartBr(br){return"Start"===br||"StartAndEnd"==br}function hasEndBr(br){return"End"==br||"StartAndEnd"==br}function collectLeafNodes(member,data,interactivity){if(!data.IsCollection&&!member.Level&&member.IsHidden(data.Header)(interactivity))return[];if(data.IsCollection){let i=0;const dataMembers=Array.from(data.Members||[]);for(const d of dataMembers){const res=collectLeafNodes(member,d,getMemberInteractivity(member,interactivity,d,dataMembers[++i]));if(res.length>0)return res}return[]}return member.BodyIndex>=0?[member]:flatten$1(member.Children.map(((c,idx)=>collectLeafNodes(c,GetCollectionItem(data.Members,idx),interactivity))))}function getMemberInteractivity(member,actions,data,nextData){return getScopeActions(member.Level?getRecInteractivity(member.VisibilityRaw.ToggleItem,member.Level)(actions,data.Header,null==nextData?void 0:nextData.Header):actions,data.Header.Id)}function getRecHiddenLevel(member,data,interactivity){if(!member.Level)return null;return member.IsHidden(data)(interactivity)?member.Level(data)+1:null}function MakeBodyCol(size,rr,item=null){return MakeCol(size,rr&&rr.map((r=>r.Body)).filter(isNotNull),item)}function MakeCol(size,rr,item=null){if(null===rr)return null;const arr=rr.toArray().filter(isNotNull);return MakeGridElementList(rr,"Column",size,sum(arr.map((r=>r.RowSpan))),Math.max(...arr.map((r=>r.ColSpan))),item)}function MakeGridCellOptions(filler,rtl=!1,pageSize=0,repeatHeader=!1,headerColumnCount=0,columnsBeforeCount=0){return{Filler:filler,Rtl:rtl,PageSize:pageSize,RepeatHeader:repeatHeader,HeaderColumnCount:headerColumnCount,ColumnsBeforeCount:columnsBeforeCount}}function Empty2(item){return L.Empty(L.Empty(item))}const addAnchorNodes=anchors=>vnode=>h(vnode.tagName,vnode.properties,[...buildAnchorNodes(anchors),...vnode.children]);function addRowMemberLabel(members,anchors){return convertFirstGridCell(members,addAnchorNodes(anchors))}function mapFirst$1(list,predicate,map){const heads=[];let tail=list;for(;tail&&!predicate(tail.Head);)heads.push(tail.Head),tail=tail.Tail;let result=tail&&LazyList.cons(map(tail.Head),tail.Tail);for(let i=heads.length-1;i>=0;i--)result=LazyList.cons(heads[i],result);return result}function layoutColumnMembers(membersList,data,ctx,actions){let count=0;const membersStripes=zipWith(membersList,Array.from(data),((m,d)=>{const res=layoutColumnMember(m,d,ctx,actions);return count+=res.Count,res.CellsStripes})).filter(isNotNull);return{CellsStripes:GlueStripes(LazyList.fromArray(membersStripes)),Count:count}}function layoutColumnMember(member,data,parentCtx,actions){if(!data.IsCollection&&!member.Level&&member.IsHidden(data.Header)(actions))return{CellsStripes:null,Count:0};if(data.IsCollection)return function(member,dataCollection,ctx,actions){let count=0,hiddenLevel=null;const data=Array.from(dataCollection),membersStripes=data.map(((d,index)=>{if(member.Level&&null!==hiddenLevel&&member.Level(d.Header)>=hiddenLevel)return null;const itemActions=getMemberInteractivity(member,actions,d,data[index+1]);hiddenLevel=getRecHiddenLevel(member,d.Header,itemActions);const res=layoutColumnMember(member,d,ctx,itemActions);return count+=res.Count,res.CellsStripes})).filter(isNotNull);return{CellsStripes:GlueStripes(LazyList.fromArray(membersStripes)),Count:count}}(member,data.Members||[],parentCtx,actions);const ctx=!data.IsCollection&&member.GroupName?Object.assign(Object.assign({},parentCtx),{PeerScopes:{[member.GroupName]:data.Header.Id}}):parentCtx,subMembers=member.Children||[],isLeaf=!subMembers.length,membersLayoutResult=subMembers.length?layoutColumnMembers(subMembers,data.Members,ctx,actions):null,occupiedCellsCount=isLeaf||!membersLayoutResult?1:membersLayoutResult.Count;let cellsStripes=membersLayoutResult&&membersLayoutResult.CellsStripes;if(member.Header&&0!==occupiedCellsCount){const extraTotal=function(members,data,actions){return pipe(iterable$1.zip(((m,d)=>[m,d])),iterable$1.filter((md=>md[0].IsExtraTotal&&!md[0].IsHidden(md[1].Header)(actions))),iterable$1.first,(tuple=>null!==tuple?tuple[0]:null))(members,data)}(member.Children,data.Members,actions),extraSpan=null!==extraTotal?function(extraTotal){let span=0,current=extraTotal;for(;null!==current;)null===current.Header&&current.IsExtraTotal&&!current.IsZeroSpan&&span++,current=current.Children&&current.Children.length?current.Children[0]:null;return span}(extraTotal):0,colSpan=member.Header.ColSpan+extraSpan,cellWidth=sum(collectLeafNodes(member,data,actions).map((m=>m.Size))),cell=Object.assign(Object.assign({},member.Header),{RowSpan:occupiedCellsCount,ColSpan:colSpan,Layout:member.Header.Layout&&member.Header.Layout(data.Header,ctx)(actions)(cellWidth,member.GetSize2(colSpan)),Item:null,Width:0});let headerCellsStripes=LazyList.cons(LazyList.cons(cell));const hole=Object.assign(Object.assign({},member.Header),{RowSpan:occupiedCellsCount,ColSpan:1,Layout:null,Item:null,Width:0});for(let i=1;i<member.Header.ColSpan+extraSpan;i++)headerCellsStripes=LazyList.cons(LazyList.cons(hole),headerCellsStripes);cellsStripes=cellsStripes&&cellsStripes.concat(headerCellsStripes)||headerCellsStripes}if(cellsStripes&&member.Label){member.Label(data.Header)(actions)&&(cellsStripes=function(members,label){const addAnchors=addAnchorNodes({ToCAnchor:label});return mapFirst$1(members,(cells=>null!==cells.map((cell=>cell.Layout)).filter(isNotNull)),(cells=>mapFirst$1(cells,(cell=>null!==cell.Layout),(cell=>Object.assign(Object.assign({},cell),{Layout:L2.ConvertFirstBody(cell.Layout,addAnchors)})))))}(cellsStripes,generateTocAnchor(member.GroupName,data.Header.Id)))}return{CellsStripes:cellsStripes,Count:occupiedCellsCount}}function GlueStripes(cellsStripesList){if(!cellsStripesList||!cellsStripesList.Head)return null;const head=LazyList.flatten(cellsStripesList.map((x=>x&&x.Head))),tail=()=>{const t=GlueStripes(cellsStripesList.map((x=>x&&x.Tail)));return t?t.filter(isNotNull):null};return head?LazyList.cons(head,tail):tail()}const emptyContent$1=h("div",[]);function InHeader(headerRows,cornerColumnCount){const colSpan=sum(headerRows[0].Cells.map((cell=>cell.RowSpan)));return{Type:"gridheader",HeaderRows:headerRows,CornerColumnCount:cornerColumnCount,Size:0,RowSpan:headerRows.length,ColSpan:colSpan}}const emptyCell=h("td",""),emptyContent=h("div",[]),EmptyBody=()=>LResult.Complete(1,null);function layoutRowMembers(tablixMembers,ctx,actions,layoutBody,bodyData,colsHidden){const ml=LazyList.fromIterable(function*(tablixMembers,ctx,actions,layoutBody,bodyData,colsHidden){const combinePieces=(size,r,r2)=>MakeBodyCol(size,r&&LazyList.cons(r,r2&&LazyList.cons(r2))),preventOrphanStepback=5,layoutGroupRowMember=m=>layoutRowMember(m,ctx,actions,!1,!1,layoutBody,bodyData,colsHidden);for(const g of function*(tablixMembers){let members={};const clean=()=>{members={};for(const kind of[MemberKind_Quit,MemberKind_Member,MemberKind_Header,MemberKind_Footer,MemberKind_Collection])members[kind]=[]};clean();let last=MemberKind_Member;for(let member of[...tablixMembers,null]){const kind=null==member?MemberKind_Quit:"After"==member[0].KeepWithGroup?MemberKind_Header:"Before"==member[0].KeepWithGroup?MemberKind_Footer:member[1].IsCollection?MemberKind_Collection:MemberKind_Member;if(kind<last||last==MemberKind_Member&&kind>MemberKind_Member||last==MemberKind_Collection&&kind==MemberKind_Collection){if(members[MemberKind_Collection].length>0){const hh=members[MemberKind_Header],ff=members[MemberKind_Footer];yield{Header:hh,RepeatHeader:hh.some((m=>m[0].RepeatOnNewPage)),Collection:members[MemberKind_Collection][0],Footer:ff,RepeatFooter:ff.some((m=>m[0].RepeatOnNewPage)),Members:null}}else members[MemberKind_Member].length>0?yield{Members:members[MemberKind_Member],Header:null,RepeatHeader:!1,Collection:null,Footer:null,RepeatFooter:!1}:yield{Members:members[MemberKind_Header].concat(members[MemberKind_Footer]),Header:null,RepeatHeader:!1,Collection:null,Footer:null,RepeatFooter:!1};clean()}if(null===member)return;members[kind].push(member),last=kind}}(tablixMembers))if(null!=g.Members){const mm=LazyList.fromArray(g.Members||[]),mmm=mm&&mm.filter(isNotNull),groupMembers=mmm&&mmm.map(layoutGroupRowMember).filter(isNotNull);null!==groupMembers&&(yield groupMembers)}else{const mc=g.Collection;if(null===mc)throw new LayoutError("Tablix member layout: collection have to be non empty.");let groupLayout=layoutGroupRowMember(mc);if(null!=g.Header&&g.Header.length>0){const hl=LazyList.fromArray(g.Header),headerMembers=hl&&hl.map(layoutGroupRowMember).filter(isNotEmpty).filter(isNotNull),headerLayout=headerMembers&&L.StackLazyList(headerMembers,MakeBodyCol),header=headerLayout&&L.KeepTogether(headerLayout,1/0,(result2=>result2.Body));if(null!==header){const body="EMPTY_COLLECTION"!==groupLayout?groupLayout:null,preventOrphans=!("Start"==mc[0].PageBreak||"StartAndEnd"==mc[0].PageBreak);groupLayout=null===body?header:g.RepeatHeader?L.Repeat(header,body,combinePieces):preventOrphans?L.PreventOrphans(header,body,preventOrphanStepback,combinePieces):L.StackLazyList(LazyList.cons(header,LazyList.cons(body)),MakeBodyCol)}}if(null!=g.Footer&&g.Footer.length>0){const fl=LazyList.fromArray(g.Footer),footerMembers=fl&&fl.map(layoutGroupRowMember).filter(isNotEmpty).filter(isNotNull),footerLayout=footerMembers&&L.StackLazyList(footerMembers,MakeBodyCol),footer=footerLayout&&L.KeepTogether(footerLayout,1/0,(result2=>result2.Body));if(null!==footer){const body="EMPTY_COLLECTION"!==groupLayout?groupLayout:null,preventOrphans=!("End"==mc[0].PageBreak||"StartAndEnd"==mc[0].PageBreak);groupLayout=null===body?footer:g.RepeatFooter?L.RepeatFooter(body,footer,combinePieces):preventOrphans?L.PreventOrphans(body,footer,preventOrphanStepback,combinePieces):L.StackLazyList(LazyList.cons(body,LazyList.cons(footer)),MakeBodyCol)}}null!=groupLayout&&(yield LazyList.cons(groupLayout))}}(tablixMembers,ctx,actions,layoutBody,bodyData,colsHidden)),memberLayoutsWithNulls=ml&&ml.selectMany((t=>t)),memberLayoutsOrEmpty=memberLayoutsWithNulls&&memberLayoutsWithNulls.filter(isNotNull),memberLayouts=memberLayoutsOrEmpty&&memberLayoutsOrEmpty.filter(isNotEmpty);return memberLayoutsOrEmpty&&!memberLayouts?"EMPTY_COLLECTION":memberLayouts&&L.StackLazyList(memberLayouts,MakeBodyCol)}const MemberKind_Quit=-1,MemberKind_Member=0,MemberKind_Header=1,MemberKind_Collection=2,MemberKind_Footer=3;function layoutRowMember(tablixMember,parentCtx,actions,breakBefore,breakAfter,layoutBody,bodyData,colsHidden){const[cMember,memberData]=tablixMember;let rowLayout=(data,ctx)=>function(tablixMember,parentCtx,actions,breakBefore,breakAfter,layoutBody,bodyData,colsHidden){const[member,data]=tablixMember;if(!data.IsCollection&&!member.Level&&member.IsHidden(data.Header)(actions))return null;const isLeaf=void 0!==data.Id,isCollection=data.IsCollection;let memberLayouts=null;const ctx=!isCollection&&member.GroupName?Object.assign(Object.assign({},parentCtx),{PeerScopes:{[member.GroupName]:data.Header.Id}}):parentCtx;let extraSpan=0;if(isLeaf){const row=GetCollectionItem(bodyData,data.Id),cellsData=row.Cells&&LazyList.fromArray(row.Cells);if(cellsData){const ml=function(cellsData,colsInfo,layoutBody,rowActions){let ordinal=-1,prevCell=null;return cellsData.map((cellData=>{ordinal++;let cell=prevCell||layoutBody(cellData,function(iState,actions){const isNew=a=>iState.ScopeToggles.findIndex((sa=>equals(sa,a)))<0;return Object.assign(Object.assign({},iState),{ScopeToggles:iState.ScopeToggles.concat(actions.filter(isNew))})}(rowActions,colsInfo[ordinal].Interactivity.ScopeToggles),ordinal);if(!cell)return null;if(colsInfo[ordinal].IsHidden)return prevCell=cell.ColSpan>1?Object.assign(Object.assign({},cell),{ColSpan:cell.ColSpan-1}):null,null;cell.ColSpan>1&&(cell=Object.assign(Object.assign({},cell),{ColSpan:cell.ColSpan-colsInfo.slice(ordinal,cell.ColSpan).filter(((_,idx)=>colsInfo[idx].IsHidden)).length}));const colNumber=ordinal+1,scopeID=cellData.Id,cellLayout=cell.Layout&&L2.ConvertBody(cell.Layout(cell.ColSpan),(vnode=>(vnode.properties.meta=Object.assign(Object.assign({},vnode.properties.meta),{colNumber:colNumber,scopeID:scopeID,rowType:"details"}),vnode)));return Object.assign(Object.assign({},cell),{Layout:cellLayout})})).filter(isNotNull)}(cellsData,colsHidden,((d,intr,col)=>layoutBody(d,intr,member.BodyIndex,col,ctx)),actions);memberLayouts=ml?ml.map((c=>GridImpl_InCell(null,c.Layout,c.ColSpan,member.Size,(()=>Empty2(emptyContent)),!1))):LazyList.cons(EmptyBody)}}else if(isCollection){const membersLazy=LazyList.fromIterable(data.Members||[]);if(membersLazy){const memberCollectionNullable=layoutRowCollection(member,membersLazy,ctx,actions,member.PageBreak,!0,layoutBody,bodyData,colsHidden),memberCollection=memberCollectionNullable&&memberCollectionNullable.filter(isNotNull);if(memberLayouts=memberCollection&&LazyList.cons(L.StackLazyList(memberCollection,MakeBodyCol)),!memberLayouts)return"EMPTY_COLLECTION"}}else{const lMembers=layoutRowMembers(iterable$1.zip(((m,d)=>[m,d]))(member.Children,data.Members),ctx,actions,layoutBody,bodyData,colsHidden);if("EMPTY_COLLECTION"===lMembers)return null;memberLayouts=lMembers&&LazyList.cons(lMembers);const extraTotal=function(members,data,actions){return pipe(iterable$1.zip(((m,d)=>[m,d])),iterable$1.filter((md=>md[0].IsExtraTotal&&!md[0].IsHidden(md[1].Header)(actions))),iterable$1.first,(tuple=>null!==tuple?tuple[0]:null))(members,data)}(member.Children,data.Members,actions);null!==extraTotal&&(extraSpan=function(extraTotal){let span=0,current=extraTotal;for(;null!==current;)null===current.Header&&current.IsExtraTotal&&!current.IsZeroSpan&&span++,current=current.Children&&current.Children.length?current.Children[0]:null;return span}(extraTotal))}let header=!isCollection&&member.Header?LazyList.cons(member.Header).map((h=>{const clayout=h&&h.Layout(data.Header,ctx)(actions),cellHeight=sum(collectLeafNodes(member,data,actions).map((m=>m.Size))),colSpan=h.ColSpan+extraSpan;return GridImpl_InCell(null,clayout(member.GetSize2(colSpan),cellHeight),colSpan)})):null;null===header&&extraSpan>0&&!member.IsExtraTotal&&(header=LazyList.cons(GridImpl_InCell(null,L.Empty(L.Empty(emptyCell)),extraSpan)));if(!header&&!memberLayouts)return null;let memberLayout=memberLayouts?header||memberLayouts.Tail?GridRow2(header&&header.concat(memberLayouts)||memberLayouts,(()=>Empty2(emptyCell))):memberLayouts.Head:header.Head;if(null==memberLayout)return null;if(!isCollection){if(member.KeepTogether&&(memberLayout=L.KeepTogether(memberLayout,1/0,(result2=>result2.Body))),member.Label){member.Label(data.Header)(actions)&&(memberLayout=addRowMemberLabel(memberLayout,{ToCAnchor:generateTocAnchor(member.GroupName,data.Header.Id)}))}breakBefore&&(memberLayout=L.PageBreakBefore(memberLayout)),breakAfter&&(memberLayout=L.PageBreakAfter(memberLayout))}return memberLayout}([cMember,data],ctx,actions,breakBefore,breakAfter,layoutBody,bodyData,colsHidden);return cMember.NewSection&&!memberData.IsCollection&&(rowLayout=((layout,getSectionId)=>(data,parentCtx)=>{const sectionId=getSectionId(data),ctx=Object.assign(Object.assign({},parentCtx),{EvalDynamicRuntime:evaluate(sectionId)}),layoutResult=layout(data,ctx);return null===layoutResult||"EMPTY_COLLECTION"===layoutResult?layoutResult:addSectionAttributes(layoutResult,sectionId)})(rowLayout,(d=>`${cMember.GroupName}#${d.Header.Id}`))),rowLayout(memberData,parentCtx)}const getMemberRecTail=getRecTail((mData=>mData.Header));function layoutRowCollection(member,dataLazy,ctx,actions,pb,first,layoutBody,bodyData,colsHidden){const pageBreakDisabled=dataLazy&&member.PageBreakDisabled(dataLazy.Head.Header)(actions),breakBefore=("Start"===pb||"StartAndEnd"===pb||"Between"===pb&&!first)&&!pageBreakDisabled;let memberLayout=null,tail=dataLazy;for(;!memberLayout;){if(!tail)return null;const rowData=tail;tail=member.Level?getMemberRecTail(member.IsHidden,member.Level)(rowData,actions):rowData.Tail;const breakAfter=("End"===pb||"StartAndEnd"===pb&&null===tail)&&!pageBreakDisabled,itemActions=getMemberInteractivity(member,actions,rowData.Head,rowData.Tail&&rowData.Tail.Head),memberLayout1=layoutRowMember([member,rowData.Head],ctx,itemActions,breakBefore,breakAfter,layoutBody,bodyData,colsHidden);memberLayout="EMPTY_COLLECTION"===memberLayout1?null:memberLayout1}return LazyList.cons(memberLayout,(()=>layoutRowCollection(member,tail,ctx,actions,pb,!1,layoutBody,bodyData,colsHidden)))}function isNotEmpty(x){return"EMPTY_COLLECTION"!==x}const emptyItem=h("","");function layoutTablix(tablix,data,ctx,actions,columnsHierarchy,rowsHierarchy,cornerCells,layoutBodyCell,itemCommon,makeResult,collapseRepeatingCells){const headerLayout=function(tablix,data,ctx,actions,lCorner,columns){const colCells=layoutColumnMembers(columns,data,ctx,actions).CellsStripes,columnHierarchy=colCells&&colCells.Reverse();if(!lCorner&&!columnHierarchy)return null;const headerCellsRows=lCorner&&columnHierarchy?LazyList.zip(lCorner,columnHierarchy,((cornerCells,columnCells)=>LazyList.concat(cornerCells,columnCells))):lCorner||columnHierarchy,headerRows=LazyList.zip(headerCellsRows,LazyList.fromArray(tablix.CornerRowSizes),((cells,size)=>MakeStripe(cells.toArray(),size))),options=MakeGridCellOptions((()=>Empty2(emptyContent$1)));return headerRows&&LazyList.cons(GridCells(headerRows,options,((height,rows)=>InHeader(rows,tablix.CornerColSizes.length))))}(tablix,data.ColumnMembers,ctx,actions,cornerCells,columnsHierarchy),header=headerLayout&&L.StackLazyList(headerLayout,MakeBodyCol),columnsMap=[];collectMembersDataMap(columnsHierarchy,data.ColumnMembers,columnsMap);const rowMembers=iterable$1.zip(((m,d)=>[m,d]))(rowsHierarchy,data.RowMembers),colsInfo=[];collectColsInfo(columnsHierarchy,data.ColumnMembers,colsInfo,{IsHidden:!1,PageBreakBefore:!1,PageBreakAfter:!1,Interactivity:actions});const bodyRows=function(tablixMembers,ctx,actions,layoutBody,bodyData,colsHidden){const result=layoutRowMembers(tablixMembers,ctx,actions,layoutBody,bodyData,colsHidden);return"EMPTY_COLLECTION"===result?null:result}(rowMembers,ctx,actions,((cellData,iState,rowDefIndex,columnOrdinal,rCtx)=>layoutBodyCell[rowDefIndex][columnsMap[columnOrdinal]](cellData,rCtx)(iState)),data.Body||[],colsInfo);let wholeThingLayout=header?tablix.RepeatColumnHeaders&&bodyRows?L.Repeat(header,bodyRows,((size,r,r2)=>MakeBodyCol(size,LazyList.cons(r,r2&&LazyList.cons(r2))))):L.StackLazyList(LazyList.cons(header,bodyRows&&LazyList.cons(bodyRows)),MakeBodyCol):bodyRows;if(!wholeThingLayout)return Empty2((()=>emptyItem));(itemCommon.ToCAnchor||itemCommon.Bookmark)&&(wholeThingLayout=addRowMemberLabel(wholeThingLayout,itemCommon));const colWidths=[];collectMembersBodySize(columnsHierarchy,colWidths);const allColumnWidths=tablix.CornerColSizes.concat(columnsMap.map((bodyIndex=>colWidths[bodyIndex])).filter(((w,i)=>!colsInfo[i].IsHidden))),columnsBeforeCount=function(columnsHierarchy,colsData,groupsBeforeRowHeaders,actions){const firstMember=columnsHierarchy[0];if(null==firstMember||null==firstMember.GroupName)return 0;const membersBeforeRowHeaders=[];collectColsInfo([firstMember],[colsData[0]],membersBeforeRowHeaders,{IsHidden:!1,PageBreakBefore:!1,PageBreakAfter:!1,Interactivity:actions});return membersBeforeRowHeaders.slice(0,groupsBeforeRowHeaders).filter((m=>!m.IsHidden)).length}(columnsHierarchy,data.ColumnMembers,tablix.GroupsBeforeRowHeaders,actions),rtl=tablix.RightToLeft,options=MakeGridCellOptions((item=>function(item){return L.Empty(item)}(item)),rtl,0,tablix.RepeatRowHeaders,tablix.CornerColSizes.length,columnsBeforeCount),columnPageBreaks=LazyList.fromArray(tablix.CornerColSizes.map((_=>({PageBreakBefore:!1,PageBreakAfter:!1}))).concat(colsInfo.filter((ci=>!ci.IsHidden)).map((ci=>({PageBreakBefore:ci.PageBreakBefore,PageBreakAfter:ci.PageBreakAfter}))))),preLayout=L.SuppressPageBreaks(wholeThingLayout);return L.ConvertBody(preLayout,(pass1Result=>{if(null===pass1Result)return L.Empty((()=>emptyItem));return LayoutColumns(function(fillColumnData,columnPageBreaks){return LazyList.zip(fillColumnData,columnPageBreaks,((column,colInfo)=>Object.assign(Object.assign({},column),{PageBreakBefore:colInfo.PageBreakBefore,PageBreakAfter:colInfo.PageBreakAfter})))}(FillColumnData(pass1Result,allColumnWidths,rtl),columnPageBreaks),options,collapseRepeatingCells(((width,list)=>makeResult(width,pass1Result.Size,CollectRowHeights(pass1Result),list,ctx))))}))}function collectMembersBodySize(members,map){for(let i=0;i<members.length;i++)collectMemberBodySize(members[i],map)}function collectMemberBodySize(member,map){member.BodyIndex>=0?map[member.BodyIndex]=member.Size:collectMembersBodySize(member.Children,map)}function makeRender$c(compiledItem,embeddedImageResolver){const roundingStyle=createRoundingOnlyStyle(compiledItem.RoundingRadius,compiledItem.ShapeStyle),borderStyle=createBordersOnlyStyle(compiledItem),bgStyle=createBackgroundOnlyStyle(compiledItem),bgImageClassName=getEmbeddedImageClass(compiledItem.BackgroundImage,embeddedImageResolver),sb=styleBuilder();sb.add("vertical-align",[compiledItem.VerticalAlign]);const cellStyle=(styles=[sb.style,bgStyle,borderStyle,roundingStyle].filter(Boolean),{static:Object.assign({},...styles.map((s=>s.static))),dynamic:data=>{const dynamics=styles.map((s=>s.dynamic(data)));return{style:Object.assign({},...dynamics.map((s=>s.style))),renderTimeStyle:dynamics.some((s=>null!==s.renderTimeStyle))?globals=>Object.assign({},...dynamics.map((s=>null===s.renderTimeStyle?{}:s.renderTimeStyle(globals)))):null}}});var styles;const contentStyle=borderStyle&&function(style){const sb=styleBuilder();return sb.add("marginLeft",getLeftSet(style),getBackgroundPos),sb.add("marginTop",getTopSet(style),getBackgroundPos),sb.add("marginBottom",getBottomSet(style),getBackgroundPos),sb.add("marginRight",getRightSet(style),getBackgroundPos),sb.style}(compiledItem);return function(itemName,cellStyle,contentStyle,compiledItem,bgImageClassName){const cellClassName=Object.keys(cellStyle.static).length>0?`${itemName}CellStyle`:null,styles=[];cellClassName&&styles.push({className:cellClassName,style:cellStyle.static});const contentClassName=contentStyle&&Object.keys(contentStyle.static).length>0?`${itemName}CellContentStyle`:null;contentClassName&&contentStyle&&styles.push({className:contentClassName,style:contentStyle.static});return{styles:styles,render:(data,ctx)=>content=>{const resolvedModel=resolveItemCommon(compiledItem,data,ctx),cellStyleResolved=cellStyle.dynamic(data),bordersData=cellStyle?extractBordersData(cellStyle,data,ctx.RendererOptions.TableStaticHeaders):{},cell=function(className,contentClassName,cellStyle,contentStyle,content,renderContext,model,customAttributes){if(!content)return renderEmptyTableCell(customAttributes);if(!(content.children&&content.children.length||content.properties.style))return renderEmptyTableCell(customAttributes);const{patcher:stylePatcher,id:styleId}=createStylePatcher(renderContext,cellStyle),{patcher:bgPatcher,id:bgId}=createClassNamePatcher(renderContext,className,styleId),cellPatcher=joinPatchers(stylePatcher,content?content.properties.patcher:null,bgPatcher),id=null!=bgId?bgId:styleId;contentClassName&&(content.properties.className+=` ${contentClassName}`);contentStyle&&(content.properties.style||(content.properties.style={}),Object.assign(content.properties.style,contentStyle.style));const cellContent=h("div",{className:"arjs-cellContent"},[content]);return h("td",{id:id,className:joinClassNames("arjs-tableCell","function"!=typeof className?className:null),style:cellStyle.style,patcher:cellPatcher,attributes:customAttributes},[model.ToCAnchor?h("a",{type:"toc_label",name:model.ToCAnchor},[]):[],cellContent])}(wrapRuntimeValue(resolveCompiled$1(bgImageClassName,data),(value=>joinClassNames(cellClassName,value))),contentClassName,cellStyleResolved,contentStyle&&contentStyle.dynamic(data),content,ctx,resolvedModel,bordersData);return addActionAttribute(cell,resolvedModel.Action),cell}}}(compiledItem.Name,cellStyle,contentStyle,compiledItem,bgImageClassName)}function renderEmptyTableCell(customAttributes){return h("td",{className:"arjs-tableCell",attributes:customAttributes},[])}function extractBordersData(style,data,forceExtract){if(!forceExtract&&"firefox"!==environment)return{};const dynamicStyle=style.dynamic(data),borders={top:dynamicStyle.style.borderTopWidth||style.static.borderTopWidth||style.static.borderWidth,left:dynamicStyle.style.borderLeftWidth||style.static.borderLeftWidth||style.static.borderWidth,right:dynamicStyle.style.borderRightWidth||style.static.borderRightWidth||style.static.borderWidth,bottom:dynamicStyle.style.borderBottomWidth||style.static.borderBottomWidth||style.static.borderWidth};return{"data-borders":JSON.stringify({top:borders.top&&Length.toCss(Length.parse(borders.top))||"0pt",left:borders.left&&Length.toCss(Length.parse(borders.left))||"0pt",right:borders.right&&Length.toCss(Length.parse(borders.right))||"0pt",bottom:borders.bottom&&Length.toCss(Length.parse(borders.bottom))||"0pt"})}}function getIndexesMatrix(originTable){const totalRows=originTable[0].length;let zIndex=1;return function getIndexMatrix(firstColIdx,lastColIdx,firstRowIdx,lastRowIdx){let mergedCellRoot;for(let colIdx=firstColIdx;colIdx<=lastColIdx;colIdx++){let maxColSpan=1;for(let rowIdx=firstRowIdx;rowIdx<=lastRowIdx;rowIdx++){const currentCell=originTable[colIdx][rowIdx];currentCell.ColSpan>maxColSpan&&(maxColSpan=currentCell.ColSpan,mergedCellRoot=Object.assign(Object.assign({},currentCell),{colIdx:colIdx,rowIdx:rowIdx}))}if(mergedCellRoot)break}if(mergedCellRoot){const{colIdx:colIdx,rowIdx:rowIdx,ColSpan:ColSpan,RowSpan:RowSpan}=mergedCellRoot,prevSubTable=getIndexMatrix(colIdx+ColSpan,lastColIdx,firstRowIdx,lastRowIdx),bottomSubTable=getIndexMatrix(colIdx,lastColIdx,rowIdx+RowSpan,lastRowIdx),mergedCells=Array(ColSpan).fill(Array(RowSpan).fill(zIndex));zIndex++;const topSubTable=getIndexMatrix(colIdx,colIdx+ColSpan-1,firstRowIdx,rowIdx-1);return[...getIndexMatrix(firstColIdx,colIdx-1,firstRowIdx,lastRowIdx),...mergeSubTables(topSubTable,mergedCells,bottomSubTable),...prevSubTable]}return function(firstColIdx,lastColIdx,firstRowIdx,lastRowIdx){const result=[];for(let colNum=lastColIdx;colNum>=firstColIdx;colNum--){const row=[];for(let rowNum=lastRowIdx;rowNum>=firstRowIdx;rowNum--)row.unshift(zIndex),originTable[colNum][rowNum].IsHole||zIndex++;result.unshift(row)}return result}(firstColIdx,lastColIdx,firstRowIdx,lastRowIdx)}(0,originTable.length-1,0,totalRows-1)}function mergeSubTables(topTable,middleTable,bottomTable){var _a,_b;const resultTable=[];for(let colIdx=0;colIdx<middleTable.length;colIdx++)resultTable.push([...null!==(_a=topTable[colIdx])&&void 0!==_a?_a:[],...middleTable[colIdx],...null!==(_b=bottomTable[colIdx])&&void 0!==_b?_b:[]]);return resultTable}const pt=Length.toCss;function renderCell(cellInfo,patchers){var _a,_b,_c,_d;const cell=cellInfo.Body;if(cell.properties.colSpan=cellInfo.ColSpan,cell.properties.rowSpan=cellInfo.RowSpan,cellInfo.StickyOptions){const{topStickyPosition:topStickyPosition,leftStickyPosition:leftStickyPosition,zIndex:zIndex}=cellInfo.StickyOptions;cell.properties.className=joinClassNames(cell.properties.className,"arjs-frozen-cell"),cell.properties.style=Object.assign(Object.assign({},cell.properties.style),{top:void 0!==topStickyPosition?Length.toCss(topStickyPosition):void 0,left:void 0!==leftStickyPosition?Length.toCss(leftStickyPosition):void 0,zIndex:zIndex})}if(cellInfo.ContentDimensions){const{size:size,bordersOverflow:bordersOverflow}=cellInfo.ContentDimensions,cellContent=cell.children[0],bordersStyle=Object.entries(null!==(_a=cell.properties.style)&&void 0!==_a?_a:{}).filter((([key])=>key.startsWith("border")||key.startsWith("background"))).reduce(((agg,[key,value])=>(agg[key]=value,agg)),{});cell.properties.style=null!==(_b=cell.properties.style)&&void 0!==_b?_b:{};const contentDiv=h("div",{},[cellContent]);cellContent.properties.style=Object.assign(Object.assign(Object.assign({},cellContent.properties.style),bordersStyle),{height:Length.toCss(size.height),width:Length.toCss(size.width),marginTop:`-${Length.toCss(bordersOverflow.top)}`,marginLeft:`-${Length.toCss(bordersOverflow.left)}`});const borderClassName=null!==(_d=null===(_c=cell.properties.className)||void 0===_c?void 0:_c.split(" ").filter((c=>c.endsWith("CellStyle")))[0])&&void 0!==_d?_d:null;cellContent.properties.className=joinClassNames(cellContent.properties.className,borderClassName),cell.properties.className=joinClassNames(cell.properties.className,"arjs-cell-outline-borders"),cell.children=[contentDiv]}return patchers.push(cell.properties.patcher),cell}function renderTable(itemClassName,tableStyle,width,height,heights,columns,renderContext,customAttributes,frozenCells){const colgroup=h("colgroup",columns.map((c=>h("col",{style:{width:pt(c.Size)}},[])))),cellPatchers=[],rows=[],totalRows=heights.length,rowHeights=heights,colWidths=columns.map((c=>c.Size)),frozenRowsPosition=frozenCells.rows?rowHeights.slice(0,frozenCells.rows-1).reduce(((res,curr)=>{var _a;return res.push((null!==(_a=res[res.length-1])&&void 0!==_a?_a:0)+curr),res}),[0]):[],frozenColsPosition=frozenCells.columns?colWidths.slice(0,frozenCells.columns-1).reduce(((res,curr)=>{var _a;return res.push((null!==(_a=res[res.length-1])&&void 0!==_a?_a:0)+curr),res}),[0]):[],getContentDimensions=frozenCells.rows||frozenCells.columns?function(columns,rowHeights,colWidths){const bordersOriginMatrix=columns.map((c=>c.Cells.map((tdCell=>{var _a,_b;return(null===(_b=null===(_a=tdCell.Body)||void 0===_a?void 0:_a.properties.attributes)||void 0===_b?void 0:_b["data-borders"])&&tdCell})).map((tdCell=>tdCell&&Object.assign(Object.assign({},JSON.parse(tdCell.Body.properties.attributes["data-borders"])),{rowSpan:tdCell.RowSpan,colSpan:tdCell.ColSpan}))).map((item=>item&&{left:Length.parse(item.left),top:Length.parse(item.top),bottom:Length.parse(item.bottom),right:Length.parse(item.right),rowSpan:item.rowSpan,colSpan:item.colSpan})))),caclBorderWidth=(current,sibling)=>void 0===sibling?null!=current?current:0:current>=sibling?current:(sibling-current)/2,getPrevColumnBorder=(colIdx,rowIdx)=>{var _a;for(let prevRowIdx=rowIdx;prevRowIdx>=0;prevRowIdx--)for(let prevColIdx=colIdx-1;prevColIdx>=0;prevColIdx--){const prevItem=null===(_a=bordersOriginMatrix[prevColIdx])||void 0===_a?void 0:_a[prevRowIdx];if(prevItem&&prevItem.colSpan===colIdx-prevColIdx)return prevItem.right}},getPrevRowBorder=(colIdx,rowIdx)=>{var _a;for(let prevColIdx=colIdx;prevColIdx>=0;prevColIdx--)for(let prevRowIdx=rowIdx-1;prevRowIdx>=0;prevRowIdx--){const prevItem=null===(_a=bordersOriginMatrix[prevColIdx])||void 0===_a?void 0:_a[prevRowIdx];if(prevItem&&prevItem.rowSpan===rowIdx-prevRowIdx)return prevItem.bottom}},bordersOverflowMatrix=bordersOriginMatrix.map(((col,colIdx)=>col.map(((cellBorders,rowIdx)=>{var _a,_b;return{left:caclBorderWidth(null!==(_a=null==cellBorders?void 0:cellBorders.left)&&void 0!==_a?_a:0,getPrevColumnBorder(colIdx,rowIdx)),top:caclBorderWidth(null!==(_b=null==cellBorders?void 0:cellBorders.top)&&void 0!==_b?_b:0,getPrevRowBorder(colIdx,rowIdx))}})))),getCellHeight=(rowNum,rowSpan)=>sumRange(rowHeights,rowNum,rowSpan),getCellWidth=(colNum,colSpan)=>sumRange(colWidths,colNum,colSpan);return(rowIdx,rowSpan,colIdx,colSpan)=>({size:{width:getCellWidth(colIdx,colSpan)+bordersOriginMatrix[colIdx][rowIdx].left/2+bordersOriginMatrix[colIdx][rowIdx].right/2,height:getCellHeight(rowIdx,rowSpan)+bordersOriginMatrix[colIdx][rowIdx].top/2+bordersOriginMatrix[colIdx][rowIdx].bottom/2},bordersOverflow:bordersOverflowMatrix[colIdx][rowIdx]})}(columns,rowHeights,colWidths):null,zIndexexMatrix=getIndexesMatrix(columns.map((col=>col.Cells.map((({ColSpan:ColSpan,RowSpan:RowSpan,IsHole:IsHole})=>({ColSpan:ColSpan,RowSpan:RowSpan,IsHole:IsHole}))))));for(let rowNum=0;rowNum<totalRows;rowNum++){const rowHeight=rowHeights[rowNum],topStickyPosition=frozenRowsPosition[rowNum],isFrozenRow=void 0!==topStickyPosition,rowCells=columns.map((col=>col.Cells[rowNum])).map((({Body:Body,ColSpan:ColSpan,RowSpan:RowSpan,IsHole:IsHole},colIdx)=>{var _a;if(IsHole)return null;if(null==Body)throw new Error("Table render error: cell is missing");const leftStickyPosition=frozenColsPosition[colIdx];return renderCell({Body:Body,ColSpan:ColSpan,RowSpan:RowSpan,StickyOptions:void 0!==leftStickyPosition||isFrozenRow?{topStickyPosition:topStickyPosition,leftStickyPosition:leftStickyPosition,zIndex:null===(_a=zIndexexMatrix[colIdx])||void 0===_a?void 0:_a[rowNum]}:void 0,ContentDimensions:void 0!==leftStickyPosition||void 0!==topStickyPosition?null==getContentDimensions?void 0:getContentDimensions(rowNum,RowSpan,colIdx,ColSpan):void 0},cellPatchers)})).filter(isNotNull),row=h("tr",{className:void 0!==topStickyPosition?"arjs-frozen-row":void 0,style:{height:pt(rowHeight)},GroupType:"group"},rowCells);rows.push(row)}const tBody=h("tbody",rows),{patcher:patcher,id:id}=createStylePatcher(renderContext,tableStyle),tablePatcher=joinPatchers(cellPatchers,patcher),style=Object.assign({},tableStyle.style,{width:pt(width),height:pt(height)});return h("table",{id:id,className:itemClassName?`arjs-tableItem ${itemClassName}`:"arjs-tableItem",style:style,patcher:tablePatcher,attributes:customAttributes},[colgroup,tBody])}function makeRender$b(compiledItem,embeddedImageResolver){const borderStyle=createBordersOnlyStyle(compiledItem),bgStyle=createBackgroundOnlyStyle(compiledItem),bgImageClassName=getEmbeddedImageClass(compiledItem.BackgroundImage,embeddedImageResolver),borderWidthConpensation=borderStyle&&function(style){const sb=styleBuilder();return sb.add("marginLeft",getLeftSet(style),getTablePos),sb.add("marginTop",getTopSet(style),getTablePos),sb.add("marginBottom",getBottomSet(style),getTablePos),sb.add("marginRight",getRightSet(style),getTablePos),sb.style}(compiledItem),tableStyle=function(styles){return{static:Object.assign({},...styles.map((s=>s.static))),dynamic:data=>{const dynamics=styles.map((s=>s.dynamic(data)));return{style:Object.assign({},...dynamics.map((s=>s.style))),renderTimeStyle:dynamics.some((s=>null!==s.renderTimeStyle))?globals=>Object.assign({},...dynamics.map((s=>null===s.renderTimeStyle?{}:s.renderTimeStyle(globals)))):null}}}}([bgStyle,borderStyle,borderWidthConpensation].filter(isNotNull));tableStyle.static.zIndex=compiledItem.ZIndex.toString();const itemName=compiledItem.Name,className=Object.keys(tableStyle.static).length>0?`${itemName}Style`:null;return{styles:className?[{className:className,style:tableStyle.static}]:[],render:(data,ctx)=>(width,height,heights,columns)=>arrangement=>{const tableStyleDynamic=tableStyle.dynamic(data);arrangement.HFirst||(tableStyleDynamic.style.borderLeftStyle="none"),arrangement.VFirst||(tableStyleDynamic.style.borderTopStyle="none"),arrangement.HLast||(tableStyleDynamic.style.borderRightStyle="none"),arrangement.VLast||(tableStyleDynamic.style.borderBottomStyle="none");const customAttributes=Object.assign(Object.assign({},borderStyle&&extractBordersData(borderStyle,data,!1)),{title:resolveItemCommon(compiledItem,data,ctx).Tooltip,"data-name":`${compiledItem.Name}_${data.Id}`}),frozenCells=ctx.RendererOptions.TableStaticHeaders?{rows:compiledItem.FrozenRows,columns:compiledItem.FrozenColumns}:{rows:0,columns:0};return renderTable(`${className||""} ${bgImageClassName(data)}`,tableStyleDynamic,width,height,heights,columns,ctx,customAttributes,frozenCells)}}}const noBorder={Color:"Transparent",Style:"None",Width:"0pt"};function makeCell(cellContent,i18n,cellType,action){const content=isSupportedItem(cellContent)?Object.assign({},cellContent):stubUnsupportedItem(cellContent,i18n);content.Width="0pt",content.Height="0pt","line"!==content.Type&&"sparkline"!==content.Type&&"bandedlist"!==content.Type&&"bullet"!==content.Type&&(content.Style=Object.assign({},content.Style));const result={Name:`${content.Name}Cell`,Type:"tablixcell",BackgroundColor:null,VerticalAlign:null,BackgroundImage:null,Borders:null,RoundingRadius:null,Content:content,Label:null,LayerName:content.LayerName,CellType:cellType,Visibility:"Visibility"in cellContent&&"list"!==cellContent.Type?cellContent.Visibility:createVisibility(),Action:null!=action?action:createAction()};return"line"!==content.Type&&"sparkline"!==content.Type&&"bandedlist"!==content.Type&&"bullet"!==content.Type&&(result.Borders={Border:content.Style.Border,LeftBorder:content.Style.LeftBorder,TopBorder:content.Style.TopBorder,RightBorder:content.Style.RightBorder,BottomBorder:content.Style.BottomBorder},content.Style.Border=noBorder,content.Style.LeftBorder=noBorder,content.Style.TopBorder=noBorder,content.Style.RightBorder=noBorder,content.Style.BottomBorder=noBorder),"image"!==content.Type&&"line"!==content.Type&&"subreport"!==content.Type&&"bandedlist"!==content.Type&&"bullet"!==content.Type&&"sparkline"!==content.Type&&(result.BackgroundColor=content.Style.BackgroundColor,content.Style.BackgroundColor="Transparent","tableofcontents"!==content.Type&&"barcode"!==content.Type&&"inputfield"!==content.Type&&(result.BackgroundImage={Value:content.Style.BackgroundImage.Value,MIMEType:content.Style.BackgroundImage.MIMEType,Source:content.Style.BackgroundImage.Source,BackgroundRepeat:content.Style.BackgroundImage.BackgroundRepeat},content.Style.BackgroundImage=Object.assign(Object.assign({},content.Style.BackgroundImage),{Value:""}))),"textbox"===content.Type&&(result.VerticalAlign=content.Style.VerticalAlign),"rectangle"!==content.Type&&"shape"!==content.Type||(result.RoundingRadius=content.RoundingRadius),result}function cleanContent(query){return query.Fields&&0!==query.Fields.length||query.Regions&&0!==query.Regions.length?query.Regions&&0!==query.Regions.length?query.Fields&&0!==query.Fields.length?query:{Regions:query.Regions}:{Fields:query.Fields}:{}}function cleanMember(query){const result={};return query.Header&&(result.Header=cleanContent(query.Header)),query.Group&&(result.Group=function(group){const result={Name:group.Name};return group.GroupExpressions&&(result.GroupExpressions=group.GroupExpressions),group.Parent&&(result.Parent=group.Parent),group.Filters&&group.Filters.length&&(result.Filters=group.Filters),result}(query.Group)),query.Sort&&query.Sort.length&&(result.Sort=query.Sort),query.Members&&query.Members.length&&(result.Members=query.Members),result}const defaultVisibility$1=createVisibility();function compileMembers(members,bodySizes,levelSizes,context,memberType){return __awaiter(this,void 0,void 0,(function*(){const compiled=yield Promise.all(members.map((m=>__awaiter(this,void 0,void 0,(function*(){return yield compileMember(m,bodySizes,levelSizes,context,memberType)})))));return needExtraTotal(members)&&compiled.push(...compiled.map((c=>createExtraTotal(c,!0)))),{Query:compiled.map((c=>c.Query)).filter(Boolean),Members:compiled.map((c=>c.Member)),Styles:flatten$1(compiled.map((c=>c.Styles)))}}))}function needExtraTotal(members){if(!members.filter((c=>c.Group)).length)return!1;if(members.filter((c=>isRecursiveHierarchy(c))).length)return!1;const distinctToggles=uniq(members.map((c=>c.Visibility.ToggleItem)));if(1!==distinctToggles.length||!distinctToggles[0])return!1;return 1===uniq(members.map((c=>c.Visibility.Hidden)).map((h=>"boolean"==typeof h?h:"true"===h.toLowerCase()||"true"!==h.toLowerCase()&&h))).length}function createExtraTotal(cMember,isTopLevel=!1){let headerQuery=cMember.Query.Header,totalIsHidden=d=>a=>!cMember.Member.IsHidden(d)(a);if(!isTopLevel&&cMember.Query.Group){const hiddenQuery={Fields:[],Regions:[]},memberIsHidden=compileVisibility$1(cMember.Member.VisibilityRaw,hiddenQuery);totalIsHidden=d=>a=>!memberIsHidden(d)(a),headerQuery=hiddenQuery.Fields.length>0?hiddenQuery:void 0}const newMember=createExtraTotalMember(cMember,!0,isTopLevel);return{Query:Object.assign(Object.assign({},newMember.Query),headerQuery?{Header:headerQuery}:null),Member:Object.assign(Object.assign({},newMember.Member),{IsHidden:totalIsHidden}),Styles:[]}}function createExtraTotalMember(member,isExtraTotal,isTopLevel){const children=zipWith(member.Member.Children||[],member.Query.Members||[],((m,q)=>({Member:m,Query:q,Styles:[]}))).filter((m=>!m.Member.IsExtraTotal)).map((m=>createExtraTotalMember(m,!!m.Query.Group,!1))),hasHeader=isTopLevel||!member.Query.Group&&!!member.Query.Header,childrenQuery=children.map((c=>c.Query));return{Query:Object.assign(Object.assign({},hasHeader?{Header:member.Query.Header}:null),childrenQuery.length?{Members:childrenQuery}:null),Member:Object.assign(Object.assign({},member.Member),{Header:hasHeader?member.Member.Header:null,IsHidden:hasHeader?member.Member.IsHidden:()=>()=>!1,IsExtraTotal:isExtraTotal,IsZeroSpan:isExtraTotal&&null===member.Member.Header&&null!==member.Query.Group,Children:children.map((c=>c.Member))}),Styles:[]}}function compileVisibility$1(visibility,queryRef){const hiddenComp=createTypedCompiler((function(value){return compileExpression(value,queryRef.Fields)})).compileBoolean(visibility.Hidden,defaultVisibility$1.Hidden);return data=>actions=>(data=>{const resolved=resolveCompiled$1(hiddenComp,data);return"function"!=typeof resolved?toBoolean(resolved):resolved})(data)!==(actions=>!!visibility.ToggleItem&&actions.ScopeToggles.filter((a=>"toggle"===a.Type&&1===a.ItemPath.length&&visibility.ToggleItem.toLowerCase()===a.ItemPath[0].toLowerCase())).length%2>0)(actions)}function compileMember(member,bodySizes,levelSizes,context,memberType){var _a,_b;return __awaiter(this,void 0,void 0,(function*(){if(member.BodyIndex<0&&!member.Children.length)throw new LayoutError("Empty children of not leaf member");const childrenLevelSizes=member.Header&&member.Header.Item?levelSizes.slice(member.Header.LevelCount||1):levelSizes,cChildren=member.Children&&(yield Promise.all(member.Children.map((m=>__awaiter(this,void 0,void 0,(function*(){return yield compileMember(m,bodySizes,childrenLevelSizes,context,memberType)}))))));needExtraTotal(member.Children)&&cChildren.push(...cChildren.map((c=>createExtraTotal(c))));const headerCellItem=(null===(_a=member.Header)||void 0===_a?void 0:_a.Item)?makeCell(member.Header.Item,context.i18n,memberType):null,cHeader=headerCellItem?yield compile$2(headerCellItem,Object.assign(Object.assign({},context),{ContainerSize:null})):null,hCell=cHeader&&function(layout,rowSpan,colSpan,documentMap,arrangement=Arrangements.Both,arrangementPrev=Arrangements.None,repeatable=!1){return{Layout:layout,RowSpan:rowSpan,ColSpan:colSpan,Arrangement:arrangement,ArrangementPrev:arrangementPrev,Repeatable:repeatable,IsEmpty:0===rowSpan&&0===colSpan,DocumentMap:documentMap}}(cHeader.Layout,cChildren.length||1,(null===(_b=member.Header)||void 0===_b?void 0:_b.LevelCount)||1,cHeader.DocumentMap);const exprComp=createTypedCompiler((function(value){return compileExpression(value,hQuery.Fields)})),hQuery=cHeader&&cHeader.Query||{Fields:[],Regions:[]};let level=null;if(isRecursiveHierarchy(member)){const levelComp=exprComp.compileNumber("=Level()");level=data=>resolveCompiled$1(levelComp,data)}const isHidden=compileVisibility$1(member.Visibility,hQuery),isPageBreakDisabled=function(pageBreakDisabled,exprComp){const compiledPageBreakDisabled=pageBreakDisabled?exprComp.compileBoolean(pageBreakDisabled):null;return data=>()=>toBoolean(resolveCompiled$1(compiledPageBreakDisabled,data))}(member.Group&&member.Group.PageBreakDisabled,exprComp),labelValue=member.Group&&member.Group.DocumentMapLabel?function(label,exprComp){const labelComp=exprComp.compileString(label);return data=>actions=>resolveCompiled$1(labelComp,data)}(member.Group.DocumentMapLabel,exprComp):null,sortExpressions=member.Group&&context.Interactivity.SortExpressions[member.Group.Name];sortExpressions&&(hQuery.Fields=uniq(hQuery.Fields.concat(sortExpressions)));const query=Def.Makers.TablixMember(member.Group?Def.Makers.Group(member.Group.Name,member.Group.GroupExpressions,member.Group.Filters?member.Group.Filters.map((f=>({Expression:f.FilterExpression,Op:f.Operator,Values:f.FilterValues}))):void 0,member.Group.ParentGroup||void 0):null,member.SortExpressions&&member.SortExpressions.map((e=>({Expression:e.Value,Direction:e.Direction})))||[],hQuery.Fields.length>0||hQuery.Regions.length>0?hQuery:null,cChildren&&cChildren.map((c=>c.Query)).filter(Boolean)||[]),cMember={Header:hCell,Children:cChildren&&cChildren.map((c=>c.Member))||[],Size:member.BodyIndex>=0?sumRange(bodySizes,member.BodyIndex,member.BodyCount):null,GetSize2:levelCount=>sumRange(levelSizes,0,levelCount),BodyIndex:member.BodyIndex,PageBreak:member.Group?member.Group.PageBreak:"None",PageBreakDisabled:isPageBreakDisabled,IsHidden:isHidden,VisibilityRaw:member.Visibility,Level:level,Label:labelValue,IsExtraTotal:!1,IsZeroSpan:!1,KeepWithGroup:member.KeepWithGroup,RepeatOnNewPage:member.RepeatOnNewPage,KeepTogether:member.KeepTogether,GroupName:member.Group&&member.Group.Name,NewSection:!!member.Group&&member.Group.NewSection},styles=cChildren&&flatten$1(cChildren.map((c=>c.Styles)))||[];return cHeader&&styles.push(...cHeader.Styles),{Query:cleanMember(query),Member:cMember,Styles:styles}}))}function documentMapTablix(tablixName,columnsHierarchy,rowsHierarchy,docMapBodyCell,context){return(parentData,parentCtx)=>parentActions=>{const data=parentData.Regions[0],ctx=Object.assign(Object.assign({},parentCtx),{ParentScopes:Object.assign(Object.assign({},parentCtx.ParentScopes),{[tablixName]:data.Scope.Id})}),actions=getScopeActions(parentActions,data.Scope.Id),headerDocMap=function(data,ctx,actions,columns,context){const colCells=columnMembersDocMap(columns,data,ctx,actions,context).CellsStripes;return flatten(colCells?flatten$3(colCells).map((item=>item&&item.DocumentMap)).filter((item=>item)):[])}(data.ColumnMembers,ctx,actions,columnsHierarchy,context),columnsMap=[];collectMembersDataMap(columnsHierarchy,data.ColumnMembers,columnsMap);const rowsMap=[];collectMembersDataMap(rowsHierarchy,data.RowMembers,rowsMap);const colsHidden=[];collectColsInfo(columnsHierarchy,data.ColumnMembers,colsHidden,{Interactivity:actions,IsHidden:!1,PageBreakAfter:!1,PageBreakBefore:!1});const rowsCtx=headerDocMap.length>0?setPrevDocPath(ctx,headerDocMap[headerDocMap.length-1].path):ctx,bodyRows=collectRowMembersDocMap(rowsHierarchy,data.RowMembers,rowsCtx,actions,((cellData,cellCtx,rowOrdinal,columnOrdinal)=>docMapBodyCell[rowsMap[rowOrdinal]][columnsMap[columnOrdinal]](cellData,cellCtx)(actions)),data.Body,colsHidden.map((c=>c.IsHidden)),context);if(!bodyRows)return[];return headerDocMap.concat(bodyRows)}}function collectRowMembersDocMap(membersList,data,ctx,actions,docMapCellOrdinal,dataBody,colsHidden,context){const makeMembersDocMap=membersList&&data&&membersList.map(((m,i)=>memberCtx=>rowMemberDocMap(m,data[i],memberCtx,actions,docMapCellOrdinal,dataBody,colsHidden,context)))||[];return flatten(Array.from(makeCollectionWithDocumentMap(ctx,makeMembersDocMap,(m=>m))))}function rowMemberDocMap(member,data,ctx,parentActions,docMapCell,bodyData,colsHidden,context){const headerActions=data.Header?getScopeActions(parentActions,data.Header.Id):parentActions,actions=member.Level?parentActions:headerActions;if(!data.IsCollection&&!member.Level&&member.IsHidden(data.Header)(actions))return[];const memberLabel=data.Header&&member.Label&&member.Label(data.Header)(actions),isLeaf=void 0!==data.Id,isCollection=data.IsCollection;let memberDocumentMaps=null;if(!isCollection){const resolvedModel=resolveItemCommon({Name:member.GroupName,Label:memberLabel},data.Header,ctx);ctx=setDocMapNode({Name:member.GroupName||"",ScopeId:data.Header.Id},context.DocumentMap,ctx,resolvedModel)}if(isLeaf){let cellCtx=Object.assign(Object.assign({},ctx),{DocumentMap:Object.assign(Object.assign({},ctx.DocumentMap),{node:null})});const cellsData=GetCollectionItem(bodyData,data.Id).Cells;let ordinal=0;memberDocumentMaps=flatten(makeCollectionWithDocumentMap(cellCtx,(cellsData||[]).map((cellData=>cCtx=>{const c=colsHidden[ordinal]?null:docMapCell(cellData,cCtx,data.Id,ordinal++);return c?c.DocumentMap:[]})),(m=>m)))}else data.Members&&(memberDocumentMaps=isCollection?function(member,data,ctx,actions,docMapBody,bodyData,colsHidden,context){if(!data)return null;const makeMembersDocMap=data.map((d=>mCtx=>rowMemberDocMap(member,d,mCtx,actions,docMapBody,bodyData,colsHidden,context)));return flatten(makeCollectionWithDocumentMap(ctx,makeMembersDocMap,(m=>m)))}(member,Array.from(data.Members),ctx,actions,docMapCell,bodyData,colsHidden,context):collectRowMembersDocMap(member.Children,Array.from(data.Members),ctx,actions,docMapCell,bodyData,colsHidden,context));memberDocumentMaps||(memberDocumentMaps=[]);const headerDocMap=!isCollection&&member.Header&&member.Header.DocumentMap(data.Header,ctx)(actions);headerDocMap&&memberDocumentMaps.push(...headerDocMap);const result=!isCollection&&ctx.DocumentMap.node?[ctx.DocumentMap.node]:[];return result.push(...memberDocumentMaps),result}function columnMembersDocMap(membersList,data,ctx,actions,context){let count=0;const makeMembersStripes=zipWith(membersList,data,((m,d)=>mCtx=>{const res=columnMemberDocMap(m,d,mCtx,actions,context);return count+=res.Count,res.CellsStripes}));return{CellsStripes:flatten(Array.from(makeCollectionWithDocumentMap(ctx,makeMembersStripes,getStripesDocumentMap)).filter(isNotNull)),Count:count}}function columnMemberDocMap(member,data,ctx,parentActions,context){const actions=data.Header?getScopeActions(parentActions,data.Header.Id):parentActions;if(!data.IsCollection&&!member.Level&&member.IsHidden(data.Header)(actions))return{CellsStripes:null,Count:0};if(data.IsCollection)return function(member,data,ctx,actions,context){let count=0;const makeMembersStripes=data.map((d=>memberCtx=>{const res=columnMemberDocMap(member,d,memberCtx,actions,context);return count+=res.Count,res.CellsStripes}));return{CellsStripes:flatten(Array.from(makeCollectionWithDocumentMap(ctx,makeMembersStripes,getStripesDocumentMap)).filter(isNotNull)),Count:count}}(member,Array.from(data.Members||[]),ctx,actions,context);const subMembers=member.Children||[],isLeaf=!subMembers.length,membersDocMapResult=subMembers.length?columnMembersDocMap(subMembers,Array.from(data.Members),ctx,actions,context):null,occupiedCellsCount=isLeaf?1:membersDocMapResult&&membersDocMapResult.Count||0;let cellsStripes=membersDocMapResult&&membersDocMapResult.CellsStripes;if(member.Header&&0!==occupiedCellsCount){const memberLabel=data.Header&&member.Label&&member.Label(data.Header)(actions);let headerCellsStripes=[Object.assign({},member.Header,{RowSpan:occupiedCellsCount,DocumentMap:buildDocumentMap(member.GroupName||"",{Label:memberLabel},context.DocumentMap,[member.Header.DocumentMap])(data.Header,ctx)(actions)})];const hole=Object.assign({},member.Header,{RowSpan:occupiedCellsCount,ColSpan:1,DocumentMap:[]});for(let i=1;i<member.Header.ColSpan;i++)headerCellsStripes=[hole,...headerCellsStripes];cellsStripes=cellsStripes&&cellsStripes.concat(headerCellsStripes)||headerCellsStripes}return{CellsStripes:cellsStripes,Count:occupiedCellsCount}}function getStripesDocumentMap(stripes){return stripes?flatten(stripes.map((cs=>cs.DocumentMap))):[]}function makeCollectionWithDocumentMap(ctx,items,getDocMap){const result=[];for(const makeItem of items){const item=makeItem(ctx);result.push(item);const itemDocMap=getDocMap(item);itemDocMap.length>0&&(ctx=setPrevDocPath(ctx,itemDocMap[itemDocMap.length-1].path))}return result}function MakeCanMergeVNodeCell(autoMergeItemNames){return(cell,otherCell,noPrevStripeCell)=>{const textBox=cell?findFirstItem(cell):null,otherTextBox=otherCell?findFirstItem(otherCell):null;if(null==textBox||null==otherTextBox)return!1;const otherName=otherTextBox.Name.toUpperCase(),automergeItems=Object.keys(autoMergeItemNames);return automergeItems.indexOf(otherName)>=0&&automergeItems.indexOf(textBox.Name.toUpperCase())>=0&&textBox.Value===otherTextBox.Value&&textBox.Name.toUpperCase()===otherTextBox.Name.toUpperCase()&&(!autoMergeItemNames[otherName]||noPrevStripeCell)}}function findFirstItem(vTree){if("VirtualNode"!==vTree.type)return null;const node=vTree;if(node.properties.itemContent)return node.properties.itemContent;for(const child of node.children){const childItem=findFirstItem(child);if(childItem)return childItem}return null}const defaultTablix=createReportItem({Type:"tablix"},"default");function collectMembersBodyIndex(members,index){members.forEach((c=>function(member,index){if(member.BodyIndex>=0)return void index.push(member.BodyIndex);member.Children&&collectMembersBodyIndex(member.Children,index)}(c,index)))}function fixHierarchyLevels(hierarchy){let hierarchyDepth=0,members=hierarchy.Members;for(;members.length;){const firstMember=members[0];firstMember.Header&&firstMember.Header.Item&&(hierarchyDepth+=firstMember.Header.LevelCount||1),members=firstMember.Children}return hierarchy.LevelSizes.length>hierarchyDepth?Object.assign(Object.assign({},hierarchy),{LevelSizes:hierarchy.LevelSizes.slice(0,hierarchyDepth)}):hierarchy}var tablix=dataRegion((function(tablixInitial,context){return __awaiter(this,void 0,void 0,(function*(){const tablix=function(tablix){return Object.assign(Object.assign({},tablix),{ColumnHierarchy:fixHierarchyLevels(tablix.ColumnHierarchy),RowHierarchy:fixHierarchyLevels(tablix.RowHierarchy)})}(tablixInitial),colsLevelSizes=tablix.ColumnHierarchy.LevelSizes.map(Length.parse),rowsLevelSizes=tablix.RowHierarchy.LevelSizes.map(Length.parse),bodyColsSizes=tablix.Body.Columns.map(Length.parse),cellCanShrink=tc=>{var _a;const rItem=null!==(_a=null==tc?void 0:tc.Item)&&void 0!==_a?_a:null;return!rItem||"textbox"===rItem.Type&&rItem.CanShrink},bodyRowsSizes=tablix.Body.Rows.map((r=>r.Cells.every(cellCanShrink)?0:Length.parse(r.Height))),cornerComp=tablix.Corner?yield function(corner,context){return __awaiter(this,void 0,void 0,(function*(){const cornerCellsStripes=[],cornerCellsMatrix=range(corner.RowHeights.length).map((()=>new Array(corner.ColumnWidths.length))),query={Fields:[],Regions:[]},staticStyles=[];for(let i=0;i<corner.RowHeights.length;i++){const rowCells=corner.Rows[i];for(let j=0;j<corner.ColumnWidths.length;j++){const cellContents=rowCells[j];if(!cellContents||!cellContents.Item)continue;const width=sumRange(corner.ColumnWidths,j,cellContents.ColSpan),height=sumRange(corner.RowHeights,i,cellContents.RowSpan),cellItem=makeCell(cellContents.Item,context.i18n,"corner"),cellComp=yield compile$2(cellItem,Object.assign(Object.assign({},context),{ContainerSize:null}));if(null===cellComp)throw new InvalidReportDefinitionError("Unsupported report item in corner cell");const dataMap=combineDataQuery(query,cellComp.Query);staticStyles.push(...cellComp.Styles),cornerCellsMatrix[i][j]=0===(cellContent=cellContents).RowSpan&&0===cellContent.ColSpan?null:(data,ctx)=>actions=>MakeCell(cellComp.Layout(dataMap(data),ctx)(actions)(width,height),cellContents.Item,cellContents.ColSpan,cellContents.RowSpan,width);for(let k=1;k<cellContents.RowSpan;k++)cornerCellsMatrix[i+k][j]=()=>()=>MakeCell(null,cellContents.Item,cellContents.ColSpan,1)}const stripe=LazyList.fromArray(cornerCellsMatrix[i].filter(Boolean));stripe&&cornerCellsStripes.push(stripe)}var cellContent;const stripes=LazyList.fromArray(cornerCellsStripes);return{Query:query,Cells:(data,ctx)=>actions=>stripes&&stripes.map((ss=>ss.map((s=>s(data,ctx)(actions))))),Styles:staticStyles}}))}({Rows:tablix.Corner,RowHeights:colsLevelSizes,ColumnWidths:rowsLevelSizes},context):null,colMembersComp=yield compileMembers(tablix.ColumnHierarchy.Members,bodyColsSizes,colsLevelSizes,context,"column"),rowMembersComp=yield compileMembers(tablix.RowHierarchy.Members,bodyRowsSizes,rowsLevelSizes,context,"row"),bodyComp=yield function(body,context){return __awaiter(this,void 0,void 0,(function*(){const widths=body.Columns.map(Length.parse),query=[],cellsMatrix=[],styles=[],documentMapNodes=[];for(const row of body.Rows){const qRowResult=[],rowCells=[],rowCellsDM=[];query.push({Cells:qRowResult}),cellsMatrix.push(rowCells),documentMapNodes.push(rowCellsDM);const height=Length.parse(row.Height);let colNum=0;for(const cell of row.Cells)if(cell&&cell.Item){const cellColNum=colNum,calcWidth=colSpan=>1===colSpan?widths[cellColNum]:sumRange(widths,cellColNum,colSpan),cellItem=makeCell(cell.Item,context.i18n,"body"),compItem=yield compile$2(cellItem,Object.assign(Object.assign({},context),{ContainerSize:null}));if(null===compItem)throw new InvalidReportDefinitionError(`Invalid report item in tablix cell: ${cellItem.Type}`);qRowResult.push(cleanContent(compItem.Query)),rowCells.push(((data,ctx)=>actions=>({ColSpan:cell.ColSpan,Layout:colSpan=>compItem.Layout(data,ctx)(actions)(calcWidth(colSpan),height)}))),rowCellsDM.push(((data,ctx)=>actions=>({ColSpan:cell.ColSpan,DocumentMap:compItem.DocumentMap(data,ctx)(actions)}))),styles.push(...compItem.Styles),colNum+=cell.ColSpan}else qRowResult.push({}),rowCells.push((data=>actions=>null)),rowCellsDM.push((()=>()=>null))}return{Query:query,Cells:cellsMatrix,Styles:styles,DocumentMap:documentMapNodes}}))}(tablix.Body,context);bodyComp.Query=function(bodyQuery,colMembers,rowMembers){const colsIndex=[];collectMembersBodyIndex(colMembers,colsIndex);const rowsIndex=[];return collectMembersBodyIndex(rowMembers,rowsIndex),rowsIndex.map((ri=>({Cells:colsIndex.map((ci=>bodyQuery[ri].Cells[ci]))})))}(bodyComp.Query,colMembersComp.Members,rowMembersComp.Members);const staticStyles=[];cornerComp&&staticStyles.push(...cornerComp.Styles),staticStyles.push(...colMembersComp.Styles),staticStyles.push(...rowMembersComp.Styles),staticStyles.push(...bodyComp.Styles);const tablixDef=Def.Makers.Tablix(tablix.Name,(tablix.Filters||[]).map((f=>({Expression:f.FilterExpression,Op:f.Operator,Values:f.FilterValues}))),colMembersComp&&colMembersComp.Query,rowMembersComp&&rowMembersComp.Query,cornerComp&&cornerComp.Query,bodyComp.Query,tablix.SortExpressions&&tablix.SortExpressions.length?tablix.SortExpressions.map((e=>({Expression:e.Value,Direction:e.Direction}))):null),columns=colMembersComp.Members,rows=rowMembersComp.Members,fields=tablixDef.Content.Fields,comp=value=>compileExpression(value,fields,context.EvaluationContext),bgImage=tablix.Style.BackgroundImage&&compileBackgroundImageData(tablix.Style.BackgroundImage,comp,context.getResourceUri),exprCompiler=createTypedCompiler(comp),compiled=Object.assign(Object.assign({Name:context.ReportID+tablix.Name,BackgroundColor:exprCompiler.compileColor(tablix.Style.BackgroundColor,defaultTablix.Style.BackgroundColor),BackgroundImage:bgImage,Label:exprCompiler.compileString(tablix.Label),Bookmark:exprCompiler.compileString(tablix.Bookmark,defaultTablix.Bookmark),Tooltip:exprCompiler.compileString(tablix.ToolTip,defaultTablix.ToolTip),ZIndex:tablix.ZIndex},compileBorders(tablix.Style,exprCompiler)),{FrozenRows:tablix.FrozenRows,FrozenColumns:tablix.FrozenColumns}),{render:render,styles:styles}=makeRender$b(compiled,context.getImageResolver());staticStyles.push(...styles);const lTablix={RightToLeft:"RTL"===tablix.LayoutDirection.toUpperCase(),CornerColSizes:rowsLevelSizes,CornerRowSizes:colsLevelSizes,RepeatRowHeaders:tablix.RepeatRowHeaders,RepeatColumnHeaders:tablix.RepeatColumnHeaders,GroupsBeforeRowHeaders:tablix.GroupsBeforeRowHeaders},autoMergeItemCells=flatten(tablix.Body.Rows.map((r=>r.Cells))).filter(isNotNull).filter((c=>"Never"!==c.AutoMergeMode&&null!=c.Item)),autoMergeItemNames={};for(const c of autoMergeItemCells)if(c.Item){autoMergeItemNames[c.Item.Name.toUpperCase()]="Restricted"===c.AutoMergeMode}const collapseRepeatingCells=MakeCollapseRepeatingCells(autoMergeItemNames,MakeCanMergeVNodeCell(autoMergeItemNames));let result={Query:{Fields:[],Regions:[tablixDef]},Layout:(data,parentCtx)=>actions=>(width,height)=>{const tData=data.Regions[0],ctx=Object.assign(Object.assign({},parentCtx),{ParentScopes:Object.assign(Object.assign({},parentCtx.ParentScopes),{[tablixDef.Name]:tData.Scope.Id})}),scopeActions=getScopeActions(actions,tData.Scope.Id),itemCommon=resolveItemCommon(compiled,tData.Scope,ctx),ll=layoutTablix(lTablix,tData,ctx,scopeActions,columns,rows,cornerComp&&cornerComp.Cells(tData.Scope,ctx)(scopeActions),bodyComp.Cells,itemCommon,render(tData.Scope,ctx),collapseRepeatingCells);return context.Layout.Arrange(ll,((res,arrangement)=>res&&res(arrangement)))},Styles:staticStyles,DocumentMap:buildDocumentMap(tablix.Name,compiled,context.DocumentMap,[documentMapTablix(tablix.Name,columns,rows,bodyComp.DocumentMap,context)])};return result=yield compileNoRowsMessage(result,tablix,context),tablix.NewSection&&(result=Object.assign(Object.assign({},result),{Layout:inStackSection(result.Layout,(data=>`${compiled.Name}#${data.Regions[0].Scope.Id}`))})),result}))}));const defaultVisibility=createVisibility(),makeCompileVisibility=getDataScope=>(visibility,comp)=>{const isHiddenComp=createTypedCompiler(comp).compileBoolean(visibility.Hidden,defaultVisibility.Hidden);if(!visibility.ToggleItem&&"function"!=typeof isHiddenComp){const isHiddenStatic=toBoolean(isHiddenComp);if(!0===isHiddenStatic)return function(){return()=>()=>null};if(!1===isHiddenStatic)return function(fun){return fun}}return function(fun){return(data,...args)=>{const isHiddenInitial=toBoolean(safeResolveCompiledData(isHiddenComp,getDataScope(data)));return actions=>((isHidden,actions)=>{visibility&&visibility.ToggleItem&&(isHidden=isHidden!==actions.ScopeToggles.filter((a=>"toggle"===a.Type&&1===a.ItemPath.length&&visibility.ToggleItem.toLowerCase()===a.ItemPath[0].toLowerCase())).length%2>0);return isHidden})(isHiddenInitial,actions)?null:fun(data,...args)(actions)}}},compileVisibility=makeCompileVisibility((data=>data)),compileTablixMemberVisibility=makeCompileVisibility((data=>data.Header));function withDefault(fun,defaultValue){return(data,...args)=>actions=>fun(data,...args)(actions)||defaultValue}function compileGroup$1(tGroups,details,context,consumeWhiteSpace,slicer,shifted,renderer,width){var _a,_b,_c,_d,_e,_f;return __awaiter(this,void 0,void 0,(function*(){const staticStyles=[],contentQuery={Fields:[],Regions:[]},childMapper=makeMapChild$2(contentQuery,staticStyles),compileExpr=v=>compileExpression(v,contentQuery.Fields),compileContainer=band=>__awaiter(this,void 0,void 0,(function*(){const{Type:Type,Name:name}=band,bandProps=__rest$1(band,["Type","Name"]),container=Object.assign(Object.assign(Object.assign({},createRectangle(null!=name?name:"")),bandProps),{Overflow:"Grow",ConsumeWhiteSpace:consumeWhiteSpace,Visibility:{Hidden:!1,ToggleItem:""}}),containerVisibility=compileVisibility(band.Visibility,compileExpr),compiledContainer=yield compile$2(container,context),childContainer=compiledContainer&&childMapper(compiledContainer);return childContainer&&{Layout:containerVisibility(childContainer.Layout),DocumentMap:withDefault(containerVisibility(childContainer.DocumentMap),[])}})),isRoot=!1===shifted,isDetails=0===tGroups.length;let group=null,subGroups=[];isDetails||([group,...subGroups]=tGroups,group&&function(group){var _a,_b,_c,_d,_e,_f;(null===(_a=null==group?void 0:group.Header)||void 0===_a?void 0:_a.RepeatOnNewPage)&&("End"===group.Header.PageBreak?group.Header.PageBreak="None":"StartAndEnd"===group.Header.PageBreak&&(group.Header.PageBreak="Start"));(null===(_b=null==group?void 0:group.Footer)||void 0===_b?void 0:_b.RepeatOnNewPage)&&("Start"===group.Footer.PageBreak?group.Footer.PageBreak="None":"StartAndEnd"===group.Footer.PageBreak&&(group.Footer.PageBreak="End"));(null==group?void 0:group.PreventOrphanedHeader)&&("End"===(null===(_c=group.Header)||void 0===_c?void 0:_c.PageBreak)||null===(_d=group.Header)||void 0===_d||_d.PageBreak);(null==group?void 0:group.PreventOrphanedFooter)&&("Start"===(null===(_e=group.Footer)||void 0===_e?void 0:_e.PageBreak)||null===(_f=group.Footer)||void 0===_f||_f.PageBreak)}(group));const exprComp=createTypedCompiler((function(value){return compileExpression(value,contentQuery.Fields)})),compiled={Name:null!==(_a=null==group?void 0:group.Group.Name)&&void 0!==_a?_a:"",Label:exprComp.compileString((null===(_b=null==group?void 0:group.Group)||void 0===_b?void 0:_b.DocumentMapLabel)||null)},detailsCompiled=isDetails&&details?yield compileContainer(Object.assign(Object.assign({},details),{PageBreak:"None"})):null,children=isDetails?null:yield function(tGroups,details,context,consumeWhiteSpace,slicer,shifted,renderer,width){return __awaiter(this,void 0,void 0,(function*(){const firstGroup=tGroups[0],withPageBreak=PageBreakIterable(firstGroup?firstGroup.Group.PageBreak:details?details.PageBreak:"None"),cGroup=yield compileGroup$1(tGroups,details,context,consumeWhiteSpace,slicer,shifted,renderer,width);return cGroup&&Object.assign(Object.assign({},cGroup),{Layout:(data,ctx)=>actions=>{var _a;if(!(null===(_a=data.Members)||void 0===_a?void 0:_a.length))return null;data.IsCollection;const scopeActions=getScopeActions(actions,data.Header.Id),resIterable=iterable$1.map((m=>cGroup.Layout(m,ctx)(scopeActions)))(data.Members),resNotNullable=iterable$1.filter(isNotNull)(resIterable);return withPageBreak(resNotNullable)},DocumentMap:(data,ctx)=>actions=>{var _a;if(!(null===(_a=data.Members)||void 0===_a?void 0:_a.length))return[];const childData=GetCollectionItem$1(data.Members,0),scopeActions=getScopeActions(actions,childData.Header.Id);return buildNestedGroupDocMap(context.DocumentMap)((d=>({Scope:d.Header,Groups:Array.from(d.Members||[])})),(d=>d.Header))("",{},cGroup.DocumentMap)(childData,ctx)(scopeActions)}})}))}(subGroups,details,context,consumeWhiteSpace,slicer,!0,renderer,width),headerBand=(null==group?void 0:group.Header)&&(yield compileContainer(group.Header)),footerBand=(null==group?void 0:group.Footer)&&(yield compileContainer(group.Footer)),lGroup=group&&function(preventOrphanedHeader,preventOrphanedFooter,repeatHeader,repeatFooter,printFooterAtBottom,galleyMode,renderer){return(header,body,footer)=>null==header&&null==footer?body:repeatHeader&&repeatFooter?RepeatHeaderVertically(header,RepeatFooterVertically(body,footer,printFooterAtBottom&&!galleyMode,renderer),renderer):(null==header||null==footer||repeatFooter||preventOrphanedFooter||(body=L2.VerticalStack(body?LazyList.cons(body,LazyList.cons(footer)):LazyList.cons(footer),renderer.Stack,renderer.Empty),footer=null),null!=header&&(body=repeatHeader?RepeatHeaderVertically(header,body,renderer):preventOrphanedHeader?PreventOrphans(header,body,PreventOrphanStepback,renderer):L2.VerticalStack(LazyList.cons(header,LazyList.cons(body)),renderer.Stack,renderer.Empty)),null!=footer&&(body=repeatFooter?RepeatFooterVertically(body,footer,printFooterAtBottom&&!galleyMode,renderer):preventOrphanedFooter?PreventOrphans(body,footer,PreventOrphanStepback,renderer):L2.VerticalStack(LazyList.cons(body,LazyList.cons(footer)),renderer.Stack,renderer.Empty)),body)}(group.PreventOrphanedHeader,group.PreventOrphanedFooter,(null===(_c=group.Header)||void 0===_c?void 0:_c.RepeatOnNewPage)||!1,(null===(_d=group.Footer)||void 0===_d?void 0:_d.RepeatOnNewPage)||!1,(null===(_e=group.Footer)||void 0===_e?void 0:_e.PrintAtBottom)||!1,!1,renderer),memberDef=Def.Makers.TablixMember(isRoot?null:Def.Makers.Group((null==group?void 0:group.Group.Name)||"",(null==group?void 0:group.Group.GroupExpressions)||[],((null==group?void 0:group.Group.Filters)||[]).map((f=>({Expression:f.FilterExpression,Op:f.Operator,Values:f.FilterValues}))),(null==group?void 0:group.Group.ParentGroup)||void 0),((null==group?void 0:group.SortExpressions)||[]).map((s=>({Direction:s.Direction,Expression:s.Value}))),contentQuery,children?[children.Query]:[]),compiledGroup={Query:memberDef,Styles:children?[...staticStyles,...children.Styles]:staticStyles,Layout:(data,parentCtx)=>actions=>{var _a,_b,_c,_d,_f;const ctx=memberDef.Group?Object.assign(Object.assign({},parentCtx),{ParentScopes:Object.assign(Object.assign({},parentCtx.ParentScopes),{[memberDef.Group.Name]:data.Header.Id})}):parentCtx,scopeActions=isRoot?actions:getScopeActions(actions,data.Header.Id),header=(null===(_a=null==headerBand?void 0:headerBand.Layout(data.Header,ctx)(scopeActions))||void 0===_a?void 0:_a(width,Length.parse(group.Header.Height)))||null;let footer=(null===(_b=null==footerBand?void 0:footerBand.Layout(data.Header,ctx)(scopeActions))||void 0===_b?void 0:_b(width,Length.parse(group.Footer.Height)))||null;null!=group&&null!=footer&&null!=group.Footer&&group.Footer.PrintAtBottom&&!group.Footer.RepeatOnNewPage&&(footer=PlaceAtBottom(footer,shifted?slicer:slicer={Shift:0,Slice:slicer.Slice},width,Length.parse(group.Footer.Height),renderer));const lDetails=(null===(_c=null==detailsCompiled?void 0:detailsCompiled.Layout(data.Header,ctx)(scopeActions))||void 0===_c?void 0:_c(width,Length.parse(details.Height)))||null,lChildren=isDetails?lDetails?[lDetails]:null:null==children?void 0:children.Layout(Array.from(data.Members)[0],ctx)(scopeActions);lChildren&&(data.IsCollection||null===(_d=data.Members)||void 0===_d||_d.length);const body=null!==(_f=lChildren&&LazyList.fromIterable(lChildren))&&void 0!==_f?_f:null;let layout=L2.VerticalStack(body,renderer.GroupStack,renderer.Empty);if(lGroup&&(layout=lGroup(header,layout,footer)),!layout)return layout;(null==group?void 0:group.KeepTogether)&&(layout=context.Layout.KeepTogether(layout));const anchorNodes=buildAnchorNodes(resolveItemCommon(compiled,data.Header,ctx));return anchorNodes.length&&(layout=L2.ConvertFirstBody(layout,(content=>{if(!content)return content;const cnt=content;return cnt.children=[...anchorNodes,...cnt.children],content}))),layout},DocumentMap:(data,ctx)=>actions=>{const scopeActions=isRoot?actions:getScopeActions(actions,data.Header.Id),childNodes=[headerBand?(dd,cctx)=>headerBand.DocumentMap(dd.Header,cctx):null,isDetails?(dd,cctx)=>{var _a;return(null===(_a=null==detailsCompiled?void 0:detailsCompiled.DocumentMap)||void 0===_a?void 0:_a.call(detailsCompiled,dd.Header,cctx))||(()=>[])}:(null==children?void 0:children.DocumentMap)||null,footerBand?(dd,cctx)=>footerBand.DocumentMap(dd.Header,cctx):null].filter(isNotNull);return buildNestedDocMap(context.DocumentMap)((d=>d.Header))((null==group?void 0:group.Group.Name)||"",compiled,childNodes)(data,ctx)(scopeActions)}},compileScopeExpression=expr=>{const val=compileExpression(expr,contentQuery.Fields);return"function"!=typeof val?val:data=>resolveCompiled$1(val,data)};if(null===(_f=isDetails?details:group)||void 0===_f?void 0:_f.Visibility){const visibilityMap=compileTablixMemberVisibility((isDetails?details:group).Visibility,compileScopeExpression);return Object.assign(Object.assign({},compiledGroup),{Layout:visibilityMap(group&&group.Group.NewSection?inHierarchyStackSection(compiledGroup.Layout,(d=>`${group.Group.Name}#${d.Header.Id}`)):compiledGroup.Layout),DocumentMap:withDefault(visibilityMap(compiledGroup.DocumentMap),[])})}return compiledGroup}))}function RepeatHeaderVertically(first,second,renderer){return function(first,second,combine,renderer){return L.Repeat(first,second,((height,r1,r2)=>L.Chop(LazyList.fromArray([r1,r2].map((r=>null!=r?r.Body:L.Empty(renderer.Empty(0,0))))),(slices=>slices.map((slice=>slice.IsSplit()?slice.Tail:_=>LResult.Complete(0,renderer.Empty(0,height))))),((width,list2)=>combine(width,height,list2.map((lr=>lr.Body)))))))}(first,second,((w,h,items)=>renderer.Stack("Vertical",w,h,items.toArray())),renderer)}function RepeatFooterVertically(first,second,takeAllSpace,renderer){return function(first,second,takeAllSpace,combine,renderer){return L.RepeatFooter(first,second,((height,r1,r2)=>L.Chop(LazyList.fromArray([r1,r2].map((r=>null!=r?r.Body:L.Empty(renderer.Empty(0,0))))),(slices=>slices.map((slice=>slice.IsSplit()?slice.Tail:_=>LResult.Complete(0,renderer.Empty(0,height))))),((width,list2)=>{const fragments=list2.map((lr=>lr.Body)).toArray(),heightSum=sum(fragments.map((lr=>{return vnode=lr,Length.parse(vnode.properties.style.height);var vnode})));return height>heightSum&&fragments.splice(1,0,renderer.Empty(width,height-heightSum)),combine(width,height,fragments.filter(isNotNull))}))),takeAllSpace)}(first,second,takeAllSpace,((w,h,items)=>renderer.Stack("Vertical",w,h,items)),renderer)}const PreventOrphanStepback=5;function PreventOrphans(first,second,preventOrphanStepback,renderer){return function(first,second,preventOrphanStepback,combine,renderer){return L.PreventOrphans(first,second,preventOrphanStepback,((height,r1,r2)=>L.Chop(LazyList.fromArray([r1,r2].map((r=>null!=r?r.Body:L.Empty(renderer.Empty(0,0))))),(slices=>slices.map((slice=>slice.IsSplit()?slice.Tail:_=>LResult.Complete(0,renderer.Empty(0,height))))),((width,list2)=>combine(width,height,list2.map((lr=>lr.Body)))))))}(first,second,preventOrphanStepback,((w,h,items)=>renderer.Stack("Vertical",w,h,items.toArray())),renderer)}function PlaceAtBottom(layout,slice,width,height,renderer){const totalSlice=slice.Shift;return L.PlaceAtEnd(layout,slice.Slice,((shift,l)=>L.ConvertBody(l,(f=>renderer.Stack("Vertical",width,shift+height,[renderer.Empty(width,shift-totalSlice),f].filter(isNotNull))))),(l=>l))}const makeMapChild$2=(queryRef,styles)=>{const makeMapData=makeDataMapper(queryRef);return child=>{const mapData=makeMapData(child.Query);return styles.push(...child.Styles),{Layout:mapData(child.Layout),DocumentMap:mapData(child.DocumentMap)}}};const defaultBandedList=createReportItem({Type:"bandedlist"},"default"),renderStack=(direction,width,height,content)=>{if("Vertical"!==direction)throw new VDomRendererError(`'${direction}' stack is not implemented`);(content||[]).forEach((item=>{item.properties.className+=" arjs-listItem"}));const patcher=content&&joinPatchers(content.map((c=>c.properties.patcher)));return h("div",{style:{width:Length.toCss(width),height:Length.toCss(height)},patcher:patcher},content||[])},renderGroupStack=(direction,width,height,content)=>{if("Vertical"!==direction)throw new VDomRendererError(`'${direction}' stack is not implemented`);(content||[]).forEach((item=>{item.properties.className+=" arjs-listItem",item.properties.GroupType="group"}));const patcher=content&&joinPatchers(content.map((c=>c.properties.patcher)));return h("div",{style:{width:Length.toCss(width),height:Length.toCss(height)},patcher:patcher,GroupType:"bandedlistgroup"},content||[])};var bandedlist=dataRegion((function(item,context){return __awaiter(this,void 0,void 0,(function*(){const contentQuery={Fields:[],Regions:[]},compiled=function(definition,context,comp){const exprCompiler=createTypedCompiler(comp);return{Type:"bandedlist",Name:context.ReportID+definition.Name,Label:exprCompiler.compileString(definition.Label),Bookmark:exprCompiler.compileString(definition.Bookmark,defaultBandedList.Bookmark),Tooltip:exprCompiler.compileString(definition.ToolTip,defaultBandedList.ToolTip)}}(item,context,(expr=>compileExpression(expr,contentQuery.Fields))),renderer={Empty:renderEmpty,Stack:renderStack,GroupStack:renderGroupStack},width=Length.parse(item.Width),rootGroupAdapter={Type:"bandedlistgroup",Header:item.Header,Footer:item.Footer,Group:createGroup(""),SortExpressions:[],Visibility:{Hidden:!1,ToggleItem:""},KeepTogether:item.KeepTogether,PreventOrphanedHeader:item.PreventOrphanedHeader,PreventOrphanedFooter:item.PreventOrphanedFooter};let slicer={Shift:0,Slice:!1};if(null!=item.Footer&&item.Groups.length>0&&null!=item.Groups[0].Footer){const footer=item.Footer,groupfooter=item.Groups[0].Footer;footer.PrintAtBottom&&groupfooter.PrintAtBottom&&(slicer={Shift:Length.parse(footer.Height),Slice:!0})}const members=yield compileGroup$1([rootGroupAdapter,...item.Groups],item.Details,context,item.ConsumeWhiteSpace,slicer,!1,renderer,width),tablixDef=Def.Makers.Tablix(item.Name,item.Filters.map((f=>({Expression:f.FilterExpression,Op:f.Operator,Values:f.FilterValues}))),null,members?[members.Query]:[],contentQuery,null);let result={Query:{Fields:[],Regions:[tablixDef]},Layout:(data,parentCtx)=>actions=>(width,height)=>{var _a;if(!(null===(_a=item.Groups)||void 0===_a?void 0:_a.length)&&!item.Details)return CanvasResizable([],!1,!1,width,height,!1,!1,!1,renderer.Empty,renderer.Empty,VDomFragmentFactory.clip);const tablixData=data.Regions[0],ctx=Object.assign(Object.assign({},parentCtx),{ParentScopes:Object.assign(Object.assign({},parentCtx.ParentScopes),{[tablixDef.Name]:tablixData.Scope.Id})}),scopeActions=getScopeActions(actions,tablixData.Scope.Id);let layout=null==members?void 0:members.Layout(tablixData.RowMembers[0],ctx)(scopeActions);if(!layout)return Empty2(null);const resolvedModel=resolveItemCommon(compiled,tablixData.Scope,ctx),tooltip=resolvedModel.Tooltip;tooltip&&(layout=L2.ConvertBody(layout,(content=>content?(content.properties.attributes=Object.assign(Object.assign({},content.properties.attributes),{title:tooltip}),content):content)));const anchorNodes=buildAnchorNodes(resolvedModel);return anchorNodes.length&&(layout=L2.ConvertFirstBody(layout,(content=>{if(!content)return content;const cnt=content;return cnt.children=[...anchorNodes,...cnt.children],content}))),layout},Styles:(null==members?void 0:members.Styles)||[],DocumentMap:(data,parentCtx)=>actions=>{const tablixData=data.Regions[0],scopeActions=getScopeActions(actions,tablixData.Scope.Id),ctx=Object.assign(Object.assign({},parentCtx),{ParentScopes:Object.assign(Object.assign({},parentCtx.ParentScopes),{[tablixDef.Name]:tablixData.Scope.Id})});return buildNestedGroupDocMap(context.DocumentMap)((tData=>({Scope:tData.Scope,Groups:tData.RowMembers})),(dd=>dd.Header))(item.Name,compiled,members.DocumentMap)(tablixData,ctx)(scopeActions)}};return item.NewSection&&(result=Object.assign(Object.assign({},result),{Layout:inStackSection(result.Layout,(data=>`${compiled.Name}#${data.Regions[0].Scope.Id}`))})),result}))}));function makeRender$a(model){const sb=styleBuilder();sb.add("borderRadius",[model.ShapeStyle],(shapeStyle=>"Ellipse"===shapeStyle?"50% / 50%":null));const style=sb.style,className=`${model.Name}Style`;return{render:(data,ctx,itemViewSize)=>function(className,style,itemViewSize,renderContext,model){const styleAndSize=Object.assign(Object.assign({},style.style),buildSizeStyle(itemViewSize)),{patcher:patcher,id:id}=createStylePatcher(renderContext,style);return wrapSplittedItem(itemViewSize,h("div",{className:`arjs-itemContent arjs-container ${className}`,style:styleAndSize,patcher:patcher,id:id,title:model.Tooltip},buildAnchorNodes(model)))}(className,style.dynamic(data),itemViewSize,ctx,resolveItemCommon(model,data,ctx)),styles:[{className:className,style:style.static}]}}const defaultShape=createReportItem({Type:"shape"},"default");function makeLayout$b(model,width,height,data,render,ctx){return function(shape,width,height,renderShape){return L2.StaticClipped(width,height,renderShape)}(0,width,height,(itemViewSize=>render(data,ctx,itemViewSize)))}function makeRender$9(model,embeddedImageResolver,getResourceUri){const sb=styleBuilder(),getBackgroundPosition=alignment=>"Middle"===alignment?"center":alignment.toLowerCase();sb.add("backgroundImage",[model.Value]),sb.add("backgroundSize",[model.Sizing],(sizing=>{switch(sizing){case"Fit":return"100% 100%";case"FitProportional":return"contain";case"Clip":case"AutoSize":default:return"auto"}})),sb.add("backgroundPositionX",[model.HorizontalAlignment],getBackgroundPosition),sb.add("backgroundPositionY",[model.VerticalAlignment],getBackgroundPosition),sb.add("paddingLeft",[model.Style.PaddingLeft]),sb.add("paddingRight",[model.Style.PaddingRight]),sb.add("paddingTop",[model.Style.PaddingTop]),sb.add("paddingBottom",[model.Style.PaddingBottom]);const style=sb.style,className=`${model.Name}Style`;return{render:imageData=>{const sbRuntime=styleBuilder();return imageData&&sbRuntime.add("backgroundImage",[imageData.Value]),(data,ctx,itemViewSize)=>{const styleDynamic=style.dynamic(data),sbRuntimeStyleDynamic=sbRuntime.style.dynamic(data),dynamicStyle={style:Object.assign(Object.assign(Object.assign({},styleDynamic.style),sbRuntime.style.static),sbRuntimeStyleDynamic.style),renderTimeStyle:styleDynamic.renderTimeStyle||sbRuntimeStyleDynamic.renderTimeStyle?globals=>Object.assign(Object.assign({},styleDynamic.renderTimeStyle&&ctx.EvalDynamicRuntime(styleDynamic.renderTimeStyle,globals)),sbRuntimeStyleDynamic.renderTimeStyle&&ctx.EvalDynamicRuntime(sbRuntimeStyleDynamic.renderTimeStyle,globals)):null},val=imageData?imageData.Value:model.Value,src=imageData?imageData.Source:model.Source,itemCommon=resolveItemCommon(model,data,ctx);return function(className,embeddedImageClassName,style,itemViewSize,ctx,model,sizeMode){const{patcher:stylePatcher,id:styleId}=createStylePatcher(ctx,style),{patcher:bgPatcher,id:bgId}=createClassNamePatcher(ctx,embeddedImageClassName,styleId),contentNode=h("div",{id:null!=bgId?bgId:styleId,className:`arjs-itemContent arjs-imageItem ${className} ${embeddedImageClassName}`,style:Object.assign(Object.assign({},style.style),buildSizeStyle(itemViewSize)),patcher:joinPatchers(stylePatcher,bgPatcher),attributes:"Clip"!==sizeMode?{"data-sizemode":sizeMode}:{},title:model.Tooltip},buildAnchorNodes(model));return addActionAttribute(contentNode,model.Action),wrapSplittedItem(itemViewSize,contentNode)}(className,(value=resolveCompiled$1(val,data),embeddedImageResolver(src||"External",value)),dynamicStyle,itemViewSize,ctx,itemCommon,model.Sizing);var value}},styles:[{className:className,style:Object.assign({},style.static,{position:"absolute",width:"100%",height:"100%",backgroundRepeat:"no-repeat",backgroundOrigin:"content-box"})}]}}const defaultImage=createReportItem({Type:"image"},"default");function makeLayout$a(model,width,height,data,render,ctx){return function(image,width,height,renderImage){return L2.StaticClipped(width,height,renderImage)}(0,width,height,(itemViewSize=>render(data,ctx,itemViewSize)))}function makeRender$8(model){const sb=styleBuilder(),reverse=Length.parse(model.StartPoint.X)>Length.parse(model.EndPoint.X),startX=reverse?Length.parse(model.EndPoint.X):Length.parse(model.StartPoint.X),startY=reverse?Length.parse(model.EndPoint.Y):Length.parse(model.StartPoint.Y),endX=reverse?Length.parse(model.StartPoint.X):Length.parse(model.EndPoint.X),endY=reverse?Length.parse(model.StartPoint.Y):Length.parse(model.EndPoint.Y),lineLength=Length.toCss(Math.sqrt(Math.pow(endX-startX,2)+Math.pow(endY-startY,2))),angle=180*Math.atan2(endY-startY,endX-startX)/Math.PI,isVertical=Math.abs(angle)%180==90,prefix=isVertical?"Right":startY<endY?"Top":"Bottom",transformOrigin="Top"===prefix?"0 0":"0 100%";sb.add("position",["absolute"]),sb.add(`border${prefix}Style`,[model.LineStyle],getBorderStyle),sb.add(`border${prefix}Color`,[model.LineColor]),sb.add(`border${prefix}Width`,[model.LineWidth]),sb.add("width",[isVertical?"0pt":lineLength]),sb.add("height",[isVertical?lineLength:Length.toCss(Math.abs(endY-startY))]),sb.add("transformOrigin",[transformOrigin]),sb.add("transform",[`rotate(${isVertical?0:angle}deg)`]),sb.add("zIndex",[model.ZIndex]),isVertical&&sb.add("left",[`calc(-${model.LineWidth} / 2)`]);const lineStyle=sb.style,lineClassName=`${model.Name}Style`;return{render:(data,ctx,itemViewSize)=>function(lineClassName,lineStyle,itemViewSize,renderContext,model){const{patcher:patcher,id:id}=createStylePatcher(renderContext,lineStyle);return wrapSplittedItem(itemViewSize,h("div",{className:"arjs-itemContent arjs-lineItem",style:Object.assign({},buildSizeStyle(itemViewSize)),patcher:patcher},[...buildAnchorNodes(model),h("div",{className:lineClassName,style:lineStyle.style,id:id},[])]))}(lineClassName,lineStyle.dynamic(data),itemViewSize,ctx,resolveItemCommon(model,data,ctx)),styles:[{className:lineClassName,style:lineStyle.static}]}}const defaultLine=createReportItem({Type:"line"},"default");function makeLayout$9(model,width,height,data,render,ctx){return function(line,width,height,renderLine){return L2.StaticClipped(width,height,renderLine)}(0,width,height,(itemViewSize=>render(data,ctx,itemViewSize)))}const romUpgrade_V3={fixFplPageSize:(fixedPage,page)=>{var _a,_b,_c,_d,_e,_f;return Object.assign(Object.assign({},fixedPage),{Width:null!==(_a=fixedPage.Width)&&void 0!==_a?_a:page.PageWidth,Height:null!==(_b=fixedPage.Height)&&void 0!==_b?_b:page.PageHeight,TopMargin:null!==(_c=fixedPage.TopMargin)&&void 0!==_c?_c:page.TopMargin,BottomMargin:null!==(_d=fixedPage.BottomMargin)&&void 0!==_d?_d:page.BottomMargin,LeftMargin:null!==(_e=fixedPage.LeftMargin)&&void 0!==_e?_e:page.LeftMargin,RightMargin:null!==(_f=fixedPage.RightMargin)&&void 0!==_f?_f:page.RightMargin})}},romUpgrade_V4={getReportSections:romReport=>{if(romReport.ReportSections&&romReport.ReportSections.length>0)return romReport.ReportSections.map((rs=>"Continuous"===rs.Type?rs.Body?rs:Object.assign(Object.assign({},rs),{Body:createCplReport().Body}):rs.FixedPage?rs:Object.assign(Object.assign({},rs),{FixedPage:createFplReport().FixedPage})));if(romReport.FixedPage){const{FixedPage:FixedPage,Page:Page,DataElementName:DataElementName,Width:Width}=romReport;return[{Name:"ReportSection",DisplayName:"ReportSection",FixedPage:FixedPage,Page:Page,DataElementName:DataElementName,Width:Width,DataElementOutput:"Auto",Type:"FixedPage"}]}{const{PageHeader:PageHeader,PageFooter:PageFooter,Body:Body,Page:Page,DataElementName:DataElementName,Width:Width}=romReport;return[{Name:"ReportSection",DisplayName:"ReportSection",PageHeader:PageHeader,Body:null!=Body?Body:createCplReport().Body,PageFooter:PageFooter,Page:Page,DataElementName:DataElementName,Width:Width,DataElementOutput:"Auto",Type:"Continuous"}]}}},defaultSubreport$1=createReportItem({Type:"subreport"},"default");function isEmptyValue(value){return"boolean"!=typeof value&&"number"!=typeof value&&!value}function LayoutFPLGroups(groupItems,makeEmpty){var _a,_b;return L2.VerticalStack(null!==(_b=null===(_a=function(list){return list&&LazyList.cons(list.Head,list.Tail&&list.Tail.select((it=>L.PageBreakBefore(it))))}(LazyList.fromIterable(groupItems)))||void 0===_a?void 0:_a.filter(isNotNull))&&void 0!==_b?_b:null,((d,w,h,items)=>items&&items.length?items[0]:makeEmpty(w,h)),makeEmpty)}function LayoutPages(pages){return PageLayout(LazyList.fromArray(pages))}function PageLayout(pages){if(null===pages)return null;const page=pages.Head,fplResult=FixedCanvas(page.Size.Height,page.Items.map((it=>NewItem(it.Body,it.Filler,it.Places,it.PlaceHolder,it.IsRepeatable,it.setLastPlace))),((height2,items)=>FixedCanvas(page.Size.Width,items.map((it=>NewItem(it.Body,it.Filler,it.Places.map((p=>{return position=p.Position2,size=p.Size2,position2=p.Position,size2=p.Size,{Name:p.Name,Position:position,Position2:position2,Size:size,Size2:size2};var position,size,position2,size2})),it.PlaceHolder,it.IsRepeatable,it.setLastPlace))),((width2,items2)=>page.MakeResult(width2,height2,items2.map((it=>({Name:it.Places[0].Name,Content:it.Body,Position:{X:it.Places[0].Position,Y:it.Places[0].Position2}}))))),null,null)),(items=>{const tail=items;return PageLayout(tail.filter((t=>!t.IsRepeatable)).map((dr=>dr.PlaceHolder)).map((ph=>ph&&function(pages,phName){let tail=pages;for(;tail;){if(tail.Head.PlaceHolders.find((ph=>ph.Name===phName)))return!0;tail=tail.Tail}return!1}(pages.Tail,ph)?ph:null)).filter((ph=>!ph)).length>0?LazyList.cons(function(proto,tail){const map=new Map(tail.map((t=>[t.Places[0].Name,t.Body])));return Object.assign(Object.assign({},proto),{Items:proto.Items.filter((it=>map.has(it.Places[0].Name))).map((item=>Object.assign(Object.assign({},item),{Body:map.get(item.Places[0].Name)})))})}(Object.assign(Object.assign({},page),{AddAnchors:null}),tail),pages.Tail):createNextPage(pages.Tail,tail.concat(page.OverflowTail||[])))}),(()=>PageLayout(createNextPage(pages.Tail,page.OverflowTail||[]))));return page.AddAnchors?L2.ConvertFirstBody(fplResult,page.AddAnchors):fplResult}function FixedCanvas(canvasSize,items,makeResult,makeTail,makeContinuation){return space=>{var _a,_b;if(space<=0)return LResult.Fail();const head=[],tail=[];let hasSplit=!1;for(const item of items.filter((it=>!L.IsZero(it.Body)))){let placeLayout=item.Body,slice=LResult.Fail();for(let i=0;i<item.Places.length;i++){item.setLastPlace(i===item.Places.length-1);const place=item.Places[i],itemSpace=space-place.Position;if(slice=placeLayout(place.Size),itemSpace<slice.Size)return LResult.Fail();if(!slice.IsFailed()){if(slice.Size,place.Size,slice.IsPageBreak()||head.push(NewItem(slice.Body,null,[place],item.PlaceHolder,item.IsRepeatable,item.setLastPlace)),slice.IsCompleted())break;placeLayout=slice.Tail}}const itemTail=null!==(_b=null!==(_a=slice.Tail)&&void 0!==_a?_a:item.Filler)&&void 0!==_b?_b:item.IsRepeatable?item.Body:null;null!=itemTail&&tail.push(ReplaceBody(item,itemTail,item.Filler)),!slice||slice.IsCompleted()||item.IsRepeatable||(hasSplit=!0)}const size=Math.min(space,canvasSize),result=makeResult(size,head);if(!hasSplit){if(null==makeContinuation)return LResult.Complete(size,result);const nextPage=makeContinuation();return null!==nextPage?LResult.Split(size,result,nextPage):LResult.Complete(size,result)}const remainder=(makeTail?makeTail(tail):null)||FixedCanvas(canvasSize,tail,makeResult,null,makeContinuation);return LResult.Split(size,result,remainder)}}function createNextPage(pages,tail){if(null===pages)return null;const proto=pages.Head,placeholders=new Map(proto.PlaceHolders.map((ph=>[ph.Name,ph]))),allRegionsTail=tail.filter((t=>t.PlaceHolder)),orphanedTail=allRegionsTail.filter((t=>!placeholders.has(t.PlaceHolder))),phTail=allRegionsTail.filter((t=>placeholders.has(t.PlaceHolder))).map((t=>{const placeholder=placeholders.get(t.PlaceHolder);return{Body:t.Body,Filler:t.Filler,Places:placeholder.Places,PlaceHolder:placeholder.PlaceHolder,IsRepeatable:!1,setLastPlace:t.setLastPlace}}));return(page=proto).PlaceHolders&&page.PlaceHolders.length>0&&!page.Items.some((x=>!x.IsRepeatable))&&0===phTail.length&&(proto.ThrowIfPlaceHoldersEmpty||0===proto.Items.length)?createNextPage(pages.Tail,tail):LazyList.cons({Items:proto.Items.concat(phTail),MakeResult:proto.MakeResult,PlaceHolders:[],ThrowIfPlaceHoldersEmpty:proto.ThrowIfPlaceHoldersEmpty,OverflowTail:orphanedTail,AddAnchors:null,Size:proto.Size},pages.Tail);var page}function NewItem(body,filler,places,placeholder,isRepeatable,setLastPlace){return{Body:body,Filler:filler,Places:places,PlaceHolder:placeholder,IsRepeatable:isRepeatable,setLastPlace:setLastPlace}}function ReplaceBody(item,body,filler){return NewItem(body,filler,item.Places,item.PlaceHolder,item.IsRepeatable,item.setLastPlace)}const sumLength=lengths=>Length.toCss(sum(lengths.map(Length.parse)));function renderPage$1(pageInfo,reportSectionDisplayName,content,pageIndex=0,sliceIndex=0){if("arjs-reportPage"===content.properties.className)return content.properties.meta=Object.assign(Object.assign({},content.properties.meta),{pageIndex:pageIndex,sliceIndex:sliceIndex}),content;const style={width:pageInfo&&pageInfo.PageWidth,height:pageInfo&&pageInfo.PageHeight,paddingLeft:pageInfo&&pageInfo.LeftMargin,paddingTop:pageInfo&&pageInfo.TopMargin,paddingRight:pageInfo&&pageInfo.RightMargin,paddingBottom:pageInfo&&pageInfo.BottomMargin,position:"relative"};null===style.width&&(style.width=sumLength([content.properties.style.width,pageInfo&&pageInfo.LeftMargin,pageInfo&&pageInfo.RightMargin].filter(Boolean))),null===style.height&&(style.height=sumLength([content.properties.style.height,pageInfo&&pageInfo.TopMargin,pageInfo&&pageInfo.BottomMargin].filter(Boolean)));const attributes=reportSectionDisplayName?{"data-reportsectiondisplayname":reportSectionDisplayName}:void 0;return h("div",{className:"arjs-reportPage",style:style,patcher:content.properties.patcher,meta:{pageIndex:pageIndex,sliceIndex:sliceIndex},attributes:attributes},[content])}const fixedSizeItemTypes=["list","tablix","table","tableofcontents","bandedlist"];function isFixedSizeItem(item){return fixedSizeItemTypes.indexOf(item.Type)>=0}function wrapWithFplSite(def){return"fixedpagesection"===def.Type?{Name:`${def.Name}Site`,Type:"rectangleitemsite",BackgroundColor:def.Style.BackgroundColor,BackgroundImage:def.Style.BackgroundImage&&{BackgroundRepeat:def.Style.BackgroundImage.BackgroundRepeat,Value:def.Style.BackgroundImage.Value,MIMEType:def.Style.BackgroundImage.MIMEType,Source:def.Style.BackgroundImage.Source},Borders:{Border:def.Style.Border,LeftBorder:def.Style.LeftBorder,TopBorder:def.Style.TopBorder,RightBorder:def.Style.RightBorder,BottomBorder:def.Style.BottomBorder},RoundingRadius:null,ShapeStyle:null,ZIndex:0,Content:def,Visibility:createVisibility()}:wrapWithSite(def)}function getBounds(reportItem){return{Position:Length.parse(reportItem.Top),Size:isFixedSizeItem(reportItem)&&reportItem.FixedHeight?getFixedSize(reportItem.FixedHeight,reportItem.Height):Length.parse(reportItem.Height),Position2:Length.parse(reportItem.Left),Size2:isFixedSizeItem(reportItem)&&"tableofcontents"!==reportItem.Type&&reportItem.FixedWidth?getFixedSize(reportItem.FixedWidth,reportItem.Width):Length.parse(reportItem.Width)}}function getFixedSize(fixedSize,size){return Math.max(Length.parse(fixedSize),Length.parse(size))}function makePageTree(container,context){return __awaiter(this,void 0,void 0,(function*(){const{render:render,styles:styles,query:query}=yield function(defRect,context){return __awaiter(this,void 0,void 0,(function*(){const place=wrapWithFplSite(Object.assign(Object.assign({},defRect),{ReportItems:[]})),compiledRect=yield compile$2(place,context);return{render:(data,ctx)=>actions=>(width,height)=>{if(!compiledRect)return()=>null;const horSlice=compiledRect.Layout(data,ctx)(actions)(width,height)(height).Body;if(!horSlice)return()=>null;const place=horSlice(width).Body;return place?items=>{const children=items.map(renderChild),isDivNode=n=>isVNode$2(n)&&"DIV"===n.tagName;if(2===place.children.filter(isDivNode).length){for(const child of place.children)if(isDivNode(child)){child.children=children;break}}else place.children.filter(isDivNode).length,place.children=[...place.children,...children];return place.properties.patcher=joinPatchers(place.properties.patcher,children.map((c=>c.properties.patcher))),place}:()=>null},styles:compiledRect&&compiledRect.Styles||[],query:compiledRect&&compiledRect.Query||{Fields:[],Regions:[]}}}))}(container,context),children=yield Promise.all(container.ReportItems.filter(isRectangle).map((r=>__awaiter(this,void 0,void 0,(function*(){return yield function(container,context){return __awaiter(this,void 0,void 0,(function*(){const baseNode=yield makePageTree(container,context);return Object.assign(Object.assign({},baseNode),{pageTree:Object.assign(Object.assign({},baseNode.pageTree),{Location:{X:Length.parse(container.Left),Y:Length.parse(container.Top)},Size:{Width:Length.parse(container.Width),Height:Length.parse(container.Height)}})})}))}(r,context)})))));return children.forEach((c=>{styles.push(...c.styles);const dataMap=combineDataQuery(query,c.query),makeRes=c.pageTree.MakeResult;c.pageTree.MakeResult=(data,ctx)=>makeRes(dataMap(data),ctx)})),{styles:styles,query:query,pageTree:{Name:container.Name,MakeResult:render,Children:children.map((p=>p.pageTree)),ContentItems:container.ReportItems.filter((ri=>"rectangle"!==ri.Type)).map((ri=>({Name:ri.Name,Location:{X:Length.parse(ri.Left),Y:Length.parse(ri.Top)}})))}}}))}const makeTreeResult=treeNode=>(width,height)=>(data,ctx)=>actions=>contentItems=>{const children=treeNode.Children.map((c=>({Name:c.Name,Position:c.Location,Content:makeTreeResult(c)(c.Size.Width,c.Size.Height)(data,ctx)(actions)(contentItems)}))).filter(notEmpty),content=treeNode.ContentItems.map((ci=>contentItems.find((i=>i.Name===ci.Name)))).filter(isDefined).filter(notEmpty);return treeNode.MakeResult(data,ctx)(actions)(width,height)([...children,...content])};function notEmpty(items){return null!==items.Content}function getReportItems(item){const result=[item];return"rectangle"!==item.Type&&"fixedpagesection"!==item.Type||result.push(...flatten$1((item.ReportItems||[]).map(getReportItems))),result}function getOverflowName(item){return"list"===item.Type||"tablix"===item.Type||"table"===item.Type||"tableofcontents"===item.Type||"subreport"===item.Type||"bandedlist"===item.Type?item.OverflowName:null}function isOverflowPlaceholder(rItem){return"overflowplaceholder"===rItem.Type}function isRectangle(rItem){return"rectangle"===rItem.Type}function getFixedPageSize(fixedPage){var _a,_b,_c,_d,_e,_f;return{PageWidth:null!==(_a=fixedPage.Width)&&void 0!==_a?_a:"0in",PageHeight:null!==(_b=fixedPage.Height)&&void 0!==_b?_b:"0in",TopMargin:null!==(_c=fixedPage.TopMargin)&&void 0!==_c?_c:"0in",BottomMargin:null!==(_d=fixedPage.BottomMargin)&&void 0!==_d?_d:"0in",LeftMargin:null!==(_e=fixedPage.LeftMargin)&&void 0!==_e?_e:"0in",RightMargin:null!==(_f=fixedPage.RightMargin)&&void 0!==_f?_f:"0in"}}function getFplHeight$1(page){var _a,_b,_c;const l=Length.parse;return l(null!==(_a=page.PageHeight)&&void 0!==_a?_a:"0in")-l(null!==(_b=page.TopMargin)&&void 0!==_b?_b:"0in")-l(null!==(_c=page.BottomMargin)&&void 0!==_c?_c:"0in")}function getFplWidth(page){var _a,_b,_c;const l=Length.parse;return l(null!==(_a=page.PageWidth)&&void 0!==_a?_a:"0in")-l(null!==(_b=page.LeftMargin)&&void 0!==_b?_b:"0in")-l(null!==(_c=page.RightMargin)&&void 0!==_c?_c:"0in")}const getContentSize=pageSize=>({Width:getFplWidth(pageSize),Height:getFplHeight$1(pageSize)}),renderContent=(content,pageSize)=>{if(!content)return content;const contentSize=getContentSize(pageSize);return content.properties.className+=" arjs-section",renderPage$1(pageSize,"",h("div",{style:{position:"relative",width:Length.toCss(contentSize.Width),height:Length.toCss(contentSize.Height)},patcher:content.properties.patcher},[content]))};var fixedpage=dataRegion((function(definition,context){return __awaiter(this,void 0,void 0,(function*(){const fplGroup=null!==definition.Group&&definition.Group.GroupExpressions.length>0?definition.Group:null,pages=yield Promise.all(definition.Pages.map(((p,index)=>function(rdlPage,context){return __awaiter(this,void 0,void 0,(function*(){const pageItems=getReportItems(rdlPage),placeholders=new Map(pageItems.filter(isOverflowPlaceholder).map((ph=>[ph.Name,ph]))),getPlaceholders=overflowName=>{if(!overflowName)return[];const ph=placeholders.get(overflowName);return ph?(placeholders.delete(overflowName),[ph,...getPlaceholders(ph.OverflowName)]):[]},contentItems=pageItems.filter((i=>"overflowplaceholder"!==i.Type&&"rectangle"!==i.Type&&"fixedpagesection"!==i.Type)).map((it=>({Item:it,Places:getPlaceholders(getOverflowName(it))}))),usedPh=Array.from(placeholders.values()).map((ph=>ph.OverflowName)).filter(Boolean),unusedPlaceholders=Array.from(placeholders.keys()).filter((phName=>usedPh.indexOf(phName)<0)).map((phName=>placeholders.get(phName))).map((ph=>({Name:ph.Name,Places:[ph,...getPlaceholders(ph.OverflowName)]}))),{styles:styles,query:query,pageTree:pageTree}=yield makePageTree(rdlPage,context),pageSize=getFixedPageSize(rdlPage);return{Styles:styles,Query:query,Page:{ContentItems:contentItems,PlaceHolders:unusedPlaceholders,Hierarchy:pageTree,ThrowIfPlaceHoldersEmpty:rdlPage.ThrowIfPlaceHoldersEmpty,PageSize:pageSize}}}))}(Object.assign(Object.assign({},p),{Name:`__Page_${index}__`}),context)))),phAvailable=flatten$1(pages.map((p=>p.Page.PlaceHolders))).map((ph=>ph.Name)),stripInvalidPh=phName=>phName&&phAvailable.indexOf(phName)>=0?phName:null,staticStyles=flatten$1(pages.map((p=>p.Styles))),documentMapNodes=[],query={Fields:[],Regions:[]},groupLabel=null!==definition.Group&&definition.Group.GroupExpressions.length>0?compileExpression(definition.Group.DocumentMapLabel,query.Fields):void 0,pagesComp=yield Promise.all(pages.map(((pi,i)=>__awaiter(this,void 0,void 0,(function*(){const pageInfo=pi,page=pageInfo.Page,children=[],visibility=compileVisibility(definition.Pages[i].Visibility,(expr=>{const val=compileExpression(expr,query.Fields);return"function"!=typeof val?val:(data,ctx)=>safeResolveCompiledData(val,data,"fixed page",ctx)})),pageDocumentMapNodesCollection=[];for(const childTuple of page.ContentItems){const child=isSupportedItem(childTuple.Item)?childTuple.Item:stubUnsupportedItem(childTuple.Item,context.i18n),bounds=getBounds(child),itemSite=isSelfSited(child)?child:wrapWithFplSite(child),itemSize={Height:bounds.Size,Width:bounds.Size2},childContext=Object.assign(Object.assign({},context),{Layout:Object.assign(Object.assign({},context.Layout),{KeepTogether:L2.KeepTogether(itemSize),KeepTogetherVert:l=>L.KeepTogether(l,itemSize.Height,(r=>r.Body))}),ContainerSize:{Height:bounds.Size,Width:bounds.Size2}}),childComp=yield compile$2(itemSite,childContext);if(null===childComp)continue;const dataMap=combineDataQuery(query,childComp.Query);children.push({MakeL:(data,ctx)=>actions=>childComp.Layout(dataMap(data),ctx)(actions)(bounds.Size2,bounds.Size),Places:[Object.assign({Name:child.Name},bounds),...childTuple.Places.map((pl=>Object.assign({Name:pl.Name},getBounds(pl))))],PlaceHolder:stripInvalidPh(childTuple.Places.length?childTuple.Places[childTuple.Places.length-1].OverflowName:getOverflowName(childTuple.Item)),IsRepeatable:!isFixedSizeItem(child)&&"subreport"!==child.Type,FillGroup:"table"===child.Type&&"FillGroup"===child.RepeatBlankRows}),staticStyles.push(...childComp.Styles),childComp.DocumentMap&&pageDocumentMapNodesCollection.push({DocMap:withDefault(visibility(((data,ctx)=>actions=>childComp.DocumentMap(dataMap(data),ctx)(actions))),[]),Bounds:{Location:{X:bounds.Position2,Y:bounds.Position},Size:{Width:bounds.Size2,Height:bounds.Size}}})}const pageDocumentMapNodes=pageDocumentMapNodesCollection.sort(((a,b)=>a.Bounds.Location.Y-b.Bounds.Location.Y||a.Bounds.Location.X-b.Bounds.Location.X)).map((dm=>dm.DocMap));documentMapNodes.push(...pageDocumentMapNodes);const makeChildren=(data,ctx)=>actions=>children.map((c=>{const childCtx=Object.assign(Object.assign({},ctx),{FPL:{isLastPlace:!0,isFillerLayout:!1}}),fillerLayout=c.FillGroup?c.MakeL(data,Object.assign(Object.assign({},childCtx),{FPL:Object.assign(Object.assign({},childCtx.FPL),{isFillerLayout:!0})}))(actions):null;return{Body:c.MakeL(data,childCtx)(actions),Filler:fillerLayout,Places:c.Places,PlaceHolder:c.PlaceHolder,IsRepeatable:c.IsRepeatable,setLastPlace:value=>{childCtx.FPL.isLastPlace=value}}})),renderResult=makeTreeResult(page.Hierarchy),pageDataMap=combineDataQuery(query,pageInfo.Query),placeHolders=page.PlaceHolders.map((ph=>({Name:ph.Name,Places:ph.Places.map((pl=>Object.assign({Name:pl.Name},getBounds(pl)))),PlaceHolder:stripInvalidPh(ph.Places[ph.Places.length-1].OverflowName)})));return visibility(((data,ctx)=>actions=>(width,height)=>{const anchorNodes=groupLabel?buildAnchorNodes(resolveItemCommon({Name:definition.Group&&definition.Group.Name||"",Label:groupLabel},data,ctx)):null,contentSize=getContentSize(page.PageSize);return{MakeResult:(w,h,c)=>renderContent(((width,height)=>(data,ctx)=>renderResult(width,height)(pageDataMap(data),ctx))(w,h)(data,ctx)(actions)(c),Object.assign(Object.assign({},page.PageSize),{PageWidth:w===contentSize.Width?page.PageSize.PageWidth:Length.toCss(w+Length.parse(page.PageSize.LeftMargin)+Length.parse(page.PageSize.RightMargin)),PageHeight:h===contentSize.Height?page.PageSize.PageHeight:Length.toCss(h+Length.parse(page.PageSize.TopMargin)+Length.parse(page.PageSize.BottomMargin))})),Items:makeChildren(data,ctx)(actions),PlaceHolders:placeHolders,ThrowIfPlaceHoldersEmpty:page.ThrowIfPlaceHoldersEmpty,OverflowTail:[],AddAnchors:anchorNodes?firstPage=>(firstPage&&(firstPage.children=[...anchorNodes,...firstPage.children]),firstPage):null,Size:contentSize}}))}))))),pagesDocMap=buildDocumentMap(definition.Group&&definition.Group.Name||"",{Label:groupLabel},context.DocumentMap,documentMapNodes),fplDocMap=fplGroup?buildGroupDocumentMap(definition.Group&&definition.Group.Name||"",{},context.DocumentMap,pagesDocMap):(data,ctx)=>actions=>pagesDocMap(data.Groups[0],ctx)(actions),getFplScope=data=>fplGroup?Object.assign({Groups:[]},data.Regions[0]):{Scope:data,Name:"",Groups:[data]},getFplActions=fplGroup?(actions,scopeId)=>getScopeActions(actions,scopeId):actions=>actions,fplQuery=fplGroup?{Fields:[],Regions:[{type:"list",Name:"FixedPage1",Content:{Fields:[],Regions:[]},Group:{Name:fplGroup.Name,GroupExpressions:fplGroup.GroupExpressions,Filters:(fplGroup.Filters||[]).map((f=>({Expression:f.FilterExpression,Op:f.Operator,Values:f.FilterValues}))),Parent:fplGroup.ParentGroup},Sort:(definition.SortExpressions||[]).map((s=>({Direction:s.Direction,Expression:s.Value}))),GroupContent:query,Filters:(definition.Filters||[]).map((f=>({Expression:f.FilterExpression,Op:f.Operator,Values:f.FilterValues}))),HandleEmptyGroups:!0}]}:query;let lPages=(data,ctx)=>{const withData=pagesComp.map((p=>({scopeId:data.Id,data:p(data,ctx)})));return actions=>{const withActions=withData.map((d=>d.data(getFplActions(actions,d.scopeId)))).filter(isNotNull);return(width,height)=>LayoutPages(withActions.map((g=>{var _a;return null!==(_a=null==g?void 0:g(width,height))&&void 0!==_a?_a:null})).filter(isNotNull))}};return definition.Group.NewSection&&(lPages=inStackSection(lPages,(data=>`${null==fplGroup?void 0:fplGroup.Name}#${data.Id}`))),{Query:fplQuery,Layout:(data,ctx)=>{const withData=map$2(getFplScope(data).Groups,(g=>lPages(g,ctx)));return actions=>{const withActions=map$2(withData,(g=>g(actions)));return(width,height)=>LayoutFPLGroups(function*(iterable,predicate){for(const item of iterable)predicate(item)&&(yield item)}(map$2(withActions,(g=>g(width,height))),isNotNull),(()=>h("div",[])))}},Styles:staticStyles,DocumentMap:(data,ctx)=>actions=>fplDocMap(getFplScope(data),ctx)(actions)}}))}));const defaultSubreport=createReport();const renderer={makeEmptyFragment:(width,height)=>h("div",{style:{width:Length.toCss(width),height:Length.toCss(height)}},[]),makePage:(direction,width,height,listItems)=>{if(1===(null==listItems?void 0:listItems.length))return listItems[0];const patcher=joinPatchers((null!=listItems?listItems:[]).map((c=>c.properties.patcher)));return h("div",{style:{width:Length.toCss(width),height:Length.toCss(height)},patcher:patcher},null!=listItems?listItems:[])}};function getGroupsData(data){return data.Groups?GetCollectionItem(data.Groups,0):data.Scope}function getSubActions(actions,subreportName){return Object.assign(Object.assign({},actions),{Toggles:actions.Toggles.filter((a=>a.ItemPath[0]===subreportName)).map((a=>"toggle"===a.Type?{Type:a.Type,ItemPath:a.ItemPath.slice(1),ScopeId:a.ScopeId}:a)),ScopeToggles:[],IsToggle:()=>!1})}function isDataSetRef$1(param){return!!param.DataSetReference.DataSetName}const makeCheckMark=(checked,color)=>checked?(svg=>svg?`url("data:image/svg+xml;charset=utf8,${encodeURIComponent(svg)}")`:"")(`<svg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24'><path fill='${color}' d='M19,5L7,17L1.5,11.5L2.91,10.09L7,14.17L17.59,3.59L19,5Z' /></svg>`):"",makeBottomPadding=(paddingBottom,textDecoration)=>"double"===getTextDecorationStyle(textDecoration)?Length.toCss(Math.max(Length.parse(paddingBottom)-Length.fromPixels(1),0)):paddingBottom;function makeRender$7(model){const style=model.Style,sb=styleBuilder();sb.add("color",[style.Color]),sb.add("textDecorationLine",[style.TextDecoration],getTextDecoration$3),sb.add("textDecorationStyle",[style.TextDecoration],getTextDecorationStyle),sb.add("fontFamily",[style.FontFamily]),sb.add("fontSize",[style.FontSize]),sb.add("fontStyle",[style.FontStyle],getFontStyle$1),sb.add("fontWeight",[style.FontWeight],getFontWeight$3),sb.add("paddingLeft",[style.PaddingLeft]),sb.add("paddingRight",[style.PaddingRight]),sb.add("paddingTop",[style.PaddingTop]),sb.add("paddingBottom",[style.PaddingBottom,style.TextDecoration],makeBottomPadding),sb.add("wordWrap",[style.WrapMode],getWordWrap),sb.add("wordBreak",[style.WrapMode],getWordBreak),sb.add("whiteSpace",[style.WrapMode],getWhiteSpace);const checked="function"==typeof model.Checked?data=>{const value=resolveCompiled$1(model.Checked,data);return"function"!=typeof value?"true"===(null!==value&&value).toString().toLowerCase():value}:toBoolean(model.Checked),sbCheck=styleBuilder();sbCheck.add("background-image",[checked,style.Color],makeCheckMark);const contentStyle=sb.style,checkStyle=sbCheck.style,contentClassName=`${model.Name}Style`,className=`${contentClassName} arjs-cbCommon arjs-cb${model.CheckAlignment}`,textClassName=`arjs-cbTextCommon arjs-cbText${model.CheckAlignment}`,checkClassName=`${model.Name}StyleCheck`;return{render:(data,itemViewSize,text,ctx)=>{var _a;const resolvedContentStyle=contentStyle.dynamic(data),fullTextClassName="double"===(null!==(_a=contentStyle.static.textDecorationStyle)&&void 0!==_a?_a:resolvedContentStyle.style.textDecorationStyle)?`${textClassName} arjs-cbPadding`:textClassName;return function(contentClassName,textClassName,contentStyle,checkStyleName,checkStyle,itemViewSize,text,idGenerator,model){const textContent=fillLineBreaks("function"==typeof text?"":text),createCheckNode=dynamicStyle=>h("div",{className:`arjs-cbControl ${checkStyleName}`,style:dynamicStyle||checkStyle.style},[]),createTextNode=value=>h("div",{className:`arjs-textBoxContent ${textClassName}`},value),anchorNodes=buildAnchorNodes(model);let patcher=null;const id=idGenerator.next();if("function"==typeof text||null!==contentStyle.renderTimeStyle||null!==checkStyle.renderTimeStyle){const getNewContent=globals=>{const patchTextContent=fillLineBreaks("function"==typeof text?text(globals):text),patchCheckedStyle=checkStyle.renderTimeStyle?checkStyle.renderTimeStyle(globals):null;return[...anchorNodes,createCheckNode(patchCheckedStyle),createTextNode(patchTextContent)].filter(isNotNull)};patcher=globals=>({id:id,style:contentStyle.renderTimeStyle?contentStyle.renderTimeStyle(globals):null,children:"function"==typeof text||null!==checkStyle.renderTimeStyle?getNewContent(globals):null})}const styleAndSize=Object.assign(Object.assign({},contentStyle.style),buildSizeStyle(itemViewSize));return wrapSplittedItem(itemViewSize,h("div",{className:`arjs-textBoxItem ${contentClassName}`,style:styleAndSize,patcher:patcher,id:id,title:model.Tooltip},[...anchorNodes,createCheckNode(null),createTextNode(textContent)]))}(className,fullTextClassName,resolvedContentStyle,checkClassName,checkStyle.dynamic(data),itemViewSize,text,ctx.IDGenerator,resolveItemCommon(model,data,ctx))},styles:[{className:contentClassName,style:Object.assign({},contentStyle.static)},{className:checkClassName,style:Object.assign({},checkStyle.static)}]}}const defaultCheckBox=createReportItem({Type:"checkbox"},"default");function Tree(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function Data(source,dest){this.source=source,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=dest,this.destLen=0,this.ltree=new Tree,this.dtree=new Tree}var sltree=new Tree,sdtree=new Tree,length_bits=new Uint8Array(30),length_base=new Uint16Array(30),dist_bits=new Uint8Array(30),dist_base=new Uint16Array(30),clcidx=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),code_tree=new Tree,lengths=new Uint8Array(320);function tinf_build_bits_base(bits,base,delta,first){var i,sum;for(i=0;i<delta;++i)bits[i]=0;for(i=0;i<30-delta;++i)bits[i+delta]=i/delta|0;for(sum=first,i=0;i<30;++i)base[i]=sum,sum+=1<<bits[i]}var offs=new Uint16Array(16);function tinf_build_tree(t,lengths,off,num){var i,sum;for(i=0;i<16;++i)t.table[i]=0;for(i=0;i<num;++i)t.table[lengths[off+i]]++;for(t.table[0]=0,sum=0,i=0;i<16;++i)offs[i]=sum,sum+=t.table[i];for(i=0;i<num;++i)lengths[off+i]&&(t.trans[offs[lengths[off+i]]++]=i)}function tinf_getbit(d){d.bitcount--||(d.tag=d.source[d.sourceIndex++],d.bitcount=7);var bit=1&d.tag;return d.tag>>>=1,bit}function tinf_read_bits(d,num,base){if(!num)return base;for(;d.bitcount<24;)d.tag|=d.source[d.sourceIndex++]<<d.bitcount,d.bitcount+=8;var val=d.tag&65535>>>16-num;return d.tag>>>=num,d.bitcount-=num,val+base}function tinf_decode_symbol(d,t){for(;d.bitcount<24;)d.tag|=d.source[d.sourceIndex++]<<d.bitcount,d.bitcount+=8;var sum=0,cur=0,len=0,tag=d.tag;do{cur=2*cur+(1&tag),tag>>>=1,++len,sum+=t.table[len],cur-=t.table[len]}while(cur>=0);return d.tag=tag,d.bitcount-=len,t.trans[sum+cur]}function tinf_decode_trees(d,lt,dt){var hlit,hdist,hclen,i,num,length;for(hlit=tinf_read_bits(d,5,257),hdist=tinf_read_bits(d,5,1),hclen=tinf_read_bits(d,4,4),i=0;i<19;++i)lengths[i]=0;for(i=0;i<hclen;++i){var clen=tinf_read_bits(d,3,0);lengths[clcidx[i]]=clen}for(tinf_build_tree(code_tree,lengths,0,19),num=0;num<hlit+hdist;){var sym=tinf_decode_symbol(d,code_tree);switch(sym){case 16:var prev=lengths[num-1];for(length=tinf_read_bits(d,2,3);length;--length)lengths[num++]=prev;break;case 17:for(length=tinf_read_bits(d,3,3);length;--length)lengths[num++]=0;break;case 18:for(length=tinf_read_bits(d,7,11);length;--length)lengths[num++]=0;break;default:lengths[num++]=sym}}tinf_build_tree(lt,lengths,0,hlit),tinf_build_tree(dt,lengths,hlit,hdist)}function tinf_inflate_block_data(d,lt,dt){for(;;){var length,dist,offs,i,sym=tinf_decode_symbol(d,lt);if(256===sym)return 0;if(sym<256)d.dest[d.destLen++]=sym;else for(length=tinf_read_bits(d,length_bits[sym-=257],length_base[sym]),dist=tinf_decode_symbol(d,dt),i=offs=d.destLen-tinf_read_bits(d,dist_bits[dist],dist_base[dist]);i<offs+length;++i)d.dest[d.destLen++]=d.dest[i]}}function tinf_inflate_uncompressed_block(d){for(var length,i;d.bitcount>8;)d.sourceIndex--,d.bitcount-=8;if((length=256*(length=d.source[d.sourceIndex+1])+d.source[d.sourceIndex])!==(65535&~(256*d.source[d.sourceIndex+3]+d.source[d.sourceIndex+2])))return-3;for(d.sourceIndex+=4,i=length;i;--i)d.dest[d.destLen++]=d.source[d.sourceIndex++];return d.bitcount=0,0}!function(lt,dt){var i;for(i=0;i<7;++i)lt.table[i]=0;for(lt.table[7]=24,lt.table[8]=152,lt.table[9]=112,i=0;i<24;++i)lt.trans[i]=256+i;for(i=0;i<144;++i)lt.trans[24+i]=i;for(i=0;i<8;++i)lt.trans[168+i]=280+i;for(i=0;i<112;++i)lt.trans[176+i]=144+i;for(i=0;i<5;++i)dt.table[i]=0;for(dt.table[5]=32,i=0;i<32;++i)dt.trans[i]=i}(sltree,sdtree),tinf_build_bits_base(length_bits,length_base,4,3),tinf_build_bits_base(dist_bits,dist_base,2,1),length_bits[28]=0,length_base[28]=258;const inflate=function(source,dest){var bfinal,res,d=new Data(source,dest);do{switch(bfinal=tinf_getbit(d),tinf_read_bits(d,2,0)){case 0:res=tinf_inflate_uncompressed_block(d);break;case 1:res=tinf_inflate_block_data(d,sltree,sdtree);break;case 2:tinf_decode_trees(d,d.ltree,d.dtree),res=tinf_inflate_block_data(d,d.ltree,d.dtree);break;default:res=-3}if(0!==res)throw new Error("Data error")}while(!bfinal);return d.destLen<d.dest.length?"function"==typeof d.dest.slice?d.dest.slice(0,d.destLen):d.dest.subarray(0,d.destLen):d.dest};var unicodeTrie=class{constructor(data){const isBuffer="function"==typeof data.readUInt32BE&&"function"==typeof data.slice;if(isBuffer||data instanceof Uint8Array){let uncompressedLength;if(isBuffer)this.highStart=data.readUInt32BE(0),this.errorValue=data.readUInt32BE(4),uncompressedLength=data.readUInt32BE(8),data=data.slice(12);else{const view=new DataView(data.buffer);this.highStart=view.getUint32(0),this.errorValue=view.getUint32(4),uncompressedLength=view.getUint32(8),data=data.subarray(12)}data=inflate(data,new Uint8Array(uncompressedLength)),data=inflate(data,new Uint8Array(uncompressedLength)),this.data=new Uint32Array(data.buffer)}else({data:this.data,highStart:this.highStart,errorValue:this.errorValue}=data)}get(codePoint){let index;return codePoint<0||codePoint>1114111?this.errorValue:codePoint<55296||codePoint>56319&&codePoint<=65535?(index=(this.data[codePoint>>5]<<2)+(31&codePoint),this.data[index]):codePoint<=65535?(index=(this.data[2048+(codePoint-55296>>5)]<<2)+(31&codePoint),this.data[index]):codePoint<this.highStart?(index=this.data[2080+(codePoint>>11)],index=this.data[index+(codePoint>>5&63)],index=(index<<2)+(31&codePoint),this.data[index]):this.data[this.data.length-4]}},b64={};!function(exports){var Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,PLUS="+".charCodeAt(0),SLASH="/".charCodeAt(0),NUMBER="0".charCodeAt(0),LOWER="a".charCodeAt(0),UPPER="A".charCodeAt(0),PLUS_URL_SAFE="-".charCodeAt(0),SLASH_URL_SAFE="_".charCodeAt(0);function decode(elt){var code=elt.charCodeAt(0);return code===PLUS||code===PLUS_URL_SAFE?62:code===SLASH||code===SLASH_URL_SAFE?63:code<NUMBER?-1:code<NUMBER+10?code-NUMBER+26+26:code<UPPER+26?code-UPPER:code<LOWER+26?code-LOWER+26:void 0}exports.toByteArray=function(b64){var i,j,l,tmp,placeHolders,arr;if(b64.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var len=b64.length;placeHolders="="===b64.charAt(len-2)?2:"="===b64.charAt(len-1)?1:0,arr=new Arr(3*b64.length/4-placeHolders),l=placeHolders>0?b64.length-4:b64.length;var L=0;function push(v){arr[L++]=v}for(i=0,j=0;i<l;i+=4,j+=3)push((16711680&(tmp=decode(b64.charAt(i))<<18|decode(b64.charAt(i+1))<<12|decode(b64.charAt(i+2))<<6|decode(b64.charAt(i+3))))>>16),push((65280&tmp)>>8),push(255&tmp);return 2===placeHolders?push(255&(tmp=decode(b64.charAt(i))<<2|decode(b64.charAt(i+1))>>4)):1===placeHolders&&(push((tmp=decode(b64.charAt(i))<<10|decode(b64.charAt(i+1))<<4|decode(b64.charAt(i+2))>>2)>>8&255),push(255&tmp)),arr},exports.fromByteArray=function(uint8){var i,temp,length,num,extraBytes=uint8.length%3,output="";function encode(num){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(num)}for(i=0,length=uint8.length-extraBytes;i<length;i+=3)temp=(uint8[i]<<16)+(uint8[i+1]<<8)+uint8[i+2],output+=encode((num=temp)>>18&63)+encode(num>>12&63)+encode(num>>6&63)+encode(63&num);switch(extraBytes){case 1:output+=encode((temp=uint8[uint8.length-1])>>2),output+=encode(temp<<4&63),output+="==";break;case 2:output+=encode((temp=(uint8[uint8.length-2]<<8)+uint8[uint8.length-1])>>10),output+=encode(temp>>4&63),output+=encode(temp<<2&63),output+="="}return output}}(b64);var classes={OP:0,CL:1,CP:2,QU:3,GL:4,NS:5,EX:6,SY:7,IS:8,PR:9,PO:10,NU:11,AL:12,HL:13,ID:14,IN:15,HY:16,BA:17,BB:18,B2:19,ZW:20,CM:21,WJ:22,H2:23,H3:24,JL:25,JV:26,JT:27,RI:28,AI:29,BK:30,CB:31,CJ:32,CR:33,LF:34,NL:35,SA:36,SG:37,SP:38,XX:39},pairs={};let CI_BRK$1,CP_BRK$1,DI_BRK$1,IN_BRK$1,PR_BRK$1,AI,AL,BA,BK,CB,CJ,CR,ID,LF,NL,NS,SA,SG,SP,WJ,XX;pairs.DI_BRK=DI_BRK$1=0,pairs.IN_BRK=IN_BRK$1=1,pairs.CI_BRK=CI_BRK$1=2,pairs.CP_BRK=CP_BRK$1=3,pairs.PR_BRK=PR_BRK$1=4,pairs.pairTable=[[4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,4,4,4,4,4,4,4],[0,4,4,1,1,4,4,4,4,1,1,0,0,0,0,0,1,1,0,0,4,2,4,0,0,0,0,0,0],[0,4,4,1,1,4,4,4,4,1,1,1,1,1,0,0,1,1,0,0,4,2,4,0,0,0,0,0,0],[4,4,4,1,1,1,4,4,4,1,1,1,1,1,1,1,1,1,1,1,4,2,4,1,1,1,1,1,1],[1,4,4,1,1,1,4,4,4,1,1,1,1,1,1,1,1,1,1,1,4,2,4,1,1,1,1,1,1],[0,4,4,1,1,1,4,4,4,0,0,0,0,0,0,0,1,1,0,0,4,2,4,0,0,0,0,0,0],[0,4,4,1,1,1,4,4,4,0,0,0,0,0,0,0,1,1,0,0,4,2,4,0,0,0,0,0,0],[0,4,4,1,1,1,4,4,4,0,0,1,0,0,0,0,1,1,0,0,4,2,4,0,0,0,0,0,0],[0,4,4,1,1,1,4,4,4,0,0,1,1,1,0,0,1,1,0,0,4,2,4,0,0,0,0,0,0],[1,4,4,1,1,1,4,4,4,0,0,1,1,1,1,0,1,1,0,0,4,2,4,1,1,1,1,1,0],[1,4,4,1,1,1,4,4,4,0,0,1,1,1,0,0,1,1,0,0,4,2,4,0,0,0,0,0,0],[1,4,4,1,1,1,4,4,4,1,1,1,1,1,0,1,1,1,0,0,4,2,4,0,0,0,0,0,0],[1,4,4,1,1,1,4,4,4,0,0,1,1,1,0,1,1,1,0,0,4,2,4,0,0,0,0,0,0],[1,4,4,1,1,1,4,4,4,0,0,1,1,1,0,1,1,1,0,0,4,2,4,0,0,0,0,0,0],[0,4,4,1,1,1,4,4,4,0,1,0,0,0,0,1,1,1,0,0,4,2,4,0,0,0,0,0,0],[0,4,4,1,1,1,4,4,4,0,0,0,0,0,0,1,1,1,0,0,4,2,4,0,0,0,0,0,0],[0,4,4,1,0,1,4,4,4,0,0,1,0,0,0,0,1,1,0,0,4,2,4,0,0,0,0,0,0],[0,4,4,1,0,1,4,4,4,0,0,0,0,0,0,0,1,1,0,0,4,2,4,0,0,0,0,0,0],[1,4,4,1,1,1,4,4,4,1,1,1,1,1,1,1,1,1,1,1,4,2,4,1,1,1,1,1,1],[0,4,4,1,1,1,4,4,4,0,0,0,0,0,0,0,1,1,0,4,4,2,4,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0],[1,4,4,1,1,1,4,4,4,0,0,1,1,1,0,1,1,1,0,0,4,2,4,0,0,0,0,0,0],[1,4,4,1,1,1,4,4,4,1,1,1,1,1,1,1,1,1,1,1,4,2,4,1,1,1,1,1,1],[0,4,4,1,1,1,4,4,4,0,1,0,0,0,0,1,1,1,0,0,4,2,4,0,0,0,1,1,0],[0,4,4,1,1,1,4,4,4,0,1,0,0,0,0,1,1,1,0,0,4,2,4,0,0,0,0,1,0],[0,4,4,1,1,1,4,4,4,0,1,0,0,0,0,1,1,1,0,0,4,2,4,1,1,1,1,0,0],[0,4,4,1,1,1,4,4,4,0,1,0,0,0,0,1,1,1,0,0,4,2,4,0,0,0,1,1,0],[0,4,4,1,1,1,4,4,4,0,1,0,0,0,0,1,1,1,0,0,4,2,4,0,0,0,0,1,0],[0,4,4,1,1,1,4,4,4,0,0,0,0,0,0,0,1,1,0,0,4,2,4,0,0,0,0,0,1]];const UnicodeTrie=unicodeTrie,base64=b64;({BK:BK,CR:CR,LF:LF,NL:NL,CB:CB,BA:BA,SP:SP,WJ:WJ,SP:SP,BK:BK,LF:LF,NL:NL,AI:AI,AL:AL,SA:SA,SG:SG,XX:XX,CJ:CJ,ID:ID,NS:NS}=classes);const{DI_BRK:DI_BRK,IN_BRK:IN_BRK,CI_BRK:CI_BRK,CP_BRK:CP_BRK,PR_BRK:PR_BRK,pairTable:pairTable}=pairs,classTrie=new UnicodeTrie(base64.toByteArray("AA4IAAAAAAAAAhqg5VV7NJtZvz7fTC8zU5deplUlMrQoWqmqahD5So0aipYWrUhVFSVBQ10iSTtUtW6nKDVF6k7d75eQfEUbFcQ9KiFS90tQEolcP23nrLPmO+esr/+f39rr/a293t/e7/P8nmfvlz0O6RvrBJADtbBNaD88IOKTOmOrCqhu9zE770vc1pBV/xL5dxj2V7Zj4FGSomFKStCWNlV7hG1VabZfZ1LaHbFrRwzzLjzPoi1UHDnlV/lWbhgIIJvLBp/pu7AHEdRnIY+ROdXxg4fNpMdTxVnnm08OjozejAVsBqwqz8kddGRlRxsd8c55dNZoPuex6a7Dt6L0NNb03sqgTlR2/OT7eTt0Y0WnpUXxLsp5SMANc4DsmX4zJUBQvznwexm9tsMH+C9uRYMPOd96ZHB29NZjCIM2nfO7tsmQveX3l2r7ft0N4/SRJ7kO6Y8ZCaeuUQ4gMTZ67cp7TgxvlNDsPgOBdZi2YTam5Q7m3+00l+XG7PrDe6YoPmHgK+yLih7fAR16ZFCeD9WvOVt+gfNW/KT5/M6rb/9KERt+N1lad5RneVjzxXHsLofuU+TvrEsr3+26sVz5WJh6L/svoPK3qepFH9bysDljWtD1F7KrxzW1i9r+e/NLxV/acts7zuo304J9+t3Pd6Y6u8f3EAqxNRgv5DZjaI3unyvkvHPya/v3mWVYOC38qBq11+yHZ2bAyP1HbkV92vdno7r2lxz9UwCdCJVfd14NLcpO2CadHS/XPJ9doXgz5vLv/1OBVS3gX0D9n6LiNIDfpilO9RsLgZ2W/wIy8W/Rh93jfoz4qmRV2xElv6p2lRXQdO6/Cv8f5nGn3u0wLXjhnvClabL1o+7yvIpvLfT/xsKG30y/sTvq30ia9Czxp9dr9v/e7Yn/O0QJXxxBOJmceP/DBFa1q1v6oudn/e6qc/37dUoNvnYL4plQ9OoneYOh/r8fOFm7yl7FETHY9dXd5K2n/qEc53dOEe1TTJcvCfp1dpTC334l0vyaFL6mttNEbFjzO+ZV2mLk0qc3BrxJ4d9gweMmjRorxb7vic0rSq6D4wzAyFWas1TqPE0sLI8XLAryC8tPChaN3ALEZSWmtB34SyZcxXYn/E4Tg0LeMIPhgPKD9zyHGMxxhxnDDih7eI86xECTM8zodUCdgffUmRh4rQ8zyA6ow/Aei+01a8OMfziQQ+GAEkhwN/cqUFYAVzA9ex4n6jgtsiMvXf5BtXxEU4hSphvx3v8+9au8eEekEEpkrkne/zB1M+HAPuXIz3paxKlfe8aDMfGWAX6Md6PuuAdKHFVH++Ed5LEji94Z5zeiJIxbmWeN7rr1/ZcaBl5/nimdHsHgIH/ssyLUXZ4fDQ46HnBb+hQqG8yNiKRrXL/b1IPYDUsu3dFKtRMcjqlRvONd4xBvOufx2cUHuk8pmG1D7PyOQmUmluisVFS9OWS8fPIe8LiCtjwJKnEC9hrS9uKmISI3Wa5+vdXUG9dtyfr7g/oJv2wbzeZU838G6mEvntUb3SVV/fBZ6H/sL+lElzeRrHy2Xbe7UWX1q5sgOQ81rv+2baej4fP4m5Mf/GkoxfDtT3++KP7do9Jn26aa6xAhCf5L9RZVfkWKCcjI1eYbm2plvTEqkDxKC402bGzXCYaGnuALHabBT1dFLuOSB7RorOPEhZah1NjZIgR/UFGfK3p1ElYnevOMBDLURdpIjrI+qZk4sffGbRFiXuEmdFjiAODlQCJvIaB1rW61Ljg3y4eS4LAcSgDxxZQs0DYa15wA032Z+lGUfpoyOrFo3mg1sRQtN/fHHCx3TrM8eTrldMbYisDLXbUDoXMLejSq0fUNuO1muX0gEa8vgyegkqiqqbC3W0S4cC9Kmt8MuS/hFO7Xei3f8rSvIjeveMM7kxjUixOrl6gJshe4JU7PhOHpfrRYvu7yoAZKa3Buyk2J+K5W+nNTz1nhJDhRUfDJLiUXxjxXCJeeaOe/r7HlBP/uURc/5efaZEPxr55Qj39rfTLkugUGyMrwo7HAglfEjDriehF1jXtwJkPoiYkYQ5aoXSA7qbCBGKq5hwtu2VkpI9xVDop/1xrC52eiIvCoPWx4lLl40jm9upvycVPfpaH9/o2D4xKXpeNjE2HPQRS+3RFaYTc4Txw7Dvq5X6JBRwzs9mvoB49BK6b+XgsZVJYiInTlSXZ+62FT18mkFVcPKCJsoF5ahb19WheZLUYsSwdrrVM3aQ2XE6SzU2xHDS6iWkodk5AF6F8WUNmmushi8aVpMPwiIfEiQWo3CApONDRjrhDiVnkaFsaP5rjIJkmsN6V26li5LNM3JxGSyKgomknTyyrhcnwv9Qcqaq5utAh44W30SWo8Q0XHKR0glPF4fWst1FUCnk2woFq3iy9fAbzcjJ8fvSjgKVOfn14RDqyQuIgaGJZuswTywdCFSa89SakMf6fe+9KaQMYQlKxiJBczuPSho4wmBjdA+ag6QUOr2GdpcbSl51Ay6khhBt5UXdrnxc7ZGMxCvz96A4oLocxh2+px+1zkyLacCGrxnPzTRSgrLKpStFpH5ppKWm7PgMKZtwgytKLOjbGCOQLTm+KOowqa1sdut9raj1CZFkZD0jbaKNLpJUarSH5Qknx1YiOxdA5L6d5sfI/unmkSF65Ic/AvtXt98Pnrdwl5vgppQ3dYzWFwknZsy6xh2llmLxpegF8ayLwniknlXRHiF4hzzrgB8jQ4wdIqcaHCEAxyJwCeGkXPBZYSrrGa4vMwZvNN9aK0F4JBOK9mQ8g8EjEbIQVwvfS2D8GuCYsdqwqSWbQrfWdTRUJMqmpnWPax4Z7E137I6brHbvjpPlfNZpF1d7PP7HB/MPHcHVKTMhLO4f3CZcaccZEOiS2DpKiQB5KXDJ+Ospcz4qTRCRxgrKEQIgUkKLTKKwskdx2DWo3bg3PEoB5h2nA24olwfKSR+QR6TAvEDi/0czhUT59RZmO1MGeKGeEfuOSPWfL+XKmhqpZmOVR9mJVNDPKOS49Lq+Um10YsBybzDMtemlPCOJEtE8zaXhsaqEs9bngSJGhlOTTMlCXly9Qv5cRN3PVLK7zoMptutf7ihutrQ/Xj7VqeCdUwleTTKklOI8Wep9h7fCY0kVtDtIWKnubWAvbNZtsRRqOYl802vebPEkZRSZc6wXOfPtpPtN5HI63EUFfsy7U/TLr8NkIzaY3vx4A28x765XZMzRZTpMk81YIMuwJ5+/zoCuZj1wGnaHObxa5rpKZj4WhT670maRw04w0e3cZW74Z0aZe2n05hjZaxm6urenz8Ef5O6Yu1J2aqYAlqsCXs5ZB5o1JJ5l3xkTVr8rJQ09NLsBqRRDT2IIjOPmcJa6xQ1R5yGP9jAsj23xYDTezdyqG8YWZ7vJBIWK56K+iDgcHimiQOTIasNSua1fOBxsKMMEKd15jxTl+3CyvGCR+UyRwuSI2XuwRIPoNNclPihfJhaq2mKkNijwYLY6feqohktukmI3KDvOpN7ItCqHHhNuKlxMfBAEO5LjW2RKh6lE5Hd1dtAOopac/Z4FdsNsjMhXz/ug8JGmbVJTA+VOBJXdrYyJcIn5+OEeoK8kWEWF+wdG8ZtZHKSquWDtDVyhFPkRVqguKFkLkKCz46hcU1SUY9oJ2Sk+dmq0kglqk4kqKT1CV9JDELPjK1WsWGkEXF87g9P98e5ff0mIupm/w6vc3kCeq04X5bgJQlcMFRjlFWmSk+kssXCAVikfeAlMuzpUvCSdXiG+dc6KrIiLxxhbEVuKf7vW7KmDQI95bZe3H9mN3/77F6fZ2Yx/F9yClllj8gXpLWLpd5+v90iOaFa9sd7Pvx0lNa1o1+bkiZ69wCiC2x9UIb6/boBCuNMB/HYR0RC6+FD9Oe5qrgQl6JbXtkaYn0wkdNhROLqyhv6cKvyMj1Fvs2o3OOKoMYTubGENLfY5F6H9d8wX1cnINsvz+wZFQu3zhWVlwJvwBEp69Dqu/ZnkBf3nIfbx4TK7zOVJH5sGJX+IMwkn1vVBn38GbpTg9bJnMcTOb5F6Ci5gOn9Fcy6Qzcu+FL6mYJJ+f2ZZJGda1VqruZ0JRXItp8X0aTjIcJgzdaXlha7q7kV4ebrMsunfsRyRa9qYuryBHA0hc1KVsKdE+oI0ljLmSAyMze8lWmc5/lQ18slyTVC/vADTc+SNM5++gztTBLz4m0aVUKcfgOEExuKVomJ7XQDZuziMDjG6JP9tgR7JXZTeo9RGetW/Xm9/TgPJpTgHACPOGvmy2mDm9fl09WeMm9sQUAXP3Su2uApeCwJVT5iWCXDgmcuTsFgU9Nm6/PusJzSbDQIMfl6INY/OAEvZRN54BSSXUClM51im6Wn9VhVamKJmzOaFJErgJcs0etFZ40LIF3EPkjFTjGmAhsd174NnOwJW8TdJ1Dja+E6Wa6FVS22Haj1DDA474EesoMP5nbspAPJLWJ8rYcP1DwCslhnn+gTFm+sS9wY+U6SogAa9tiwpoxuaFeqm2OK+uozR6SfiLCOPz36LiDlzXr6UWd7BpY6mlrNANkTOeme5EgnnAkQRTGo9T6iYxbUKfGJcI9B+ub2PcyUOgpwXbOf3bHFWtygD7FYbRhb+vkzi87dB0JeXl/vBpBUz93VtqZi7AL7C1VowTF+tGmyurw7DBcktc+UMY0E10Jw4URojf8NdaNpN6E1q4+Oz+4YePtMLy8FPRP")),mapClass=function(c){switch(c){case AI:return AL;case SA:case SG:case XX:return AL;case CJ:return NS;default:return c}},mapFirst=function(c){switch(c){case LF:case NL:return BK;case CB:return BA;case SP:return WJ;default:return c}};class Break{constructor(position,required=!1){this.position=position,this.required=required}}var linebreaker=class{constructor(string){this.string=string,this.pos=0,this.lastPos=0,this.curClass=null,this.nextClass=null}nextCodePoint(){const code=this.string.charCodeAt(this.pos++),next=this.string.charCodeAt(this.pos);return 55296<=code&&code<=56319&&56320<=next&&next<=57343?(this.pos++,1024*(code-55296)+(next-56320)+65536):code}nextCharClass(){return mapClass(classTrie.get(this.nextCodePoint()))}nextBreak(){for(null==this.curClass&&(this.curClass=mapFirst(this.nextCharClass()));this.pos<this.string.length;){this.lastPos=this.pos;const lastClass=this.nextClass;if(this.nextClass=this.nextCharClass(),this.curClass===BK||this.curClass===CR&&this.nextClass!==LF)return this.curClass=mapFirst(mapClass(this.nextClass)),new Break(this.lastPos,!0);let cur;switch(this.nextClass){case SP:cur=this.curClass;break;case BK:case LF:case NL:cur=BK;break;case CR:cur=CR;break;case CB:cur=BA}if(null!=cur){if(this.curClass=cur,this.nextClass===CB)return new Break(this.lastPos);continue}let shouldBreak=!1;switch(pairTable[this.curClass][this.nextClass]){case DI_BRK:shouldBreak=!0;break;case IN_BRK:shouldBreak=lastClass===SP;break;case CI_BRK:if(shouldBreak=lastClass===SP,!shouldBreak)continue;break;case CP_BRK:if(lastClass!==SP)continue}if(this.curClass=this.nextClass,shouldBreak)return new Break(this.lastPos)}if(this.pos>=this.string.length)return this.lastPos<this.string.length?(this.lastPos=this.string.length,new Break(this.string.length)):null}};const renderTabs$1=makeRenderTabs(((tabText,tabSize)=>h("span",{className:"arjs-text-tab arjs-flex-textitem",style:{minWidth:tabSize}},tabText.length>0?[`${tabText}\xa0`]:[])));function render$6(className,style,itemViewSize,text,pageNumber,tocLink,levelSettings,renderContext){const link=tocLink?{Type:"bookmark",Target:tocLink}:null,textContent=flatten(fillLineBreaks(text).map((t=>"string"==typeof t?renderTabs$1(t,levelSettings.textIndent):t))),createNode=pageNumberValue=>{const levelTextContent=function(settings,textContent,pageNumber){if(!settings.displayPageNumber)return textContent;const pageNum=null!==pageNumber?pageNumber:"";if(!settings.displayFillCharacters)return[...textContent,pageNum];const flexContent=[];for(const item of textContent)if("string"==typeof item){const breaker=new linebreaker(item);let bk=breaker.nextBreak(),lastPos=0;for(;bk;){const word=item.slice(lastPos,bk.position);flexContent.push(h("span",{className:"arjs-flex-textitem"},[word])),lastPos=bk.position,bk=breaker.nextBreak()}}else flexContent.push(item);const fillerWord=null!==settings.fillCharacter?settings.fillCharacter.toString():"",fillerText=fillerWord.length?fillerWord.repeat(1e3/fillerWord.length):null,fillerDiv=null!==fillerText?h("div",{className:"arjs-char-wrap"},[fillerText]):"",pageNumDiv=h("div",{className:"arjs-float-r"},[pageNum]),tailContentDiv=h("div",{className:"arjs-float-r-abs"},[pageNumDiv,fillerDiv]),tailDiv=h("div",{className:"arjs-flex-textfiller"},[tailContentDiv]);return flexContent.push(tailDiv),flexContent}(levelSettings,textContent,pageNumberValue);return h("div",{className:"arjs-textBoxContent"},[h("span",{className:"arjs-action"},[h("span",{className:"arjs-action arjs-tocLevelLabel"+(levelSettings.displayFillCharacters?" arjs-flex-wrap":""),style:{justifyContent:(align=levelSettings.textAlign,"right"===align?"flex-end":"center"===align?"center":"justify"===align?"space-between":"flex-start")},attributes:{"data-action":JSON.stringify(link)}},levelTextContent)])]);var align},id=renderContext.IDGenerator.next(),evalExpr=renderContext.EvalDynamicRuntime;return wrapSplittedItem(itemViewSize,h("div",{id:id,className:`arjs-itemContent arjs-textBoxItem arjs-tocLevelItem ${className}`,style:Object.assign(Object.assign({},style.style),buildSizeStyle(itemViewSize)),patcher:globals=>({id:id,style:style.renderTimeStyle?evalExpr(style.renderTimeStyle,globals):null,children:[createNode(evalExpr(pageNumber,globals))]})},[createNode("")]))}const defaultTocLevel=createTableOfContentsLevel();function compile$e(definition,context){const fields=[],query={Fields:fields,Regions:[]};const compiled=function(definition,context,comp){const exprCompiler=createTypedCompiler(comp);return{Name:context.ReportID+definition.LevelName,DisplayFillCharacters:"right"!==definition.Style.TextAlign&&definition.DisplayFillCharacters,DisplayPageNumber:definition.DisplayPageNumber,Style:{Color:exprCompiler.compileColor(definition.Style.Color,defaultTocLevel.Style.Color),BackgroundColor:exprCompiler.compileColor(definition.Style.BackgroundColor,defaultTocLevel.Style.BackgroundColor),TextAlign:exprCompiler.compileEnum.TextAlign(definition.Style.TextAlign,defaultTocLevel.Style.TextAlign),TextDecoration:exprCompiler.compileEnum.TextDecoration(definition.Style.TextDecoration,defaultTocLevel.Style.TextDecoration),FontFamily:exprCompiler.compileString(definition.Style.FontFamily,defaultTocLevel.Style.FontFamily),FontSize:exprCompiler.compileLength(definition.Style.FontSize,defaultTocLevel.Style.FontSize),FontStyle:exprCompiler.compileEnum.FontStyle(definition.Style.FontStyle,defaultTocLevel.Style.FontStyle),FontWeight:exprCompiler.compileEnum.FontWeight(definition.Style.FontWeight,defaultTocLevel.Style.FontWeight),PaddingLeft:exprCompiler.compileLength(definition.Style.PaddingLeft,defaultTocLevel.Style.PaddingLeft),PaddingRight:exprCompiler.compileLength(definition.Style.PaddingRight,defaultTocLevel.Style.PaddingRight),PaddingTop:exprCompiler.compileLength(definition.Style.PaddingTop,defaultTocLevel.Style.PaddingTop),PaddingBottom:exprCompiler.compileLength(definition.Style.PaddingBottom,defaultTocLevel.Style.PaddingBottom),LeadingChar:exprCompiler.compileString(definition.Style.LeadingChar,defaultTocLevel.Style.LeadingChar),TextIndent:definition.Style.TextIndent}}}(definition,context,(function(value){return compileExpression(value,fields,context.EvaluationContext)})),{render:render,measure:measure,styles:styles}=function(model){const style=model.Style,sb=styleBuilder();sb.add("color",[style.Color]),sb.add("backgroundColor",[style.BackgroundColor]),sb.add("textAlign",[style.TextAlign,"ltr","",""],getTextAlign$1),sb.add("textDecoration",[style.TextDecoration],getTextDecoration$3),sb.add("fontFamily",[style.FontFamily]),sb.add("fontSize",[style.FontSize]),sb.add("fontStyle",[style.FontStyle],getFontStyle$1),sb.add("fontWeight",[style.FontWeight],getFontWeight$3),sb.add("paddingLeft",[style.PaddingLeft]),sb.add("paddingRight",[style.PaddingRight]),sb.add("paddingTop",[style.PaddingTop]),sb.add("paddingBottom",[style.PaddingBottom]);const contentStyle=sb.style,contentClassName=`${model.Name}Style`;return{render:(data,itemViewSize,text,pageNumber,tocLink,ctx)=>{const dynamicStyle=contentStyle.dynamic(data),textAlign=Object.assign(Object.assign({},contentStyle.static),dynamicStyle.style).textAlign,levelOptions={displayPageNumber:model.DisplayPageNumber,displayFillCharacters:model.DisplayPageNumber&&model.DisplayFillCharacters,fillCharacter:model.DisplayPageNumber&&model.DisplayFillCharacters?resolveCompiled$1(style.LeadingChar,data):null,textAlign:textAlign,textIndent:style.TextIndent};return render$6(contentClassName,dynamicStyle,itemViewSize,text,pageNumber,tocLink,levelOptions,ctx)},measure:(d,t,w)=>MeasureTextBoxHeight(Object.assign(Object.assign({},contentStyle.static),contentStyle.dynamic(d).style),t,w,!1,!1,style.TextIndent),styles:[{className:contentClassName,style:contentStyle.static}]}}(compiled);return{Query:query,Layout:(data,ctx,levelData)=>()=>(width,height)=>function(model,width,height,data,ctx,levelData,renderCompiled,measureText){const pageNumPlaceholder=model.DisplayPageNumber?"000":"",value=levelData.Value.toString();return L.KeepTogether(layout$b({CanGrow:!0,CanShrink:!1},value,width,height,((itemViewSize,text)=>renderCompiled(data,itemViewSize,text,levelData.PageNumber,levelData.ToCLink,ctx)),(()=>measureText(data,value+pageNumPlaceholder,width,!1))),1/0,(r=>r.Body))}(compiled,width,height,data,ctx,levelData,render,measure),Styles:styles}}const defaultTalbeOfContents=createReportItem({Type:"tableofcontents"},"default");function makeRender$5(model){const sb=styleBuilder();sb.add("zIndex",[model.ZIndex]);const style=sb.style,className=`${model.Name}Style`;return{render:(data,itemViewSize,svg,renderContext)=>function(className,itemViewSize,svg,renderContext,model){const styleAndSize=buildSizeStyle(itemViewSize);return wrapSplittedItem(itemViewSize,h("div",{className:`arjs-itemContent arjs-svgItem ${className}`,style:styleAndSize,title:model.Tooltip},[...buildAnchorNodes(model),svg]))}(className,itemViewSize,svg,0,resolveItemCommon(model,data,renderContext)),styles:[{className:className,style:style.static}]}}const namespace$1="http://www.w3.org/2000/svg",stackedBarPalette=["1",".8",".64",".512",".4096",".32768",".262144",".2097152"];const getNormalizedValues=chart=>chart.Values.map((v=>100*v/(chart.MaxValue-chart.MinValue||1))),yPercentToCss=(chart,value)=>Length.toCss(chart.Height*value/100),xPercentToCss=(chart,value)=>Length.toCss(chart.Width*value/100),yPercentToPixels=(chart,value)=>Length.toPixels(chart.Height*value/100),xPercentToPixels=(chart,value)=>Length.toPixels(chart.Width*value/100),getGradientId=itemName=>`${itemName}_gradient`,getGradientUri=itemName=>`url(#${getGradientId(itemName)})`,renderLinearGradient=(name,x1,y1,x2,y2,stops)=>h("linearGradient",{namespace:namespace$1,attributes:{id:getGradientId(name),x1:x1,y1:y1,x2:x2,y2:y2}},stops.map((stop=>h("stop",{namespace:namespace$1,attributes:{offset:`${stop.offset.toString()}%`,"stop-color":stop.stopColor}},[])))),getColumnWidth=(width,maxColumnWidth,valuesCount)=>{const columnDefaultWidth=width/(valuesCount||1)/1.25,maxColumnWidthLength=maxColumnWidth&&Length.parse(maxColumnWidth)||0;return maxColumnWidthLength&&columnDefaultWidth>maxColumnWidthLength?maxColumnWidthLength:columnDefaultWidth};function RenderToSVG$1(compiledSparkline,data,widthTwips,heightTwips){const sizeMod="Line"===compiledSparkline.SparklineType&&compiledSparkline.MarkerVisibility?Length.parse(compiledSparkline.LineWidth):0,chart=function(compiledSparkline,data,width,height){const scope=data.Scope;function resolve(value){return resolveCompiled$1(value,scope)}const resolvedValues=data&&data.Groups&&Array.from(data.Groups).map((g=>resolveCompiled$1(compiledSparkline.SeriesValue,g)))||[];let minValue=Math.min.apply(Math,resolvedValues),maxValue=Math.max.apply(Math,resolvedValues);switch(compiledSparkline.SparklineType){case"Columns":minValue=Math.min(minValue,0),maxValue=Math.max(maxValue,0);break;case"Whiskers":minValue=-1,maxValue=1;break;case"StackedBar":minValue=0,maxValue=1}return{Name:`${compiledSparkline.Name}_${scope.Id}`,Width:width,Height:height,SparklineType:compiledSparkline.SparklineType,GradientStyle:resolve(compiledSparkline.GradientStyle),FillColor:resolve(compiledSparkline.FillColor),GradientEndColor:resolve(compiledSparkline.GradientEndColor),LineColor:resolve(compiledSparkline.LineColor),LineWidth:resolve(compiledSparkline.LineWidth),MarkerColor:resolve(compiledSparkline.MarkerColor),MarkerVisibility:compiledSparkline.MarkerVisibility,MaximumColumnWidth:resolve(compiledSparkline.MaximumColumnWidth),RangeGradientStyle:resolve(compiledSparkline.RangeGradientStyle),RangeGradientEndColor:resolve(compiledSparkline.RangeGradientEndColor),RangeFillColor:resolve(compiledSparkline.RangeFillColor),RangeLowerBound:resolve(compiledSparkline.RangeLowerBound),RangeUpperBound:resolve(compiledSparkline.RangeUpperBound),RangeVisibility:toBoolean(resolve(compiledSparkline.RangeVisibility)),Values:resolvedValues,MinValue:minValue,MaxValue:maxValue}}(compiledSparkline,data,widthTwips-40-sizeMod,heightTwips-40-sizeMod);return h("svg",{namespace:namespace$1,attributes:{height:Length.toPixels(heightTwips).toString(),width:Length.toPixels(widthTwips).toString(),viewBox:`${Length.toPixels(-20)} ${Length.toPixels(-20-sizeMod)} ${Length.toPixels(widthTwips)} ${Length.toPixels(heightTwips)}`,preserveAspectRatio:"none"}},chart.Values.length>0?[renderSparkline(chart)]:[])}function renderSparkline(chart){switch(chart.SparklineType){case"Columns":return function(chart){const zero=100*chart.MinValue/(chart.MaxValue-chart.MinValue||1),values=getNormalizedValues(chart),firstColorValue=chart.FillColor,secondColorValue=chart.GradientEndColor,gradient=getGradient(chart.GradientStyle,firstColorValue,secondColorValue,chart.Name),fill=gradient?getGradientUri(chart.Name):firstColorValue,columnWidth=getColumnWidth(chart.Width,chart.MaximumColumnWidth,chart.Values.length),rangeGradient=chart.RangeVisibility?renderRangeGradient(chart,0,100):null,result=[];gradient&&result.push(gradient);return result.push(h("g",{namespace:namespace$1,attributes:{fill:fill,"stroke-width":"0"}},[rangeGradient||[],...values.map(((value,index)=>((chart,value,zero,index,width)=>h("rect",{namespace:namespace$1,attributes:{x:Length.toCss(.125*width*(2*index+1)+width*index),y:yPercentToCss(chart,100+zero-(value>=0?value:0)),width:Length.toCss(width),height:yPercentToCss(chart,Math.abs(value))}},[]))(chart,value,zero,index,columnWidth)))])),result}(chart);case"Whiskers":return function(chart){const values=getNormalizedValues(chart),firstColorValue=chart.FillColor,secondColorValue=chart.GradientEndColor,gradient=getGradient(chart.GradientStyle,firstColorValue,secondColorValue,chart.Name),fill=gradient?getGradientUri(chart.Name):firstColorValue,columnWidth=getColumnWidth(chart.Width,chart.MaximumColumnWidth,chart.Values.length),rangeGradient=chart.RangeVisibility?renderRangeGradient(chart,0,100):null,result=[];gradient&&result.push(gradient);return result.push(h("g",{namespace:namespace$1,attributes:{fill:fill,"stroke-width":"0"}},[rangeGradient||[],...values.map(((value,index)=>((chart,value,index,width)=>h("rect",{namespace:namespace$1,attributes:{x:Length.toCss(.125*width*(2*index+1)+width*index),y:yPercentToCss(chart,value>0?0:0===value?45:50),width:Length.toCss(width),height:yPercentToCss(chart,0===value?10:50)}},[]))(chart,value,index,columnWidth)))])),result}(chart);case"Area":return function(chart){const values=getNormalizedValues(chart),zero=100*chart.MinValue/(chart.MaxValue-chart.MinValue||1),step=100/(chart.Values.length-1||1),firstColorValue=chart.FillColor,secondColorValue=chart.GradientEndColor,gradient=getGradient(chart.GradientStyle,firstColorValue,secondColorValue,chart.Name),fill=gradient?getGradientUri(chart.Name):firstColorValue,rangeGradient=chart.RangeVisibility?renderRangeGradient(chart,0,100):null,result=[];gradient&&result.push(gradient);rangeGradient&&result.push(rangeGradient);return result.push(h("path",{namespace:namespace$1,attributes:{fill:fill,"vector-effect":"non-scaling-stroke",d:`M 0 ${yPercentToPixels(chart,100+zero)} \t\t\t\t${values.map(((v,i)=>`L ${xPercentToPixels(chart,i*step)} ${yPercentToPixels(chart,100-v+zero)}`)).join(" ")} \t\t\t\tL ${xPercentToPixels(chart,100)} ${yPercentToPixels(chart,100+zero)} \t\t\t\tZ`}},[])),result}(chart);case"StackedBar":return function(chart){const values=getNormalizedValues(chart),sum=values.reduce(((p,c)=>p+Math.max(c,0)),0)||1,rects=[];let right=0;for(let i=0;i<values.length;i++)values[i]<0||(rects.push(h("rect",{namespace:namespace$1,attributes:{x:xPercentToCss(chart,right),y:"0pt",width:xPercentToCss(chart,100*values[i]/sum),height:yPercentToCss(chart,100),"fill-opacity":stackedBarPalette[i%stackedBarPalette.length]}},[])),right+=100*values[i]/sum);return[h("g",{namespace:namespace$1,attributes:{fill:chart.FillColor,"stroke-width":"0"}},rects)]}(chart);default:return function(chart){const zero=100*chart.MinValue/(chart.MaxValue-chart.MinValue||1),values=getNormalizedValues(chart).map((v=>v-zero)),step=100/(chart.Values.length-1||1),lineWidthValue=chart.LineWidth,lineColorValue=chart.LineColor,markerColorValue=chart.MarkerColor,marker=chart.MarkerVisibility?h("g",{namespace:namespace$1,attributes:{fill:markerColorValue,stroke:markerColorValue,"stroke-width":lineWidthValue}},[h("circle",{namespace:namespace$1,attributes:{cx:`${xPercentToCss(chart,(values.length-1)*step)}`,cy:`${yPercentToCss(chart,100-values[values.length-1])}`,r:lineWidthValue}},[])]):null,rangeGradient=chart.RangeVisibility?renderRangeGradient(chart,0,100):null,result=[];rangeGradient&&result.push(rangeGradient);result.push(h("polyline",{namespace:namespace$1,attributes:{fill:"none",stroke:lineColorValue,"stroke-width":lineWidthValue,"stroke-linejoin":"round",points:values.map(((v,i)=>`${xPercentToPixels(chart,i*step)},${yPercentToPixels(chart,100-v)}`)).join(" ")}},[])),marker&&result.push(marker);return result}(chart)}}function getGradient(style,firstColor,secondColor,name){let result;switch(style){case"LeftRight":result=renderLinearGradient(name,"0","0","1","0",[{offset:0,stopColor:firstColor},{offset:100,stopColor:secondColor}]);break;case"TopBottom":result=renderLinearGradient(name,"0","0","0","1",[{offset:0,stopColor:firstColor},{offset:100,stopColor:secondColor}]);break;case"DiagonalLeft":result=renderLinearGradient(name,"0","0","1","1",[{offset:0,stopColor:firstColor},{offset:100,stopColor:secondColor}]);break;case"DiagonalRight":result=renderLinearGradient(name,"0","100%","100%","0",[{offset:0,stopColor:firstColor},{offset:100,stopColor:secondColor}]);break;case"HorizontalCenter":result=renderLinearGradient(name,"0","0","0","1",[{offset:0,stopColor:firstColor},{offset:50,stopColor:secondColor},{offset:100,stopColor:firstColor}]);break;case"VerticalCenter":result=renderLinearGradient(name,"0","0","1","0",[{offset:0,stopColor:firstColor},{offset:50,stopColor:secondColor},{offset:100,stopColor:firstColor}]);break;case"Center":result=((name,stops)=>h("radialGradient",{namespace:namespace$1,attributes:{id:getGradientId(name)}},stops.map((stop=>h("stop",{namespace:namespace$1,attributes:{offset:`${stop.offset.toString()}%`,"stop-color":stop.stopColor}},[])))))(name,[{offset:0,stopColor:firstColor},{offset:50,stopColor:secondColor},{offset:100,stopColor:firstColor}]);break;default:result=null}return result}function renderRangeGradient(chart,min,max){const lower=100*(chart.RangeLowerBound-chart.MinValue)/(chart.MaxValue-chart.MinValue||1),upper=100*(chart.RangeUpperBound-chart.MinValue)/(chart.MaxValue-chart.MinValue||1);if(!upper&&0!==upper||!lower&&0!==lower||upper<lower)return null;const range=max-min,yOffset=100-(upper-min)/range*100,height=Math.abs(upper-lower)/range*100,firstColorValue=chart.RangeFillColor,secondColorValue=chart.RangeGradientEndColor,gradient=getGradient(chart.RangeGradientStyle,firstColorValue,secondColorValue,chart.Name+"_R"),fill=gradient?getGradientUri(chart.Name+"_R"):firstColorValue;return h("g",{namespace:namespace$1},[gradient||[],h("rect",{namespace:namespace$1,attributes:{fill:fill,x:"0",y:`${yPercentToCss(chart,yOffset)}`,width:xPercentToCss(chart,100),height:`${yPercentToCss(chart,height)}`}},[])])}const defaultSparkline=createReportItem({Type:"sparkline"},"default");function makeLayout$5(model,width,height,data,renderContext,render){return function(sparkline,width,height,renderSparkline){return L2.StaticClipped(width,height,renderSparkline)}(0,width,height,(itemViewSize=>render(data.Scope,itemViewSize,RenderToSVG$1(model,data,itemViewSize.FullWidth,itemViewSize.FullHeight),renderContext)))}var sparkline=dataRegion((function(definition,context){return __awaiter(this,void 0,void 0,(function*(){const fields=[],groupContent={Fields:[],Regions:[]};const exprCompiler=createTypedCompiler((function(value){return compileExpression(value,fields,context.EvaluationContext)})),compiled={Type:"sparkline",Name:context.ReportID+definition.Name,Label:exprCompiler.compileString(definition.Label),Bookmark:exprCompiler.compileString(definition.Bookmark,defaultSparkline.Bookmark),Tooltip:exprCompiler.compileString(definition.ToolTip,defaultSparkline.ToolTip),SparklineType:definition.SparklineType,GradientStyle:definition.GradientStyle,FillColor:exprCompiler.compileColor(definition.FillColor,defaultSparkline.FillColor),GradientEndColor:exprCompiler.compileColor(definition.GradientEndColor,defaultSparkline.GradientEndColor),LineColor:exprCompiler.compileColor(definition.LineColor,defaultSparkline.LineColor),LineWidth:exprCompiler.compileLength(definition.LineWidth,defaultSparkline.LineWidth),MarkerColor:exprCompiler.compileColor(definition.MarkerColor,defaultSparkline.MarkerColor),MarkerVisibility:definition.MarkerVisibility,MaximumColumnWidth:exprCompiler.compileLength(definition.MaximumColumnWidth,defaultSparkline.MaximumColumnWidth),RangeGradientStyle:definition.RangeGradientStyle,RangeGradientEndColor:exprCompiler.compileColor(definition.RangeGradientEndColor,defaultSparkline.RangeGradientEndColor),RangeFillColor:exprCompiler.compileColor(definition.RangeFillColor,defaultSparkline.RangeFillColor),RangeLowerBound:exprCompiler.compileNumber(definition.RangeLowerBound,defaultSparkline.RangeLowerBound),RangeUpperBound:exprCompiler.compileNumber(definition.RangeUpperBound,defaultSparkline.RangeUpperBound),RangeVisibility:exprCompiler.compileBoolean(definition.RangeVisibility,defaultSparkline.RangeVisibility),SeriesValue:compileExpression(definition.SeriesValue,groupContent.Fields,context.EvaluationContext),ZIndex:definition.ZIndex,Style:{}},sparklineDef=Def.Makers.List(definition.Name,{Fields:fields,Regions:[]},(definition.Filters||[]).map((f=>({Expression:f.FilterExpression,Op:f.Operator,Values:f.FilterValues}))),Def.Makers.Group(definition.Group.Name,definition.Group.GroupExpressions,(definition.Group.Filters||[]).map((f=>({Expression:f.FilterExpression,Op:f.Operator,Values:f.FilterValues}))),definition.Group.ParentGroup||void 0),(definition.SortExpressions||[]).map((s=>({Direction:s.Direction,Expression:s.Value}))),groupContent),{render:render,styles:styles}=makeRender$5(compiled);return{Query:{Fields:[],Regions:[sparklineDef]},Layout:(data,ctx)=>actions=>(width,height)=>makeLayout$5(compiled,width,height,data.Regions[0],ctx,render),Styles:styles,DocumentMap:(data,ctx)=>buildDocumentMap(definition.Name,compiled,context.DocumentMap,[])(data.Regions[0].Scope,ctx)}}))}));function GetNiceNumber(x,round,isLogarithmic=!1){const expv=Math.floor(Math.log10(x)),f=x/Math.pow(10,expv);let nf;if(isLogarithmic){const pow=0===(value=x)?0:Math.floor(Math.log10(value));return Math.pow(10,pow)}var value;return nf=round?f<1.5?1:f<2.5?2.5:f<3?2:f<7?5:10:f<=1?1:f<=1.5?1.5:f<=2?2:f<=2.5?2.5:f<=5?5:10,nf*Math.pow(10,expv)}const namespace="http://www.w3.org/2000/svg",palettes_Palette1=["#666666","#B2B2B2"],palettes_Palette2=["#666666","#999999","#CCCCCC"];function nextColor(index,rangeCount){if(2==rangeCount)return 0==index?palettes_Palette1[0]:palettes_Palette1[1];if(3==rangeCount){if(0==index)return palettes_Palette2[0];if(1==index)return palettes_Palette2[1]}return palettes_Palette2[2]}const toPx$1=length=>Length.toPixels(Length.parse(length||"0pt")),RectangleFEx=(X,Y,Width,Height)=>({X:X,Y:Y,Width:Width,Height:Height});function tryParseFloat(value){const parsed=parseFloat(`${value}`);return isNaN(parsed)||!isFinite(parsed)?null:parsed}function makeCalculatedBullet(bullet){const autoLimits=function(_chart){let _direction,_min=0,_max=0,_interval=0,min=0,max=0;null!==_chart.MarkerValue?(min=Math.min(_chart.Value,_chart.MarkerValue),max=Math.max(_chart.Value,_chart.MarkerValue)):min=max=_chart.Value;let rangeMinMax=max-min;_min=_chart.Min||0,_max=_chart.Max||0,_interval=_chart.Interval||0;let isMinAuto=null===_chart.Min,isMaxAuto=null===_chart.Max;if(isMinAuto||isMaxAuto||_min<=_max)_direction="Forward";else{_direction="Backward";const tmp=_min;_min=_max,_max=tmp}if(!isMinAuto&&isMaxAuto&&_min>max&&(_min=max),!isMaxAuto&&isMinAuto&&_max<min&&(_max=min),null===_chart.Interval)if(isMinAuto&&isMaxAuto)if(min<max){const range=GetNiceNumber(rangeMinMax,!1);_interval=GetNiceNumber(range/5,!0)}else isMinAuto=isMaxAuto=!1,_interval=1,_min=min-_interval,_max=_min+5*_interval;else if(isMaxAuto)if(_min<max){const range=GetNiceNumber(max-_min,!1);_interval=GetNiceNumber(range/5,!0)}else if(rangeMinMax>0){const range=GetNiceNumber(rangeMinMax,!1);_interval=GetNiceNumber(range/5,!0)}else _interval=1;else if(isMinAuto)if(_max>min){const range=GetNiceNumber(_max-min,!1);_interval=GetNiceNumber(range/5,!0)}else if(rangeMinMax>0){const range=GetNiceNumber(rangeMinMax,!1);_interval=GetNiceNumber(range/5,!0)}else _interval=1;else _interval=_min<_max?GetNiceNumber((_max-_min)/5,!0):1;let margin=_interval;if(isMinAuto){let adjustedMin=min;if(!isMaxAuto&&0!=adjustedMin&&Math.abs(_max-adjustedMin)<=Number.EPSILON){let isMinPositive=adjustedMin>0;adjustedMin-=5*_interval,isMinPositive&&adjustedMin<=0&&(adjustedMin=0)}_min=Math.floor(adjustedMin/_interval)*_interval,0!=_min&&Math.abs(_min-min)<=.1*rangeMinMax&&(_min-=margin)}if(isMaxAuto){let adjustedMax=max;Math.abs(_min-adjustedMax)<=Number.EPSILON&&(adjustedMax+=5*_interval),_max=Math.ceil(adjustedMax/_interval)*_interval,Math.abs(_max-_min)<=_interval&&(_max+=_interval),Math.abs(_max-max)<=.1*rangeMinMax&&(_max+=margin)}return{Min:_min,Max:_max,Interval:_interval,Direction:_direction}}(bullet);return Object.assign(Object.assign({},bullet),autoLimits)}function RenderToSVG(compiledBullet,data,widthTwips,heightTwips,language){const chart=function(compiledBullet,data){const Ranges=[],range1=resolveCompiled$1(compiledBullet.Range1Boundary,data);null!==range1&&Ranges.push({BoundValue:range1});const range2=resolveCompiled$1(compiledBullet.Range2Boundary,data);null!==range2&&Ranges.push({BoundValue:range2});const resolvedMin=resolveCompiled$1(compiledBullet.WorstValue,data),resolvedMax=resolveCompiled$1(compiledBullet.BestValue,data),resolvedInterval=resolveCompiled$1(compiledBullet.Interval,data);return{MarkerValue:resolveCompiled$1(compiledBullet.TargetValue,data),Value:resolveCompiled$1(compiledBullet.Value,data),Min:resolvedMin,Max:resolvedMax,OriginalMin:resolvedMin,Orientation:compiledBullet.Orientation,IsHorizontal:"Horizontal"===compiledBullet.Orientation,Ranges:Ranges,MarkerShape:compiledBullet.TargetShape,TargetLineColor:resolveCompiled$1(compiledBullet.TargetLineColor,data),TicksLineColor:resolveCompiled$1(compiledBullet.TicksLineColor,data),TicksLineWidth:resolveCompiled$1(compiledBullet.TicksLineWidth,data),ValueColor:resolveCompiled$1(compiledBullet.ValueColor,data),TickMark:compiledBullet.TickMarks,TargetLineWidth:resolveCompiled$1(compiledBullet.TargetLineWidth,data),LabelFormat:resolveCompiled$1(compiledBullet.LabelFormat,data),LabelFontFamily:resolveCompiled$1(compiledBullet.LabelFontFamily,data),LabelFontSize:resolveCompiled$1(compiledBullet.LabelFontSize,data),LabelFontStyle:resolveCompiled$1(compiledBullet.LabelFontStyle,data),LabelFontColor:resolveCompiled$1(compiledBullet.LabelFontColor,data),ShowTicks:"None"!==compiledBullet.TickMarks,TickLength:"3pt",ShowLabels:compiledBullet.ShowLabels,Direction:"Forward",Interval:resolvedInterval}}(compiledBullet,data);"number"!=typeof chart.Min&&(chart.Min=tryParseFloat(chart.Min)),"number"!=typeof chart.Max&&(chart.Max=tryParseFloat(chart.Max)),"number"!=typeof chart.Interval&&(chart.Interval=tryParseFloat(chart.Interval)),chart.OriginalMin=chart.Min;const _chart=makeCalculatedBullet(chart),FillRectangle=(fill,x,y,width,height)=>h("rect",{namespace:namespace,attributes:{x:(x+_chartArea.X).toString(),y:(y+_chartArea.Y+_chartArea.Height).toString(),width:width.toString(),height:Math.abs(height).toString(),fill:fill}},[]),FillEllipse=(fill,x,y,width,height)=>h("ellipse",{namespace:namespace,attributes:{cx:(x+_chartArea.X+width/2).toString(),cy:(y+_chartArea.Y+_chartArea.Height+height/2).toString(),rx:Math.abs(width/2).toString(),ry:Math.abs(height/2).toString(),fill:fill}},[]),width=Length.toPixels(widthTwips),height=Length.toPixels(heightTwips);let _chartArea={X:0,Y:0,Width:width,Height:height},_scaleFactor=0;return function(boundRect){boundRect.X+=1,boundRect.Y+=1,boundRect.Width-=2,boundRect.Height-=2,_chartArea=boundRect;let marginLeft=0,marginTop=0,marginBottom=0;_chart.ShowTicks&&(_chart.IsHorizontal?marginBottom=Math.max(marginBottom,toPx$1(_chart.TickLength)):marginLeft=Math.max(marginLeft,toPx$1(_chart.TickLength)));if(_chart.ShowLabels){let minLabelSize=MeasureText(Format(_chart.Min,language,_chart.LabelFormat),_chart.LabelFontSize,_chart.LabelFontFamily),maxLabelSize=MeasureText(Format(_chart.Max,language,_chart.LabelFormat),_chart.LabelFontSize,_chart.LabelFontFamily);if(_chart.IsHorizontal){let margin=minLabelSize.Height+2;margin>boundRect.Height/2&&(margin=boundRect.Height/2),marginBottom+=margin}else{marginTop=Math.max(marginTop,maxLabelSize.Height/2),marginBottom=Math.max(marginBottom,minLabelSize.Height/2);let margin=Math.max(minLabelSize.Width,maxLabelSize.Width);margin>boundRect.Width/2&&(margin=boundRect.Width/2),marginLeft+=margin}}_chartArea={X:marginLeft,Y:marginTop,Width:boundRect.Width-(marginLeft+0),Height:boundRect.Height-(marginTop+marginBottom)},_chartArea.X+=boundRect.X,_chartArea.Width+=boundRect.X,_chartArea.Y+=boundRect.Y,_chartArea.Height+=boundRect.Y}({X:0,Y:0,Width:width,Height:height}),function(){_chart.Min,_chart.Max,0;let scale=_chart.Max-_chart.Min;Number.isFinite(scale)&&!Number.isNaN(scale)||(scale=0);let globalRange=_chart.IsHorizontal?_chartArea.Width:_chartArea.Height;0!==scale&&(scale=globalRange/scale);Number.isFinite(scale)&&!Number.isNaN(scale)||(scale=0);_scaleFactor=scale}(),h("svg",{namespace:namespace,attributes:{height:height.toString(),width:width.toString(),viewBox:`0 ${-_chartArea.Y} ${width} ${height}`}},[...function(){const rangeCount=_chart.Ranges.length+1,ranges=[];let x1="Forward"===_chart.Direction?_chart.Min:_chart.Max;for(let index=0;index<_chart.Ranges.length;index++){const x2=_chart.Ranges[index].BoundValue;ranges.push(DrawRange(x1,x2,nextColor(index,rangeCount))),x1=x2}const backdrop=nextColor(rangeCount-1,rangeCount);return ranges.push(DrawRange(x1,"Forward"===_chart.Direction?_chart.Max:_chart.Min,backdrop)),ranges}(),null!==_chart.MarkerValue?function(){_chart.MarkerValue<_chart.Min||(_chart.MarkerValue,_chart.Max),0;return function(){_chart.MarkerValue,0;const markerCenter=GetCenterByValue(_chart.MarkerValue);let shapeWidth=0,lineWidth=toPx$1(_chart.TargetLineWidth);shapeWidth=_chart.IsHorizontal?.75*_chartArea.Height:.75*_chartArea.Width;const shapeWidthHalf=shapeWidth/2,color=_chart.TargetLineColor;if("Line"===_chart.MarkerShape)return _chart.IsHorizontal?FillRectangle(color,markerCenter.X-lineWidth/2,markerCenter.Y-shapeWidthHalf,lineWidth,shapeWidth):FillRectangle(color,markerCenter.X-shapeWidth/2,markerCenter.Y-lineWidth/2,shapeWidth,lineWidth);if("Dot"===_chart.MarkerShape)return FillEllipse(color,markerCenter.X-shapeWidth/2,markerCenter.Y-shapeWidth/2,shapeWidth,shapeWidth);if("Square"===_chart.MarkerShape)return FillRectangle(color,markerCenter.X-shapeWidthHalf,markerCenter.Y-shapeWidthHalf,shapeWidth,shapeWidth);return""}()}():"",function(){_chart.Value<_chart.Min||(_chart.Value,_chart.Max),0;let center=GetCenterByValue(_chart.Value),shapeWidth=0;shapeWidth=_chart.IsHorizontal?.3*_chartArea.Height:.3*_chartArea.Width;let valueBrush=_chart.ValueColor;var min=null!==_chart.OriginalMin?_chart.OriginalMin:_chart.Min;if(Math.abs(min)<=Number.EPSILON){let measureRect=null,toValue="Forward"===_chart.Direction?min:_chart.Value,fromValue="Forward"===_chart.Direction?_chart.Value:min;if(toValue<fromValue&&"Forward"===_chart.Direction){let tempVal=toValue;toValue=fromValue,fromValue=tempVal}return _chart.IsHorizontal?(measureRect=GetHorizontalRectangle(fromValue,toValue),measureRect.Y=center.Y-shapeWidth/2,measureRect.Height=shapeWidth):(measureRect=GetVerticalRectangle(fromValue,toValue),measureRect.X=center.X-shapeWidth/2,measureRect.Width=shapeWidth),FillRectangle(valueBrush,measureRect.X,measureRect.Y,measureRect.Width,measureRect.Height)}return FillEllipse(valueBrush,center.X-shapeWidth/2,center.Y-shapeWidth/2,shapeWidth,shapeWidth)}(),...function(){const scale=[];if(null==_chart.Interval)return scale;for(let tick=_chart.Min;tick<=_chart.Max;tick+=_chart.Interval){let drawnTick=DrawTick(null,tick),anchor=drawnTick.Anchor;if(_chart.ShowLabels){let align="";align=tick<=_chart.Min?"Forward"===_chart.Direction?"Near":"Far":tick>=_chart.Max?"Forward"===_chart.Direction?"Far":"Near":"Center",scale.push(DrawLabel(tick,anchor,align)),scale.push(drawnTick.Tick)}}return scale}()]);function MeasureText(text,fontSize,fontFamily){return{Width:text.length*toPx$1(fontSize)*.8,Height:MeasureTextBoxHeight({fontSize:fontSize,fontFamily:fontFamily},"1",1e3)/20}}function DrawRange(x1,x2,backdrop){const clippedX1=Math.min(Math.max(x1,_chart.Min),_chart.Max),clippedX2=Math.max(Math.min(x2,_chart.Max),_chart.Min);if(clippedX1==clippedX2)return"";const rangeRect=_chart.IsHorizontal?GetHorizontalRectangle(clippedX1,clippedX2):GetVerticalRectangle(clippedX1,clippedX2);return FillRectangle(backdrop,rangeRect.X,rangeRect.Y,rangeRect.Width,rangeRect.Height)}function LocalToGlobal(localValue){return"Forward"===_chart.Direction?_chart.IsHorizontal?(localValue-_chart.Min)*_scaleFactor+_chartArea.X:(localValue-_chart.Min)*_scaleFactor+_chartArea.Y:_chart.IsHorizontal?_chartArea.X+_chartArea.Width-(localValue-_chart.Min)*_scaleFactor:_chartArea.Y+_chartArea.Height-(localValue-_chart.Min)*_scaleFactor}function GetHorizontalRectangle(valueFrom,valueTo){const x=LocalToGlobal(valueFrom),y=-_chartArea.Height,w=LocalToGlobal(valueTo)-x,h=_chartArea.Height;return RectangleFEx(x,y,w,h)}function GetVerticalRectangle(valueFrom,valueTo){const y=-LocalToGlobal(valueTo),w=_chartArea.Width,h=-y-LocalToGlobal(valueFrom);return RectangleFEx(0,y,w,h)}function GetCenterByValue(value){const v=LocalToGlobal(value);return{X:_chart.IsHorizontal?v:_chartArea.Width/2,Y:_chart.IsHorizontal?-_chartArea.Height/2:-v}}function DrawTick(tickPen,tickValue){let anchor={X:0,Y:0},tick="";const color=_chart.TicksLineColor;let x1=_chart.IsHorizontal?LocalToGlobal(tickValue):_chartArea.X,y1=_chart.IsHorizontal?_chartArea.Height:_chartArea.Height+_chartArea.Y-LocalToGlobal(tickValue),x2=0,y2=0;switch(_chart.TickMark){case"None":anchor={X:x1,Y:y1};break;case"Inside":x2=_chart.IsHorizontal?x1:x1+toPx$1(_chart.TickLength),y2=_chart.IsHorizontal?y1-toPx$1(_chart.TickLength):y1,tick=h("line",{namespace:namespace,attributes:{x1:x1.toString(),y1:y1.toString(),x2:x2.toString(),y2:y2.toString(),style:`stroke:${color};stroke-width:${toPx$1(_chart.TicksLineWidth)}`}},[]),anchor={X:x1,Y:y1};break;default:case"Outside":x2=_chart.IsHorizontal?x1:x1-toPx$1(_chart.TickLength),y2=_chart.IsHorizontal?y1+toPx$1(_chart.TickLength):y1,tick=h("line",{namespace:namespace,attributes:{x1:x1.toString(),y1:y1.toString(),x2:x2.toString(),y2:y2.toString(),style:`stroke:${color};stroke-width:${toPx$1(_chart.TicksLineWidth)}`}},[]),anchor={X:x2,Y:y2}}return{Anchor:anchor,Tick:tick}}function DrawLabel(tickValue,anchor,align){return function(text,anchor,align){let corner={X:0,Y:0},dominantBaseline=_chart.IsHorizontal?"hanging":"middle",textAnchor="middle";switch(align){case"Near":textAnchor="start";break;case"Far":textAnchor="end"}_chart.IsHorizontal?corner={X:anchor.X,Y:anchor.Y+2}:(corner={X:anchor.X-2,Y:anchor.Y},textAnchor="end");return h("text",{namespace:namespace,attributes:{x:corner.X.toString(),y:corner.Y.toString(),"text-anchor":textAnchor,"dominant-baseline":dominantBaseline,"font-family":_chart.LabelFontFamily}},[h("tspan",{namespace:namespace,attributes:getAttributesForLabel(_chart)},text)])}(Format(tickValue,language,_chart.LabelFormat),anchor,align)}}const getAttributesForLabel=chart=>{const atr={};atr.fill=chart.LabelFontColor,atr["font-family"]=chart.LabelFontFamily,atr["font-size"]=chart.LabelFontSize,atr["font-style"]=getFontStyle(chart.LabelFontStyle),atr["font-weight"]=getFontWeight$2(chart.LabelFontStyle);const textDecoration=getTextDecoration$2(chart.LabelFontStyle);return textDecoration&&(atr["text-decoration"]=textDecoration),atr},getFontStyle=labelFontStyle=>"italic"===labelFontStyle.toLowerCase()?"italic":"normal",getFontWeight$2=labelFontStyle=>"bold"===labelFontStyle.toLowerCase()?"bold":"normal",getTextDecoration$2=labelFontStyle=>{switch(labelFontStyle){case"Underline":return"underline";case"Strikeout":return"line-through";default:return null}};function makeRender$4(model){const sb=styleBuilder();sb.add("zIndex",[model.ZIndex]);const style=sb.style,className=`${model.Name}Style`;return{render:(data,width,height,svg,renderContext)=>function(className,style,width,height,svg,renderContext,model){const styleAndSize=Object.assign(Object.assign({},style.style),{width:Length.toCss(width),height:Length.toCss(height)}),{patcher:patcher,id:id}=createStylePatcher(renderContext,style);return h("div",{className:`${className} arjs-svgItem`,style:styleAndSize,patcher:patcher,id:id,title:model.Tooltip},[...buildAnchorNodes(model),svg])}(className,style.dynamic(data),width,height,svg,renderContext,resolveItemCommon(model,data,renderContext)),styles:[{className:className,style:style.static}]}}const defaultBullet=createReportItem({Type:"bullet"},"default");function makeLayout$4(model,width,height,data,renderContext,render){return function(bullet,width,height,renderBullet){return L2.Fixed(width,height,renderBullet)}(0,width,height,((width,height)=>render(data,width,height,RenderToSVG(model,data,width,height,renderContext.Language),renderContext)))}const builtInSvgRenderEngineBuilder=dv._SvgRenderEngine;class CustomSvgMeasure{begin(svgElement){this.element=svgElement}end(){}getBBox(){try{const textRectangle=this.element.getBBox();return new dv.core.Rect(textRectangle.x,textRectangle.y,textRectangle.width,textRectangle.height)}catch(_a){return new dv.core.Rect(0,0,0,0)}}measureString(s,fontSize,fontFamily,fontWeight,fontStyle,writingMode){const writingModeValue=writingMode===dv.TextWritingMode.Vertical?"tb-rl":"lr-tb",{Width:Width,Height:Height}=MeasureTextBoxSize({fontSize:fontSize,fontFamily:fontFamily,fontWeight:fontWeight,fontStyle:fontStyle,writingMode:writingModeValue},s,null);return new dv.core.Size(Length.toPixels(Width),Length.toPixels(Height))}}const compiler=createCompiler();class CalculationEnginePlugin{constructor(params){this.name="CustomCalculationEngine",this.type=dv._BuildInCalculationEngineBuilderCollection._pluginType,this.priority=1,this.parameters={},params.forEach((([expression,value])=>{const parameterName=expression.replace(/(^=parameters[.!])|(\.value$)/gi,"").toLowerCase();this.parameters[parameterName]=value}))}buildCalculationEngine(type,proxy){const ctx={Data:{chart:makeGlobalDataTypesDvChart(proxy),parameters:this.parameters}};return{evaluate:(name,expression)=>{try{const compiled=compiler(expression),result="function"==typeof compiled?compiled(ctx):compiled;"Bool"===result.Type&&proxy.resultCallback(result.Value)}catch(ex){console.warn("[chart expression]",ex.message)}}}}queryInterface(name){return"ICalculationEngineBuilder"===name||"IPlugin"===name?this:null}}const makeGlobalDataTypesDvChart=proxy=>({get currentdetail(){return proxy.getIdentityValue("current.detail")},get currentdata(){return proxy.getIdentityValue("current.value")},get currentdatahigh(){return proxy.getIdentityValue("current.high")},get currentdatalow(){return proxy.getIdentityValue("current.low")},get currentdataopen(){return proxy.getIdentityValue("current.open")},get currentdataclose(){return proxy.getIdentityValue("current.close")},get currentdataupper(){return proxy.getIdentityValue("current.upper")},get currentdatalower(){return proxy.getIdentityValue("current.lower")},get currentcategory(){return proxy.getIdentityValue("current.dimension")},get nextdetail(){return proxy.getIdentityValue("next.detail")},get nextdata(){return proxy.getIdentityValue("next.value")},get nextdatahigh(){return proxy.getIdentityValue("next.high")},get nextdatalow(){return proxy.getIdentityValue("next.low")},get nextdataopen(){return proxy.getIdentityValue("next.open")},get nextdataclose(){return proxy.getIdentityValue("next.close")},get nextdataupper(){return proxy.getIdentityValue("next.upper")},get nextdatalower(){return proxy.getIdentityValue("next.lower")},get nextcategory(){return proxy.getIdentityValue("next.dimension")},get previousdetail(){return proxy.getIdentityValue("previous.detail")},get previousdata(){return proxy.getIdentityValue("previous.value")},get previousdatahigh(){return proxy.getIdentityValue("previous.high")},get previousdatalow(){return proxy.getIdentityValue("previous.low")},get previousdataopen(){return proxy.getIdentityValue("previous.open")},get previousdataclose(){return proxy.getIdentityValue("previous.close")},get previousdataupper(){return proxy.getIdentityValue("previous.upper")},get previousdatalower(){return proxy.getIdentityValue("previous.lower")},get previouscategory(){return proxy.getIdentityValue("previous.dimension")}});class StringFormattingPlugin{constructor(language){this.language=language,this.name="StringFormatting",this.type=dv._BuildInStringFormatBuilderCollection._pluginType,this.priority=1}build(){return{format:(format,object)=>Format(object instanceof Date?dateTimeFactory_createFromJsDate(object):object,this.language,format),defaultFormat:(dataType,percentage)=>"g"}}queryInterface(name){return"IStringFormatBuilder"===name||"IPlugin"===name?this:null}}const svgRenderPlugin=new class{constructor(){this.name="Svg",this.type=dv.BuildInRenderEngineBuilderCollection._pluginType,this.priority=1}buildRenderEngine(type,element,devicePixelRatio){return type===builtInSvgRenderEngineBuilder._renderEngineType?new builtInSvgRenderEngineBuilder(element,new CustomSvgMeasure):null}queryInterface(name){return"IRenderEngineBuilder"==name||"IPlugin"==name?this:null}};function makeRender$3(getResourceUri){return{render:(itemViewSize,viewModel,language,model,paramRefs)=>function(itemViewSize,viewModel,language,getResourceUri,model,paramRefs){const calcPlugin=new CalculationEnginePlugin(paramRefs),formatPlugin=new StringFormattingPlugin(language),isDevMode="node"!==environment&&document.body.className.split(" ").indexOf("arjs-dev-mode")>-1,Hook=function(){};Hook.prototype.unhook=()=>{},Hook.prototype.hook=node=>{isDevMode&&(node.onclick=()=>{console.log(JSON.stringify(viewModel))});const pluginCollection=new dv.plugins.PluginCollection;pluginCollection.register(svgRenderPlugin),pluginCollection.register(calcPlugin),pluginCollection.register(formatPlugin);const chartSize=new dv.core.Size(Length.toPixels(itemViewSize.FullWidth),Length.toPixels(itemViewSize.FullHeight)),dvi=new dv.FlexDV(node,null,chartSize,pluginCollection);dvi.hitTested.addHandler(((_,e)=>{var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l,_m,_o,_p,_q,_r,_s;const originalEvent=e.event.originalEvent,targetElementAttributes=originalEvent.target.attributes;if("click"!==originalEvent.type&&"mousemove"!==originalEvent.type||targetElementAttributes.getNamedItem("data-action")||"svg"===originalEvent.target.nodeName)return;let action=null;const pointModel=null===(_a=e.model)||void 0===_a?void 0:_a.queryInterface("IPointModel");if(pointModel&&pointModel.parent&&pointModel.parent.parent){const plotModel=pointModel.parent.parent.queryInterface("IPlotModel");if(plotModel){const plotName=null!==(_d=null===(_c=null===(_b=plotModel._definition)||void 0===_b?void 0:_b._plotOption)||void 0===_c?void 0:_c.name)&&void 0!==_d?_d:plotModel.name;action=pointModel.items&&pointModel.items[0]&&pointModel.items[0]["___action___"+plotName]}}const legendItemModel=null===(_f=null===(_e=e.model)||void 0===_e?void 0:_e.parent)||void 0===_f?void 0:_f.queryInterface("ILegendItemModel");if(legendItemModel){const legendModel=null===(_g=e.model.parent)||void 0===_g?void 0:_g.parent,legendPointData=null===(_k=null===(_j=null===(_h=legendItemModel._data)||void 0===_h?void 0:_h._getRelatedPointViews)||void 0===_j?void 0:_j.call(_h,null==legendModel?void 0:legendModel.parent)[0])||void 0===_k?void 0:_k.items[0],kind=null!==(_l=null==legendModel?void 0:legendModel.__kind)&&void 0!==_l?_l:1,legendKinds=[dv._LegendKind.PlotColor&kind?"color":null,dv._LegendKind.PlotShape&kind?"shape":null,dv._LegendKind.PlotSize&kind?"size":null].filter(Boolean),plotNames=[null===(_q=null===(_p=null===(_o=null===(_m=null==legendModel?void 0:legendModel.__data)||void 0===_m?void 0:_m._definition)||void 0===_o?void 0:_o._plotDefinition)||void 0===_p?void 0:_p._plotOption)||void 0===_q?void 0:_q.__name,...(null!==(_s=null===(_r=null==legendModel?void 0:legendModel.__data)||void 0===_r?void 0:_r._definitions)&&void 0!==_s?_s:[]).map((d=>{var _a,_b;return null===(_b=null===(_a=null==d?void 0:d._plotDefinition)||void 0===_a?void 0:_a._plotOption)||void 0===_b?void 0:_b.__name}))].filter(Boolean);for(const legendKind of legendKinds){for(const plotName of plotNames)if(action=legendPointData&&legendPointData["___action___"+legendKind+"-encoding___"+plotName],action)break;if(action)break}}if(action){const actionAttrValue=buildActionAttr(action),actionAttr=document.createAttribute("data-action");if(actionAttr.value=actionAttrValue.Type?JSON.stringify(actionAttrValue):"{}",targetElementAttributes.setNamedItem(actionAttr),actionAttrValue.Type){const classAttr=document.createAttribute("class");classAttr.value="arjs-action",targetElementAttributes.setNamedItem(classAttr)}}}));try{dvi.load(viewModel)}catch(err){isDevMode&&console.log(err)}};const chartNode=h("div",{className:"arjs-fullSize",hook:new Hook},[]),contentNode=h("div",{className:"arjs-itemContent arjs-svgItem",style:buildSizeStyle(itemViewSize),title:model.Tooltip},[...buildAnchorNodes(model),chartNode]);return wrapSplittedItem(itemViewSize,contentNode)}(itemViewSize,viewModel,language,0,model,paramRefs),styles:[]}}var lib$1={},utils$1={},length$1={};Object.defineProperty(length$1,"__esModule",{value:!0});var twipsPerPx=0;function getTwipsPerPx(){return twipsPerPx||(twipsPerPx=twipsPer$1.in/function(){if("undefined"==typeof document)return 96;var elem=document.body.appendChild(document.createElement("div"));elem.style.width="1in",elem.style.padding="0";var dpi=elem.clientWidth;return document.body.removeChild(elem),dpi}())}var twipsPer$1={in:1440,pt:20,pc:240,cm:566.9291338582677,mm:56.69291338582677};length$1.default={parse:function(length){var trimmed=length.trim(),units=trimmed.substr(-2).toLowerCase();if(!twipsPer$1[units])throw new Error("Unable to parse length: "+length);var stringVal=trimmed.substr(0,trimmed.length-2);if(!function(value){return!isNaN(value-parseFloat(value))}(stringVal))throw new Error("Unable to parse length: "+length);var value=parseFloat(stringVal);return Math.trunc(value*twipsPer$1[units])},toPixels:function(twips){return twips/getTwipsPerPx()}},Object.defineProperty(utils$1,"__esModule",{value:!0}),utils$1.hashCode=utils$1.tryConvertToNumber=utils$1.toPx=utils$1.mapValues=utils$1.toNumber=utils$1.toStringOrNull=utils$1.isExpression=void 0;var length_1$1=length$1;utils$1.isExpression=function(value){return value&&"string"==typeof value&&"="===value.trim()[0]},utils$1.toStringOrNull=function(value){return null!=value?""+value:null},utils$1.toNumber=function(value){var numericValue="number"==typeof value?value:parseFloat(""+value);return isNaN(numericValue)?0:numericValue},utils$1.mapValues=function(obj,callback){var result={};return Object.keys(obj||{}).forEach((function(key){result[key]=callback(obj[key])})),result},utils$1.toPx=function(value){if(!value)return 0;if("number"==typeof value)return value;if("string"!=typeof value)return null;if("Inherit"===value)return 0;var twips=length_1$1.default.parse(value);return twips?Math.max(length_1$1.default.toPixels(twips),1):0},utils$1.tryConvertToNumber=function(value){if(null==value||"string"!=typeof value)return value;if(""===value)return null;var numericValue=parseFloat(value);return isNaN(numericValue)?value:numericValue},utils$1.hashCode=function(str){var hash=0;if(str)for(var lowerStr=str.toLowerCase(),i=0;i<lowerStr.length;i++)hash=(hash<<5)-hash+lowerStr.charCodeAt(i),hash&=hash;return"x"+(hash>=0?"":"_")+Math.abs(hash).toString(16).toUpperCase()};var translate$1={};!function(exports){var __assign=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},__spreadArrays=commonjsGlobal&&commonjsGlobal.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;var r=Array(s),k=0;for(i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:!0}),exports.dateMode=exports.getOverlayField=exports.overlayStyle=exports.convertRuleTarget=exports.encodings=exports.mapAndEscapeField=exports.mapField=exports.dataPointStyle=exports.legendStyle=exports.style=exports.lineStyle=exports.backgroundStyle=exports.titleStyle=exports.labelStyle=exports.textStyle=exports.paddings=void 0;var XRegExp=xRegExp;exports.paddings=function(style){return{left:style.PaddingLeft,right:style.PaddingRight,top:style.PaddingTop,bottom:style.PaddingBottom}},exports.textStyle=function(style){return{color:style.Color,fontFamily:style.FontFamily,fontSize:style.FontSize,fontStyle:style.FontStyle,fontWeight:style.FontWeight,textDecoration:style.TextDecoration}},exports.labelStyle=function(style){return __assign(__assign({},exports.textStyle(style)),{padding:exports.paddings(style),writingMode:style.WritingMode})},exports.titleStyle=function(style){return __assign(__assign({},exports.textStyle(style)),{padding:exports.paddings(style)})},exports.backgroundStyle=function(style){return{backgroundColor:style.BackgroundColor,fill:style.BackgroundColor}},exports.lineStyle=function(style){return{stroke:style.Border.Color,strokeWidth:style.Border.Width,strokeDasharray:style.Border.Style}},exports.style=function(style){return __assign(__assign(__assign({},exports.backgroundStyle(style)),exports.lineStyle(style)),{borderStyle:exports.lineStyle(style)})},exports.legendStyle=function(legendStyle,iconColor){return __assign(__assign({},exports.style(legendStyle)),{iconColor:iconColor})},exports.dataPointStyle=function(config){return{symbolOpacity:config.SymbolOpacity,opacity:config.Opacity,strokeOpacity:config.Opacity,fill:config.Style.BackgroundColor,stroke:config.LineStyle.Color,strokeWidth:config.LineStyle.Width,strokeDasharray:config.LineStyle.Style,symbolShape:config.SymbolShape,symbolFill:config.SymbolStyle.BackgroundColor,symbolStroke:config.SymbolStyle.Border.Color,symbolStrokeWidth:config.SymbolStyle.Border.Width,symbolStrokeDasharray:config.SymbolStyle.Border.Style}};var aggregates=["Avg","Count","CountDistinct","First","Last","Max","Median","Min","Mode","StDev","StDevP","Sum","Var","VarP"],agregatesRegexStr="(?<aggregateName>"+aggregates.join("|")+")",SIMPLE_FIELD_REGEX=XRegExp("^=\\s*Fields[\\.!](?<fieldName>[\\pL_\\d]+?)\\.Value\\s*$","gi"),COMPLEX_FIELD_REGEX=XRegExp('^=\\s*Fields(?:\\.Item)?\\("(?<fieldName>[^"]+)"\\)\\.Value\\s*$',"gi"),AGGREGATE_SIMPLE_FIELD_REGEX=XRegExp("^=\\s*"+agregatesRegexStr+"\\s*\\(\\s*Fields[\\.!](?<fieldName>[\\pL_\\d]+?)\\.Value\\s*\\)\\s*$","gi"),AGGREGATE_COMPLEX_FIELD_REGEX=XRegExp("^=\\s*"+agregatesRegexStr+'\\s*\\(\\s*Fields(?:\\.Item)?\\("(?<fieldName>[^"]+)"\\)\\.Value\\s*\\)\\s*$',"gi");function tryParseExpression(exp,regex,withAggregate){void 0===withAggregate&&(withAggregate=!1);var match=XRegExp.exec(exp,regex);if(!match)return null;var _a=match,fieldName=_a.fieldName,aggregateName=_a.aggregateName;return fieldName?withAggregate&&aggregateName?fieldName+" ("+function(aggregateName){var lowerName=aggregateName.toLowerCase();return aggregates.find((function(aggregate){return aggregate.toLowerCase()===lowerName}))||aggregateName}(aggregateName)+")":fieldName:null}function mapField(expression){var exp=expression&&expression.trim();return exp?'=""'===exp?"emptyField":tryParseExpression(exp,SIMPLE_FIELD_REGEX)||tryParseExpression(exp,COMPLEX_FIELD_REGEX)||tryParseExpression(exp,AGGREGATE_SIMPLE_FIELD_REGEX,!0)||tryParseExpression(exp,AGGREGATE_COMPLEX_FIELD_REGEX,!0)||exp.replace(/^=/,""):"stubField"}exports.mapField=mapField,exports.mapAndEscapeField=function(str){return function(str){return str.replace(/([,>])/g,"\\$1")}(mapField(str))};var aggregate=function(agg,defaultAgg){return void 0===defaultAgg&&(defaultAgg="Sum"),agg&&"None"!==agg?agg:defaultAgg},group=function(group){return group&&"None"!==group?group:null};function getSort(orderType,sortingField,aggregate){var order=function(sortDirection){return sortDirection&&"None"!==sortDirection?sortDirection:null}(orderType);return sortingField?{field:exports.mapAndEscapeField(sortingField),order:order,aggregate:aggregate}:order||null}var predefinedNames=["xField","valueField","categoryField","detailFields","colorField","sizeField","shapeField"].map((function(name){return name.toLowerCase()}));function templateFields(encodings,translatedEncodings,template){if(!template)return null;var tokens=function(originalString){for(var regExp=XRegExp("{s*((w+s+)*w+)([(d+)])?(.w*)*s*(:s*.+?)*s*}","g"),matches=[],m=null;m=regExp.exec(originalString);)m&&m[1]&&matches.push(m[1]);return matches}(template.toString()).filter((function(token){return-1===predefinedNames.indexOf(token.toLowerCase())})),fields=[],pushField=function(fieldValue,aggregate){return fields.push({field:fieldValue,aggregate:aggregate})},aggregateEncodings=__spreadArrays(translatedEncodings.values,translatedEncodings.details,[translatedEncodings.category,translatedEncodings.color,translatedEncodings.shape,translatedEncodings.size]);return(encodings.Values||[]).forEach((function(encoding){var field=encoding&&encoding.Field;field&&("Complex"===field.FieldType?field.Subfields.forEach((function(subField){return pushField(exports.mapAndEscapeField(subField.Value),aggregate(encoding.Aggregate))})):(field.Value||[]).forEach((function(fieldValue){return pushField(exports.mapAndEscapeField(fieldValue),aggregate(encoding.Aggregate))})))})),tokens.forEach((function(token){var encoding=aggregateEncodings.find((function(encoding){return"string"==typeof encoding.field&&encoding.field.toLowerCase()===token.toLowerCase()}));pushField(exports.mapAndEscapeField(encoding&&encoding.field||token),encoding&&encoding.aggregate)})),fields}var translateTextEncodings=function(encodings,translatedTextEncodings){var result=encodings.map((function(encoding){return{field:encoding.Field.Value.map((function(v,i){return encoding.Field.Captions[i]||v})).map(exports.mapAndEscapeField).join(","),aggregate:"None"===encoding.Aggregate?null:aggregate(encoding.Aggregate)}}));return translatedTextEncodings&&result.push.apply(result,translatedTextEncodings),result.length>0?result:null};exports.encodings=function(encodings,textTemplate,tooltipTemplate,plotType){var canUseCommonField="Scatter"!==plotType&&"Line"!==plotType,translatedEncodings={values:encodings.Values&&encodings.Values.map((function(value){return"Simple"===value.Field.FieldType?{field:value.Field.Value.map((function(v,i){return"Simple"===value.Field.FieldType&&value.Field.Captions[i]||v})).map(exports.mapAndEscapeField).join(","),aggregate:aggregate(value.Aggregate)}:{field:value.Field.Subfields.reduce((function(p,c){return p[c.Key]=exports.mapAndEscapeField(c.Caption||c.Value),p}),{}),aggregate:aggregate(value.Aggregate)}})),category:encodings.Category&&{field:encodings.Category.Field.Value.length>0?encodings.Category.Field.Value.map(exports.mapAndEscapeField).join(">"):canUseCommonField?"commonField":"",sort:getSort(encodings.Category.Sort,encodings.Category.SortingField,aggregate(encodings.Category.SortingAggregate,"List"))},color:encodings.Color&&{field:encodings.Color.Field.Value.map(exports.mapAndEscapeField).join(","),aggregate:aggregate(encodings.Color.Aggregate,"List")},size:encodings.Size&&{field:encodings.Size.Field.Value.map(exports.mapAndEscapeField).join(","),aggregate:aggregate(encodings.Size.Aggregate)},shape:encodings.Shape&&{field:encodings.Shape.Field.Value.map(exports.mapAndEscapeField).join(","),aggregate:aggregate(encodings.Shape.Aggregate,"List")},details:encodings.Details&&encodings.Details.map((function(detail){return{field:detail.Field.Value.map(exports.mapAndEscapeField).join(","),excludeNulls:detail.ExcludeNulls,group:group(detail.Group),sort:getSort(detail.Sort,detail.SortingField,aggregate(detail.SortingAggregate,"List"))}}))},textEncoding=templateFields(encodings,translatedEncodings,textTemplate);translatedEncodings.text=translateTextEncodings((encodings.Texts||[]).filter((function(encoding){return"Label"===encoding.Target})),textEncoding);var tooltipEncoding=templateFields(encodings,translatedEncodings,tooltipTemplate);return translatedEncodings.tooltip=translateTextEncodings((encodings.Texts||[]).filter((function(encoding){return"ToolTip"===encoding.Target})),tooltipEncoding),translatedEncodings};var ruleTargets={BackgroundColor:"style.fill",LabelTemplate:"text.template",TooltipTemplate:"tooltip.template",LineColor:"style.stroke",LineStyle:"style.strokeDasharray",LineWidth:"style.strokeWidth",SymbolLineColor:"style.symbolStroke",SymbolLineStyle:"style.symbolStrokeDasharray",SymbolLineWidth:"style.symbolStrokeWidth",SymbolBackgroundColor:"style.symbolFill"};exports.convertRuleTarget=function(target){return ruleTargets[target]||"style.fill"},exports.overlayStyle=function(style){return{stroke:style.Border.Color,strokeWidth:style.Border.Width,strokeDasharray:style.Border.Style,strokeOpacity:1,fill:style.BackgroundColor}};var overlayPredefinedTokens=["High","Low","Open","Close","Upper","Lower"];exports.getOverlayField=function(field){return field?overlayPredefinedTokens.includes(field)?field.toLowerCase():exports.mapAndEscapeField(field):null},exports.dateMode=function(dateMode,axisType){return"Y"===axisType||"Default"===dateMode?null:"Millisecond"===dateMode?"MilliSecond":dateMode}}(translate$1);var compile$a={};Object.defineProperty(compile$a,"__esModule",{value:!0}),compile$a.compileAxesLabelsTemplates=compile$a.compileEncodings=compile$a.compileObject=void 0;var Utils$2=utils$1,Translate$1=translate$1;compile$a.compileObject=function compileObject(obj,compile,path){for(var compiled={},_loop_1=function(key){var value=obj[key];null===value?compiled[key]=null:"object"==typeof value?Array.isArray(value)?compiled[key]=value.map((function(v,i){return"object"==typeof v&&null!==v?compileObject(v,compile,path+"."+key+"["+i+"]"):Utils$2.isExpression(v)?compile(v,path+"."+key+"["+i+"]"):v})):compiled[key]=compileObject(value,compile,path+"."+key):compiled[key]=Utils$2.isExpression(value)?compile(value,path+"."+key):value},_i=0,_a=Object.keys(obj);_i<_a.length;_i++){_loop_1(_a[_i])}return compiled},compile$a.compileEncodings=function(plots,compileData){for(var compiledData={},_loop_2=function(i){var plot=plots[i],path="model.plots["+i+"].encodings";plot.encodings.Color&&plot.encodings.Color.Field.Value.forEach((function(expression,index){expression&&(compiledData[Translate$1.mapField(expression)]=Utils$2.isExpression(expression)?compileData(expression,path+".color.field.value["+index+"]"):expression)})),plot.encodings.Shape&&plot.encodings.Shape.Field.Value.forEach((function(expression,index){expression&&(compiledData[Translate$1.mapField(expression)]=Utils$2.isExpression(expression)?compileData(expression,path+".shape.field.value["+index+"]"):expression)})),plot.encodings.Size&&plot.encodings.Size.Field.Value.forEach((function(expression,index){expression&&(compiledData[Translate$1.mapField(expression)]=Utils$2.isExpression(expression)?compileData(expression,path+".size.field.value["+index+"]"):expression)})),plot.encodings.Category&&plot.encodings.Category.Field.Value.forEach((function(expression,index){expression&&Utils$2.isExpression(expression)&&(compiledData[Translate$1.mapField(expression)]=compileData(expression,path+".category.field.value["+index+"]"))})),plot.encodings.Category&&plot.encodings.Category.SortingField&&Utils$2.isExpression(plot.encodings.Category.SortingField)&&(compiledData[Translate$1.mapField(plot.encodings.Category.SortingField)]=compileData(plot.encodings.Category.SortingField,path+".category.sortingField")),plot.encodings.Details&&plot.encodings.Details.forEach((function(encoding,encIndex){encoding.Field.Value.forEach((function(expression,index){expression&&Utils$2.isExpression(expression)&&(compiledData[Translate$1.mapField(expression)]=compileData(expression,path+".details["+encIndex+"].field.value["+index+"]"))})),encoding.SortingField&&Utils$2.isExpression(encoding.SortingField)&&(compiledData[Translate$1.mapField(encoding.SortingField)]=compileData(encoding.SortingField,path+".details["+encIndex+"].sortingField"))})),plot.encodings.Texts&&plot.encodings.Texts.forEach((function(encoding,encIndex){encoding.Field.Value.forEach((function(expression,index){encoding.Field.Captions[index]?compiledData[encoding.Field.Captions[index]]=compileData(expression,path+".texts["+encIndex+"].field.value["+index+"]"):expression&&Utils$2.isExpression(expression)&&(compiledData[Translate$1.mapField(expression)]=compileData(expression,path+".texts["+encIndex+"].field.value["+index+"]"))}))})),plot.encodings.Values&&plot.encodings.Values.forEach((function(encoding,encIndex){"Simple"===encoding.Field.FieldType?encoding.Field.Value.forEach((function(expression,index){"Simple"===encoding.Field.FieldType&&encoding.Field.Captions[index]?compiledData[encoding.Field.Captions[index]]=compileData(expression,path+".values["+encIndex+"].field.value["+index+"]"):expression&&(compiledData[Translate$1.mapField(expression)]=compileData(expression,path+".values["+encIndex+"].field.value["+index+"]"))})):(encoding.Field.Subfields||[]).forEach((function(subField){var expression=subField.Value;subField.Caption?compiledData[subField.Caption]=compileData(subField.Caption,path+".values["+encIndex+"].field.value["+subField.Key+"]"):expression&&(compiledData[Translate$1.mapField(expression)]=compileData(expression,path+".values["+encIndex+"].field.value["+subField.Key+"]"))}))}))},i=0;i<plots.length;i++)_loop_2(i);return compiledData},compile$a.compileAxesLabelsTemplates=function(model,compileData){var compiledTemplates={};return model.config.plotAreas.forEach((function(plotArea,pi){plotArea.axes.forEach((function(axis,ai){axis.labelTemplate&&(compiledTemplates[Utils$2.hashCode(axis.labelTemplate)]=compileData(axis.labelTemplate,"model.config.plotAreas["+pi+"].axes["+ai+"].labelTemplate"))}))})),compiledTemplates};var resolve={},__assign$1=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign$1=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};Object.defineProperty(resolve,"__esModule",{value:!0}),resolve.resolveOverlay=resolve.resolveRule=resolve.dataPointStyle=resolve.overlayStyle=resolve.legendStyle=resolve.style=resolve.lineStyle=resolve.backgroundStyle=resolve.gaugeLabelStyle=resolve.titleStyle=resolve.labelStyle=resolve.textStyle=resolve.paddings=void 0;var Utils$1=utils$1;function paddings(compiledPaddings,resolve){return{left:Utils$1.toPx(resolve(compiledPaddings.left)),right:Utils$1.toPx(resolve(compiledPaddings.right)),top:Utils$1.toPx(resolve(compiledPaddings.top)),bottom:Utils$1.toPx(resolve(compiledPaddings.bottom))}}function textStyle(compiledStyle,resolve){var textDecoration=resolve(compiledStyle.textDecoration);return{color:resolve(compiledStyle.color),fontFamily:resolve(compiledStyle.fontFamily),fontSize:resolve(compiledStyle.fontSize),fontStyle:resolve(compiledStyle.fontStyle),fontWeight:getFontWeight$1(resolve(compiledStyle.fontWeight)),textDecoration:{overline:"Overline"===textDecoration,lineThrough:"LineThrough"===textDecoration,underline:"Underline"===textDecoration}}}function gaugeLabelStyle(compiledStyle,resolve){return __assign$1(__assign$1({},textStyle(compiledStyle,resolve)),{writingMode:"tb-rl"===resolve(compiledStyle.writingMode)?"Vertical":"Horizontal"})}function backgroundStyle(compiledStyle,resolve){return{fill:resolve(compiledStyle.fill),backgroundColor:resolve(compiledStyle.backgroundColor)}}function resolveLineWidthAndStyle(width,style,resolve){var strokeWidth=Utils$1.toPx(resolve(width)),strokeStyle=resolve(style);return"None"===strokeStyle&&(strokeWidth=0),{strokeWidth:strokeWidth,strokeStyle:strokeStyle}}function lineStyle(compiledStyle,resolve){var _a=resolveLineWidthAndStyle(compiledStyle.strokeWidth,compiledStyle.strokeDasharray,resolve),strokeWidth=_a.strokeWidth,strokeStyle=_a.strokeStyle;return{stroke:resolve(compiledStyle.stroke),strokeWidth:strokeWidth,strokeDasharray:getStrokeDasharray(strokeStyle,strokeWidth),strokeOpacity:1}}function style(compiledStyle,resolve){return __assign$1(__assign$1({},backgroundStyle(compiledStyle,resolve)),lineStyle(compiledStyle,resolve))}function overlayStyle(compiledStyle,resolve){return __assign$1(__assign$1({},lineStyle(compiledStyle,resolve)),{strokeOpacity:resolve(compiledStyle.strokeOpacity),fill:resolve(compiledStyle.fill)})}resolve.paddings=paddings,resolve.textStyle=textStyle,resolve.labelStyle=function(compiledStyle,resolve){return __assign$1(__assign$1({},textStyle(compiledStyle,resolve)),{padding:paddings(compiledStyle.padding,resolve),writingMode:"tb-rl"===resolve(compiledStyle.writingMode)?"Vertical":"Horizontal"})},resolve.titleStyle=function(compiledStyle,resolve){return __assign$1(__assign$1({},textStyle(compiledStyle,resolve)),{padding:paddings(compiledStyle.padding,resolve)})},resolve.gaugeLabelStyle=gaugeLabelStyle,resolve.backgroundStyle=backgroundStyle,resolve.lineStyle=lineStyle,resolve.style=style,resolve.legendStyle=function(compiledStyle,resolve){return __assign$1(__assign$1({},style(compiledStyle,resolve)),{iconColor:resolve(compiledStyle.iconColor)})},resolve.overlayStyle=overlayStyle;resolve.dataPointStyle=function(compiledStyle,resolve){var shape,symbolShape=resolve(compiledStyle.symbolShape),_a=resolveLineWidthAndStyle(compiledStyle.symbolStrokeWidth,compiledStyle.symbolStrokeDasharray,resolve),symbolStrokeWidth=_a.strokeWidth,symbolStrokeStyle=_a.strokeStyle;return"None"===symbolStrokeStyle&&(shape=symbolShape,symbolStrokeWidth=["X","Dash","Plus"].findIndex((function(v){return v===shape}))>=0?null:0),__assign$1(__assign$1({symbolOpacity:resolve(compiledStyle.symbolOpacity),symbolStrokeOpacity:resolve(compiledStyle.symbolOpacity),fill:resolve(compiledStyle.fill)},lineStyle(compiledStyle,resolve)),{opacity:resolve(compiledStyle.opacity),strokeOpacity:resolve(compiledStyle.strokeOpacity),symbolShape:"Auto"===symbolShape?null:symbolShape,symbolFill:resolve(compiledStyle.symbolFill),symbolStroke:resolve(compiledStyle.symbolStroke),symbolStrokeWidth:symbolStrokeWidth,symbolStrokeDasharray:getStrokeDasharray(symbolStrokeStyle,symbolStrokeWidth)})};var getFontWeight$1=function(value){return fontWeightMap[(value||"Normal").toLowerCase()].toString()},fontWeightMap={lighter:0,thin:100,extralight:200,light:300,normal:400,medium:500,semibold:600,bold:700,extrabold:800,heavy:900,bolder:1e3};function getStrokeDasharray(borderStyle,borderWidth){if(!borderStyle||!borderWidth)return null;switch(borderStyle.toLowerCase()){case"dotted":return borderWidth+", "+borderWidth;case"dashed":return 4*borderWidth+", "+4*borderWidth;case"dashdot":case"dashdotdot":return 4*borderWidth+", "+4*borderWidth+", "+borderWidth+", "+4*borderWidth;default:return null}}resolve.resolveRule=function(compiledName,compiledValue,compiledStyle,resolve){var name=resolve(compiledName);switch(name){case"style.strokeWidth":case"style.symbolStrokeWidth":return{name:name,value:Utils$1.toPx(resolve(compiledValue))};case"style.strokeDasharray":var _a=resolveLineWidthAndStyle(compiledStyle.strokeWidth,compiledValue,resolve),strokeWidth=_a.strokeWidth;return{name:name,value:getStrokeDasharray(_a.strokeStyle,strokeWidth)};case"style.symbolStrokeDasharray":var _b=resolveLineWidthAndStyle(compiledStyle.symbolStrokeWidth,compiledValue,resolve),symbolStrokeWidth=_b.strokeWidth;return{name:name,value:getStrokeDasharray(_b.strokeStyle,symbolStrokeWidth)};default:return{name:name,value:resolve(compiledValue)}}},resolve.resolveOverlay=function(overlay,resolve){switch(overlay.type){case"Needle":var widthPx=Utils$1.toPx(resolve(overlay.width));return{type:resolve(overlay.type),display:resolve(overlay.display),start:resolve(overlay.start),end:"1,"+Utils$1.toNumber(resolve(overlay.end)),width:widthPx?widthPx/2:null,style:{stroke:resolve(overlay.style.stroke),opacity:resolve(overlay.style.opacity),fill:resolve(overlay.style.fill)}};case"Ellipse":return{type:resolve(overlay.type),display:resolve(overlay.display),pointPath:resolve(overlay.pointPath),position:resolve(overlay.position),width:Utils$1.toPx(resolve(overlay.width)),height:Utils$1.toPx(resolve(overlay.height)),style:{stroke:resolve(overlay.style.stroke),opacity:resolve(overlay.style.opacity),fill:resolve(overlay.style.fill)}};case"Text":var _a=overlay.offset.map((function(offset){return Utils$1.toPx(resolve(offset))})),offsetX=_a[0],offsetY=_a[1];return{type:resolve(overlay.type),display:resolve(overlay.display),pointPath:resolve(overlay.pointPath),position:resolve(overlay.position),text:Utils$1.toStringOrNull(resolve(overlay.text)),offset:offsetX+","+offsetY,textStyle:__assign$1({},gaugeLabelStyle(overlay.textStyle,resolve))};default:return{label:resolve(overlay.label),legendText:resolve(overlay.legendText),type:resolve(overlay.type),display:resolve(overlay.display),style:overlayStyle(overlay.style,resolve),field:resolve(overlay.field),detailLevel:resolve(overlay.detailLevel),axis:resolve(overlay.axis),aggregate:resolve(overlay.aggregate),start:resolve(overlay.start),end:resolve(overlay.end),order:resolve(overlay.order),period:resolve(overlay.period),intercept:resolve(overlay.intercept),forecast:{backwardPeriod:resolve(overlay.forecast.backwardPeriod),forwardPeriod:resolve(overlay.forecast.forwardPeriod)},value:resolve(overlay.value)}}};var __assign=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},__spreadArrays=commonjsGlobal&&commonjsGlobal.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;var r=Array(s),k=0;for(i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(lib$1,"__esModule",{value:!0});var Utils=utils$1,Translate=translate$1,Compile=compile$a,Resolve=resolve;var _default=lib$1.default=function(definition,compileConfig,compileData,processInteractivity){return function(model,compileConfig,compileData,processInteractivity){var compiledConfig=Compile.compileObject(model.config,compileConfig,"model.config"),compiledPlots=model.plots.map((function(plot,i){return{name:plot.name,type:plot.type,config:Compile.compileObject(__assign(__assign({},plot.config),{rules:plot.config.rules.map((function(rule){return __assign(__assign({},rule),{condition:null})}))}),compileConfig,"model.plots["+i+"]"),encodings:plot.encodings}})),compiledData=Compile.compileEncodings(model.plots,compileData),compiledAxesLabelsTemplates=Compile.compileAxesLabelsTemplates(model,compileData),compiledActions={};processInteractivity&&model.plots.forEach((function(plot){plot.config.action&&(compiledActions["___action___"+plot.name]=compileAction(plot.config.action,compileData)),plot.encodings.Color.Action&&(compiledActions["___action___color-encoding___"+plot.name]=compileAction(plot.encodings.Color.Action,compileData)),plot.encodings.Size.Action&&(compiledActions["___action___size-encoding___"+plot.name]=compileAction(plot.encodings.Size.Action,compileData)),plot.encodings.Shape.Action&&(compiledActions["___action___shape-encoding___"+plot.name]=compileAction(plot.encodings.Shape.Action,compileData))}));var transform=[],withUnpivotTransform=function(plot,plotIndex){var _a,fields=null===(_a=plot.encodings)||void 0===_a?void 0:_a.values.map((function(v){return v.field})),newDataFieldName="unpivotDataFields/"+plot.name,dvDataSourceName="unpivotData/"+plot.name,newCategoryName="unpivotDataCategory/"+plot.name;return transform.push({category:{fieldAs:newCategoryName,from:fields},valueFieldAs:newDataFieldName,outputAs:dvDataSourceName}),__assign(__assign({},plot),{data:dvDataSourceName,encodings:__assign(__assign({},plot.encodings),{values:[{field:newDataFieldName}],details:[{field:newCategoryName,group:"Stack"}],color:model.plots[plotIndex].config.useGlobalLegend?{field:newCategoryName}:plot.encodings.color,text:plot.config.text.template?{field:newCategoryName}:plot.encodings.text})})};return function(configScope,dataScopes){var resolve=function(value){return resolveCompiled(value,configScope)};return{config:{bar:{bottomWidth:fixNaN(resolve(compiledConfig.bar.bottomWidth)),neckHeight:fixNaN(resolve(compiledConfig.bar.neckHeight)),overlap:fixNaN(resolve(compiledConfig.bar.overlap)),topWidth:fixNaN(resolve(compiledConfig.bar.topWidth)),width:fixNaN(resolve(compiledConfig.bar.width))},header:{title:resolve(compiledConfig.header.title),height:resolve(compiledConfig.header.height),style:Resolve.style(compiledConfig.header.style,resolve),textStyle:Resolve.textStyle(compiledConfig.header.textStyle,resolve),borderStyle:Resolve.lineStyle(compiledConfig.header.style,resolve),padding:Resolve.paddings(compiledConfig.header.padding,resolve),hAlign:resolve(compiledConfig.header.hAlign),vAlign:resolve(compiledConfig.header.vAlign)},footer:{title:resolve(compiledConfig.footer.title),height:resolve(compiledConfig.footer.height),style:Resolve.style(compiledConfig.footer.style,resolve),textStyle:Resolve.textStyle(compiledConfig.footer.textStyle,resolve),borderStyle:Resolve.lineStyle(compiledConfig.footer.style,resolve),padding:Resolve.paddings(compiledConfig.footer.padding,resolve),hAlign:resolve(compiledConfig.footer.hAlign),vAlign:resolve(compiledConfig.footer.vAlign)},palette:Array.isArray(compiledConfig.palette)?compiledConfig.palette.map(resolve).filter((function(x){return x})):resolve(compiledConfig.palette),plotAreas:compiledConfig.plotAreas.map((function(plotArea,pi){return{axes:plotArea.axes.map((function(axis,ai){return{axisLine:resolve(axis.axisLine),dateMode:resolve(axis.dateMode),format:resolve(axis.format),height:resolve(axis.height),labelAngle:[resolve(axis.labelAngle)],reversed:resolve(axis.reversed),logBase:resolve(axis.logBase),labelStyle:Resolve.labelStyle(axis.labelStyle,resolve),labels:resolve(axis.labels),labelTemplate:model.config.plotAreas[pi].axes[ai].labelTemplate?"{"+Utils.hashCode(model.config.plotAreas[pi].axes[ai].labelTemplate)+".value}":null,lineStyle:Resolve.lineStyle(axis.lineStyle,resolve),majorGrid:resolve(axis.majorGrid),majorGridStyle:Resolve.lineStyle(axis.majorGridStyle,resolve),majorTicks:resolve(axis.majorTicks),majorTickStyle:Resolve.lineStyle(axis.majorTickStyle,resolve),majorTickSize:Utils.toPx(resolve(axis.majorTickSize)),majorUnit:Utils.tryConvertToNumber(resolve(axis.majorUnit)),max:Utils.tryConvertToNumber(resolve(axis.max)),maxHeight:resolve(axis.maxHeight),maxWidth:resolve(axis.maxWidth),min:Utils.tryConvertToNumber(resolve(axis.min)),minorGrid:resolve(axis.minorGrid),minorGridStyle:Resolve.lineStyle(axis.minorGridStyle,resolve),minorTicks:resolve(axis.minorTicks),minorTickStyle:Resolve.lineStyle(axis.minorTickStyle,resolve),minorTickSize:Utils.toPx(resolve(axis.minorTickSize)),minorUnit:Utils.tryConvertToNumber(resolve(axis.minorUnit)),origin:Utils.tryConvertToNumber(resolve(axis.origin)),overlappingLabels:resolve(axis.overlappingLabels),plots:axis.plots.map((function(plot){return resolve(plot)})),position:resolve(axis.position),scale:{type:resolve(axis.scale.type)},textStyle:Resolve.textStyle(axis.textStyle,resolve),title:resolve(axis.title),titleStyle:Resolve.titleStyle(axis.titleStyle,resolve),type:resolve(axis.type),width:resolve(axis.width)}})),legends:plotArea.legends.map((function(legend){return{orientation:resolve(legend.orientation),position:resolve(legend.hidden)?"None":resolve(legend.position),textStyle:Resolve.textStyle(legend.textStyle,resolve),titleStyle:Resolve.textStyle(legend.titleStyle,resolve),style:Resolve.legendStyle(legend.style,resolve),borderStyle:Resolve.lineStyle(legend.style,resolve),padding:Resolve.paddings(legend.padding,resolve),title:resolve(legend.title),type:resolve(legend.type),gradient:{enabled:!1},template:resolve(legend.template),maxHeight:resolve(legend.maxHeight),maxWidth:resolve(legend.maxWidth),ranges:legend.ranges.length>0?legend.ranges.map((function(_a){var to=_a.to,title=_a.title;return{to:resolve(to),title:resolve(title)}})):null}})),legend:{orientation:resolve(plotArea.legend.orientation),position:resolve(plotArea.legend.hidden)?"None":resolve(plotArea.legend.position),textStyle:Resolve.textStyle(plotArea.legend.textStyle,resolve),titleStyle:Resolve.textStyle(plotArea.legend.titleStyle,resolve),style:Resolve.style(plotArea.legend.style,resolve),borderStyle:Resolve.lineStyle(plotArea.legend.style,resolve),padding:Resolve.paddings(plotArea.legend.padding,resolve),wrapping:resolve(plotArea.legend.wrapping)},style:Resolve.backgroundStyle(plotArea.style,resolve),borderStyle:Resolve.lineStyle(plotArea.borderStyle,resolve),padding:Resolve.paddings(plotArea.padding,resolve)}}))},plots:compiledPlots.map((function(plot,plotIndex){var textTemplate=resolve(plot.config.text.template),tooltipTemplate=resolve(plot.config.tooltip.template),compiledPlot={name:plot.name,type:plot.type,config:{bar:{bottomWidth:fixNaN(resolve(plot.config.bar.bottomWidth)),neckHeight:fixNaN(resolve(plot.config.bar.neckHeight)),overlap:fixNaN(resolve(plot.config.bar.overlap)),topWidth:fixNaN(resolve(plot.config.bar.topWidth)),width:fixNaN(resolve(plot.config.bar.width))},clippingMode:resolve(plot.config.clippingMode),offset:resolve(plot.config.offset),innerRadius:resolve(plot.config.innerRadius),lineAspect:resolve(plot.config.lineAspect),axisMode:resolve(plot.config.axisMode),showNulls:resolve(plot.config.showNulls),startAngle:fixStartAngle(resolve(plot.config.startAngle)),style:Resolve.dataPointStyle(plot.config.style,resolve),swapAxes:resolve(plot.config.swapAxes),sweep:resolve(plot.config.sweep),symbols:fixSymbols(resolve(plot.config.symbols),plot.type),text:{connectingLine:Resolve.lineStyle(plot.config.text.connectingLine,resolve),linePosition:resolve(plot.config.text.linePosition),overlappingLabels:resolve(plot.config.text.overlappingLabels),position:resolve(plot.config.text.position),template:textTemplate,offset:resolve(plot.config.text.offset),style:Resolve.style(plot.config.text.style,resolve),textStyle:Resolve.textStyle(plot.config.text.textStyle,resolve),angle:resolve(plot.config.text.angle)},tooltip:{template:tooltipTemplate},rules:plot.config.rules.map((function(rule,ruleIndex){return{condition:model.plots[plotIndex].config.rules[ruleIndex].condition,type:resolve(rule.type),actions:rule.actions.map((function(action){return{targetElement:resolve(action.targetElement),properties:action.properties.map((function(prop){return Resolve.resolveRule(prop.name,prop.value,plot.config.style,resolve)}))}}))}})),overlays:plot.config.overlays.map((function(overlay){return Resolve.resolveOverlay(overlay,resolve)}))},encodings:Translate.encodings(plot.encodings,textTemplate,tooltipTemplate,plot.type)};return model.plots[plotIndex].config.unpivotData&&(compiledPlot=withUnpivotTransform(compiledPlot,plotIndex)),compiledPlot})),data:{values:dataScopes.map((function(dataScope){return __assign(__assign(__assign({commonField:""},Utils.mapValues(compiledData,(function(expression){return resolveCompiled(expression,dataScope)}))),Utils.mapValues(compiledActions,(function(action){return function(action,dataScope){var resolve=function(value){return resolveCompiled(value,dataScope)},bookmarkLink=""+resolve(action.BookmarkLink);return{BookmarkLink:bookmarkLink?"bm_"+encodeURIComponent(bookmarkLink):"",Hyperlink:resolve(action.Hyperlink),Drillthrough:{ReportName:resolve(action.Drillthrough.ReportName),Parameters:action.Drillthrough.Parameters.map((function(p){return{ParameterName:p.ParameterName,Value:resolve(p.Value),Omit:resolve(p.Omit)}}))},ApplyParameters:{Parameters:action.ApplyParameters.Parameters.map((function(p){return __assign(__assign({},p),{Value:resolve(p.Value)})}))}}}(action,dataScope)}))),Utils.mapValues(compiledAxesLabelsTemplates,(function(labelTemplate){return resolveCompiled(labelTemplate,dataScope)})))})),dateFormats:!1},transform:transform}}}(function(definition,processInteractivity){var _a,_b,_c,_d,availablePlotNames=definition.Plots.map((function(plot){return plot.PlotName})),config={bar:{bottomWidth:definition.Bar.BottomWidth,neckHeight:definition.Bar.NeckHeight,overlap:definition.Bar.Overlap,topWidth:definition.Bar.TopWidth,width:definition.Bar.Width},header:{title:definition.Header.Title,height:void 0===definition.Header.Height?null:definition.Header.Height,style:Translate.style(definition.Header.Style),textStyle:Translate.textStyle(definition.Header.TextStyle),padding:Translate.paddings(definition.Header.Style),hAlign:definition.Header.HAlign,vAlign:definition.Header.VAlign},footer:{title:definition.Footer.Title,height:void 0===definition.Footer.Height?null:definition.Footer.Height,style:Translate.style(definition.Footer.Style),textStyle:Translate.textStyle(definition.Footer.TextStyle),padding:Translate.paddings(definition.Footer.Style),hAlign:definition.Footer.HAlign,vAlign:definition.Footer.VAlign},palette:"Custom"===definition.Palette?definition.CustomPalette:definition.Palette,plotAreas:[{axes:__spreadArrays(definition.PlotArea.Axes).sort((function(a,b){return a.AxisType.charCodeAt(0)-b.AxisType.charCodeAt(0)})).map((function(axis){return{axisLine:axis.AxisLine,dateMode:Translate.dateMode(axis.DateMode,axis.AxisType),format:axis.Format,height:axis.Height,labelAngle:axis.LabelAngle,reversed:axis.Reversed,logBase:axis.LogBase,labelStyle:Translate.labelStyle(axis.LabelStyle),labels:axis.Labels,labelTemplate:axis.LabelField,lineStyle:Translate.lineStyle(axis.LineStyle),majorGrid:axis.MajorGrid,majorGridStyle:Translate.lineStyle(axis.MajorGridStyle),majorTicks:axis.MajorTicks,majorTickStyle:Translate.lineStyle(axis.MajorTickStyle),majorTickSize:axis.MajorTickSize,majorUnit:axis.MajorUnit,max:axis.Max,maxHeight:axis.MaxHeight,maxWidth:axis.MaxWidth,min:axis.Min,minorGrid:axis.MinorGrid,minorGridStyle:Translate.lineStyle(axis.MinorGridStyle),minorTicks:axis.MinorTicks,minorTickStyle:Translate.lineStyle(axis.MinorTickStyle),minorTickSize:axis.MinorTickSize,minorUnit:axis.MinorUnit,origin:axis.Origin,overlappingLabels:axis.OverlappingLabels,plots:axis.Plots.filter((function(plotName){return availablePlotNames.indexOf(plotName)>-1})),position:axis.Position,scale:{type:axis.Scale},textStyle:Translate.textStyle(axis.TextStyle),title:axis.Title,titleStyle:Translate.titleStyle(axis.TitleStyle),type:axis.AxisType,width:axis.Width}})),legends:definition.PlotArea.Legends.map((function(legend){return{hidden:legend.Hidden,orientation:legend.Orientation,position:legend.Position,style:Translate.legendStyle(legend.Style,"Color"!==legend.LegendType?legend.IconColor:null),textStyle:Translate.textStyle(legend.TextStyle),titleStyle:Translate.textStyle(legend.TitleStyle),padding:Translate.paddings(legend.Style),title:legend.Title,type:legend.LegendType,template:"Size"===legend.LegendType?"{from:g}-{to:g}":"{value:g}",maxHeight:legend.MaxHeight,maxWidth:legend.MaxWidth,ranges:legend.RangeOptions.map((function(_a){var To=_a.To,Title=_a.Title;return{to:To,title:""===Title?null:Title}})).sort((function(a,b){return a.to-b.to}))}})),legend:{hidden:definition.Legend.Hidden,orientation:definition.Legend.Orientation,position:definition.Legend.Position,textStyle:Translate.textStyle(definition.Legend.TextStyle),titleStyle:Translate.textStyle(definition.Legend.TitleStyle),style:Translate.style(definition.Legend.Style),padding:Translate.paddings(definition.Legend.Style),wrapping:definition.Legend.Wrapping},style:Translate.backgroundStyle(definition.PlotArea.Style),borderStyle:Translate.lineStyle(definition.PlotArea.Style),padding:Translate.paddings(definition.PlotArea.Style)}]},plots=definition.Plots.map((function(plot){return function(plot,processInteractivity){var _a,_b,_c,_d,_e,_f,result={name:plot.PlotName,type:plot.PlotType,config:{action:plot.Config.Action,bar:{bottomWidth:null!==(_a=plot.Config.Bar.BottomWidth)&&void 0!==_a?_a:null,neckHeight:null!==(_b=plot.Config.Bar.NeckHeight)&&void 0!==_b?_b:null,overlap:null!==(_c=plot.Config.Bar.Overlap)&&void 0!==_c?_c:null,topWidth:null!==(_d=plot.Config.Bar.TopWidth)&&void 0!==_d?_d:null,width:null!==(_e=plot.Config.Bar.Width)&&void 0!==_e?_e:null},clippingMode:plot.Config.ClippingMode,offset:plot.Config.Offset,innerRadius:plot.Config.InnerRadius,lineAspect:plot.Config.LineAspect,axisMode:translateAxisMode(plot.Config.AxisMode,plot.Config.Radial),showNulls:plot.Config.ShowNulls,startAngle:plot.Config.StartAngle,style:Translate.dataPointStyle(plot.Config),swapAxes:plot.Config.SwapAxes,sweep:plot.Config.Sweep,symbols:plot.Config.Symbols,useGlobalLegend:!!(null===(_f=plot.Encodings.Color.Field.Value[0])||void 0===_f?void 0:_f.toString().includes("VALUESNAME")),unpivotData:plot.Config.UnpivotData,text:{connectingLine:Translate.lineStyle(plot.Config.Text.ConnectingLine),linePosition:plot.Config.Text.LinePosition,overlappingLabels:plot.Config.Text.OverlappingLabels,position:plot.Config.Text.TextPosition,template:plot.Config.Text.Template||null,offset:plot.Config.Text.Offset,style:Translate.style(plot.Config.Text.Style),textStyle:Translate.textStyle(plot.Config.Text.Style),angle:0},tooltip:{template:plot.Config.Tooltip.Template},overlays:plot.Config.Overlays.map((function(overlay){return{label:"ReferenceLine"!==overlay.OverlayType&&overlay.LegendLabel?overlay.LegendLabel:null,legendText:"ReferenceLine"===overlay.OverlayType&&overlay.LegendLabel?overlay.LegendLabel:null,type:overlay.OverlayType,display:overlay.Display,style:Translate.overlayStyle(overlay.Style),field:Translate.getOverlayField(overlay.Field),detailLevel:overlay.DetailLevel,axis:overlay.Axis,aggregate:overlay.AggregateType,start:overlay.Start,end:overlay.End,order:overlay.Order,period:overlay.Period,intercept:overlay.Intercept,forecast:{backwardPeriod:overlay.BackwardForecastPeriod,forwardPeriod:overlay.ForwardForecastPeriod},value:overlay.Value||null}})),rules:processInteractivity?plot.Config.Rules.map((function(rule){return{condition:rule.Condition,type:"DataPoint",actions:rule.RuleProperties.map((function(prop){return{targetElement:"DataPoint",properties:[{name:Translate.convertRuleTarget(prop.TargetProperty),value:prop.Value}]}}))}})):[]},encodings:plot.Encodings};if(plot.Config.BarLines){var _g=plot.Config.BarLineStyle||{},_h=_g.Color,Color=void 0===_h?"Black":_h,_j=_g.Style,Style=void 0===_j?"Solid":_j,_k=_g.Width,barLineOverlay={label:null,legendText:null,display:"Front",field:"",detailLevel:"Total",type:"BarLine",axis:"Y",start:1,end:1,order:2,period:2,aggregate:"Average",value:"",intercept:null,forecast:{backwardPeriod:0,forwardPeriod:0},style:{stroke:Color,strokeDasharray:Style,strokeWidth:void 0===_k?"1pt":_k,strokeOpacity:plot.Config.Opacity,fill:"black"}};result.config.overlays.push(barLineOverlay)}var plotPointers=plot.Config.Pointers;Array.isArray(plotPointers)&&plotPointers.forEach((function(pointer){var needleOverlay={type:"Needle",display:"Front",start:"center",end:pointer.End,width:pointer.NeedleWidth,style:{stroke:"none",opacity:plot.Config.Opacity,fill:pointer.Style.BackgroundColor}},ellipseOverlay={type:"Ellipse",display:"Front",pointPath:"center",position:"Center",width:pointer.NeedlePinWidth,height:pointer.NeedlePinWidth,style:{stroke:"none",opacity:plot.Config.Opacity,fill:pointer.Style.BackgroundColor}};result.config.overlays.push(needleOverlay,ellipseOverlay)}));var plotLabels=plot.Config.CustomLabels;Array.isArray(plotLabels)&&plotLabels.forEach((function(label){var textOverlay={type:"Text",display:"Front",pointPath:"center",position:"Center",text:label.Text,offset:[label.OffsetX,label.OffsetY],textStyle:{fontStyle:label.Style.FontStyle,fontSize:label.Style.FontSize,fontFamily:label.Style.FontFamily,fontWeight:label.Style.FontWeight,color:label.Style.Color,textDecoration:label.Style.TextDecoration,writingMode:label.Style.WritingMode}};result.config.overlays.push(textOverlay)}));return result}(plot,processInteractivity)})),colorLegends=config.plotAreas[0].legends.filter((function(l){return"Color"==l.type})),colorLegend=colorLegends[0],plotsWithColorLegend=plots.filter((function(plot){return"HighLowOpenClose"!==plot.type&&"Candlestick"!==plot.type}));colorLegend&&plotsWithColorLegend.length>1?plotsWithColorLegend.forEach((function(e,i){colorLegends.length<=i&&config.plotAreas[0].legends.push(__assign({},colorLegend))})):!colorLegend&&plotsWithColorLegend.length>=1&&plotsWithColorLegend.forEach((function(){config.plotAreas[0].legends.push(__assign(__assign({},mockLegend),{type:"Color"}))}));return plots.forEach((function(_a,i){var _b=_a.config,useGlobalLegend=_b.useGlobalLegend,unpivotData=_b.unpivotData,colorLegendCounter=0;config.plotAreas[0].legends.forEach((function(legend,k){"Color"===legend.type&&(colorLegendCounter===i&&useGlobalLegend&&(config.plotAreas[0].legends[k]=__assign(__assign(__assign(__assign({},mockLegend),{type:"Color",title:null}),config.plotAreas[0].legend),{style:__assign(__assign({},config.plotAreas[0].legend.style),{iconColor:null})}),unpivotData&&(config.plotAreas[0].legends[k].titleStyle.fontSize="0px")),colorLegendCounter++)}))})),null===(_c=config.plotAreas[0].axes.find((function(axis){return"X"===axis.type})))||void 0===_c||(_a=_c.plots).push.apply(_a,availablePlotNames.filter((function(plotName){return!config.plotAreas[0].axes.some((function(axis){return"X"===axis.type&&axis.plots.includes(plotName)}))}))),null===(_d=config.plotAreas[0].axes.find((function(axis){return"Y"===axis.type})))||void 0===_d||(_b=_d.plots).push.apply(_b,availablePlotNames.filter((function(plotName){return!config.plotAreas[0].axes.some((function(axis){return"Y"===axis.type&&axis.plots.includes(plotName)}))}))),{config:config,plots:plots}}(definition,processInteractivity),compileConfig,compileData,processInteractivity)};function translateAxisMode(axisMode,radial){return axisMode||(radial?"Radial":"Cartesian")}var mockLegend={hidden:!1,orientation:"Vertical",position:"Right",textStyle:{color:"Black",fontFamily:"Arial",fontSize:"10pt",fontStyle:"Normal",fontWeight:"Normal",textDecoration:"None"},titleStyle:{color:"Black",fontFamily:"Arial",fontSize:"10pt",fontStyle:"Normal",fontWeight:"Normal",textDecoration:"None"},style:{borderStyle:{stroke:"Black",strokeWidth:"0pt",strokeDasharray:""},stroke:"Black",strokeWidth:"0pt",strokeDasharray:"",backgroundColor:"Transparent",fill:"Transparent",iconColor:null},padding:{left:"0pt",right:"0pt",top:"0pt",bottom:"0pt"},title:"",template:"{value:g}",maxHeight:1,maxWidth:1,ranges:[]};function resolveCompiled(compiled,dataScope){return"function"==typeof compiled?compiled(dataScope):compiled}function compileAction(action,compileData){return{BookmarkLink:Utils.isExpression(action.BookmarkLink)?compileData(action.BookmarkLink,"Action.BookmarkLink"):action.BookmarkLink,Hyperlink:Utils.isExpression(action.Hyperlink)?compileData(action.Hyperlink,"Action.Hyperlink"):action.Hyperlink,Drillthrough:{ReportName:Utils.isExpression(action.Drillthrough.ReportName)?compileData(action.Drillthrough.ReportName,"Action.Drillthrough.ReportName"):action.Drillthrough.ReportName,Parameters:action.Drillthrough.Parameters.map((function(p,i){return{ParameterName:p.ParameterName,Value:Utils.isExpression(p.Value)?compileData(p.Value,"Action.Drillthrough.Parameters["+i+"].Value"):p.Value,Omit:Utils.isExpression(p.Omit)?compileData(p.Omit,"Action.Drillthrough.Parameters["+i+"].Omit"):p.Omit}}))},ApplyParameters:{Parameters:action.ApplyParameters.Parameters.map((function(p,i){return __assign(__assign({},p),{Value:Utils.isExpression(p.Value)?compileData(p.Value,"Action.ApplyParameters.Parameters["+i+"].Value"):p.Value})}))}}}function fixStartAngle(resolvedStartAngle){var startAngle=Utils.tryConvertToNumber(resolvedStartAngle);return"number"==typeof startAngle?startAngle-90:resolvedStartAngle}function fixSymbols(resolvedSymbols,plotType){return"Scatter"===plotType||resolvedSymbols}var fixNaN=function(value){return"number"==typeof value&&isNaN(value)?null:value};const getGenericPath=path=>null==path?void 0:path.replace(/\[\d+\]/g,"[]");function makeLayout$3(model,width,height,data,ctx,render,paramRefs){const resolvedLanguage=resolveCompiled$1(model.Style.Language,data),formatLanguage=resolvedLanguage&&"Default"!==resolvedLanguage?resolvedLanguage.toString():ctx.Language,listData=data.Regions[0],viewModel=model.Model(listData.Scope,function(collection){if(Array.isArray(collection))return collection;const array=[];for(let i=0;i<collection.length;i++)array[i]=GetCollectionItem(collection,i);return array}(listData.Groups)),params=paramRefs.map((([expression,value])=>[expression,safeResolveCompiledData(value,listData.Scope)]));return function(chart,width,height,renderDVChart){return L2.StaticClipped(width,height,renderDVChart)}(0,width,height,(itemViewSize=>render(itemViewSize,viewModel,formatLanguage,resolveItemCommon(model,listData.Scope,ctx),params)))}const toNativeDate=compiledValue=>{if("function"!=typeof compiledValue)return dateTimeFactory_isDateTime(compiledValue)?compiledValue.toDate():compiledValue;const dynamicData=compiledValue;return(data,ctx)=>{const runtime=dynamicData(data,ctx);if("function"!=typeof runtime)return dateTimeFactory_isDateTime(runtime)?runtime.toDate():runtime;const dynamicRuntime=runtime;return globals=>{const result=dynamicRuntime(globals);return dateTimeFactory_isDateTime(result)?result.toDate():result}}},toDynamicValue=compiledValue=>{if("function"!=typeof compiledValue)return compiledValue;const dynamicData=compiledValue;return(data,ctx)=>{const runtime=dynamicData(data,ctx);return"function"!=typeof runtime?runtime:null}};var dvchart=dataRegion((function(definition,context){return __awaiter(this,void 0,void 0,(function*(){const contentQuery={Fields:[],Regions:[]},groupContentQuery={Fields:[],Regions:[]},comp=function(comp){const exprCompiler=createTypedCompiler(comp);return(value,path)=>{switch(getGenericPath(path)){case"model.plots[].overlays[].text":return exprCompiler.compileString(value);default:return comp(value)}}}((value=>compileExpression(value,contentQuery.Fields,context.EvaluationContext))),compContent=(value,path)=>toNativeDate(toDynamicValue(comp(value,path))),compiled=function(definition,context,compConfig,compData){const compiledModel=_default(definition,compConfig,compData,!0);return{Type:"dvchart",Name:context.ReportID+definition.Name,Label:compConfig(definition.Label),Bookmark:compConfig(definition.Bookmark),Tooltip:compConfig(definition.ToolTip),Model:compiledModel,Style:{Language:compConfig(definition.Style.Language)}}}(definition,context,compContent,(value=>toNativeDate(toDynamicValue(compileExpression(value,groupContentQuery.Fields,context.EvaluationContext))))),compiledParameterRefs=function(definition){const expressions=[],traverseTree=node=>{"variable"===node.Token.type&&node.Token.value.match(/parameters[\.!].+\.value/i)&&expressions.push(`=${node.Token.value}`),node.Children.forEach(traverseTree)};return definition.Plots.forEach((plot=>{plot.Config.Rules.forEach((rule=>{const tree=treeBuilder$2(rule.Condition);traverseTree(tree)}))})),expressions}(definition).map((p=>[p,compContent(p)])),chartDef=Def.Makers.List(definition.Name,contentQuery,(definition.Filters||[]).map((f=>({Expression:f.FilterExpression,Op:f.Operator,Values:f.FilterValues}))),Def.Makers.Group(definition.Name),[],groupContentQuery),{render:render}=makeRender$3(context.getResourceUri);return compileNoRowsMessage({Query:{Fields:[],Regions:[chartDef]},Layout:(data,ctx)=>actions=>(width,height)=>makeLayout$3(compiled,width,height,data,ctx,render,compiledParameterRefs),Styles:[],DocumentMap:(data,ctx)=>buildDocumentMap(definition.Name,compiled,context.DocumentMap,[])(data.Regions[0].Scope,ctx)},definition,context)}))}));const ORTHOGONAL_ROTATIONS=["Rotate90Degrees","Rotate270Degrees"];function getAlignOffset(maximumSize,paddingOneSide,paddingOppositeSide,barHeight){if(0===barHeight)return 0;const availablePlace=maximumSize-paddingOneSide-paddingOppositeSide;return availablePlace>barHeight?(availablePlace-barHeight)/2:0}function getPadding(barHeight,quietZoneTop,quietZoneLeft,quietZoneBottom,quietZoneRight,paddingTop,paddingLeft,paddingBottom,paddingRight,width,height,rotation,targetSide){return Length.toCss(getPaddings(barHeight,quietZoneTop,quietZoneLeft,quietZoneBottom,quietZoneRight,paddingTop,paddingLeft,paddingBottom,paddingRight,width,height,rotation)[targetSide])}function getPaddings(barHeight,quietZoneTop,quietZoneLeft,quietZoneBottom,quietZoneRight,paddingTop,paddingLeft,paddingBottom,paddingRight,width,height,rotation){const barHeightLen=Length.parse(barHeight),[quietZoneLeftLen,quietZoneTopLen,quietZoneRightLen,quietZoneBottomLen,paddingLeftLen,paddingTopLen,paddingRightLen,paddingBottomLen]=[quietZoneLeft,quietZoneTop,quietZoneRight,quietZoneBottom,paddingLeft,paddingTop,paddingRight,paddingBottom].map((l=>Length.parse(l)));let top,bottom,left,right,alignOffset;switch(rotation){case"Rotate90Degrees":top=quietZoneLeftLen,bottom=quietZoneRightLen,left=quietZoneBottomLen,right=quietZoneTopLen;break;case"Rotate180Degrees":top=quietZoneBottomLen,bottom=quietZoneTopLen,left=quietZoneRightLen,right=quietZoneLeftLen;break;case"Rotate270Degrees":top=quietZoneRightLen,bottom=quietZoneLeftLen,left=quietZoneTopLen,right=quietZoneBottomLen;break;default:top=quietZoneTopLen,bottom=quietZoneBottomLen,left=quietZoneLeftLen,right=quietZoneRightLen}return top+=paddingTopLen,left+=paddingLeftLen,bottom+=paddingBottomLen,right+=paddingRightLen,ORTHOGONAL_ROTATIONS.includes(rotation)?(alignOffset=getAlignOffset(Length.parse(width),left,right,barHeightLen),left+=alignOffset,right+=alignOffset):(alignOffset=getAlignOffset(Length.parse(height),top,bottom,barHeightLen),top+=alignOffset,bottom+=alignOffset),{top:top,left:left,bottom:bottom,right:right}}function buildRotationStyle(bcModel){const style={};return 90===bcModel.Angle?(style.transform="rotate(90deg)",style.transformOrigin="0px 0px",style.position="relative",style.left="100%"):180===bcModel.Angle?style.transform="rotate(180deg)":270===bcModel.Angle&&(style.transform="rotate(270deg)",style.transformOrigin="0px 0px",style.position="relative",style.top="100%"),style}function renderError(node,message){if(!document||!node)return;const errorStub=document.createElement("div");errorStub.className="arjs-errorMessage",errorStub.innerText=message,node.appendChild(errorStub)}function makeRender$2(model,i18n){const sb=styleBuilder(),paddingData=[model.Definition.BarHeight,model.Definition.QuietZone.Top,model.Definition.QuietZone.Left,model.Definition.QuietZone.Bottom,model.Definition.QuietZone.Right,model.Style.PaddingTop,model.Style.PaddingLeft,model.Style.PaddingBottom,model.Style.PaddingRight,model.Definition.Width,model.Definition.Height,model.Definition.Rotation];sb.add("paddingLeft",[...paddingData,"left"],getPadding),sb.add("paddingRight",[...paddingData,"right"],getPadding),sb.add("paddingTop",[...paddingData,"top"],getPadding),sb.add("paddingBottom",[...paddingData,"bottom"],getPadding);const style=sb.style,className=`${model.Name}Style`;return{render:(data,ctx,itemViewSize,bcModel)=>function(className,style,itemViewSize,renderContext,model,bcModel,i18n){const styleAndSize=Object.assign(Object.assign({},style.style),buildSizeStyle(itemViewSize)),{patcher:patcher,id:id}=createStylePatcher(renderContext,style),renderBarcode=(node,mdl)=>{if("None"!==mdl.Symbology)if(mdl.Model)try{new Barcode(node,mdl.Model)}catch(ex){console.warn("[barcodejs]",mdl.Symbology+":",ex instanceof Error?ex.message:`${ex}`),renderError(node,mdl.ErrorMessage||i18n.t("core:default-invalid-barcode-text","ERROR"))}else console.warn("[barcodejs]",`${mdl.Symbology} barcodes are not supported by BarcodeJS`),renderError(node,i18n.t("core:barcode-symbology-not-supported",{defaultValue:'"{{symbology}}" is not supported',symbology:mdl.Symbology,interpolation:{escapeValue:!1}}))};let contentPatcher=null;const Hook=function(){};"function"!=typeof bcModel.Model?Hook.prototype.hook=node=>{node.onclick=()=>document.body.className.includes("arjs-dev-mode")&&console.log(JSON.stringify(bcModel.Model)),renderBarcode(node,bcModel)}:contentPatcher=globals=>(Hook.prototype.hook=node=>renderBarcode(node,Object.assign(Object.assign({},bcModel),{Model:bcModel.Model(globals)})),{id:null}),Hook.prototype.unhook=()=>{};const barcodeNode=h("div",{hook:new Hook,style:buildRotationStyle(bcModel),title:model.Tooltip},[]);return wrapSplittedItem(itemViewSize,h("div",{className:`arjs-itemContent arjs-barcode arjs-hideOverflow arjs-svgItem ${className}`,style:styleAndSize,patcher:joinPatchers(patcher,contentPatcher),id:id},[...buildAnchorNodes(model),barcodeNode]))}(className,style.dynamic(data),itemViewSize,ctx,resolveItemCommon(model,data,ctx),bcModel,i18n),styles:[{className:className,style:style.static}]}}var lib={},utils={};Object.defineProperty(utils,"__esModule",{value:!0}),utils.get=function get(obj,propertyName){if(null==obj)return obj;var path=propertyName.split("."),value=obj[path[0]];return 1===path.length?value:get(value,path.slice(1).join("."))},utils.set=function set(obj,propertyname,value){if("object"==typeof obj&&null!==obj){var path=propertyname.split(".");1===path.length?obj[path[0]]=value:("object"==typeof obj[path[0]]&&null!==obj[path[0]]||(obj[path[0]]={}),set(obj[path[0]],path.slice(1).join("."),value))}};var length={};Object.defineProperty(length,"__esModule",{value:!0});var twipsPer={in:1440,pt:20,pc:240,cm:566.9291338582677,mm:56.69291338582677};length.default={parse:function(length){var trimmed=length.trim(),units=trimmed.substr(-2).toLowerCase();if(!twipsPer[units])throw new Error("Unable to parse length: "+length);var stringVal=trimmed.substr(0,trimmed.length-2);if(!function(value){return!isNaN(value-parseFloat(value))}(stringVal))throw new Error("Unable to parse length: "+length);var value=parseFloat(stringVal);return Math.trunc(value*twipsPer[units])},toCss:function(twips){return Math.round(1e4*twips/20)/1e4+"pt"}};var __read=commonjsGlobal&&commonjsGlobal.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__spread=commonjsGlobal&&commonjsGlobal.__spread||function(){for(var ar=[],i=0;i<arguments.length;i++)ar=ar.concat(__read(arguments[i]));return ar};Object.defineProperty(lib,"__esModule",{value:!0});var _=utils,length_1=length,isLengthValid=function(l){try{length_1.default.parse(l)}catch(err){return!1}return!0},createMap=function(to,from,converter){return void 0===converter&&(converter=function(){for(var vals=[],_i=0;_i<arguments.length;_i++)vals[_i]=arguments[_i];return vals[0]}),{from:from,to:to,converter:converter}};function getText$2(value,minLength,maxLength){void 0===minLength&&(minLength=Number.MIN_VALUE),void 0===maxLength&&(maxLength=Number.MAX_VALUE);var dataString=""+value;return dataString.length<minLength?leftPadZero(dataString,minLength):dataString.length>maxLength?dataString.substr(0,maxLength):dataString}var valueOrUndefined=function(value){return value||void 0},leftPadZero=function(value,length){return"0".repeat(Math.max(0,length-value.length))+value},getPosition=function(location){return"Above"===location?"top":"bottom"},getShowLabel=function(location){return"None"!==location},getLinkageValue=function(value,type){return"None"!==type?value:""},getTopBottomQuietZone=function(quietZoneTargetSide,quietZoneOppositeSide,barcodeHeigth,barHeight){if(![quietZoneTargetSide,quietZoneOppositeSide,barcodeHeigth,barHeight].every(isLengthValid))return quietZoneTargetSide;var barHeigthLength=length_1.default.parse(barHeight);if(!barHeigthLength)return quietZoneTargetSide;var _a=__read([quietZoneTargetSide,quietZoneOppositeSide,barcodeHeigth].map((function(l){return length_1.default.parse(l)})),3),quietZoneTargetSideLength=_a[0],quietZoneOppositeSideLength=_a[1],offset=(_a[2]-quietZoneTargetSideLength-quietZoneOppositeSideLength-barHeigthLength)/2;return length_1.default.toCss(Math.max(0,quietZoneTargetSideLength+offset))},TextTextAlign={Right:"right",Left:"left"},TextDecoration={Underline:"underline",Overline:"overline",LineThrough:"line-through",UnderlineLineThrough:"underline line-through"},FontWeight={Lighter:"50",Thin:"100",ExtraLight:"200",Light:"300",Normal:"normal",Medium:"500",SemiBold:"600",Bold:"700",ExtraBold:"800",Heavy:"900",Bolder:"1000"},QrCodeMask={Auto:"auto",Mask000:"0",Mask001:"1",Mask010:"2",Mask011:"3",Mask100:"4",Mask101:"5",Mask110:"6",Mask111:"7"},getQrCodeMask=function(mask){return QrCodeMask[mask]},Charset={65001:"UTF-8",932:"Shift_JIS"},getCharset=function(encodingNum){return Charset[encodingNum]||"UTF-8"},Pdf417ErrorCorrectionLevel={Level0:"0",Level1:"1",Level2:"2",Level3:"3",Level4:"4",Level5:"5",Level6:"6",Level7:"7",Level8:"8"},DataMatrixEcc200SymbolSize={SquareAuto:"squareAuto",RectangularAuto:"rectangularAuto",Square10:"square10",Square12:"square12",Square14:"square14",Square16:"square16",Square18:"square18",Square20:"square20",Square22:"square22",Square24:"square24",Square26:"square26",Square32:"square32",Square36:"square36",Square40:"square40",Square44:"square44",Square48:"square48",Square52:"square52",Square64:"square64",Square72:"square72",Square80:"square80",Square88:"square88",Square96:"square96",Square104:"square104",Square120:"square120",Square132:"square132",Square144:"square144",Rectangular8x18:"rectangular8x18",Rectangular8x32:"rectangular8x32",Rectangular12x26:"rectangular12x26",Rectangular12x36:"rectangular12x36",Rectangular16x36:"rectangular16x36",Rectangular16x48:"rectangular16x48"},getDataMatrixEcc200SymbolSize=function(size){return DataMatrixEcc200SymbolSize[size]},DataMatrixEcc000140SymbolSize={Auto:"auto",Square9:"square9",Square11:"square11",Square13:"square13",Square15:"square15",Square17:"square17",Square19:"square19",Square21:"square21",Square23:"square23",Square25:"square25",Square27:"square27",Square29:"square29",Square31:"square31",Square33:"square33",Square35:"square35",Square37:"square37",Square39:"square39",Square41:"square41",Square43:"square43",Square45:"square45",Square47:"square47",Square49:"square49"},COMMON_MAP=[createMap("renderType",[],(function(){return"svg"})),createMap("color",["Style.Color"]),createMap("backgroundColor",["Style.BackgroundColor"]),createMap("hideExtraChecksum",[],(function(){return!0})),createMap("desiredSize.width",["Width"]),createMap("desiredSize.height",["Height"]),createMap("font.fontFamily",["Style.FontFamily"]),createMap("font.fontStyle",["Style.FontStyle"]),createMap("font.fontWeight",["Style.FontWeight"],(function(fontWeight){return FontWeight[fontWeight]})),createMap("font.fontSize",["Style.FontSize"]),createMap("font.textDecoration",["Style.TextDecoration"],(function(textDecoration){return TextDecoration[textDecoration]||"none"})),createMap("font.textAlign",["Style.TextAlign"],(function(align){return TextTextAlign[align]||"center"})),createMap("quietZone.left",["QuietZone.Left"]),createMap("quietZone.right",["QuietZone.Right"]),createMap("quietZone.top",["QuietZone.Top","QuietZone.Bottom","Height","BarHeight"],getTopBottomQuietZone),createMap("quietZone.bottom",["QuietZone.Bottom","QuietZone.Top","Height","BarHeight"],getTopBottomQuietZone)],AZTEC_CODE_MAP=[createMap("type",["Symbology"],(function(){return"AztecCode"})),createMap("text",["Value"],(function(value){return getText$2(value)})),createMap("errorCorrection",["AztecOptions.ErrorCorrection"]),createMap("symbolSize",["AztecOptions.Layers"],(function(value){return value>=0?value:-value+"*"})),createMap("charset",["AztecOptions.Encoding"],getCharset)],EAN_13_MAP=[createMap("type",["Symbology"],(function(){return"EAN13"})),createMap("text",["Value"],(function(value){return getText$2(value,0,13)})),createMap("showLabel",["CaptionLocation"],getShowLabel),createMap("labelPosition",["CaptionLocation"],getPosition),createMap("hideExtraChecksum",[],(function(){return!1})),createMap("addOn",["SupplementOptions.Value"],valueOrUndefined),createMap("addOnHeight",["SupplementOptions.BarHeight"],(function(height){return isLengthValid(height)&&length_1.default.parse(height)?height:"auto"})),createMap("addOnLabelPosition",["SupplementOptions.CaptionLocation"],getPosition),createMap("quietZone.addOn",["SupplementOptions.Spacing"])],EAN_8_MAP=[createMap("type",["Symbology"],(function(){return"EAN8"})),createMap("text",["Value"],(function(value){return getText$2(value,0,8)})),createMap("showLabel",["CaptionLocation"],getShowLabel),createMap("labelPosition",["CaptionLocation"],getPosition),createMap("hideExtraChecksum",[],(function(){return!1})),createMap("addOn",["SupplementOptions.Value"],valueOrUndefined),createMap("addOnHeight",["SupplementOptions.BarHeight"],(function(height){return isLengthValid(height)&&length_1.default.parse(height)?height:"auto"})),createMap("addOnLabelPosition",["SupplementOptions.CaptionLocation"],getPosition),createMap("quietZone.addOn",["SupplementOptions.Spacing"])],QR_CODE_MAP=[createMap("type",["Symbology"],(function(){return"QRCode"})),createMap("text",["Value"],(function(value){return getText$2(value)})),createMap("charset",["QrCodeOptions.Encoding"],getCharset),createMap("model",["QrCodeOptions.Model"],(function(model){return"Model1"===model?1:2})),createMap("version",["QrCodeOptions.Version"],(function(version){return version>0?version:"auto"})),createMap("errorCorrectionLevel",["QrCodeOptions.ErrorLevel"]),createMap("mask",["QrCodeOptions.Mask"],getQrCodeMask),createMap("connection",["QrCodeOptions.Connection"]),createMap("connectionNo",["QrCodeOptions.ConnectionNumber"])],GS1_DATA_MATRIX_MAP=[createMap("type",["Symbology"],(function(){return"GS1DataMatrix"})),createMap("text",["Value"],(function(value){return getText$2(value)})),createMap("unitSize",["NarrowBarWidth"],(function(value){return isValueNonZero(value)?value:null})),createMap("symbolSize",["DataMatrixOptions.Ecc200SymbolSize"],getDataMatrixEcc200SymbolSize),createMap("encodingMode",["DataMatrixOptions.Ecc200EncodingMode"],(function(mode){return"Auto"===mode?"auto":mode})),createMap("structuredAppend",["DataMatrixOptions.StructuredAppend"]),createMap("structureNumber",["DataMatrixOptions.StructureNumber"]),createMap("fileIdentifier",["DataMatrixOptions.FileIdentifier"])],GS1_QR_CODE_MAP=[createMap("type",["Symbology"],(function(){return"QRCode"})),createMap("text",["Value"],(function(value){return getText$2(value)})),createMap("charset",["QrCodeOptions.Encoding"],getCharset),createMap("version",["QrCodeOptions.Version"],(function(version){return version>0?version:"auto"})),createMap("errorCorrectionLevel",["QrCodeOptions.ErrorLevel"]),createMap("mask",["QrCodeOptions.Mask"],getQrCodeMask)],CODABAR_MAP=[createMap("type",["Symbology"],(function(){return"Codabar"})),createMap("text",["Value"],(function(value){return getText$2(value)})),createMap("showLabel",["CaptionLocation"],getShowLabel),createMap("labelPosition",["CaptionLocation"],getPosition),createMap("checkDigit",["CheckSum"]),createMap("nwRatio",["NWRation"],(function(ratio){return 3===ratio?3:2}))],CODE_39_MAP=[createMap("type",["Symbology"],(function(){return"Code39"})),createMap("text",["Value"],(function(value){return getText$2(value).toUpperCase()})),createMap("showLabel",["CaptionLocation"],getShowLabel),createMap("labelPosition",["CaptionLocation"],getPosition),createMap("checkDigit",["CheckSum"]),createMap("nwRatio",["NWRation"],(function(ratio){return 3===ratio?3:2})),createMap("fullASCII",[],(function(){return!1})),createMap("unitSize",["NarrowBarWidth"],(function(value){return isValueNonZero(value)?value:null})),createMap("desiredSize.width",["NarrowBarWidth"],(function(barWidth){return isValueNonZero(barWidth)?void 0:null}))],CODE_39_X_MAP=__spread(CODE_39_MAP,[createMap("text",["Value"],(function(value){return getText$2(value)})),createMap("fullASCII",[],(function(){return!0}))]),CODE_93_MAP=[createMap("type",["Symbology"],(function(){return"Code93"})),createMap("text",["Value"],(function(value){return getText$2(value)})),createMap("showLabel",["CaptionLocation"],getShowLabel),createMap("labelPosition",["CaptionLocation"],getPosition),createMap("checkDigit",["CheckSum"]),createMap("fullASCII",[],(function(){return!1}))],CODE_93_X_MAP=__spread(CODE_93_MAP,[createMap("fullASCII",[],(function(){return!0}))]),CODE_128_MAP=[createMap("type",["Symbology"],(function(){return"Code128"})),createMap("text",["Value"],(function(value){return getText$2(value)})),createMap("showLabel",["CaptionLocation"],getShowLabel),createMap("labelPosition",["CaptionLocation"],getPosition),createMap("codeSet",[],(function(){return"auto"}))],CODE_128_A_MAP=__spread(CODE_128_MAP,[createMap("codeSet",[],(function(){return"A"}))]),CODE_128_B_MAP=__spread(CODE_128_MAP,[createMap("codeSet",[],(function(){return"B"}))]),CODE_128_C_MAP=__spread(CODE_128_MAP,[createMap("codeSet",[],(function(){return"C"}))]),UCC_EAN_128_MAP=[createMap("type",["Symbology"],(function(){return"GS1_128"})),createMap("text",["Value"],(function(value){return getText$2(value)})),createMap("showLabel",["CaptionLocation"],getShowLabel),createMap("labelPosition",["CaptionLocation"],getPosition)],CODE_49_MAP=[createMap("type",["Symbology"],(function(){return"Code49"})),createMap("text",["Value"],(function(value){return getText$2(value)})),createMap("showLabel",["CaptionLocation"],getShowLabel),createMap("labelPosition",["CaptionLocation"],getPosition),createMap("grouping",["Code49Options.Grouping"]),createMap("groupNo",["Code49Options.GroupNumber"])],PDF_417_MAP=[createMap("type",["Symbology"],(function(){return"PDF417"})),createMap("text",["Value"],(function(value){return getText$2(value)})),createMap("errorCorrectionLevel",["Pdf417Options.ErrorCorrectionLevel"],(function(level){return Pdf417ErrorCorrectionLevel[level]})),createMap("columns",["Pdf417Options.Columns"],(function(col){return col>=0&&col<=30?col:"auto"})),createMap("rows",["Pdf417Options.Rows"],(function(row){return row>=3&&row<=90?row:"auto"})),createMap("compact",["Pdf417Options.Pdf417Type"],(function(type){return"Simple"===type}))],DATA_MATRIX_MAP=[createMap("type",["Symbology"],(function(){return"DataMatrix"})),createMap("text",["Value"],(function(value){return getText$2(value)})),createMap("eccMode",["DataMatrixOptions.EccMode"]),createMap("ecc200SymbolSize",["DataMatrixOptions.Ecc200SymbolSize"],getDataMatrixEcc200SymbolSize),createMap("ecc200EncodingMode",["DataMatrixOptions.Ecc200EncodingMode"],(function(mode){return"Auto"===mode?"auto":mode})),createMap("ecc000140SymbolSize",["DataMatrixOptions.Ecc000_140SymbolSize"],(function(size){return DataMatrixEcc000140SymbolSize[size]})),createMap("structuredAppend",["DataMatrixOptions.StructuredAppend"]),createMap("structureNumber",["DataMatrixOptions.StructureNumber"]),createMap("fileIdentifier",["DataMatrixOptions.FileIdentifier"])],ITF_14_MAP=[createMap("type",["Symbology"],(function(){return"ITF-14"})),createMap("text",["Value"],(function(value){return getText$2(value,13,14)})),createMap("height",["SupplementOptions.BarHeight"],(function(height){return isLengthValid(height)&&length_1.default.parse(height)?height:"auto"})),createMap("showLabel",["CaptionLocation"],getShowLabel),createMap("labelPosition",["CaptionLocation"],getPosition),createMap("hideExtraChecksum",[],(function(){return!1})),createMap("nwRatio",["NWRation"],(function(ratio){return 3===ratio?3:2}))],UPC_A_MAP=[createMap("type",["Symbology"],(function(){return"UPC-A"})),createMap("text",["Value"],(function(value){return getText$2(value,0,12)})),createMap("height",["SupplementOptions.BarHeight"],(function(height){return isLengthValid(height)&&length_1.default.parse(height)?height:"auto"})),createMap("showLabel",["CaptionLocation"],getShowLabel),createMap("labelPosition",["CaptionLocation"],getPosition),createMap("nwRatio",["NWRation"],(function(ratio){return 3===ratio?3:2})),createMap("addOn",["SupplementOptions.Value"],valueOrUndefined),createMap("addOnHeight",["SupplementOptions.BarHeight"],(function(height){return isLengthValid(height)&&length_1.default.parse(height)?height:"auto"})),createMap("addOnLabelPosition",["SupplementOptions.CaptionLocation"],getPosition),createMap("quietZone.addOn",["SupplementOptions.Spacing"]),createMap("hideExtraChecksum",[],(function(){return!1}))],UPC_E0_MAP=[createMap("type",["Symbology"],(function(){return"UPC-E0"})),createMap("text",["Value"],(function(value){return getText$2(value,0,6)})),createMap("height",["SupplementOptions.BarHeight"],(function(height){return isLengthValid(height)&&length_1.default.parse(height)?height:"auto"})),createMap("showLabel",["CaptionLocation"],getShowLabel),createMap("labelPosition",["CaptionLocation"],getPosition),createMap("nwRatio",["NWRation"],(function(ratio){return 3===ratio?3:2})),createMap("addOn",["SupplementOptions.Value"],valueOrUndefined),createMap("addOnHeight",["SupplementOptions.BarHeight"],(function(height){return isLengthValid(height)&&length_1.default.parse(height)?height:"auto"})),createMap("addOnLabelPosition",["SupplementOptions.CaptionLocation"],getPosition),createMap("quietZone.addOn",["SupplementOptions.Spacing"]),createMap("hideExtraChecksum",[],(function(){return!1}))],UPC_E1_MAP=[createMap("type",["Symbology"],(function(){return"UPC-E1"})),createMap("text",["Value"],(function(value){return getText$2(value,0,6)})),createMap("height",["SupplementOptions.BarHeight"],(function(height){return isLengthValid(height)&&length_1.default.parse(height)?height:"auto"})),createMap("showLabel",["CaptionLocation"],getShowLabel),createMap("labelPosition",["CaptionLocation"],getPosition),createMap("hideExtraChecksum",[],(function(){return!1})),createMap("nwRatio",["NWRation"],(function(ratio){return 3===ratio?3:2})),createMap("addOn",["SupplementOptions.Value"],valueOrUndefined),createMap("addOnHeight",["SupplementOptions.BarHeight"],(function(height){return isLengthValid(height)&&length_1.default.parse(height)?height:"auto"})),createMap("addOnLabelPosition",["SupplementOptions.CaptionLocation"],getPosition),createMap("quietZone.addOn",["SupplementOptions.Spacing"])],CODE_2_5_INTLV_MAP=[createMap("type",["Symbology"],(function(){return"Interleaved2of5"})),createMap("text",["Value"],(function(value){return getText$2(value,0,16)})),createMap("height",["SupplementOptions.BarHeight"],(function(height){return isLengthValid(height)&&length_1.default.parse(height)?height:"auto"})),createMap("showLabel",["CaptionLocation"],getShowLabel),createMap("labelPosition",["CaptionLocation"],getPosition),createMap("nwRatio",["NWRation"],(function(ratio){return 3===ratio?3:2}))];function isValueNonZero(value){return!!value&&(value.length>0&&length_1.default.parse(value)>0)}function getGS1DataBarText(value){var text=getText$2(value);if(!/\(|\)/.test(text)){if(text.length>=15){var chars=__spread(text);return chars.splice(0,0,"("),chars.splice(3,0,")"),chars.join("")}return"(01)"+getText$2(value,13,14)}return text}function getLinkageHeight(barHeight,height){return isLengthValid(barHeight)&&length_1.default.parse(barHeight)>0?length_1.default.toCss(length_1.default.parse(barHeight)/4):isLengthValid(height)&&length_1.default.parse(height)>0?length_1.default.toCss(length_1.default.parse(height)/4):"auto"}var GS1_LINKAGE_MAP=[createMap("linkage",["Gs1CompositeOptions.Value","Gs1CompositeOptions.CompositeType"],getLinkageValue),createMap("linkageVersion",["Gs1CompositeOptions.CompositeType"],(function(type){return"None"!==type?type:"CCA"})),createMap("hideLinkageText",[],(function(){return!0})),createMap("linkageHeight",["BarHeight","Height"],getLinkageHeight),createMap("desiredSize.height",["BarHeight","Height","Gs1CompositeOptions.Value","Gs1CompositeOptions.CompositeType"],(function(barHeight,height,linkageValue,linkageType){if(!getLinkageValue(linkageValue,linkageType))return height;var linkageHeight=getLinkageHeight(barHeight,height);return"auto"!==linkageHeight?length_1.default.toCss(length_1.default.parse(height)-length_1.default.parse(linkageHeight)):height}))],MAPPING={Aztec:AZTEC_CODE_MAP,EAN_13:EAN_13_MAP,EAN_8:EAN_8_MAP,QRCode:QR_CODE_MAP,GS1DataMatrix:GS1_DATA_MATRIX_MAP,GS1QRCode:GS1_QR_CODE_MAP,Codabar:CODABAR_MAP,Code39:CODE_39_MAP,Code39x:CODE_39_X_MAP,Code_93:CODE_93_MAP,Code93x:CODE_93_X_MAP,Code_128auto:CODE_128_MAP,Code_128_A:CODE_128_A_MAP,Code_128_B:CODE_128_B_MAP,Code_128_C:CODE_128_C_MAP,UCCEAN128:UCC_EAN_128_MAP,Code49:CODE_49_MAP,Pdf417:PDF_417_MAP,DataMatrix:DATA_MATRIX_MAP,ITF14:ITF_14_MAP,UPC_A:UPC_A_MAP,UPC_E0:UPC_E0_MAP,UPC_E1:UPC_E1_MAP,Code25intlv:CODE_2_5_INTLV_MAP,RSS14:[createMap("type",["Symbology"],(function(){return"GS1 DataBar Omnidirectional"})),createMap("text",["Value"],(function(value){return getGS1DataBarText(value)})),createMap("height",["SupplementOptions.BarHeight"],(function(height){return isLengthValid(height)&&length_1.default.parse(height)?height:"auto"})),createMap("showLabel",["CaptionLocation"],getShowLabel),createMap("labelPosition",["CaptionLocation"],getPosition),createMap("hideExtraChecksum",[],(function(){return!1})),createMap("hideAIText",["CaptionGrouping"],(function(value){return!value}))],RSSLimited:__spread([createMap("type",["Symbology"],(function(){return"GS1 DataBar Limited"})),createMap("text",["Value"],(function(value){return getGS1DataBarText(value)})),createMap("height",["SupplementOptions.BarHeight"],(function(height){return isLengthValid(height)&&length_1.default.parse(height)?height:"auto"})),createMap("showLabel",["CaptionLocation"],getShowLabel),createMap("labelPosition",["CaptionLocation"],getPosition),createMap("hideExtraChecksum",[],(function(){return!1})),createMap("hideAIText",["CaptionGrouping"],(function(value){return!value}))],GS1_LINKAGE_MAP),RSS14Truncated:[createMap("type",["Symbology"],(function(){return"GS1 DataBar Truncated"})),createMap("text",["Value"],(function(value){return getGS1DataBarText(value)})),createMap("height",["SupplementOptions.BarHeight"],(function(height){return isLengthValid(height)&&length_1.default.parse(height)?height:"auto"})),createMap("showLabel",["CaptionLocation"],getShowLabel),createMap("labelPosition",["CaptionLocation"],getPosition),createMap("hideExtraChecksum",[],(function(){return!1})),createMap("hideAIText",["CaptionGrouping"],(function(value){return!value}))],RSS14Stacked:__spread([createMap("type",["Symbology"],(function(){return"GS1 DataBar Stacked"})),createMap("text",["Value"],(function(value){return getGS1DataBarText(value)})),createMap("height",["SupplementOptions.BarHeight"],(function(height){return isLengthValid(height)&&length_1.default.parse(height)?height:"auto"})),createMap("showLabel",["CaptionLocation"],getShowLabel),createMap("labelPosition",["CaptionLocation"],getPosition),createMap("hideExtraChecksum",[],(function(){return!1})),createMap("hideAIText",["CaptionGrouping"],(function(value){return!value}))],GS1_LINKAGE_MAP),RSS14StackedOmnidirectional:[createMap("type",["Symbology"],(function(){return"GS1 DataBar StackedOmnidirectional"})),createMap("text",["Value"],(function(value){return getGS1DataBarText(value)})),createMap("height",["SupplementOptions.BarHeight"],(function(height){return isLengthValid(height)&&length_1.default.parse(height)?height:"auto"})),createMap("showLabel",["CaptionLocation"],getShowLabel),createMap("labelPosition",["CaptionLocation"],getPosition),createMap("hideExtraChecksum",[],(function(){return!1})),createMap("hideAIText",["CaptionGrouping"],(function(value){return!value}))],JapanesePostal:[createMap("type",["Symbology"],(function(){return"Japanese Postal"})),createMap("text",["Value"],(function(value){return getText$2(value)})),createMap("height",["SupplementOptions.BarHeight"],(function(height){return isLengthValid(height)&&length_1.default.parse(height)?height:"auto"})),createMap("showLabel",["CaptionLocation"],getShowLabel),createMap("labelPosition",["CaptionLocation"],getPosition)]},getMapping=function(symbology){return MAPPING[LegacyMapping[symbology]||symbology]};lib.isSymbologySupported=function(symbology){return!!getMapping(symbology)};var translateBarcodeModel_1=lib.translateBarcodeModel=function(romBarcodeModel){var mapping=getMapping(romBarcodeModel.Symbology);if(!mapping)return null;var viewModel={},applyMapping=function(map){var romValues=map.from.map((function(value){return _.get(romBarcodeModel,value)})),viewModelValue=map.converter.apply(map,__spread(romValues));null!==viewModelValue&&_.set(viewModel,map.to,viewModelValue)};return COMMON_MAP.forEach(applyMapping),mapping.forEach(applyMapping),viewModel},LegacyMapping={Code2of5:"Code_2_of_5",Code2of5Interleaved:"Code25intlv",Matrix2of5:"Matrix_2_of_5",Code39Extended:"Code39x",Code128A:"Code_128_A",Code128B:"Code_128_B",Code128C:"Code_128_C",Code128Auto:"Code_128auto",Ansi39:"Code39",Code93:"Code_93",Code93Extended:"Code93x",Ansi39x:"Code39x",MsiPlessey:"MSI",Postnet:"PostNet",Ean8:"EAN_8",Ean13:"EAN_13",UpcA:"UPC_A",UpcE:"UPC_E0",RoyalMail4Scc:"RM4SCC",UccEan128:"UCCEAN128",PDF417:"Pdf417",Ean128Fnc1:"EAN128FNC1",Code11:"Code_11",SSCC18:"SSCC_18",IATA2of5:"IATA_2_of_5"};const defaultBarcode=createReportItem({Type:"barcode"},"default");function resolveStyle(style,data){return{BackgroundColor:safeResolveCompiledData(style.BackgroundColor,data),Color:safeResolveCompiledData(style.Color,data),Format:safeResolveCompiledData(style.Format,data),FontFamily:safeResolveCompiledData(style.FontFamily,data),FontSize:safeResolveCompiledData(style.FontSize,data),FontStyle:safeResolveCompiledData(style.FontStyle,data),FontWeight:safeResolveCompiledData(style.FontWeight,data),TextAlign:safeResolveCompiledData(style.TextAlign,data),TextDecoration:safeResolveCompiledData(style.TextDecoration,data)}}function getBarcodeModel(model,width,height,data,ctx){const errorMessage=resolveCompiled$1(model.InvalidBarcodeText,data),angle=parseInt((model.Definition.Rotation||"None").replace(/\D/g,""),10)||0,paddings=getPaddings(model.Definition.BarHeight,model.Definition.QuietZone.Top,model.Definition.QuietZone.Left,model.Definition.QuietZone.Bottom,model.Definition.QuietZone.Right,safeResolveCompiledData(model.Style.PaddingTop,data),safeResolveCompiledData(model.Style.PaddingLeft,data),safeResolveCompiledData(model.Style.PaddingBottom,data),safeResolveCompiledData(model.Style.PaddingRight,data),Length.toCss(width),Length.toCss(height),model.Definition.Rotation),{availableWidth:availableWidth,availableHeight:availableHeight}=function(width,height,paddings,rotation){const availableWidth=width-paddings.left-paddings.right,availableHeight=height-paddings.top-paddings.bottom;return ORTHOGONAL_ROTATIONS.includes(rotation)?{availableWidth:availableHeight,availableHeight:availableWidth}:{availableWidth:availableWidth,availableHeight:availableHeight}}(width,height,paddings,model.Definition.Rotation),value=resolveCompiled$1(model.Value,data,ctx),romBarcodeModel=Object.assign(Object.assign({},model.Definition),{QuietZone:{Left:"0in",Right:"0in",Top:"0in",Bottom:"0in"},Style:resolveStyle(model.Style,data),Width:Length.toCss(availableWidth),Height:Length.toCss(availableHeight),Gs1CompositeOptions:Object.assign(Object.assign({},model.Gs1CompositeOptions),{Value:safeResolveCompiledData(model.Gs1CompositeOptions.Value,data)})});return{Model:"function"!=typeof value?translateBarcodeModel_1(Object.assign(Object.assign({},romBarcodeModel),{Value:value})):globals=>translateBarcodeModel_1(Object.assign(Object.assign({},romBarcodeModel),{Value:value(globals)})),Symbology:model.Definition.Symbology,ErrorMessage:errorMessage,Angle:angle}}function makeLayout$2(model,width,height,data,render,ctx){return function(barcode,width,height,renderBarcode){return L2.StaticClipped(width,height,renderBarcode)}(0,width,height,(itemViewSize=>render(data,ctx,itemViewSize,getBarcodeModel(model,width,height,data,ctx))))}function compileRows(tableRows,parentContext,setLastRow,type){return __awaiter(this,void 0,void 0,(function*(){const query={Fields:[],Regions:[]},context=Object.assign(Object.assign({},parentContext),{ContainerSize:null}),compileScopeExpression=expr=>{const val=compileExpression(expr,query.Fields);return"function"!=typeof val?val:data=>resolveCompiled$1(val,data)},staticStyles=[],compiledRows=[],mapChild=makeMapChild$1(query,staticStyles),cellCanShrink=tc=>{var _a;const rItem=null!==(_a=null==tc?void 0:tc.Item)&&void 0!==_a?_a:null;return!rItem||"textbox"===rItem.Type&&rItem.CanShrink};for(const rowDef of tableRows){const visibility=compileVisibility(rowDef.Visibility,compileScopeExpression),row={Height:Length.parse(rowDef.Height),Visibility:visibility,Cells:[],RowCanShrink:rowDef.TableCells.every(cellCanShrink)};for(let j=0;j<rowDef.TableCells.length;j++){const cell=rowDef.TableCells[j];let cellComp=cell&&cell.Item&&(yield compile$2(makeCell(cell.Item,context.i18n,"body",rowDef.Action),context));cellComp=compileVisibility$3(rowDef.Visibility,cellComp,(()=>null),context),null!==cellComp?row.Cells[j]=Object.assign(Object.assign({},mapChild(cellComp)),{ColSpan:cell.ColSpan,RowSpan:cell.RowSpan}):row.Cells[j]=null}const rowDocMap=(data,ctx)=>actions=>{const cellsDocMap=row.Cells.map(((c,i)=>c&&!ctx.IsCellHidden({ColIndex:i,ColSpan:c.ColSpan})?c:null)).filter(isNotNull).map((c=>c.DocumentMap));return buildDocumentMap("",{},context.DocumentMap,cellsDocMap)(data,ctx)(actions)};compiledRows.push(Object.assign(Object.assign({},row),{DocMap:withDefault(visibility(rowDocMap),[])}))}const rowNumber=compileExpression("=RowNumber()",query.Fields);return{Query:query,Layout:(data,ctx)=>actions=>{const lastRowNumber=toNumber$1(resolveCompiled$1(rowNumber,data));setLastRow&&setLastRow(lastRowNumber);const rowsHeights=compiledRows.map((cr=>cr.Visibility((()=>()=>cr.Height))(data)(actions)));return columns=>{let remainder=new Array(columns.length).fill(null),resultRowIndex=0;const stripesWithEmptyCells=rowsHeights.filter(isNotNull).map(((h,i)=>MakeStripe([],compiledRows[i].RowCanShrink?0:h)));for(let rowIndex=0;rowIndex<compiledRows.length;rowIndex++){const rowCells=compiledRows[rowIndex].Cells.map(((c,i)=>c||remainder[i]));if(null!==rowsHeights[rowIndex]){for(let cellIndex=0;cellIndex<rowCells.length;){const cell=rowCells[cellIndex];if(null!==cell){void 0===cell.RowSpan&&(cell.RowSpan=1);const colSpan=1===cell.ColSpan?null===columns[cellIndex]?0:1:columns.slice(cellIndex,cellIndex+cell.ColSpan).filter(isNotNull).length,rowSpan=1===cell.RowSpan?null===rowsHeights[rowIndex]?0:1:rowsHeights.slice(rowIndex,rowIndex+cell.RowSpan).filter(isNotNull).length,cellHeight=CellSize(cell.RowSpan,rowIndex,rowsHeights);if(colSpan>0&&rowSpan>0){let contentLayout=(0,cell.Layout)(data,ctx)(actions)(CellSize(cell.ColSpan,cellIndex,columns),cellHeight);contentLayout=L2.ConvertBody(contentLayout,(vnode=>(vnode.properties.meta=Object.assign(Object.assign({},vnode.properties.meta),{colNumber:cellIndex,rowNumber:lastRowNumber,scopeID:data.Id,rowType:type}),vnode)));const gridCell=MakeCell(contentLayout,null,colSpan,rowSpan,cellHeight);stripesWithEmptyCells[resultRowIndex].Cells[cellIndex]=gridCell;for(let k=1;k<rowSpan;k++)stripesWithEmptyCells[resultRowIndex+k].Cells[cellIndex]=MakeCell(null,null,colSpan,1)}cellIndex+=cell.ColSpan}else cellIndex++}resultRowIndex++,remainder=new Array(columns.length).fill(null)}else remainder=rowCells.map((c=>c&&c.RowSpan>1?Object.assign(Object.assign({},c),{RowSpan:c.RowSpan-1}):null))}const stripes=LazyList.fromArray(stripesWithEmptyCells.map((s=>Object.assign(Object.assign({},s),{Cells:s.Cells.filter((c=>c&&!c.IsEmpty))}))));if(!stripes)return null;const result=GridCells(stripes,MakeGridCellOptions((item=>{var _a,_b;const colSpan=null!==(_a=null==item?void 0:item.colSpan)&&void 0!==_a?_a:1,rowSpan=null!==(_b=null==item?void 0:item.rowSpan)&&void 0!==_b?_b:1,source=null==item?void 0:item.item,template="function"==typeof source?source(1/0).Body:null;return Empty2(h("td",Object.assign(Object.assign({},null==template?void 0:template.properties),{colSpan:colSpan,rowSpan:rowSpan}),[]))})),((size,strip)=>InHeader(strip,size)));return result&&LazyList.cons(result)}},DocumentMap:buildDocumentMap("",{},context.DocumentMap,flatten$1(compiledRows.map((r=>r.DocMap)))),Styles:staticStyles}}))}function CellSize(span,startPosition,sizes){const endPosition=startPosition+span;startPosition>=0&&sizes.length;let width=0;for(let i=startPosition;i<endPosition;i++){width+=sizes[i]||0}return width}const makeMapChild$1=(queryRef,styles)=>{const makeMapData=makeDataMapper(queryRef);return child=>{const mapData=makeMapData(child.Query);return styles.push(...child.Styles),{Layout:mapData(child.Layout),DocumentMap:mapData(child.DocumentMap)}}};function compileDetails(defDetails,context,setLastRow){return __awaiter(this,void 0,void 0,(function*(){const cDetail=yield function(defDetails,context,setLastRow){return __awaiter(this,void 0,void 0,(function*(){const detRows=defDetails&&(yield compileRows(defDetails.TableRows,context,setLastRow,"details")),details=defDetails&&{PageBreakAtStart:"Start"===defDetails.Group.PageBreak||"StartAndEnd"===defDetails.Group.PageBreak,PageBreakAtEnd:"End"===defDetails.Group.PageBreak||"StartAndEnd"===defDetails.Group.PageBreak,NewSection:!1},contentQuery=Def.EmptyContent,sortExpressions=context.Interactivity.SortExpressions[defDetails.Group.Name||`${defDetails.TableName}###Details`],groupQuery=sortExpressions?Object.assign(Object.assign({},detRows.Query),{Fields:uniq(detRows.Query.Fields.concat(sortExpressions))}):detRows.Query;function comp(value){return compileExpression(value,groupQuery.Fields)}const compiled={Label:createTypedCompiler(comp).compileString(defDetails.Group.DocumentMapLabel)},layout=LayoutDetail(details),group=defDetails,listQuery=Def.Makers.List(group.Group.Name,contentQuery,[],group.Group.Name?Def.Makers.Group(group.Group.Name,group.Group.GroupExpressions,(group.Group.Filters||[]).map((f=>({Expression:f.FilterExpression,Op:f.Operator,Values:f.FilterValues}))),group.Group.ParentGroup||void 0):Def.Makers.Group(""),(group.SortExpressions||[]).map((s=>({Direction:s.Direction,Expression:s.Value}))),groupQuery),compiledDetail={Styles:detRows.Styles,Query:{Fields:[],Regions:[listQuery]},Layout:(data,ctx)=>actions=>columns=>{const scopeActions=getScopeActions(actions,data.Id),rows=detRows.Layout(data,ctx)(scopeActions)(columns);return rows&&layout(rows)},DocumentMap:buildDocumentMap(defDetails.Group.Name||"${Table}_Details",compiled,context.DocumentMap,[detRows.DocumentMap])},compileScopeExpression=expr=>{const val=compileExpression(expr,groupQuery.Fields);return"function"!=typeof val?val:data=>resolveCompiled$1(val,data)},visibility=isRecursiveHierarchy(group)?createVisibility():group.Visibility,visibilityMap=compileVisibility(visibility,compileScopeExpression);return Object.assign(Object.assign({},compiledDetail),{Layout:visibilityMap(compiledDetail.Layout),DocumentMap:withDefault(visibilityMap(compiledDetail.DocumentMap),[])})}))}(defDetails,context,setLastRow);if(!cDetail)return null;const withPageBreak=PageBreakList(defDetails.Group.PageBreak),layoutGroup=isRecursiveHierarchy(defDetails)?compileHierarchyToggle(defDetails.Visibility,cDetail.Layout,cDetail.Query.Regions[0].GroupContent.Fields):(gData,ctx)=>actions=>{var _a;return null!==(_a=null==gData?void 0:gData.map((g=>cDetail.Layout(g,ctx)(actions))).filter(isNotNull))&&void 0!==_a?_a:null};return Object.assign(Object.assign({},cDetail),{Layout:(data,parentCtx)=>actions=>columns=>{if(!data.Regions||!data.Regions.length)return null;const listData=data.Regions[0],ctx=Object.assign(Object.assign({},parentCtx),{ParentScopes:Object.assign(Object.assign({},parentCtx.ParentScopes),{[cDetail.Query.Regions[0].Name]:listData.Scope.Id})}),scopeActions=getScopeActions(actions,listData.Scope.Id),lazyGroups=LazyList.fromIterable(listData.Groups||[]),lg=lazyGroups&&layoutGroup(lazyGroups,ctx)(scopeActions),result=lg&&lg.map((g=>g(columns))).filter(isNotNull);return result&&withPageBreak(result)},DocumentMap:(data,ctx)=>actions=>{if(!data.Regions||!data.Regions.length)return[];const listData=data.Regions[0],scopeActions=getScopeActions(actions,listData.Scope.Id);return buildGroupDocumentMap("",{},context.DocumentMap,cDetail.DocumentMap)(listData,ctx)(scopeActions)}})}))}function compileGroups(tGroups,details,context,_repeatToFill,lFiller,setLastRow,isRootGroup=!1){return __awaiter(this,void 0,void 0,(function*(){const group=tGroups[0],repeatToFill=_repeatToFill&&isRootGroup,lGroup=function(tg,repeatToFill){if(!repeatToFill)return tg;let consistentGroup=tg;"None"!==tg.BreakLocation&&(consistentGroup=Object.assign(Object.assign({},tg),{BreakLocation:"None"}));tg.KeepTogether&&(consistentGroup=Object.assign(Object.assign({},tg),{KeepTogether:!1}));return consistentGroup}({PreventOrphanedFooter:group.PreventOrphanedFooter,KeepTogether:group.KeepTogether,BreakLocation:group.Group.PageBreak},repeatToFill),cGroup=yield compileGroup(tGroups,details,context,_repeatToFill,lFiller,setLastRow,isRootGroup);if(!cGroup)return null;const layoutGroup=isRecursiveHierarchy(group)?compileHierarchyToggle(group.Visibility,cGroup.Layout,cGroup.Query.Regions[0].GroupContent.Fields):(gData,ctx)=>actions=>{var _a;return null!==(_a=null==gData?void 0:gData.map((g=>cGroup.Layout(g,ctx)(actions))).filter(isNotNull))&&void 0!==_a?_a:null},withPageBreak=PageBreakList(lGroup.BreakLocation);return Object.assign(Object.assign({},cGroup),{Layout:(data,ctx)=>actions=>columns=>{if(!data.Regions||!data.Regions.length)return null;const listData=data.Regions[0],scopeActions=getScopeActions(actions,listData.Scope.Id),lazyGroups=LazyList.fromIterable(listData.Groups||[]),lg=lazyGroups&&layoutGroup(lazyGroups,ctx)(scopeActions),result=lg&&lg.map((g=>g(columns))).filter(isNotNull);return result&&withPageBreak(result)},DocumentMap:(data,ctx)=>actions=>{if(!data.Regions||!data.Regions.length)return[];const listData=data.Regions[0],scopeActions=getScopeActions(actions,listData.Scope.Id);return buildGroupDocumentMap("",{},context.DocumentMap,cGroup.DocumentMap)(listData,ctx)(scopeActions)}})}))}function compileGroup(tGroups,details,context,_repeatToFill,lFiller,setLastRow,isRootGroup=!1){return __awaiter(this,void 0,void 0,(function*(){const[group,...subGroups]=tGroups,children=subGroups.length?yield compileGroups(subGroups,details,context,_repeatToFill,lFiller,setLastRow):details&&(yield compileDetails(details,context,setLastRow)),staticStyles=[],cGroup=function(options,_repeatToFill,isRootGroup=!1){const repeatToFill=_repeatToFill&&isRootGroup;return(rows,headerRows,footerRows,fillerRows,_isFillerLayout,_isLastChunk)=>{const body=_isFillerLayout||!rows?null:Stack(rows),header=headerRows&&GroupSection(headerRows),footer=footerRows&&GroupSection(footerRows),filler=idx=>{const fRows=fillerRows(idx);return fRows&&Stack(fRows)};if(null===header&&null===body&&null===footer)return null;let layout=L.GroupAdvanced(header,body,footer,MakeFiller(filler),options,((sz,hr,br,fr)=>MakeBodyCol(sz,[hr,br,fr].reduce(((res,item)=>res&&item?res.concat(LazyList.cons(item)):item?LazyList.cons(item):res),null),repeatToFill?function(header,body,footer){const Header=null!==header?header.Body:null;let Body=null!==body?body.Body:null,Footer=null!==footer?footer.Body:null;if(null===Footer&&null!==Body&&"gridelementlist"===Body.Type){const b=Body.Item;b&&b.Footer&&(Body=b.Body,Footer=b.Footer)}return{Header:Header,Body:Body,Footer:Footer}}(hr,br,fr):null)));if(repeatToFill&&!options.PrintFooterAtBottom){const fill=MakeFiller(filler);let fillEmpty=fill;(options.RepeatHeader||options.RepeatFooter)&&(fillEmpty=L.GroupAdvanced(options.RepeatHeader?header:null,fill,options.RepeatFooter?footer:null,null,Object.assign(Object.assign({},defaultGroupOptions),{RepeatHeader:options.RepeatHeader,RepeatFooter:options.RepeatFooter}),((size,h,b,f)=>MakeBodyCol(size,[h,b,f].reduce(((res,item)=>res&&item?res.concat(LazyList.cons(item)):item?LazyList.cons(item):res),null)))));const fillEmptyLast=options.RepeatFooter?fillEmpty:L.GroupAdvanced(options.RepeatHeader?header:null,fill,footer,null,Object.assign(Object.assign({},defaultGroupOptions),{RepeatHeader:options.RepeatHeader,RepeatFooter:!0}),((size,h,b,f)=>MakeBodyCol(size,[h,b,f].reduce(((res,item)=>res&&item?res.concat(LazyList.cons(item)):item?LazyList.cons(item):res),null))));layout=L.FillSpace(layout,_isLastChunk,fill,fillEmpty,fillEmptyLast,((size,rowsFragment,fillFragments)=>{const tuple=null!=rowsFragment&&"gridheader"!==rowsFragment.Type?rowsFragment.Item:null,footerReplacer=options.RepeatFooter||_isLastChunk()||null===tuple||null===tuple.Footer?null:fill(tuple.Footer.Size),outcome=(null!==tuple?[tuple.Header,tuple.Body,fillFragments,footerReplacer?footerReplacer.Body:tuple.Footer]:[rowsFragment,fillFragments]).reduce(((res,item)=>res&&item?res.concat(LazyList.cons(item)):item?LazyList.cons(item):res),null);return MakeCol(size,outcome)}))}return layout}}(Object.assign(Object.assign({},defaultGroupOptions),{RepeatHeader:group.Header&&group.Header.RepeatOnNewPage||!1,RepeatFooter:group.Footer&&group.Footer.RepeatOnNewPage||!1,PreventOrphanedFooter:group.PreventOrphanedFooter,PreventOrphanStepback:5,PrintFooterAtBottom:GetPrintFooterAtBottom(tGroups,isRootGroup)}),_repeatToFill,isRootGroup),childrenQuery=children?children.Query:{Fields:[],Regions:[]},sortExpressions=context.Interactivity.SortExpressions[group.Group.Name],groupQuery=sortExpressions?Object.assign(Object.assign({},childrenQuery),{Fields:uniq(childrenQuery.Fields.concat(sortExpressions))}):childrenQuery,childMapper=makeMapChild(groupQuery,staticStyles),lHeaderRowsCompiled=group.Header&&(yield compileRows(group.Header.TableRows,context,null,"header")),lHeaderRows=lHeaderRowsCompiled&&childMapper(lHeaderRowsCompiled),lFooterRowsCompiled=group.Footer&&(yield compileRows(group.Footer.TableRows,context,null,"footer")),lFooterRows=lFooterRowsCompiled&&childMapper(lFooterRowsCompiled);const compiled={Label:createTypedCompiler((function(value){return compileExpression(value,groupQuery.Fields)})).compileString(group.Group.DocumentMapLabel)},groupSortExpr=context.Interactivity.SortExpressions[group.Group.Name],listDef=Def.Makers.List(group.Group.Name,{Fields:[],Regions:[]},[],Def.Makers.Group(group.Group.Name,group.Group.GroupExpressions,(group.Group.Filters||[]).map((f=>({Expression:f.FilterExpression,Op:f.Operator,Values:f.FilterValues}))),group.Group.ParentGroup||void 0),(group.SortExpressions||[]).map((s=>({Direction:s.Direction,Expression:s.Value}))),groupSortExpr?Object.assign(Object.assign({},groupQuery),{Fields:uniq(groupQuery.Fields.concat(groupSortExpr))}):groupQuery),compiledGroup={Query:{Fields:[],Regions:[listDef]},Styles:children?[...staticStyles,...children.Styles]:staticStyles,Layout:(data,parentCtx)=>actions=>columns=>{const ctx=Object.assign(Object.assign({},parentCtx),{ParentScopes:Object.assign(Object.assign({},parentCtx.ParentScopes),{[listDef.Name]:data.Id})}),scopeActions=getScopeActions(actions,data.Id),headerRows=lHeaderRows&&lHeaderRows.Layout(data,ctx)(scopeActions)(columns),footerRows=lFooterRows&&lFooterRows.Layout(data,ctx)(scopeActions)(columns),bodyRows=children&&children.Layout(data,ctx)(scopeActions)(columns),makeFiller=lFiller&&lFiller(data,ctx)(scopeActions),filler=makeFiller?makeFiller(columns):()=>null;let groupLayout=cGroup(bodyRows,headerRows,footerRows,filler,ctx.FPL.isFillerLayout,(()=>ctx.FPL.isLastPlace));if(groupLayout&&compiled.Label){safeResolveCompiledData(compiled.Label,data,"label")&&(groupLayout=addRowMemberLabel(groupLayout,{ToCAnchor:generateTocAnchor(group.Group.Name,data.Id)}))}return group.KeepTogether&&groupLayout&&(groupLayout=context.Layout.KeepTogetherVert(groupLayout)),groupLayout},DocumentMap:(data,ctx)=>actions=>{const headerRows=lHeaderRows&&lHeaderRows.DocumentMap,footerRows=lFooterRows&&lFooterRows.DocumentMap,bodyRows=children&&children.DocumentMap;return buildDocumentMap(group.Group.Name,compiled,context.DocumentMap,[headerRows,bodyRows,footerRows].filter(isNotNull))(data,ctx)(actions)}},visibility=isRecursiveHierarchy(group)?createVisibility():group.Visibility,visibilityMap=compileVisibility(visibility,(expr=>{const val=compileExpression(expr,groupQuery.Fields);return"function"!=typeof val?val:data=>resolveCompiled$1(val,data)}));return Object.assign(Object.assign({},compiledGroup),{Layout:visibilityMap(group.Group.NewSection?inTableSection(compiledGroup.Layout,(d=>`${group.Group.Name}#${d.Id}`)):compiledGroup.Layout),DocumentMap:withDefault(visibilityMap(compiledGroup.DocumentMap),[])})}))}const defaultGroupOptions={RepeatHeader:!1,RepeatFooter:!1,PreventOrphanedHeader:!1,PreventOrphanedFooter:!1,PreventOrphanStepback:0,PrintFooterAtBottom:!1,MoveFooterToNextPage:!1};function GetPrintFooterAtBottom(groups,isRootGroup=!1){if(!groups.length)return!1;if(isRootGroup&&groups.some((g=>g.Footer&&g.Footer.PrintAtBottom||!1)))return!0;const[group,...rest]=groups;return!(!group.Footer||!group.Footer.PrintAtBottom)||!(!group.PreventOrphanedFooter||!rest.length)&&GetPrintFooterAtBottom(rest)}const makeMapChild=(queryRef,styles)=>{const makeMapData=makeDataMapper(queryRef);return child=>{const mapData=makeMapData(child.Query);return styles.push(...child.Styles),{Layout:mapData(child.Layout),DocumentMap:mapData(child.DocumentMap)}}},FillFragment_New=(filler,width,height)=>h("","");function Stack(items,item=null){return L.StackLazyList(items,MakeBodyCol)}function GroupSection(section){return section&&Stack(section)}function MakeFiller(lFiller){return L.Replicate((idx=>lFiller(idx)||L.Zero()),((size,list)=>MakeCol(size,list)))}const LayoutDetail=detail=>rows=>{const oneRow=null===rows.Tail,item=detail.NewSection?detail:null;let layout=oneRow&&null==item?rows.Head:Stack(rows,item);return detail.PageBreakAtStart&&(layout=L.PageBreakBefore(layout)),detail.PageBreakAtEnd&&(layout=L.PageBreakAfter(layout)),layout},defaultTable=createReportItem({Type:"table"},"default");function createTextBoxFiller(item,withStyle){if("line"===item.Type||"overflowplaceholder"===item.Type)throw new InvalidReportDefinitionError("Invalid report item type: Line is not supported as table cell item.");const tb=createTextBox(`__${item.Name}_filler__`);return withStyle&&(tb.Style=Object.assign(Object.assign({},tb.Style),"bandedlist"!==item.Type&&"bullet"!==item.Type&&"sparkline"!==item.Type?item.Style:null)),tb}function SafeEval(node,ctx){try{return ctx?node.Eval(ctx):node.EvalConst()}catch(err){return console.warn(err.message),Tools.Variant.Null}}var table=dataRegion((function(table,context){return __awaiter(this,void 0,void 0,(function*(){const lTable={PageBreakAtStart:"Start"===table.PageBreak||"StartAndEnd"===table.PageBreak},_repeatToFill=table.RepeatToFill||"None"!==table.RepeatBlankRows,_rootTableGroup=Object.assign(Object.assign({},function(name){const d=cjs$1.Model.ReportItem.decode({Type:"table",Name:name,TableGroups:[{Group:{Name:name}}]});if("error"===d.type)throw new Error(`Fatal Error: can't create empty table: ${d.reason}`);return d.value.TableGroups[0]}(table.Name)),{Header:table.Header,Footer:table.Footer,PreventOrphanedFooter:table.PreventOrphanedFooter,Group:createGroup("")}),compiledFiller=table.Details&&(yield function(details,ctx,withStyle){return __awaiter(this,void 0,void 0,(function*(){if(!details.TableRows.length)return null;const fillerRows=details.TableRows.map((lastRow=>Object.assign(Object.assign({},lastRow),{Visibility:{Hidden:!1,ToggleItem:""},TableCells:lastRow.TableCells&&lastRow.TableCells.map((tc=>tc&&Object.assign(Object.assign({},tc),{Item:tc.Item&&createTextBoxFiller(tc.Item,withStyle),AutoMergeMode:"Never"})))})));let lastRowNumber=-1;const setLastRowNumber=rowNum=>{lastRowNumber=rowNum},f=yield compileRows(fillerRows,ctx,null,"filler");let hasRowNumber=!1;const makeFields=f.Query.Fields.map((f=>{const exprTree=treeBuilder$2(f);if(exprTree.Contains("rownumber","function"))return hasRowNumber=!0,function(expr,evalCtx){const newExprNode=replaceExpressionNode(expr,(node=>"function"===node.Token.type&&"rownumber"===node.Token.value&&(!node.Children.length||1===node.Children.length&&null==SafeEval(node.Children[0],evalCtx).Value)),(()=>treeBuilder$2("=__ROW_NUMBER__")));return rowNumber=>{const newCtx=Object.assign(Object.assign({},evalCtx),{Data:Object.assign(Object.assign({},evalCtx.Data),{__row_number__:rowNumber})});return SafeEval(newExprNode,newCtx).Value}}(exprTree,ctx.EvaluationContext);{const exprResult=SafeEval(exprTree,ctx.EvaluationContext).Value;return()=>exprResult}})),makeFakeData=rowNumber=>({Id:-1,"@":makeFields.map((f=>f(rowNumber))),Regions:[]});return{Layout:(data,ctx)=>actions=>columns=>idx=>f.Layout(makeFakeData(lastRowNumber+idx+1),ctx)(actions)(columns),Styles:f.Styles,SetLastRowNum:hasRowNumber?setLastRowNumber:null}}))}(table.Details,context,_repeatToFill)),children=yield compileGroup([_rootTableGroup,...table.TableGroups],table.Details?Object.assign(Object.assign({},table.Details),{TableName:table.Name}):null,context,_repeatToFill,compiledFiller&&compiledFiller.Layout,compiledFiller&&compiledFiller.SetLastRowNum,!0),firstGroup=children?children.Query.Regions[0]:Def.Makers.List("",Def.EmptyContent,[],Def.Makers.Group(""),[],Def.EmptyContent),contentQuery={Fields:[...firstGroup.GroupContent.Fields,...context.Interactivity.SortExpressions[table.Name]||[]],Regions:[]},comp=value=>compileExpression(value,contentQuery.Fields,context.EvaluationContext),bgImage=table.Style.BackgroundImage&&compileBackgroundImageData(table.Style.BackgroundImage,comp,context.getResourceUri),exprCompiler=createTypedCompiler(comp),compiled=Object.assign(Object.assign({Name:context.ReportID+table.Name,ZIndex:table.ZIndex,BackgroundColor:exprCompiler.compileColor(table.Style.BackgroundColor,defaultTable.Style.BackgroundColor),BackgroundImage:bgImage},compileBorders(table.Style,exprCompiler)),{Label:exprCompiler.compileString(table.Label),Bookmark:exprCompiler.compileString(table.Bookmark,defaultTable.Bookmark),Tooltip:exprCompiler.compileString(table.ToolTip,defaultTable.ToolTip),FrozenRows:table.FrozenRows,FrozenColumns:table.FrozenColumns}),listDef=Def.Makers.List(table.Name,contentQuery,(table.Filters||[]).map((f=>({Expression:f.FilterExpression,Op:f.Operator,Values:f.FilterValues}))),Def.Makers.Group(firstGroup.Name,[1],[],firstGroup.Group.Parent||void 0),(firstGroup.Sort||[]).map((s=>({Direction:s.Direction,Expression:s.Expression}))),firstGroup.GroupContent),{render:render,styles:styles}=makeRender$b(compiled,context.getImageResolver()),autoMergeCells=table.Details?flatten(table.Details.TableRows.map((r=>r.TableCells))).filter(isNotNull).filter((c=>"Never"!==c.AutoMergeMode)):[],autoMergeItemNames={};for(const c of autoMergeCells)if(c.Item){autoMergeItemNames[c.Item.Name.toUpperCase()]="Restricted"===c.AutoMergeMode}const tableLayout=(_table=lTable,_autoMergeItemNames=autoMergeItemNames,(rootTableGroupLayout,tableColumns,makeResult)=>{var allColumnWidths=tableColumns.filter(isNotNull);if(null===rootTableGroupLayout)return L.Empty(L.Empty((()=>FillFragment_New(null,0,0))));const options=MakeGridCellOptions((item=>L.Empty(FillFragment_New(null,0,0)))),collapseRepeatingCells=MakeCollapseRepeatingCells(_autoMergeItemNames,MakeCanMergeVNodeCell(_autoMergeItemNames)),layout=L.ConvertBody(rootTableGroupLayout,(gridRows=>gridRows&&GridCells(FillColumnData(gridRows,allColumnWidths),options,collapseRepeatingCells(((width,list)=>makeResult(width,gridRows.Size,CollectRowHeights(gridRows),list))))));return L.SuppressPageBreaks(layout,_table.PageBreakAtStart)});var _table,_autoMergeItemNames;const compileScopeExpression=expr=>{const val=compileExpression(expr,contentQuery.Fields);return"function"!=typeof val?val:data=>resolveCompiled$1(val,data)},colWidths=table.TableColumns.map((c=>compileVisibility(c.Visibility,compileScopeExpression)(((data,ctx)=>actions=>Length.parse(c.Width))))),cellIsHidden=(data,renderCtx)=>actions=>{const columns=colWidths.map((c=>c(data,renderCtx)(actions)));return cell=>0===columns.slice(cell.ColIndex,cell.ColIndex+cell.ColSpan).filter(isNotNull).length};let result={Query:{Fields:[],Regions:[listDef]},Layout:(data,parentCtx)=>actions=>(width,height)=>{const listData=data.Regions[0],ctx=Object.assign(Object.assign({},parentCtx),{ParentScopes:Object.assign(Object.assign({},parentCtx.ParentScopes),{[listDef.Name]:listData.Scope.Id})}),scopeActions=getScopeActions(actions,listData.Scope.Id),rootGroupScope=iterable$1.first(listData.Groups)||listData.Scope,columnsActions=rootGroupScope===listData.Scope?scopeActions:getScopeActions(scopeActions,rootGroupScope.Id),columns=((columnWidths,colAutoWidthEnabled,tableWidth)=>{const freeSpace=tableWidth-columnWidths.reduce(((sum,width)=>width?sum+width:sum),0),ocupiedByAutoWidthColumns=columnWidths.reduce(((sum,width,i)=>width&&colAutoWidthEnabled[i]?sum+width:sum),0);return 0===ocupiedByAutoWidthColumns?columnWidths:columnWidths.map(((width,i)=>width&&colAutoWidthEnabled[i]?width+Math.floor(freeSpace*(width/ocupiedByAutoWidthColumns)):width))})(colWidths.map((c=>c(listData.Scope,ctx)(columnsActions))),table.TableColumns.map((col=>"Proportional"===col.AutoWidth)),width),rootChild=children&&children.Layout(rootGroupScope,ctx)(scopeActions);let rootChildWithCols=rootChild&&rootChild(columns);const itemCommon=resolveItemCommon(compiled,listData.Scope,ctx);rootChildWithCols&&(itemCommon.ToCAnchor||itemCommon.Bookmark)&&(rootChildWithCols=addRowMemberLabel(rootChildWithCols,itemCommon));const tLayout=tableLayout(rootChildWithCols,columns,render(listData.Scope,ctx));return context.Layout.Arrange(tLayout,((res,arrangement)=>res&&res(arrangement)))},Styles:[...styles,...children&&children.Styles||[],...compiledFiller&&compiledFiller.Styles||[]],DocumentMap:(data,parentCtx)=>actions=>{const listData=data.Regions[0],scopeActions=getScopeActions(actions,listData.Scope.Id),ctx=Object.assign(Object.assign({},parentCtx),{IsCellHidden:cellIsHidden(listData.Scope,parentCtx)(actions)}),content=children?children.DocumentMap:()=>()=>[];return buildGroupDocumentMap(table.Name,compiled,context.DocumentMap,content)(listData,ctx)(scopeActions)}};return result=yield compileNoRowsMessage(result,table,context),table.NewSection&&(result=Object.assign(Object.assign({},result),{Layout:inStackSection(result.Layout,(data=>`${compiled.Name}#${data.Regions[0].Scope.Id}`))})),result}))}));function createContentNode(pdfModel){switch(pdfModel.InputType){case"Text":return function(pdfModel){return"function"!=typeof pdfModel.Value?h("div",{className:"arjs-textBoxContent arjs-inputField",attributes:{"data-inputfield":makeDataAttr(pdfModel)},style:pdfModel.Multiline?{"vertical-align":"top"}:{}},fillLineBreaks(pdfModel.Value)):null}(pdfModel);case"CheckBox":return function(pdfModel){return"function"!=typeof pdfModel.Checked?h("div",{className:"arjs-textBoxContent arjs-inputField",attributes:{"data-inputfield":makeDataAttr(pdfModel)},style:{textAlign:"center"}},pdfModel.Checked?"\u2713":""):null}(pdfModel);default:return null}}function makeDataAttr(pdfModel){return isResolvedModel(pdfModel)?JSON.stringify(pdfModel):""}function makeRender$1(model){const style=model.Style,sb=styleBuilder();sb.add("color",[style.Color]),sb.add("fontFamily",[style.FontFamily]),sb.add("fontSize",[style.FontSize]),sb.add("fontStyle",[style.FontStyle],getFontStyle$1),sb.add("fontWeight",[style.FontWeight],getFontWeight$3),sb.add("textAlign",[style.TextAlign,"ltr",style.Format,model.ValueUnformatted],getTextAlign$1),sb.add("padding",["2pt"]);const contentStyle=sb.style,className=`${model.Name}Style`;return{render:(data,itemViewSize,ctx)=>function(className,style,itemViewSize,pdfModel,idGenerator,model){const isRenderTimeModel=!isResolvedModel(pdfModel),anchorNodes=buildAnchorNodes(model);let patcher=null;const id=idGenerator.next();if(isRenderTimeModel||null!==style.renderTimeStyle){const getNewContent=ctx=>[...anchorNodes,createContentNode(resolvePdfModelRuntime(pdfModel,ctx))].filter(isNotNull);patcher=ctx=>({id:id,style:style.renderTimeStyle?style.renderTimeStyle(ctx):null,children:isRenderTimeModel?getNewContent(ctx):null})}const styleAndSize=Object.assign(Object.assign({},style.style),buildSizeStyle(itemViewSize));return wrapSplittedItem(itemViewSize,h("div",{className:`arjs-textBoxItem ${className}`,style:styleAndSize,patcher:patcher,id:id,title:model.Tooltip},[...anchorNodes,h("div",{className:"arjs-inputFieldBase"},[createContentNode(pdfModel)].filter(isNotNull))]))}(className,contentStyle.dynamic(data),itemViewSize,resolvePdfModel(model.PdfModel,data),ctx.IDGenerator,resolveItemCommon(model,data,ctx)),styles:[{className:className,style:contentStyle.static}]}}const resolvePdfModel=(pdfModel,data)=>Object.assign(Object.assign({},pdfModel),{Value:limitValueLength(resolveCompiled$1(pdfModel.Value,data),pdfModel.MaxLength),Checked:resolveCompiled$1(pdfModel.Checked,data),CheckSize:resolveCompiled$1(pdfModel.CheckSize,data),FieldName:resolveCompiled$1(pdfModel.FieldName,data)||pdfModel.Name}),resolvePdfModelRuntime=(pdfModel,globals)=>Object.assign(Object.assign({},pdfModel),{Value:limitValueLength("function"==typeof pdfModel.Value?pdfModel.Value(globals):pdfModel.Value,pdfModel.MaxLength),Checked:"function"==typeof pdfModel.Checked?pdfModel.Checked(globals):pdfModel.Checked,CheckSize:"function"==typeof pdfModel.CheckSize?pdfModel.CheckSize(globals):pdfModel.CheckSize,FieldName:("function"==typeof pdfModel.FieldName?pdfModel.FieldName(globals):pdfModel.FieldName)||pdfModel.Name}),limitValueLength=(value,maxLength)=>maxLength&&value&&"function"!=typeof value?value.substr(0,maxLength):value,isResolvedModel=pdfModel=>Object.values(pdfModel).every((v=>"function"!=typeof v)),defaultInputFieldText=createReportItem({Type:"inputfield"},"default"),defaultInputFieldCheckBox=createReportItem({Type:"inputfield",InputType:"CheckBox"},"default");function compilePdfModel(definition,value,comp){const exprCompiler=createTypedCompiler(comp);return{InputType:definition.InputType,Name:definition.Name,FieldName:exprCompiler.compileString(definition.FieldName,defaultInputFieldCheckBox.FieldName),Checked:"CheckBox"===definition.InputType?exprCompiler.compileBoolean(definition.Checked,defaultInputFieldCheckBox.Checked):null,CheckStyle:"CheckBox"===definition.InputType?definition.CheckStyle:null,CheckSize:"CheckBox"===definition.InputType?exprCompiler.compileLength(definition.CheckSize,defaultInputFieldCheckBox.CheckSize):null,Value:value,Readonly:definition.Readonly,Required:definition.Required,Password:"Text"===definition.InputType?definition.Password:null,Multiline:"Text"===definition.InputType?definition.Multiline:null,SpellCheck:"Text"===definition.InputType?definition.SpellCheck:null,MaxLength:"Text"===definition.InputType?definition.MaxLength:null}}const pStyles={H1:Object.freeze({FontSize:"2.00em",FontWeight:"Bold",SpaceBefore:"0.67em",SpaceAfter:"0.67em"}),H2:Object.freeze({FontSize:"1.50em",FontWeight:"Bold",SpaceBefore:"0.83em",SpaceAfter:"0.83em"}),H3:Object.freeze({FontSize:"1.17em",FontWeight:"Bold",SpaceBefore:"1em",SpaceAfter:"1em"}),H4:Object.freeze({FontSize:"1.00em",FontWeight:"Bold",SpaceBefore:"1.33em",SpaceAfter:"1.33em"}),H5:Object.freeze({FontSize:"0.83em",FontWeight:"Bold",SpaceBefore:"1.67em",SpaceAfter:"1.67em"}),H6:Object.freeze({FontSize:"0.67em",FontWeight:"Bold",SpaceBefore:"2.33em",SpaceAfter:"2.33em"}),P:Object.freeze({SpaceBefore:"1em",SpaceAfter:"1em"})},availableStyles=Object.keys(pStyles);function initExpr(exprOrValue){return function(exprOrValue){return"string"!=typeof exprOrValue||!exprOrValue.trim().startsWith("=")}(exprOrValue)?{type:"value",value:exprOrValue}:{type:"expr-string",exprString:exprOrValue}}const compileExpr=comp=>function(...fns){return x=>fns.reduce(((v,f)=>f(v)),x)}(initExpr,(comp=>value=>{if("value"===value.type)return value;const compiled=comp(value.exprString);return"function"!=typeof compiled?{type:"value",value:compiled}:{type:"expr-dynamic",exprDynamic:compiled}})(comp));function makeExprResolver(data,ctx){return expr=>"value"===expr.type?expr.value:resolveCompiled$1(expr.exprDynamic,data,ctx)}function toCompiledValue(expr){return"value"===expr.type?expr.value:expr.exprDynamic}function toExprCompiled(expr){return"function"!=typeof expr?{type:"value",value:expr}:{type:"expr-dynamic",exprDynamic:expr}}const renderTabs=makeRenderTabs(((tabText,tabSize)=>h("span",{className:"arjs-text-tab",style:{minWidth:tabSize}},tabText.length>0?[`${tabText}\xa0`]:[])));function render(model,style,textRunContent){var _a;switch(model.Type){case"text":const textContent=flatten(fillLineBreaks(textRunContent.text).map((t=>"string"==typeof t?renderTabs(t):t))),content=((actionDef,value)=>{if(!actionDef)return value;const dataAttrValue=buildActionAttr(actionDef);if(dataAttrValue.Type){const attributes={"data-action":JSON.stringify(dataAttrValue)};return[h("span",{className:"arjs-action",attributes:attributes},value)]}return value})(null!==(_a=model.Action)&&void 0!==_a?_a:createAction(),textContent);return h("span",{style:style,title:model.ToolTip,className:"arjs-textRun"},content);case"image":const attributes={"data-sizemode":"Fit"},action=(actionDef=>{if(!actionDef)return;const actionAttr=buildActionAttr(actionDef);return actionAttr.Type?JSON.stringify(actionAttr):void 0})(model.Action);return action&&(attributes["data-action"]=action),h("div",{style:style,title:model.ToolTip,className:`arjs-textRun ${action?"arjs-action":""} ${textRunContent.embeddedImageClassName||""}`,attributes:attributes},[])}}const getFontSize=(fontSize,styleName)=>{switch(styleName){case"SUP":case"SUB":return`calc(${fontSize} * 0.833)`;default:return fontSize}};function renderTextRun(model,embeddedImageResolver){const style=function(model){const sb=styleBuilder();switch(model.Type){case"text":model.Style.Color&&sb.add("color",[model.Style.Color]),model.Style.BackgroundColor&&sb.add("backgroundColor",[model.Style.BackgroundColor]),model.Style.FontFamily&&sb.add("fontFamily",[model.Style.FontFamily],wrapWithQuotes),model.Style.FontSize&&sb.add("fontSize",[model.Style.FontSize,model.StyleName],getFontSize),model.Style.FontStyle&&sb.add("fontStyle",[model.Style.FontStyle],getFontStyle$1),model.Style.FontWeight&&sb.add("fontWeight",[model.Style.FontWeight],getFontWeight$3),model.Style.TextDecoration&&(sb.add("textDecorationLine",[model.Style.TextDecoration],getTextDecoration$3),sb.add("textDecorationStyle",[model.Style.TextDecoration],getTextDecorationStyle)),model.Style.LineSpacing&&model.Style.FontSize&&sb.add("lineHeight",[model.Style.LineSpacing,model.Style.FontSize],getLineHeight),(model.Style.Subscript||model.Style.Superscript)&&(model.Style.Superscript&&sb.add("verticalAlign",["super"]),model.Style.Subscript&&sb.add("verticalAlign",["sub"]));break;case"image":sb.add("backgroundImage",[model.Value]),sb.add("width",[model.Width]),sb.add("height",[model.Height]),sb.add("backgroundSize",["100% 100%"]),sb.add("display",["inline-block"])}return sb.style.static}(model);switch(model.Type){case"text":return{type:model.Type,value:model.Value,resolvedStyles:style,render:text=>render(model,style,{text:text})};case"image":return{type:model.Type,resolvedStyles:style,render:()=>render(model,style,{embeddedImageClassName:embeddedImageResolver(model.Source,model.Value)})}}}function compileTextRun(textRun,exprCompiler,fields,context){const compiled=function(textRun,exprCompiler,fields,context){var _a,_b;switch(textRun.Type){case"text":return{Name:"TextRun",Type:textRun.Type,Value:exprCompiler.compString(textRun.Value),Tooltip:exprCompiler.compString(textRun.ToolTip),Action:compileAction$1(null!==(_a=textRun.Action)&&void 0!==_a?_a:createAction(),fields),Label:textRun.Label,StyleName:textRun.StyleName,Style:{Color:textRun.Style.Color&&exprCompiler.compColor(textRun.Style.Color),BackgroundColor:textRun.Style.BackgroundColor&&exprCompiler.compColor(textRun.Style.BackgroundColor),FontFamily:textRun.Style.FontFamily&&exprCompiler.compString(textRun.Style.FontFamily),FontSize:textRun.Style.FontSize&&exprCompiler.compLength(textRun.Style.FontSize),FontStyle:textRun.Style.FontStyle&&exprCompiler.compEnum.FontStyle(textRun.Style.FontStyle),FontWeight:textRun.Style.FontWeight&&exprCompiler.compEnum.FontWeight(textRun.Style.FontWeight),TextDecoration:textRun.Style.TextDecoration&&exprCompiler.compEnum.TextDecoration(textRun.Style.TextDecoration),LineSpacing:textRun.Style.LineSpacing&&exprCompiler.compLength(textRun.Style.LineSpacing),Subscript:textRun.Style.Subscript&&exprCompiler.compBoolean(textRun.Style.Subscript),Superscript:textRun.Style.Superscript&&exprCompiler.compBoolean(textRun.Style.Superscript)}};case"image":const compiledImageData=compileImageData({Value:textRun.Value,Source:textRun.Source,MIMEType:textRun.MIMEType},(value=>toCompiledValue(exprCompiler.compString(value))),context.getResourceUri);return{Source:compiledImageData.Source,MIMEType:compiledImageData.MIMEType,Value:toExprCompiled(compiledImageData.Value),Name:"TextRun",Type:textRun.Type,Width:exprCompiler.compLength(textRun.Width),Height:exprCompiler.compLength(textRun.Height),Tooltip:exprCompiler.compString(textRun.ToolTip),Action:compileAction$1(null!==(_b=textRun.Action)&&void 0!==_b?_b:createAction(),fields),Label:textRun.Label}}}(textRun,exprCompiler,fields,context);return(data,ctx)=>function(compiled,resolveExpr,data,ctx){const common=function(textrun,data,ctx){return resolveItemCommon(Object.assign(Object.assign({},textrun),{Value:toCompiledValue(textrun.Value),Tooltip:toCompiledValue(textrun.Tooltip)}),data,ctx)}(compiled,data,ctx);switch(compiled.Type){case"text":const resolvedText={Type:compiled.Type,Value:resolveExpr(compiled.Value),StyleName:compiled.StyleName,ToolTip:resolveExpr(compiled.Tooltip),Action:common.Action,Label:compiled.Label,Style:{Color:compiled.Style.Color&&resolveExpr(compiled.Style.Color),BackgroundColor:compiled.Style.BackgroundColor&&resolveExpr(compiled.Style.BackgroundColor),FontFamily:compiled.Style.FontFamily&&resolveExpr(compiled.Style.FontFamily),FontSize:compiled.Style.FontSize&&resolveExpr(compiled.Style.FontSize),FontStyle:compiled.Style.FontStyle&&resolveExpr(compiled.Style.FontStyle),FontWeight:compiled.Style.FontWeight&&resolveExpr(compiled.Style.FontWeight),TextDecoration:compiled.Style.TextDecoration&&resolveExpr(compiled.Style.TextDecoration),LineSpacing:compiled.Style.LineSpacing&&resolveExpr(compiled.Style.LineSpacing),Subscript:compiled.Style.Subscript&&resolveExpr(compiled.Style.Subscript),Superscript:compiled.Style.Superscript&&resolveExpr(compiled.Style.Superscript)}};return"function"==typeof resolvedText.Value&&(resolvedText.Value="<B>RUNTIME VALUE NOT SUPPORTED YET</B>"),resolvedText;case"image":const resolvedImage={Type:compiled.Type,Value:resolveExpr(compiled.Value),Source:compiled.Source,MIMEType:compiled.MIMEType,Width:resolveExpr(compiled.Width),Height:resolveExpr(compiled.Height),ToolTip:resolveExpr(compiled.Tooltip),Action:common.Action,Label:compiled.Label};return"function"==typeof resolvedImage.Value&&(resolvedImage.Value=""),resolvedImage}}(compiled,makeExprResolver(data,ctx),data,ctx)}const emptyTextRun=renderTextRun(createTextRun(),(()=>"")),lineBreakTextRun={Type:"text",Text:"\n",Style:emptyTextRun.resolvedStyles,render:emptyTextRun.render},LIST_INDENT_DEFAULT_TWIPS=Length.parse("30pt");function getListItemIndent(leftIndent,listLevel){const leftIndentTwips=leftIndent?Length.parse(leftIndent):0;return Length.toCss(leftIndentTwips+listLevel*LIST_INDENT_DEFAULT_TWIPS)}function getListItemIndentFromModel(model){return getListItemIndent(model.LeftIndent||null,model.ListLevel)}function getListItemMarker(model){const shouldUseFallbackFont="Bullet"===model.ListStyle&&model.ListLevel>1;let marker="";var listItemIndex,listStyleType;"Numbered"===model.ListStyle&&(listItemIndex=model.ListItemIndex,marker="None"!==(listStyleType=model.ListStyleType)?`${formatLevel(++listItemIndex,listStyleType||"Decimal")}.`:""),"Bullet"===model.ListStyle&&(marker=function(listLevel,listStyleType){switch(listStyleType){case"Disc":return"\u2022";case"Circle":return"\u25e6";case"Square":return"\u25aa";case"None":return""}switch(listLevel){case 1:return"\u2022";case 2:return"\u25e6";default:return"\u25aa"}}(model.ListLevel,model.ListStyleType));const width=getListItemIndentFromModel(model),listMarkerGap="Bullet"===model.ListStyle?"0.4em":"0.2em";return h("div",{className:"arjs-richtext-list-item__marker",style:{minWidth:width,width:width,paddingRight:listMarkerGap}},[h("span",{className:"arjs-textRun arjs-textLine",style:{fontFamily:shouldUseFallbackFont?"Arial":"inherit",marginLeft:"auto",minWidth:"3em",width:`calc(${width} - ${listMarkerGap})`,textAlign:"right"}},marker)])}function getParagraphChildren(lines,model){return model.ListLevel>0?function(textRuns,model){const listMarker=getListItemMarker(model),listProps={className:"arjs-richtext-list-item",style:{marginLeft:`-${getListItemIndentFromModel(model)}`}};return[h("div",listProps,[listMarker,h("div",{className:"arjs-richtext-list-item__content"},textRuns)])]}(lines,model):lines}function renderParagraph(model){const style=function(model){var _a;const sb=styleBuilder();return model.ListLevel>0?sb.add("padding-left",[model.LeftIndent||null,model.ListLevel,(null===(_a=model.Style)||void 0===_a?void 0:_a.FontSize)||null],getListItemIndent):model.LeftIndent&&sb.add("padding-left",[model.LeftIndent]),model.RightIndent&&sb.add("padding-right",[model.RightIndent]),model.HangingIndent&&sb.add("text-indent",[model.HangingIndent]),model.SpaceBefore&&sb.add("margin-top",[model.SpaceBefore]),model.SpaceAfter&&sb.add("margin-bottom",[model.SpaceAfter]),model.Style.Color&&sb.add("color",[model.Style.Color]),model.Style.BackgroundColor&&sb.add("backgroundColor",[model.Style.BackgroundColor]),model.Style.TextAlign&&(sb.add("textAlign",[model.Style.TextAlign],getTextAlign$1),sb.add("textAlignLast",[model.Style.TextAlign,"LTR","DistributeAllLines"],getTextAlignLast)),model.Style.FontFamily&&sb.add("fontFamily",[model.Style.FontFamily],wrapWithQuotes),model.Style.FontSize&&sb.add("fontSize",[model.Style.FontSize]),model.Style.FontStyle&&sb.add("fontStyle",[model.Style.FontStyle],getFontStyle$1),model.Style.FontWeight&&sb.add("fontWeight",[model.Style.FontWeight],getFontWeight$3),sb.style.static}(model);return{Style:style,render:lines=>h("div",{style:style},getParagraphChildren(lines,model))}}function compile$4(paragraph,comp,fields,context){const exprCompiler=function(comp){const exprCompiler=createTypedCompiler(comp);return{compLength:compileExpr(exprCompiler.compileLength),compString:compileExpr(exprCompiler.compileString),compBoolean:compileExpr(exprCompiler.compileBoolean),compColor:compileExpr(exprCompiler.compileColor),compEnum:{TextAlign:compileExpr(exprCompiler.compileEnum.ParagraphTextAlign),FontWeight:compileExpr(exprCompiler.compileEnum.FontWeight),FontStyle:compileExpr(exprCompiler.compileEnum.FontStyle),TextDecoration:compileExpr(exprCompiler.compileEnum.TextDecoration)}}}(comp),compiled=function(paragraph,exprCompiler){const style=Object.assign({},function(name){const sName=availableStyles.find((n=>function(str1,str2,ignoreCasing=!1){return 0===str1.localeCompare(str2,void 0,{sensitivity:ignoreCasing?"accent":"variant"})}(n,name,!0)));return sName&&pStyles[sName]}(paragraph.StyleName));for(const styleProp of Object.keys(paragraph.Style)){const propValue=paragraph.Style[styleProp];void 0!==propValue&&(style[styleProp]=propValue)}paragraph.LeftIndent&&(style.LeftIndent=paragraph.LeftIndent);paragraph.RightIndent&&(style.RightIndent=paragraph.RightIndent);paragraph.HangingIndent&&(style.HangingIndent=paragraph.HangingIndent);paragraph.SpaceBefore&&(style.SpaceBefore=paragraph.SpaceBefore);paragraph.SpaceAfter&&(style.SpaceAfter=paragraph.SpaceAfter);return{ListStyle:paragraph.ListStyle,ListStyleType:paragraph.ListStyleType,ListLevel:paragraph.ListLevel,ListItemIndex:paragraph.ListItemIndex,Style:{LeftIndent:style.LeftIndent&&exprCompiler.compLength(style.LeftIndent),RightIndent:style.RightIndent&&exprCompiler.compLength(style.RightIndent),HangingIndent:style.HangingIndent&&exprCompiler.compLength(style.HangingIndent),SpaceBefore:style.SpaceBefore&&exprCompiler.compLength(style.SpaceBefore),SpaceAfter:style.SpaceAfter&&exprCompiler.compLength(style.SpaceAfter),Color:style.Color&&exprCompiler.compColor(style.Color),BackgroundColor:style.BackgroundColor&&exprCompiler.compColor(style.BackgroundColor),FontFamily:style.FontFamily&&exprCompiler.compString(style.FontFamily),FontSize:style.FontSize&&exprCompiler.compLength(style.FontSize),FontStyle:style.FontStyle&&exprCompiler.compEnum.FontStyle(style.FontStyle),FontWeight:style.FontWeight&&exprCompiler.compEnum.FontWeight(style.FontWeight),TextAlign:style.TextAlign&&exprCompiler.compEnum.TextAlign(style.TextAlign),LineSpacing:style.LineSpacing&&exprCompiler.compLength(style.LineSpacing)}}}(paragraph,exprCompiler),textRuns=paragraph.TextRuns.map((tr=>compileTextRun(tr,exprCompiler,fields,context)));return(data,ctx)=>actions=>{const resolvedTextRuns=textRuns.map((tr=>tr(data,ctx))),resolveExpr=makeExprResolver(data,ctx),resolvedParagraph=function(compiled,resolveExpr){return{TextRuns:[],LeftIndent:compiled.Style.LeftIndent&&resolveExpr(compiled.Style.LeftIndent),RightIndent:compiled.Style.RightIndent&&resolveExpr(compiled.Style.RightIndent),HangingIndent:compiled.Style.HangingIndent&&resolveExpr(compiled.Style.HangingIndent),StyleName:"",ListStyle:compiled.ListStyle,ListStyleType:compiled.ListStyleType,ListLevel:compiled.ListLevel,ListItemIndex:compiled.ListItemIndex,SpaceBefore:compiled.Style.SpaceBefore&&resolveExpr(compiled.Style.SpaceBefore),SpaceAfter:compiled.Style.SpaceAfter&&resolveExpr(compiled.Style.SpaceAfter),Style:{TextAlign:compiled.Style.TextAlign&&resolveExpr(compiled.Style.TextAlign),Color:compiled.Style.Color&&resolveExpr(compiled.Style.Color),BackgroundColor:compiled.Style.BackgroundColor&&resolveExpr(compiled.Style.BackgroundColor),FontFamily:compiled.Style.FontFamily&&resolveExpr(compiled.Style.FontFamily),FontSize:compiled.Style.FontSize&&resolveExpr(compiled.Style.FontSize),FontStyle:compiled.Style.FontStyle&&resolveExpr(compiled.Style.FontStyle),FontWeight:compiled.Style.FontWeight&&resolveExpr(compiled.Style.FontWeight),LineSpacing:compiled.Style.LineSpacing&&resolveExpr(compiled.Style.LineSpacing)}}}(compiled,resolveExpr);return Object.assign(Object.assign({},renderParagraph(resolvedParagraph)),{TextRuns:resolvedTextRuns.map((tr=>renderTextRun(tr,context.getImageResolver()))).map((tr=>"text"===tr.type?{Type:"text",Text:tr.value,Style:tr.resolvedStyles,render:tr.render}:{Type:"image",Style:tr.resolvedStyles,render:tr.render}))})}}const mockGlobals={executiontime:dateTimeFactory_createFromString("1970-01-01T00:00:00.000"),reportfolder:"report folder",reportname:"report name"};const getMetaValue=(vnode,prop)=>{var _a,_b;return!!vnode&&"VirtualNode"===vnode.type&&(null===(_b=null===(_a=vnode)||void 0===_a?void 0:_a.properties.meta)||void 0===_b?void 0:_b[prop])},hasClassName=(vnode,classname)=>{var _a,_b;return!!vnode&&"VirtualNode"===vnode.type&&!!(null===(_b=null===(_a=vnode)||void 0===_a?void 0:_a.properties.className)||void 0===_b?void 0:_b.includes(classname))},clearMarkerText=listMarker=>{listMarker&&"VirtualNode"===listMarker.type?clearMarkerText(listMarker.children[0]):listMarker.text=""},cleanupSplittedParagraph=(paragraphNode,arr)=>{var _a;const listItemContent=hasClassName(paragraphNode.children[0],"arjs-richtext-list-item")?paragraphNode.children[0].children.find((c=>hasClassName(c,"arjs-richtext-list-item__content"))):null;!!listItemContent&&(!arr.First&&getMetaValue(listItemContent.children[0],"paragraphLineIndex")>0||arr.First&&1===listItemContent.children.length&&getMetaValue(listItemContent.children[0],"paragraphLineIndex")<0)&&clearMarkerText(null===(_a=paragraphNode.children[0])||void 0===_a?void 0:_a.children.find((c=>hasClassName(c,"arjs-richtext-list-item__marker")))),arr.First||(paragraphNode.properties.style=Object.assign(Object.assign({},paragraphNode.properties.style),{"margin-top":"0pt"})),arr.Last||(paragraphNode.properties.style=Object.assign(Object.assign({},paragraphNode.properties.style),{"margin-bottom":"0pt"}))},wrapWithTextBoxContent=content=>[h("div",{className:"arjs-textBoxContent arjs-richTextContent"},content)];function makeRender(model){const style=model.Style,sb=styleBuilder();style.Color&&sb.add("color",[style.Color]),style.FontFamily&&sb.add("fontFamily",[style.FontFamily],wrapWithQuotes),style.FontSize&&sb.add("fontSize",[style.FontSize]),style.FontStyle&&sb.add("fontStyle",[style.FontStyle],getFontStyle$1),style.FontWeight&&sb.add("fontWeight",[style.FontWeight],getFontWeight$3),style.PaddingLeft&&sb.add("paddingLeft",[style.PaddingLeft]),style.PaddingRight&&sb.add("paddingRight",[style.PaddingRight]),style.PaddingTop&&sb.add("paddingTop",[style.PaddingTop]),style.PaddingBottom&&sb.add("paddingBottom",[style.PaddingBottom]);const contentStyle=sb.style,contentClassName=`${model.Name}Style`;return{render:(data,ctx)=>(itemViewSize,getRenderTimeParagraphs,mockParagraphs=[])=>{const resolvedModel=resolveItemCommon(model,data,ctx),anchorNodes=buildAnchorNodes(resolvedModel),dynamicStyle=contentStyle.dynamic(data,ctx),id=ctx.IDGenerator.next();let patcher;if("function"==typeof getRenderTimeParagraphs||dynamicStyle.renderTimeStyle){const lineFirstIndex=(mockParagraphs=>{for(let i=0;i<mockParagraphs.length;i++)for(let j=0;j<=mockParagraphs[i].children.length;j++){const lineIndex=getMetaValue(mockParagraphs[i].children[j],"lineIndex");if("number"==typeof lineIndex)return lineIndex}return 0})(mockParagraphs),lineEndIndex=(mockParagraphs=>{for(let i=mockParagraphs.length-1;i>=0;i--)for(let j=mockParagraphs[i].children.length-1;j>=0;j--){const lineIndex=getMetaValue(mockParagraphs[i].children[j],"lineIndex");if("number"==typeof lineIndex)return lineIndex}return 0})(mockParagraphs);patcher=ctx=>{var _a,paragraphs,arr;return{id:id,style:dynamicStyle.renderTimeStyle?dynamicStyle.renderTimeStyle(ctx):null,children:"function"==typeof getRenderTimeParagraphs?wrapWithTextBoxContent([...anchorNodes,...(paragraphs=null!==(_a=getRenderTimeParagraphs(ctx)(lineFirstIndex,lineEndIndex))&&void 0!==_a?_a:[],arr=getMetaValue(mockParagraphs[0],"arrangement"),arr&&!arr.First&&paragraphs.length>0&&cleanupSplittedParagraph(paragraphs[0],arr),arr&&!arr.Last&&paragraphs.length>0&&cleanupSplittedParagraph(paragraphs[paragraphs.length-1],arr),paragraphs)]):null}}}return wrapSplittedItem(itemViewSize,h("div",{style:Object.assign(Object.assign(Object.assign({},dynamicStyle.style),{display:"block"}),buildSizeStyle(itemViewSize)),className:`arjs-itemContent arjs-textBoxItem ${contentClassName}`,patcher:patcher,id:id,title:resolvedModel.Tooltip},wrapWithTextBoxContent([...anchorNodes,...mockParagraphs])))},resolveStyles:data=>Object.assign(Object.assign({},contentStyle.static),contentStyle.dynamic(data).style),styles:[{className:contentClassName,style:contentStyle.static}]}}let containerInstance=null;function getContainer(){return null!=containerInstance?containerInstance:containerInstance=function(){const doc=document,container=doc.createElement("div");return container.style.position="absolute",container.style.left="0px",container.style.top="0px",container.style.visibility="hidden",container.style.textRendering="optimizeSpeed",doc.body.appendChild(container),container}()}const isLineBreakElement=e=>e instanceof HTMLBRElement,getElementValue=e=>{var _a;return isLineBreakElement(e)?"\n":null!==(_a=null==e?void 0:e.textContent)&&void 0!==_a?_a:""},isLinebreakRegex=/\r*\n+\r*/;function splitLines(textRuns){const lines=[];let curLine=null;for(let tRun of textRuns)null==curLine&&(curLine=[],lines.push(curLine)),curLine.push(tRun),"text"===tRun.Type&&tRun.Text.endsWith("\n")&&("chrome"===environment&&tRun.Text.endsWith(" \n")&&(tRun.Text=tRun.Text.replace(/\s\n$/,"\n")),curLine=null);return lines}function MeasureRichTextBoxSize(style,paragraphs,width){return"node"===environment?{paragraphs:paragraphs.map((p=>({Lines:[{TextRuns:p.TextRuns,Height:0}],Style:p.Style,render:p.render}))),full:{x:0,y:0,width:0,height:0}}:function(style,paragraphs,width){const content=document.createElement("div");Object.assign(content.style,style),paragraphs.forEach((paragraph=>{const paragraphElement=document.createElement("div");Object.assign(paragraphElement.style,paragraph.Style),paragraph.TextRuns.map(((textRun,i,runs)=>{const textRunSpan=document.createElement("span");switch(textRun.Type){case"text":Object.assign(textRunSpan.style,textRun.Style);const text=textRun.Text,breaker=new linebreaker(text);let bk=breaker.nextBreak(),lastPos=0;for(;bk;){if(bk.required||isLinebreakRegex.test(text))textRunSpan.appendChild(document.createElement("br"));else{const wordSpan=document.createElement("span");wordSpan.innerText=text.slice(lastPos,bk.position),textRunSpan.appendChild(wordSpan)}lastPos=bk.position,bk=breaker.nextBreak()}return textRunSpan;case"image":const imageDiv=document.createElement("div");return Object.assign(imageDiv.style,textRun.Style),textRunSpan.appendChild(imageDiv),textRunSpan}})).forEach((textRun=>paragraphElement.appendChild(textRun))),content.appendChild(paragraphElement)}));const container=getContainer();container.style.width=Length.toCss(width),container.appendChild(content);const splittedParagraphs=[];for(let i=0;i<content.children.length;i++){splittedParagraphs[i]=Object.assign(Object.assign({},paragraphs[i]),{TextRuns:[]});const paragraphElement=content.children[i];let lastWordRect={left:Number.NEGATIVE_INFINITY,right:Number.NEGATIVE_INFINITY},isPrevLineBreak=!1;for(let j=0;j<paragraphElement.children.length;j++){const textRunElement=paragraphElement.children[j];let run=paragraphs[i].TextRuns[j];switch(run.Type){case"text":let textRun=null;for(let k=0;k<textRunElement.children.length;k++){const wordElement=textRunElement.children[k],currentWordRect=wordElement.getBoundingClientRect();lastWordRect.right-currentWordRect.left>.1&&!isPrevLineBreak&&(textRun?(textRun.Text+="\n",textRun=null):splittedParagraphs[i].TextRuns.push(Object.assign(Object.assign({},lineBreakTextRun),{rects:[currentWordRect]}))),"justify"===paragraphs[i].Style.textAlign?(textRun=Object.assign(Object.assign({},run),{Text:getElementValue(wordElement),rects:[currentWordRect]}),splittedParagraphs[i].TextRuns.push(textRun)):textRun?(textRun.Text+=getElementValue(wordElement),textRun.rects.push(currentWordRect),isLineBreakElement(wordElement)&&(textRun=null)):isLineBreakElement(wordElement)?splittedParagraphs[i].TextRuns.push(Object.assign(Object.assign({},lineBreakTextRun),{rects:[currentWordRect]})):(textRun=Object.assign(Object.assign({},run),{Text:getElementValue(wordElement),rects:[currentWordRect]}),splittedParagraphs[i].TextRuns.push(textRun)),lastWordRect=currentWordRect,isPrevLineBreak=isLineBreakElement(wordElement)}break;case"image":const currentWordRect=textRunElement.children[0].getBoundingClientRect();lastWordRect.right-currentWordRect.left>.1&&!isPrevLineBreak&&splittedParagraphs[i].TextRuns.push(Object.assign(Object.assign({},lineBreakTextRun),{rects:[currentWordRect]})),lastWordRect=currentWordRect,isPrevLineBreak=!1,splittedParagraphs[i].TextRuns.push(Object.assign(Object.assign({},run),{rects:[currentWordRect]}))}}}const fullRect=container.getBoundingClientRect(),fullSize={x:Length.fromPixels(fullRect.x),y:Length.fromPixels(fullRect.y),width:Length.fromPixels(fullRect.width),height:Length.fromPixels(fullRect.height)};container.removeChild(content);let prevBottom=fullRect.top;const getLineHeight=(wordRects,isLast)=>{const bottom=wordRects.length>0?wordRects.reduce(((acc,cur)=>Math.max(acc,cur.bottom)),Number.MIN_SAFE_INTEGER):prevBottom;let height=bottom-prevBottom;return prevBottom=bottom,isLast&&(height+=fullRect.bottom-bottom),height};return{paragraphs:splittedParagraphs.filter((p=>p.TextRuns.length>0)).map(((p,pi,pars)=>({Lines:splitLines(p.TextRuns).map(((line,i,lines)=>({TextRuns:line,Height:Length.fromPixels(getLineHeight(flatten$1(line.filter((l=>!("text"===l.Type&&"\n"===l.Text))).map((l=>l.rects))),pi===pars.length-1&&i===lines.length-1))}))),Style:p.Style,render:p.render}))),full:fullSize}}(style,paragraphs,width)}let domParser=null;const emptyProps={style:{},paragraphStyleName:"",listLevel:0,listStyle:"None",listItemIndex:0,paragraphIndents:{}};function convertHTML(html,customDOMParser){const body=(null!=customDOMParser?customDOMParser:null!=domParser?domParser:domParser=new DOMParser).parseFromString(html,"text/html").body,paragraphs=[];let currentParagraph=null;function pushTextRun(text,props){text&&(currentParagraph||(currentParagraph=makeParagraph(),paragraphs.push(currentParagraph)),currentParagraph.TextRuns.push(makeTextRun(text,props)))}function convertNode(node,props,index=-1,isLastListItem=!1){var _a;if(node)switch(node.nodeType){case node.TEXT_NODE:pushTextRun((null!==(_a=node.nodeValue)&&void 0!==_a?_a:"").replace(/\r|\n/g,""),props);break;case node.ELEMENT_NODE:const element=node;if(isInlineElement(element))if("BR"===element.tagName)pushTextRun("\n",props);else if("IMG"===element.tagName){!function(props){props.Value&&(currentParagraph||(currentParagraph=makeParagraph(),paragraphs.push(currentParagraph)),currentParagraph.TextRuns.push(makeImageRun(props)))}(getImageProps(element,props))}else{const elementProps=getElementProps(element,props);element.childNodes.forEach((child=>convertNode(child,elementProps)))}else if(isBlockElement(element)){let elementProps=getElementProps(element,props,index,isLastListItem);if(["UL","OL"].includes(element.tagName)){elementProps.listLevel+=1;let itemIndex=0;const children=Array.from(element.childNodes).filter((child=>{var _a;return child.nodeType!==node.TEXT_NODE||""!==(null!==(_a=child.nodeValue)&&void 0!==_a?_a:"").replace(/\r|\n/g,"").trim()})),lastChildListItemIndex=children.map((el=>el.tagName)).lastIndexOf("LI");children.forEach(((child,childIndex)=>convertNode(child,elementProps,child.nodeType===child.ELEMENT_NODE&&"LI"===child.tagName?itemIndex++:-1,childIndex===lastChildListItemIndex))),currentParagraph=null}else if("LI"===element.tagName){const children=Array.from(element.childNodes).filter((child=>{var _a;return child.nodeType!==node.TEXT_NODE||""!==(null!==(_a=child.nodeValue)&&void 0!==_a?_a:"").replace(/\r|\n/g,"").trim()})),firstChild=children[0];(!firstChild||firstChild.nodeType===firstChild.TEXT_NODE||firstChild.nodeType===firstChild.ELEMENT_NODE&&isInlineElement(firstChild))&&(currentParagraph=makeParagraph(elementProps),paragraphs.push(currentParagraph),elementProps=Object.assign(Object.assign({},elementProps),{listStyle:"None"})),children.forEach((child=>convertNode(child,elementProps,index))),currentParagraph&&(currentParagraph.TextRuns.length&&currentParagraph.TextRuns[currentParagraph.TextRuns.length-1].Value.endsWith("\n")||pushTextRun("\n",elementProps))}else currentParagraph=makeParagraph(elementProps),paragraphs.push(currentParagraph),element.childNodes.forEach((child=>convertNode(child,elementProps))),currentParagraph=null}}}return body&&body.childNodes.forEach((node=>convertNode(node,emptyProps))),paragraphs}const getImageProps=(imgElement,parentProps=emptyProps)=>{var _a,_b,_c,_d,_e,_f;const src=null===(_a=imgElement.attributes.getNamedItem("src"))||void 0===_a?void 0:_a.value,dataValue=null===(_b=imgElement.attributes.getNamedItem("data-value"))||void 0===_b?void 0:_b.value,source=dataValue&&(null===(_c=imgElement.attributes.getNamedItem("data-source"))||void 0===_c?void 0:_c.value)||"External",value=dataValue||"External"===source&&src||"";return Object.assign(Object.assign(Object.assign({Value:value,Source:source,MIMEType:dataValue?null===(_d=imgElement.attributes.getNamedItem("data-mime-type"))||void 0===_d?void 0:_d.value:""},getInlineStyleImpl(imgElement,"Width","width","width",toValidImgLength)),getInlineStyleImpl(imgElement,"Height","height","height",toValidImgLength)),{Action:{Hyperlink:null!==(_f=null===(_e=parentProps.action)||void 0===_e?void 0:_e.Hyperlink)&&void 0!==_f?_f:"",BookmarkLink:"",Drillthrough:{Parameters:[],ReportName:""},ApplyParameters:{Parameters:[]}}})},toValidImgLength=length=>{var _a;return null!==(_a=toValidLength(length))&&void 0!==_a?_a:"1in"},toValidLength=length=>{try{return Length.toCss(Length.parse(length))}catch(_a){return length.endsWith("px")?convertPxToPt(length):void 0}},convertPxToPt=length=>{const stringValue=length.substr(0,length.length-2),value=parseFloat(stringValue);return Length.toCss(Length.fromPixels(value))};const getElementProps=(element,parentProps=emptyProps,index=-1,isLastListItem=!1)=>{var _a,_b;const inlineStyles=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},getInlineStyle(element,"Color","color","color")),getInlineStyle(element,"BackgroundColor","background-color","bgcolor")),getInlineStyle(element,"FontFamily","font-family")),getInlineStyle(element,"FontSize","font-size","",toValidLength)),getInlineStyle(element,"FontStyle","font-style")),getInlineStyle(element,"FontWeight","font-weight")),getInlineStyle(element,"TextAlign","text-align","align")),function(element){let textDecoration;const valueParts=(element.style.getPropertyValue("text-decoration").replace(/^"|"$/g,"")||`${element.style.getPropertyValue("text-decoration-line").replace(/^"|"$/g,"")} ${element.style.getPropertyValue("text-decoration-style").replace(/^"|"$/g,"")}`).toLowerCase().trim().split(" ");switch(valueParts[0]){case"line-through":textDecoration="LineThrough";break;case"overline":textDecoration="Overline";break;case"underline":textDecoration="double"===valueParts[1]?"DoubleUnderline":"Underline";break;default:textDecoration="None"}return"None"!==textDecoration?{TextDecoration:textDecoration}:{}}(element)),getHangingIndent=length=>{const validLength=toValidLength(length);return void 0===validLength&&parentProps.listLevel>0?parentProps.paragraphIndents.HangingIndent:validLength},getRightIndent=length=>getIndent(length,"RightIndent"),getLeftIndent=length=>getIndent(length,"LeftIndent"),getIndent=(length,propName)=>{const indent=function(lengths){let sumTwips=0;for(const length of lengths)sumTwips+=length?Length.parse(length):0;return Length.toCss(sumTwips)}([toValidLength(length),parentProps.paragraphIndents[propName]]);return"0pt"===indent?void 0:indent},paragraphIndents=isBlockElement(element)?Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},getInlineIndentStyle(element,"LeftIndent","margin-left","",getLeftIndent)),getInlineIndentStyle(element,"RightIndent","margin-right","",getRightIndent)),getInlineIndentStyle(element,"SpaceBefore","margin-top","",toValidLength)),getInlineIndentStyle(element,"SpaceAfter","margin-bottom","",toValidLength)),getInlineIndentStyle(element,"HangingIndent","text-indent","",getHangingIndent)):{};let paragraphStyleName="",hyperlink=null,listStyle="None",listStyleType="None";switch(element.tagName){case"I":case"EM":inlineStyles.FontStyle="Italic";break;case"B":case"STRONG":inlineStyles.FontWeight="Bold";break;case"DEL":case"S":case"STRIKE":inlineStyles.TextDecoration="LineThrough";break;case"U":case"INS":inlineStyles.TextDecoration="Underline";break;case"P":paragraphStyleName="P";break;case"H1":paragraphStyleName="H1";break;case"H2":paragraphStyleName="H2";break;case"H3":paragraphStyleName="H3";break;case"H4":paragraphStyleName="H4";break;case"H5":paragraphStyleName="H5";break;case"H6":paragraphStyleName="H6";break;case"SUB":inlineStyles.Subscript=!0,inlineStyles.Superscript=!1;break;case"SUP":inlineStyles.Superscript=!0,inlineStyles.Subscript=!1;break;case"A":hyperlink=element.getAttribute("href"),inlineStyles.Color="Blue",inlineStyles.TextDecoration="Underline";break;case"OL":listStyle="Numbered",listStyleType=getListStyleType(element.style.getPropertyValue("list-style-type"));break;case"UL":listStyle="Bullet",listStyleType=getListStyleType(element.style.getPropertyValue("list-style-type"));break;case"LI":parentProps.listLevel>0&&["Numbered","Bullet"].includes(parentProps.listStyle)&&(0!==index||paragraphIndents.SpaceBefore||(paragraphIndents.SpaceBefore=parentProps.paragraphIndents.SpaceBefore),isLastListItem&&!paragraphIndents.SpaceAfter&&(paragraphIndents.SpaceAfter=parentProps.paragraphIndents.SpaceAfter))}return{style:Object.assign(Object.assign({},parentProps.style),inlineStyles),paragraphIndents:paragraphIndents,paragraphStyleName:paragraphStyleName,action:{Hyperlink:null!==(_b=null!=hyperlink?hyperlink:null===(_a=parentProps.action)||void 0===_a?void 0:_a.Hyperlink)&&void 0!==_b?_b:"",BookmarkLink:"",Drillthrough:{Parameters:[],ReportName:""},ApplyParameters:{Parameters:[]}},listLevel:parentProps.listLevel,listStyle:"None"!==listStyle||-1===index?listStyle:parentProps.listStyle,listStyleType:-1===index?listStyleType:parentProps.listStyleType,listItemIndex:index}},getInlineStyle=(element,propName,cssPropName,attrName="",convertValue)=>getInlineStyleImpl(element,propName,cssPropName,attrName,convertValue),getInlineIndentStyle=(element,propName,cssPropName,attrName="",convertValue)=>getInlineStyleImpl(element,propName,cssPropName,attrName,convertValue),getInlineStyleImpl=(element,propName,cssPropName,attrName="",convertValue)=>{var _a;const inlineStyles={},attrValue=null===(_a=element.attributes.getNamedItem(attrName))||void 0===_a?void 0:_a.value,cssValue=element.style.getPropertyValue(cssPropName).replace(/^"|"$/g,"");let value=null!=attrValue?attrValue:cssValue;return convertValue&&(value=convertValue(value)),value&&(inlineStyles[propName]=value),inlineStyles},getListStyleType=styleValue=>styleValue.split("-").map((p=>p.length>=2?p[0].toUpperCase()+p.substring(1):"")).join("");const isInlineElement=element=>["I","EM","B","STRONG","BR","SPAN","SUB","SUP","A","DEL","INS","S","STRIKE","U","IMG"].includes(element.tagName),isBlockElement=element=>["P","H1","H2","H3","H4","H5","H6","UL","OL","LI"].includes(element.tagName),makeTextRun=(value,props)=>{var _a;const defaultTextrun=createTextRun();return Object.assign(Object.assign({},defaultTextrun),{Value:value,StyleName:"",Style:Object.assign(Object.assign({},defaultTextrun.Style),props.style),Action:null!==(_a=props.action)&&void 0!==_a?_a:createAction()})},makeImageRun=props=>{const defaultImagerun=function(){const d=cjs$1.Model.ReportItem.decode({Type:"richtext",Name:"",Paragraphs:[{TextRuns:[{Type:"image"}]}]});if("error"===d.type)throw new Error(`Fatal Error: can't create richtext item: ${d.reason}`);return d.value.Paragraphs[0].TextRuns[0]}();return Object.assign(Object.assign({},defaultImagerun),{Value:props.Value||"",Width:props.Width||"1in",Height:props.Height||"1in",Source:props.Source||"External",MIMEType:props.MIMEType||"",Action:props.Action||{Hyperlink:"",BookmarkLink:"",Drillthrough:{Parameters:[],ReportName:""},ApplyParameters:{Parameters:[]}}})},makeParagraph=(props=emptyProps)=>{const defaultParagraph=createParagraph();return Object.assign(Object.assign(Object.assign({},createParagraph()),props.paragraphIndents),{TextRuns:[],StyleName:props.paragraphStyleName,ListStyle:props.listStyle,ListStyleType:props.listStyleType,ListLevel:props.listLevel,ListItemIndex:props.listItemIndex,Style:Object.assign(Object.assign({},defaultParagraph.Style),props.style)})},defaultRichTextBox=createReportItem({Type:"richtext"},"default");function makeLayout(lContext,lRichText,paragraphs,data,renderCompiled,resolveStyles,ctx){var _a;const measuredParagraphs=MeasureRichTextBoxSize(resolveStyles(data),null!==(_a=function(paragraphs,ctx){return"function"==typeof paragraphs?paragraphs({Data:{globals:mockGlobals},PaginationService:defaultPagination,GetDocumentPath:ctx.GetDocumentPath}):paragraphs}(paragraphs,ctx))&&void 0!==_a?_a:[],lRichText.Width),content="function"==typeof paragraphs?globals=>{var _a;return MeasureRichTextBoxSize(resolveStyles(data),null!==(_a=paragraphs(globals))&&void 0!==_a?_a:[],lRichText.Width).paragraphs}:measuredParagraphs.paragraphs;return buildRichTextItem(lContext)(lRichText,measuredParagraphs.paragraphs,content,(ivs=>(ps,rps)=>renderCompiled(ivs,rps,ps)))}const buildRichTextItem=lConfig=>(lRichtext,mockParagraphs,runtimeParagraphs,makeResult)=>{var _a,_b,_c;let lineIndex=0;const makeTextRuns=textRuns=>textRuns.map((tr=>"text"===tr.Type?tr.render(tr.Text):tr.render())),makeLine=(runs,paragraphLineIndex,currentLineIndex)=>h("span",{className:"arjs-textLine",meta:{lineIndex:currentLineIndex,paragraphLineIndex:paragraphLineIndex}},runs),paragraphs=null!==(_b=null===(_a=LazyList.fromArray(mockParagraphs))||void 0===_a?void 0:_a.map((p=>{var _a;let paragraphLineIndex=0;const lines=null===(_a=LazyList.fromArray(p.Lines))||void 0===_a?void 0:_a.map((l=>{const textRuns=makeTextRuns(l.TextRuns),currentLineIndex=lineIndex;lineIndex++;const currentParagraphLineIndex=paragraphLineIndex;paragraphLineIndex++;return(lContext=lConfig,(makeResult,makeFiller)=>line=>textRuns=>hSpace=>{const lFuncHorz=wSpace=>LResult.Complete(line.Width,makeResult(textRuns));return line.Height<hSpace?LResult.Complete(line.Height,lFuncHorz):line.Height>lContext.ContainerHeight&&hSpace===lContext.ContainerHeight?LResult.Complete(hSpace,lFuncHorz):LResult.Split(lContext.CanGrow?hSpace:0,(wSpace=>LResult.Complete(line.Width,makeFiller())),(hs=>LResult.Complete(hs>line.Height?line.Height:hs,lFuncHorz)))})((runs=>makeLine(runs,currentParagraphLineIndex,currentLineIndex)),(()=>makeLine([],-1)))({Width:lRichtext.Width,Height:l.Height})(textRuns);var lContext}));return((makeResult,cnv)=>linesLayout=>L.Arrange(L2.VerticalStack(linesLayout,((dir,w,h,lines)=>makeResult(w,h,null!=lines?lines:[])),((w,h)=>makeResult(w,h,[]))),((arr,t1)=>L.ConvertBody(t1,cnv(arr))),!0))(((w,h,lines)=>p.render(lines)),(arr=>paragraphNode=>(arr.First&&arr.Last||(paragraphNode.properties.meta=Object.assign(Object.assign({},paragraphNode.properties.meta),{arrangement:arr}),cleanupSplittedParagraph(paragraphNode,arr)),paragraphNode)))(null!=lines?lines:null)})))&&void 0!==_b?_b:null,getRenderTimeParagraphs="function"==typeof runtimeParagraphs?globals=>(lineStartIndex,lineEndIndex)=>{const resolvedParagraphs=runtimeParagraphs(globals)||[];let linesCount=0;const paragraphsSlice=[];for(let pi=0;pi<resolvedParagraphs.length;pi++){if(linesCount+resolvedParagraphs[pi].Lines.length>=lineStartIndex+1){const lines=resolvedParagraphs[pi].Lines.slice(Math.max(0,lineStartIndex-linesCount),Math.min(resolvedParagraphs[pi].Lines.length,lineEndIndex-linesCount+1));paragraphsSlice.push(resolvedParagraphs[pi].render(lines.map((line=>makeLine(makeTextRuns(line.TextRuns))))))}if(linesCount+=resolvedParagraphs[pi].Lines.length,linesCount>lineEndIndex)break}return paragraphsSlice}:null;return null!==(_c=((lItem,makeResult,setHeight,cnv,clipVertically)=>(mockParagraphs,runtimeParagraphs)=>{let result=L.Arrange(L.TakeAtLeast(L.StackLazyList(mockParagraphs,((height,lazyItems)=>{var _a;const paragraphs=null===(_a=null==lazyItems?void 0:lazyItems.map((it=>it.Body)).filter(isNotNull))||void 0===_a?void 0:_a.map((it=>it(lItem.Width))).map((lResult=>lResult.Body)).filter(isNotNull);return L.Static(lItem.Width,null,null,0,((hArrangement,hspace,hoffset)=>{var _a;const itemViewSize={VisibleWidth:hspace,VisibleHeight:height,FullWidth:lItem.Width,FullHeight:height,HOffset:hoffset,VOffset:0};return makeResult(itemViewSize)(null!==(_a=null==paragraphs?void 0:paragraphs.toArray())&&void 0!==_a?_a:[],runtimeParagraphs)}))})),lItem.Height,((n,r)=>L.ConvertBody(r,setHeight(n)))),((arr,t1)=>L.ConvertBody(t1,cnv(arr))),!0);return!1===lItem.CanGrow&&(result=L2.ClipVertical(result,lItem.Height,clipVertically)),result})(lRichtext,makeResult,(n=>r=>(null!==n&&(r.properties.style.height=Length.toCss(n)),r)),(arr=>x=>(arr.First||(x.properties.style.paddingTop="0pt"),arr.Last||(x.properties.style.paddingBottom="0pt"),x)),VDomFragmentFactory.clipVertically)(paragraphs,getRenderTimeParagraphs))&&void 0!==_c?_c:Empty2(h("div",[]))};function wrapReportItem(item,compiledItem,compileCtx){if(!compiledItem)return null;const resultItem={Query:compiledItem.Query,Layout:(itemData,ctx)=>{const resData=compiledItem.Layout(itemData,ctx);return actions=>{const resActions=resData(actions);return(width,height)=>{let resultLayout=resActions(width,height);(item=>"dvchart"===item.Type||"sparkline"===item.Type||"line"===item.Type||"bullet"===item.Type||"checkbox"===item.Type||"KeepTogether"in item&&item.KeepTogether)(item)&&(resultLayout=compileCtx.Layout.KeepTogether(resultLayout));const pageBreak=(item=>"PageBreak"in item?item.PageBreak:null)(item);pageBreak&&"None"!==pageBreak&&("Between"===pageBreak||(resultLayout=L2.PageBreak(resultLayout,pageBreak)));const layerName=(item=>"LayerName"in item?item.LayerName:null)(item);var itemLayout,layerClassName;return layerName&&(itemLayout=resultLayout,layerClassName=compileCtx.getLayerClassName(layerName),resultLayout=itemLayout&&layerClassName?L2.ConvertBody(itemLayout,(div=>(div&&(div.properties.className=div.properties.className?`${div.properties.className} ${layerClassName}`:layerClassName),div))):itemLayout),resultLayout}}},Styles:compiledItem.Styles,DocumentMap:compiledItem.DocumentMap},visibility=(item=>"tablix"===item.Type||"table"===item.Type||"line"===item.Type||"sparkline"===item.Type||"bullet"===item.Type||"rectangleitemsite"===item.Type||"tablixcell"===item.Type?item.Visibility:null)(item);if(visibility){return compileVisibility$3(visibility,resultItem,"tablixcell"===item.Type?()=>renderEmptyTableCell():()=>renderEmpty(0,0),compileCtx)}return resultItem}const compileMap={textbox:function(definition,context){return __awaiter(this,void 0,void 0,(function*(){const fields=[],query={Fields:fields,Regions:[]};const compiledTb=function(definition,context,comp,fields){var _a;const locValues=context.GetLocalizedValue(definition.Name,"Value",definition.Value),locValue=function(value,locales,exprCompiler){const valueCompiled=exprCompiler(value),localizedValues=locales.map((lr=>({Language:lr.Language,Value:exprCompiler(lr.Value)})));return lang=>{const localized=localizedValues.find((l=>l.Language===lang));return localized?localized.Value:valueCompiled}}(locValues.DefaultValue,locValues.Locales,(v=>comp(context.DocumentMap.AddHeadingLevel(v,definition.Label,definition.Style.HeadingLevel)))),exprCompiler=createTypedCompiler(comp),writingMode=exprCompiler.compileEnum.WritingMode(definition.Style.WritingMode,defaultTextBox.Style.WritingMode),shrinkToFit=exprCompiler.compileBoolean(definition.Style.ShrinkToFit,defaultTextBox.Style.ShrinkToFit),valueFormat=exprCompiler.compileString(definition.Style.Format,defaultTextBox.Style.Format),formatLanguage=exprCompiler.compileString(definition.Style.Language,defaultTextBox.Style.Language),value=(data,ctx)=>{const resolvedLanguage=safeResolveCompiledData(formatLanguage,data,"Language",ctx),language=resolvedLanguage&&"Default"!==resolvedLanguage?Format(resolvedLanguage,null,null):ctx.Language;return resolveCompiled$1(locValue(language),data,ctx)},formattedValue=formatCompiledValue(value,valueFormat,formatLanguage);return{Type:"textbox",Name:context.ReportID+definition.Name,OriginalName:definition.Name,Value:formattedValue,ValueUnformatted:value,OriginalValue:wrapOriginalValue(definition.Value),CanGrow:context.Layout.CanChangeItemsSize&&definition.CanGrow,CanShrink:definition.CanShrink,ShrinkToFit:compileShrinkToFit(shrinkToFit,writingMode),Label:exprCompiler.compileString(definition.Label),Action:compileAction$1(null!==(_a=definition.Action)&&void 0!==_a?_a:createAction(),fields),Bookmark:exprCompiler.compileString(definition.Bookmark,defaultTextBox.Bookmark),Tooltip:exprCompiler.compileString(definition.ToolTip,defaultTextBox.ToolTip),HeadingLevel:exprCompiler.compileNumber(definition.Style.HeadingLevel),InitialToggleState:exprCompiler.compileBoolean(definition.ToggleImage.InitialState,defaultTextBox.ToggleImage.InitialState),Style:{Angle:definition.Style.Angle,Color:exprCompiler.compileColor(definition.Style.Color,defaultTextBox.Style.Color),TextAlign:exprCompiler.compileEnum.TextAlign(definition.Style.TextAlign,defaultTextBox.Style.TextAlign),VerticalAlign:exprCompiler.compileEnum.VerticalAlign(definition.Style.VerticalAlign,defaultTextBox.Style.VerticalAlign),TextDecoration:exprCompiler.compileEnum.TextDecoration(definition.Style.TextDecoration,defaultTextBox.Style.TextDecoration),Format:valueFormat,Language:formatLanguage,TextJustify:definition.Style.TextJustify,FontFamily:exprCompiler.compileString(definition.Style.FontFamily,defaultTextBox.Style.FontFamily),FontSize:exprCompiler.compileLength(definition.Style.FontSize,defaultTextBox.Style.FontSize),FontStyle:exprCompiler.compileEnum.FontStyle(definition.Style.FontStyle,defaultTextBox.Style.FontStyle),FontWeight:exprCompiler.compileEnum.FontWeight(definition.Style.FontWeight,defaultTextBox.Style.FontWeight),PaddingLeft:exprCompiler.compileLength(definition.Style.PaddingLeft,defaultTextBox.Style.PaddingLeft),PaddingRight:exprCompiler.compileLength(definition.Style.PaddingRight,defaultTextBox.Style.PaddingRight),PaddingTop:exprCompiler.compileLength(definition.Style.PaddingTop,defaultTextBox.Style.PaddingTop),PaddingBottom:exprCompiler.compileLength(definition.Style.PaddingBottom,defaultTextBox.Style.PaddingBottom),Direction:exprCompiler.compileEnum.Direction(definition.Style.Direction,defaultTextBox.Style.Direction),WrapMode:exprCompiler.compileEnum.WrapMode(definition.Style.WrapMode,defaultTextBox.Style.WrapMode),LineHeight:exprCompiler.compileString(definition.Style.LineHeight,defaultTextBox.Style.LineHeight),LineSpacing:exprCompiler.compileLength(definition.Style.LineSpacing),CharacterSpacing:exprCompiler.compileLength(definition.Style.CharacterSpacing,defaultTextBox.Style.CharacterSpacing),WritingMode:writingMode,MinCondenseRate:(minCondenseRate=exprCompiler.compileNumber(definition.Style.MinCondenseRate,defaultTextBox.Style.MinCondenseRate),data=>Math.max(10,Math.min(100,toNumber$1(safeResolveCompiledData(minCondenseRate,data))))/100),UprightInVerticalText:exprCompiler.compileEnum.UprightInVerticalText(definition.Style.UprightInVerticalText,defaultTextBox.Style.UprightInVerticalText)}};var minCondenseRate}(definition,context,(function(value){return compileExpression(value,fields,Object.assign(Object.assign({},context.EvaluationContext),{SelfID:context.ReportID+definition.Name}))}),fields),toggled=(actions,scopeId)=>actions.ScopeToggles.filter((a=>"toggle"===a.Type&&1===a.ItemPath.length&&a.ScopeId===scopeId&&definition.Name===a.ItemPath[0])).length%2>0,{render:render,measure:measure,styles:styles}=makeRender$f(compiledTb,((data,ctx)=>{const initialToggleState=toBoolean(safeResolveCompiledData(compiledTb.InitialToggleState,data));return actions=>{return actions.IsToggle(definition.Name)?{Type:"toggle",Action:(scopeId=data.Id,{Type:"toggle",ItemPath:[...context.Path,definition.Name],ScopeId:scopeId}),IsExpanded:!initialToggleState!==toggled(actions,data.Id)}:null;var scopeId}}),((data,ctx)=>actions=>""===definition.UserSort.SortExpression?null:function(userSort,ctx,actions,controllerScopeId){const sortDirection=(actions,scopeId)=>{const scopeSort=(actions.SortState[scopeId]||{})[userSort.SortExpressionScope];return scopeSort&&scopeSort.Expression===userSort.SortExpression?scopeSort.Direction:null},sortScopeId=userSort.SortTarget?ctx.ParentScopes[userSort.SortTarget]||ctx.PeerScopes[userSort.SortTarget]:controllerScopeId;if(void 0===sortScopeId)return console.warn(`UserSort SortTarget scope '${userSort.SortTarget}' is undefined`),null;return{Type:"sort",Action:{Type:"sort",ScopeId:sortScopeId,Expression:userSort.SortExpression,ExpressionScope:userSort.SortExpressionScope},SortDirection:sortDirection(actions,sortScopeId)}}(definition.UserSort,ctx,actions,data.Id)),context.getResourceUri);return{Query:query,Layout:(data,ctx)=>actions=>(ctx=Object.assign(Object.assign({},ctx),{GetDocumentPath:()=>{const node=ctx.getDocumentMapNode({Name:definition.Name,ScopeId:data.Id});return node?node.path.map(((l,idx)=>context.DocumentMap.FormatLevelNumber(idx,l+1))).join("."):""}}),(width,height)=>{const resolvedValue=resolveCompiled$1(compiledTb.ValueUnformatted,data,ctx),resolvedTextValue=resolveCompiled$1(compiledTb.Value,data,ctx);return function(model,width,height,data,value,renderCompiled,measureText,ctx){const shrinkToFit=1===model.Style.MinCondenseRate(data)&&model.ShrinkToFit(data);return layout$b({CanGrow:!shrinkToFit&&model.CanGrow,CanShrink:!shrinkToFit&&model.CanShrink},value,width,height,((itemViewSize,text)=>renderCompiled(itemViewSize,text)),(()=>measureText(resolveTextForMeasure(value,ctx)||"",width)))}(compiledTb,width,height,data,resolvedTextValue,render(data,ctx)(actions)(resolvedValue),measure(data,ctx)(actions),ctx)}),Styles:styles,DocumentMap:buildDocumentMap(definition.Name,compiledTb,context.DocumentMap,[])}}))},rectangle:compile$s,section:compile$s,pagesection:compile$s,fixedpagesection:compile$s,rectangleitemsite:function(definition,context){return __awaiter(this,void 0,void 0,(function*(){const content=definition.Content,contentCompiled=yield compile$2(content,context);if(null===contentCompiled)return null;const{Query:contentQuery,Layout:contentLayout,Styles:contentStyles}=contentCompiled,isDataRegion=isRegion(content)&&contentQuery.Regions[0],queryFields=isDataRegion?contentQuery.Regions[0].Content.Fields:contentQuery.Fields,selfId="section"!==content.Type&&"pagesection"!==content.Type?context.ReportID+content.Name:void 0,comp=value=>compileExpression(value,queryFields,Object.assign(Object.assign({},context.EvaluationContext),{SelfID:selfId})),bgImage=definition.BackgroundImage&&compileBackgroundImageData(definition.BackgroundImage,comp,context.getResourceUri),exprCompiler=createTypedCompiler(comp),compiled=Object.assign({Name:context.ReportID+definition.Name,BackgroundColor:exprCompiler.compileColor(definition.BackgroundColor,"Transparent"),BackgroundImage:bgImage,RoundingRadius:definition.RoundingRadius&&{Default:exprCompiler.compileLength(definition.RoundingRadius.Default),TopLeft:exprCompiler.compileLength(definition.RoundingRadius.TopLeft),TopRight:exprCompiler.compileLength(definition.RoundingRadius.TopRight),BottomLeft:exprCompiler.compileLength(definition.RoundingRadius.BottomLeft),BottomRight:exprCompiler.compileLength(definition.RoundingRadius.BottomRight)},ShapeStyle:null!=definition.ShapeStyle?exprCompiler.compileEnum.ShapeStyle(definition.ShapeStyle):null,ZIndex:definition.ZIndex,LayerName:definition.LayerName},compileBorders(definition.Borders,exprCompiler)),siteDataMap=isDataRegion?data=>data.Regions[0].Scope:data=>data,{render:render,styles:styles}=makeRender$d(compiled,context.getImageResolver());return{Query:contentQuery,Layout:(data,ctx)=>actions=>(width,height)=>context.Layout.Arrange(contentLayout(data,ctx)(actions)(width,height),render(siteDataMap(data),ctx)),Styles:contentStyles.concat(...styles),DocumentMap:(data,ctx)=>actions=>contentCompiled.DocumentMap?contentCompiled.DocumentMap(data,ctx)(actions):[]}}))},list:list,tablix:tablix,tablixcell:function(definition,context){var _a;return __awaiter(this,void 0,void 0,(function*(){const content=definition.Content,cContent=yield compile$2(content,context),isDataRegion=isRegion(content)&&(null==cContent?void 0:cContent.Query.Regions[0]),queryFields=cContent?isDataRegion?cContent.Query.Regions[0].Content.Fields:cContent.Query.Fields:[],comp=value=>compileExpression(value,queryFields,Object.assign(Object.assign({},context.EvaluationContext),{SelfID:context.ReportID+content.Name})),bgImage=definition.BackgroundImage&&compileBackgroundImageData(definition.BackgroundImage,comp,context.getResourceUri),compiledRowNumber="body"===definition.CellType?comp("=RowNumber()"):null,exprCompiler=createTypedCompiler(comp),compiled=Object.assign({Name:context.ReportID+definition.Name,BackgroundColor:null!==definition.BackgroundColor?exprCompiler.compileColor(definition.BackgroundColor):null,BackgroundImage:bgImage,VerticalAlign:null!==definition.VerticalAlign?exprCompiler.compileEnum.VerticalAlign(definition.VerticalAlign):null,Label:null!==definition.Label?exprCompiler.compileString(definition.Label):null,RoundingRadius:definition.RoundingRadius&&{Default:exprCompiler.compileLength(definition.RoundingRadius.Default),TopLeft:exprCompiler.compileLength(definition.RoundingRadius.TopLeft),TopRight:exprCompiler.compileLength(definition.RoundingRadius.TopRight),BottomLeft:exprCompiler.compileLength(definition.RoundingRadius.BottomLeft),BottomRight:exprCompiler.compileLength(definition.RoundingRadius.BottomRight)},Action:compileAction$1(null!==(_a=definition.Action)&&void 0!==_a?_a:createAction(),queryFields)},definition.Borders&&compileBorders(definition.Borders,exprCompiler)),siteDataMap=isDataRegion?data=>data.Regions[0].Scope:data=>data,{render:render,styles:styles}=makeRender$c(compiled,context.getImageResolver());return{Query:cContent?cContent.Query:{Fields:queryFields,Regions:[]},Layout:(data,ctx)=>{const dataRes=cContent&&cContent.Layout(data,ctx),siteData=siteDataMap(data);return actions=>{const actionsRes=dataRes&&dataRes(actions);return(width,height)=>L2.ConvertBody(function(content,makeResult){return L2.ConvertBody(content,makeResult)}(actionsRes?actionsRes(width,height):Empty2(h("div",[])),render(siteData,ctx)),(vnode=>(vnode.properties.meta=Object.assign(Object.assign({},vnode.properties.meta),{rowNumber:resolveCompiled$1(compiledRowNumber,data),cellType:definition.CellType}),vnode)))}},Styles:(cContent&&cContent.Styles||[]).concat(...styles),DocumentMap:(data,ctx)=>actions=>cContent&&cContent.DocumentMap?cContent.DocumentMap(data,ctx)(actions):[]}}))},bandedlist:bandedlist,shape:function(definition,context){return __awaiter(this,void 0,void 0,(function*(){const query={Fields:[],Regions:[]};const exprCompiler=createTypedCompiler((function(value){return compileExpression(value,query.Fields,context.EvaluationContext)})),compiled={Type:"shape",Name:context.ReportID+definition.Name,ShapeStyle:exprCompiler.compileEnum.ShapeStyle(definition.ShapeStyle,defaultShape.ShapeStyle),Label:exprCompiler.compileString(definition.Label),Bookmark:exprCompiler.compileString(definition.Bookmark,defaultShape.Bookmark),Tooltip:exprCompiler.compileString(definition.ToolTip,defaultShape.ToolTip)},{render:render,styles:styles}=makeRender$a(compiled);return{Query:query,Layout:(data,ctx)=>actions=>(width,height)=>makeLayout$b(0,width,height,data,render,ctx),Styles:styles,DocumentMap:buildDocumentMap(definition.Name,compiled,context.DocumentMap,[])}}))},image:function(definition,context){var _a;return __awaiter(this,void 0,void 0,(function*(){const query={Fields:[],Regions:[]};function comp(value){return compileExpression(value,query.Fields,context.EvaluationContext)}const locValues=context.GetLocalizedValue(definition.Name,"Value",definition.Value),locSources=context.GetLocalizedValue(definition.Name,"Source",definition.Source),defaultImageData={Source:locSources.DefaultValue,Value:locValues.DefaultValue,MIMEType:definition.MIMEType},defaultData=locValues.Locales.length||locSources.Locales.length?null:compileImageData(defaultImageData,comp,context.getResourceUri),imageDataLocalized=locValues.Locales.length||locSources.Locales.length?function(defaultImage,locValues,locSources,comp,getResourceUri){const defaultData=compileImageData(defaultImage,comp,getResourceUri),locData=uniq([...locValues.map((l=>l.Language.toLowerCase())),...locSources.map((l=>l.Language.toLowerCase()))]).map((lang=>{const locValue=locValues.find((l=>l.Language.toLowerCase()===lang)),locSource=locSources.find((s=>s.Language.toLowerCase()===lang));return{Language:lang,Value:compileImageData(Object.assign(Object.assign({},defaultImage),{Source:locSource?locSource.Value:defaultImage.Source,Value:locValue?locValue.Value:defaultImage.Value}),comp,getResourceUri)}}));return lang=>{const d=locData.find((l=>l.Language===lang.toLowerCase()));return d?d.Value:defaultData}}(defaultImageData,locValues.Locales,locSources.Locales,comp,context.getResourceUri):null,exprCompiler=createTypedCompiler(comp),compiled=Object.assign({Type:"image",Name:context.ReportID+definition.Name,Sizing:definition.Sizing,HorizontalAlignment:exprCompiler.compileEnum.HorizontalImageAlign(definition.HorizontalAlignment,defaultImage.HorizontalAlignment),VerticalAlignment:exprCompiler.compileEnum.VerticalImageAlign(definition.VerticalAlignment,defaultImage.VerticalAlignment),Label:exprCompiler.compileString(definition.Label,defaultImage.Label),Bookmark:exprCompiler.compileString(definition.Bookmark,defaultImage.Bookmark),Tooltip:exprCompiler.compileString(definition.ToolTip,defaultImage.ToolTip),Action:compileAction$1(null!==(_a=definition.Action)&&void 0!==_a?_a:createAction(),query.Fields),Style:{PaddingLeft:exprCompiler.compileLength(definition.Style.PaddingLeft,defaultImage.Style.PaddingLeft),PaddingRight:exprCompiler.compileLength(definition.Style.PaddingRight,defaultImage.Style.PaddingRight),PaddingTop:exprCompiler.compileLength(definition.Style.PaddingTop,defaultImage.Style.PaddingTop),PaddingBottom:exprCompiler.compileLength(definition.Style.PaddingBottom,defaultImage.Style.PaddingBottom)}},defaultData),{render:render,styles:styles}=makeRender$9(compiled,context.getImageResolver(),context.getResourceUri);return{Query:query,Layout:(data,ctx)=>actions=>(width,height)=>{const imageData=imageDataLocalized&&imageDataLocalized(ctx.Language);return makeLayout$a(0,width,height,data,render(imageData),ctx)},Styles:styles,DocumentMap:buildDocumentMap(definition.Name,compiled,context.DocumentMap,[])}}))},line:function(definition,context){return __awaiter(this,void 0,void 0,(function*(){const query={Fields:[],Regions:[]};const exprCompiler=createTypedCompiler((function(value){return compileExpression(value,query.Fields,context.EvaluationContext)})),compiled={Type:"line",Name:context.ReportID+definition.Name,Label:exprCompiler.compileString(definition.Label),Bookmark:exprCompiler.compileString(definition.Bookmark,defaultLine.Bookmark),StartPoint:definition.StartPoint,EndPoint:definition.EndPoint,LineColor:exprCompiler.compileColor(definition.LineColor,defaultLine.LineColor),LineStyle:exprCompiler.compileEnum.BorderStyle(definition.LineStyle,defaultLine.LineStyle),LineWidth:exprCompiler.compileLength(definition.LineWidth,defaultLine.LineColor),ZIndex:definition.ZIndex},{render:render,styles:styles}=makeRender$8(compiled);return{Query:query,Layout:(data,ctx)=>actions=>(width,height)=>makeLayout$9(0,width,height,data,render,ctx),Styles:styles,DocumentMap:buildDocumentMap(definition.Name,compiled,context.DocumentMap,[])}}))},subreport:function(item,context){return __awaiter(this,void 0,void 0,(function*(){const subreportDefinition=yield context.getSubreport(item.ReportName);if(!subreportDefinition)return null;const content={Type:"reportcontent",ReportSections:romUpgrade_V4.getReportSections(subreportDefinition).map((rs=>"Continuous"===rs.Type?Object.assign(Object.assign({},rs),{PageHeader:void 0,PageFooter:void 0,Page:Object.assign(Object.assign({},rs.Page),{PageWidth:item.Width,LeftMargin:"0pt",RightMargin:"0pt",TopMargin:"0pt",BottomMargin:"0pt"})}):Object.assign(Object.assign({},rs),{FixedPage:Object.assign(Object.assign({},rs.FixedPage),{Pages:rs.FixedPage.Pages.map((p=>Object.assign({},function(fixedPage){const pageSize=getFixedPageSize(fixedPage);return Object.assign(Object.assign({},fixedPage),{Width:Length.toCss(getFplWidth(pageSize)),Height:Length.toCss(getFplHeight$1(pageSize)),TopMargin:"0pt",BottomMargin:"0pt",LeftMargin:"0pt",RightMargin:"0pt"})}(romUpgrade_V3.fixFplPageSize(p,rs.Page))))),Height:Length.toCss(getFplHeight$1(rs.Page))})}))),DataSets:subreportDefinition.DataSets,EmbeddedImages:subreportDefinition.EmbeddedImages,DocumentMap:subreportDefinition.DocumentMap,Layers:subreportDefinition.Layers},query={Fields:[],Regions:[]};const language=createTypedCompiler((function(value){return compileExpression(value,query.Fields)})).compileString(subreportDefinition.Language,defaultSubreport.Language),compLocalized=compileLocalizedResources(subreportDefinition.Language,subreportDefinition.LocalizationResources);let subContext=Object.assign(Object.assign({},yield context.New(item.ReportName,[...context.Path,item.Name],item.SubstituteThemeOnSubreport)),{GetLocalizedValue:compLocalized,ConsumeContainerWhitespace:subreportDefinition.ConsumeContainerWhitespace});item.SubstituteThemeOnSubreport||(subContext=yield subContext.updateTheme(subreportDefinition.ThemeUri));const compiledContent=yield compileReportContent(content,{ConsumeWhiteSpace:!1,FillHorzSpace:!1,FillVertSpace:!1},subContext,!0);if(!compiledContent)return null;const dm=combineDataQuery(query,compiledContent.Query),parameters=[];parameters.push(...subreportDefinition.ReportParameters.filter((p=>p.DefaultValue&&!isDataSetRef$1(p.DefaultValue)&&p.DefaultValue.Values&&p.DefaultValue.Values.length>0)).map((p=>({Name:p.Name.toLowerCase(),Value:!isDataSetRef$1(p.DefaultValue)&&p.DefaultValue.Values&&p.DefaultValue.Values[0]})))),parameters.push(...item.Parameters.map((p=>({Name:p.ParameterName.toLowerCase(),Value:p.Value}))));const contentFields=item.Parameters.map((p=>p.Value)),result={Query:{Fields:[],Regions:[{type:"subreport",Name:item.Name,Report:{type:"report",Name:item.ReportName,Content:query},Content:{Fields:contentFields,Regions:[]},Parameters:parameters}]},Layout:(data,parentCtx)=>{const subreportData=getGroupsData(data.Regions[0]),lang=resolveCompiled$1(language,subreportData);if("function"==typeof lang)throw new ExpressionEvaluationError("Runtime expressions are not supported in Language property.");const ctx=Object.assign(Object.assign({},parentCtx),{Language:lang||"Default",ParentScopes:getDataSetScopes(compiledContent.Query.Regions,subreportData.Regions),PeerScopes:getPeerScopes(compiledContent.Query.Regions,subreportData.Regions)});return actions=>(width,height)=>((data,ctx)=>actions=>(w,h)=>{const l=LazyList.fromArray(compiledContent.Layout.map((sl=>sl.L(dm(data),ctx)(actions).L(w,h))));return L2.VerticalStack(PageBreakList("Between")(l),renderer.makePage,renderer.makeEmptyFragment)})(subreportData,ctx)(getSubActions(actions,item.Name))(width,height)},Styles:compiledContent.Styles,DocumentMap:(data,ctx)=>actions=>compiledContent.DocumentMap?compiledContent.DocumentMap(getGroupsData(data.Regions[0]),ctx)(getSubActions(actions,item.Name)):[]};return function(itemDef,compileCtx){const labelsQuery_Fields=[],exprComp=createTypedCompiler((function(value){return compileExpression(value,labelsQuery_Fields,compileCtx.EvaluationContext)})),labelTest=exprComp.compileString(itemDef.Label),bookmarkTest=exprComp.compileString(itemDef.Bookmark,defaultSubreport$1.Bookmark),tooltipTest=exprComp.compileString(itemDef.Tooltip,defaultSubreport$1.ToolTip);return isEmptyValue(labelTest)&&isEmptyValue(bookmarkTest)&&isEmptyValue(tooltipTest)?compiledItem=>compiledItem:compiledItem=>{const{Query:query,Layout:layout,DocumentMap:docMap}=compiledItem,exprCompiler=createTypedCompiler((function(value){return compileExpression(value,labelsQuery_Fields,compileCtx.EvaluationContext)})),label=exprCompiler.compileString(itemDef.Label),bookmark=exprCompiler.compileString(itemDef.Bookmark,defaultSubreport$1.Bookmark),tooltip=exprCompiler.compileString(itemDef.Tooltip,defaultSubreport$1.ToolTip),itemCommon={Name:itemDef.Name,Label:label,Bookmark:bookmark,Tooltip:tooltip};return Object.assign(Object.assign({},compiledItem),{Layout:(data,ctx)=>{const withData=layout(data,ctx);return actions=>{const withActions=withData(actions);return(w,h)=>{const l=withActions(w,h);return L2.ConvertFirstBody(l,(firstDiv=>{if("DIV"!==firstDiv.tagName)return firstDiv;const resolved=resolveItemCommon(itemCommon,data,ctx);return firstDiv.children=[...buildAnchorNodes(resolved),...firstDiv.children],resolved.Tooltip&&(firstDiv.properties.attributes=Object.assign(Object.assign({},firstDiv.properties.attributes),{title:resolved.Tooltip})),firstDiv}))}}},DocumentMap:buildDocumentMap(itemDef.Name,itemCommon,compileCtx.DocumentMap,[docMap]),Query:query})}}({Name:item.Name,Label:item.Label,Bookmark:item.Bookmark,Tooltip:item.ToolTip},context)(yield compileNoRowsMessage(result,item,context))}))},checkbox:function(definition,context){return __awaiter(this,void 0,void 0,(function*(){const query={Fields:[],Regions:[]};const compiled=function(definition,context,comp){const exprCompiler=createTypedCompiler(comp);return{Type:"checkbox",Name:context.ReportID+definition.Name,CheckAlignment:definition.CheckAlignment,Checked:exprCompiler.compileBoolean(definition.Checked,defaultCheckBox.Checked),Text:exprCompiler.compileString(definition.Text,defaultCheckBox.Text),CanGrow:!1,CanShrink:!1,Label:exprCompiler.compileString(definition.Label),Bookmark:exprCompiler.compileString(definition.Bookmark,defaultCheckBox.Bookmark),Tooltip:exprCompiler.compileString(definition.ToolTip,defaultCheckBox.ToolTip),Style:{Color:exprCompiler.compileColor(definition.Style.Color,defaultCheckBox.Style.Color),PaddingLeft:exprCompiler.compileLength(definition.Style.PaddingLeft,defaultCheckBox.Style.PaddingLeft),PaddingRight:exprCompiler.compileLength(definition.Style.PaddingRight,defaultCheckBox.Style.PaddingRight),PaddingTop:exprCompiler.compileLength(definition.Style.PaddingTop,defaultCheckBox.Style.PaddingTop),PaddingBottom:exprCompiler.compileLength(definition.Style.PaddingBottom,defaultCheckBox.Style.PaddingBottom),FontFamily:exprCompiler.compileString(definition.Style.FontFamily,defaultCheckBox.Style.FontFamily),FontSize:exprCompiler.compileLength(definition.Style.FontSize,defaultCheckBox.Style.FontSize),FontStyle:exprCompiler.compileEnum.FontStyle(definition.Style.FontStyle,defaultCheckBox.Style.FontStyle),FontWeight:exprCompiler.compileEnum.FontWeight(definition.Style.FontWeight,defaultCheckBox.Style.FontWeight),WrapMode:exprCompiler.compileEnum.WrapMode(definition.Style.WrapMode,defaultCheckBox.Style.WrapMode),TextDecoration:exprCompiler.compileEnum.TextDecoration(definition.Style.TextDecoration,defaultCheckBox.Style.TextDecoration)}}}(definition,context,(function(value){return compileExpression(value,query.Fields,context.EvaluationContext)})),{render:render,styles:styles}=makeRender$7(compiled);return{Query:query,Layout:(data,ctx)=>actions=>(width,height)=>function(model,width,height,data,ctx,renderCompiled){return layout$b(model,resolveCompiled$1(model.Text,data),width,height,((itemViewSize,text)=>renderCompiled(data,itemViewSize,text,ctx)),(()=>{throw Error("measureHeight at checkbox")}))}(compiled,width,height,data,ctx,render),Styles:styles,DocumentMap:buildDocumentMap(definition.Name,compiled,context.DocumentMap,[])}}))},fixedpage:fixedpage,tableofcontents:function(definition,context){return __awaiter(this,void 0,void 0,(function*(){const fields=[],query={Fields:fields,Regions:[]},compiledLevels=[],staticStyles=[],levelDefinitions=definition.Levels.length>0?definition.Levels:[createTableOfContentsLevel()];for(let i=0;i<levelDefinitions.length;i++){const level=levelDefinitions[i];level.LevelName=`${definition.Name}Level${i+1}`;const levelComp=compile$e(level,context),dataMap=combineDataQuery(query,levelComp.Query);compiledLevels.push({MakeL:(data,ctx,levelData)=>levelComp.Layout(dataMap(data),ctx,levelData)}),staticStyles.push(...levelComp.Styles)}const exprCompiler=createTypedCompiler((function(value){return compileExpression(value,fields,context.EvaluationContext)})),compiled={Name:context.ReportID+definition.Name,FillHorzSpace:!1,FillVertSpace:!1,ConsumeWhiteSpace:!0,CanShrink:context.Layout.CanChangeItemsSize,MaxLevel:exprCompiler.compileNumber(definition.Style.MaxLevel,defaultTalbeOfContents.Style.MaxLevel),Bookmark:exprCompiler.compileString(definition.Bookmark,defaultTalbeOfContents.Bookmark),Tooltip:exprCompiler.compileString(definition.ToolTip,defaultTalbeOfContents.ToolTip),Clip:"None",Scrollable:!1},{render:render,styles:styles}=makeRender$e(compiled);return{Query:query,Layout:(data,ctx)=>actions=>(width,height)=>{if(null==ctx.getDocumentMap)throw new Error("DocumentMap is not initialized");const docMap=ctx.getDocumentMap();return function(model,width,height,data,ctx,render,children){return layout$a(model,children,width,height,((w,h,c)=>render(data,ctx,w,h,c)),render$c)}(compiled,width,height,data,ctx,render,((documentMap,data,ctx)=>actions=>width=>{const elements=documentMap;let maxLevel=Number.parseInt(toString$1(resolveCompiled$1(compiled.MaxLevel,data)));maxLevel||(maxLevel=Number.MAX_SAFE_INTEGER);const children=[];for(let i=0;i<elements.length;i++){const item=elements[i];if(item.level>=maxLevel)continue;const level=compiledLevels[Math.min(item.level,compiledLevels.length-1)],levelData={Value:null!==item.name?item.name:"",ToCLink:item.anchor,PageNumber:globals=>{if(globals.ToCLabels&&globals.ToCLabels.length>0){const p=globals.ToCLabels.find((l=>l.content.indexOf(item.anchor)>-1));if(p)return(p.pageIndex+(context.EvaluationContext.StartPageNumber||1)).toString()}return"?"}},child={Bounds:{Location:{X:0,Y:i},Size:{Width:width,Height:0}},Body:level.MakeL(data,ctx,levelData)(actions)(width,0),IsHelper:!1};children.push(child)}return children})(docMap,data,ctx)(actions)(width))},Styles:staticStyles.concat(styles),DocumentMap:()=>()=>[]}}))},sparkline:sparkline,bullet:function(definition,context){return __awaiter(this,void 0,void 0,(function*(){const query={Fields:[],Regions:[]};const exprCompiler=createTypedCompiler((function(value){return compileExpression(value,query.Fields,context.EvaluationContext)})),compiled={Type:"bullet",Name:context.ReportID+definition.Name,Label:exprCompiler.compileString(definition.Label),Bookmark:exprCompiler.compileString(definition.Bookmark,defaultBullet.Bookmark),Tooltip:exprCompiler.compileString(definition.ToolTip,defaultBullet.ToolTip),LabelFormat:exprCompiler.compileString(definition.LabelFormat,defaultBullet.LabelFormat),LabelFontFamily:exprCompiler.compileString(definition.LabelFontFamily,defaultBullet.LabelFontFamily),LabelFontSize:exprCompiler.compileLength(definition.LabelFontSize,defaultBullet.LabelFontSize),LabelFontStyle:exprCompiler.compileEnum.BulletLabelFontStyles(definition.LabelFontStyle,defaultBullet.LabelFontStyle),LabelFontColor:exprCompiler.compileColor(definition.LabelFontColor,defaultBullet.LabelFontColor),Orientation:definition.Orientation,ShowLabels:definition.ShowLabels,TargetShape:definition.TargetShape,TargetLineColor:exprCompiler.compileColor(definition.TargetLineColor,defaultBullet.TargetLineColor),TargetLineWidth:exprCompiler.compileLength(definition.TargetLineWidth,defaultBullet.TargetLineWidth),TickMarks:definition.TickMarks,TicksLineColor:exprCompiler.compileColor(definition.TicksLineColor,defaultBullet.TicksLineColor),TicksLineWidth:exprCompiler.compileLength(definition.TicksLineWidth,defaultBullet.TicksLineWidth),ValueColor:exprCompiler.compileColor(definition.ValueColor,defaultBullet.ValueColor),BestValue:exprCompiler.compileNumber(definition.BestValue,defaultBullet.BestValue),Interval:exprCompiler.compileNumber(definition.Interval,defaultBullet.Interval),Range1Boundary:""===definition.Range1Boundary?null:exprCompiler.compileNumber(definition.Range1Boundary,defaultBullet.Range1Boundary),Range2Boundary:""===definition.Range2Boundary?null:exprCompiler.compileNumber(definition.Range2Boundary,defaultBullet.Range2Boundary),TargetValue:""===definition.TargetValue?null:exprCompiler.compileNumber(definition.TargetValue,defaultBullet.TargetValue),Value:exprCompiler.compileNumber(definition.Value,defaultBullet.Value),WorstValue:exprCompiler.compileNumber(definition.WorstValue,defaultBullet.WorstValue),ZIndex:definition.ZIndex},{render:render,styles:styles}=makeRender$4(compiled);return{Query:query,Layout:(data,ctx)=>actions=>(width,height)=>makeLayout$4(compiled,width,height,data,ctx,render),Styles:styles,DocumentMap:buildDocumentMap(definition.Name,compiled,context.DocumentMap,[])}}))},dvchart:dvchart,barcode:function(definition,context){return __awaiter(this,void 0,void 0,(function*(){const query={Fields:[],Regions:[]},compiled=function(definition,context,comp){const exprCompiler=createTypedCompiler(comp);return{Type:"barcode",Name:context.ReportID+definition.Name,Label:exprCompiler.compileString(definition.Label),Bookmark:exprCompiler.compileString(definition.Bookmark,defaultBarcode.Bookmark),Tooltip:exprCompiler.compileString(definition.ToolTip,defaultBarcode.ToolTip),Value:exprCompiler.compileString(definition.Value),InvalidBarcodeText:exprCompiler.compileString(definition.InvalidBarcodeText),Gs1CompositeOptions:Object.assign(Object.assign({},definition.Gs1CompositeOptions),{Value:exprCompiler.compileString(definition.Gs1CompositeOptions.Value)}),Style:{BackgroundColor:exprCompiler.compileColor(definition.Style.BackgroundColor,"Transparent"),Color:exprCompiler.compileColor(definition.Style.Color),Format:exprCompiler.compileString(definition.Style.Format),FontFamily:exprCompiler.compileString(definition.Style.FontFamily),FontSize:exprCompiler.compileLength(definition.Style.FontSize),FontStyle:exprCompiler.compileEnum.FontStyle(definition.Style.FontStyle),FontWeight:exprCompiler.compileEnum.FontWeight(definition.Style.FontWeight),PaddingLeft:exprCompiler.compileLength(definition.Style.PaddingLeft,defaultBarcode.Style.PaddingLeft),PaddingRight:exprCompiler.compileLength(definition.Style.PaddingRight,defaultBarcode.Style.PaddingRight),PaddingTop:exprCompiler.compileLength(definition.Style.PaddingTop,defaultBarcode.Style.PaddingTop),PaddingBottom:exprCompiler.compileLength(definition.Style.PaddingBottom,defaultBarcode.Style.PaddingBottom),TextAlign:exprCompiler.compileEnum.TextAlign(definition.Style.TextAlign),TextDecoration:exprCompiler.compileEnum.TextDecoration(definition.Style.TextDecoration)},Definition:definition}}(definition,context,(value=>compileExpression(value,query.Fields,context.EvaluationContext))),{render:render,styles:styles}=makeRender$2(compiled,context.i18n);return{Query:query,Layout:(data,ctx)=>actions=>(width,height)=>makeLayout$2(compiled,width,height,data,render,ctx),Styles:styles,DocumentMap:buildDocumentMap(definition.Name,compiled,context.DocumentMap,[])}}))},table:table,inputfield:function(definition,context){return __awaiter(this,void 0,void 0,(function*(){const query={Fields:[],Regions:[]};const compiled=function(definition,context,comp){const exprCompiler=createTypedCompiler(comp),value="Text"===definition.InputType?comp(definition.Value):null,formattedValue=formatCompiledValue(value,"Text"===definition.InputType?exprCompiler.compileString(definition.Style.Format,defaultInputFieldText.Style.Format):null);return{Type:"inputfield",Name:context.ReportID+definition.Name,PdfModel:compilePdfModel(definition,formattedValue,comp),ValueUnformatted:value,CanGrow:!1,CanShrink:!1,Label:exprCompiler.compileString(definition.Label),Bookmark:exprCompiler.compileString(definition.Bookmark,defaultInputFieldText.Bookmark),Tooltip:exprCompiler.compileString(definition.ToolTip,defaultInputFieldText.ToolTip),Style:{Color:exprCompiler.compileColor(definition.Style.Color,defaultInputFieldText.Style.Color),FontFamily:"Text"===definition.InputType?exprCompiler.compileString(definition.Style.FontFamily,defaultInputFieldText.Style.FontFamily):null,FontSize:"Text"===definition.InputType?exprCompiler.compileLength(definition.Style.FontSize,defaultInputFieldText.Style.FontSize):null,FontStyle:"Text"===definition.InputType?exprCompiler.compileEnum.FontStyle(definition.Style.FontStyle,defaultInputFieldText.Style.FontStyle):null,FontWeight:"Text"===definition.InputType?exprCompiler.compileEnum.FontWeight(definition.Style.FontWeight,defaultInputFieldText.Style.FontWeight):null,TextAlign:exprCompiler.compileEnum.TextAlign(definition.Style.TextAlign,defaultInputFieldText.Style.TextAlign),Format:"Text"===definition.InputType?exprCompiler.compileString(definition.Style.Format,defaultInputFieldText.Style.Format):null}}}(definition,context,(function(value){return compileExpression(value,query.Fields,context.EvaluationContext)})),{render:render,styles:styles}=makeRender$1(compiled);return{Query:query,Layout:(data,ctx)=>()=>(width,height)=>function(model,width,height,data,ctx,renderCompiled){return layout$b(model,resolveCompiled$1(model.PdfModel.Value,data),width,height,(itemViewSize=>renderCompiled(data,itemViewSize,ctx)),(()=>{throw Error("measureHeight at inputfield")}))}(compiled,width,height,data,ctx,render),Styles:styles,DocumentMap:buildDocumentMap(definition.Name,compiled,context.DocumentMap,[])}}))},richtext:function(definition,context){var _a,_b;return __awaiter(this,void 0,void 0,(function*(){const fields=[],query={Fields:fields,Regions:[]},comp=value=>compileExpression(value,fields,Object.assign(Object.assign({},context.EvaluationContext),{SelfID:context.ReportID+definition.Name})),compiledTb=function(definition,context,comp,fields){const exprCompiler=createTypedCompiler(comp);return{Type:"textbox",Name:context.ReportID+definition.Name,OriginalName:definition.Name,CanGrow:context.Layout.CanChangeItemsSize&&definition.CanGrow,Label:exprCompiler.compileString(definition.Label),Bookmark:exprCompiler.compileString(definition.Bookmark,defaultRichTextBox.Bookmark),Tooltip:exprCompiler.compileString(definition.ToolTip,defaultRichTextBox.ToolTip),Style:{Color:exprCompiler.compileColor(definition.Style.Color,defaultRichTextBox.Style.Color),FontFamily:exprCompiler.compileString(definition.Style.FontFamily,defaultRichTextBox.Style.FontFamily),FontSize:exprCompiler.compileLength(definition.Style.FontSize,defaultRichTextBox.Style.FontSize),FontStyle:exprCompiler.compileEnum.FontStyle(definition.Style.FontStyle,defaultRichTextBox.Style.FontStyle),FontWeight:exprCompiler.compileEnum.FontWeight(definition.Style.FontWeight,defaultRichTextBox.Style.FontWeight),PaddingLeft:exprCompiler.compileLength(definition.Style.PaddingLeft,defaultRichTextBox.Style.PaddingLeft),PaddingRight:exprCompiler.compileLength(definition.Style.PaddingRight,defaultRichTextBox.Style.PaddingRight),PaddingTop:exprCompiler.compileLength(definition.Style.PaddingTop,defaultRichTextBox.Style.PaddingTop),PaddingBottom:exprCompiler.compileLength(definition.Style.PaddingBottom,defaultRichTextBox.Style.PaddingBottom),LineHeight:exprCompiler.compileLength(definition.Style.LineHeight,defaultRichTextBox.Style.LineHeight)}}}(definition,context,comp),paragraphs="None"===definition.MarkupType?function(paragraphs,comp,fields,context){const compiledArray=paragraphs.map((p=>compile$4(p,comp,fields,context)));return(data,ctx)=>actions=>compiledArray.map((p=>p(data,ctx)(actions)))}(definition.Paragraphs,comp,fields,context):"HTML"===definition.MarkupType?function(comp,valueEpxr,context){const cValue=compileExpr(comp)(valueEpxr);return(data,ctx)=>actions=>{const value=makeExprResolver(data,ctx)(cValue);return"function"==typeof value?globals=>{var _a;return convertHTML(null!==(_a=value(globals))&&void 0!==_a?_a:"").map((p=>compile$4(p,(x=>x),[],context))).map((p=>p(data,ctx)(actions)))}:convertHTML(null!=value?value:"").map((p=>compile$4(p,(x=>x),[],context))).map((p=>p(data,ctx)(actions)))}}(comp,null!==(_b=null===(_a=definition.Value)||void 0===_a?void 0:_a.toString())&&void 0!==_b?_b:"",context):()=>()=>[],{render:render,resolveStyles:resolveStyles,styles:styles}=makeRender(compiledTb);return{Query:query,Layout:(data,ctx)=>actions=>{ctx=Object.assign(Object.assign({},ctx),{GetDocumentPath:()=>{const node=ctx.getDocumentMapNode({Name:definition.Name,ScopeId:data.Id});return node?node.path.map(((l,idx)=>context.DocumentMap.FormatLevelNumber(idx,l+1))).join("."):""}});const resolvedParagraphs=paragraphs(data,ctx)(actions);return(width,height)=>{var _a,_b;const lRichText={Width:width,Height:height,CanGrow:compiledTb.CanGrow};return makeLayout({ContainerHeight:null!==(_b=null===(_a=context.ContainerSize)||void 0===_a?void 0:_a.Height)&&void 0!==_b?_b:1/0,CanGrow:lRichText.CanGrow},lRichText,resolvedParagraphs,data,render(data,ctx),resolveStyles,ctx)}},Styles:styles,DocumentMap:buildDocumentMap(definition.Name,compiledTb,context.DocumentMap,[])}}))}};function compile$2(reportItem,context){return __awaiter(this,void 0,void 0,(function*(){const type=reportItem.Type.toLowerCase();return compileMap[type]?wrapReportItem(reportItem,yield compileMap[type](reportItem,context),context):null}))}const Cols=function(makeEmptyFragment,makeFillFragment,makeResult){return function Cols(content,options){if(!content)throw new LayoutError("ArgumentNullException: content");return space=>{const fail=LResult.Fail();if(space<=0)return fail;let height=0;const cols=[];let tail=null,layout=content;for(;null!==layout&&cols.length<options.Count;){const band=layout(space);if(band.IsFailed())break;if(height=Math.max(band.Size,height),band.IsPageBreak()){if(0===cols.length)return LResult.PageBreak(Cols(band.Tail,options));cols.push(EmptyCol(options,height)),layout=band.Tail}else if(tail=Slice(cols,band.Body,options),layout=band.Tail,null!==tail)break}if(0===cols.length)return fail;const head=ColStack(cols,tail,options,height),remainder=null!==layout?Cols(layout,options):null;return LResult.SplitOrComplete(height,head,remainder)}};function ColStack(head,content,options,height){return space=>{let pos=0;const taken=[],remainder=[];for(const col of head){(pos+col.Size<=space?taken:remainder).push(col);const spacing=options.Spacing+(options.Width-col.Size);pos+=col.Size+spacing}if(0===taken.length)return LResult.Fail();if(null===content&&taken.length<options.Count){const col=EmptyCol(options,height);let n=options.Count-taken.length;for(;n-- >0;){pos+col.Size<=space&&taken.push(col);const spacing=options.Spacing+(options.Width-col.Size);pos+=col.Size+spacing}}const stack=function(columns,options,height){const pads=columns.map((col=>{const spacing=options.Width-col.Size;return spacing>0?[makeEmptyFragment(spacing,height),spacing]:null})),spacerItem=null,spacers=columns.map(((col,i)=>{const spacing=i===columns.length-1?0:options.Spacing;return spacing>0?[makeFillFragment(spacerItem,spacing,height),spacing]:null}));let fragments=[];for(let i=0;i<columns.length;i++)null!==columns[i].Body&&fragments.push([columns[i].Body,columns[i].Size]),null!==pads[i]&&fragments.push(pads[i]),null!==spacers[i]&&fragments.push(spacers[i]);fragments=fragments.filter(isNotNull);const width=fragments.map((f=>f[1])).reduce(((res,b)=>res+b),0);return{Fragment:makeResult("Horizontal",width,height,fragments.map((f=>f[0]))),Width:width}}(taken,options,height);if(null===content&&0===remainder.length)return LResult.Complete(stack.Width,stack.Fragment);const tail=Slice(remainder,content,options);return LResult.Split(stack.Width,stack.Fragment,ColStack(remainder,tail,options,height))}}function EmptyCol(options,height){return LResult.Complete(options.Width,makeEmptyFragment(options.Width,height))}}(((widht,height)=>h("div",{style:{widht:widht,height:height}},[])),((item,width,height)=>h("div",{style:{width:Length.toCss(width),height:Length.toCss(height)}},[])),((direction,width,height,items)=>h("div",{style:{width:Length.toCss(width),height:Length.toCss(height),display:"flex"}},(items||[]).map((it=>(it.properties.style.position="relative",it))))));function pageSectionItem(def,name,forceFillHorzSpace=!1){const sectionDef=Object.assign(Object.assign({},def),forceFillHorzSpace?{FillHorzSpace:!0}:{});return{Name:`${name}Site`,Type:"rectangleitemsite",BackgroundColor:def.Style.BackgroundColor,BackgroundImage:def.Style.BackgroundImage,Borders:{Border:def.Style.Border,LeftBorder:def.Style.LeftBorder,TopBorder:def.Style.TopBorder,RightBorder:def.Style.RightBorder,BottomBorder:def.Style.BottomBorder},Content:sectionDef,Visibility:createVisibility()}}function compileReportSection(def,layoutOptions,context,isSubreport){return __awaiter(this,void 0,void 0,(function*(){const bodyCompiled=yield"Continuous"===def.Type?function(def,layoutOptions,context,isSubreport){var _a,_b;return __awaiter(this,void 0,void 0,(function*(){const width=Length.parse(def.Width),body=Object.assign(Object.assign(Object.assign({},def.Body),layoutOptions),{Columns:makeColOptions(def.Page)}),contentContext=Object.assign(Object.assign({},context),{Layout:Object.assign(Object.assign({},context.Layout),{Arrange:L2.Arrange})}),compileHeaderFooter=(s,name)=>s&&compile$2(pageSectionItem(s,name,!0),contentContext),bodyDefSize={Width:width,Height:Length.parse(body.Height)},bodySize={Width:body.Columns?body.Columns.Width:getFplWidth(def.Page),Height:Length.parse(def.Page.PageHeight)-Length.parse(def.Page.TopMargin)-Length.parse(def.Page.BottomMargin)-(def.PageHeader?Length.parse(def.PageHeader.Height):0)-(def.PageFooter?Length.parse(def.PageFooter.Height):0)},bodyContext=Object.assign(Object.assign({},contentContext),{Layout:Object.assign(Object.assign({},contentContext.Layout),{KeepTogether:L2.KeepTogether(bodySize),KeepTogetherVert:l=>L.KeepTogether(l,bodySize.Height,(r=>r.Body))}),ContainerSize:bodyDefSize});let bodyCompiled=yield compile$2(pageSectionItem(body,contentContext.MakeItemName("__bodysection_")),bodyContext);body.Columns&&(bodyCompiled=function(body,options){return Object.assign(Object.assign({},body),{Layout:(data,ctx)=>{const withData=body.Layout(data,ctx);return actions=>{const withActions=withData(actions);return(width,height)=>Cols(withActions(width,height),options)}}})}(bodyCompiled,body.Columns));const sectionsCompiled=[yield compileHeaderFooter(null!==(_a=def.PageHeader)&&void 0!==_a?_a:null,contentContext.MakeItemName("__headersection_")),bodyCompiled,yield compileHeaderFooter(null!==(_b=def.PageFooter)&&void 0!==_b?_b:null,contentContext.MakeItemName("__footersection_"))];if(!bodyContext.ConsumeContainerWhitespace){const makeBodyLayout=sectionsCompiled[1].Layout;sectionsCompiled[1].Layout=(data,ctx)=>actions=>(bodyWidth,bodyHeight)=>function(definition,width,layout){const height=Length.parse(definition.Height),maxItemY=Math.max(0,...definition.ReportItems.map((ri=>Length.parse(ri.Top)+Length.parse(ri.Height)))),maxItemX=Math.max(0,...definition.ReportItems.map((ri=>Length.parse(ri.Left)+Length.parse(ri.Width))));return function(layout,widthTail,heightTail){const predicate=(res,space)=>space===1/0&&null===res.Tail;return L.ConvertSlice(layout,((vres,vspace)=>{const vSize=predicate(vres,vspace)?vres.Size+heightTail:vres.Size;return{Size:vSize,Body:vres.Body&&L.ConvertSlice(vres.Body,((hres,hspace)=>{const hSize=predicate(hres,hspace)?hres.Size+widthTail:hres.Size,vNode=hres.Body;return vNode&&(vNode.properties.style.height=Length.toCss(vSize),vNode.properties.style.width=Length.toCss(hSize)),{Size:hSize,Body:vNode}}))}}))}(layout,width-maxItemX,height-maxItemY)}(body,width,makeBodyLayout(data,ctx)(actions)(bodyWidth,bodyHeight))}const contentQuery={Fields:[],Regions:[]},sectionsDataMap=sectionsCompiled.map((s=>s&&combineDataQuery(contentQuery,s.Query))),staticStyles=flatten$1(sectionsCompiled.filter(isNotNull).map((s=>s.Styles))),headerHeight=def.PageHeader&&Length.parse(def.PageHeader.Height),footerHeight=def.PageFooter&&Length.parse(def.PageFooter.Height),bodyHeight=Length.parse(Length.toCss(getFplHeight(def.Page))),getDocumentMap=(data,ctx)=>reportActions=>sectionsCompiled[1].DocumentMap(sectionsDataMap[1](data),ctx)(reportActions);return{Query:contentQuery,Layout:(data,ctx)=>actions=>(containerWidth,containerHeight)=>{var _a,_b,_c,_d,_e,_f;const lWidth=null!==(_b=null===(_a=body.Columns)||void 0===_a?void 0:_a.Width)&&void 0!==_b?_b:containerWidth===1/0?width:containerWidth,lHeight=containerHeight===1/0?bodyHeight:containerHeight,sect=zipWith(sectionsCompiled,sectionsDataMap,((section,dataMap)=>null==section?void 0:section.Layout(dataMap(data),ctx)(actions)));return isSubreport?sect[1](lWidth,lHeight):function(header,body,footer){return L2.Page(header,body,footer,renderCPL)}(null!==(_d=null===(_c=sect[0])||void 0===_c?void 0:_c.call(sect,lWidth,headerHeight))&&void 0!==_d?_d:null,sect[1](lWidth,lHeight),null!==(_f=null===(_e=sect[2])||void 0===_e?void 0:_e.call(sect,lWidth,footerHeight))&&void 0!==_f?_f:null)},Styles:staticStyles,DocumentMap:(data,ctx)=>actions=>getDocumentMap(data,ctx)(actions)}}))}(def,layoutOptions,context,isSubreport):function(def,context){return __awaiter(this,void 0,void 0,(function*(){const bodyDefSize={Width:1/0,Height:1/0},bodySize={Width:getFplWidth(def.Page),Height:getFplHeight(def.Page)},bodyContext=Object.assign(Object.assign({},context),{Layout:Object.assign(Object.assign({},context.Layout),{Arrange:L2.ArrangeAll,KeepTogether:L2.KeepTogether(bodySize),KeepTogetherVert:l=>L.KeepTogether(l,bodySize.Height,(r=>r.Body))}),ContainerSize:bodyDefSize});return yield compile$2(def.FixedPage,bodyContext)}))}(def,context),{PageWidth:PageWidth,PageHeight:PageHeight,RightMargin:RightMargin,LeftMargin:LeftMargin,TopMargin:TopMargin,BottomMargin:BottomMargin}=def.Page,pageSize={PageWidth:"Continuous"===def.Type?PageWidth:"",PageHeight:"Continuous"===def.Type?PageHeight:"",RightMargin:RightMargin,LeftMargin:LeftMargin,TopMargin:TopMargin,BottomMargin:BottomMargin};const displayName=createTypedCompiler((function(value){return compileExpression(value,bodyCompiled.Query.Fields,context.EvaluationContext)})).compileString(def.DisplayName||def.Name);return{Query:bodyCompiled.Query,Layout:(data,parentCtx)=>{var _a;const ctx=Object.assign(Object.assign({},parentCtx),{EvalDynamicRuntime:(value,evalCtx)=>value(evalCtx)}),dName=null!==(_a=function(val,data,ctx,evalCtx){const runtimeVal=resolveCompiled$1(val,data,ctx);return"function"==typeof runtimeVal?runtimeVal(evalCtx):runtimeVal}(displayName,data,ctx,context.EvaluationContext))&&void 0!==_a?_a:"";return actions=>({L:bodyCompiled.Layout(data,ctx)(actions),DisplayName:dName})},PageSize:pageSize,Styles:bodyCompiled.Styles,DocumentMap:(data,ctx)=>actions=>bodyCompiled.DocumentMap(data,ctx)(actions)}}))}function makeColOptions(pageInfo){if(pageInfo.Columns<=1)return null;const spacing=Length.parse(pageInfo.ColumnSpacing);return{Count:pageInfo.Columns,Spacing:spacing,Width:CalculateColumnSize(pageInfo.Columns,spacing,getFplWidth(pageInfo))}}function getFplHeight(page){const l=Length.parse;return l(page.PageHeight)-l(page.TopMargin)-l(page.BottomMargin)}function renderCPL(width,height,sections){sections.filter(Boolean).forEach((section=>{var _a;section.properties.className=`${null!==(_a=section.properties.className)&&void 0!==_a?_a:""} arjs-section`.trim()}));const patcher=joinPatchers(sections.map((s=>s.properties.patcher)));return h("div",{style:{width:Length.toCss(width),height:Length.toCss(height)},patcher:patcher},sections)}function compileReportContent(rDef,sectionLayoutOptions,context,isSubreport=!1){return __awaiter(this,void 0,void 0,(function*(){const contentContext=Object.assign(Object.assign({},context),{Interactivity:collectToggles((reportSections=rDef.ReportSections,flatten$1(reportSections.map((rs=>"FixedPage"===rs.Type?rs.FixedPage.Pages:rs.Body.ReportItems))))),GetDataSet:name=>{const dataSet=""===name?1===rDef.DataSets.length?rDef.DataSets[0]:null:rDef.DataSets.find((ds=>ds.Name.toLowerCase()===name.toLowerCase()));return dataSet?makeDataSet(dataSet):null},DocumentMap:buildDocumentMapConfig(rDef.DocumentMap),getLayerClassName:makeGetLayerClassName(rDef)});var reportSections;const embeddedImageResolver=contentContext.getImageResolver(),embeddedImagesStyles=(rDef.EmbeddedImages||[]).map((image=>({className:embeddedImageResolver("Embedded",image.Name),style:{backgroundImage:`url("data:${image.MIMEType};base64,${image.ImageData.replace(/(\r\n|\n|\r)/gm,"")}")`}}))),sectionsLayout=[],sectionsDocumentMap=[],sectionsQuery={Fields:[],Regions:[]},staticStyles=[];for(const rs of rDef.ReportSections){const sectionCompiled=yield compileReportSection(rs,sectionLayoutOptions,contentContext,isSubreport),dataMap=combineDataQuery(sectionsQuery,sectionCompiled.Query);sectionsLayout.push({L:(data,ctx)=>sectionCompiled.Layout(dataMap(data),ctx),PageSize:sectionCompiled.PageSize}),sectionsDocumentMap.push(((data,ctx)=>sectionCompiled.DocumentMap(dataMap(data),ctx)));for(const style of sectionCompiled.Styles)staticStyles.push(style)}staticStyles.push(...embeddedImagesStyles);const bodyDataSets=sectionsQuery.Regions.filter((r=>"dataset"===r.type)).map((r=>r.Name)),emptyDataSets=rDef.DataSets.filter((ds=>bodyDataSets.indexOf(ds.Name)<0&&!ds.Query.DataSourceName.startsWith("$dataset:")));return{Query:{Fields:sectionsQuery.Fields,Regions:[...sectionsQuery.Regions,...emptyDataSets.map(makeDataSet)]},Layout:sectionsLayout.map((sl=>({L:(data,parentCtx)=>{const ctx=Object.assign(Object.assign({},parentCtx),{EvalDynamicRuntime:(value,evalCtx)=>value(evalCtx)});return actions=>{const reportInteractivity=getReportInteractivity(actions,contentContext,data.Id);return sl.L(data,ctx)(reportInteractivity)}},PageSize:sl.PageSize}))),Styles:staticStyles,DocumentMap:(data,ctx)=>actions=>flatten$1(sectionsDocumentMap.map((s=>s(data,ctx)(getReportInteractivity(actions,contentContext,data.Id)))))}}))}function getReportInteractivity(interactivity,context,scopeId){return Object.assign(Object.assign({},getScopeActions(interactivity,scopeId)),{IsToggle:name=>context.Interactivity.Toggles.indexOf(name)>=0})}function makeDataSet(dataSet){const parentDataSetName=function(dataSourceName){const groups=/^\$dataset:(.*)\/(.*)$/.exec(dataSourceName);return 3===(null==groups?void 0:groups.length)?groups[1]:null}(dataSet.Query.DataSourceName);return Object.assign({type:"dataset",Name:dataSet.Name,Parameters:dataSet.Query.QueryParameters||[],FieldNames:dataSet.Fields.map((f=>f.Name)),Content:{Fields:[],Regions:[]},Filters:(dataSet.Filters||[]).map((f=>({Expression:f.FilterExpression,Op:f.Operator,Values:f.FilterValues})))},parentDataSetName?{ParentName:parentDataSetName}:{})}const defaultReport=createReport(),defaultInteractivity={Toggles:[],ScopeToggles:[],SortState:{},IsToggle:()=>!1};function generateID(){return this.patchCounter||(this.patchCounter=0),"dc_"+ ++this.patchCounter}function createActions(actions){return Object.assign(Object.assign({},defaultInteractivity),actions)}function compileReport(reportDef,context){return __awaiter(this,void 0,void 0,(function*(){return function(rDef,context){return __awaiter(this,void 0,void 0,(function*(){const content={Type:"reportcontent",ReportSections:romUpgrade_V4.getReportSections(rDef).map((reportSection=>"Continuous"===reportSection.Type?reportSection:Object.assign(Object.assign({},reportSection),{FixedPage:Object.assign(Object.assign({},reportSection.FixedPage),{Pages:reportSection.FixedPage.Pages.map((p=>romUpgrade_V3.fixFplPageSize(p,reportSection.Page)))})}))),DataSets:rDef.DataSets,EmbeddedImages:rDef.EmbeddedImages,DocumentMap:rDef.DocumentMap,Layers:rDef.Layers},imageResolver=context.getImageResolver(),imagesStyles=Object.keys(context.ExternalImages).map((imageName=>({className:imageResolver("External",imageName),style:{backgroundImage:`url("data:${context.ExternalImages[imageName].MimeType};base64,${context.ExternalImages[imageName].Value.replace(/(\r\n|\n|\r)/gm,"")}")`}}))),updatedContext=Object.assign(Object.assign({},(yield context.updateTheme(rDef.ThemeUri)).setStartPageNumber(rDef.StartPageNumber)),{GetLocalizedValue:compileLocalizedResources(rDef.Language,rDef.LocalizationResources),ConsumeContainerWhitespace:rDef.ConsumeContainerWhitespace}),contentCompiled=yield compileReportContent(content,{ConsumeWhiteSpace:!0,FillHorzSpace:!0,FillVertSpace:!0},updatedContext),contentQuery=contentCompiled.Query,language=createTypedCompiler((function(value){return compileExpression(value,contentQuery.Fields)})).compileString(rDef.Language,defaultReport.Language),staticStyles=[...contentCompiled.Styles,...imagesStyles],getDocumentMap=(data,ctx)=>reportActions=>contentCompiled.DocumentMap(data,ctx)(reportActions);return{Query:{type:"report",Name:rDef.Name,Content:contentQuery},Layout:data=>{const lang=safeResolveCompiledData(language,data)||"";return actions=>rendererOptions=>{const reportActions=createActions(actions),ctx={IDGenerator:{next:generateID},Language:lang||"Default",getDocumentMap:()=>[],ParentScopes:getDataSetScopes(contentQuery.Regions,data.Regions),PeerScopes:getPeerScopes(contentQuery.Regions,data.Regions),EvalDynamicRuntime:(value,evalCtx)=>value(evalCtx),DocumentMap:{lastPath:[],level:0,node:null},getDocumentMapNode:itemId=>ctx.getDocumentMap().find((n=>n.itemId.Name===itemId.Name&&n.itemId.ScopeId===itemId.ScopeId))||null,GetDocumentPath:()=>"",FPL:{isLastPlace:!0,isFillerLayout:!1},RendererOptions:rendererOptions};let docMap=null;return ctx.getDocumentMap=()=>docMap||(docMap=getDocumentMap(data,ctx)(reportActions)),contentCompiled.Layout.map((sl=>{const section=sl.L(data,ctx)(reportActions);return{L:section.L(1/0,1/0),PageSize:sl.PageSize,ReportSectionDisplayName:section.DisplayName}}))}},Styles:staticStyles,DocumentMap:data=>{const ctx={IDGenerator:{next:generateID},Language:safeResolveCompiledData(language,data,"Language")||"",getDocumentMap:()=>[],ParentScopes:getDataSetScopes(contentQuery.Regions,data.Regions),PeerScopes:getPeerScopes(contentQuery.Regions,data.Regions),EvalDynamicRuntime:(value,evalCtx)=>value(evalCtx),DocumentMap:{lastPath:[],level:0,node:null},getDocumentMapNode:()=>null,GetDocumentPath:()=>"",FPL:{isLastPlace:!0,isFillerLayout:!1},RendererOptions:{TableStaticHeaders:!1}};return actions=>function(updNodes){const root={anchor:"",kids:[],isLeaf:!1,name:"",level:-1,page:null},stack=[];stack.push(root);let prevNode=null;return(updNodes||[]).forEach(((node,i)=>{const nodeLevel=node.level;for(prevNode&&(prevNode.isLeaf=prevNode.level>=nodeLevel);nodeLevel<=stack[stack.length-1].level;)stack.pop();const lastNode=stack[stack.length-1];lastNode.isLeaf=!1;const{anchor:anchor,name:name,level:level}=node,resultNode={anchor:anchor,name:name,level:level,isLeaf:!1,kids:[],location:{},page:null};prevNode=resultNode,lastNode.kids.push(resultNode),stack.push(resultNode)})),prevNode&&(prevNode.isLeaf=!0),{kids:root.kids}}(getDocumentMap(data,ctx)(createActions(actions)))},Subreports:context.Subreports}}))}(reportDef,context)}))}const defaultDocMap={Source:"None",NumberingStyle:"None",Levels:[]};function createFactory(rootReportName,i18n,resourceLocator,userData,customProperties){var _a;const subreports={},reportResources={themes:[],images:{}};let itemNameCounter=1;const getLayerCss=()=>"",instanceID=`arjs-x${hashCode((new Date).getTime().toString())}`,getReportID=(name,substituteThemes)=>__awaiter(this,void 0,void 0,(function*(){return rootReportName===name?`${instanceID}-rpt1`:(yield getSubreportImpl(name),`${instanceID}-rpt${substituteThemes?"st":""}${Object.keys(subreports).indexOf(name)+2}`)})),getSubreportImpl=name=>__awaiter(this,void 0,void 0,(function*(){var _b;if(!subreports[name]){let subDef=null;try{subDef=yield resourceLocator.getResource(name)}catch(e){throw"invalid_response"===(null===(_b=null==e?void 0:e.details)||void 0===_b?void 0:_b.type)?new Error(i18n.t("core:errors.subreport-invalid",{defaultValue:'Subreport "{{reportUri}}" is invalid: {{error}}',reportUri:name,error:e.message,interpolation:{escapeValue:!1}})):new Error(i18n.t("core:errors.subreport-not-available",{defaultValue:'Subreport "{{reportUri}}" is not available: {{error}}',reportUri:name,error:e.message,interpolation:{escapeValue:!1}}))}if(!subDef)throw new Error(i18n.t("core:errors.subreport-not-available",{defaultValue:'Subreport "{{reportUri}}" is not available: {{error}}',reportUri:name,error:null,interpolation:{escapeValue:!1}}));try{subreports[name]=decodeReport(subDef)}catch(_c){subreports[name]=null}}return subreports[name]})),getSubreport=name=>__awaiter(this,void 0,void 0,(function*(){return yield getSubreportImpl(name),subreports[name]}));function getImageResolver(){const self=this;return(source,iName)=>wrapRuntimeValue(iName,(value=>{return name=value,"Embedded"===source&&name?`${self.ReportID}${hashCode(name)}Img`:"External"===source&&name&&!name.match(/^(url\(")?http(?:s)?\:\/\/.*/i)?`Ext${hashCode(name.replace(/^url\(\"|\"\)$/gi,""))}Img`:"";var name}))}const valueNotLocalized=(name,prop,defValue)=>({DefaultValue:defValue,Locales:[]});function updateTheme(themeUri){return __awaiter(this,void 0,void 0,(function*(){let theme;if(themeUri){if(theme=reportResources.themes.find((theme=>theme.Uri===themeUri.toLowerCase())),!theme){let themeValue=null;try{themeValue=yield resourceLocator.getResource(themeUri)}catch(e){}theme={Uri:themeUri,Value:(null==themeValue?void 0:themeValue.Theme)?fillTheme(themeValue.Theme):emptyTheme},reportResources.themes.push(theme)}}else theme={Uri:"",Value:emptyTheme};const newEvaluationContext=Object.assign(Object.assign({},this.EvaluationContext),{Data:Object.assign(Object.assign({},this.EvaluationContext.Data),{theme:theme.Value})});return Object.assign(Object.assign({},this),{EvaluationContext:newEvaluationContext})}))}function setStartPageNumber(startPageNumber){const newEvaluationContext=Object.assign(Object.assign({},this.EvaluationContext),{StartPageNumber:startPageNumber});return Object.assign(Object.assign({},this),{EvaluationContext:newEvaluationContext})}const globals=Object.assign({executiontime:dateTimeFactory_create(),reportfolder:"report folder",reportname:"report name"},mapKeysDeep(userData,(key=>key.toLowerCase()))),defaultOverflowBehavior="Dashboard"===(null===(_a=null==customProperties?void 0:customProperties.find((cp=>"ViewerType"===cp.Name)))||void 0===_a?void 0:_a.Value)?"Scroll":"Grow";return function create(reportName,path=null,substituteThemes=!1){return __awaiter(this,void 0,void 0,(function*(){return{ReportID:yield getReportID(reportName,substituteThemes),getSubreport:getSubreport,getImageResolver:getImageResolver,getResourceUri:resourceLocator.getResourceUri,getLayerClassName:getLayerCss,i18n:i18n,updateTheme:updateTheme,setStartPageNumber:setStartPageNumber,ContainerSize:this?this.ContainerSize:null,Interactivity:{Toggles:[],SortExpressions:{}},Path:path||[],New:create,GetLocalizedValue:valueNotLocalized,EvaluationContext:this?this.EvaluationContext:{Data:{theme:emptyTheme,globals:globals}},ScopeDataSet:null,GetDataSet:()=>{throw new Error(i18n.t("core:errors.no-datasets","No DataSets defined."))},ExternalImages:reportResources.images,Subreports:subreports,ConsumeContainerWhitespace:!1,Layout:{Arrange:L2.Arrange,KeepTogether:this?this.Layout.KeepTogether:l=>l,KeepTogetherVert:this?this.Layout.KeepTogetherVert:l=>l,CanChangeItemsSize:!0},DocumentMap:buildDocumentMapConfig(defaultDocMap),MakeItemName:name=>`${name}_${itemNameCounter++}`,DefaultOverflowBehavior:defaultOverflowBehavior}}))}}const hashCode=str=>{let hash=0;if(str){const lowerStr=str.toLowerCase();for(let i=0;i<lowerStr.length;i++)hash=(hash<<5)-hash+lowerStr.charCodeAt(i),hash&=hash}return(hash>=0?"":"_")+Math.abs(hash).toString(16).toUpperCase()};function*Paginate(layout,pageContexts,lastPageContext,tocLabelsRef,pageWidth,pageHeight,makeResult,layoutOrder){var _a;const bookmarks={};for(const pageResult of"NOrder"===layoutOrder?function*(layout,pageWidth,pageHeight,getResult){const sliceIterator=SliceIterator(layout,pageHeight||1/0),pages=iterable$1.map(((band,sliceIndex)=>({iterator:SliceIterator(band,pageWidth||1/0),sliceIndex:sliceIndex})))(sliceIterator);for(const{rawPage:rawPage,sliceIndex:sliceIndex}of function*(pagesIterators){const pageBands=Array.from(pagesIterators);let exist=!1;do{exist=!1;for(const enumerator of pageBands){const next=enumerator.iterator[Symbol.iterator]().next();next.done||(yield{rawPage:next.value,sliceIndex:enumerator.sliceIndex},exist=!0)}}while(exist)}(pages))yield getResult(sliceIndex,rawPage)}(layout,pageWidth,pageHeight,getResult):function*(layout,pageWidth,pageHeight,getResult){let sliceIndex=0;for(const band of SliceIterator(layout,pageHeight||1/0)){for(const rawPage of SliceIterator(band,pageWidth||1/0))yield getResult(sliceIndex,rawPage);sliceIndex++}}(layout,pageWidth,pageHeight,getResult)){const{sliceIndex:sliceIndex,content:page}=pageResult,pageSections=collectSections(page),pageContext=buildNextPageContext(lastPageContext,{opened:pageSections.filter((s=>"start"===s.position)).map((s=>s.id)),closed:pageSections.filter((s=>"end"===s.position)).map((s=>s.id))});pageContexts.push(pageContext);const pageIndex=pageContext.pagination.GetMain().PageIndex,pageBookmarks=collectBookmarks(page);for(const bmId of pageBookmarks){(null!==(_a=bookmarks[bmId])&&void 0!==_a?_a:bookmarks[bmId]=[]).push(pageIndex)}const renderedPage=makeResult(pageIndex,sliceIndex,page);yield{content:renderedPage,type:"page",pageIndex:pageIndex};const pageAnchors=collectAnchors(renderedPage);if(pageAnchors&&pageAnchors.length>0){const labels={content:pageAnchors,type:"toclabels",pageIndex:pageIndex};yield labels,tocLabelsRef.push(labels)}const updPages=new Set;for(const anchor of pageAnchors){const bmPages=bookmarks[anchor];if(bmPages)for(const bmPage of bmPages)updPages.add(bmPage)}for(const updPage of updPages){const updContext=pageContexts[updPage];updContext.patch&&(yield updContext.patch.patcher(updContext.evaluationContext))}const patcher=page.properties&&page.properties.patcher;if(patcher){pageContext.evaluationContext.ReportItems=buildRenderTree(renderedPage);const wrappedPatcher=wrapPatcher(pageIndex,patcher),pagePatches=wrappedPatcher.patcher(pageContext.evaluationContext);Array.isArray(pagePatches.content)&&pagePatches.content.length>0&&(yield pagePatches,pageContext.patch=wrappedPatcher)}lastPageContext=pageContext}}function wrapPatcher(pageIndex,patchers){return{patcher:globals=>({content:patchers.filter((p=>p)).map((p=>p(globals))),type:"patch",pageIndex:pageIndex})}}function*SliceIterator(content,pageSize){let tail=content,pageIndex=0;for(;tail;){const slice=tail(pageSize);if(slice.IsFailed())throw new LayoutError(`Failed to complete layout on page ${pageIndex+1}`);slice.Body&&(yield slice.Body),tail=slice.Tail,pageIndex++}}function getPageContentSize(pageInfo){if(pageInfo){const pageWidth=pageInfo.PageWidth&&Length.parse(pageInfo.PageWidth)||null,pageHeight=pageInfo.PageHeight&&Length.parse(pageInfo.PageHeight)||null,leftMargin=pageInfo.LeftMargin&&Length.parse(pageInfo.LeftMargin)||0,rightMargin=pageInfo.RightMargin&&Length.parse(pageInfo.RightMargin)||0,topMargin=pageInfo.TopMargin&&Length.parse(pageInfo.TopMargin)||0,bottomMargin=pageInfo.BottomMargin&&Length.parse(pageInfo.BottomMargin)||0;return{Width:pageWidth?pageWidth-leftMargin-rightMargin:null,Height:pageHeight?pageHeight-topMargin-bottomMargin:null}}return{Width:null,Height:null}}const getResult=(sliceIndex,content)=>({sliceIndex:sliceIndex,content:content});function MakePaginate(galleyMode,layoutOrder="ZOrder"){const rOptions={TableStaticHeaders:galleyMode};return function*(sectionsLayout){const tocLabelsRef=[];let lastPageContext=function(tocLabelsRef){return{evaluationContext:{Data:{},ToCLabels:tocLabelsRef,ReportItems:[],CumulativeTotals:[]},pagination:PaginationService.init(),patch:null}}(tocLabelsRef);const pageContexts=[];for(const sectionLayout of sectionsLayout(rOptions)){const pageSize=galleyMode?null:sectionLayout.PageSize,contentSize=getPageContentSize(pageSize);yield*Paginate(sectionLayout.L,pageContexts,lastPageContext,tocLabelsRef,contentSize.Width,contentSize.Height,((pi,si,page)=>renderPage$1(pageSize,sectionLayout.ReportSectionDisplayName,page,pi,si)),layoutOrder),lastPageContext=pageContexts[pageContexts.length-1]}lastPageContext.pagination.Complete();for(let i=0;i<pageContexts.length;i++){const patch=pageContexts[i].patch;patch&&(yield patch.patcher(pageContexts[i].evaluationContext))}}}function buildNextPageContext(prev,sections){const pagination=prev.pagination.Next(sections.opened,sections.closed);return Object.assign(Object.assign({},prev),{pagination:pagination,patch:null,evaluationContext:Object.assign(Object.assign({},prev.evaluationContext),{ReportItems:void 0,PaginationService:pagination})})}function applyInteractiveAction(action,interactiveState){switch(action.Type){case"toggle":return function(action,state){return Object.assign(Object.assign({},state),{Toggles:[...state.Toggles,action]})}(action,interactiveState);case"sort":return function(action,state){if("string"!=typeof action.Expression)return state;const scopeState=state.SortState[action.ScopeId]||{};let exprScopeState=scopeState[action.ExpressionScope];exprScopeState&&exprScopeState.Expression===action.Expression||(exprScopeState={Expression:action.Expression,Direction:"Descending"});const newExprScopeState=Object.assign(Object.assign({},exprScopeState),{Direction:"Ascending"===exprScopeState.Direction?"Descending":"Ascending"}),newScopeState=Object.assign(Object.assign({},scopeState),{[action.ExpressionScope]:newExprScopeState});return Object.assign(Object.assign({},state),{SortState:Object.assign(Object.assign({},state.SortState),{[action.ScopeId]:newScopeState})})}(action,interactiveState)}}const emptyResult={value:null,done:!0,next:()=>emptyResult,previous:()=>emptyResult},escapeSymbols=/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g;function getRegexp(searchString,matchCase,wholeWord){const escapedString=searchString.replace(escapeSymbols,"\\$&");const wordBoundary="(?:(?<=\\p{L}\\p{M}*?|\\p{N})(?!\\p{L}\\p{M}*?|\\p{N})|(?<!\\p{L}\\p{M}*?|\\p{N})(?=\\p{L}\\p{M}*?|\\p{N}))";return xRegExp(wholeWord?`${wordBoundary}${escapedString}${wordBoundary}`:escapedString,matchCase?"g":"ig")}const getPagePatches=(patches,pageIndex)=>flatten$1(patches.filter((p=>p.pageIndex===pageIndex)).map((p=>p.patches)));const needNextPage=(elementsOnPage,elementIndex,forward)=>0===elementsOnPage||forward&&elementsOnPage-1===elementIndex||!forward&&0===elementIndex,isVText=node=>"VirtualText"===node.type,isVNode=node=>"VirtualNode"===node.type;function*flattenVTree(node){if(yield node,isVNode(node))for(let i=0;i<node.children.length;i++)yield*flattenVTree(node.children[i])}const getFlatArray=node=>Array.from(flattenVTree(node));function collectPageElements(page,patches,regexp){if(0===page.children.length)return[];const elements=[];if(page.properties&&page.properties.id&&page.properties.className&&page.properties.className.split(" ").includes("arjs-textBoxItem")){const lastPatch=function(array,predicate){return findLast$3(predicate,array)}(patches,(p=>!(!p||!p.children||p.id!==page.properties.id)));const fullText=(lastPatch?flatten$1(lastPatch.children.map((c=>getFlatArray(c)))):getFlatArray(page)).filter((n=>isVText(n)||isVNode(n)&&("DIV"===n.tagName||"BR"===n.tagName))).reduce(((agg,cur,i,arr)=>{if(isVNode(cur)&&"DIV"===cur.tagName){const previousNode=arr[i-1];previousNode&&isVNode(previousNode)&&"DIV"===previousNode.tagName||0===agg.length||agg.push(cur)}else agg.push(cur);return agg}),[]).map((n=>isVText(n)?n.text:" ")).join("");if(fullText){let span=null;for(;null!==(span=regexp.exec(fullText));)elements.push({text:fullText,id:page.properties.id,position:span.index,length:span[0].length})}}else{const childNodes=page.children.filter(isVNode);for(let i=0;i<childNodes.length;i++)elements.push(...collectPageElements(childNodes[i],patches,regexp))}return elements}function findElement(rootElement,predicate){for(let i=0;i<rootElement.childNodes.length;i++)if(rootElement.childNodes[i].nodeType===Node.ELEMENT_NODE){const element=rootElement.childNodes[i];if(predicate(element))return element;const result=findElement(element,predicate);if(result)return result}return null}var module,fontfaceobserver_standalone={exports:{}};module=fontfaceobserver_standalone,function(){function l(a,b){document.addEventListener?a.addEventListener("scroll",b,!1):a.attachEvent("scroll",b)}function t(a){this.a=document.createElement("div"),this.a.setAttribute("aria-hidden","true"),this.a.appendChild(document.createTextNode(a)),this.b=document.createElement("span"),this.c=document.createElement("span"),this.h=document.createElement("span"),this.f=document.createElement("span"),this.g=-1,this.b.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.c.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.f.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.h.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;",this.b.appendChild(this.h),this.c.appendChild(this.f),this.a.appendChild(this.b),this.a.appendChild(this.c)}function u(a,b){a.a.style.cssText="max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;white-space:nowrap;font-synthesis:none;font:"+b+";"}function z(a){var b=a.a.offsetWidth,c=b+100;return a.f.style.width=c+"px",a.c.scrollLeft=c,a.b.scrollLeft=a.b.scrollWidth+100,a.g!==b&&(a.g=b,!0)}function A(a,b){function c(){var a=k;z(a)&&a.a.parentNode&&b(a.g)}var k=a;l(a.b,c),l(a.c,c),z(a)}function B(a,b){var c=b||{};this.family=a,this.style=c.style||"normal",this.weight=c.weight||"normal",this.stretch=c.stretch||"normal"}var C=null,D=null,E=null,F=null;function J(){return null===F&&(F=!!document.fonts),F}function K(){if(null===E){var a=document.createElement("div");try{a.style.font="condensed 100px sans-serif"}catch(b){}E=""!==a.style.font}return E}function L(a,b){return[a.style,a.weight,K()?a.stretch:"","100px",b].join(" ")}B.prototype.load=function(a,b){var c=this,k=a||"BESbswy",r=0,n=b||3e3,H=(new Date).getTime();return new Promise((function(a,b){if(J()&&!function(){if(null===D)if(J()&&/Apple/.test(window.navigator.vendor)){var a=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))(?:\.([0-9]+))/.exec(window.navigator.userAgent);D=!!a&&603>parseInt(a[1],10)}else D=!1;return D}()){var M=new Promise((function(a,b){!function e(){(new Date).getTime()-H>=n?b(Error(n+"ms timeout exceeded")):document.fonts.load(L(c,'"'+c.family+'"'),k).then((function(c){1<=c.length?a():setTimeout(e,25)}),b)}()})),N=new Promise((function(a,c){r=setTimeout((function(){c(Error(n+"ms timeout exceeded"))}),n)}));Promise.race([N,M]).then((function(){clearTimeout(r),a(c)}),b)}else!function(a){document.body?a():document.addEventListener?document.addEventListener("DOMContentLoaded",(function c(){document.removeEventListener("DOMContentLoaded",c),a()})):document.attachEvent("onreadystatechange",(function k(){"interactive"!=document.readyState&&"complete"!=document.readyState||(document.detachEvent("onreadystatechange",k),a())}))}((function(){function v(){var b;(b=-1!=f&&-1!=g||-1!=f&&-1!=h||-1!=g&&-1!=h)&&((b=f!=g&&f!=h&&g!=h)||(null===C&&(b=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),C=!!b&&(536>parseInt(b[1],10)||536===parseInt(b[1],10)&&11>=parseInt(b[2],10))),b=C&&(f==w&&g==w&&h==w||f==x&&g==x&&h==x||f==y&&g==y&&h==y)),b=!b),b&&(d.parentNode&&d.parentNode.removeChild(d),clearTimeout(r),a(c))}var e=new t(k),p=new t(k),q=new t(k),f=-1,g=-1,h=-1,w=-1,x=-1,y=-1,d=document.createElement("div");d.dir="ltr",u(e,L(c,"sans-serif")),u(p,L(c,"serif")),u(q,L(c,"monospace")),d.appendChild(e.a),d.appendChild(p.a),d.appendChild(q.a),document.body.appendChild(d),w=e.a.offsetWidth,x=p.a.offsetWidth,y=q.a.offsetWidth,function I(){if((new Date).getTime()-H>=n)d.parentNode&&d.parentNode.removeChild(d),b(Error(n+"ms timeout exceeded"));else{var a=document.hidden;!0!==a&&void 0!==a||(f=e.a.offsetWidth,g=p.a.offsetWidth,h=q.a.offsetWidth,v()),r=setTimeout(I,50)}}(),A(e,(function(a){f=a,v()})),u(e,L(c,'"'+c.family+'",sans-serif')),A(p,(function(a){g=a,v()})),u(p,L(c,'"'+c.family+'",serif')),A(q,(function(a){h=a,v()})),u(q,L(c,'"'+c.family+'",monospace'))}))}))},module.exports=B}();var FontFaceObserver=fontfaceobserver_standalone.exports;const domFonts=[],fontStore=[];let styleElement;function isFontEqual(f1,f2){return f1.name===f2.name&&f1.style===f2.style&&f1.weight===f2.weight}function registerFont(...fonts){return __awaiter(this,void 0,void 0,(function*(){domFonts.push(...fonts.filter((font=>(font=>font.name&&(font.source||font.locals))(font)&&!domFonts.find((f=>isFontEqual(f.descriptor,font))))).map((font=>({descriptor:font,loaded:!1})))),yield function(){return __awaiter(this,void 0,void 0,(function*(){if("undefined"==typeof document)return;styleElement||(styleElement=document.createElement("style"),document.body.appendChild(styleElement)),styleElement.innerHTML=generateFontFacesCSS();const observers=domFonts.filter((font=>!font.loaded&&font.descriptor.source&&font.descriptor.source.length>0)).map((font=>new FontFaceObserver(font.descriptor.name,{style:font.descriptor.style,weight:font.descriptor.weight})));yield Promise.all(observers.map((observer=>observer.load().catch((()=>{}))))),domFonts.forEach((font=>{font.loaded=!0}))}))}()}))}const quote=s=>`"${s&&s.replace(/['"]/g,"'").replace(/^'|'$/g,"")}"`;function generateFontFacesCSS(){const styles=[];for(const font of domFonts){const locals=(font.descriptor.locals||[]).filter(Boolean).map((local=>`local(${quote(local)})`)),urls=(Array.isArray(font.descriptor.source)?font.descriptor.source:[font.descriptor.source]).filter(Boolean).map((url=>`url(${quote(url)})`));styles.push({"font-family":quote(font.descriptor.name),"font-style":font.descriptor.style,"font-weight":font.descriptor.weight,src:[...locals,...urls].join(", ")})}return styles.map((fontStyle=>`@font-face { ${(style=>Object.keys(style).filter((key=>!!style[key])).map((key=>`${key}: ${style[key]};`)).join(" "))(fontStyle)} }`)).join("\n")}function getFonts(){return fontStore.slice()}const FontStore={registerFonts:function registerFonts(value,...rest){if("string"==typeof value){return fetch(value).then((response=>response.json())).then((config=>registerFonts(...(null==config?void 0:config.descriptors)||[])))}return[value,...rest].forEach((f=>{const currIdx=fontStore.findIndex((registered=>isFontEqual(f,registered)));currIdx>=0&&fontStore.splice(currIdx,1),fontStore.push(f)})),registerFont(...getFonts().filter((font=>!font.postscriptName)))},getFonts:getFonts};const arjsStyles='.arjs-reportPage, .arjs-reportPage * {\r\n\tbox-sizing: border-box;\r\n\t-moz-box-sizing: border-box;\r\n\t-webkit-box-sizing: border-box;\r\n}\r\n\r\n@media screen {\r\n\t.arjs-hide-screen {\r\n\t\tvisibility: hidden;\r\n\t}\r\n}\r\n\r\n@media print {\r\n\t.arjs-hide-paper {\r\n\t\tvisibility: hidden;\r\n\t}\r\n}\r\n\r\n.arjs-reportPage {\r\n\tbackground-color: white;\r\n\tcolor: black;\r\n\tfont-family: Arial;\r\n\tfont-size: 10pt;\r\n\tfont-weight: normal;\r\n\tfont-style: normal;\r\n\ttext-rendering: optimizeSpeed;\r\n\ttext-decoration-skip-ink: none;\r\n}\r\n\r\n.arjs-canvasItem {\r\n\tposition: absolute;\r\n}\r\n.arjs-itemContent {\r\n\tposition: absolute;\r\n}\r\n.arjs-stack_vert {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n}\r\n.arjs-stack_horz {\r\n\tdisplay: flex;\r\n\tflex-direction: row;\r\n}\r\n.arjs-listItem {\r\n\tposition: relative;\r\n}\r\n.arjs-section {\r\n\tposition: relative;\r\n}\r\n.arjs-placeItem {\r\n\tposition: absolute;\r\n\tz-index: inherit;\r\n}\r\n.arjs-tableItem {\r\n\tborder-collapse: collapse;\r\n\ttable-layout: fixed;\r\n}\r\n.arjs-tableCell {\r\n\tpadding: 0;\r\n\tvertical-align: top;\r\n}\r\n@-moz-document url-prefix() {\r\n\t.arjs-tableCell {\r\n\t\t height: 100%;\r\n\t }\r\n}\r\n.arjs-cellContent {\r\n\tposition: relative;\r\n\theight: 100%;\r\n\toverflow: hidden;\r\n}\r\n.arjs-cellContent > div {\r\n\tmin-height: 100%;\r\n\tmin-width: 100%;\r\n}\r\n.arjs-cbControl {\r\n\twidth: 12px;\r\n\theight: 12px;\r\n\tmin-width: 12px;\r\n\tmin-height: 12px;\r\n\tborder-width: 1px;\r\n\tborder-style: solid;\r\n}\r\n\r\n.arjs-cbCommon {\r\n\twidth: 100%;\r\n\theight: 100%;\r\n\toverflow: hidden;\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\tjustify-content: flex-start;\r\n\talign-items: center;\r\n\ttext-align: center;\r\n}\r\n\r\n.arjs-cbTopLeft {\r\n\talign-items: flex-start;\r\n\ttext-align: left;\r\n}\r\n\r\n.arjs-cbTopRight {\r\n\talign-items: flex-end;\r\n\ttext-align: right;\r\n}\r\n\r\n.arjs-cbMiddleLeft {\r\n\tflex-direction: row;\r\n\ttext-align: left;\r\n}\r\n\r\n.arjs-cbMiddleCenter {\r\n\tflex-direction: row;\r\n\tjustify-content: center;\r\n}\r\n\r\n.arjs-cbMiddleRight {\r\n\tflex-direction: row-reverse;\r\n\ttext-align: right;\r\n}\r\n\r\n.arjs-cbBottomLeft {\r\n\tflex-direction: column-reverse;\r\n\talign-items: flex-start;\r\n\ttext-align: left;\r\n}\r\n\r\n.arjs-cbBottomCenter {\r\n\tflex-direction: column-reverse;\r\n}\r\n\r\n.arjs-cbBottomRight {\r\n\tflex-direction: column-reverse;\r\n\talign-items: flex-end;\r\n\ttext-align: right;\r\n}\r\n\r\n.arjs-cbTextCommon {\r\n\twidth: 100%;\r\n}\r\n.arjs-cbPadding {\r\n\tpadding-bottom: 0.75pt;\r\n}\r\n\r\n.arjs-cbTextTopLeft, .arjs-cbTextBottomLeft {\r\n\tpadding-left: 14px;\r\n}\r\n\r\n.arjs-cbTextTopRight, .arjs-cbTextBottomRight {\r\n\tpadding-right: 14px;\r\n}\r\n\r\n.arjs-cbTextMiddleLeft {\r\n\tpadding-left: 2px;\r\n\twidth: calc(100% - 2px);\r\n}\r\n\r\n.arjs-cbTextMiddleCenter{\r\n\tposition: absolute;\r\n}\r\n\r\n.arjs-cbTextMiddleRight {\r\n\tpadding-right: 2px;\r\n\twidth: calc(100% - 2px);\r\n}\r\n\r\n.arjs-textBoxItem {\r\n\tdisplay: flex;\r\n\tposition: absolute;\r\n\toverflow: hidden;\r\n}\r\n\r\n.arjs-textBoxContent {\r\n\twidth: 100%;\r\n\tmax-height: 100%;\r\n\toverflow: hidden;\r\n\ttext-decoration-style: inherit;\r\n\ttext-decoration-line: inherit;\r\n\ttransform-origin: left top;\r\n}\r\n\r\n.arjs-hideOverflow {\r\n\toverflow: hidden;\r\n}\r\n\r\n.arjs-action {\r\n\tcursor: pointer;\r\n\ttext-decoration-style: inherit;\r\n\ttext-decoration-line: inherit;\r\n}\r\n\r\n.arjs-action.arjs-control {\r\n\tbackground-size: contain;\r\n\tbackground-repeat: no-repeat;\r\n\tdisplay: inline-block;\r\n}\r\n\r\n.arjs-action.arjs-control.arjs-toggle-placeholder, /* ARJ-3744. Remove this class after drop IE support */\r\n.arjs-action.arjs-control.arjs-toggle-expanded,\r\n.arjs-action.arjs-control.arjs-toggle-collapsed {\r\n\tmin-width: 15px;\r\n\tmin-height: 15px;\r\n}\r\n\r\n.arjs-action.arjs-control.arjs-sort-placeholder, /* ARJ-3744. Remove this class after drop IE support */\r\n.arjs-action.arjs-control.arjs-sort-variant,\r\n.arjs-action.arjs-control.arjs-sort-ascending,\r\n.arjs-action.arjs-control.arjs-sort-descending {\r\n\tmin-width: 18px;\r\n\tmin-height: 18px;\r\n}\r\n\r\n.arjs-toggle-expanded {\r\n\tbackground-image: url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZD0iTTE5LDEzSDEzVjE5SDExVjEzSDVWMTFIMTFWNUgxM1YxMUgxOVYxM1oiIC8+PC9zdmc+");\r\n}\r\n\r\n.arjs-toggle-collapsed {\r\n\tbackground-image: url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZD0iTTE5LDEzSDVWMTFIMTlWMTNaIiAvPjwvc3ZnPg==");\r\n}\r\n\r\n/* ARJ-3744. Remove this class after drop IE support */\r\n.arjs-icon-placeholder {\r\n\tbackground-image: url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiBoZWlnaHQ9IjI0IiB3aWR0aD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PC9zdmc+DQo=");\r\n}\r\n\r\n.arjs-sort-variant {\r\n\tbackground-image: url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZD0iTTEwLDEzVjExSDE4VjEzSDEwTTEwLDE5VjE3SDE0VjE5SDEwTTEwLDdWNUgyMlY3SDEwTTYsMTdIOC41TDUsMjAuNUwxLjUsMTdINFY3SDEuNUw1LDMuNUw4LjUsN0g2VjE3WiIgLz48L3N2Zz4=");\r\n}\r\n\r\n.arjs-sort-ascending {\r\n\tbackground-image: url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZD0iTTEwLDExVjEzSDE4VjExSDEwTTEwLDVWN0gxNFY1SDEwTTEwLDE3VjE5SDIyVjE3SDEwTTYsN0g4LjVMNSwzLjVMMS41LDdINFYyMEg2VjdaIiAvPjwvc3ZnPg==");\r\n}\r\n\r\n.arjs-sort-descending {\r\n\tbackground-image: url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZD0iTTEwLDEzVjExSDE4VjEzSDEwTTEwLDE5VjE3SDE0VjE5SDEwTTEwLDdWNUgyMlY3SDEwTTYsMTdIOC41TDUsMjAuNUwxLjUsMTdINFY0SDZWMTdaIiAvPjwvc3ZnPg==");\r\n}\r\n\r\n.arjs-tocLevelLabel {\r\n\ttext-decoration-style: inherit;\r\n\ttext-decoration-line: inherit;\r\n    white-space: pre-wrap;\r\n}\r\n\r\n.arjs-flex-wrap {\r\n\tdisplay: flex;\r\n\tflex-wrap: wrap;\r\n\tjustify-content: flex-start;\r\n}\r\n\r\n.arjs-barcode {\r\n\tdisplay: flex;\r\n}\r\n.arjs-barcode > div {\r\n\tflex: 1;\r\n}\r\n\r\n.arjs-flex-textitem {\r\n\tflex: 0 1 auto;\r\n\ttext-decoration-style: inherit;\r\n\ttext-decoration-line: inherit;\r\n\tpointer-events: none;\r\n}\r\n\r\n.arjs-flex-textfiller {\r\n\tflex: 1 1 auto;\r\n\tposition: relative;\r\n\toverflow: hidden;\r\n\ttext-decoration-style: inherit;\r\n\ttext-decoration-line: inherit;\r\n\tpointer-events: none;\r\n}\r\n\r\n.arjs-text-tab {\r\n\tdisplay: inline-block;\r\n\ttext-align: left;\r\n\ttext-decoration-style: inherit;\r\n\ttext-decoration-line: inherit;\r\n\tpointer-events: none;\r\n}\r\n\r\n.arjs-float-r {\r\n\tfloat: right;\r\n\ttext-decoration-style: inherit;\r\n\ttext-decoration-line: inherit;\r\n}\r\n\r\n.arjs-float-r-abs {\r\n\tdisplay: flex;\r\n\tflex-direction: row-reverse;\r\n\tposition: absolute;\r\n\tright: 0;\r\n\ttext-decoration-style: inherit;\r\n\ttext-decoration-line: inherit;\r\n}\r\n\r\n.arjs-char-wrap {\r\n\toverflow-wrap: break-word;\r\n\ttext-decoration-style: inherit;\r\n\ttext-decoration-line: inherit;\r\n}\r\n\r\n.arjs-bordersItem {\r\n\tpointer-events: none;\r\n}\r\n\r\n.arjs-errorMessage {\r\n\tfont-size: 10pt;\r\n\tcolor: Black;\r\n\tpadding: 2pt;\r\n}\r\n\r\n.arjs-inputField {\r\n\tdisplay: table-cell;\r\n\tvertical-align: middle;\r\n\theight: 100%;\r\n}\r\n\r\n.arjs-inputFieldBase {\r\n\tposition: relative;\r\n\tdisplay: table;\r\n\theight: 100%;\r\n\twidth: 100%;\r\n}\r\n\r\n.arjs-fullSize {\r\n\twidth: 100%;\r\n\theight: 100%;\r\n}\r\n\r\n.arjs-textRun {\r\n\toverflow: hidden;\r\n}\r\n\r\n.arjs-textLine {\r\n\twhite-space: nowrap;\r\n\tdisplay: block;\r\n\ttext-indent: initial;\r\n}\r\n\r\n.arjs-textLine:last-child {\r\n\ttext-align-last: auto;\r\n}\r\n\r\n.arjs-textLine:first-child {\r\n\ttext-indent: inherit;\r\n}\r\n\r\n.arjs-richtext-list-item {\r\n\tdisplay: flex;\r\n\talign-items: baseline;\r\n}\r\n\r\n.arjs-richtext-list-item__content {\r\n\tflex-grow: 1;  /* let the list item content take all available space */\r\n}\r\n\r\n.arjs-richtext-list-item__marker {\r\n\tdisplay: flex;\r\n\tjustify-content: flex-end;\r\n\ttext-indent: 0;\r\n}\r\n\r\n.arjs-upright {\r\n\t-webkit-text-combine: horizontal; /* Safari */\r\n\ttext-combine-upright: all;\r\n}\r\n\r\n.arjs-frozen-row {\r\n\tposition: relative;\r\n}\r\n\r\n.arjs-frozen-cell {\r\n\tposition: sticky;\r\n}\r\n\r\n.arjs-cell-outline-borders {\r\n\tborder-color: transparent !important;\r\n}\r\n\r\n.arjs-cell-outline-borders > div > div {\r\n\tposition: absolute;\r\n}\r\n\r\n.arjs-cell-outline-borders > div {\r\n\twidth: 100%;\r\n\theight: 100%;\r\n}\r\n\r\n.arjs-frozen-cell > div > div {\r\n\tleft: 0pt;\r\n\ttop: 0pt;\r\n}\r\n\r\n/* see node_modules/gc-dv/lib/gcdv.css */\r\n.gcdv-tooltip {\r\n    position: absolute;\r\n    z-index: 1000;\r\n    top: 0;\r\n    left: 0;\r\n    pointer-events: none;\r\n    max-width: 400px;\r\n    padding: 6px;\r\n    background-color: #ffffe5;\r\n    border: 1px solid rgba(0, 0, 0, .1);\r\n    border-radius: 6px;\r\n    box-shadow: 0 6px 12px rgba(0, 0, 0, .175);\r\n    box-sizing: border-box\r\n}\r\n';function print(renderer,onProgress,checkCancel){return __awaiter(this,void 0,void 0,(function*(){const i18n=renderer.i18n;!function(html,i18n){var _a;if(isElectron()){const win=window.open();if(!win)throw new Error(i18n.t("core:errors.print.open-window-failed","Cannot open new window"));win.document.open(),win.document.write(html),win.document.close()}else{const iframe=document.createElement("iframe");iframe.style.display="none",document.body.appendChild(iframe);const listener=e=>{"arjs-print-done"===e.data&&(document.body.removeChild(iframe),window.removeEventListener("message",listener))};window.addEventListener("message",listener);const iframeDocument=null===(_a=iframe.contentWindow)||void 0===_a?void 0:_a.document;if(!iframeDocument)return void console.log("Cannot access iframe document");iframeDocument.open(),iframeDocument.write(html),iframeDocument.close()}}(yield function(renderer,i18n,onProgress,checkCancel){return __awaiter(this,void 0,void 0,(function*(){const cancelledMsg=i18n.t("core:errors.print.cancel-print-message","Print process was cancelled by user"),renderIterator=renderer.render();for(;!renderIterator.next().done;)if(checkCancel&&checkCancel())return new Promise(((_,reject)=>__awaiter(this,void 0,void 0,(function*(){reject(cancelledMsg)}))));const{pages:pages,patches:patches,styles:styles}=renderer.getContent(),stylesElement=document.createElement("style"),staticStyles=styles.filter((s=>s.className)).map((s=>`.${s.className} {${VDomRenderer.getCssString(s.style)}}`)).join(" ");stylesElement.innerText=staticStyles,document.body.appendChild(stylesElement);const rootElement=document.createElement("div");rootElement.style.position="absolute",rootElement.style.visibility="hidden",rootElement.style.width="10px",rootElement.style.height="10px",rootElement.style.overflow="hidden",document.body.appendChild(rootElement);const cleanElements=()=>{if(stylesElement)try{document.body.removeChild(stylesElement)}catch(e){}if(rootElement)try{document.body.removeChild(rootElement)}catch(e){}};let currentPageIndex=0,currentPage=null;const nextPage=()=>new Promise((resolve=>{currentPage&&rootElement.removeChild(currentPage),currentPageIndex>=pages.length?resolve(null):(currentPage=VDomRenderer.renderToDOM(pages[currentPageIndex],patches[currentPageIndex],{hideInteractivity:!0}),currentPage?(rootElement.appendChild(currentPage),currentPageIndex++,setTimeout((()=>{currentPage&&rootElement.removeChild(currentPage);const html=currentPage&&currentPage.outerHTML,size=currentPage&&{width:currentPage.style.width,height:currentPage.style.height};currentPage=null,resolve(html&&size?{html:html,size:size}:null)}),20)):resolve(null))}));return new Promise(((resolve,reject)=>__awaiter(this,void 0,void 0,(function*(){try{let pageIndex=0,pageNode=yield nextPage();if(!pageNode)return cleanElements(),void reject(i18n.t("core:errors.print.first-page-render-failed","First page render failed"));const pages=[];let pageSize=null;for(;pageNode;){if(onProgress&&onProgress(pageIndex+1),pages.push(pageNode.html),pageSize=pageSize||pageNode.size,pageIndex++,checkCancel&&checkCancel())return cleanElements(),void reject(cancelledMsg);pageNode=yield nextPage()}cleanElements(),resolve(function(content,styles,size){const sizeTemplate=size?`\n\t\t\t\tsize: ${size.width} ${size.height};`:"";return`<!DOCTYPE html>\n<html>\n\t<head>\n\t\t<meta charset="utf-8">\n\t\t<title>Report</title>\n\t\t<style>\n\t\t\tbody {\n\t\t\t\tmargin: 0pt;\n\t\t\t\tpadding: 0pt;\n\t\t\t}\n\t\t\t.arjs-pageWrapper {\n\t\t\t\theight: ${size?"calc("+size.height+" - 1mm)":"auto"};\n\t\t\t\twidth: ${size?"calc("+size.width+" - 1mm)":"auto"};\n\t\t\t\tpage-break-after: always;\n\t\t\t\toverflow: hidden;\n\t\t\t}\n\t\t\t@page {\n\t\t\t\tmargin: 0mm;${sizeTemplate}\n\t\t\t}\n\t\t\t@media screen {\n\t\t\t\t.arjs-pageWrapper {\n\t\t\t\t\tdisplay: none !important;\n\t\t\t\t}\n\t\t\t}\n\t\t\t@media print {\n\t\t\t\t.arjs-pageWrapper {\n\t\t\t\t\t-webkit-print-color-adjust: exact;\n\t\t\t\t\tdisplay: block !important;\n\t\t\t\t\t${"firefox"===environment?"padding-top: 1px;":""}\n\t\t\t\t}\n\t\t\t}\n\t\t</style>\n\t\t<style>${arjsStyles}</style>\n\t\t<style>${styles}</style>\n\t</head>\n\t<body onload="load()">\n\t\t${content}\n\t\t<script>\n\t\t\t${fontFaceObserverScript}\n\t\t<\/script>\n\t\t<script>\n\t\t\tfunction load() {\n\t\t\t\tconst fonts = [${domFonts.map((font=>JSON.stringify({name:font.descriptor.name,style:font.descriptor.style||"normal",weight:font.descriptor.weight||"normal"}))).join(",")}];\n\t\t\t\tconst observers = fonts.map(function (font) {\n\t\t\t\t\treturn new FontFaceObserver(font.name, { style: font.style, weight: font.weight })\n\t\t\t\t});\n\t\t\t\tPromise.all(observers.map(function (observer) {\n\t\t\t\t\treturn observer.load().catch(function() { /* ignore errors */ })\n\t\t\t\t}))\n\t\t\t\t.then(function() { printDocument() })\n\t\t\t}\n\t\t\tfunction printDocument() {\n\t\t\t\tsetTimeout(${selfPrintingScript}, 0)\n\t\t\t}\n\t\t<\/script>\n\t</body>\n</html>`}(pages.map((page=>`<div class="arjs-pageWrapper">${page}</div>`)).join("\n"),staticStyles+generateFontFacesCSS(),pageSize))}catch(error){cleanElements(),reject(error.message)}}))))}))}(renderer,i18n,onProgress,checkCancel),i18n)}))}const selfPrintingScript=`function(){ ${isElectron()?'require("electron").ipcRenderer.invoke("print-report");':'window.print(); parent.postMessage("arjs-print-done", "*");'}}`,fontFaceObserverScript='/* Font Face Observer v2.1.0 - \xa9 Bram Stein. License: BSD-3-Clause */(function(){function l(a,b){document.addEventListener?a.addEventListener("scroll",b,!1):a.attachEvent("scroll",b)}function m(a){document.body?a():document.addEventListener?document.addEventListener("DOMContentLoaded",function c(){document.removeEventListener("DOMContentLoaded",c);a()}):document.attachEvent("onreadystatechange",function k(){if("interactive"==document.readyState||"complete"==document.readyState)document.detachEvent("onreadystatechange",k),a()})};function t(a){this.a=document.createElement("div");this.a.setAttribute("aria-hidden","true");this.a.appendChild(document.createTextNode(a));this.b=document.createElement("span");this.c=document.createElement("span");this.h=document.createElement("span");this.f=document.createElement("span");this.g=-1;this.b.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";this.c.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";\nthis.f.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";this.h.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;";this.b.appendChild(this.h);this.c.appendChild(this.f);this.a.appendChild(this.b);this.a.appendChild(this.c)}\nfunction u(a,b){a.a.style.cssText="max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;white-space:nowrap;font-synthesis:none;font:"+b+";"}function z(a){var b=a.a.offsetWidth,c=b+100;a.f.style.width=c+"px";a.c.scrollLeft=c;a.b.scrollLeft=a.b.scrollWidth+100;return a.g!==b?(a.g=b,!0):!1}function A(a,b){function c(){var a=k;z(a)&&a.a.parentNode&&b(a.g)}var k=a;l(a.b,c);l(a.c,c);z(a)};function B(a,b){var c=b||{};this.family=a;this.style=c.style||"normal";this.weight=c.weight||"normal";this.stretch=c.stretch||"normal"}var C=null,D=null,E=null,F=null;function G(){if(null===D)if(J()&&/Apple/.test(window.navigator.vendor)){var a=/AppleWebKit\\/([0-9]+)(?:\\.([0-9]+))(?:\\.([0-9]+))/.exec(window.navigator.userAgent);D=!!a&&603>parseInt(a[1],10)}else D=!1;return D}function J(){null===F&&(F=!!document.fonts);return F}\nfunction K(){if(null===E){var a=document.createElement("div");try{a.style.font="condensed 100px sans-serif"}catch(b){}E=""!==a.style.font}return E}function L(a,b){return[a.style,a.weight,K()?a.stretch:"","100px",b].join(" ")}\nB.prototype.load=function(a,b){var c=this,k=a||"BESbswy",r=0,n=b||3E3,H=(new Date).getTime();return new Promise(function(a,b){if(J()&&!G()){var M=new Promise(function(a,b){function e(){(new Date).getTime()-H>=n?b(Error(""+n+"ms timeout exceeded")):document.fonts.load(L(c,\'"\'+c.family+\'"\'),k).then(function(c){1<=c.length?a():setTimeout(e,25)},b)}e()}),N=new Promise(function(a,c){r=setTimeout(function(){c(Error(""+n+"ms timeout exceeded"))},n)});Promise.race([N,M]).then(function(){clearTimeout(r);a(c)},\nb)}else m(function(){function v(){var b;if(b=-1!=f&&-1!=g||-1!=f&&-1!=h||-1!=g&&-1!=h)(b=f!=g&&f!=h&&g!=h)||(null===C&&(b=/AppleWebKit\\/([0-9]+)(?:\\.([0-9]+))/.exec(window.navigator.userAgent),C=!!b&&(536>parseInt(b[1],10)||536===parseInt(b[1],10)&&11>=parseInt(b[2],10))),b=C&&(f==w&&g==w&&h==w||f==x&&g==x&&h==x||f==y&&g==y&&h==y)),b=!b;b&&(d.parentNode&&d.parentNode.removeChild(d),clearTimeout(r),a(c))}function I(){if((new Date).getTime()-H>=n)d.parentNode&&d.parentNode.removeChild(d),b(Error(""+\nn+"ms timeout exceeded"));else{var a=document.hidden;if(!0===a||void 0===a)f=e.a.offsetWidth,g=p.a.offsetWidth,h=q.a.offsetWidth,v();r=setTimeout(I,50)}}var e=new t(k),p=new t(k),q=new t(k),f=-1,g=-1,h=-1,w=-1,x=-1,y=-1,d=document.createElement("div");d.dir="ltr";u(e,L(c,"sans-serif"));u(p,L(c,"serif"));u(q,L(c,"monospace"));d.appendChild(e.a);d.appendChild(p.a);d.appendChild(q.a);document.body.appendChild(d);w=e.a.offsetWidth;x=p.a.offsetWidth;y=q.a.offsetWidth;I();A(e,function(a){f=a;v()});u(e,\nL(c,\'"\'+c.family+\'",sans-serif\'));A(p,function(a){g=a;v()});u(p,L(c,\'"\'+c.family+\'",serif\'));A(q,function(a){h=a;v()});u(q,L(c,\'"\'+c.family+\'",monospace\'))})})};window.FontFaceObserver=B,window.FontFaceObserver.prototype.load=B.prototype.load;}());\n';function isElectron(){return"undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type||(!("undefined"==typeof process||"object"!=typeof process.versions||!process.versions.electron)||"object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent.indexOf("Electron")>=0)}var factory,production_lic={exports:{}};factory=function(){return function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:!1};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.loaded=!0,module.exports}return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.p="dist",__webpack_require__(0)}([function(module,exports){(function(global){Object.defineProperty(exports,"__esModule",{value:!0});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},isBrowser="undefined"!=typeof window,stringFromCharCode=String.fromCharCode,uint8Array=isBrowser&&window.Uint8Array||function(arg1){var result;if("number"==typeof arg1){result=new Array(arg1);for(var i=0;i<arg1;++i)result[i]=0}else result=arg1.slice(0);return result.buffer=result,result.byteLength=result.length,"object"===(void 0===arg1?"undefined":_typeof(arg1))&&arg1.buffer&&(result.buffer=arg1.buffer),result},STR64CODE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",freeGlobal="object"==(void 0===global?"undefined":_typeof(global))&&global&&global.Object===Object&&global,freeSelf="object"==("undefined"==typeof self?"undefined":_typeof(self))&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf;function swapArrayElements(a,x,y,transform){return 1==a.length||a.splice(y,1,transform(a.splice(x,1,transform(a[y]))[0])),a}function unshiftString(str){for(var charArray=str.split(""),unshifChar=function(c){return function(char){var step=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,code=char.charCodeAt(0);return code>=65&&code<=90?char.toLowerCase():code>=97&&code<=122?char.toUpperCase():code>=48&&code<=57?stringFromCharCode(48+(code-48+10+step)%10):char}(c,-1)},i=charArray.length-5;i>=0;i--)swapArrayElements(charArray,i+1,i+3,unshifChar),swapArrayElements(charArray,i,i+2,unshifChar);return charArray.join("")}function btoaPolyfill(str){var bits,h1,h2,h3,h4,c,plain,coded,e=[],pad="",b64=STR64CODE;if((c=(plain=str).length%3)>0)for(;c++<3;)pad+="=",plain+="\0";for(c=0;c<plain.length;c+=3)h1=(bits=plain.charCodeAt(c)<<16|plain.charCodeAt(c+1)<<8|plain.charCodeAt(c+2))>>18&63,h2=bits>>12&63,h3=bits>>6&63,h4=63&bits,e[c/3]=b64.charAt(h1)+b64.charAt(h2)+b64.charAt(h3)+b64.charAt(h4);return coded=(coded=e.join("")).slice(0,coded.length-pad.length)+pad}function atobPolyfill(str){var o1,o2,o3,h3,h4,bits,coded,d=[],b64=STR64CODE;coded=str;for(var c=0;c<coded.length;c+=4)o1=(bits=b64.indexOf(coded.charAt(c))<<18|b64.indexOf(coded.charAt(c+1))<<12|(h3=b64.indexOf(coded.charAt(c+2)))<<6|(h4=b64.indexOf(coded.charAt(c+3))))>>>16&255,o2=bits>>>8&255,o3=255&bits,d[c/4]=stringFromCharCode(o1,o2,o3),64==h4&&(d[c/4]=stringFromCharCode(o1,o2)),64==h3&&(d[c/4]=stringFromCharCode(o1));return d.join("")}function decodeStr64(base64){return(isBrowser&&window.atob||atobPolyfill)(base64)}function encodeStr64(str){return(isBrowser&&window.btoa||btoaPolyfill)(str)}function decode(data){if(!data)return"";var source=unshiftString(data);source=source.split("").reverse().join("");var shiftLength=Math.ceil(source.length/2);return function(str){return decodeURIComponent(Array.prototype.map.call(decodeStr64(str),(function(c){return"%"+("00"+c.charCodeAt(0).toString(16)).slice(-2)})).join(""))}(source=(source=(source=source.substr(shiftLength)+source.substr(0,shiftLength)).replace("#","=")).replace("&","=="))}function str64ToArrayBuffer(base64){for(var binary_string=decodeStr64(base64),len=binary_string.length,bytes=new uint8Array(len),i=0;i<len;i++)bytes[i]=binary_string.charCodeAt(i);return bytes.buffer}function str2ArrayBuffer(str){for(var buf=new ArrayBuffer(str.length),bufView=new uint8Array(buf),i=0,strLen=str.length;i<strLen;i++)bufView[i]=str.charCodeAt(i);return buf}function asPromise(obj){return"oncomplete"in obj&&(obj.then=function(resolve,reject){obj.resolve=resolve,obj.reject=reject},obj.oncomplete=function(e){obj.resolve(obj.result)},obj.onerror=function(){obj.reject()}),obj}exports.iDe=decode,exports.attorn=function(licenseKey,productInfo,successCallback,failedCallback){var crypto=isBrowser?window.msCrypto?window.msCrypto:window.crypto:void 0,licObj=function(keyData,separator){try{separator="#"+separator;var i=keyData.indexOf(separator);if(i>-1)return{prefix:keyData.substring(0,i),licData:JSON.parse(decode(keyData.substr(i+separator.length)))}}catch(e){}return!1}(licenseKey,productInfo.aC);if(!licObj)return failedCallback();var buf,str,licData=licObj.licData,prefix=licObj.prefix+"#"+productInfo.aC,data=(buf=str64ToArrayBuffer((str=prefix+JSON.stringify(licData.D),encodeStr64(encodeURIComponent(str).replace(/%([0-9A-F]{2})/g,(function(match,p1){return stringFromCharCode(parseInt(p1,16))}))))),stringFromCharCode.apply(null,new uint8Array(buf)));function checkSum(){return function(str){for(var hash1=0,hash2=5381,hash3=0,i=str.length-1;i>=0;i--){var c=str.charCodeAt(i);hash1=c+(hash1<<6)+(hash1<<16)-hash1,hash2=c+((hash2<<5)+hash2),hash3=c+((hash3<<5)-hash3),hash3&=hash3}var hash=hash1^hash2^hash3;return hash<0&&(hash=~hash),hash.toString(16).toUpperCase()}(prefix+JSON.stringify(licData.D))===licData.H?successCallback(licData.D):failedCallback()}var l=decode("JYx3Gb#8Pb5R"),p=decode("VdgJHc#wJb59");if(root[l]&&root[l][p]&&!location.protocol.match(/^https/i))return checkSum();if(!crypto||!crypto.subtle)return checkSum();var jwk={alg:"PS256",e:"AQAB",kty:"RSA",n:(str64=productInfo.pK,str64.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/,""))};jwk=window.msCrypto?str2ArrayBuffer(JSON.stringify(jwk)):jwk;var str64,algo={name:"RSA-PSS",saltLength:32,hash:{name:"SHA-256"}};asPromise(crypto.subtle.importKey("jwk",jwk,algo,!1,["verify"])).then((function(key){asPromise(crypto.subtle.verify(algo,key,str64ToArrayBuffer(licData.S),str2ArrayBuffer(data))).then((function(result){return result?successCallback(licData.D):failedCallback()}))}),(function(){return checkSum()}))}}).call(exports,function(){return this}())}])},production_lic.exports=factory();let _key="";function setLicenseKey(key){_key=key}function getLicenseKey(){return _key}function isLocalHost(){if(!window)return!1;if("file:"===window.location.protocol)return!0;const hostname=window.location.hostname;return!!(hostname.indexOf(".")<0||matchDomains(hostname,["127.0.0.1","[::1]","[0:0:0:0:0:0:0:1]","*.local"]))}function resolveLicense(){return __awaiter(this,void 0,void 0,(function*(){const key=_key;return new Promise(((resolve,reject)=>{if(!key)return isLocalHost()?resolve({Type:1}):resolve({Type:0});production_lic.exports.attorn(key,{pK:"l6/zrbWoSbcLFwEetFh38rH3ErBZE9H+Cqix3R+wTlfA1wD5B+lUcCQn+EJ60I4RGrm0x1sFjkiLWwB0jAn6BWZv0W4WbqAKriOdeoivxDp1Wmjs3qkEDhvbsjPtfvwx2BHil6o+/tDrdMJQSGs18WZm2PoQLQuL+9VhZ4FNRHUQU3Jtioke/OZEGHJOdYVwvCGalzBad6QFOiVbDBQPePpS3++GJzOxN8SN/7lyS5/IdKiy3WJRaVGkB370+HbN6hKraDfUgReLX26yxRaKC/5aWnGAJ2NnWLoGyAGRcwT9dVjo4bcAZNrrA0U9JVKQxaSskhdv2p49XzJkltXx5w==",aC:"B1"},(data=>{if(!data.Prd||!data.Prd.some((prod=>"YVFT"===prod.C)))return resolve({Type:4});const domains=data.Dms;if(null!=domains){const currentDomain=window.location.hostname;if(!isLocalHost()&&!matchDomains(currentDomain,domains.split(",")))return resolve({Type:4})}const daysLeft=function(date){if(null==date)return;const expiry=new Date(parseInt(date.substr(0,4))||0,parseInt(date.substr(4,2))-1||0,parseInt(date.substr(6,2))||0),now=new Date;return Math.ceil((+expiry-+now)/864e5)}(data.Exp);return void 0!==daysLeft&&daysLeft<=0?resolve({Type:3}):data.Evl?resolve({Type:1,Left:daysLeft}):resolve({Type:2})}),(()=>resolve({Type:4})))}))}))}function matchDomains(hostname,domains){let i;const len=domains.length;let d,wildcard=!1;for(i=0;i<len;i++){if(d=domains[i],d&&0===d.lastIndexOf("*.",0)&&(wildcard=!0),d=wildcard?d.slice(2):d,d===hostname)return!0;if(wildcard){const ix=hostname.indexOf("."+d);if(ix>0&&ix===hostname.length-d.length-1)return!0}}return!1}var lookup=[],revLookup=[],Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,inited=!1;function init(){inited=!0;for(var code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,len=code.length;i<len;++i)lookup[i]=code[i],revLookup[code.charCodeAt(i)]=i;revLookup["-".charCodeAt(0)]=62,revLookup["_".charCodeAt(0)]=63}function encodeChunk(uint8,start,end){for(var tmp,num,output=[],i=start;i<end;i+=3)tmp=(uint8[i]<<16)+(uint8[i+1]<<8)+uint8[i+2],output.push(lookup[(num=tmp)>>18&63]+lookup[num>>12&63]+lookup[num>>6&63]+lookup[63&num]);return output.join("")}function fromByteArray(uint8){var tmp;inited||init();for(var len=uint8.length,extraBytes=len%3,output="",parts=[],i=0,len2=len-extraBytes;i<len2;i+=16383)parts.push(encodeChunk(uint8,i,i+16383>len2?len2:i+16383));return 1===extraBytes?(tmp=uint8[len-1],output+=lookup[tmp>>2],output+=lookup[tmp<<4&63],output+="=="):2===extraBytes&&(tmp=(uint8[len-2]<<8)+uint8[len-1],output+=lookup[tmp>>10],output+=lookup[tmp>>4&63],output+=lookup[tmp<<2&63],output+="="),parts.push(output),parts.join("")}function read(buffer,offset,isLE,mLen,nBytes){var e,m,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,nBits=-7,i=isLE?nBytes-1:0,d=isLE?-1:1,s=buffer[offset+i];for(i+=d,e=s&(1<<-nBits)-1,s>>=-nBits,nBits+=eLen;nBits>0;e=256*e+buffer[offset+i],i+=d,nBits-=8);for(m=e&(1<<-nBits)-1,e>>=-nBits,nBits+=mLen;nBits>0;m=256*m+buffer[offset+i],i+=d,nBits-=8);if(0===e)e=1-eBias;else{if(e===eMax)return m?NaN:1/0*(s?-1:1);m+=Math.pow(2,mLen),e-=eBias}return(s?-1:1)*m*Math.pow(2,e-mLen)}function write(buffer,value,offset,isLE,mLen,nBytes){var e,m,c,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,rt=23===mLen?Math.pow(2,-24)-Math.pow(2,-77):0,i=isLE?0:nBytes-1,d=isLE?1:-1,s=value<0||0===value&&1/value<0?1:0;for(value=Math.abs(value),isNaN(value)||value===1/0?(m=isNaN(value)?1:0,e=eMax):(e=Math.floor(Math.log(value)/Math.LN2),value*(c=Math.pow(2,-e))<1&&(e--,c*=2),(value+=e+eBias>=1?rt/c:rt*Math.pow(2,1-eBias))*c>=2&&(e++,c/=2),e+eBias>=eMax?(m=0,e=eMax):e+eBias>=1?(m=(value*c-1)*Math.pow(2,mLen),e+=eBias):(m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen),e=0));mLen>=8;buffer[offset+i]=255&m,i+=d,m/=256,mLen-=8);for(e=e<<mLen|m,eLen+=mLen;eLen>0;buffer[offset+i]=255&e,i+=d,e/=256,eLen-=8);buffer[offset+i-d]|=128*s}var toString={}.toString,isArray=Array.isArray||function(arr){return"[object Array]"==toString.call(arr)};function kMaxLength(){return Buffer.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function createBuffer(that,length){if(kMaxLength()<length)throw new RangeError("Invalid typed array length");return Buffer.TYPED_ARRAY_SUPPORT?(that=new Uint8Array(length)).__proto__=Buffer.prototype:(null===that&&(that=new Buffer(length)),that.length=length),that}function Buffer(arg,encodingOrOffset,length){if(!(Buffer.TYPED_ARRAY_SUPPORT||this instanceof Buffer))return new Buffer(arg,encodingOrOffset,length);if("number"==typeof arg){if("string"==typeof encodingOrOffset)throw new Error("If encoding is specified then the first argument must be a string");return allocUnsafe(this,arg)}return from(this,arg,encodingOrOffset,length)}function from(that,value,encodingOrOffset,length){if("number"==typeof value)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&value instanceof ArrayBuffer?function(that,array,byteOffset,length){if(array.byteLength,byteOffset<0||array.byteLength<byteOffset)throw new RangeError("'offset' is out of bounds");if(array.byteLength<byteOffset+(length||0))throw new RangeError("'length' is out of bounds");array=void 0===byteOffset&&void 0===length?new Uint8Array(array):void 0===length?new Uint8Array(array,byteOffset):new Uint8Array(array,byteOffset,length);Buffer.TYPED_ARRAY_SUPPORT?(that=array).__proto__=Buffer.prototype:that=fromArrayLike(that,array);return that}(that,value,encodingOrOffset,length):"string"==typeof value?function(that,string,encoding){"string"==typeof encoding&&""!==encoding||(encoding="utf8");if(!Buffer.isEncoding(encoding))throw new TypeError('"encoding" must be a valid string encoding');var length=0|byteLength(string,encoding),actual=(that=createBuffer(that,length)).write(string,encoding);actual!==length&&(that=that.slice(0,actual));return that}(that,value,encodingOrOffset):function(that,obj){if(internalIsBuffer(obj)){var len=0|checked(obj.length);return 0===(that=createBuffer(that,len)).length||obj.copy(that,0,0,len),that}if(obj){if("undefined"!=typeof ArrayBuffer&&obj.buffer instanceof ArrayBuffer||"length"in obj)return"number"!=typeof obj.length||(val=obj.length)!=val?createBuffer(that,0):fromArrayLike(that,obj);if("Buffer"===obj.type&&isArray(obj.data))return fromArrayLike(that,obj.data)}var val;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(that,value)}function assertSize(size){if("number"!=typeof size)throw new TypeError('"size" argument must be a number');if(size<0)throw new RangeError('"size" argument must not be negative')}function allocUnsafe(that,size){if(assertSize(size),that=createBuffer(that,size<0?0:0|checked(size)),!Buffer.TYPED_ARRAY_SUPPORT)for(var i=0;i<size;++i)that[i]=0;return that}function fromArrayLike(that,array){var length=array.length<0?0:0|checked(array.length);that=createBuffer(that,length);for(var i=0;i<length;i+=1)that[i]=255&array[i];return that}function checked(length){if(length>=kMaxLength())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+kMaxLength().toString(16)+" bytes");return 0|length}function internalIsBuffer(b){return!(null==b||!b._isBuffer)}function byteLength(string,encoding){if(internalIsBuffer(string))return string.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(string)||string instanceof ArrayBuffer))return string.byteLength;"string"!=typeof string&&(string=""+string);var len=string.length;if(0===len)return 0;for(var loweredCase=!1;;)switch(encoding){case"ascii":case"latin1":case"binary":return len;case"utf8":case"utf-8":case void 0:return utf8ToBytes(string).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*len;case"hex":return len>>>1;case"base64":return base64ToBytes(string).length;default:if(loweredCase)return utf8ToBytes(string).length;encoding=(""+encoding).toLowerCase(),loweredCase=!0}}function slowToString(encoding,start,end){var loweredCase=!1;if((void 0===start||start<0)&&(start=0),start>this.length)return"";if((void 0===end||end>this.length)&&(end=this.length),end<=0)return"";if((end>>>=0)<=(start>>>=0))return"";for(encoding||(encoding="utf8");;)switch(encoding){case"hex":return hexSlice(this,start,end);case"utf8":case"utf-8":return utf8Slice(this,start,end);case"ascii":return asciiSlice(this,start,end);case"latin1":case"binary":return latin1Slice(this,start,end);case"base64":return base64Slice(this,start,end);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,start,end);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(encoding+"").toLowerCase(),loweredCase=!0}}function swap(b,n,m){var i=b[n];b[n]=b[m],b[m]=i}function bidirectionalIndexOf(buffer,val,byteOffset,encoding,dir){if(0===buffer.length)return-1;if("string"==typeof byteOffset?(encoding=byteOffset,byteOffset=0):byteOffset>2147483647?byteOffset=2147483647:byteOffset<-2147483648&&(byteOffset=-2147483648),byteOffset=+byteOffset,isNaN(byteOffset)&&(byteOffset=dir?0:buffer.length-1),byteOffset<0&&(byteOffset=buffer.length+byteOffset),byteOffset>=buffer.length){if(dir)return-1;byteOffset=buffer.length-1}else if(byteOffset<0){if(!dir)return-1;byteOffset=0}if("string"==typeof val&&(val=Buffer.from(val,encoding)),internalIsBuffer(val))return 0===val.length?-1:arrayIndexOf(buffer,val,byteOffset,encoding,dir);if("number"==typeof val)return val&=255,Buffer.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?dir?Uint8Array.prototype.indexOf.call(buffer,val,byteOffset):Uint8Array.prototype.lastIndexOf.call(buffer,val,byteOffset):arrayIndexOf(buffer,[val],byteOffset,encoding,dir);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(arr,val,byteOffset,encoding,dir){var i,indexSize=1,arrLength=arr.length,valLength=val.length;if(void 0!==encoding&&("ucs2"===(encoding=String(encoding).toLowerCase())||"ucs-2"===encoding||"utf16le"===encoding||"utf-16le"===encoding)){if(arr.length<2||val.length<2)return-1;indexSize=2,arrLength/=2,valLength/=2,byteOffset/=2}function read(buf,i){return 1===indexSize?buf[i]:buf.readUInt16BE(i*indexSize)}if(dir){var foundIndex=-1;for(i=byteOffset;i<arrLength;i++)if(read(arr,i)===read(val,-1===foundIndex?0:i-foundIndex)){if(-1===foundIndex&&(foundIndex=i),i-foundIndex+1===valLength)return foundIndex*indexSize}else-1!==foundIndex&&(i-=i-foundIndex),foundIndex=-1}else for(byteOffset+valLength>arrLength&&(byteOffset=arrLength-valLength),i=byteOffset;i>=0;i--){for(var found=!0,j=0;j<valLength;j++)if(read(arr,i+j)!==read(val,j)){found=!1;break}if(found)return i}return-1}function hexWrite(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;length?(length=Number(length))>remaining&&(length=remaining):length=remaining;var strLen=string.length;if(strLen%2!=0)throw new TypeError("Invalid hex string");length>strLen/2&&(length=strLen/2);for(var i=0;i<length;++i){var parsed=parseInt(string.substr(2*i,2),16);if(isNaN(parsed))return i;buf[offset+i]=parsed}return i}function utf8Write(buf,string,offset,length){return blitBuffer(utf8ToBytes(string,buf.length-offset),buf,offset,length)}function asciiWrite(buf,string,offset,length){return blitBuffer(function(str){for(var byteArray=[],i=0;i<str.length;++i)byteArray.push(255&str.charCodeAt(i));return byteArray}(string),buf,offset,length)}function latin1Write(buf,string,offset,length){return asciiWrite(buf,string,offset,length)}function base64Write(buf,string,offset,length){return blitBuffer(base64ToBytes(string),buf,offset,length)}function ucs2Write(buf,string,offset,length){return blitBuffer(function(str,units){for(var c,hi,lo,byteArray=[],i=0;i<str.length&&!((units-=2)<0);++i)hi=(c=str.charCodeAt(i))>>8,lo=c%256,byteArray.push(lo),byteArray.push(hi);return byteArray}(string,buf.length-offset),buf,offset,length)}function base64Slice(buf,start,end){return 0===start&&end===buf.length?fromByteArray(buf):fromByteArray(buf.slice(start,end))}function utf8Slice(buf,start,end){end=Math.min(buf.length,end);for(var res=[],i=start;i<end;){var secondByte,thirdByte,fourthByte,tempCodePoint,firstByte=buf[i],codePoint=null,bytesPerSequence=firstByte>239?4:firstByte>223?3:firstByte>191?2:1;if(i+bytesPerSequence<=end)switch(bytesPerSequence){case 1:firstByte<128&&(codePoint=firstByte);break;case 2:128==(192&(secondByte=buf[i+1]))&&(tempCodePoint=(31&firstByte)<<6|63&secondByte)>127&&(codePoint=tempCodePoint);break;case 3:secondByte=buf[i+1],thirdByte=buf[i+2],128==(192&secondByte)&&128==(192&thirdByte)&&(tempCodePoint=(15&firstByte)<<12|(63&secondByte)<<6|63&thirdByte)>2047&&(tempCodePoint<55296||tempCodePoint>57343)&&(codePoint=tempCodePoint);break;case 4:secondByte=buf[i+1],thirdByte=buf[i+2],fourthByte=buf[i+3],128==(192&secondByte)&&128==(192&thirdByte)&&128==(192&fourthByte)&&(tempCodePoint=(15&firstByte)<<18|(63&secondByte)<<12|(63&thirdByte)<<6|63&fourthByte)>65535&&tempCodePoint<1114112&&(codePoint=tempCodePoint)}null===codePoint?(codePoint=65533,bytesPerSequence=1):codePoint>65535&&(codePoint-=65536,res.push(codePoint>>>10&1023|55296),codePoint=56320|1023&codePoint),res.push(codePoint),i+=bytesPerSequence}return function(codePoints){var len=codePoints.length;if(len<=4096)return String.fromCharCode.apply(String,codePoints);var res="",i=0;for(;i<len;)res+=String.fromCharCode.apply(String,codePoints.slice(i,i+=4096));return res}(res)}Buffer.TYPED_ARRAY_SUPPORT=void 0===global$1.TYPED_ARRAY_SUPPORT||global$1.TYPED_ARRAY_SUPPORT,Buffer.poolSize=8192,Buffer._augment=function(arr){return arr.__proto__=Buffer.prototype,arr},Buffer.from=function(value,encodingOrOffset,length){return from(null,value,encodingOrOffset,length)},Buffer.TYPED_ARRAY_SUPPORT&&(Buffer.prototype.__proto__=Uint8Array.prototype,Buffer.__proto__=Uint8Array),Buffer.alloc=function(size,fill,encoding){return function(that,size,fill,encoding){return assertSize(size),size<=0?createBuffer(that,size):void 0!==fill?"string"==typeof encoding?createBuffer(that,size).fill(fill,encoding):createBuffer(that,size).fill(fill):createBuffer(that,size)}(null,size,fill,encoding)},Buffer.allocUnsafe=function(size){return allocUnsafe(null,size)},Buffer.allocUnsafeSlow=function(size){return allocUnsafe(null,size)},Buffer.isBuffer=function(obj){return null!=obj&&(!!obj._isBuffer||isFastBuffer(obj)||function(obj){return"function"==typeof obj.readFloatLE&&"function"==typeof obj.slice&&isFastBuffer(obj.slice(0,0))}(obj))},Buffer.compare=function(a,b){if(!internalIsBuffer(a)||!internalIsBuffer(b))throw new TypeError("Arguments must be Buffers");if(a===b)return 0;for(var x=a.length,y=b.length,i=0,len=Math.min(x,y);i<len;++i)if(a[i]!==b[i]){x=a[i],y=b[i];break}return x<y?-1:y<x?1:0},Buffer.isEncoding=function(encoding){switch(String(encoding).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(list,length){if(!isArray(list))throw new TypeError('"list" argument must be an Array of Buffers');if(0===list.length)return Buffer.alloc(0);var i;if(void 0===length)for(length=0,i=0;i<list.length;++i)length+=list[i].length;var buffer=Buffer.allocUnsafe(length),pos=0;for(i=0;i<list.length;++i){var buf=list[i];if(!internalIsBuffer(buf))throw new TypeError('"list" argument must be an Array of Buffers');buf.copy(buffer,pos),pos+=buf.length}return buffer},Buffer.byteLength=byteLength,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function(){var len=this.length;if(len%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var i=0;i<len;i+=2)swap(this,i,i+1);return this},Buffer.prototype.swap32=function(){var len=this.length;if(len%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var i=0;i<len;i+=4)swap(this,i,i+3),swap(this,i+1,i+2);return this},Buffer.prototype.swap64=function(){var len=this.length;if(len%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var i=0;i<len;i+=8)swap(this,i,i+7),swap(this,i+1,i+6),swap(this,i+2,i+5),swap(this,i+3,i+4);return this},Buffer.prototype.toString=function(){var length=0|this.length;return 0===length?"":0===arguments.length?utf8Slice(this,0,length):slowToString.apply(this,arguments)},Buffer.prototype.equals=function(b){if(!internalIsBuffer(b))throw new TypeError("Argument must be a Buffer");return this===b||0===Buffer.compare(this,b)},Buffer.prototype.inspect=function(){var str="";return this.length>0&&(str=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(str+=" ... ")),"<Buffer "+str+">"},Buffer.prototype.compare=function(target,start,end,thisStart,thisEnd){if(!internalIsBuffer(target))throw new TypeError("Argument must be a Buffer");if(void 0===start&&(start=0),void 0===end&&(end=target?target.length:0),void 0===thisStart&&(thisStart=0),void 0===thisEnd&&(thisEnd=this.length),start<0||end>target.length||thisStart<0||thisEnd>this.length)throw new RangeError("out of range index");if(thisStart>=thisEnd&&start>=end)return 0;if(thisStart>=thisEnd)return-1;if(start>=end)return 1;if(this===target)return 0;for(var x=(thisEnd>>>=0)-(thisStart>>>=0),y=(end>>>=0)-(start>>>=0),len=Math.min(x,y),thisCopy=this.slice(thisStart,thisEnd),targetCopy=target.slice(start,end),i=0;i<len;++i)if(thisCopy[i]!==targetCopy[i]){x=thisCopy[i],y=targetCopy[i];break}return x<y?-1:y<x?1:0},Buffer.prototype.includes=function(val,byteOffset,encoding){return-1!==this.indexOf(val,byteOffset,encoding)},Buffer.prototype.indexOf=function(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,!0)},Buffer.prototype.lastIndexOf=function(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,!1)},Buffer.prototype.write=function(string,offset,length,encoding){if(void 0===offset)encoding="utf8",length=this.length,offset=0;else if(void 0===length&&"string"==typeof offset)encoding=offset,length=this.length,offset=0;else{if(!isFinite(offset))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");offset|=0,isFinite(length)?(length|=0,void 0===encoding&&(encoding="utf8")):(encoding=length,length=void 0)}var remaining=this.length-offset;if((void 0===length||length>remaining)&&(length=remaining),string.length>0&&(length<0||offset<0)||offset>this.length)throw new RangeError("Attempt to write outside buffer bounds");encoding||(encoding="utf8");for(var loweredCase=!1;;)switch(encoding){case"hex":return hexWrite(this,string,offset,length);case"utf8":case"utf-8":return utf8Write(this,string,offset,length);case"ascii":return asciiWrite(this,string,offset,length);case"latin1":case"binary":return latin1Write(this,string,offset,length);case"base64":return base64Write(this,string,offset,length);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,string,offset,length);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(""+encoding).toLowerCase(),loweredCase=!0}},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function asciiSlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i)ret+=String.fromCharCode(127&buf[i]);return ret}function latin1Slice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i)ret+=String.fromCharCode(buf[i]);return ret}function hexSlice(buf,start,end){var len=buf.length;(!start||start<0)&&(start=0),(!end||end<0||end>len)&&(end=len);for(var out="",i=start;i<end;++i)out+=toHex(buf[i]);return out}function utf16leSlice(buf,start,end){for(var bytes=buf.slice(start,end),res="",i=0;i<bytes.length;i+=2)res+=String.fromCharCode(bytes[i]+256*bytes[i+1]);return res}function checkOffset(offset,ext,length){if(offset%1!=0||offset<0)throw new RangeError("offset is not uint");if(offset+ext>length)throw new RangeError("Trying to access beyond buffer length")}function checkInt(buf,value,offset,ext,max,min){if(!internalIsBuffer(buf))throw new TypeError('"buffer" argument must be a Buffer instance');if(value>max||value<min)throw new RangeError('"value" argument is out of bounds');if(offset+ext>buf.length)throw new RangeError("Index out of range")}function objectWriteUInt16(buf,value,offset,littleEndian){value<0&&(value=65535+value+1);for(var i=0,j=Math.min(buf.length-offset,2);i<j;++i)buf[offset+i]=(value&255<<8*(littleEndian?i:1-i))>>>8*(littleEndian?i:1-i)}function objectWriteUInt32(buf,value,offset,littleEndian){value<0&&(value=4294967295+value+1);for(var i=0,j=Math.min(buf.length-offset,4);i<j;++i)buf[offset+i]=value>>>8*(littleEndian?i:3-i)&255}function checkIEEE754(buf,value,offset,ext,max,min){if(offset+ext>buf.length)throw new RangeError("Index out of range");if(offset<0)throw new RangeError("Index out of range")}function writeFloat(buf,value,offset,littleEndian,noAssert){return noAssert||checkIEEE754(buf,0,offset,4),write(buf,value,offset,littleEndian,23,4),offset+4}function writeDouble(buf,value,offset,littleEndian,noAssert){return noAssert||checkIEEE754(buf,0,offset,8),write(buf,value,offset,littleEndian,52,8),offset+8}Buffer.prototype.slice=function(start,end){var newBuf,len=this.length;if((start=~~start)<0?(start+=len)<0&&(start=0):start>len&&(start=len),(end=void 0===end?len:~~end)<0?(end+=len)<0&&(end=0):end>len&&(end=len),end<start&&(end=start),Buffer.TYPED_ARRAY_SUPPORT)(newBuf=this.subarray(start,end)).__proto__=Buffer.prototype;else{var sliceLen=end-start;newBuf=new Buffer(sliceLen,void 0);for(var i=0;i<sliceLen;++i)newBuf[i]=this[i+start]}return newBuf},Buffer.prototype.readUIntLE=function(offset,byteLength,noAssert){offset|=0,byteLength|=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return val},Buffer.prototype.readUIntBE=function(offset,byteLength,noAssert){offset|=0,byteLength|=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset+--byteLength],mul=1;byteLength>0&&(mul*=256);)val+=this[offset+--byteLength]*mul;return val},Buffer.prototype.readUInt8=function(offset,noAssert){return noAssert||checkOffset(offset,1,this.length),this[offset]},Buffer.prototype.readUInt16LE=function(offset,noAssert){return noAssert||checkOffset(offset,2,this.length),this[offset]|this[offset+1]<<8},Buffer.prototype.readUInt16BE=function(offset,noAssert){return noAssert||checkOffset(offset,2,this.length),this[offset]<<8|this[offset+1]},Buffer.prototype.readUInt32LE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),(this[offset]|this[offset+1]<<8|this[offset+2]<<16)+16777216*this[offset+3]},Buffer.prototype.readUInt32BE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),16777216*this[offset]+(this[offset+1]<<16|this[offset+2]<<8|this[offset+3])},Buffer.prototype.readIntLE=function(offset,byteLength,noAssert){offset|=0,byteLength|=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return val>=(mul*=128)&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readIntBE=function(offset,byteLength,noAssert){offset|=0,byteLength|=0,noAssert||checkOffset(offset,byteLength,this.length);for(var i=byteLength,mul=1,val=this[offset+--i];i>0&&(mul*=256);)val+=this[offset+--i]*mul;return val>=(mul*=128)&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readInt8=function(offset,noAssert){return noAssert||checkOffset(offset,1,this.length),128&this[offset]?-1*(255-this[offset]+1):this[offset]},Buffer.prototype.readInt16LE=function(offset,noAssert){noAssert||checkOffset(offset,2,this.length);var val=this[offset]|this[offset+1]<<8;return 32768&val?4294901760|val:val},Buffer.prototype.readInt16BE=function(offset,noAssert){noAssert||checkOffset(offset,2,this.length);var val=this[offset+1]|this[offset]<<8;return 32768&val?4294901760|val:val},Buffer.prototype.readInt32LE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),this[offset]|this[offset+1]<<8|this[offset+2]<<16|this[offset+3]<<24},Buffer.prototype.readInt32BE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),this[offset]<<24|this[offset+1]<<16|this[offset+2]<<8|this[offset+3]},Buffer.prototype.readFloatLE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),read(this,offset,!0,23,4)},Buffer.prototype.readFloatBE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),read(this,offset,!1,23,4)},Buffer.prototype.readDoubleLE=function(offset,noAssert){return noAssert||checkOffset(offset,8,this.length),read(this,offset,!0,52,8)},Buffer.prototype.readDoubleBE=function(offset,noAssert){return noAssert||checkOffset(offset,8,this.length),read(this,offset,!1,52,8)},Buffer.prototype.writeUIntLE=function(value,offset,byteLength,noAssert){(value=+value,offset|=0,byteLength|=0,noAssert)||checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength)-1,0);var mul=1,i=0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUIntBE=function(value,offset,byteLength,noAssert){(value=+value,offset|=0,byteLength|=0,noAssert)||checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength)-1,0);var i=byteLength-1,mul=1;for(this[offset+i]=255&value;--i>=0&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUInt8=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,1,255,0),Buffer.TYPED_ARRAY_SUPPORT||(value=Math.floor(value)),this[offset]=255&value,offset+1},Buffer.prototype.writeUInt16LE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=255&value,this[offset+1]=value>>>8):objectWriteUInt16(this,value,offset,!0),offset+2},Buffer.prototype.writeUInt16BE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>8,this[offset+1]=255&value):objectWriteUInt16(this,value,offset,!1),offset+2},Buffer.prototype.writeUInt32LE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset+3]=value>>>24,this[offset+2]=value>>>16,this[offset+1]=value>>>8,this[offset]=255&value):objectWriteUInt32(this,value,offset,!0),offset+4},Buffer.prototype.writeUInt32BE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=255&value):objectWriteUInt32(this,value,offset,!1),offset+4},Buffer.prototype.writeIntLE=function(value,offset,byteLength,noAssert){if(value=+value,offset|=0,!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=0,mul=1,sub=0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)value<0&&0===sub&&0!==this[offset+i-1]&&(sub=1),this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeIntBE=function(value,offset,byteLength,noAssert){if(value=+value,offset|=0,!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=byteLength-1,mul=1,sub=0;for(this[offset+i]=255&value;--i>=0&&(mul*=256);)value<0&&0===sub&&0!==this[offset+i+1]&&(sub=1),this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeInt8=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,1,127,-128),Buffer.TYPED_ARRAY_SUPPORT||(value=Math.floor(value)),value<0&&(value=255+value+1),this[offset]=255&value,offset+1},Buffer.prototype.writeInt16LE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=255&value,this[offset+1]=value>>>8):objectWriteUInt16(this,value,offset,!0),offset+2},Buffer.prototype.writeInt16BE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>8,this[offset+1]=255&value):objectWriteUInt16(this,value,offset,!1),offset+2},Buffer.prototype.writeInt32LE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=255&value,this[offset+1]=value>>>8,this[offset+2]=value>>>16,this[offset+3]=value>>>24):objectWriteUInt32(this,value,offset,!0),offset+4},Buffer.prototype.writeInt32BE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),value<0&&(value=4294967295+value+1),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=255&value):objectWriteUInt32(this,value,offset,!1),offset+4},Buffer.prototype.writeFloatLE=function(value,offset,noAssert){return writeFloat(this,value,offset,!0,noAssert)},Buffer.prototype.writeFloatBE=function(value,offset,noAssert){return writeFloat(this,value,offset,!1,noAssert)},Buffer.prototype.writeDoubleLE=function(value,offset,noAssert){return writeDouble(this,value,offset,!0,noAssert)},Buffer.prototype.writeDoubleBE=function(value,offset,noAssert){return writeDouble(this,value,offset,!1,noAssert)},Buffer.prototype.copy=function(target,targetStart,start,end){if(start||(start=0),end||0===end||(end=this.length),targetStart>=target.length&&(targetStart=target.length),targetStart||(targetStart=0),end>0&&end<start&&(end=start),end===start)return 0;if(0===target.length||0===this.length)return 0;if(targetStart<0)throw new RangeError("targetStart out of bounds");if(start<0||start>=this.length)throw new RangeError("sourceStart out of bounds");if(end<0)throw new RangeError("sourceEnd out of bounds");end>this.length&&(end=this.length),target.length-targetStart<end-start&&(end=target.length-targetStart+start);var i,len=end-start;if(this===target&&start<targetStart&&targetStart<end)for(i=len-1;i>=0;--i)target[i+targetStart]=this[i+start];else if(len<1e3||!Buffer.TYPED_ARRAY_SUPPORT)for(i=0;i<len;++i)target[i+targetStart]=this[i+start];else Uint8Array.prototype.set.call(target,this.subarray(start,start+len),targetStart);return len},Buffer.prototype.fill=function(val,start,end,encoding){if("string"==typeof val){if("string"==typeof start?(encoding=start,start=0,end=this.length):"string"==typeof end&&(encoding=end,end=this.length),1===val.length){var code=val.charCodeAt(0);code<256&&(val=code)}if(void 0!==encoding&&"string"!=typeof encoding)throw new TypeError("encoding must be a string");if("string"==typeof encoding&&!Buffer.isEncoding(encoding))throw new TypeError("Unknown encoding: "+encoding)}else"number"==typeof val&&(val&=255);if(start<0||this.length<start||this.length<end)throw new RangeError("Out of range index");if(end<=start)return this;var i;if(start>>>=0,end=void 0===end?this.length:end>>>0,val||(val=0),"number"==typeof val)for(i=start;i<end;++i)this[i]=val;else{var bytes=internalIsBuffer(val)?val:utf8ToBytes(new Buffer(val,encoding).toString()),len=bytes.length;for(i=0;i<end-start;++i)this[i+start]=bytes[i%len]}return this};var INVALID_BASE64_RE=/[^+\/0-9A-Za-z-_]/g;function toHex(n){return n<16?"0"+n.toString(16):n.toString(16)}function utf8ToBytes(string,units){var codePoint;units=units||1/0;for(var length=string.length,leadSurrogate=null,bytes=[],i=0;i<length;++i){if((codePoint=string.charCodeAt(i))>55295&&codePoint<57344){if(!leadSurrogate){if(codePoint>56319){(units-=3)>-1&&bytes.push(239,191,189);continue}if(i+1===length){(units-=3)>-1&&bytes.push(239,191,189);continue}leadSurrogate=codePoint;continue}if(codePoint<56320){(units-=3)>-1&&bytes.push(239,191,189),leadSurrogate=codePoint;continue}codePoint=65536+(leadSurrogate-55296<<10|codePoint-56320)}else leadSurrogate&&(units-=3)>-1&&bytes.push(239,191,189);if(leadSurrogate=null,codePoint<128){if((units-=1)<0)break;bytes.push(codePoint)}else if(codePoint<2048){if((units-=2)<0)break;bytes.push(codePoint>>6|192,63&codePoint|128)}else if(codePoint<65536){if((units-=3)<0)break;bytes.push(codePoint>>12|224,codePoint>>6&63|128,63&codePoint|128)}else{if(!(codePoint<1114112))throw new Error("Invalid code point");if((units-=4)<0)break;bytes.push(codePoint>>18|240,codePoint>>12&63|128,codePoint>>6&63|128,63&codePoint|128)}}return bytes}function base64ToBytes(str){return function(b64){var i,j,l,tmp,placeHolders,arr;inited||init();var len=b64.length;if(len%4>0)throw new Error("Invalid string. Length must be a multiple of 4");placeHolders="="===b64[len-2]?2:"="===b64[len-1]?1:0,arr=new Arr(3*len/4-placeHolders),l=placeHolders>0?len-4:len;var L=0;for(i=0,j=0;i<l;i+=4,j+=3)tmp=revLookup[b64.charCodeAt(i)]<<18|revLookup[b64.charCodeAt(i+1)]<<12|revLookup[b64.charCodeAt(i+2)]<<6|revLookup[b64.charCodeAt(i+3)],arr[L++]=tmp>>16&255,arr[L++]=tmp>>8&255,arr[L++]=255&tmp;return 2===placeHolders?(tmp=revLookup[b64.charCodeAt(i)]<<2|revLookup[b64.charCodeAt(i+1)]>>4,arr[L++]=255&tmp):1===placeHolders&&(tmp=revLookup[b64.charCodeAt(i)]<<10|revLookup[b64.charCodeAt(i+1)]<<4|revLookup[b64.charCodeAt(i+2)]>>2,arr[L++]=tmp>>8&255,arr[L++]=255&tmp),arr}(function(str){if((str=function(str){return str.trim?str.trim():str.replace(/^\s+|\s+$/g,"")}(str).replace(INVALID_BASE64_RE,"")).length<2)return"";for(;str.length%4!=0;)str+="=";return str}(str))}function blitBuffer(src,dst,offset,length){for(var i=0;i<length&&!(i+offset>=dst.length||i>=src.length);++i)dst[i+offset]=src[i];return i}function isFastBuffer(obj){return!!obj.constructor&&"function"==typeof obj.constructor.isBuffer&&obj.constructor.isBuffer(obj)}const messages={en:{0:"VInl\\Y7|\\UDQd5SiTo;3doSwEnnxfUDw\\YXmKIGifoHucYSidInl\\Y7|\\UDt\\ZmifI:iepXwKGHlfIn4\\XLneI;{fJPMWyrW\\Y3yd5Ljepmic4X7e{DjeoWi[Z\\jcYzj[oznKI\\xekDnfoHufYH2cY;wNirL\\kD7d5WieJX{[4jje4XmKIGidInl\\Y7|\\UyifIjnKIvngUDre{DrdkD7d5X{KJD3eoPq[ZPnKIPxdo\\reo3jfInxdkDndYHrdE6MTY3jcYyifZOwe4Hu\\ZPCdYX|[4n3e{7ld42i\\o;{KIH|e4n|fIHw[4Ww",1:{t:"VH:4[YKm[DCjfTCCZ4SqenWT[YCwdoS{TmNhSY[icIWieHmwcjCX[YK{bX:v",l:"Un:1JFyqZ3Wvd3WlJH[wdjCFbYO1dnmjeYSqc35>",ld:"XX:2djC1[X2xc4Kidolh[HWxcH:6cXWveDCs[Ylh[YixbYKmdzCqcjC8cI1h[HG6LINqMh>>"},3:"YY;3ekDnfoHufYH2cY;wKIzr[4Xwe4WicZOi\\ZjycZLn\\E6MXI:ieJX{[4jje4Wi[UDucYPndpPnNEDydIXje4Wifon|cZSif5f5No3ne4PrfZOw[4;vNirWd{DngJTndoSigY;3ekD2eonjdEDy\\ZLrd4SuKJDu\\YH|\\UDld472[YP2KJX|NpPjdIX|SI3ne4PrfZOw[4;vNi??",4:"UY74[Yzr\\EDucYPndpPnKIvngU6MTI;3[oznKIPq\\YPtKJTq\\UDucYPndpPnKIvngUDrdkD7d5X{KJD{d4rn[5Si[Y7mKIHm\\EDjKJ\\jdInmKIzr[4Xwe4WwEmnoKJnxfUDw\\YXmKIH|e4n|fIHw[4WuKJDu\\YH|\\UDld472[YP2KJX|NpPjdIX|SI3ne4PrfZOw[4;vNi??"},zh:{0:"7r{s7qo-7[ky8M867[-x8M-D66EEEwcEsQoeiQkoigcekgcXkQgcjQkwwQYRt-kxigc1iQc2w-giigcLlgkFxgk1mQkjlEDD[5TrfoXU\\ZDxepT|UnOM7Nk27rg47t-C7tU978ED7[-s77Uq7NsQ7Nsp7\\QD8M-G7N{y66EEEkFnrqNopr|oislnv9NqvM5mwdFmwqdqttlnl81qt6JxxK|nl81npMloislpoqVqvM5mwdFpqc9qtsVris9mw9dmwM5op8ZppKxqttlnl81qt6Jmx8Joic1liKKMKQYoiwoeiQY6twYMsg-:lQYRt-YRmgoCigoEtwU9vwkJu--:opPjdIX|NpjjSIf{[ZDn[4n2gU7ld42?",1:{t:"66TyS4KidHWEbYS6JFGkeHm3[WKmdH:zeIOLVzEps6YomLkojZknk6ElwqwnmL0nkJF>",l:"6qzr7J746c7Y6ZjH6Z,S7L756Z,w7L,C",ld:"7L,W66Tp6p7J6q3E66rF6qzK6qXJ6qzg7M,Z6ZnqJIutgfXlrR>>"},3:"7qMq77sG7tYN8M-X8M867[-x8M-D7dg{8N-J7r{h66EEEwkDnQg|w-k2tgU7uE|qt9hqtt1rn86if5f5Nof{[ZDn[4n2gU7ld42wEkFnw9drnd1qt7ZpnMlopL1xxK|qt9hqi\\Vpu9xxxLr|[Yzne{76[WDpeoHy\\YPrfJmw[4;vNi??",4:"7rgi7rYK77sG8M867[-x8M-D7N-j7qIx66EEEwU9nQg9jwcliQchrgojwggdtwU6tggcjQkwwQYRt-kxigU1qgcDt--:lQY7vwU1pgkxigc5w-YMqQgcjQc[t-cekgcXkQkwwQYRt-kxigQCiiqi7ccE8\\{C7dkw7[sr99{O7[-x7[-T8[ED8[Mw7Nw48Kg|99{ce4Hu\\ZOwgIHC\\5LjeIXlcZT7NoPxdS??"},ja:{0:"66Qr66Mm66M966Q|66M77qQH7cEz66IO8McN66Im66IN66MM66I-66Id66MV66Ip66IZ66Ih66EEEwklxgYVigQDtwQDnQYKsggWsQQDs-QDt-QCigQFsgQErQQEw-QFu-QEwgQEtgQFxQQDxwQDp-QDt-QFkQQFsgQErQQEqwQFs-QEtgQFxQQDlQY1jgkoigQDr-QDogQCii??",1:{t:"55Pi55L455Ln55L66rDr6czQ6Mzb67T,JFGkeHm3[WKmdH:zeIOLVzEkh5kkh7okhrUkhrMkh7wojZh>",l:"6qzt55PR55P955L555Po55P{55Hv7ZXO6cjE55Hw67bC6r3j55HW55LN55Hn55HF55H,55H[55DD",ld:"55PJ55Pq55Ll55Lj55Ps55Lu55P955Hv6qzK6Zr66qzg7[bU55Hw55DC6r7M55LLJIutgTEnm7Ykhbgkh[okhJJ>"},3:"66QK66Qr66Mm66Mk66Qt66Mv66Q:66Iw7r{L7[s77r{h8\\cV66IO79YE7NsI66IZ66I-66IZ66Ih66EE",4:"7s4l66IZ66IG66Qr66Mm66M966Q|66M77qQH7cEz66MU7[-Y7d8Z66Ip66IP66I-66Id66MV66Ip66IZ66Ih66EE"},ko:{0:"874:9L429KUi9Ksm88Y:KQ{yxw{fjEFukLii9LgI9Ks386wK86wmNirD[5TrfoXU\\ZDxepT|UnRtrdyi9Kwm9\\cL9\\Y[88Em88o2KQ{eqQ4csQ4XpEFtpd|updVujMFuksVsuKCi9[Mm8tECKQ4XjQ{cnEFvncptk6ltk8SwEws2iQwisEFttNlup\\ltkrSie4Hu\\ZOvc4;{SI3ne4PrfZOw[4;vKQw[mQwMnECzPleyNVC3QFRupN|tq\\yi9MQ:9Kwe8tkyKQwynQwglgwNkQwNrE6?",1:{t:"RXO1bY[mVnWxc4K1d1qUJP3QjfrxhP3NlB>>",l:"78Dx8Z,t77X9JPzdiP3WoDEsoc{tocUtiLEtjrUrtJBh8KfH8Jr275vJ75vl",ld:"8K31JP3QjfrxhP3NlDEsoc{tocUtiLEtjrUsjqRh8KXf8Kz977HdJIutgTEtocxh8K318[vFJPvokPvkkDEslLosj5ksj7Rv"},3:"9[-L8tEC9[{SKQwfxQ{fvQ{GqQ{MrQsyiEFtr6|tq6|tmLlun6luktZtk6ltk8SwEwwuwQ{foQwEoEFsvc|tr8VsvKFtqMii9LYK86M286sWKJPjdIX|NYvxemDv\\ZPlcZX|NoPxdUFtoLFtkrSiOV[5OE2yPVi|9L{:88IeKQwuwQ{foQ{lxQ{NpQs6uEFtuLVtpq5tk6ltk8Sw",4:"9L8[88s987EeKQwfxQ{fvQ{GqQ{MrQ4ErEFupqZtk6ltk8SwEwwfxQ{fvQ{GqQ{MrQ4ErQwnxEFtk8Vuk7yi9\\oX9L469\\Y[9Kwe8tQiKQ{eqQ4csQ4XpEFtpd|updVujMFuksVtrdyi9NcW8tEC9\\Y[9Kwe8tkyKQwynQwglgwNkQwNrE6M8tUC88EqKQwuwQ{foQwMnED|[Yzne{3td5LCdYX|[4n3e{7ld42i87kS86sWKFG4P|CvOFW6O-{exQwjpEFuq9|uk7|swNCi89EW878P86wK86wmNi??"}},getMessages=(language="")=>{var _a;return null!==(_a=messages[language.trim().substring(0,2)])&&void 0!==_a?_a:messages.en},getNagMessage=(language,type)=>Buffer.from(Array.from(getMessages(language)[type]).map((c=>c.charCodeAt(0)-2)).map((c=>String.fromCharCode(c))).join(""),"base"+Math.sqrt(4096)).toString();function addEvalBanner(page,leftDays,language){const style={color:"gray",position:"absolute",left:"30pt",bottom:"30pt",fontWeight:"bold",fontFamily:"Arial",whiteSpace:"nowrap",display:"block",zIndex:Math.floor(1e3*Math.random()).toString()},evalBanner=h("div",{style:style,className:"arjs-textBoxItem"},[]),text=((language,leftDays)=>[getMessages(language)[1].t,void 0===leftDays?getMessages(language)[1].l:getMessages(language)[1].ld].map(((text,i)=>Buffer.from(Array.from(text).map((c=>c.charCodeAt(0)-1)).map((c=>String.fromCharCode(c))).join(""),"base"+Math.sqrt(4096)).toString().replace("{l}",1===i&&void 0!==leftDays?`${leftDays}`:"{l}"))))(language,leftDays),pieces=text.map(spanify).reduce(((result,rowPieces,idx)=>(result.push(...rowPieces),idx<text.length-1&&result.push(h("br",[])),result)),[]);evalBanner.children.push(...pieces);const rPages=isReportPage(page)?[page]:findElements(page,isReportPage);0===rPages.length&&rPages.push(page);for(const rPage of rPages){const rndIdx=Math.floor(Math.random()*rPage.children.length);rPage.children.splice(rndIdx,0,evalBanner)}}const isReportPage=node=>{var _a;return(null!==(_a=node.properties.className)&&void 0!==_a?_a:"").includes("arjs-reportPage")};function findElements(rootElement,predicate){const result=[];for(let i=0;i<rootElement.children.length;i++)if("VirtualNode"===rootElement.children[i].type){const element=rootElement.children[i];predicate(element)?result.push(element):result.push(...findElements(element,predicate))}return result}function spanify(text){const pieces=[];for(;text.length>6;){const rndLength=Math.floor(2+3*Math.random())+1;pieces.push(text.substr(0,rndLength)),text=text.substr(rndLength)}return pieces.push(text),pieces.map((p=>h("span",p)))}class VDomRenderer{constructor(layoutFn,documentMapFn,styles,galleyMode,layoutOrder,i18n){this.documentMapFn=documentMapFn,this.styles=styles,this.galleyMode=galleyMode,this.i18n=i18n,this.pages=[],this.patches=[],this.tocLabels=[],this._e=()=>({Type:0}),this.pageGenerator=MakePaginate(this.galleyMode,layoutOrder)(layoutFn),this.language=this.i18n&&this.i18n.language||""}static create(pageDoc,renderOptions={galleyMode:!1,interactivityActions:[]},i18n){return __awaiter(this,void 0,void 0,(function*(){const interactivityState=renderOptions.interactivityActions.reduce(((state,action)=>applyInteractiveAction(action,state)),{Toggles:[],SortState:{}}),{layout:layout,documentMap:documentMap}=yield pageDoc.getLayout(interactivityState),renderer=new VDomRenderer(layout,documentMap,pageDoc.styles,renderOptions.galleyMode,pageDoc.layoutOrder,i18n),lic=yield resolveLicense();return renderer._e=()=>lic,renderer}))}static renderToDOM(content,patches,options={}){return function(content,patches,options={}){const opts={document:options.targetDocument||window.document},domElement=create(content,opts);return patches&&patches.length>0&&patches.forEach((pagePatch=>pagePatch.forEach((elementPatch=>{const element=elementPatch.id&&findElement(domElement,(el=>el.id===elementPatch.id));if(element){if(elementPatch.style&&function(element,style){if(element&&style)for(const key in style)element.style[key]=style[key]}(element,elementPatch.style),elementPatch.children){for(;element.lastChild;)element.removeChild(element.lastChild);elementPatch.children.forEach((c=>{element.appendChild(create(c,opts))}))}elementPatch.className&&(element.className=elementPatch.className)}})))),options.searchResults&&options.searchResults.length>0&&options.searchResults.forEach((result=>{const element=findElement(domElement,(el=>el.id===result.id));element&&(element.className+=" searchHighlight")})),options.hideInteractivity&&domElement.appendChild(create(h("style",".arjs-control { display: none !important; }"),opts)),domElement}(content,patches,options)}static getCssString(style){return function(styleData,format=!1){const colon=format?": ":":",semicolon=format?";\n":";",topRightBottomLeft=["top","right","bottom","left"],widthStyleColor=["width","style","color"];function merge(style,key,suffixes,sameOnly=!1){if(suffixes.every((s=>!!style[`${key}-${s}`]))){if(suffixes.every((s=>style[`${key}-${s}`]===style[`${key}-${suffixes[0]}`])))style[key]=style[`${key}-${suffixes[0]}`];else{if(sameOnly)return;style[key]=suffixes.map((s=>style[`${key}-${s}`])).join(" ")}suffixes.forEach((s=>style[`${key}-${s}`]=void 0))}}const newStyleData=Object.keys(styleData).reduce(((obj,key)=>(obj[key.replace(/[A-Z]/g,(m=>`-${m}`)).toLowerCase()]=styleData[key],obj)),{});return merge(newStyleData,"padding",topRightBottomLeft),merge(newStyleData,"margin",topRightBottomLeft),merge(newStyleData,"background-position",["x","y"]),function(style){merge(style,"border",widthStyleColor),merge(style,"border-top",widthStyleColor),merge(style,"border-right",widthStyleColor),merge(style,"border-bottom",widthStyleColor),merge(style,"border-left",widthStyleColor),merge(style,"border",topRightBottomLeft,!0),topRightBottomLeft.forEach((suffix=>function(style,key,suffix){style[key]&&style[key]===style[`${key}-${suffix}`]&&(style[`${key}-${suffix}`]=void 0)}(style,"border",suffix)))}(newStyleData),Object.keys(newStyleData).filter((key=>!!newStyleData[key])).reduce(((css,key)=>css+`${key}${colon}${newStyleData[key]}${semicolon}`),"")}(style)}*render(){for(const res of this.pageGenerator)switch(res.type){case"page":const lic=this._e();1===lic.Type&&addEvalBanner(res.content,lic.Left,this.language),this.pages.push(res.content),yield{pageCount:this.pages.length,isComplete:!1};break;case"patch":this.patches[res.pageIndex]=this.patches[res.pageIndex]||[],this.patches[res.pageIndex].push(res.content);break;case"toclabels":this.tocLabels[res.pageIndex]=this.tocLabels[res.pageIndex]||[],this.tocLabels[res.pageIndex].push(res.content)}yield{pageCount:this.pages.length,isComplete:!0}}getPage(pIndex){return this.pages[pIndex]||null}getDelayedContent(pageIndex){return this.patches[pageIndex]||null}getDocumentMap(){return this.documentMapFn()}resolveBookmark(label){return this.tocLabels.findIndex((p=>p&&p.some((l=>l&&l.indexOf(label)>-1))))}getContent(){return{pages:this.pages,patches:this.patches,styles:this.styles}}*findText(options){const patches=this.patches.map(((pp,pageIndex)=>({pageIndex:pageIndex,patches:flatten$2(pp)})));let searchItems=function(pages,patches,searchString,matchCase=!1,wholeWord=!1){if(!searchString||!pages||0===pages.length)return()=>emptyResult;const regexp=getRegexp(searchString,matchCase,wholeWord);let currentPageElements=[],currentPageIndex=0;const find=(pageIndex=0,elementIndex=-1,forward=!0)=>{let searchDone=!1;for(pageIndex===currentPageIndex&&0!==currentPageElements.length||(currentPageIndex=pageIndex,currentPageElements=collectPageElements(pages[currentPageIndex],getPagePatches(patches,currentPageIndex),regexp));needNextPage(currentPageElements.length,elementIndex,forward);){if(currentPageIndex+=forward?1:-1,forward&&currentPageIndex>=pages.length||!forward&&currentPageIndex<0){searchDone=!0;break}currentPageElements=collectPageElements(pages[currentPageIndex],getPagePatches(patches,currentPageIndex),regexp),elementIndex=forward?-1:currentPageElements.length}searchDone||(elementIndex+=forward?1:-1);const result=searchDone?null:currentPageElements[elementIndex];return{value:result&&{pageIndex:currentPageIndex,text:result.text,id:result.id,position:result.position,length:result.length,itemIndex:elementIndex},done:searchDone,next:()=>find(currentPageIndex,elementIndex,!0),previous:()=>find(currentPageIndex,elementIndex,!1)}};return find}(this.pages,patches,options.Text,options.MatchCase,options.WholeWord)(options.PageIndex,options.ItemIndex);for(;!searchItems.done;)searchItems.value&&(yield{text:searchItems.value.text,itemId:searchItems.value.id,pageIndex:searchItems.value.pageIndex,itemIndex:searchItems.value.itemIndex,position:searchItems.value.position,length:searchItems.value.length},searchItems=options.SearchBackward?searchItems.previous():searchItems.next())}print(onProgress,checkCancel){return print(this,onProgress,checkCancel)}getFontFaces(){return generateFontFacesCSS()}}let onRegisteredCallbacks=new Set;const getFunctions=CustomCodeInternal_getFunctions,registeredFunctions=new Map,CustomCode={registerFunctions:functions=>{const customCode={};functions.forEach((f=>{customCode[f.name]=f.body,registeredFunctions.set(f.name,f)})),CustomCodeInternal_registerFunctions(customCode),onRegisteredCallbacks.forEach((callback=>callback()))},getFunctions:()=>[...registeredFunctions.values()]},treeBuilder$1=createTreeBuilder(),isCodeExpression=exp=>"string"==typeof exp&&exp.startsWith("=")&&treeBuilder$1(exp).Contains("code","constant");function hasCustomCodeInDatasets(datasets){return datasets.some((dataset=>dataset.Fields.some((field=>isCodeExpression(field.Value)))||dataset.Filters.some((filter=>isCodeExpression(filter.FilterExpression)))))}class PageDocument{constructor(report,ctx,pageInfo,layoutOrder,data,i18n){this.report=report,this.i18n=i18n,this.sortState={},this.ctx=ctx,this.pageInfo=pageInfo,this.layoutOrder=layoutOrder,this.data=data,this.resultTree=data.dataTree,this.dataLayoutFn=this.report.Layout(this.resultTree)}get styles(){return this.report.Styles}getLayout(interactivityState){return __awaiter(this,void 0,void 0,(function*(){equals(interactivityState.SortState,this.sortState)||(this.sortState=interactivityState.SortState,this.resultTree=yield this.data.applySort(this.sortState),this.dataLayoutFn=this.report.Layout(this.resultTree));const resultTree=this.resultTree;return{layout:this.dataLayoutFn(interactivityState),documentMap:()=>this.report.DocumentMap(resultTree,{})(interactivityState)}}))}runRenderer(renderOptions){return VDomRenderer.create(this,renderOptions||{galleyMode:!1,interactivityActions:[]},this.i18n)}print(renderOptions,onProgress,checkCancel){return __awaiter(this,void 0,void 0,(function*(){return(yield VDomRenderer.create(this,renderOptions||{galleyMode:!1,interactivityActions:[]},this.i18n)).print(onProgress,checkCancel)}))}}function validateParameters(parameters){const validationResults={};return Object.keys(parameters).forEach((name=>validationResults[name]=function(param){var _a;const{errorMessage:errorMessage,descriptor:descriptor}=param,input=__rest$1(param,["errorMessage","descriptor"]),validated=function(param){if(param.descriptor.multiValue)return validateMultiValueParameter(param);if(param.values.length>1)return markAsInvalid(param,"requiredSingleValue");const result=getParameterValue(param.values,param.descriptor.nullable);if(void 0===result)return markAsMissingValue(param,"requiredValue");if(null===result)return param.descriptor.nullable?markAsValid(param):markAsInvalid(param,"valueIsNull");const validated=validateByType(param,variantToString(result));if(param.descriptor.hasValidValues){const value=getParameterValue(validated.values,validated.descriptor.nullable);return validated.state!==ParameterStatus.ok||validated.validValues.some((vv=>isEqual(vv.value,value)))?validated:markAsInvalid(param,"valueOutOfRange")}return validated}(Object.assign(Object.assign({},input),{descriptor:Object.assign(Object.assign({},descriptor),{hasValidValues:isDataSetRef(descriptor.validValues)||descriptor.validValues.length>0}),error:null}));return{isValid:validated.state===ParameterStatus.ok,message:null!==(_a=validated.error)&&void 0!==_a?_a:void 0}}(parameters[name]))),validationResults}function isDataSetRef(validValues){return!Array.isArray(validValues)&&!!validValues.dataSet}function normalize(path){var isPathAbsolute=function(path){return"/"===path.charAt(0)}(path),trailingSlash="/"===substr(path,-1);return(path=function(parts,allowAboveRoot){for(var up=0,i=parts.length-1;i>=0;i--){var last=parts[i];"."===last?parts.splice(i,1):".."===last?(parts.splice(i,1),up++):up&&(parts.splice(i,1),up--)}if(allowAboveRoot)for(;up--;up)parts.unshift("..");return parts}(filter$1(path.split("/"),(function(p){return!!p})),!isPathAbsolute).join("/"))||isPathAbsolute||(path="."),path&&trailingSlash&&(path+="/"),(isPathAbsolute?"/":"")+path}function filter$1(xs,f){if(xs.filter)return xs.filter(f);for(var res=[],i=0;i<xs.length;i++)f(xs[i],i,xs)&&res.push(xs[i]);return res}PageDocument.create=(reportDefinition,ctx,resourceLocator,parameters,getDataProvider,i18n)=>__awaiter(void 0,void 0,void 0,(function*(){let compiled,dataTree;try{compiled=yield function(report,i18n,resourceLocator,userData){return __awaiter(this,void 0,void 0,(function*(){const context=yield createFactory(report.Name,i18n,resourceLocator,userData,report.CustomProperties)(report.Name);return compileReport(report,context)}))}(reportDefinition,i18n,resourceLocator,ctx)}catch(e){if(e instanceof LayoutError)throw new Error(i18n.t("core:errors.layout",{defaultValue:"Report layout error: {{details}}.",details:e.message,interpolation:{escapeValue:!1}}));if(e instanceof InvalidReportDefinitionError)throw new Error(i18n.t("core:errors.invalid-definition",{defaultValue:"Report definition is not valid: {{details}}.",details:e.message,interpolation:{escapeValue:!1}}));if(e instanceof ReportCompilationError)throw new Error(i18n.t("core:errors.compile",{defaultValue:"Report compile error: {{details}}.",details:e.message,interpolation:{escapeValue:!1}}));throw e}try{const dataProvider=yield getDataProvider(compiled.Subreports,!function(query){const traverse=obj=>"object"==typeof obj?null!==obj&&(Array.isArray(obj)?obj.some(traverse):Object.values(obj).some(traverse)):isCodeExpression(obj);return traverse(query)}(compiled.Query.Content)&&!hasCustomCodeInDatasets(reportDefinition.DataSets));dataTree=yield dataProvider.fetchReportData(compiled.Query,parameters)}catch(e){const message=e instanceof Error?e.message:`${e}`;throw new Error(i18n.t("core:errors.data-processing",{defaultValue:"Data processing error: {{details}}.",details:message,interpolation:{escapeValue:!1}}))}const pageInfo=!!(reportDefinition.Body&&reportDefinition.Body.ReportItems&&reportDefinition.Body.ReportItems.length>0&&(reportDefinition.Body.ReportItems[0].Type||"").startsWith("fixedpage"))?null:reportDefinition.Page;return new PageDocument(compiled,ctx,pageInfo,reportDefinition.LayoutOrder,dataTree,i18n)})),i18next.init({fallbackLng:"en",lng:"en",resources:{},defaultNS:"arjs_core",keySeparator:"."}),window.arjsViewer=window.arjsViewer||{},window.arjsViewer.addLocalization=localeData=>{localeData.forEach((({ns:ns,lng:lng,resources:resources})=>{i18next.hasResourceBundle(lng,ns)||i18next.addResourceBundle(lng,ns,resources)}))},window.arjsViewer.loadLocalizations&&window.arjsViewer.loadLocalizations();var substr="b"==="ab".substr(-1)?function(str,start,len){return str.substr(start,len)}:function(str,start,len){return start<0&&(start=str.length+start),str.substr(start,len)};class HttpRequestError extends Error{constructor(message,details){super(message),this.details=details,Object.setPrototypeOf(this,HttpRequestError.prototype)}}const noCacheHeaders={"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"};function makeRequestInit(token,headers={}){const init={headers:Object.assign(Object.assign(Object.assign({},noCacheHeaders),{Accept:"application/json"}),headers)};return token?init.headers.Authorization=token:init.credentials="include",init}const handleRequest=(request,getResult)=>__awaiter(void 0,void 0,void 0,(function*(){const response=yield request;if(!response.ok)throw new HttpRequestError((response=>`${response.status} - ${response.statusText}`)(response),{type:"status",status:response.status,statusText:response.statusText});try{return yield getResult(response)}catch(e){const message=e instanceof Error?e.message:`${e}`;throw new HttpRequestError(message,{type:"invalid_response"})}}));function createHttpClient(authToken){return{getJson:uri=>{return url=uri,token=authToken,__awaiter(void 0,void 0,void 0,(function*(){return handleRequest(fetch(url,makeRequestInit(token)),(response=>response.json()))}));var url,token},postJson:(uri,data)=>((url,token,data=null)=>__awaiter(void 0,void 0,void 0,(function*(){return handleRequest(fetch(url,Object.assign(Object.assign({},makeRequestInit(token,{"content-type":"application/json"})),{method:"post",body:JSON.stringify(data)})),(r=>r.json()))})))(uri,authToken,data),getText:uri=>{return url=uri,token=authToken,__awaiter(void 0,void 0,void 0,(function*(){return handleRequest(fetch(url,makeRequestInit(token)),(r=>r.text()))}));var url,token}}}function createDefaultResourceLocator(basePath="",http){const httpClient=null!=http?http:createHttpClient("");basePath&&(basePath=basePath.replace(/\/+$/,"")+"/");const getResourceUri=name=>{if(!name)throw new Error("Resource URI not specified.");return joinPaths(basePath,name)};return{getResourceUri:getResourceUri,getResource:resourceUri=>httpClient.getJson(getResourceUri(resourceUri)),fork:name=>createDefaultResourceLocator(joinPaths(basePath,function(uri){if(!uri)return"";const separatorIdx=uri.lastIndexOf("/");return separatorIdx>=0?uri.substring(0,separatorIdx).replace(/\/+$/,""):""}(name)))}}function makeFullResourceLocator(baseLocator){const http=createHttpClient(""),getResourceUri=baseLocator.getResourceUri||(name=>name),getResource=baseLocator.getResource||(resourceUri=>http.getJson(getResourceUri(resourceUri))),resLocator={getResourceUri:getResourceUri,getResource:getResource,fork:baseLocator.fork||(()=>resLocator)};return resLocator}const isAbsoluteUrl=url=>url.match(/^https?:\/\//i);function joinPaths(baseUri,uri){return uri?baseUri&&isAbsoluteUrl(baseUri)?new URL(uri,baseUri).href:isAbsoluteUrl(uri)||/^\/+/.test(uri)?uri:function(){return normalize(filter$1(Array.prototype.slice.call(arguments,0),(function(p,index){if("string"!=typeof p)throw new TypeError("Arguments to path.join must be strings");return p})).join("/"))}(baseUri,uri).replace(/\\/g,"/"):baseUri}const webResourceProvider={getData(requestInfo){return __awaiter(this,void 0,void 0,(function*(){const{uri:uri}=requestInfo,options=__rest$1(requestInfo,["uri"]);let response,responseText;try{response=yield fetch(uri,options),responseText=yield response.text()}catch(err){return failure({message:err instanceof Error?err.message:`${err}`})}return response.ok?success(responseText):failure({status:response.status,message:responseText})}))},getDataSync(requestInfo){const{uri:uri}=requestInfo,options=__rest$1(requestInfo,["uri"]),request=new XMLHttpRequest;request.withCredentials="include"===options.credentials;try{request.open(options.method,uri,!1);const headers=options.headers||{};for(const headerKey of Object.keys(headers))request.setRequestHeader(headerKey,headers[headerKey]);request.send("post"===options.method&&options.body?options.body:null)}catch(err){return failure({message:err instanceof Error?err.message:`${err}`})}return 200===request.status?success(request.responseText):failure({status:request.status,message:request.responseText})}};function makeKey(requestInfo){return function(data,opts){opts||(opts={}),"function"==typeof opts&&(opts={cmp:opts});var f,cycles="boolean"==typeof opts.cycles&&opts.cycles,cmp=opts.cmp&&(f=opts.cmp,function(node){return function(a,b){var aobj={key:a,value:node[a]},bobj={key:b,value:node[b]};return f(aobj,bobj)}}),seen=[];return function stringify(node){if(node&&node.toJSON&&"function"==typeof node.toJSON&&(node=node.toJSON()),void 0!==node){if("number"==typeof node)return isFinite(node)?""+node:"null";if("object"!=typeof node)return JSON.stringify(node);var i,out;if(Array.isArray(node)){for(out="[",i=0;i<node.length;i++)i&&(out+=","),out+=stringify(node[i])||"null";return out+"]"}if(null===node)return"null";if(-1!==seen.indexOf(node)){if(cycles)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var seenIndex=seen.push(node)-1,keys=Object.keys(node).sort(cmp&&cmp(node));for(out="",i=0;i<keys.length;i++){var key=keys[i],value=stringify(node[key]);value&&(out&&(out+=","),out+=JSON.stringify(key)+":"+value)}return seen.splice(seenIndex,1),"{"+out+"}"}}(data)}(requestInfo)}function throwErr(err){throw err}const makeGetErrorMessage=i18n=>err=>{switch(err.key){case"fetch-failed":return i18n.t("core:errors.fetch-failed",{defaultValue:'Unable to load data from "{{uri}}": {{responseStatus}} {{responseText}}.',uri:err.uri,responseStatus:err.responseStatus,responseText:err.responseText,interpolation:{escapeValue:!1}});case"json-parse":return i18n.t("core:errors.json-parse",{defaultValue:'Failed to parse JSON: {{errorMessage}}. Source string: "{{jsonString}}".',errorMessage:err.message,jsonString:err.jsonString,interpolation:{escapeValue:!1}});case"unknown-dataprovider":return i18n.t("core:errors.unknown-dataprovider",{defaultValue:'Unknown data provider "{{providerName}}"',providerName:err.providerName,interpolation:{escapeValue:!1}});case"unknown-datasource":return i18n.t("core:errors.unknown-datasource",{defaultValue:'Unknown datasource "{{dataSourceName}}"',dataSourceName:err.dataSourceName,interpolation:{escapeValue:!1}});case"generic-error":return i18n.t("core:errors.generic-error",{defaultValue:"{{errorMessage}}",errorMessage:err.message,interpolation:{escapeValue:!1}});case"dataprovider.no-data":return i18n.t("core:errors.dataprovider.no-data",{defaultValue:"Invalid data provider settings. Source or data is not specified.",interpolation:{escapeValue:!1}});case"dataprovider.connectstring-invalid":return i18n.t("core:errors.dataprovider.connectstring-invalid",{defaultValue:"Invalid data source ConnectString: {{connectString}}.",connectString:err.connectionString,interpolation:{escapeValue:!1}});case"dataprovider.commandtext-invalid":return i18n.t("core:errors.dataprovider.commandtext-invalid",{defaultValue:"Invalid data provider CommandText: {{commandText}}.",commandText:err.commandText,interpolation:{escapeValue:!1}});case"jsondataprovider.no-global-data":return i18n.t("core:errors.jsondataprovider.no-global-data",{defaultValue:'No data available for DataSet "{{datasetName}}" - {{globalPath}} = {{globalValue}}',datasetName:err.datasetName,globalPath:err.globalPath,globalValue:err.globalValue,interpolation:{escapeValue:!1}});case"csvdataprovider.header-parse":return i18n.t("core:errors.csvdataprovider.header-parse",{defaultValue:'Unable to parse column header: "{{headerValue}}"',headerValue:err.headerValue,interpolation:{escapeValue:!1}});default:!function(err){throw new Error("Unknown error kind: "+err.key)}(err)}};const isDataProviderError=err=>{if("object"!=typeof err||null==err)return!1;switch(err.key){case"fetch-failed":case"json-parse":case"unknown-dataprovider":case"unknown-datasource":case"generic-error":case"dataprovider.no-data":case"dataprovider.connectstring-invalid":case"dataprovider.commandtext-invalid":case"jsondataprovider.no-global-data":case"csvdataprovider.header-parse":return!0;default:return!1}};const withLocalizedErrors=i18n=>{const getErrorMessage=makeGetErrorMessage(i18n);return fn=>(...args)=>{try{return fn(...args)}catch(err){throw isDataProviderError(err)?new Error(getErrorMessage(err)):err}}},withLocalizedErrorsAsync=i18n=>{const getErrorMessage=makeGetErrorMessage(i18n);return fn=>(...args)=>__awaiter(void 0,void 0,void 0,(function*(){try{return yield fn(...args)}catch(err){throw isDataProviderError(err)?new Error(getErrorMessage(err)):err}}))},map$1=transform=>function*(source){let counter=0,next=source.next();for(;!next.done;)yield transform(next.value,counter++),next=source.next()},filter=predicate=>function*(source){for(const item of source)predicate(item)&&(yield item)};function first(source){const firstItem=source.next();return firstItem.done?void 0:firstItem.value}function last(source){let lastItem;for(const item of source)lastItem=item;return lastItem}function any(source){for(const _ of source)return!0;return!1}const zip=selector=>function*(first,second){let index=0;const it1=(first||[])[Symbol.iterator](),it2=(second||[])[Symbol.iterator]();let r1=it1.next(),r2=it2.next();for(;!r1.done&&!r2.done;)yield selector(r1.value,r2.value,index++),r1=it1.next(),r2=it2.next()},zipTuple=zip(((f,t)=>[f,t])),asIndexed=map$1(((item,index)=>({index:index,item:item}))),toArray=Array.from;const iterable={map:map$1,mapMany:transform=>function*(source){for(const item of source)yield*transform(item)},filter:filter,first:first,last:last,any:any,findFirst:predicate=>source=>first(filter(predicate)(source)),findLast:predicate=>source=>last(filter(predicate)(source)),findAny:predicate=>source=>any(filter(predicate)(source)),zip:zip,zipTuple:zipTuple,asIndexed:asIndexed,orderBy:(keySelector,comparer)=>function*(source){for(const item of Array.from(source).sort(((a,b)=>comparer(keySelector(a),keySelector(b)))))yield item},takeWhile:predicate=>function*(source){for(const item of source){if(!predicate(item))return;yield item}},toArray:toArray,groupBy:keyFunction=>function*(source){const groups=new Map;for(const item of source){const key=keyFunction(item);groups.has(key)?groups.get(key).push(item):groups.set(key,[item])}for(const group of groups.entries())yield group},count:function(source){let count=0;for(const _ of source)count++;return count},memoize:function*(iterable){const iterator=iterable[Symbol.iterator](),cache=[];let index=-1;for(;;)if(index++,index<cache.length)yield cache[index];else{const next=iterator.next();if(next.done)return;cache[index]=next.value,yield next.value}},skip:skipCount=>function*(source){let counter=0;for(const item of source)counter++>=skipCount&&(yield item)},join:function*(...iterables){for(const it of iterables)yield*it}},columnRegex=/^([^\[\]\(\)]+)()()$|^([^\[\]\(\)]+)\((\w+)\)()$|^([^\[\]\(\)]+)\((\w+)\[(\d+)\]\)$|^([^\[\]\(\)]+)()\[(\d+)\]$/;function parseColumns(columnHeaders){let namelessColomnIndex=0;const generateName=colomnIndex=>`Column${colomnIndex}`,isNameTaken=colomnName=>columnHeaders.some((name=>name===colomnName));return columnHeaders.map((col=>{if(null===col){do{namelessColomnIndex++}while(isNameTaken(generateName(namelessColomnIndex)));return{name:generateName(namelessColomnIndex),type:"String",width:0}}const matches=columnRegex.exec(col||"");if(matches){const found=matches.findIndex(((v,i)=>i>0&&void 0!==v));if(found>-1)return{name:matches[found].trim(),type:matches[found+1]||"String",width:parseInt(matches[found+2]||"0")}}throw throwErr({key:"csvdataprovider.header-parse",headerValue:null!=col?col:void 0})}))}function buildHeader(lines,input,settings,connectionStringColumns){let columns;const headerColumns=parseColumns(settings.HasHeaders&&iterable.first(lines)||[]);if(connectionStringColumns.length>0)columns=connectionStringColumns;else if(headerColumns.length>0)columns=headerColumns;else{columns=splitLineDelimited(settings)(readLines(settings)(input).next().value||"").map(((_,i)=>({name:`Column${i+1}`,type:"String",width:0})))}const header={nameIndex:{},types:columns.map((col=>col.type))};return columns.forEach(((col,i)=>{header.nameIndex[col.name]=i})),header}const readLines=settings=>function*(csv){let index=0,lineCount=0;for(;index<csv.length;){let line="";for(;index<csv.length&&!csv.startsWith(settings.RowsSeparator,index);)line+=csv[index],index++;index+=settings.RowsSeparator.length,lineCount++,lineCount<=settings.DataStartLine||0===line.length&&settings.JoinRowsSeparators||(yield line)}},splitLineDelimited=settings=>line=>{const trimmedLine=(line||"").trim(),parts=[];let part="",quote=!1;for(let i=0;i<trimmedLine.length;i++){const c=trimmedLine[i];trimmedLine.startsWith(settings.TextQualifier,i)?(i+=settings.TextQualifier.length-1,trimmedLine.startsWith(settings.TextQualifier,i+1)?i+=settings.TextQualifier.length:quote=!quote,part+=settings.TextQualifier):quote?part+=c:trimmedLine.startsWith(settings.ColumnsSeparator,i)?(i+=settings.ColumnsSeparator.length-1,(part.length>0||!settings.JoinColumnsSeparators)&&parts.push(part),part=""):trimmedLine.startsWith(settings.EscapeCharSymbol,i)?(i+=settings.EscapeCharSymbol.length,part+=trimmedLine[i]):part+=c}return parts.push(part),parts.map((p=>""===p||"DBNull"===p?null:" "===p?"":p.startsWith(settings.TextQualifier)&&p.endsWith(settings.TextQualifier)?p.substr(settings.TextQualifier.length,p.length-2*settings.TextQualifier.length):p))},splitLineFixed=rxFixedColumns=>line=>line.split(rxFixedColumns).map((s=>s.trim())).slice(1,-1),map=fn=>r=>"success"==r.kind?success(fn(r.value)):r,createPipe=r=>({map:f=>createPipe(map(f)(r)),then:f=>createPipe((f=>r=>(r=>"failure"==r.kind?r:r.value)(map(f)(r)))(f)(r)),result:r});function getResultOrThrowAsync(fn){return(...args)=>__awaiter(this,void 0,void 0,(function*(){const result=yield fn(...args);if("failure"===result.kind)throw result.error;return result.value}))}function getEmbeddedCsv(source){return source.data?success(source.data):failure({key:"dataprovider.no-data"})}function getText(source,webResProvider){return __awaiter(this,void 0,void 0,(function*(){return"http"===source.kind?function(source,webResProvider){return __awaiter(this,void 0,void 0,(function*(){return yield fetchText(source.endpoint,toFetchOptions(source),webResProvider)}))}(source,webResProvider):getEmbeddedCsv(source)}))}function getTextSync(source,webResProvider){return"http"===source.kind?function(source,webResProvider){return fetchTextSync(source.endpoint,toFetchOptions(source),webResProvider)}(source,webResProvider):getEmbeddedCsv(source)}const csvDataProvider={openReader:(settings,fields,webResProvider)=>__awaiter(void 0,void 0,void 0,(function*(){return createPipe(yield getText(settings.source,webResProvider)).map(getCsvReader(settings.dataParserOptions,fields.map((f=>f.DataField)))).result})),openReaderSync:(settings,fields,webResProvider)=>createPipe(getTextSync(settings.source,webResProvider)).map(getCsvReader(settings.dataParserOptions,fields.map((f=>f.DataField)))).result},getCsvReader=(settings,dataFields)=>data=>{const dataReader=function(input,settings){const connectionStringLine=splitLineDelimited({ColumnsSeparator:",",TextQualifier:'"',EscapeCharSymbol:"\\",JoinColumnsSeparators:!1})(settings.Columns),connectionStringColumns=parseColumns(connectionStringLine.some((col=>col))?connectionStringLine:[]),columnWidths=connectionStringColumns.map((c=>c.width)).filter((w=>0!==w)),splitLine=0===columnWidths.length?splitLineDelimited(settings):splitLineFixed(new RegExp("^"+columnWidths.map((w=>`(.{0,${w}})`)).join("")));return pipe(readLines(settings),iterable.map(splitLine),(lines=>({header:buildHeader(lines,input,settings,connectionStringColumns),lines:lines})))(input)}(data,settings);if(0===dataFields.length)for(let[key,value]of Object.entries(dataReader.header.nameIndex))dataFields[value]=key;const descriptors=dataFields.map(toDataFieldDescriptor).map((d=>d.Type?d:Object.assign(Object.assign({},d),{Type:mapDataType(dataReader.header.types[dataReader.header.nameIndex[d.Name]])}))),parseDates=getParseDateFieldsFn(descriptors,settings.defaultDateFormats);return{descriptors:descriptors,records:pipe(iterable.map((dataRow=>descriptors.map((d=>dataRow[dataReader.header.nameIndex[d.Name]])))),iterable.map(parseDates))(dataReader.lines)}};function buildDataFieldsMap(obj){const dfMap={};return isDataObject(obj)&&Object.keys(obj).forEach((key=>{dfMap[key.toLowerCase()]={originalKey:key,props:buildDataFieldsMap(obj[key])}})),dfMap}function isDataObject(value){return"object"==typeof value&&null!==value&&!Array.isArray(value)}function makeJsonReader(dataFields,optionsDateFormats){return(data,query)=>{const dataValues=query?JSONPath({json:data,path:query.replace(/^\$\.\[/,"$[")}):data;let dataIterator=function(values){return null==values||void 0===values[Symbol.iterator]?[][Symbol.iterator]():values[Symbol.iterator]()}(dataValues);const first=iterable.first(dataIterator),dataFieldsDictionary=Array.isArray(dataValues)?buildDataFieldsMap(first):{};0===dataFields.length&&(dataFields=isDataObject(first)?Object.keys(first):["Field1"]),dataIterator=iterable.join(void 0!==first?[first]:[],dataIterator);const descriptors=dataFields.map(toDataFieldDescriptor),defaultDateFormats=[{ISO_8601:!0},...optionsDateFormats],parseDates=getParseDateFieldsFn(descriptors,defaultDateFormats),recordsPipe=pipe(iterable.map((dataRow=>1!==dataFields.length||isDataObject(dataRow)?descriptors.map((d=>isDataObject(dataRow)?function(obj,path="",dataFieldsMapRef){if(null==obj)return obj;if(dataFieldsMapRef[path]&&void 0!==obj[dataFieldsMapRef[path].originalKey])return obj[dataFieldsMapRef[path].originalKey];const originalKey=Object.keys(obj).find((key=>key.toLowerCase()===path));if(originalKey)return dataFieldsMapRef[path]={originalKey:originalKey,props:buildDataFieldsMap(obj[originalKey])},obj[originalKey];const pathParts=path.split("."),lastPartIndex=pathParts.length-1;return function find(root,firstPartIndex,dfMapRef){for(let index=lastPartIndex;index>=firstPartIndex;index--){const key=(start=firstPartIndex,end=index,pathParts.slice(start,end+1).join("."));if(void 0===dfMapRef[key]){const originalKey=Object.keys(root).find((k=>k.toLowerCase()===key));if(!originalKey)continue;dfMapRef[key]={originalKey:originalKey,props:buildDataFieldsMap(root[originalKey])}}const value=root[dfMapRef[key].originalKey];if("object"!=typeof value||null===value||Array.isArray(value)){if(void 0!==value&&index===lastPartIndex)return value}else{const result=find(value,index+1,dfMapRef[key].props);if(void 0!==result)return result}}var start,end}(obj,0,dataFieldsMapRef)}(dataRow,d.LowerCaseName,dataFieldsDictionary):null)):[dataRow])),iterable.map(parseDates));return{descriptors:descriptors,records:recordsPipe(dataIterator)}}}function getEmbeddedJson(source){if(source.data.startsWith("@@")){const varName=source.data.substring(2),data=window[varName];return null==data?failure({key:"jsondataprovider.no-global-data",globalPath:`window['${varName}']`,globalValue:`${data}`}):success(data)}return source.data?parseJSON(source.data):failure({key:"dataprovider.no-data"})}function getJson(source,webResProvider){return __awaiter(this,void 0,void 0,(function*(){return"http"===source.kind?function(source,webResProvider){return __awaiter(this,void 0,void 0,(function*(){const fetched=yield fetchText(source.endpoint,toFetchOptions(source),webResProvider);return createPipe(fetched).then((d=>parseJSON(d))).result}))}(source,webResProvider):getEmbeddedJson(source)}))}function getJsonSync(source,webResProvider){return"http"===source.kind?function(source,webResProvider){const fetched=fetchTextSync(source.endpoint,toFetchOptions(source),webResProvider);return createPipe(fetched).then((d=>parseJSON(d))).result}(source,webResProvider):getEmbeddedJson(source)}const createReader=(options,fields)=>data=>makeJsonReader(fields.map((f=>f.DataField)),options.defaultDateFormats)(data,options.jpath);function parseJSON(jsonString){try{return success(JSON.parse(jsonString))}catch(e){return throwErr({key:"json-parse",jsonString:jsonString,message:e.message})}}const unescapeChar=c=>{switch(c){case"\\r":return"\r";case"\\n":return"\n";case"\\t":return"\t";case'\\"':return'"';case"\\=":return"=";case"\\;":return";";default:return c}};function unescapeString(part){let inStringConstant=!1;return[...part].map(((c,i,a)=>{var _a;if("\\"===c){const newChar=`${c}${null!==(_a=a[i+1])&&void 0!==_a?_a:""}`;return inStringConstant?'\\"'===newChar||"\\\\"===newChar?(a[i+1]="",newChar):c:(a[i+1]="",newChar.replace(/\\r|\\n|\\t|\\"|\\=|\\;/g,unescapeChar))}return'"'===c&&(inStringConstant=!inStringConstant),c})).join("")}function parseUri(uri){const dividerPos=uri.indexOf("?");if(dividerPos<0)return{endpoint:uri,queries:[]};const endpoint=uri.substr(0,dividerPos);let name="",value="",isEscaped=!1;const queries=[];for(let i=dividerPos+1;i<uri.length;i++)if("&"!==uri[i]||isEscaped)if("="!==uri[i]||isEscaped)name+=uri[i],isEscaped=!isEscaped&&"\\"===uri[i];else{value="";for(let j=i+1;j<uri.length;j++){if("&"===uri[j]&&!isEscaped){i=j-1;break}value+=uri[j],j===uri.length-1&&(i=j),isEscaped=!isEscaped&&"\\"===uri[j]}}else queries.push({name:name,value:value}),name="",value="";return name.length&&queries.push({name:name,value:value}),{endpoint:endpoint,queries:queries}}function parseHeaders(props,prefix){return Object.entries(props).filter((([key])=>key.startsWith(prefix))).map((([key,value])=>[key.substr(prefix.length),unescapeString(value)])).reduce(((acc,[key,value])=>(acc[key]=value,acc)),{})}function parseRawString(input,parsingSettings,err){try{return success(parseSeparatedString(input,parsingSettings))}catch(_a){return failure(err)}}function getSourceSettings(settings){var _a;if(void 0!==settings.dataSource.data)return success({kind:"embedded",data:unescapeString(settings.dataSource.data)});const dataSource={endpoint:unescapeString(null!==(_a=settings.dataSource.endpoint)&&void 0!==_a?_a:""),headers:parseHeaders(settings.dataSource,"Header$")},dataSet=function(parsed){var _a,_b,_c;const method=null===(_a=parsed.method)||void 0===_a?void 0:_a.toLowerCase();return{uri:unescapeString(null!==(_b=parsed.uri)&&void 0!==_b?_b:""),method:"post"===method?{type:"post",body:unescapeString(null!==(_c=parsed.body)&&void 0!==_c?_c:"")}:{type:"get"},headers:parseHeaders(parsed,"Header$")}}(settings.dataSet),endpoint=function(dataQueryUri,baseUri){let uri;const baseUriParsed=parseUri(baseUri),dataQueryUriParsed=parseUri(dataQueryUri),isDataQueryAbsolute=!!dataQueryUriParsed.endpoint.match(/^https?:/i);baseUriParsed.endpoint&&!isDataQueryAbsolute?(uri=baseUriParsed.endpoint,dataQueryUriParsed.endpoint&&(uri+=dataQueryUriParsed.endpoint.substr(uri.endsWith("/")&&dataQueryUriParsed.endpoint.startsWith("/")?1:0))):uri=dataQueryUriParsed.endpoint;const queries=(queries=>queries.reduce(((unique,item)=>{const index=unique.findIndex((query=>query.name===item.name));return index>-1?unique[index]=item:unique.push(item),unique}),[]))([...isDataQueryAbsolute?[]:baseUriParsed.queries,...dataQueryUriParsed.queries]);return queries.length&&(uri+="?"+queries.map((q=>`${q.name}${q.value.length>0?"=":""}${q.value}`)).join("&")),uri}(dataSet.uri,dataSource.endpoint);return endpoint?success({kind:"http",endpoint:endpoint,method:dataSet.method,headers:Object.assign(Object.assign({},dataSource.headers),dataSet.headers)}):failure({key:"dataprovider.no-data"})}const parsingSettings$1={ignoreQuotes:!0,trimValues:!1,lowerCaseKeys:!1};const getPropValue=(props,name,def,func)=>void 0===props[name]?def:func?func(props[name]):props[name],unescape=s=>s.replace(/\\r/g,"\r").replace(/\\n/g,"\n").replace(/\\t/g,"\t").replace(/\\;/g,";").replace(/\\\\/g,"\\");function getReaderSettings$1(settings){return{ColumnsSeparator:getPropValue(settings.dataSet,"ColumnsSeparator",",",unescape),JoinColumnsSeparators:getPropValue(settings.dataSet,"JoinColumnsSeparators",!1,parseBoolean),RowsSeparator:getPropValue(settings.dataSet,"RowsSeparator","\n",unescape),JoinRowsSeparators:getPropValue(settings.dataSet,"JoinRowsSeparators",!1,parseBoolean),TextQualifier:getPropValue(settings.dataSet,"TextQualifier",'"',unescape),DataStartLine:getPropValue(settings.dataSet,"DataStartLine",0,parseInt),EscapeCharSymbol:getPropValue(settings.dataSet,"EscapeCharSymbol","\\"),HasHeaders:getPropValue(settings.dataSet,"HasHeaders",!1,parseBoolean),Columns:getPropValue(settings.dataSet,"Columns","",unescape),defaultDateFormats:[{ISO_8601:!0},...parseDateFormats(getByInvariantCaseKey(settings.dataSource,"DateFormats"))]}}function parseCsvSettings(connectionString,commandText){const rawSettingsRes=function(connectString,commandText,parsingSettings){const dataSource=parseRawString(connectString,parsingSettings,{key:"dataprovider.connectstring-invalid",connectionString:connectString});if("failure"===dataSource.kind)return dataSource;const dataSet=parseRawString(commandText,parsingSettings,{key:"dataprovider.commandtext-invalid",commandText:commandText});return"failure"===dataSet.kind?dataSet:success({dataSource:dataSource.value,dataSet:dataSet.value})}(connectionString,commandText,parsingSettings$1);if("failure"===rawSettingsRes.kind)return rawSettingsRes;const rawSettings=rawSettingsRes.value,sourceSettings=getSourceSettings(rawSettings);return"failure"===sourceSettings.kind?sourceSettings:success({source:sourceSettings.value,dataParserOptions:{dataFormat:"csv",options:getReaderSettings$1(rawSettings)}})}const parsingSettings={lowerCaseKeys:!1,ignoreQuotes:!1,trimValues:!1},connectStringMap=[{from:"jsondoc",to:"endpoint"},{from:"jsondata",to:"data"}];function parseSettingsString(input,mappedProps,err,defaultProp){const parsedSettings=parseRawString(input,parsingSettings,err);if("failure"===parsedSettings.kind)return parsedSettings;const keys=Object.keys(parsedSettings.value);return void 0!==defaultProp&&(0===input.length||1===keys.length&&keys[0]===input)?success({[defaultProp]:input}):success(mappedProps.reduce(((acc,map)=>function(map,props){if(props.hasOwnProperty(map.to)||!props.hasOwnProperty(map.from))return props;const _a=props,_b=map.from,sourceValue=_a[_b],restProps=__rest$1(_a,["symbol"==typeof _b?_b:_b+""]);return Object.assign(Object.assign({},restProps),{[map.to]:sourceValue})}(map,acc)),parsedSettings.value))}function parseJsonSettings(connectionString,commandText){const rawSettingsRes=function(connectString,commandText){const dataSource=parseSettingsString(connectString,connectStringMap,{key:"dataprovider.connectstring-invalid",connectionString:connectString});if("failure"===dataSource.kind)return dataSource;const dataSet=parseSettingsString(commandText,[],{key:"dataprovider.commandtext-invalid",commandText:commandText},"jpath");return"failure"===dataSet.kind?dataSet:success({dataSource:dataSource.value,dataSet:(props=dataSet.value,0!==Object.keys(props).filter((key=>["jpath","method","uri"].includes(key)||key.startsWith("Header$"))).length?dataSet.value:{jpath:commandText})});var props}(connectionString,commandText);if("failure"===rawSettingsRes.kind)return rawSettingsRes;const rawSettings=rawSettingsRes.value,sourceSettings=getSourceSettings(rawSettings);return"failure"===sourceSettings.kind?sourceSettings:success({source:sourceSettings.value,dataParserOptions:{dataFormat:"json",options:(settings=rawSettings,{jpath:unescapeString(null!==(_a=settings.dataSet.jpath)&&void 0!==_a?_a:""),defaultDateFormats:parseDateFormats(unescapeString(null!==(_b=getByInvariantCaseKey(settings.dataSource,"DateFormats"))&&void 0!==_b?_b:""))})}});var settings,_a,_b}const dataProviderSettingsParser={json:parseJsonSettings,jsonembed:parseJsonSettings,csv:parseCsvSettings,csvembed:parseCsvSettings,testing:function(connectionString,commandText){const settings=getReaderSettings$1({dataSource:parseSeparatedString(connectionString),dataSet:{}});return settings.HasHeaders=!0,success({source:{kind:"embedded",data:commandText},dataParserOptions:{dataFormat:"csv",options:settings}})}};const dataReaders={json:{openReader:(settings,fields,webResProvider)=>__awaiter(void 0,void 0,void 0,(function*(){return createPipe(yield getJson(settings.source,webResProvider)).map(createReader(settings.dataParserOptions,fields)).result})),openReaderSync:(settings,fields,webResProvider)=>createPipe(getJsonSync(settings.source,webResProvider)).map(createReader(settings.dataParserOptions,fields)).result},csv:csvDataProvider};function getDataProvider(connection,webResProvider=webResourceProvider){const parserOptions=connection.dataParserOptions;if("json"===parserOptions.dataFormat){const dataReader=dataReaders[parserOptions.dataFormat],settings=Object.assign(Object.assign({},connection),{dataParserOptions:parserOptions.options});return{openReader:fields=>dataReader.openReader(settings,fields,webResProvider),openReaderSync:fields=>dataReader.openReaderSync(settings,fields,webResProvider)}}{const dataReader=dataReaders[parserOptions.dataFormat],settings=Object.assign(Object.assign({},connection),{dataParserOptions:parserOptions.options});return{openReader:fields=>dataReader.openReader(settings,fields,webResProvider),openReaderSync:fields=>dataReader.openReaderSync(settings,fields,webResProvider)}}}function MakeDataReaderFactory(dataSet){const dataFieldsDs=Object.assign(Object.assign({},dataSet),{Fields:dataSet.Fields.filter((f=>f.DataField))}),computedFields=dataSet.Fields.filter((f=>!f.DataField&&f.Value)),fields=dataSet.Fields.map((f=>f.Name)),fieldsIndex={};for(let i=0;i<fields.length;i++)fieldsIndex[fields[i]]=i;const dataFields=dataFieldsDs.Fields.map((f=>f.Name)),resolveComputed=function(computedFields,dataFields){const compiledFields=function(fields,dataFields){const sorted=[],fieldNames=dataFields.map((f=>f.toLowerCase()));let outstanding=fields,canResolve=[];do{canResolve=outstanding.filter((f=>canResolveComputedField(f.Value,fieldNames))),sorted.push(...canResolve),fieldNames.push(...canResolve.map((f=>f.Name.toLowerCase()))),outstanding=outstanding.filter((f=>canResolve.indexOf(f)<0))}while(canResolve.length);return sorted.push(...outstanding.map((f=>Object.assign(Object.assign({},f),{Value:"=Nothing"})))),sorted}(computedFields,dataFields).map((field=>[field.Name,treeBuilder(field.Value)]));return(dataFields,evalCtx)=>{if(!compiledFields.length)return[];const fields={},dataCtx=Object.assign(Object.assign({},evalCtx),{Data:Object.assign(Object.assign({},evalCtx.Data),{fields:fields})});for(let i=0;i<dataFields.length;i++){const[fName,fValue]=dataFields[i];fields[fName]={Name:fName,Value:fValue}}const computedNameValues=[];for(const[name,exprTree]of compiledFields){const computed=SafeEval$1(exprTree,dataCtx).Value;computedNameValues.push([name,computed]),fields[name]={Name:name,Value:computed}}return computedNameValues}}(computedFields,dataFields);return evalCtx=>{const recordsPipe=pipe(iterable.map((dataFieldsRow=>{const dataRow=[];for(let i=0;i<dataFields.length;i++)dataRow[fieldsIndex[dataFields[i]]]=dataFieldsRow[i];return resolveComputed(dataFields.map((df=>[df,dataRow[fieldsIndex[df]]])),evalCtx).forEach((([name,value])=>{dataRow[fieldsIndex[name]]=value})),dataRow})),iterable.asIndexed);return{open:getDataFields=>__awaiter(this,void 0,void 0,(function*(){const dataReader=yield getDataFields(dataFieldsDs);return{types:fields.map((f=>dataFields.indexOf(f)>=0?dataReader.descriptors[dataFields.indexOf(f)].Type:null)),records:recordsPipe(dataReader.records)}})),openSync:getDataFields=>{const dataReader=getDataFields(dataFieldsDs);return{types:fields.map((f=>dataFields.indexOf(f)>=0?dataReader.descriptors[dataFields.indexOf(f)].Type:null)),records:recordsPipe(dataReader.records)}}}}}const treeBuilder=createTreeBuilder();function canResolveComputedField(expr,fieldNames){const exprTree=treeBuilder(expr);return!Tools.containsNode(exprTree,(node=>{if("variable"!==node.Token.type)return!1;const path=node.Token.value.split(/\.|!/);if("fields"===path[0].toLowerCase()&&path.length>1){const name=path[1].toLowerCase();if(fieldNames.indexOf(name)<0)return!0}return!1}))}function isRecordSet(value){return"function"!=typeof value}function buildNestedDataSet(dataSetName,dataSetFields,dataReader,parent){const openJsonReader=data=>ds=>makeJsonReader(ds.Fields.map((f=>f.DataField)),[])(data);return(parentData,parentName)=>{if(parentName!==parent.datasetName)throw new Error(`Data processing error: invalid dataset hierarchy. "${dataSetName}" must be "${parent.datasetName}" child, but is "${parentName}" child.`);const[first,...parentRecordsRest]=parentData||[];if(!first)return[];const data=first.GetByName(parent.fieldName),firstReader=dataReader.openSync(openJsonReader(data.Value)),{types:types,records:firstRecords}=firstReader;return Memoize(GetRecordset({types:types,records:function*(){yield*firstRecords;for(const parentRecord of parentRecordsRest){const data=parentRecord.GetByName(parent.fieldName);yield*dataReader.openSync(openJsonReader(data.Value)).records}}()},dataSetFields))}}function Memoize(iterable){const iterator=iterable[Symbol.iterator](),cache=[];return{*[Symbol.iterator](){let index=-1;for(;;)if(index++,index<cache.length)yield cache[index];else{const next=iterator.next();if(next.done)return;cache[index]=next.value,yield next.value}}}}const isGlobalDataRef=/(^|;) *jsondata *= *@@\w+ *(;|$)/i;function isDataSourceDynamic(dataSource){const connStr=`${dataSource.ConnectionProperties.ConnectString}`.trim();return connStr.startsWith("=")||isGlobalDataRef.test(connStr)}function isDataSetDynamic(dataSet){return`${dataSet.Query.CommandText}`.trim().startsWith("=")||dataSet.Fields.filter((f=>!f.DataField&&f.Value&&`${f.Value}`.toLowerCase().indexOf("parameters")>=0)).length>0}function*GetRecordset(dataReader,fields){const fieldNameIndex={};for(let i=0;i<fields.length;i++)fieldNameIndex[fields[i].Name]=i;for(const record of dataReader.records)yield new Record(record.index,fieldNameIndex,record.item.map(((c,i)=>parseVariant(c,dataReader.types[i]))))}function parseVariant(value,type){if(null==value)return Create$2(value);const lowerCaseValue="object"==typeof value?lowerKeysDeep(value):value;try{return null===type?Create$2(lowerCaseValue):Create$2(lowerCaseValue,type,!0)}catch(err){return Create$2(lowerCaseValue)}}function lowerKeysDeep(obj){if(null==obj||"object"!=typeof obj||obj instanceof Date||dateTimeFactory_isDateTime(obj))return obj;if(Array.isArray(obj))return obj.map(lowerKeysDeep);const result={};return Object.keys(obj||{}).forEach((key=>{result[key.toLowerCase()]=lowerKeysDeep(obj[key])})),result}let _worker,_customCodeRegistrations=new Set;const isCustomCodeRegistered=()=>__awaiter(void 0,void 0,void 0,(function*(){return Promise.all(_customCodeRegistrations.values())}));function registerCustomCodeInWorker(){const functions=getFunctions();if(!_worker||0===Object.keys(functions).length)return;const registered=sendRequest("registerFunctions",-1,[JSON.stringify(functions,((key,value)=>"function"==typeof value?value.toString():value))]);_customCodeRegistrations.add(registered),registered.then((()=>_customCodeRegistrations.delete(registered)))}function getWorker(){if(_worker)return _worker;const blob=new Blob(['function __rest(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t}function __awaiter(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P((function(resolve){resolve(result.value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))}const exponent=/^[0-9]+(?:\\.[0-9]+)?e$/i,makePos=(line,column,character)=>({line:line,column:column,character:character});function tokenize(expression){const isExponent=s=>s&&exponent.test(s),tokens=[];let previous="",isStringConst=!1,isDateConst=!1,currentLine=0,currentColumn=-1,startLine=0,startColumn=0,startIndex=0;const resetIndex=i=>{previous||(startLine=currentLine,startColumn=currentColumn,startIndex=i)};for(let i=0;i<expression.length;i++){const current=expression[i];if(currentColumn+=1,\'"\'!==current)if(isStringConst)resetIndex(i),previous+=current,previous&&!isStringConst&&(tokens.push({token:previous,position:makePos(startLine,startColumn,startIndex),expression:expression}),previous=""),"\\n"===current&&currentLine++,"\\n"!==current&&"\\r"!==current||(currentColumn=-1);else if("#"!==current||0!==previous.length&&"\\\\"===previous[previous.length-1]||(isDateConst=!isDateConst),isDateConst||"#"===current)previous+=current;else if(" "!==current&&"\\t"!==current&&"\\n"!==current&&"\\r"!==current)if((s=current)&&"+-/*=<>&,()\\\\^".indexOf(s)>-1){if(("+"===current||"-"===current)&&isExponent(previous)){previous+=current;continue}if(""!==previous&&tokens.push({token:previous,position:makePos(startLine,startColumn,startIndex),expression:expression}),previous="","="!==current&&"<"!==current&&">"!==current||!(tokens.length>0)||"<"!==tokens[tokens.length-1].token&&">"!==tokens[tokens.length-1].token)if("("===current&&tokens.length>0){const lastToken=tokens[tokens.length-1],splitLocation=Math.max(lastToken.token.lastIndexOf("."),lastToken.token.lastIndexOf("!"));if(splitLocation>0){const lastTokenValue=lastToken.token;tokens[tokens.length-1].token=lastTokenValue.substr(0,splitLocation),tokens.push({token:lastTokenValue.substr(splitLocation),position:makePos(startLine,startColumn+splitLocation,startIndex+splitLocation),expression:expression})}tokens.push({token:current,position:makePos(currentLine,currentColumn,i),expression:expression})}else tokens.push({token:current,position:makePos(currentLine,currentColumn,i),expression:expression});else tokens[tokens.length-1].token+=current}else resetIndex(i),previous+=current;else""!==previous&&tokens.push({token:previous,position:makePos(startLine,startColumn,startIndex),expression:expression}),previous="","\\n"===current&&currentLine++,"\\n"!==current&&"\\r"!==current||(currentColumn=-1),startLine=currentLine,startColumn=0;else if(isStringConst){const next=expression[i+1];next===current?(i+=1,currentColumn+=1,previous+=current+next):(isStringConst=!1,previous+=current,previous&&(tokens.push({token:previous,position:makePos(startLine,startColumn,startIndex),expression:expression}),previous=""),resetIndex(i))}else isStringConst=!0,previous&&(tokens.push({token:previous,position:makePos(startLine,startColumn,startIndex),expression:expression}),previous=""),resetIndex(i),previous+=current}var s;return""!==previous&&tokens.push({token:previous,position:makePos(startLine,startColumn,startIndex),expression:expression}),tokens}const patterns$1=["dddd","ddd","dd","d","fffffff","ffffff","fffff","ffff","fff","ff","f","FFFFFFF","FFFFFF","FFFFF","FFFF","FFF","FF","F","gg","g","hh","h","HH","H","K","mm","m","MMMM","MMM","MM","M","ss","s","tt","t","yyyyy","yyyy","yyy","yy","y","zzz","zz","z","YYYYY","YYYY","YYY","YY","Y","G"];function formatDateTimeWithPattern(value,pattern,locale,isUTC){function fn(val,digits,forceSign=!1){if("string"==typeof val)return val;const num=Math.abs(val).toString();return(val<0?"-":forceSign?"+":"")+(num.length<digits?"0".repeat(digits-num.length)+num:num)}const splittedPattern=parseDateTimeFormat(pattern,patterns$1),needDeclension=splittedPattern.indexOf("d")>-1||splittedPattern.indexOf("dd")>-1,date=value,year=isUTC?date.getUTCFullYear():date.getFullYear(),month=isUTC?date.getUTCMonth():date.getMonth(),day=isUTC?date.getUTCDate():date.getDate(),weekDay=isUTC?date.getUTCDay():date.getDay(),hours=isUTC?date.getUTCHours():date.getHours(),minutes=isUTC?date.getUTCMinutes():date.getMinutes(),seconds=isUTC?date.getUTCSeconds():date.getSeconds(),milliseconds=isUTC?date.getUTCMilliseconds():date.getMilliseconds(),timeZoneOffset=date.getTimezoneOffset(),timeZoneOffsetHours=Math.round(timeZoneOffset/60),timeZoneOffsetMinutes=Math.abs(timeZoneOffset)%60;return splittedPattern.map(((part,index)=>{const previousPart=splittedPattern[index-1];switch(part){case"d":return fn(day,1);case"dd":return fn(day,2);case"ddd":return locale.daysShort[weekDay];case"dddd":return locale.days[weekDay];case"f":return fn(Math.round(milliseconds/100),1);case"ff":return fn(Math.round(milliseconds/10),2);case"fff":return fn(milliseconds,3);case"ffff":return fn(milliseconds,4);case"fffff":return fn(milliseconds,5);case"ffffff":return fn(milliseconds,6);case"fffffff":return fn(milliseconds,7);case"F":return fn(Math.round(milliseconds/100)||"",0);case"FF":return fn(Math.round(milliseconds/10)||"",0);case"FFF":case"FFFF":case"FFFFF":case"FFFFFF":case"FFFFFFF":return fn(Math.round(milliseconds)||"",0);case"h":return fn(hours%12||12,1);case"hh":return fn(hours%12||12,2);case"H":return fn(hours,1);case"HH":return fn(hours,2);case"K":return timeZoneOffset?fn(timeZoneOffsetHours,2,!0)+":"+fn(timeZoneOffsetMinutes,2):"Z";case"m":return fn(minutes,1);case"mm":return fn(minutes,2);case"M":return fn(month+1,1);case"MM":return fn(month+1,2);case"MMM":return locale.monthsShort[month];case"MMMM":return needDeclension&&locale.monthsDeclined?locale.monthsDeclined[month]:locale.months[month];case"s":return fn(seconds,1);case"ss":return fn(seconds,2);case"t":return hours<12?locale.amPmShort[0]:locale.amPmShort[1];case"tt":return hours<12?locale.amPm[0]:locale.amPm[1];case"Y":case"YY":case"YYY":case"YYYY":case"YYYYY":case"y":case"yy":case"yyy":case"yyyy":case"yyyyy":return locale.getCustomYear?locale.getCustomYear(date,part,fn,previousPart):fn(part.length<=2?year%100:year,part.length);case"z":return fn(-timeZoneOffsetHours,1,!0);case"zz":return fn(-timeZoneOffsetHours,2,!0);case"zzz":return fn(-timeZoneOffsetHours,2,!0)+":"+fn(timeZoneOffsetMinutes,2);case"g":case"gg":return locale.getCustomEra?locale.getCustomEra(date,!1).substr(0,part.length):locale.era;case"G":return locale.getCustomEra?locale.getCustomEra(date,!0):"G";default:return part.replace(/\\\\(.)/g,"$1").replace(/"/g,"")}})).join("")}let patternCache=new Map;function parseDateTimeFormat(pattern,patterns){const cachedResult=patternCache.get(pattern);if(cachedResult)return cachedResult;const currentPattern=(pattern&&"%"===pattern[0]?pattern.replace("%",""):pattern)||"",endsWithPattern=val=>{for(let i=0;i<patterns.length;i++)if(val.endsWith(patterns[i])){if(!(val.length>patterns[i].length&&"\\\\"===val[val.length-1-patterns[i].length]))return patterns[i];{const shortenedPattern=patterns.find((p=>p===patterns[i].substr(1,patterns[i].length-1)));if(shortenedPattern)return shortenedPattern}}return""},splitPatterns=patternPart=>{const p=[];let pat=endsWithPattern(patternPart);for(;pat;)patternPart=patternPart.substr(0,patternPart.length-pat.length),p.push(pat),pat=endsWithPattern(patternPart);return patternPart&&p.push(patternPart),p.reverse(),p},parts=[];let last,previous="",isString=!1;for(let i=0;i<currentPattern.length;i++){if(\'"\'===currentPattern[i]){isString=!isString,isString||(previous+=\'"\'),last=endsWithPattern(previous),last?parts.push(...splitPatterns(previous)):(parts.push(previous),previous=""),isString&&(previous=\'"\');continue}if(isString){previous+=currentPattern[i];continue}const prevPat=endsWithPattern(previous),curPat=endsWithPattern(previous+currentPattern[i]);prevPat&&!curPat&&(parts.push(...splitPatterns(previous)),previous=""),previous+=currentPattern[i]}var key,value;return isString&&previous&&!previous.endsWith(\'"\')&&(previous+=\'"\'),last=endsWithPattern(previous),last?parts.push(...splitPatterns(previous)):previous&&parts.push(previous),key=pattern,value=parts,patternCache.set(key,value),patternCache.size>1e4&&(patternCache=new Map(function(map){const pairs=[];for(let kvp of map)pairs.push([kvp[0],kvp[1]]);return pairs}(patternCache).slice(patternCache.size-1e3))),parts}function toInteger(dirtyNumber){if(null===dirtyNumber||!0===dirtyNumber||!1===dirtyNumber)return NaN;var number=Number(dirtyNumber);return isNaN(number)?number:number<0?Math.ceil(number):Math.floor(number)}function requiredArgs(required,args){if(args.length<required)throw new TypeError(required+" argument"+(required>1?"s":"")+" required, but only "+args.length+" present")}function toDate(argument){requiredArgs(1,arguments);var argStr=Object.prototype.toString.call(argument);return argument instanceof Date||"object"==typeof argument&&"[object Date]"===argStr?new Date(argument.getTime()):"number"==typeof argument||"[object Number]"===argStr?new Date(argument):("string"!=typeof argument&&"[object String]"!==argStr||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn\'t accept strings as date arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule"),console.warn((new Error).stack)),new Date(NaN))}function addDays(dirtyDate,dirtyAmount){requiredArgs(2,arguments);var date=toDate(dirtyDate),amount=toInteger(dirtyAmount);return isNaN(amount)?new Date(NaN):amount?(date.setDate(date.getDate()+amount),date):date}function addMonths(dirtyDate,dirtyAmount){requiredArgs(2,arguments);var date=toDate(dirtyDate),amount=toInteger(dirtyAmount);if(isNaN(amount))return new Date(NaN);if(!amount)return date;var dayOfMonth=date.getDate(),endOfDesiredMonth=new Date(date.getTime());endOfDesiredMonth.setMonth(date.getMonth()+amount+1,0);var daysInMonth=endOfDesiredMonth.getDate();return dayOfMonth>=daysInMonth?endOfDesiredMonth:(date.setFullYear(endOfDesiredMonth.getFullYear(),endOfDesiredMonth.getMonth(),dayOfMonth),date)}function add(dirtyDate,duration){if(requiredArgs(2,arguments),!duration||"object"!=typeof duration)return new Date(NaN);var years=duration.years?toInteger(duration.years):0,months=duration.months?toInteger(duration.months):0,weeks=duration.weeks?toInteger(duration.weeks):0,days=duration.days?toInteger(duration.days):0,hours=duration.hours?toInteger(duration.hours):0,minutes=duration.minutes?toInteger(duration.minutes):0,seconds=duration.seconds?toInteger(duration.seconds):0,date=toDate(dirtyDate),dateWithMonths=months||years?addMonths(date,months+12*years):date,dateWithDays=days||weeks?addDays(dateWithMonths,days+7*weeks):dateWithMonths,minutesToAdd=minutes+60*hours,secondsToAdd=seconds+60*minutesToAdd,msToAdd=1e3*secondsToAdd,finalDate=new Date(dateWithDays.getTime()+msToAdd);return finalDate}function addMilliseconds(dirtyDate,dirtyAmount){requiredArgs(2,arguments);var timestamp=toDate(dirtyDate).getTime(),amount=toInteger(dirtyAmount);return new Date(timestamp+amount)}function startOfWeek(dirtyDate,dirtyOptions){requiredArgs(1,arguments);var options=dirtyOptions||{},locale=options.locale,localeWeekStartsOn=locale&&locale.options&&locale.options.weekStartsOn,defaultWeekStartsOn=null==localeWeekStartsOn?0:toInteger(localeWeekStartsOn),weekStartsOn=null==options.weekStartsOn?defaultWeekStartsOn:toInteger(options.weekStartsOn);if(!(weekStartsOn>=0&&weekStartsOn<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var date=toDate(dirtyDate),day=date.getDay(),diff=(day<weekStartsOn?7:0)+day-weekStartsOn;return date.setDate(date.getDate()-diff),date.setHours(0,0,0,0),date}function getTimezoneOffsetInMilliseconds(date){var utcDate=new Date(Date.UTC(date.getFullYear(),date.getMonth(),date.getDate(),date.getHours(),date.getMinutes(),date.getSeconds(),date.getMilliseconds()));return utcDate.setUTCFullYear(date.getFullYear()),date.getTime()-utcDate.getTime()}function startOfDay(dirtyDate){requiredArgs(1,arguments);var date=toDate(dirtyDate);return date.setHours(0,0,0,0),date}function differenceInCalendarDays(dirtyDateLeft,dirtyDateRight){requiredArgs(2,arguments);var startOfDayLeft=startOfDay(dirtyDateLeft),startOfDayRight=startOfDay(dirtyDateRight),timestampLeft=startOfDayLeft.getTime()-getTimezoneOffsetInMilliseconds(startOfDayLeft),timestampRight=startOfDayRight.getTime()-getTimezoneOffsetInMilliseconds(startOfDayRight);return Math.round((timestampLeft-timestampRight)/864e5)}function compareAsc(dirtyDateLeft,dirtyDateRight){requiredArgs(2,arguments);var dateLeft=toDate(dirtyDateLeft),dateRight=toDate(dirtyDateRight),diff=dateLeft.getTime()-dateRight.getTime();return diff<0?-1:diff>0?1:diff}function isDate$2(value){return requiredArgs(1,arguments),value instanceof Date||"object"==typeof value&&"[object Date]"===Object.prototype.toString.call(value)}function isValid(dirtyDate){if(requiredArgs(1,arguments),!isDate$2(dirtyDate)&&"number"!=typeof dirtyDate)return!1;var date=toDate(dirtyDate);return!isNaN(Number(date))}function differenceInCalendarMonths(dirtyDateLeft,dirtyDateRight){requiredArgs(2,arguments);var dateLeft=toDate(dirtyDateLeft),dateRight=toDate(dirtyDateRight),yearDiff=dateLeft.getFullYear()-dateRight.getFullYear(),monthDiff=dateLeft.getMonth()-dateRight.getMonth();return 12*yearDiff+monthDiff}function getQuarter(dirtyDate){requiredArgs(1,arguments);var date=toDate(dirtyDate),quarter=Math.floor(date.getMonth()/3)+1;return quarter}function differenceInCalendarWeeks(dirtyDateLeft,dirtyDateRight,dirtyOptions){requiredArgs(2,arguments);var startOfWeekLeft=startOfWeek(dirtyDateLeft,dirtyOptions),startOfWeekRight=startOfWeek(dirtyDateRight,dirtyOptions),timestampLeft=startOfWeekLeft.getTime()-getTimezoneOffsetInMilliseconds(startOfWeekLeft),timestampRight=startOfWeekRight.getTime()-getTimezoneOffsetInMilliseconds(startOfWeekRight);return Math.round((timestampLeft-timestampRight)/6048e5)}function differenceInCalendarYears(dirtyDateLeft,dirtyDateRight){requiredArgs(2,arguments);var dateLeft=toDate(dirtyDateLeft),dateRight=toDate(dirtyDateRight);return dateLeft.getFullYear()-dateRight.getFullYear()}function compareLocalAsc(dateLeft,dateRight){var diff=dateLeft.getFullYear()-dateRight.getFullYear()||dateLeft.getMonth()-dateRight.getMonth()||dateLeft.getDate()-dateRight.getDate()||dateLeft.getHours()-dateRight.getHours()||dateLeft.getMinutes()-dateRight.getMinutes()||dateLeft.getSeconds()-dateRight.getSeconds()||dateLeft.getMilliseconds()-dateRight.getMilliseconds();return diff<0?-1:diff>0?1:diff}function differenceInDays(dirtyDateLeft,dirtyDateRight){requiredArgs(2,arguments);var dateLeft=toDate(dirtyDateLeft),dateRight=toDate(dirtyDateRight),sign=compareLocalAsc(dateLeft,dateRight),difference=Math.abs(differenceInCalendarDays(dateLeft,dateRight));dateLeft.setDate(dateLeft.getDate()-sign*difference);var isLastDayNotFull=Number(compareLocalAsc(dateLeft,dateRight)===-sign),result=sign*(difference-isLastDayNotFull);return 0===result?0:result}function differenceInMilliseconds(dateLeft,dateRight){return requiredArgs(2,arguments),toDate(dateLeft).getTime()-toDate(dateRight).getTime()}var roundingMap={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(value){return value<0?Math.ceil(value):Math.floor(value)}};function getRoundingMethod(method){return method?roundingMap[method]:roundingMap.trunc}function endOfDay(dirtyDate){requiredArgs(1,arguments);var date=toDate(dirtyDate);return date.setHours(23,59,59,999),date}function endOfMonth(dirtyDate){requiredArgs(1,arguments);var date=toDate(dirtyDate),month=date.getMonth();return date.setFullYear(date.getFullYear(),month+1,0),date.setHours(23,59,59,999),date}function isLastDayOfMonth(dirtyDate){requiredArgs(1,arguments);var date=toDate(dirtyDate);return endOfDay(date).getTime()===endOfMonth(date).getTime()}function differenceInMonths(dirtyDateLeft,dirtyDateRight){requiredArgs(2,arguments);var result,dateLeft=toDate(dirtyDateLeft),dateRight=toDate(dirtyDateRight),sign=compareAsc(dateLeft,dateRight),difference=Math.abs(differenceInCalendarMonths(dateLeft,dateRight));if(difference<1)result=0;else{1===dateLeft.getMonth()&&dateLeft.getDate()>27&&dateLeft.setDate(30),dateLeft.setMonth(dateLeft.getMonth()-sign*difference);var isLastMonthNotFull=compareAsc(dateLeft,dateRight)===-sign;isLastDayOfMonth(toDate(dirtyDateLeft))&&1===difference&&1===compareAsc(dirtyDateLeft,dateRight)&&(isLastMonthNotFull=!1),result=sign*(difference-Number(isLastMonthNotFull))}return 0===result?0:result}function startOfYear(dirtyDate){requiredArgs(1,arguments);var cleanDate=toDate(dirtyDate),date=new Date(0);return date.setFullYear(cleanDate.getFullYear(),0,1),date.setHours(0,0,0,0),date}var formatDistanceLocale={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function buildFormatLongFn(args){return function(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},width=options.width?String(options.width):args.defaultWidth,format=args.formats[width]||args.formats[args.defaultWidth];return format}}var formatLong={date:buildFormatLongFn({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:buildFormatLongFn({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:buildFormatLongFn({formats:{full:"{{date}} \'at\' {{time}}",long:"{{date}} \'at\' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},formatRelativeLocale={lastWeek:"\'last\' eeee \'at\' p",yesterday:"\'yesterday at\' p",today:"\'today at\' p",tomorrow:"\'tomorrow at\' p",nextWeek:"eeee \'at\' p",other:"P"};function buildLocalizeFn(args){return function(dirtyIndex,dirtyOptions){var valuesArray,options=dirtyOptions||{};if("formatting"===(options.context?String(options.context):"standalone")&&args.formattingValues){var defaultWidth=args.defaultFormattingWidth||args.defaultWidth,width=options.width?String(options.width):defaultWidth;valuesArray=args.formattingValues[width]||args.formattingValues[defaultWidth]}else{var _defaultWidth=args.defaultWidth,_width=options.width?String(options.width):args.defaultWidth;valuesArray=args.values[_width]||args.values[_defaultWidth]}return valuesArray[args.argumentCallback?args.argumentCallback(dirtyIndex):dirtyIndex]}}function buildMatchFn(args){return function(string){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},width=options.width,matchPattern=width&&args.matchPatterns[width]||args.matchPatterns[args.defaultMatchWidth],matchResult=string.match(matchPattern);if(!matchResult)return null;var value,matchedString=matchResult[0],parsePatterns=width&&args.parsePatterns[width]||args.parsePatterns[args.defaultParseWidth],key=Array.isArray(parsePatterns)?findIndex(parsePatterns,(function(pattern){return pattern.test(matchedString)})):findKey(parsePatterns,(function(pattern){return pattern.test(matchedString)}));value=args.valueCallback?args.valueCallback(key):key,value=options.valueCallback?options.valueCallback(value):value;var rest=string.slice(matchedString.length);return{value:value,rest:rest}}}function findKey(object,predicate){for(var key in object)if(object.hasOwnProperty(key)&&predicate(object[key]))return key}function findIndex(array,predicate){for(var key=0;key<array.length;key++)if(predicate(array[key]))return key}var args,locale={code:"en-US",formatDistance:function(token,count,options){var result,tokenValue=formatDistanceLocale[token];return result="string"==typeof tokenValue?tokenValue:1===count?tokenValue.one:tokenValue.other.replace("{{count}}",count.toString()),null!=options&&options.addSuffix?options.comparison&&options.comparison>0?"in "+result:result+" ago":result},formatLong:formatLong,formatRelative:function(token,_date,_baseDate,_options){return formatRelativeLocale[token]},localize:{ordinalNumber:function(dirtyNumber,_options){var number=Number(dirtyNumber),rem100=number%100;if(rem100>20||rem100<10)switch(rem100%10){case 1:return number+"st";case 2:return number+"nd";case 3:return number+"rd"}return number+"th"},era:buildLocalizeFn({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:buildLocalizeFn({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:function(quarter){return quarter-1}}),month:buildLocalizeFn({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:buildLocalizeFn({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:buildLocalizeFn({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:(args={matchPattern:/^(\\d+)(th|st|nd|rd)?/i,parsePattern:/\\d+/i,valueCallback:function(value){return parseInt(value,10)}},function(string){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},matchResult=string.match(args.matchPattern);if(!matchResult)return null;var matchedString=matchResult[0],parseResult=string.match(args.parsePattern);if(!parseResult)return null;var value=args.valueCallback?args.valueCallback(parseResult[0]):parseResult[0];value=options.valueCallback?options.valueCallback(value):value;var rest=string.slice(matchedString.length);return{value:value,rest:rest}}),era:buildMatchFn({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\\.?\\s?c\\.?|b\\.?\\s?c\\.?\\s?e\\.?|a\\.?\\s?d\\.?|c\\.?\\s?e\\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:buildMatchFn({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:function(index){return index+1}}),month:buildMatchFn({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:buildMatchFn({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:buildMatchFn({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\\.?\\s?m\\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}};function subMilliseconds(dirtyDate,dirtyAmount){requiredArgs(2,arguments);var amount=toInteger(dirtyAmount);return addMilliseconds(dirtyDate,-amount)}function startOfUTCISOWeek(dirtyDate){requiredArgs(1,arguments);var weekStartsOn=1,date=toDate(dirtyDate),day=date.getUTCDay(),diff=(day<weekStartsOn?7:0)+day-weekStartsOn;return date.setUTCDate(date.getUTCDate()-diff),date.setUTCHours(0,0,0,0),date}function getUTCISOWeekYear(dirtyDate){requiredArgs(1,arguments);var date=toDate(dirtyDate),year=date.getUTCFullYear(),fourthOfJanuaryOfNextYear=new Date(0);fourthOfJanuaryOfNextYear.setUTCFullYear(year+1,0,4),fourthOfJanuaryOfNextYear.setUTCHours(0,0,0,0);var startOfNextYear=startOfUTCISOWeek(fourthOfJanuaryOfNextYear),fourthOfJanuaryOfThisYear=new Date(0);fourthOfJanuaryOfThisYear.setUTCFullYear(year,0,4),fourthOfJanuaryOfThisYear.setUTCHours(0,0,0,0);var startOfThisYear=startOfUTCISOWeek(fourthOfJanuaryOfThisYear);return date.getTime()>=startOfNextYear.getTime()?year+1:date.getTime()>=startOfThisYear.getTime()?year:year-1}function startOfUTCISOWeekYear(dirtyDate){requiredArgs(1,arguments);var year=getUTCISOWeekYear(dirtyDate),fourthOfJanuary=new Date(0);fourthOfJanuary.setUTCFullYear(year,0,4),fourthOfJanuary.setUTCHours(0,0,0,0);var date=startOfUTCISOWeek(fourthOfJanuary);return date}function getUTCISOWeek(dirtyDate){requiredArgs(1,arguments);var date=toDate(dirtyDate),diff=startOfUTCISOWeek(date).getTime()-startOfUTCISOWeekYear(date).getTime();return Math.round(diff/6048e5)+1}function startOfUTCWeek(dirtyDate,dirtyOptions){requiredArgs(1,arguments);var options=dirtyOptions||{},locale=options.locale,localeWeekStartsOn=locale&&locale.options&&locale.options.weekStartsOn,defaultWeekStartsOn=null==localeWeekStartsOn?0:toInteger(localeWeekStartsOn),weekStartsOn=null==options.weekStartsOn?defaultWeekStartsOn:toInteger(options.weekStartsOn);if(!(weekStartsOn>=0&&weekStartsOn<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var date=toDate(dirtyDate),day=date.getUTCDay(),diff=(day<weekStartsOn?7:0)+day-weekStartsOn;return date.setUTCDate(date.getUTCDate()-diff),date.setUTCHours(0,0,0,0),date}function getUTCWeekYear(dirtyDate,dirtyOptions){requiredArgs(1,arguments);var date=toDate(dirtyDate),year=date.getUTCFullYear(),options=dirtyOptions||{},locale=options.locale,localeFirstWeekContainsDate=locale&&locale.options&&locale.options.firstWeekContainsDate,defaultFirstWeekContainsDate=null==localeFirstWeekContainsDate?1:toInteger(localeFirstWeekContainsDate),firstWeekContainsDate=null==options.firstWeekContainsDate?defaultFirstWeekContainsDate:toInteger(options.firstWeekContainsDate);if(!(firstWeekContainsDate>=1&&firstWeekContainsDate<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var firstWeekOfNextYear=new Date(0);firstWeekOfNextYear.setUTCFullYear(year+1,0,firstWeekContainsDate),firstWeekOfNextYear.setUTCHours(0,0,0,0);var startOfNextYear=startOfUTCWeek(firstWeekOfNextYear,dirtyOptions),firstWeekOfThisYear=new Date(0);firstWeekOfThisYear.setUTCFullYear(year,0,firstWeekContainsDate),firstWeekOfThisYear.setUTCHours(0,0,0,0);var startOfThisYear=startOfUTCWeek(firstWeekOfThisYear,dirtyOptions);return date.getTime()>=startOfNextYear.getTime()?year+1:date.getTime()>=startOfThisYear.getTime()?year:year-1}function startOfUTCWeekYear(dirtyDate,dirtyOptions){requiredArgs(1,arguments);var options=dirtyOptions||{},locale=options.locale,localeFirstWeekContainsDate=locale&&locale.options&&locale.options.firstWeekContainsDate,defaultFirstWeekContainsDate=null==localeFirstWeekContainsDate?1:toInteger(localeFirstWeekContainsDate),firstWeekContainsDate=null==options.firstWeekContainsDate?defaultFirstWeekContainsDate:toInteger(options.firstWeekContainsDate),year=getUTCWeekYear(dirtyDate,dirtyOptions),firstWeek=new Date(0);firstWeek.setUTCFullYear(year,0,firstWeekContainsDate),firstWeek.setUTCHours(0,0,0,0);var date=startOfUTCWeek(firstWeek,dirtyOptions);return date}function getUTCWeek(dirtyDate,options){requiredArgs(1,arguments);var date=toDate(dirtyDate),diff=startOfUTCWeek(date,options).getTime()-startOfUTCWeekYear(date,options).getTime();return Math.round(diff/6048e5)+1}function addLeadingZeros(number,targetLength){for(var sign=number<0?"-":"",output=Math.abs(number).toString();output.length<targetLength;)output="0"+output;return sign+output}var formatters$2_y=function(date,token){var signedYear=date.getUTCFullYear(),year=signedYear>0?signedYear:1-signedYear;return addLeadingZeros("yy"===token?year%100:year,token.length)},formatters$2_M=function(date,token){var month=date.getUTCMonth();return"M"===token?String(month+1):addLeadingZeros(month+1,2)},formatters$2_d=function(date,token){return addLeadingZeros(date.getUTCDate(),token.length)},formatters$2_h=function(date,token){return addLeadingZeros(date.getUTCHours()%12||12,token.length)},formatters$2_H=function(date,token){return addLeadingZeros(date.getUTCHours(),token.length)},formatters$2_m=function(date,token){return addLeadingZeros(date.getUTCMinutes(),token.length)},formatters$2_s=function(date,token){return addLeadingZeros(date.getUTCSeconds(),token.length)},formatters$2_S=function(date,token){var numberOfDigits=token.length,milliseconds=date.getUTCMilliseconds();return addLeadingZeros(Math.floor(milliseconds*Math.pow(10,numberOfDigits-3)),token.length)},dayPeriodEnum_midnight="midnight",dayPeriodEnum_noon="noon",dayPeriodEnum_morning="morning",dayPeriodEnum_afternoon="afternoon",dayPeriodEnum_evening="evening",dayPeriodEnum_night="night",formatters$1={G:function(date,token,localize){var era=date.getUTCFullYear()>0?1:0;switch(token){case"G":case"GG":case"GGG":return localize.era(era,{width:"abbreviated"});case"GGGGG":return localize.era(era,{width:"narrow"});case"GGGG":default:return localize.era(era,{width:"wide"})}},y:function(date,token,localize){if("yo"===token){var signedYear=date.getUTCFullYear(),year=signedYear>0?signedYear:1-signedYear;return localize.ordinalNumber(year,{unit:"year"})}return formatters$2_y(date,token)},Y:function(date,token,localize,options){var signedWeekYear=getUTCWeekYear(date,options),weekYear=signedWeekYear>0?signedWeekYear:1-signedWeekYear;return"YY"===token?addLeadingZeros(weekYear%100,2):"Yo"===token?localize.ordinalNumber(weekYear,{unit:"year"}):addLeadingZeros(weekYear,token.length)},R:function(date,token){return addLeadingZeros(getUTCISOWeekYear(date),token.length)},u:function(date,token){return addLeadingZeros(date.getUTCFullYear(),token.length)},Q:function(date,token,localize){var quarter=Math.ceil((date.getUTCMonth()+1)/3);switch(token){case"Q":return String(quarter);case"QQ":return addLeadingZeros(quarter,2);case"Qo":return localize.ordinalNumber(quarter,{unit:"quarter"});case"QQQ":return localize.quarter(quarter,{width:"abbreviated",context:"formatting"});case"QQQQQ":return localize.quarter(quarter,{width:"narrow",context:"formatting"});case"QQQQ":default:return localize.quarter(quarter,{width:"wide",context:"formatting"})}},q:function(date,token,localize){var quarter=Math.ceil((date.getUTCMonth()+1)/3);switch(token){case"q":return String(quarter);case"qq":return addLeadingZeros(quarter,2);case"qo":return localize.ordinalNumber(quarter,{unit:"quarter"});case"qqq":return localize.quarter(quarter,{width:"abbreviated",context:"standalone"});case"qqqqq":return localize.quarter(quarter,{width:"narrow",context:"standalone"});case"qqqq":default:return localize.quarter(quarter,{width:"wide",context:"standalone"})}},M:function(date,token,localize){var month=date.getUTCMonth();switch(token){case"M":case"MM":return formatters$2_M(date,token);case"Mo":return localize.ordinalNumber(month+1,{unit:"month"});case"MMM":return localize.month(month,{width:"abbreviated",context:"formatting"});case"MMMMM":return localize.month(month,{width:"narrow",context:"formatting"});case"MMMM":default:return localize.month(month,{width:"wide",context:"formatting"})}},L:function(date,token,localize){var month=date.getUTCMonth();switch(token){case"L":return String(month+1);case"LL":return addLeadingZeros(month+1,2);case"Lo":return localize.ordinalNumber(month+1,{unit:"month"});case"LLL":return localize.month(month,{width:"abbreviated",context:"standalone"});case"LLLLL":return localize.month(month,{width:"narrow",context:"standalone"});case"LLLL":default:return localize.month(month,{width:"wide",context:"standalone"})}},w:function(date,token,localize,options){var week=getUTCWeek(date,options);return"wo"===token?localize.ordinalNumber(week,{unit:"week"}):addLeadingZeros(week,token.length)},I:function(date,token,localize){var isoWeek=getUTCISOWeek(date);return"Io"===token?localize.ordinalNumber(isoWeek,{unit:"week"}):addLeadingZeros(isoWeek,token.length)},d:function(date,token,localize){return"do"===token?localize.ordinalNumber(date.getUTCDate(),{unit:"date"}):formatters$2_d(date,token)},D:function(date,token,localize){var dayOfYear=function(dirtyDate){requiredArgs(1,arguments);var date=toDate(dirtyDate),timestamp=date.getTime();date.setUTCMonth(0,1),date.setUTCHours(0,0,0,0);var startOfYearTimestamp=date.getTime(),difference=timestamp-startOfYearTimestamp;return Math.floor(difference/864e5)+1}(date);return"Do"===token?localize.ordinalNumber(dayOfYear,{unit:"dayOfYear"}):addLeadingZeros(dayOfYear,token.length)},E:function(date,token,localize){var dayOfWeek=date.getUTCDay();switch(token){case"E":case"EE":case"EEE":return localize.day(dayOfWeek,{width:"abbreviated",context:"formatting"});case"EEEEE":return localize.day(dayOfWeek,{width:"narrow",context:"formatting"});case"EEEEEE":return localize.day(dayOfWeek,{width:"short",context:"formatting"});case"EEEE":default:return localize.day(dayOfWeek,{width:"wide",context:"formatting"})}},e:function(date,token,localize,options){var dayOfWeek=date.getUTCDay(),localDayOfWeek=(dayOfWeek-options.weekStartsOn+8)%7||7;switch(token){case"e":return String(localDayOfWeek);case"ee":return addLeadingZeros(localDayOfWeek,2);case"eo":return localize.ordinalNumber(localDayOfWeek,{unit:"day"});case"eee":return localize.day(dayOfWeek,{width:"abbreviated",context:"formatting"});case"eeeee":return localize.day(dayOfWeek,{width:"narrow",context:"formatting"});case"eeeeee":return localize.day(dayOfWeek,{width:"short",context:"formatting"});case"eeee":default:return localize.day(dayOfWeek,{width:"wide",context:"formatting"})}},c:function(date,token,localize,options){var dayOfWeek=date.getUTCDay(),localDayOfWeek=(dayOfWeek-options.weekStartsOn+8)%7||7;switch(token){case"c":return String(localDayOfWeek);case"cc":return addLeadingZeros(localDayOfWeek,token.length);case"co":return localize.ordinalNumber(localDayOfWeek,{unit:"day"});case"ccc":return localize.day(dayOfWeek,{width:"abbreviated",context:"standalone"});case"ccccc":return localize.day(dayOfWeek,{width:"narrow",context:"standalone"});case"cccccc":return localize.day(dayOfWeek,{width:"short",context:"standalone"});case"cccc":default:return localize.day(dayOfWeek,{width:"wide",context:"standalone"})}},i:function(date,token,localize){var dayOfWeek=date.getUTCDay(),isoDayOfWeek=0===dayOfWeek?7:dayOfWeek;switch(token){case"i":return String(isoDayOfWeek);case"ii":return addLeadingZeros(isoDayOfWeek,token.length);case"io":return localize.ordinalNumber(isoDayOfWeek,{unit:"day"});case"iii":return localize.day(dayOfWeek,{width:"abbreviated",context:"formatting"});case"iiiii":return localize.day(dayOfWeek,{width:"narrow",context:"formatting"});case"iiiiii":return localize.day(dayOfWeek,{width:"short",context:"formatting"});case"iiii":default:return localize.day(dayOfWeek,{width:"wide",context:"formatting"})}},a:function(date,token,localize){var dayPeriodEnumValue=date.getUTCHours()/12>=1?"pm":"am";switch(token){case"a":case"aa":return localize.dayPeriod(dayPeriodEnumValue,{width:"abbreviated",context:"formatting"});case"aaa":return localize.dayPeriod(dayPeriodEnumValue,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return localize.dayPeriod(dayPeriodEnumValue,{width:"narrow",context:"formatting"});case"aaaa":default:return localize.dayPeriod(dayPeriodEnumValue,{width:"wide",context:"formatting"})}},b:function(date,token,localize){var dayPeriodEnumValue,hours=date.getUTCHours();switch(dayPeriodEnumValue=12===hours?dayPeriodEnum_noon:0===hours?dayPeriodEnum_midnight:hours/12>=1?"pm":"am",token){case"b":case"bb":return localize.dayPeriod(dayPeriodEnumValue,{width:"abbreviated",context:"formatting"});case"bbb":return localize.dayPeriod(dayPeriodEnumValue,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return localize.dayPeriod(dayPeriodEnumValue,{width:"narrow",context:"formatting"});case"bbbb":default:return localize.dayPeriod(dayPeriodEnumValue,{width:"wide",context:"formatting"})}},B:function(date,token,localize){var dayPeriodEnumValue,hours=date.getUTCHours();switch(dayPeriodEnumValue=hours>=17?dayPeriodEnum_evening:hours>=12?dayPeriodEnum_afternoon:hours>=4?dayPeriodEnum_morning:dayPeriodEnum_night,token){case"B":case"BB":case"BBB":return localize.dayPeriod(dayPeriodEnumValue,{width:"abbreviated",context:"formatting"});case"BBBBB":return localize.dayPeriod(dayPeriodEnumValue,{width:"narrow",context:"formatting"});case"BBBB":default:return localize.dayPeriod(dayPeriodEnumValue,{width:"wide",context:"formatting"})}},h:function(date,token,localize){if("ho"===token){var hours=date.getUTCHours()%12;return 0===hours&&(hours=12),localize.ordinalNumber(hours,{unit:"hour"})}return formatters$2_h(date,token)},H:function(date,token,localize){return"Ho"===token?localize.ordinalNumber(date.getUTCHours(),{unit:"hour"}):formatters$2_H(date,token)},K:function(date,token,localize){var hours=date.getUTCHours()%12;return"Ko"===token?localize.ordinalNumber(hours,{unit:"hour"}):addLeadingZeros(hours,token.length)},k:function(date,token,localize){var hours=date.getUTCHours();return 0===hours&&(hours=24),"ko"===token?localize.ordinalNumber(hours,{unit:"hour"}):addLeadingZeros(hours,token.length)},m:function(date,token,localize){return"mo"===token?localize.ordinalNumber(date.getUTCMinutes(),{unit:"minute"}):formatters$2_m(date,token)},s:function(date,token,localize){return"so"===token?localize.ordinalNumber(date.getUTCSeconds(),{unit:"second"}):formatters$2_s(date,token)},S:function(date,token){return formatters$2_S(date,token)},X:function(date,token,_localize,options){var timezoneOffset=(options._originalDate||date).getTimezoneOffset();if(0===timezoneOffset)return"Z";switch(token){case"X":return formatTimezoneWithOptionalMinutes(timezoneOffset);case"XXXX":case"XX":return formatTimezone(timezoneOffset);case"XXXXX":case"XXX":default:return formatTimezone(timezoneOffset,":")}},x:function(date,token,_localize,options){var timezoneOffset=(options._originalDate||date).getTimezoneOffset();switch(token){case"x":return formatTimezoneWithOptionalMinutes(timezoneOffset);case"xxxx":case"xx":return formatTimezone(timezoneOffset);case"xxxxx":case"xxx":default:return formatTimezone(timezoneOffset,":")}},O:function(date,token,_localize,options){var timezoneOffset=(options._originalDate||date).getTimezoneOffset();switch(token){case"O":case"OO":case"OOO":return"GMT"+formatTimezoneShort(timezoneOffset,":");case"OOOO":default:return"GMT"+formatTimezone(timezoneOffset,":")}},z:function(date,token,_localize,options){var timezoneOffset=(options._originalDate||date).getTimezoneOffset();switch(token){case"z":case"zz":case"zzz":return"GMT"+formatTimezoneShort(timezoneOffset,":");case"zzzz":default:return"GMT"+formatTimezone(timezoneOffset,":")}},t:function(date,token,_localize,options){var originalDate=options._originalDate||date;return addLeadingZeros(Math.floor(originalDate.getTime()/1e3),token.length)},T:function(date,token,_localize,options){return addLeadingZeros((options._originalDate||date).getTime(),token.length)}};function formatTimezoneShort(offset,dirtyDelimiter){var sign=offset>0?"-":"+",absOffset=Math.abs(offset),hours=Math.floor(absOffset/60),minutes=absOffset%60;if(0===minutes)return sign+String(hours);var delimiter=dirtyDelimiter||"";return sign+String(hours)+delimiter+addLeadingZeros(minutes,2)}function formatTimezoneWithOptionalMinutes(offset,dirtyDelimiter){return offset%60==0?(offset>0?"-":"+")+addLeadingZeros(Math.abs(offset)/60,2):formatTimezone(offset,dirtyDelimiter)}function formatTimezone(offset,dirtyDelimiter){var delimiter=dirtyDelimiter||"",sign=offset>0?"-":"+",absOffset=Math.abs(offset);return sign+addLeadingZeros(Math.floor(absOffset/60),2)+delimiter+addLeadingZeros(absOffset%60,2)}function dateLongFormatter(pattern,formatLong){switch(pattern){case"P":return formatLong.date({width:"short"});case"PP":return formatLong.date({width:"medium"});case"PPP":return formatLong.date({width:"long"});case"PPPP":default:return formatLong.date({width:"full"})}}function timeLongFormatter(pattern,formatLong){switch(pattern){case"p":return formatLong.time({width:"short"});case"pp":return formatLong.time({width:"medium"});case"ppp":return formatLong.time({width:"long"});case"pppp":default:return formatLong.time({width:"full"})}}var longFormatters={p:timeLongFormatter,P:function(pattern,formatLong){var dateTimeFormat,matchResult=pattern.match(/(P+)(p+)?/)||[],datePattern=matchResult[1],timePattern=matchResult[2];if(!timePattern)return dateLongFormatter(pattern,formatLong);switch(datePattern){case"P":dateTimeFormat=formatLong.dateTime({width:"short"});break;case"PP":dateTimeFormat=formatLong.dateTime({width:"medium"});break;case"PPP":dateTimeFormat=formatLong.dateTime({width:"long"});break;case"PPPP":default:dateTimeFormat=formatLong.dateTime({width:"full"})}return dateTimeFormat.replace("{{date}}",dateLongFormatter(datePattern,formatLong)).replace("{{time}}",timeLongFormatter(timePattern,formatLong))}},protectedDayOfYearTokens=["D","DD"],protectedWeekYearTokens=["YY","YYYY"];function isProtectedDayOfYearToken(token){return-1!==protectedDayOfYearTokens.indexOf(token)}function isProtectedWeekYearToken(token){return-1!==protectedWeekYearTokens.indexOf(token)}function throwProtectedError(token,format,input){if("YYYY"===token)throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(format,"`) for formatting years to the input `").concat(input,"`; see: https://git.io/fxCyr"));if("YY"===token)throw new RangeError("Use `yy` instead of `YY` (in `".concat(format,"`) for formatting years to the input `").concat(input,"`; see: https://git.io/fxCyr"));if("D"===token)throw new RangeError("Use `d` instead of `D` (in `".concat(format,"`) for formatting days of the month to the input `").concat(input,"`; see: https://git.io/fxCyr"));if("DD"===token)throw new RangeError("Use `dd` instead of `DD` (in `".concat(format,"`) for formatting days of the month to the input `").concat(input,"`; see: https://git.io/fxCyr"))}var formattingTokensRegExp$1=/[yYQqMLwIdDecihHKkms]o|(\\w)\\1*|\'\'|\'(\'\'|[^\'])+(\'|$)|./g,longFormattingTokensRegExp$1=/P+p+|P+|p+|\'\'|\'(\'\'|[^\'])+(\'|$)|./g,escapedStringRegExp$1=/^\'([^]*?)\'?$/,doubleQuoteRegExp$1=/\'\'/g,unescapedLatinCharacterRegExp$1=/[a-zA-Z]/;function cleanEscapedString$1(input){return input.match(escapedStringRegExp$1)[1].replace(doubleQuoteRegExp$1,"\'")}function assign(target,dirtyObject){if(null==target)throw new TypeError("assign requires that input parameter not be null or undefined");for(var property in dirtyObject=dirtyObject||{})Object.prototype.hasOwnProperty.call(dirtyObject,property)&&(target[property]=dirtyObject[property]);return target}function getDate(dirtyDate){requiredArgs(1,arguments);var date=toDate(dirtyDate),dayOfMonth=date.getDate();return dayOfMonth}function getHours(dirtyDate){requiredArgs(1,arguments);var date=toDate(dirtyDate),hours=date.getHours();return hours}function getMinutes(dirtyDate){requiredArgs(1,arguments);var date=toDate(dirtyDate),minutes=date.getMinutes();return minutes}function getMonth(dirtyDate){requiredArgs(1,arguments);var date=toDate(dirtyDate),month=date.getMonth();return month}function getSeconds(dirtyDate){requiredArgs(1,arguments);var date=toDate(dirtyDate),seconds=date.getSeconds();return seconds}function getWeekYear(dirtyDate,options){var _options$locale,_options$locale$optio;requiredArgs(1,arguments);var date=toDate(dirtyDate),year=date.getFullYear(),localeFirstWeekContainsDate=null==options||null===(_options$locale=options.locale)||void 0===_options$locale||null===(_options$locale$optio=_options$locale.options)||void 0===_options$locale$optio?void 0:_options$locale$optio.firstWeekContainsDate,defaultFirstWeekContainsDate=null==localeFirstWeekContainsDate?1:toInteger(localeFirstWeekContainsDate),firstWeekContainsDate=null==(null==options?void 0:options.firstWeekContainsDate)?defaultFirstWeekContainsDate:toInteger(options.firstWeekContainsDate);if(!(firstWeekContainsDate>=1&&firstWeekContainsDate<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var firstWeekOfNextYear=new Date(0);firstWeekOfNextYear.setFullYear(year+1,0,firstWeekContainsDate),firstWeekOfNextYear.setHours(0,0,0,0);var startOfNextYear=startOfWeek(firstWeekOfNextYear,options),firstWeekOfThisYear=new Date(0);firstWeekOfThisYear.setFullYear(year,0,firstWeekContainsDate),firstWeekOfThisYear.setHours(0,0,0,0);var startOfThisYear=startOfWeek(firstWeekOfThisYear,options);return date.getTime()>=startOfNextYear.getTime()?year+1:date.getTime()>=startOfThisYear.getTime()?year:year-1}function startOfWeekYear(dirtyDate,dirtyOptions){requiredArgs(1,arguments);var options=dirtyOptions||{},locale=options.locale,localeFirstWeekContainsDate=locale&&locale.options&&locale.options.firstWeekContainsDate,defaultFirstWeekContainsDate=null==localeFirstWeekContainsDate?1:toInteger(localeFirstWeekContainsDate),firstWeekContainsDate=null==options.firstWeekContainsDate?defaultFirstWeekContainsDate:toInteger(options.firstWeekContainsDate),year=getWeekYear(dirtyDate,dirtyOptions),firstWeek=new Date(0);firstWeek.setFullYear(year,0,firstWeekContainsDate),firstWeek.setHours(0,0,0,0);var date=startOfWeek(firstWeek,dirtyOptions);return date}function getYear(dirtyDate){return requiredArgs(1,arguments),toDate(dirtyDate).getFullYear()}function isAfter(dirtyDate,dirtyDateToCompare){requiredArgs(2,arguments);var date=toDate(dirtyDate),dateToCompare=toDate(dirtyDateToCompare);return date.getTime()>dateToCompare.getTime()}function setUTCDay(dirtyDate,dirtyDay,dirtyOptions){requiredArgs(2,arguments);var options=dirtyOptions||{},locale=options.locale,localeWeekStartsOn=locale&&locale.options&&locale.options.weekStartsOn,defaultWeekStartsOn=null==localeWeekStartsOn?0:toInteger(localeWeekStartsOn),weekStartsOn=null==options.weekStartsOn?defaultWeekStartsOn:toInteger(options.weekStartsOn);if(!(weekStartsOn>=0&&weekStartsOn<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var date=toDate(dirtyDate),day=toInteger(dirtyDay),currentDay=date.getUTCDay(),remainder=day%7,dayIndex=(remainder+7)%7,diff=(dayIndex<weekStartsOn?7:0)+day-currentDay;return date.setUTCDate(date.getUTCDate()+diff),date}var numericPatterns_month=/^(1[0-2]|0?\\d)/,numericPatterns_date=/^(3[0-1]|[0-2]?\\d)/,numericPatterns_dayOfYear=/^(36[0-6]|3[0-5]\\d|[0-2]?\\d?\\d)/,numericPatterns_week=/^(5[0-3]|[0-4]?\\d)/,numericPatterns_hour23h=/^(2[0-3]|[0-1]?\\d)/,numericPatterns_hour24h=/^(2[0-4]|[0-1]?\\d)/,numericPatterns_hour11h=/^(1[0-1]|0?\\d)/,numericPatterns_hour12h=/^(1[0-2]|0?\\d)/,numericPatterns_minute=/^[0-5]?\\d/,numericPatterns_second=/^[0-5]?\\d/,numericPatterns_singleDigit=/^\\d/,numericPatterns_twoDigits=/^\\d{1,2}/,numericPatterns_threeDigits=/^\\d{1,3}/,numericPatterns_fourDigits=/^\\d{1,4}/,numericPatterns_anyDigitsSigned=/^-?\\d+/,numericPatterns_singleDigitSigned=/^-?\\d/,numericPatterns_twoDigitsSigned=/^-?\\d{1,2}/,numericPatterns_threeDigitsSigned=/^-?\\d{1,3}/,numericPatterns_fourDigitsSigned=/^-?\\d{1,4}/,timezonePatterns_basicOptionalMinutes=/^([+-])(\\d{2})(\\d{2})?|Z/,timezonePatterns_basic=/^([+-])(\\d{2})(\\d{2})|Z/,timezonePatterns_basicOptionalSeconds=/^([+-])(\\d{2})(\\d{2})((\\d{2}))?|Z/,timezonePatterns_extended=/^([+-])(\\d{2}):(\\d{2})|Z/,timezonePatterns_extendedOptionalSeconds=/^([+-])(\\d{2}):(\\d{2})(:(\\d{2}))?|Z/;function parseNumericPattern(pattern,string,valueCallback){var matchResult=string.match(pattern);if(!matchResult)return null;var value=parseInt(matchResult[0],10);return{value:valueCallback?valueCallback(value):value,rest:string.slice(matchResult[0].length)}}function parseTimezonePattern(pattern,string){var matchResult=string.match(pattern);return matchResult?"Z"===matchResult[0]?{value:0,rest:string.slice(1)}:{value:("+"===matchResult[1]?1:-1)*(36e5*(matchResult[2]?parseInt(matchResult[2],10):0)+6e4*(matchResult[3]?parseInt(matchResult[3],10):0)+1e3*(matchResult[5]?parseInt(matchResult[5],10):0)),rest:string.slice(matchResult[0].length)}:null}function parseAnyDigitsSigned(string,valueCallback){return parseNumericPattern(numericPatterns_anyDigitsSigned,string,valueCallback)}function parseNDigits(n,string,valueCallback){switch(n){case 1:return parseNumericPattern(numericPatterns_singleDigit,string,valueCallback);case 2:return parseNumericPattern(numericPatterns_twoDigits,string,valueCallback);case 3:return parseNumericPattern(numericPatterns_threeDigits,string,valueCallback);case 4:return parseNumericPattern(numericPatterns_fourDigits,string,valueCallback);default:return parseNumericPattern(new RegExp("^\\\\d{1,"+n+"}"),string,valueCallback)}}function parseNDigitsSigned(n,string,valueCallback){switch(n){case 1:return parseNumericPattern(numericPatterns_singleDigitSigned,string,valueCallback);case 2:return parseNumericPattern(numericPatterns_twoDigitsSigned,string,valueCallback);case 3:return parseNumericPattern(numericPatterns_threeDigitsSigned,string,valueCallback);case 4:return parseNumericPattern(numericPatterns_fourDigitsSigned,string,valueCallback);default:return parseNumericPattern(new RegExp("^-?\\\\d{1,"+n+"}"),string,valueCallback)}}function dayPeriodEnumToHours(enumValue){switch(enumValue){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function normalizeTwoDigitYear(twoDigitYear,currentYear){var result,isCommonEra=currentYear>0,absCurrentYear=isCommonEra?currentYear:1-currentYear;if(absCurrentYear<=50)result=twoDigitYear||100;else{var rangeEnd=absCurrentYear+50;result=twoDigitYear+100*Math.floor(rangeEnd/100)-(twoDigitYear>=rangeEnd%100?100:0)}return isCommonEra?result:1-result}var DAYS_IN_MONTH=[31,28,31,30,31,30,31,31,30,31,30,31],DAYS_IN_MONTH_LEAP_YEAR=[31,29,31,30,31,30,31,31,30,31,30,31];function isLeapYearIndex$1(year){return year%400==0||year%4==0&&year%100!=0}var parsers={G:{priority:140,parse:function(string,token,match,_options){switch(token){case"G":case"GG":case"GGG":return match.era(string,{width:"abbreviated"})||match.era(string,{width:"narrow"});case"GGGGG":return match.era(string,{width:"narrow"});case"GGGG":default:return match.era(string,{width:"wide"})||match.era(string,{width:"abbreviated"})||match.era(string,{width:"narrow"})}},set:function(date,flags,value,_options){return flags.era=value,date.setUTCFullYear(value,0,1),date.setUTCHours(0,0,0,0),date},incompatibleTokens:["R","u","t","T"]},y:{priority:130,parse:function(string,token,match,_options){var valueCallback=function(year){return{year:year,isTwoDigitYear:"yy"===token}};switch(token){case"y":return parseNDigits(4,string,valueCallback);case"yo":return match.ordinalNumber(string,{unit:"year",valueCallback:valueCallback});default:return parseNDigits(token.length,string,valueCallback)}},validate:function(_date,value,_options){return value.isTwoDigitYear||value.year>0},set:function(date,flags,value,_options){var currentYear=date.getUTCFullYear();if(value.isTwoDigitYear){var normalizedTwoDigitYear=normalizeTwoDigitYear(value.year,currentYear);return date.setUTCFullYear(normalizedTwoDigitYear,0,1),date.setUTCHours(0,0,0,0),date}var year="era"in flags&&1!==flags.era?1-value.year:value.year;return date.setUTCFullYear(year,0,1),date.setUTCHours(0,0,0,0),date},incompatibleTokens:["Y","R","u","w","I","i","e","c","t","T"]},Y:{priority:130,parse:function(string,token,match,_options){var valueCallback=function(year){return{year:year,isTwoDigitYear:"YY"===token}};switch(token){case"Y":return parseNDigits(4,string,valueCallback);case"Yo":return match.ordinalNumber(string,{unit:"year",valueCallback:valueCallback});default:return parseNDigits(token.length,string,valueCallback)}},validate:function(_date,value,_options){return value.isTwoDigitYear||value.year>0},set:function(date,flags,value,options){var currentYear=getUTCWeekYear(date,options);if(value.isTwoDigitYear){var normalizedTwoDigitYear=normalizeTwoDigitYear(value.year,currentYear);return date.setUTCFullYear(normalizedTwoDigitYear,0,options.firstWeekContainsDate),date.setUTCHours(0,0,0,0),startOfUTCWeek(date,options)}var year="era"in flags&&1!==flags.era?1-value.year:value.year;return date.setUTCFullYear(year,0,options.firstWeekContainsDate),date.setUTCHours(0,0,0,0),startOfUTCWeek(date,options)},incompatibleTokens:["y","R","u","Q","q","M","L","I","d","D","i","t","T"]},R:{priority:130,parse:function(string,token,_match,_options){return parseNDigitsSigned("R"===token?4:token.length,string)},set:function(_date,_flags,value,_options){var firstWeekOfYear=new Date(0);return firstWeekOfYear.setUTCFullYear(value,0,4),firstWeekOfYear.setUTCHours(0,0,0,0),startOfUTCISOWeek(firstWeekOfYear)},incompatibleTokens:["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]},u:{priority:130,parse:function(string,token,_match,_options){return parseNDigitsSigned("u"===token?4:token.length,string)},set:function(date,_flags,value,_options){return date.setUTCFullYear(value,0,1),date.setUTCHours(0,0,0,0),date},incompatibleTokens:["G","y","Y","R","w","I","i","e","c","t","T"]},Q:{priority:120,parse:function(string,token,match,_options){switch(token){case"Q":case"QQ":return parseNDigits(token.length,string);case"Qo":return match.ordinalNumber(string,{unit:"quarter"});case"QQQ":return match.quarter(string,{width:"abbreviated",context:"formatting"})||match.quarter(string,{width:"narrow",context:"formatting"});case"QQQQQ":return match.quarter(string,{width:"narrow",context:"formatting"});case"QQQQ":default:return match.quarter(string,{width:"wide",context:"formatting"})||match.quarter(string,{width:"abbreviated",context:"formatting"})||match.quarter(string,{width:"narrow",context:"formatting"})}},validate:function(_date,value,_options){return value>=1&&value<=4},set:function(date,_flags,value,_options){return date.setUTCMonth(3*(value-1),1),date.setUTCHours(0,0,0,0),date},incompatibleTokens:["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]},q:{priority:120,parse:function(string,token,match,_options){switch(token){case"q":case"qq":return parseNDigits(token.length,string);case"qo":return match.ordinalNumber(string,{unit:"quarter"});case"qqq":return match.quarter(string,{width:"abbreviated",context:"standalone"})||match.quarter(string,{width:"narrow",context:"standalone"});case"qqqqq":return match.quarter(string,{width:"narrow",context:"standalone"});case"qqqq":default:return match.quarter(string,{width:"wide",context:"standalone"})||match.quarter(string,{width:"abbreviated",context:"standalone"})||match.quarter(string,{width:"narrow",context:"standalone"})}},validate:function(_date,value,_options){return value>=1&&value<=4},set:function(date,_flags,value,_options){return date.setUTCMonth(3*(value-1),1),date.setUTCHours(0,0,0,0),date},incompatibleTokens:["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]},M:{priority:110,parse:function(string,token,match,_options){var valueCallback=function(value){return value-1};switch(token){case"M":return parseNumericPattern(numericPatterns_month,string,valueCallback);case"MM":return parseNDigits(2,string,valueCallback);case"Mo":return match.ordinalNumber(string,{unit:"month",valueCallback:valueCallback});case"MMM":return match.month(string,{width:"abbreviated",context:"formatting"})||match.month(string,{width:"narrow",context:"formatting"});case"MMMMM":return match.month(string,{width:"narrow",context:"formatting"});case"MMMM":default:return match.month(string,{width:"wide",context:"formatting"})||match.month(string,{width:"abbreviated",context:"formatting"})||match.month(string,{width:"narrow",context:"formatting"})}},validate:function(_date,value,_options){return value>=0&&value<=11},set:function(date,_flags,value,_options){return date.setUTCMonth(value,1),date.setUTCHours(0,0,0,0),date},incompatibleTokens:["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]},L:{priority:110,parse:function(string,token,match,_options){var valueCallback=function(value){return value-1};switch(token){case"L":return parseNumericPattern(numericPatterns_month,string,valueCallback);case"LL":return parseNDigits(2,string,valueCallback);case"Lo":return match.ordinalNumber(string,{unit:"month",valueCallback:valueCallback});case"LLL":return match.month(string,{width:"abbreviated",context:"standalone"})||match.month(string,{width:"narrow",context:"standalone"});case"LLLLL":return match.month(string,{width:"narrow",context:"standalone"});case"LLLL":default:return match.month(string,{width:"wide",context:"standalone"})||match.month(string,{width:"abbreviated",context:"standalone"})||match.month(string,{width:"narrow",context:"standalone"})}},validate:function(_date,value,_options){return value>=0&&value<=11},set:function(date,_flags,value,_options){return date.setUTCMonth(value,1),date.setUTCHours(0,0,0,0),date},incompatibleTokens:["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]},w:{priority:100,parse:function(string,token,match,_options){switch(token){case"w":return parseNumericPattern(numericPatterns_week,string);case"wo":return match.ordinalNumber(string,{unit:"week"});default:return parseNDigits(token.length,string)}},validate:function(_date,value,_options){return value>=1&&value<=53},set:function(date,_flags,value,options){return startOfUTCWeek(function(dirtyDate,dirtyWeek,options){requiredArgs(2,arguments);var date=toDate(dirtyDate),week=toInteger(dirtyWeek),diff=getUTCWeek(date,options)-week;return date.setUTCDate(date.getUTCDate()-7*diff),date}(date,value,options),options)},incompatibleTokens:["y","R","u","q","Q","M","L","I","d","D","i","t","T"]},I:{priority:100,parse:function(string,token,match,_options){switch(token){case"I":return parseNumericPattern(numericPatterns_week,string);case"Io":return match.ordinalNumber(string,{unit:"week"});default:return parseNDigits(token.length,string)}},validate:function(_date,value,_options){return value>=1&&value<=53},set:function(date,_flags,value,options){return startOfUTCISOWeek(function(dirtyDate,dirtyISOWeek){requiredArgs(2,arguments);var date=toDate(dirtyDate),isoWeek=toInteger(dirtyISOWeek),diff=getUTCISOWeek(date)-isoWeek;return date.setUTCDate(date.getUTCDate()-7*diff),date}(date,value,options),options)},incompatibleTokens:["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]},d:{priority:90,subPriority:1,parse:function(string,token,match,_options){switch(token){case"d":return parseNumericPattern(numericPatterns_date,string);case"do":return match.ordinalNumber(string,{unit:"date"});default:return parseNDigits(token.length,string)}},validate:function(date,value,_options){var isLeapYear=isLeapYearIndex$1(date.getUTCFullYear()),month=date.getUTCMonth();return isLeapYear?value>=1&&value<=DAYS_IN_MONTH_LEAP_YEAR[month]:value>=1&&value<=DAYS_IN_MONTH[month]},set:function(date,_flags,value,_options){return date.setUTCDate(value),date.setUTCHours(0,0,0,0),date},incompatibleTokens:["Y","R","q","Q","w","I","D","i","e","c","t","T"]},D:{priority:90,subPriority:1,parse:function(string,token,match,_options){switch(token){case"D":case"DD":return parseNumericPattern(numericPatterns_dayOfYear,string);case"Do":return match.ordinalNumber(string,{unit:"date"});default:return parseNDigits(token.length,string)}},validate:function(date,value,_options){return isLeapYearIndex$1(date.getUTCFullYear())?value>=1&&value<=366:value>=1&&value<=365},set:function(date,_flags,value,_options){return date.setUTCMonth(0,value),date.setUTCHours(0,0,0,0),date},incompatibleTokens:["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]},E:{priority:90,parse:function(string,token,match,_options){switch(token){case"E":case"EE":case"EEE":return match.day(string,{width:"abbreviated",context:"formatting"})||match.day(string,{width:"short",context:"formatting"})||match.day(string,{width:"narrow",context:"formatting"});case"EEEEE":return match.day(string,{width:"narrow",context:"formatting"});case"EEEEEE":return match.day(string,{width:"short",context:"formatting"})||match.day(string,{width:"narrow",context:"formatting"});case"EEEE":default:return match.day(string,{width:"wide",context:"formatting"})||match.day(string,{width:"abbreviated",context:"formatting"})||match.day(string,{width:"short",context:"formatting"})||match.day(string,{width:"narrow",context:"formatting"})}},validate:function(_date,value,_options){return value>=0&&value<=6},set:function(date,_flags,value,options){return(date=setUTCDay(date,value,options)).setUTCHours(0,0,0,0),date},incompatibleTokens:["D","i","e","c","t","T"]},e:{priority:90,parse:function(string,token,match,options){var valueCallback=function(value){var wholeWeekDays=7*Math.floor((value-1)/7);return(value+options.weekStartsOn+6)%7+wholeWeekDays};switch(token){case"e":case"ee":return parseNDigits(token.length,string,valueCallback);case"eo":return match.ordinalNumber(string,{unit:"day",valueCallback:valueCallback});case"eee":return match.day(string,{width:"abbreviated",context:"formatting"})||match.day(string,{width:"short",context:"formatting"})||match.day(string,{width:"narrow",context:"formatting"});case"eeeee":return match.day(string,{width:"narrow",context:"formatting"});case"eeeeee":return match.day(string,{width:"short",context:"formatting"})||match.day(string,{width:"narrow",context:"formatting"});case"eeee":default:return match.day(string,{width:"wide",context:"formatting"})||match.day(string,{width:"abbreviated",context:"formatting"})||match.day(string,{width:"short",context:"formatting"})||match.day(string,{width:"narrow",context:"formatting"})}},validate:function(_date,value,_options){return value>=0&&value<=6},set:function(date,_flags,value,options){return(date=setUTCDay(date,value,options)).setUTCHours(0,0,0,0),date},incompatibleTokens:["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]},c:{priority:90,parse:function(string,token,match,options){var valueCallback=function(value){var wholeWeekDays=7*Math.floor((value-1)/7);return(value+options.weekStartsOn+6)%7+wholeWeekDays};switch(token){case"c":case"cc":return parseNDigits(token.length,string,valueCallback);case"co":return match.ordinalNumber(string,{unit:"day",valueCallback:valueCallback});case"ccc":return match.day(string,{width:"abbreviated",context:"standalone"})||match.day(string,{width:"short",context:"standalone"})||match.day(string,{width:"narrow",context:"standalone"});case"ccccc":return match.day(string,{width:"narrow",context:"standalone"});case"cccccc":return match.day(string,{width:"short",context:"standalone"})||match.day(string,{width:"narrow",context:"standalone"});case"cccc":default:return match.day(string,{width:"wide",context:"standalone"})||match.day(string,{width:"abbreviated",context:"standalone"})||match.day(string,{width:"short",context:"standalone"})||match.day(string,{width:"narrow",context:"standalone"})}},validate:function(_date,value,_options){return value>=0&&value<=6},set:function(date,_flags,value,options){return(date=setUTCDay(date,value,options)).setUTCHours(0,0,0,0),date},incompatibleTokens:["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]},i:{priority:90,parse:function(string,token,match,_options){var valueCallback=function(value){return 0===value?7:value};switch(token){case"i":case"ii":return parseNDigits(token.length,string);case"io":return match.ordinalNumber(string,{unit:"day"});case"iii":return match.day(string,{width:"abbreviated",context:"formatting",valueCallback:valueCallback})||match.day(string,{width:"short",context:"formatting",valueCallback:valueCallback})||match.day(string,{width:"narrow",context:"formatting",valueCallback:valueCallback});case"iiiii":return match.day(string,{width:"narrow",context:"formatting",valueCallback:valueCallback});case"iiiiii":return match.day(string,{width:"short",context:"formatting",valueCallback:valueCallback})||match.day(string,{width:"narrow",context:"formatting",valueCallback:valueCallback});case"iiii":default:return match.day(string,{width:"wide",context:"formatting",valueCallback:valueCallback})||match.day(string,{width:"abbreviated",context:"formatting",valueCallback:valueCallback})||match.day(string,{width:"short",context:"formatting",valueCallback:valueCallback})||match.day(string,{width:"narrow",context:"formatting",valueCallback:valueCallback})}},validate:function(_date,value,_options){return value>=1&&value<=7},set:function(date,_flags,value,options){return(date=function(dirtyDate,dirtyDay){requiredArgs(2,arguments);var day=toInteger(dirtyDay);day%7==0&&(day-=7);var weekStartsOn=1,date=toDate(dirtyDate),currentDay=date.getUTCDay(),diff=((day%7+7)%7<weekStartsOn?7:0)+day-currentDay;return date.setUTCDate(date.getUTCDate()+diff),date}(date,value,options)).setUTCHours(0,0,0,0),date},incompatibleTokens:["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]},a:{priority:80,parse:function(string,token,match,_options){switch(token){case"a":case"aa":case"aaa":return match.dayPeriod(string,{width:"abbreviated",context:"formatting"})||match.dayPeriod(string,{width:"narrow",context:"formatting"});case"aaaaa":return match.dayPeriod(string,{width:"narrow",context:"formatting"});case"aaaa":default:return match.dayPeriod(string,{width:"wide",context:"formatting"})||match.dayPeriod(string,{width:"abbreviated",context:"formatting"})||match.dayPeriod(string,{width:"narrow",context:"formatting"})}},set:function(date,_flags,value,_options){return date.setUTCHours(dayPeriodEnumToHours(value),0,0,0),date},incompatibleTokens:["b","B","H","k","t","T"]},b:{priority:80,parse:function(string,token,match,_options){switch(token){case"b":case"bb":case"bbb":return match.dayPeriod(string,{width:"abbreviated",context:"formatting"})||match.dayPeriod(string,{width:"narrow",context:"formatting"});case"bbbbb":return match.dayPeriod(string,{width:"narrow",context:"formatting"});case"bbbb":default:return match.dayPeriod(string,{width:"wide",context:"formatting"})||match.dayPeriod(string,{width:"abbreviated",context:"formatting"})||match.dayPeriod(string,{width:"narrow",context:"formatting"})}},set:function(date,_flags,value,_options){return date.setUTCHours(dayPeriodEnumToHours(value),0,0,0),date},incompatibleTokens:["a","B","H","k","t","T"]},B:{priority:80,parse:function(string,token,match,_options){switch(token){case"B":case"BB":case"BBB":return match.dayPeriod(string,{width:"abbreviated",context:"formatting"})||match.dayPeriod(string,{width:"narrow",context:"formatting"});case"BBBBB":return match.dayPeriod(string,{width:"narrow",context:"formatting"});case"BBBB":default:return match.dayPeriod(string,{width:"wide",context:"formatting"})||match.dayPeriod(string,{width:"abbreviated",context:"formatting"})||match.dayPeriod(string,{width:"narrow",context:"formatting"})}},set:function(date,_flags,value,_options){return date.setUTCHours(dayPeriodEnumToHours(value),0,0,0),date},incompatibleTokens:["a","b","t","T"]},h:{priority:70,parse:function(string,token,match,_options){switch(token){case"h":return parseNumericPattern(numericPatterns_hour12h,string);case"ho":return match.ordinalNumber(string,{unit:"hour"});default:return parseNDigits(token.length,string)}},validate:function(_date,value,_options){return value>=1&&value<=12},set:function(date,_flags,value,_options){var isPM=date.getUTCHours()>=12;return isPM&&value<12?date.setUTCHours(value+12,0,0,0):isPM||12!==value?date.setUTCHours(value,0,0,0):date.setUTCHours(0,0,0,0),date},incompatibleTokens:["H","K","k","t","T"]},H:{priority:70,parse:function(string,token,match,_options){switch(token){case"H":return parseNumericPattern(numericPatterns_hour23h,string);case"Ho":return match.ordinalNumber(string,{unit:"hour"});default:return parseNDigits(token.length,string)}},validate:function(_date,value,_options){return value>=0&&value<=23},set:function(date,_flags,value,_options){return date.setUTCHours(value,0,0,0),date},incompatibleTokens:["a","b","h","K","k","t","T"]},K:{priority:70,parse:function(string,token,match,_options){switch(token){case"K":return parseNumericPattern(numericPatterns_hour11h,string);case"Ko":return match.ordinalNumber(string,{unit:"hour"});default:return parseNDigits(token.length,string)}},validate:function(_date,value,_options){return value>=0&&value<=11},set:function(date,_flags,value,_options){return date.getUTCHours()>=12&&value<12?date.setUTCHours(value+12,0,0,0):date.setUTCHours(value,0,0,0),date},incompatibleTokens:["h","H","k","t","T"]},k:{priority:70,parse:function(string,token,match,_options){switch(token){case"k":return parseNumericPattern(numericPatterns_hour24h,string);case"ko":return match.ordinalNumber(string,{unit:"hour"});default:return parseNDigits(token.length,string)}},validate:function(_date,value,_options){return value>=1&&value<=24},set:function(date,_flags,value,_options){var hours=value<=24?value%24:value;return date.setUTCHours(hours,0,0,0),date},incompatibleTokens:["a","b","h","H","K","t","T"]},m:{priority:60,parse:function(string,token,match,_options){switch(token){case"m":return parseNumericPattern(numericPatterns_minute,string);case"mo":return match.ordinalNumber(string,{unit:"minute"});default:return parseNDigits(token.length,string)}},validate:function(_date,value,_options){return value>=0&&value<=59},set:function(date,_flags,value,_options){return date.setUTCMinutes(value,0,0),date},incompatibleTokens:["t","T"]},s:{priority:50,parse:function(string,token,match,_options){switch(token){case"s":return parseNumericPattern(numericPatterns_second,string);case"so":return match.ordinalNumber(string,{unit:"second"});default:return parseNDigits(token.length,string)}},validate:function(_date,value,_options){return value>=0&&value<=59},set:function(date,_flags,value,_options){return date.setUTCSeconds(value,0),date},incompatibleTokens:["t","T"]},S:{priority:30,parse:function(string,token,_match,_options){return parseNDigits(token.length,string,(function(value){return Math.floor(value*Math.pow(10,3-token.length))}))},set:function(date,_flags,value,_options){return date.setUTCMilliseconds(value),date},incompatibleTokens:["t","T"]},X:{priority:10,parse:function(string,token,_match,_options){switch(token){case"X":return parseTimezonePattern(timezonePatterns_basicOptionalMinutes,string);case"XX":return parseTimezonePattern(timezonePatterns_basic,string);case"XXXX":return parseTimezonePattern(timezonePatterns_basicOptionalSeconds,string);case"XXXXX":return parseTimezonePattern(timezonePatterns_extendedOptionalSeconds,string);case"XXX":default:return parseTimezonePattern(timezonePatterns_extended,string)}},set:function(date,flags,value,_options){return flags.timestampIsSet?date:new Date(date.getTime()-value)},incompatibleTokens:["t","T","x"]},x:{priority:10,parse:function(string,token,_match,_options){switch(token){case"x":return parseTimezonePattern(timezonePatterns_basicOptionalMinutes,string);case"xx":return parseTimezonePattern(timezonePatterns_basic,string);case"xxxx":return parseTimezonePattern(timezonePatterns_basicOptionalSeconds,string);case"xxxxx":return parseTimezonePattern(timezonePatterns_extendedOptionalSeconds,string);case"xxx":default:return parseTimezonePattern(timezonePatterns_extended,string)}},set:function(date,flags,value,_options){return flags.timestampIsSet?date:new Date(date.getTime()-value)},incompatibleTokens:["t","T","X"]},t:{priority:40,parse:function(string,_token,_match,_options){return parseAnyDigitsSigned(string)},set:function(_date,_flags,value,_options){return[new Date(1e3*value),{timestampIsSet:!0}]},incompatibleTokens:"*"},T:{priority:20,parse:function(string,_token,_match,_options){return parseAnyDigitsSigned(string)},set:function(_date,_flags,value,_options){return[new Date(value),{timestampIsSet:!0}]},incompatibleTokens:"*"}},formattingTokensRegExp=/[yYQqMLwIdDecihHKkms]o|(\\w)\\1*|\'\'|\'(\'\'|[^\'])+(\'|$)|./g,longFormattingTokensRegExp=/P+p+|P+|p+|\'\'|\'(\'\'|[^\'])+(\'|$)|./g,escapedStringRegExp=/^\'([^]*?)\'?$/,doubleQuoteRegExp=/\'\'/g,notWhitespaceRegExp=/\\S/,unescapedLatinCharacterRegExp=/[a-zA-Z]/;function parse$3(dirtyDateString,dirtyFormatString,dirtyReferenceDate,dirtyOptions){requiredArgs(3,arguments);var dateString=String(dirtyDateString),formatString=String(dirtyFormatString),options=dirtyOptions||{},locale$1=options.locale||locale;if(!locale$1.match)throw new RangeError("locale must contain match property");var localeFirstWeekContainsDate=locale$1.options&&locale$1.options.firstWeekContainsDate,defaultFirstWeekContainsDate=null==localeFirstWeekContainsDate?1:toInteger(localeFirstWeekContainsDate),firstWeekContainsDate=null==options.firstWeekContainsDate?defaultFirstWeekContainsDate:toInteger(options.firstWeekContainsDate);if(!(firstWeekContainsDate>=1&&firstWeekContainsDate<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var localeWeekStartsOn=locale$1.options&&locale$1.options.weekStartsOn,defaultWeekStartsOn=null==localeWeekStartsOn?0:toInteger(localeWeekStartsOn),weekStartsOn=null==options.weekStartsOn?defaultWeekStartsOn:toInteger(options.weekStartsOn);if(!(weekStartsOn>=0&&weekStartsOn<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(""===formatString)return""===dateString?toDate(dirtyReferenceDate):new Date(NaN);var i,subFnOptions={firstWeekContainsDate:firstWeekContainsDate,weekStartsOn:weekStartsOn,locale:locale$1},setters=[{priority:10,subPriority:-1,set:dateToSystemTimezone,index:0}],tokens=formatString.match(longFormattingTokensRegExp).map((function(substring){var firstCharacter=substring[0];return"p"===firstCharacter||"P"===firstCharacter?(0,longFormatters[firstCharacter])(substring,locale$1.formatLong,subFnOptions):substring})).join("").match(formattingTokensRegExp),usedTokens=[];for(i=0;i<tokens.length;i++){var token=tokens[i];!options.useAdditionalWeekYearTokens&&isProtectedWeekYearToken(token)&&throwProtectedError(token,formatString,dirtyDateString),!options.useAdditionalDayOfYearTokens&&isProtectedDayOfYearToken(token)&&throwProtectedError(token,formatString,dirtyDateString);var firstCharacter=token[0],parser=parsers[firstCharacter];if(parser){var incompatibleTokens=parser.incompatibleTokens;if(Array.isArray(incompatibleTokens)){for(var incompatibleToken=void 0,_i=0;_i<usedTokens.length;_i++){var usedToken=usedTokens[_i].token;if(-1!==incompatibleTokens.indexOf(usedToken)||usedToken===firstCharacter){incompatibleToken=usedTokens[_i];break}}if(incompatibleToken)throw new RangeError("The format string mustn\'t contain `".concat(incompatibleToken.fullToken,"` and `").concat(token,"` at the same time"))}else if("*"===parser.incompatibleTokens&&usedTokens.length)throw new RangeError("The format string mustn\'t contain `".concat(token,"` and any other token at the same time"));usedTokens.push({token:firstCharacter,fullToken:token});var parseResult=parser.parse(dateString,token,locale$1.match,subFnOptions);if(!parseResult)return new Date(NaN);setters.push({priority:parser.priority,subPriority:parser.subPriority||0,set:parser.set,validate:parser.validate,value:parseResult.value,index:setters.length}),dateString=parseResult.rest}else{if(firstCharacter.match(unescapedLatinCharacterRegExp))throw new RangeError("Format string contains an unescaped latin alphabet character `"+firstCharacter+"`");if("\'\'"===token?token="\'":"\'"===firstCharacter&&(token=cleanEscapedString(token)),0!==dateString.indexOf(token))return new Date(NaN);dateString=dateString.slice(token.length)}}if(dateString.length>0&&notWhitespaceRegExp.test(dateString))return new Date(NaN);var uniquePrioritySetters=setters.map((function(setter){return setter.priority})).sort((function(a,b){return b-a})).filter((function(priority,index,array){return array.indexOf(priority)===index})).map((function(priority){return setters.filter((function(setter){return setter.priority===priority})).sort((function(a,b){return b.subPriority-a.subPriority}))})).map((function(setterArray){return setterArray[0]})),date=toDate(dirtyReferenceDate);if(isNaN(date))return new Date(NaN);var utcDate=subMilliseconds(date,getTimezoneOffsetInMilliseconds(date)),flags={};for(i=0;i<uniquePrioritySetters.length;i++){var setter=uniquePrioritySetters[i];if(setter.validate&&!setter.validate(utcDate,setter.value,subFnOptions))return new Date(NaN);var result=setter.set(utcDate,flags,setter.value,subFnOptions);result[0]?(utcDate=result[0],assign(flags,result[1])):utcDate=result}return utcDate}function dateToSystemTimezone(date,flags){if(flags.timestampIsSet)return date;var convertedDate=new Date(0);return convertedDate.setFullYear(date.getUTCFullYear(),date.getUTCMonth(),date.getUTCDate()),convertedDate.setHours(date.getUTCHours(),date.getUTCMinutes(),date.getUTCSeconds(),date.getUTCMilliseconds()),convertedDate}function cleanEscapedString(input){return input.match(escapedStringRegExp)[1].replace(doubleQuoteRegExp,"\'")}function parseISO(argument,dirtyOptions){requiredArgs(1,arguments);var options=dirtyOptions||{},additionalDigits=null==options.additionalDigits?2:toInteger(options.additionalDigits);if(2!==additionalDigits&&1!==additionalDigits&&0!==additionalDigits)throw new RangeError("additionalDigits must be 0, 1 or 2");if("string"!=typeof argument&&"[object String]"!==Object.prototype.toString.call(argument))return new Date(NaN);var date,dateStrings=splitDateString(argument);if(dateStrings.date){var parseYearResult=parseYear(dateStrings.date,additionalDigits);date=parseDate$2(parseYearResult.restDateString,parseYearResult.year)}if(!date||isNaN(date.getTime()))return new Date(NaN);var offset,timestamp=date.getTime(),time=0;if(dateStrings.time&&(time=parseTime$1(dateStrings.time),isNaN(time)))return new Date(NaN);if(!dateStrings.timezone){var dirtyDate=new Date(timestamp+time),result=new Date(0);return result.setFullYear(dirtyDate.getUTCFullYear(),dirtyDate.getUTCMonth(),dirtyDate.getUTCDate()),result.setHours(dirtyDate.getUTCHours(),dirtyDate.getUTCMinutes(),dirtyDate.getUTCSeconds(),dirtyDate.getUTCMilliseconds()),result}return offset=parseTimezone(dateStrings.timezone),isNaN(offset)?new Date(NaN):new Date(timestamp+time+offset)}var patterns={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},dateRegex=/^-?(?:(\\d{3})|(\\d{2})(?:-?(\\d{2}))?|W(\\d{2})(?:-?(\\d{1}))?|)$/,timeRegex=/^(\\d{2}(?:[.,]\\d*)?)(?::?(\\d{2}(?:[.,]\\d*)?))?(?::?(\\d{2}(?:[.,]\\d*)?))?$/,timezoneRegex=/^([+-])(\\d{2})(?::?(\\d{2}))?$/;function splitDateString(dateString){var timeString,dateStrings={},array=dateString.split(patterns.dateTimeDelimiter);if(array.length>2)return dateStrings;if(/:/.test(array[0])?timeString=array[0]:(dateStrings.date=array[0],timeString=array[1],patterns.timeZoneDelimiter.test(dateStrings.date)&&(dateStrings.date=dateString.split(patterns.timeZoneDelimiter)[0],timeString=dateString.substr(dateStrings.date.length,dateString.length))),timeString){var token=patterns.timezone.exec(timeString);token?(dateStrings.time=timeString.replace(token[1],""),dateStrings.timezone=token[1]):dateStrings.time=timeString}return dateStrings}function parseYear(dateString,additionalDigits){var regex=new RegExp("^(?:(\\\\d{4}|[+-]\\\\d{"+(4+additionalDigits)+"})|(\\\\d{2}|[+-]\\\\d{"+(2+additionalDigits)+"})$)"),captures=dateString.match(regex);if(!captures)return{year:NaN,restDateString:""};var year=captures[1]?parseInt(captures[1]):null,century=captures[2]?parseInt(captures[2]):null;return{year:null===century?year:100*century,restDateString:dateString.slice((captures[1]||captures[2]).length)}}function parseDate$2(dateString,year){if(null===year)return new Date(NaN);var captures=dateString.match(dateRegex);if(!captures)return new Date(NaN);var isWeekDate=!!captures[4],dayOfYear=parseDateUnit(captures[1]),month=parseDateUnit(captures[2])-1,day=parseDateUnit(captures[3]),week=parseDateUnit(captures[4]),dayOfWeek=parseDateUnit(captures[5])-1;if(isWeekDate)return function(_year,week,day){return week>=1&&week<=53&&day>=0&&day<=6}(0,week,dayOfWeek)?function(isoWeekYear,week,day){var date=new Date(0);date.setUTCFullYear(isoWeekYear,0,4);var fourthOfJanuaryDay=date.getUTCDay()||7,diff=7*(week-1)+day+1-fourthOfJanuaryDay;return date.setUTCDate(date.getUTCDate()+diff),date}(year,week,dayOfWeek):new Date(NaN);var date=new Date(0);return function(year,month,date){return month>=0&&month<=11&&date>=1&&date<=(daysInMonths[month]||(isLeapYearIndex(year)?29:28))}(year,month,day)&&function(year,dayOfYear){return dayOfYear>=1&&dayOfYear<=(isLeapYearIndex(year)?366:365)}(year,dayOfYear)?(date.setUTCFullYear(year,month,Math.max(dayOfYear,day)),date):new Date(NaN)}function parseDateUnit(value){return value?parseInt(value):1}function parseTime$1(timeString){var captures=timeString.match(timeRegex);if(!captures)return NaN;var hours=parseTimeUnit(captures[1]),minutes=parseTimeUnit(captures[2]),seconds=parseTimeUnit(captures[3]);return function(hours,minutes,seconds){if(24===hours)return 0===minutes&&0===seconds;return seconds>=0&&seconds<60&&minutes>=0&&minutes<60&&hours>=0&&hours<25}(hours,minutes,seconds)?36e5*hours+6e4*minutes+1e3*seconds:NaN}function parseTimeUnit(value){return value&&parseFloat(value.replace(",","."))||0}function parseTimezone(timezoneString){if("Z"===timezoneString)return 0;var captures=timezoneString.match(timezoneRegex);if(!captures)return 0;var sign="+"===captures[1]?-1:1,hours=parseInt(captures[2]),minutes=captures[3]&&parseInt(captures[3])||0;return function(_hours,minutes){return minutes>=0&&minutes<=59}(0,minutes)?sign*(36e5*hours+6e4*minutes):NaN}var daysInMonths=[31,null,31,30,31,30,31,31,30,31,30,31];function isLeapYearIndex(year){return year%400==0||year%4==0&&year%100!=0}class DateTime{constructor(m){this.dt=m}format(format$1){return format$1?function(dirtyDate,dirtyFormatStr,dirtyOptions){requiredArgs(2,arguments);var formatStr=String(dirtyFormatStr),options=dirtyOptions||{},locale$1=options.locale||locale,localeFirstWeekContainsDate=locale$1.options&&locale$1.options.firstWeekContainsDate,defaultFirstWeekContainsDate=null==localeFirstWeekContainsDate?1:toInteger(localeFirstWeekContainsDate),firstWeekContainsDate=null==options.firstWeekContainsDate?defaultFirstWeekContainsDate:toInteger(options.firstWeekContainsDate);if(!(firstWeekContainsDate>=1&&firstWeekContainsDate<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var localeWeekStartsOn=locale$1.options&&locale$1.options.weekStartsOn,defaultWeekStartsOn=null==localeWeekStartsOn?0:toInteger(localeWeekStartsOn),weekStartsOn=null==options.weekStartsOn?defaultWeekStartsOn:toInteger(options.weekStartsOn);if(!(weekStartsOn>=0&&weekStartsOn<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!locale$1.localize)throw new RangeError("locale must contain localize property");if(!locale$1.formatLong)throw new RangeError("locale must contain formatLong property");var originalDate=toDate(dirtyDate);if(!isValid(originalDate))throw new RangeError("Invalid time value");var timezoneOffset=getTimezoneOffsetInMilliseconds(originalDate),utcDate=subMilliseconds(originalDate,timezoneOffset),formatterOptions={firstWeekContainsDate:firstWeekContainsDate,weekStartsOn:weekStartsOn,locale:locale$1,_originalDate:originalDate};return formatStr.match(longFormattingTokensRegExp$1).map((function(substring){var firstCharacter=substring[0];return"p"===firstCharacter||"P"===firstCharacter?(0,longFormatters[firstCharacter])(substring,locale$1.formatLong,formatterOptions):substring})).join("").match(formattingTokensRegExp$1).map((function(substring){if("\'\'"===substring)return"\'";var firstCharacter=substring[0];if("\'"===firstCharacter)return cleanEscapedString$1(substring);var formatter=formatters$1[firstCharacter];if(formatter)return!options.useAdditionalWeekYearTokens&&isProtectedWeekYearToken(substring)&&throwProtectedError(substring,dirtyFormatStr,dirtyDate),!options.useAdditionalDayOfYearTokens&&isProtectedDayOfYearToken(substring)&&throwProtectedError(substring,dirtyFormatStr,dirtyDate),formatter(utcDate,substring,locale$1.localize,formatterOptions);if(firstCharacter.match(unescapedLatinCharacterRegExp$1))throw new RangeError("Format string contains an unescaped latin alphabet character `"+firstCharacter+"`");return substring})).join("")}(this.dt,convertToDateFnsFormat(format$1)):function(date,options){requiredArgs(1,arguments);var originalDate=toDate(date);if(isNaN(originalDate.getTime()))throw new RangeError("Invalid time value");var format=null!=options&&options.format?String(options.format):"extended",representation=null!=options&&options.representation?String(options.representation):"complete";if("extended"!==format&&"basic"!==format)throw new RangeError("format must be \'extended\' or \'basic\'");if("date"!==representation&&"time"!==representation&&"complete"!==representation)throw new RangeError("representation must be \'date\', \'time\', or \'complete\'");var result="",tzOffset="",dateDelimiter="extended"===format?"-":"",timeDelimiter="extended"===format?":":"";if("time"!==representation){var day=addLeadingZeros(originalDate.getDate(),2),month=addLeadingZeros(originalDate.getMonth()+1,2),year=addLeadingZeros(originalDate.getFullYear(),4);result="".concat(year).concat(dateDelimiter).concat(month).concat(dateDelimiter).concat(day)}if("date"!==representation){var offset=originalDate.getTimezoneOffset();if(0!==offset){var absoluteOffset=Math.abs(offset),hourOffset=addLeadingZeros(Math.floor(absoluteOffset/60),2),minuteOffset=addLeadingZeros(absoluteOffset%60,2);tzOffset="".concat(offset<0?"+":"-").concat(hourOffset,":").concat(minuteOffset)}else tzOffset="Z";var separator=""===result?"":"T",time=[addLeadingZeros(originalDate.getHours(),2),addLeadingZeros(originalDate.getMinutes(),2),addLeadingZeros(originalDate.getSeconds(),2)].join(timeDelimiter);result="".concat(result).concat(separator).concat(time).concat(tzOffset)}return result}(this.dt)}toDate(){return this.dt}clone(){return new DateTime(new Date(this.dt))}valueOf(){return this.dt.valueOf()}toISOString(){return isValid(this.dt)?this.dt.toISOString():""}isAfter(inp){return isAfter(this.dt,inp.dt)}year(){return getYear(this.dt)}month(){return getMonth(this.dt)}day(){return function(dirtyDate){return requiredArgs(1,arguments),toDate(dirtyDate).getDay()}(this.dt)}quarter(){return getQuarter(this.dt)}date(){return getDate(this.dt)}hour(){return getHours(this.dt)}minute(){return getMinutes(this.dt)}second(){return getSeconds(this.dt)}startOfDay(){return new DateTime(startOfDay(this.dt))}add(amount,unit){switch(unit){case"milliseconds":return new DateTime(addMilliseconds(this.dt,amount));case"seconds":return new DateTime(add(this.dt,{seconds:amount}));case"minutes":return new DateTime(add(this.dt,{minutes:amount}));case"hours":return new DateTime(add(this.dt,{hours:amount}));case"days":return new DateTime(add(this.dt,{days:amount}));case"weeks":return new DateTime(add(this.dt,{weeks:amount}));case"months":return new DateTime(add(this.dt,{months:amount}));case"quarters":return new DateTime(function(dirtyDate,dirtyAmount){requiredArgs(2,arguments);var amount=toInteger(dirtyAmount);return addMonths(dirtyDate,3*amount)}(this.dt,amount));case"years":return new DateTime(add(this.dt,{years:amount}));default:throw new Error(`add ${unit} is not implemented`)}}getTime(){const date=new Date(this.dt);return date.setFullYear(1,0,1),new DateTime(date)}dateDiff(interval,date,firstDayOfWeek){const earlyDate=date.dt;switch(interval){case"yyyy":return function(dirtyDateLeft,dirtyDateRight){requiredArgs(2,arguments);var dateLeft=toDate(dirtyDateLeft),dateRight=toDate(dirtyDateRight),sign=compareAsc(dateLeft,dateRight),difference=Math.abs(differenceInCalendarYears(dateLeft,dateRight));dateLeft.setFullYear(1584),dateRight.setFullYear(1584);var isLastYearNotFull=compareAsc(dateLeft,dateRight)===-sign,result=sign*(difference-Number(isLastYearNotFull));return 0===result?0:result}(this.dt,earlyDate);case"q":return function(dateLeft,dateRight,options){requiredArgs(2,arguments);var diff=differenceInMonths(dateLeft,dateRight)/3;return getRoundingMethod(null==options?void 0:options.roundingMethod)(diff)}(this.dt,earlyDate);case"m":return differenceInMonths(this.dt,earlyDate);case"y":case"d":case"w":return differenceInDays(this.dt,earlyDate);case"ww":return isAfter(earlyDate,this.dt)?-1:differenceInCalendarWeeks(this.dt,earlyDate,{weekStartsOn:this.getStartOfWeek(firstDayOfWeek)});case"h":return function(dateLeft,dateRight,options){requiredArgs(2,arguments);var diff=differenceInMilliseconds(dateLeft,dateRight)/36e5;return getRoundingMethod(null==options?void 0:options.roundingMethod)(diff)}(this.dt,earlyDate);case"n":return function(dateLeft,dateRight,options){requiredArgs(2,arguments);var diff=differenceInMilliseconds(dateLeft,dateRight)/6e4;return getRoundingMethod(null==options?void 0:options.roundingMethod)(diff)}(this.dt,earlyDate);case"s":return function(dateLeft,dateRight,options){requiredArgs(2,arguments);var diff=differenceInMilliseconds(dateLeft,dateRight)/1e3;return getRoundingMethod(null==options?void 0:options.roundingMethod)(diff)}(this.dt,earlyDate);default:throw new Error(`"${interval}" is not valid interval value for DateDiff() function`)}}datePart(interval,firstDayOfWeek,firstWeekOfYear){switch(interval){case"yyyy":return getYear(this.dt);case"q":return getQuarter(this.dt);case"m":return getMonth(this.dt)+1;case"y":return function(dirtyDate){requiredArgs(1,arguments);var date=toDate(dirtyDate);return differenceInCalendarDays(date,startOfYear(date))+1}(this.dt);case"d":return getDate(this.dt);case"w":return differenceInDays(this.dt,startOfWeek(this.dt,{weekStartsOn:this.getStartOfWeek(firstDayOfWeek)}))+1;case"ww":const sow=this.getStartOfWeek(firstDayOfWeek);let firstWeekContainsDate=1;2===firstWeekOfYear?firstWeekContainsDate=4:3===firstWeekOfYear&&(firstWeekContainsDate=7);return getWeekYear(this.dt,{weekStartsOn:sow,firstWeekContainsDate:firstWeekContainsDate})>getYear(this.dt)?this.getWeeksInYear(sow)+1:function(dirtyDate,options){requiredArgs(1,arguments);var date=toDate(dirtyDate),diff=startOfWeek(date,options).getTime()-startOfWeekYear(date,options).getTime();return Math.round(diff/6048e5)+1}(this.dt,{weekStartsOn:sow,firstWeekContainsDate:firstWeekContainsDate});case"h":return getHours(this.dt);case"n":return getMinutes(this.dt);case"s":return getSeconds(this.dt);default:throw new Error(`"${interval}" is not valid interval value for DatePart() function`)}}getWeeksInYear(weekStartsOn){return differenceInCalendarWeeks(function(dirtyDate){requiredArgs(1,arguments);var date=toDate(dirtyDate),year=date.getFullYear();return date.setFullYear(year+1,0,0),date.setHours(23,59,59,999),date}(this.dt),startOfYear(this.dt),{weekStartsOn:weekStartsOn})}getStartOfWeek(firstDayOfWeek){const sow=firstDayOfWeek?firstDayOfWeek-1:0;if([0,1,2,3,4,5,6].includes(sow))return sow;throw new Error("firstDayOfWeek must be integer [1..7]")}}const dateTimeFactory_create=()=>new DateTime(new Date),dateTimeFactory_createFromString=(str,formats,isStrict)=>{const value=function(date,formats){try{if(!formats||Array.isArray(formats)&&0===formats.length)return parseISO(date);for(const form of formats){const parsed=isISO_8601format(form)?parseISO(date):parse$3(date,convertToDateFnsFormat(form),new Date);if(isValid(parsed))return parsed}}catch(error){return console.warn(error),null}return null}(str,formats);return null!=value?new DateTime(value):null},dateTimeFactory_createFromArray=args=>{if(!function(args){return(!args[1]||!(args[1]<1||args[1]>12))&&((!args[2]||!(args[2]<1||args[2]>31))&&((!args[3]||!(args[3]<0||args[3]>24))&&((!args[4]||!(args[4]<0||args[4]>59))&&(!args[5]||!(args[5]<0||args[5]>59)))))}(args))return null;const date=new Date(args[0],args[1],args[2],args[3],args[4],args[5]);return date.setFullYear(args[0]),new DateTime(date)},dateTimeFactory_createFromJsDate=date=>isValid(date)?new DateTime(date):null,dateTimeFactory_isDateTime=m=>m&&m.dt&&m.dt instanceof Date;function isISO_8601format(format){return"object"==typeof format&&format.ISO_8601}const parseDictionary={dd:"dd",d:"d",DD:"dd",D:"d",fffffff:"SSSSSSS",ffffff:"SSSSSS",fffff:"SSSSS",ffff:"SSSS",fff:"SSS",ff:"SS",f:"S",hh:"hh",h:"h",HH:"HH",H:"H",mm:"mm",m:"m",ss:"ss",s:"s",tt:"aa",t:"a",a:"a",A:"aa",MM:"MM",M:"M",yyyy:"yyyy",yy:"yy",YYYY:"yyyy",YY:"yy",zzz:"XXX",zz:"X",z:"X",Z:"XXX",X:"t",x:"T"};function convertToDateFnsFormat(format){return parseDateTimeFormat(format,Object.keys(parseDictionary)).map((t=>{var _a;return null!==(_a=parseDictionary[t])&&void 0!==_a?_a:`\'${t}\'`})).join("")}const dateTimeFormatMapping={d:"Short date",D:"Long date",f:"Full date/short time",F:"Full date/long time",g:"General date/short time",G:"General date/long time",M:"Month/day",m:"Month/day",O:"Round-trip date/time",o:"Round-trip date/time",R:"RFC1123",r:"RFC1123",s:"Sortable date/time",t:"Short time",T:"Long time",u:"Universal sortable date/time",U:"Universal full date/time",Y:"Year/month",y:"Year/month"},localeIndependentFormats={"Round-trip date/time":\'yyyy"-"MM"-"dd"T"HH":"mm":"ss.fffffffK\',RFC1123:\'ddd, dd MMM yyyy HH":"mm":"ss "GMT"\',"Sortable date/time":\'yyyy"-"MM"-"dd"T"HH":"mm":"ss\',"Universal sortable date/time":\'yyyy"-"MM"-"dd HH":"mm":"ss"Z"\'},complexFormats={"Full date/short time":["Long date","Short time"],"Full date/long time":["Long date","Long time"],"General date/short time":["Short date","Short time"],"General date/long time":["Short date","Long time"],"Universal full date/time":["Long date","Long time"]},dateTimeFormatKeys=Object.keys(dateTimeFormatMapping);function formatDateTime(value,pattern,locale){const patternKey=1===(pattern=pattern||"G").length?dateTimeFormatMapping[pattern]:void 0;let customPattern;if(patternKey){if(!function(patternKey){return Object.keys(localeIndependentFormats).includes(patternKey)}(patternKey))return function(patternKey){return Object.keys(complexFormats).includes(patternKey)}(patternKey)?complexFormats[patternKey].map((f=>locale.Format(value,f))).join(" "):locale.Format(value,patternKey);customPattern=localeIndependentFormats[patternKey]}else customPattern=pattern;return formatDateTimeWithPattern(value,customPattern,locale.FormatInfo,"U"===pattern)}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function getDefaultExportFromCjs(x){return x&&x.__esModule&&Object.prototype.hasOwnProperty.call(x,"default")?x.default:x}function commonjsRequire(path){throw new Error(\'Could not dynamically require "\'+path+\'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.\')}var lib={exports:{}},DataFormatter=getDefaultExportFromCjs(lib.exports=function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}var a=r(n(1)),u=r(n(20)),s=r(n(21)),f=n(22),p=r(n(64)),d="en-US";e.exports=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.debug,r=void 0!==n&&n,o=t.UTCOffset,i=void 0===o?null:o,c=t.locale,s=void 0===c?d:c,f=t.transformCode,l=void 0===f?function(e){return e}:f,h=t.locales,m=void 0===h?[]:h;(0,u.default)(this,e),this.memoized={},this.debug=r,this.UTCOffset=i,this.transformCode=l,this.zeroDate=this.createDate("1899-12-31T00:00:00.000"),this.locales=(0,a.default)({},d,p.default),this.defineLocales(m),this.setLocale(s)}return(0,s.default)(e,[{key:"clearMemoizedFunctions",value:function(){this.memoized={}}},{key:"defineLocales",value:function(e){var t=this;e.forEach((function(e){return t.locales[e.name]=e}))}},{key:"setLocale",value:function(e){this.locale=this.locales[e]||this.locales[d],this.clearMemoizedFunctions()}},{key:"setUTCOffset",value:function(e){this.UTCOffset=e}},{key:"createDate",value:function(){var e=new(Function.prototype.bind.apply(Date,[null].concat(Array.prototype.slice.call(arguments))));if(null!==this.UTCOffset){var t=e.getTimezoneOffset(),r=60*(this.UTCOffset+t)*1e3;e.setTime(e.getTime()+r)}return e}},{key:"log",value:function(e){this.debug&&console.log(e)}},{key:"roundDecimals",value:function(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n}},{key:"gcd",value:function(e,t){for(var n=void 0;t;)n=e%t,e=t,t=n;return Math.abs(e)}},{key:"applyNumberPattern",value:function(e,t,n){e=e.toString();var r="";if("right"===n)for(var o=0,a=-1,i=t.length;++a<i;)switch(t[a]){case"0":r+=e[o]||"0",o++;break;case"#":r+=e[o]||"",o++;break;case"?":r+=e[o]||" ",o++;break;case"[":for(;a<t.length&&"]"!==t[a];)r+=t[a],a++;a--;break;default:r+=t[a]}else{var u=!1,c=void 0;if(t=t.replace(/(0|#|\\?)(,+?)(0|#|\\?)/g,(function(e,t,n,r){return u=!0,t+r})),u)for(var s=e.length-3;"-"===e[0]?s>1:s>0;)e=e.substr(0,s)+this.locale.thousandSeparator+e.substr(s),s-=3;var f=e.length-1,l=t.length;for(e="0"===e?"":e;l--;)switch(t[l]){case"0":r=(e[f]||"0")+r,c=l,f--;break;case"#":r=(e[f]||"")+r,c=l,f--;break;case"?":r=(e[f]||" ")+r,c=l,f--;break;case"]":for(;l>0&&"["!==t[l];)r=t[l]+r,l--;l++;break;default:r=t[l]+r}f>=0&&null!==c&&(r=r.substr(0,c)+e.substr(0,f+1)+r.substr(c))}return r}},{key:"restoreOrigins",value:function(e,t){return e.toString().replace(/\\[(?:(\\$*?)|(.*?))\\]/g,(function(e,n){return n&&t[n.length-1]||e}))}},{key:"formatAsNumberDecimal",value:function(e,t,n,r){var o=(e=this.roundDecimals(e,t).toString().split("."))[0],a=e[1]||0;return this.applyNumberPattern(o,n)+this.locale.decimalSeparator+this.applyNumberPattern(a,r,"right")}},{key:"formatAsNumberFractial",value:function(e,t,n){var r=e.toString().split(".");r=r[1]?Math.pow(10,r[1].length):1,e=Math.floor(e*r);var o=this.gcd(e,r);return this.applyNumberPattern(e/o,t)+"/"+this.applyNumberPattern(r/o,n)}},{key:"formatAsNumberFractialMixed",value:function(e,t,n,r){var o=0,a=1,i=1,u=e.toString().split(".");return u[1]&&(a=Math.pow(10,u[1].length),o=parseInt(u[1]),i=this.gcd(o,a)),this.applyNumberPattern(parseInt(e),t)+this.applyNumberPattern(o/i,n)+"/"+this.applyNumberPattern(a/i,r)}},{key:"formatAsNumberExponential",value:function(e,t,n,r,o,a){var i=e<0?-1:1,u=0;if(0!==e){e=Math.abs(e);for(var c=Math.pow(10,t);e<c||this.roundDecimals(e,n)<c;)e*=10,u++;for(;e>=c||this.roundDecimals(e,n)>=c;)e/=10,u--}e=this.roundDecimals(e*i,n).toString().split(".");var s="";return s+=this.applyNumberPattern(parseInt(e[0]),r),o&&(s+=this.locale.decimalSeparator+this.applyNumberPattern(parseInt(e[1]||0),o,"right")),s+"E"+(u>0?"-":"+")+this.applyNumberPattern(Math.abs(u),a)}},{key:"formatAsDateTimeElapsed",value:function(e,t,n,r,o){var a=this;e=Math.abs(e.getTime()-this.zeroDate.getTime());var i=parseInt(e/1e3),u=parseInt(i/60),c=parseInt(u/60),s=parseInt(c/24);return c=t?c%24:c,u=n?u%60:u,i=r?i%60:i,o.replace(/(dd)|(d)|(hh)|(h)|(mm)|(m)|(ss)|(s)/gi,(function(e,t,n,r,o,f,l,p,d){return t?a.applyNumberPattern(s,"00"):n?s:r?a.applyNumberPattern(c,"00"):o?c:f?a.applyNumberPattern(u,"00"):l?u:p?a.applyNumberPattern(i,"00"):d?i:""}))}},{key:"formatAsDateTimeNormal",value:function(e,t){var n=this,r=this.locale,o=r.days,a=r.daysShort,i=r.months,u=r.monthsShort,c=!1,s=e.getFullYear(),f=e.getMonth(),l=e.getDate(),p=e.getDay(),d=e.getHours(),h=e.getMinutes(),m=e.getSeconds();return t.replace(/((?:am\\/pm)|(?:a\\/p))|(?:(h[^ydsap]*?)mm)|(?:mm([^ydh]*?s))|(?:(h[^ydsap]*?)m)|(?:m([^ydh]*?s))/gi,(function(e,t,r,o,a,i){return t?(c=!0,"[]"):r?r+n.applyNumberPattern(h,"00"):o?n.applyNumberPattern(h,"00")+o:a?a+h:i?h+i:""})).replace(/(ss)|(s)|(hh)|(h)|(dddd)|(ddd)|(dd)|(d)|(mmmmm)|(mmmm)|(mmm)|(mm)|(m)|(yyyy)|(yy)|(\\[\\])/gi,(function(e,t,r,h,v,y,g,b,x,S,w,N,k,C,M,O,_){return t?n.applyNumberPattern(m,"00"):r?m:h?n.applyNumberPattern(c?d%12:d,"00"):v?c?d%12:d:y?o[p]:g?a[p]:b?n.applyNumberPattern(l,"00"):x?l:S?u[f][0]:w?i[f]:N?u[f]:k?n.applyNumberPattern(f+1,"00"):C?f+1:M?s:O?s.toString().substr(2):_?d<12?"AM":"PM":""}))}},{key:"createTextCode",value:function(e){var t=new f.Code;return t.append("\\n      result.value = {0}.replace(/@/, n);\\n    ",e),t.toString()}},{key:"createGeneralCode",value:function(){var e=new f.Code,t=this.createNumberCode("#.00"),n=this.createDateTimeCode("[d]");return e.append(\'\\n      if (type === "Number") {\\n        \'+t+\'\\n      }\\n      if (type === "DateTime") {\\n        \'+n+"\\n      }\\n    "),e.toString()}},{key:"createNumberExponentialCode",value:function(e){var t=e[1],n=e[2],r=e[3],o=new f.Code,a=void 0,i=void 0,u=function(e){return e.match(/0|\\?|#/g).length};return t?a=u(t):(t="#",a=1),n?i=u(n):(n="",i=0),o.append("\\n      result.value = this.formatAsNumberExponential(n, {0}, {1}, {2}, {3}, {4});\\n    ",a,i,t,n,r),o.toString()}},{key:"createNumberFractialCode",value:function(e){for(var t=new f.Code,n=e[1]||"#",r=e[2]||"#",o=n.length-1;"0"===n[o]&&"?"!==n[o]&&"#"!==n[o]&&" "!==n[o]&&o>0;)o--;var a=n.substr(0,o),i=n.substr(o);return a?t.append("\\n        result.value = this.formatAsNumberFractialMixed(n, {0}, {1}, {2});\\n      ",a,i,r):t.append("\\n        result.value = this.formatAsNumberFractial(n, {0}, {1});\\n      ",i,r),t.toString()}},{key:"createNumberDecimalCode",value:function(e){var t=new f.Code,n=e[1]||"0",r=e[2]||"",o=void 0,a=1;return o=r?function(e){return e.match(/0|\\?|#/g).length}(r):0,n=n.replace(/(0|#|\\?)(,+)([^0?#]*)$/,(function(e,t,n,r){return a*=Math.pow(1e3,n.length),t+r})),1!==a&&t.append("\\n        n /= {0};\\n      ",a),t.append("\\n      result.value = this.formatAsNumberDecimal(n, {0}, {1}, {2});\\n    ",o,n,r),t.toString()}},{key:"createNumberIntegerCode",value:function(e){var t=new f.Code;return t.append("\\n      n = Math.round(n);\\n      result.value = this.applyNumberPattern(n, {0});\\n    ",e),t.toString()}},{key:"createNumberCode",value:function(e,t){var n=new f.Code;t&&n.append("\\n        n = Math.abs(n);\\n      ");var r=e.match(/(.*?)(?:\\.(.*?))?e(?:\\+|\\-)(.*)/i);if(r)n.append(this.createNumberExponentialCode(r));else{var o=1,a=(e=e.replace(/(0|#|\\?)([\\s,]+)([^0?#]*?)($|\\.)/,(function(e,t,n,r,a){return o*=Math.pow(1e3,n.length),t+r+a}))).match(/%/g);a&&(o/=Math.pow(100,a.length)),1!==o&&n.append("\\n          n /= {0};\\n        ",o);var i=void 0,u=void 0;switch(!0){case!!(i=e.match(/(.*?)\\/(.*)/)):n.append(this.createNumberFractialCode(i));break;case!!(u=e.match(/(.*?)\\.(.*)/)):n.append(this.createNumberDecimalCode(u));break;default:n.append(this.createNumberIntegerCode(e))}}var c=new f.Code;return c.append("\\n      n = parseFloat(n);\\n    "),c.append("\\n      if (!isNaN(n)) {\\n        if (n >= 1e21 || n <= -1e21) {\\n          result.value = n.toString().toUpperCase();\\n        }\\n        else {\\n          "+n+"\\n        }\\n      }\\n    "),c.toString()}},{key:"createDateTimeElapsedCode",value:function(e){var t=new f.Code,n=/d/i.test(e),r=/h/i.test(e),o=/m/i.test(e);return t.append("\\n      result.value = this.formatAsDateTimeElapsed(n, {0}, {1}, {2}, {3});\\n    ",n,r,o,e),t.toString()}},{key:"createDateTimeNormalCode",value:function(e){var t=new f.Code;return t.append("\\n      result.value = this.formatAsDateTimeNormal(n, {0});\\n    ",e),t.toString()}},{key:"createDateTimeCode",value:function(e){var t=new f.Code,n=!1;e=e.replace(/\\[(h+?|m+?|s+?|y+?|d+?)]/gi,(function(e,t){return n=!0,t}));var r=n?this.createDateTimeElapsedCode(e):this.createDateTimeNormalCode(e);return t.append("\\n      n = this.createDate(n);\\n      if (!isNaN(n.getTime())) {\\n        "+r+"\\n      }\\n    "),t.toString()}},{key:"createSectionCode",value:function(e,t,n){var r=new f.Code,o=void 0,a=!1,i=e.match(/\\[((?:>|>=|<|<=|=|<>)[0-9\\.]+?)]/);switch(!0){case!!i:o=\'type == "Number" && parseFloat(n)\'+i[1].replace(/<>/,"!=").replace("/=/","==");break;case 0===t&&n>2:o=\'type == "Number" && parseFloat(n) > 0\';break;case 0===t&&2===n:o=\'type == "Number" && parseFloat(n) >= 0\';break;case 1===t:o=\'type == "Number" && parseFloat(n) < 0\',a=!0}e=(e=e.replace(/\\[(Red|Green|White|Blue|Magenta|Yellow|Cyan|Black)]/gi,(function(e,t){return r.append("\\n        result.color = {0};\\n      ",t),""}))).replace(/(\\[((?!((\\$*?)|(d*?)|(h*?)|(m*?)|(s*?))]).*?)])/,"");var c=new f.Code;switch(c.append("\\n      result.value = {0};\\n      result.pattern = {0};\\n    ",e),!0){case/General/i.test(e):c.append(this.createGeneralCode(e));break;case/@/.test(e):c.append(this.createTextCode(e));break;case/#|\\?|0/.test(e):o||(o=\'type === "Number"\'),c.append(this.createNumberCode(e,a));break;case/h|m|s|y|d/i.test(e):o||(o=\'type === "DateTime"\'),c.append(this.createDateTimeCode(e))}return c.append("\\n      return makeResult.call(this);\\n    "),o?r.append("\\n        // Section\\n        if ("+o+") {\\n          "+c+"\\n        }\\n        // End section\\n      "):r.append("\\n        // Section\\n        "+c+"\\n        // End section\\n      "),r.toString()}},{key:"createPatternCode",value:function(e){var t=this,n=[],r="",o=e.replace(/"([^"]+)"|\\\\(.?)|(_.?)|(\\*.?)|(")/g,(function(e,t,o,a){return t?(n.push(t.replace(/("|\'|\\\\)/g,"\\\\$1")),"["+(r+="$")+"]"):o?(n.push(o.replace(/("|\'|\\\\)/g,"\\\\$1")),"["+(r+="$")+"]"):a?(n.push(" "),"["+(r+="$")+"]"):""})),a=o.split(/;/),i=new f.Code;return i.append(\'\\n      var result = {\\n        value: "",\\n        align: type === "Number" || type === "DateTime" ? "right" : "",\\n        color: "",\\n        pattern: ""\\n      };\\n\\n      function makeResult() {\\n        var origins = {0};\\n        result.value = this.restoreOrigins(result.value, origins);\\n        result.pattern = this.restoreOrigins(result.pattern, origins);\\n        return result;\\n      };\\n    \',n),(a=a.slice(0,4)).forEach((function(e,n){return i.append(t.createSectionCode(e,n,a.length))})),i.append("\\n      result.value = {0};\\n      result.pattern = {0};\\n      return makeResult.call(this);\\n    ",o),i.toString()}},{key:"format",value:function(e,t,n){if(this.log("Input:"),this.log("n = "+e+", type = "+t+", pattern = "+n),e=e.toString(),n=n.toString(),this.locale.formats[n]&&(n=this.locale.formats[n]),!this.memoized[n]){var r=this.createPatternCode(n);r=this.transformCode(r),this.memoized[n]=Function("n","type",r),this.log("Code:"),this.log(r)}var o=this.memoized[n].call(this,e,t);return this.log("Result:"),this.log(o),o}}]),e}()},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var a=r(n(2));t.default=function(e,t,n){return t in e?(0,a.default)(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t,n){e.exports={default:n(3),__esModule:!0}},function(e,t,n){n(4);var r=n(7).Object;e.exports=function(e,t,n){return r.defineProperty(e,t,n)}},function(e,t,n){var r=n(5);r(r.S+r.F*!n(15),"Object",{defineProperty:n(11).f})},function(e,t,n){var r=n(6),o=n(7),a=n(8),i=n(10),u="prototype",c=function(e,t,n){var s,f,l,p=e&c.F,d=e&c.G,h=e&c.S,m=e&c.P,v=e&c.B,y=e&c.W,g=d?o:o[t]||(o[t]={}),b=g[u],x=d?r:h?r[t]:(r[t]||{})[u];for(s in d&&(n=t),n)(f=!p&&x&&void 0!==x[s])&&s in g||(l=f?x[s]:n[s],g[s]=d&&"function"!=typeof x[s]?n[s]:v&&f?a(l,r):y&&x[s]==l?function(e){var t=function(t,n,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,r)}return e.apply(this,arguments)};return t[u]=e[u],t}(l):m&&"function"==typeof l?a(Function.call,l):l,m&&((g.virtual||(g.virtual={}))[s]=l,e&c.R&&b&&!b[s]&&i(b,s,l)))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t){var n=e.exports={version:"2.5.3"};"number"==typeof __e&&(__e=n)},function(e,t,n){var r=n(9);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,o){return e.call(t,n,r,o)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){var r=n(11),o=n(19);e.exports=n(15)?function(e,t,n){return r.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var r=n(12),o=n(14),a=n(18),i=Object.defineProperty;t.f=n(15)?Object.defineProperty:function(e,t,n){if(r(e),t=a(t,!0),r(n),o)try{return i(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){var r=n(13);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){e.exports=!n(15)&&!n(16)((function(){return 7!=Object.defineProperty(n(17)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){e.exports=!n(16)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){var r=n(13),o=n(6).document,a=r(o)&&r(o.createElement);e.exports=function(e){return a?o.createElement(e):{}}},function(e,t,n){var r=n(13);e.exports=function(e,t){if(!r(e))return e;var n,o;if(t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;if("function"==typeof(n=e.valueOf)&&!r(o=n.call(e)))return o;if(!t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;throw TypeError("Can\'t convert object to primitive value")}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var a=r(n(2));t.default=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),(0,a.default)(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}()},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function o(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.replace(/{(\\d+)}/g,(function(e,t){return void 0!==n[t]?n[t]:e}))}Object.defineProperty(t,"__esModule",{value:!0}),t.Code=void 0;var i=r(n(23)),c=r(n(62)),f=r(n(20)),p=r(n(21));t.formatString=o,t.Code=function(){function e(){(0,f.default)(this,e),this.code=""}return(0,p.default)(e,[{key:"makeString",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n=n.map(c.default),o.apply(void 0,[e].concat((0,i.default)(n)))}},{key:"append",value:function(){this.code+=this.makeString.apply(this,arguments)}},{key:"toString",value:function(){return this.code}}]),e}()},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var a=r(n(24));t.default=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return(0,a.default)(e)}},function(e,t,n){e.exports={default:n(25),__esModule:!0}},function(e,t,n){n(26),n(55),e.exports=n(7).Array.from},function(e,t,n){var r=n(27)(!0);n(30)(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=r(t,n),this._i+=e.length,{value:e,done:!1})}))},function(e,t,n){var r=n(28),o=n(29);e.exports=function(e){return function(t,n){var a,i,u=String(o(t)),c=r(n),s=u.length;return c<0||c>=s?e?"":void 0:(a=u.charCodeAt(c))<55296||a>56319||c+1===s||(i=u.charCodeAt(c+1))<56320||i>57343?e?u.charAt(c):a:e?u.slice(c,c+2):i-56320+(a-55296<<10)+65536}}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can\'t call method on  "+e);return e}},function(e,t,n){var r=n(31),o=n(5),a=n(32),i=n(10),u=n(33),c=n(34),s=n(35),f=n(51),l=n(53),p=n(52)("iterator"),d=!([].keys&&"next"in[].keys()),h="@@iterator",m="keys",v="values",y=function(){return this};e.exports=function(e,t,n,g,b,x,S){s(n,t,g);var w,N,k,C=function(e){if(!d&&e in P)return P[e];switch(e){case m:case v:return function(){return new n(this,e)}}return function(){return new n(this,e)}},M=t+" Iterator",O=b==v,_=!1,P=e.prototype,T=P[p]||P[h]||b&&P[b],D=!d&&T||C(b),A=b?O?C("entries"):D:void 0,j="Array"==t&&P.entries||T;if(j&&(k=l(j.call(new e)))!==Object.prototype&&k.next&&(f(k,M,!0),r||u(k,p)||i(k,p,y)),O&&T&&T.name!==v&&(_=!0,D=function(){return T.call(this)}),r&&!S||!d&&!_&&P[p]||i(P,p,D),c[t]=D,c[M]=y,b)if(w={values:O?D:C(v),keys:x?D:C(m),entries:A},S)for(N in w)N in P||a(P,N,w[N]);else o(o.P+o.F*(d||_),t,w);return w}},function(e,t){e.exports=!0},function(e,t,n){e.exports=n(10)},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t){e.exports={}},function(e,t,n){var r=n(36),o=n(19),a=n(51),i={};n(10)(i,n(52)("iterator"),(function(){return this})),e.exports=function(e,t,n){e.prototype=r(i,{next:o(1,n)}),a(e,t+" Iterator")}},function(e,t,n){var r=n(12),o=n(37),a=n(49),i=n(46)("IE_PROTO"),u=function(){},c="prototype",s=function(){var e,t=n(17)("iframe"),r=a.length,o="<",i=">";for(t.style.display="none",n(50).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write(o+"script"+i+"document.F=Object"+o+"/script"+i),e.close(),s=e.F;r--;)delete s[c][a[r]];return s()};e.exports=Object.create||function(e,t){var n;return null!==e?(u[c]=r(e),n=new u,u[c]=null,n[i]=e):n=s(),void 0===t?n:o(n,t)}},function(e,t,n){var r=n(11),o=n(12),a=n(38);e.exports=n(15)?Object.defineProperties:function(e,t){o(e);for(var n,i=a(t),u=i.length,c=0;u>c;)r.f(e,n=i[c++],t[n]);return e}},function(e,t,n){var r=n(39),o=n(49);e.exports=Object.keys||function(e){return r(e,o)}},function(e,t,n){var r=n(33),o=n(40),a=n(43)(!1),i=n(46)("IE_PROTO");e.exports=function(e,t){var n,u=o(e),c=0,s=[];for(n in u)n!=i&&r(u,n)&&s.push(n);for(;t.length>c;)r(u,n=t[c++])&&(~a(s,n)||s.push(n));return s}},function(e,t,n){var r=n(41),o=n(29);e.exports=function(e){return r(o(e))}},function(e,t,n){var r=n(42);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var r=n(40),o=n(44),a=n(45);e.exports=function(e){return function(t,n,i){var u,c=r(t),s=o(c.length),f=a(i,s);if(e&&n!=n){for(;s>f;)if((u=c[f++])!=u)return!0}else for(;s>f;f++)if((e||f in c)&&c[f]===n)return e||f||0;return!e&&-1}}},function(e,t,n){var r=n(28),o=Math.min;e.exports=function(e){return e>0?o(r(e),9007199254740991):0}},function(e,t,n){var r=n(28),o=Math.max,a=Math.min;e.exports=function(e,t){return(e=r(e))<0?o(e+t,0):a(e,t)}},function(e,t,n){var r=n(47)("keys"),o=n(48);e.exports=function(e){return r[e]||(r[e]=o(e))}},function(e,t,n){var r=n(6),o="__core-js_shared__",a=r[o]||(r[o]={});e.exports=function(e){return a[e]||(a[e]={})}},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){var r=n(6).document;e.exports=r&&r.documentElement},function(e,t,n){var r=n(11).f,o=n(33),a=n(52)("toStringTag");e.exports=function(e,t,n){e&&!o(e=n?e:e.prototype,a)&&r(e,a,{configurable:!0,value:t})}},function(e,t,n){var r=n(47)("wks"),o=n(48),a=n(6).Symbol,i="function"==typeof a;(e.exports=function(e){return r[e]||(r[e]=i&&a[e]||(i?a:o)("Symbol."+e))}).store=r},function(e,t,n){var r=n(33),o=n(54),a=n(46)("IE_PROTO"),i=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=o(e),r(e,a)?e[a]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?i:null}},function(e,t,n){var r=n(29);e.exports=function(e){return Object(r(e))}},function(e,t,n){var r=n(8),o=n(5),a=n(54),i=n(56),u=n(57),c=n(44),s=n(58),f=n(59);o(o.S+o.F*!n(61)((function(e){Array.from(e)})),"Array",{from:function(e){var t,n,o,l,p=a(e),d="function"==typeof this?this:Array,h=arguments.length,m=h>1?arguments[1]:void 0,v=void 0!==m,y=0,g=f(p);if(v&&(m=r(m,h>2?arguments[2]:void 0,2)),null==g||d==Array&&u(g))for(n=new d(t=c(p.length));t>y;y++)s(n,y,v?m(p[y],y):p[y]);else for(l=g.call(p),n=new d;!(o=l.next()).done;y++)s(n,y,v?i(l,m,[o.value,y],!0):o.value);return n.length=y,n}})},function(e,t,n){var r=n(12);e.exports=function(e,t,n,o){try{return o?t(r(n)[0],n[1]):t(n)}catch(t){var a=e.return;throw void 0!==a&&r(a.call(e)),t}}},function(e,t,n){var r=n(34),o=n(52)("iterator"),a=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||a[o]===e)}},function(e,t,n){var r=n(11),o=n(19);e.exports=function(e,t,n){t in e?r.f(e,t,o(0,n)):e[t]=n}},function(e,t,n){var r=n(60),o=n(52)("iterator"),a=n(34);e.exports=n(7).getIteratorMethod=function(e){if(null!=e)return e[o]||e["@@iterator"]||a[r(e)]}},function(e,t,n){var r=n(42),o=n(52)("toStringTag"),a="Arguments"==r(function(){return arguments}()),i=function(e,t){try{return e[t]}catch(e){}};e.exports=function(e){var t,n,u;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=i(t=Object(e),o))?n:a?r(t):"Object"==(u=r(t))&&"function"==typeof t.callee?"Arguments":u}},function(e,t,n){var r=n(52)("iterator"),o=!1;try{var a=[7][r]();a.return=function(){o=!0},Array.from(a,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!o)return!1;var n=!1;try{var a=[7],i=a[r]();i.next=function(){return{done:n=!0}},a[r]=function(){return i},e(a)}catch(e){}return n}},function(e,t,n){e.exports={default:n(63),__esModule:!0}},function(e,t,n){var r=n(7),o=r.JSON||(r.JSON={stringify:JSON.stringify});e.exports=function(e){return o.stringify.apply(o,arguments)}},function(e,t){e.exports={name:"en-US",months:["january","february","march","april","may","june","july","august","september","october","november","december"],monthsShort:["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"],days:["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],daysShort:["su","mo","tu","we","th","fr","sa"],thousandSeparator:" ",decimalSeparator:".",formats:{"General Number":"#.#",Currency:"$ #,##0.00;[Red]$ -#,##0.00",Fixed:"0.00",Standard:"#,##0.00",Percent:"0.00%",Scientific:"0.00E+00","Yes/No":\'"Yes";"Yes";"No"\',"True/False":\'"True";"True";"False"\',"On/Off":\'"On";"On";"Off"\',"Short Date":"mm.dd.yyyy","Long Date":"dd mmmm yyyy","General Date":"mm.dd.yyyy h:mm","Medium Date":"dd.mmm.yy","Long Time":"hh:mm:ss AM/PM","Short Time":"h:mm","Medium Time":"hh:mm AM/PM"}}}]));const formatters={};function buildDateFormatterLocale(name,nfi){const{thousandSeparator:thousandSeparator,decimalSeparator:decimalSeparator}=nfi;return{name:name,thousandSeparator:thousandSeparator,decimalSeparator:decimalSeparator,formats:{}}}function formatNumberWithPattern(value,pattern,locale){var _a;const key=`${locale.decimalSeparator}<|>${locale.thousandSeparator}`,numberFormatter=null!==(_a=formatters[key])&&void 0!==_a?_a:formatters[key]=new DataFormatter({locale:key,locales:[buildDateFormatterLocale(key,locale)]});pattern=pattern.replace(/ /g,"\\\\ ").replace(/\\.([^0\\#])/g,"$1").replace(/[\'"]/g,"");const result=numberFormatter.format(value,"Number",pattern).value;return null!=result?result:""}function specifyPrecision(pattern,digits,forced=!0){return pattern.replace(/\\.[0#]*/g,(digits?".":"")+(forced?"0":"#").repeat(digits))}const numberFormatMapping={p:"Percent",c:"Currency"},standardFormatRegex=/^[cdefgnprx][0-9]*$/i;function formatNumber(value,pattern,locale){if(isNaN(value))return value.toString();let fullPattern=pattern||"g";if(standardFormatRegex.test(fullPattern)){const formatSpecifier=fullPattern[0].toLowerCase(),precisionSpecifier=fullPattern.substr(1)?parseInt(fullPattern.substr(1),10)||0:void 0;switch(formatSpecifier){case"x":let hexValue=Math.round(value).toString(16).toLowerCase();return precisionSpecifier&&hexValue.length<precisionSpecifier&&(hexValue="0".repeat(precisionSpecifier-hexValue.length)+hexValue),"X"===fullPattern[0]&&(hexValue=hexValue.toUpperCase()),hexValue;case"r":return value.toString();case"g":fullPattern=function(value,precisionSpecifier){if(!value)return"0";const precision=precisionSpecifier||15,exponent=parseFloat(value.toExponential().toLowerCase().split("e")[1]);if(exponent>-5&&exponent<precision){const decimals=precision-exponent-1;return"0"+(!Number.isInteger(value)&&decimals>0&&!/\\.0+$/.test(value.toFixed(decimals))?"."+"#".repeat(decimals):"")}return"0"+(precision>1?".0":"")+(precision>2?"#".repeat(precision-2):"")+"E+######00"}(value,null!=precisionSpecifier?precisionSpecifier:0);break;case"d":fullPattern="0".repeat(Math.max(null!=precisionSpecifier?precisionSpecifier:0,1));break;case"f":fullPattern="0.00";break;case"n":fullPattern="#,##0.##";break;case"e":fullPattern="0.000000E+000";break;default:return locale.Format(value,numberFormatMapping[formatSpecifier],precisionSpecifier)}["f","n","e"].includes(formatSpecifier)&&null!=precisionSpecifier&&(fullPattern=specifyPrecision(fullPattern,precisionSpecifier))}return formatNumberWithPattern(value,fullPattern,locale.FormatInfo)}const locales={};function addLocale(locale,...aliases){locales[locale.name]=locale,aliases.forEach((alias=>{if(alias){const newLocale=Object.assign({},locale);newLocale.name=alias.toLowerCase(),locales[newLocale.name]=newLocale}}))}addLocale({name:"be-by",months:["\\u0441\\u0442\\u0443\\u0434\\u0437\\u0435\\u043d\\u044c","\\u043b\\u044e\\u0442\\u044b","\\u0441\\u0430\\u043a\\u0430\\u0432\\u0456\\u043a","\\u043a\\u0440\\u0430\\u0441\\u0430\\u0432\\u0456\\u043a","\\u043c\\u0430\\u0439","\\u0447\\u044d\\u0440\\u0432\\u0435\\u043d\\u044c","\\u043b\\u0456\\u043f\\u0435\\u043d\\u044c","\\u0436\\u043d\\u0456\\u0432\\u0435\\u043d\\u044c","\\u0432\\u0435\\u0440\\u0430\\u0441\\u0435\\u043d\\u044c","\\u043a\\u0430\\u0441\\u0442\\u0440\\u044b\\u0447\\u043d\\u0456\\u043a","\\u043b\\u0456\\u0441\\u0442\\u0430\\u043f\\u0430\\u0434","\\u0441\\u043d\\u0435\\u0436\\u0430\\u043d\\u044c",""],monthsDeclined:["\\u0441\\u0442\\u0443\\u0434\\u0437\\u0435\\u043d\\u044f","\\u043b\\u044e\\u0442\\u0430\\u0433\\u0430","\\u0441\\u0430\\u043a\\u0430\\u0432\\u0456\\u043a\\u0430","\\u043a\\u0440\\u0430\\u0441\\u0430\\u0432\\u0456\\u043a\\u0430","\\u043c\\u0430\\u044f","\\u0447\\u044d\\u0440\\u0432\\u0435\\u043d\\u044f","\\u043b\\u0456\\u043f\\u0435\\u043d\\u044f","\\u0436\\u043d\\u0456\\u045e\\u043d\\u044f","\\u0432\\u0435\\u0440\\u0430\\u0441\\u043d\\u044f","\\u043a\\u0430\\u0441\\u0442\\u0440\\u044b\\u0447\\u043d\\u0456\\u043a\\u0430","\\u043b\\u0456\\u0441\\u0442\\u0430\\u043f\\u0430\\u0434\\u0430","\\u0441\\u043d\\u0435\\u0436\\u043d\\u044f",""],monthsShort:["\\u0441\\u0442\\u0443\\u0434\\u0437","\\u043b\\u044e\\u0442","\\u0441\\u0430\\u043a","\\u043a\\u0440\\u0430\\u0441","\\u043c\\u0430\\u0439","\\u0447\\u044d\\u0440\\u0432","\\u043b\\u0456\\u043f","\\u0436\\u043d","\\u0432\\u0435\\u0440","\\u043a\\u0430\\u0441\\u0442\\u0440","\\u043b\\u0456\\u0441\\u0442","\\u0441\\u043d\\u0435\\u0436",""],days:["\\u043d\\u044f\\u0434\\u0437\\u0435\\u043b\\u044f","\\u043f\\u0430\\u043d\\u044f\\u0434\\u0437\\u0435\\u043b\\u0430\\u043a","\\u0430\\u045e\\u0442\\u043e\\u0440\\u0430\\u043a","\\u0441\\u0435\\u0440\\u0430\\u0434\\u0430","\\u0447\\u0430\\u0446\\u0432\\u0435\\u0440","\\u043f\\u044f\\u0442\\u043d\\u0456\\u0446\\u0430","\\u0441\\u0443\\u0431\\u043e\\u0442\\u0430"],daysShort:["\\u043d\\u0434","\\u043f\\u043d","\\u0430\\u045e\\u0442","\\u0441\\u0440","\\u0447\\u0446","\\u043f\\u0442","\\u0441\\u0431"],quarters:["1","2","3","4"],amPm:["",""],amPmShort:["",""],era:"\\u043d.\\u044d.",thousandSeparator:"\\xa0",decimalSeparator:",",formats:{Percent:"###,###,##0.00 %;-###,###,##0.00 %",Currency:"###,###,##0.00 Br;-###,###,##0.00 Br","Short date":"dd.MM.yy","Long date":"d MMMM yyyy","Month/day":"d MMMM","Short time":"HH:mm","Long time":"HH:mm:ss","Year/month":"MMMM yyyy \\u0433."}},"be"),addLocale({name:"de-de",months:["Januar","Februar","M\\xe4rz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember",""],monthsDeclined:["Januar","Februar","M\\xe4rz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember",""],monthsShort:["Jan","Feb","Mrz","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez",""],days:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],daysShort:["So","Mo","Di","Mi","Do","Fr","Sa"],quarters:["1","2","3","4"],amPm:["",""],amPmShort:["",""],era:"n. Chr.",thousandSeparator:".",decimalSeparator:",",formats:{Percent:"###,###,##0.00%;-###,###,##0.00%",Currency:"###,###,##0.00 \\u20ac;-###,###,##0.00 \\u20ac","Short date":"dd.MM.yyyy","Long date":"dddd, d. MMMM yyyy","Month/day":"dd MMMM","Short time":"HH:mm","Long time":"HH:mm:ss","Year/month":"MMMM yyyy"}},"de"),addLocale({name:"en-ca",months:["January","February","March","April","May","June","July","August","September","October","November","December",""],monthsDeclined:["January","February","March","April","May","June","July","August","September","October","November","December",""],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],quarters:["Q1","Q2","Q3","Q4"],amPm:["AM","PM"],amPmShort:["A","P"],era:"A.D.",thousandSeparator:",",decimalSeparator:".",formats:{Percent:"###,###,##0.00 %;-###,###,##0.00 %",Currency:"$###,###,##0.00;-$###,###,##0.00","Short date":"dd/MM/yyyy","Long date":"MMMM-dd-yy","Month/day":"MMMM dd","Short time":"h:mm tt","Long time":"h:mm:ss tt","Year/month":"MMMM, yyyy"}}),addLocale({name:"en-gb",months:["January","February","March","April","May","June","July","August","September","October","November","December",""],monthsDeclined:["January","February","March","April","May","June","July","August","September","October","November","December",""],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],quarters:["Q1","Q2","Q3","Q4"],amPm:["AM","PM"],amPmShort:["A","P"],era:"A.D.",thousandSeparator:",",decimalSeparator:".",formats:{Percent:"###,###,##0.00 %;-###,###,##0.00 %",Currency:"\\xa3###,###,##0.00;-\\xa3###,###,##0.00","Short date":"dd/MM/yyyy","Long date":"dd MMMM yyyy","Month/day":"dd MMMM","Short time":"HH:mm","Long time":"HH:mm:ss","Year/month":"MMMM yyyy"}}),addLocale({name:"en-us",months:["January","February","March","April","May","June","July","August","September","October","November","December",""],monthsDeclined:["January","February","March","April","May","June","July","August","September","October","November","December",""],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],quarters:["Q1","Q2","Q3","Q4"],amPm:["AM","PM"],amPmShort:["A","P"],era:"A.D.",thousandSeparator:",",decimalSeparator:".",formats:{Percent:"###,###,##0.00 %;-###,###,##0.00 %",Currency:"$###,###,##0.00;($###,###,##0.00)","Short date":"M/d/yyyy","Long date":"dddd, MMMM dd, yyyy","Month/day":"MMMM dd","Short time":"h:mm tt","Long time":"h:mm:ss tt","Year/month":"MMMM, yyyy"}},"en"),addLocale({name:"es-es",months:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre",""],monthsDeclined:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre",""],monthsShort:["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","sep.","oct.","nov.","dic.",""],days:["domingo","lunes","martes","mi\\xe9rcoles","jueves","viernes","s\\xe1bado"],daysShort:["do.","lu.","ma.","mi.","ju.","vi.","s\\xe1."],quarters:["1","2","3","4"],amPm:["",""],amPmShort:["",""],era:"d. C.",thousandSeparator:".",decimalSeparator:",",formats:{Percent:"###,###,##0.00 %;-###,###,##0.00 %",Currency:"###,###,##0.00 \\u20ac;-###,###,##0.00 \\u20ac","Short date":"dd/MM/yyyy","Long date":\'dddd, d" de "MMMM" de "yyyy\',"Month/day":\'d "de" MMMM\',"Short time":"H:mm","Long time":"H:mm:ss","Year/month":\'MMMM" de "yyyy\'}},"es"),addLocale({name:"ja-jp",months:["1\\u6708","2\\u6708","3\\u6708","4\\u6708","5\\u6708","6\\u6708","7\\u6708","8\\u6708","9\\u6708","10\\u6708","11\\u6708","12\\u6708",""],monthsDeclined:["1\\u6708","2\\u6708","3\\u6708","4\\u6708","5\\u6708","6\\u6708","7\\u6708","8\\u6708","9\\u6708","10\\u6708","11\\u6708","12\\u6708",""],monthsShort:["1","2","3","4","5","6","7","8","9","10","11","12",""],days:["\\u65e5\\u66dc\\u65e5","\\u6708\\u66dc\\u65e5","\\u706b\\u66dc\\u65e5","\\u6c34\\u66dc\\u65e5","\\u6728\\u66dc\\u65e5","\\u91d1\\u66dc\\u65e5","\\u571f\\u66dc\\u65e5"],daysShort:["\\u65e5","\\u6708","\\u706b","\\u6c34","\\u6728","\\u91d1","\\u571f"],quarters:["Q1","Q2","Q3","Q4"],amPm:["\\u5348\\u524d","\\u5348\\u5f8c"],amPmShort:["\\u5348","\\u5348"],era:"\\u897f\\u66a6",thousandSeparator:",",decimalSeparator:".",formats:{Percent:"###,###,##0.00%;-###,###,##0.00%",Currency:"\\xa5###,###,##0.;-\\xa5###,###,##0.","Short date":"yyyy/MM/dd","Long date":\'yyyy"\\u5e74"M"\\u6708"d"\\u65e5"\',"Month/day":\'M"\\u6708"d"\\u65e5"\',"Short time":"H:mm","Long time":"H:mm:ss","Year/month":\'yyyy"\\u5e74"M"\\u6708"\'}},"ja"),addLocale({name:"ko-kr",months:["1\\uc6d4","2\\uc6d4","3\\uc6d4","4\\uc6d4","5\\uc6d4","6\\uc6d4","7\\uc6d4","8\\uc6d4","9\\uc6d4","10\\uc6d4","11\\uc6d4","12\\uc6d4",""],monthsDeclined:["1\\uc6d4","2\\uc6d4","3\\uc6d4","4\\uc6d4","5\\uc6d4","6\\uc6d4","7\\uc6d4","8\\uc6d4","9\\uc6d4","10\\uc6d4","11\\uc6d4","12\\uc6d4",""],monthsShort:["1","2","3","4","5","6","7","8","9","10","11","12",""],days:["\\uc77c\\uc694\\uc77c","\\uc6d4\\uc694\\uc77c","\\ud654\\uc694\\uc77c","\\uc218\\uc694\\uc77c","\\ubaa9\\uc694\\uc77c","\\uae08\\uc694\\uc77c","\\ud1a0\\uc694\\uc77c"],daysShort:["\\uc77c","\\uc6d4","\\ud654","\\uc218","\\ubaa9","\\uae08","\\ud1a0"],quarters:["1","2","3","4"],amPm:["\\uc624\\uc804","\\uc624\\ud6c4"],amPmShort:["\\uc624","\\uc624"],era:"\\uc11c\\uae30",thousandSeparator:",",decimalSeparator:".",formats:{Percent:"###,###,##0.00%;-###,###,##0.00%",Currency:"\\u20a9###,###,##0.;-\\u20a9###,###,##0.","Short date":"yyyy-MM-dd","Long date":\'yyyy"\\ub144" M"\\uc6d4" d"\\uc77c" dddd\',"Month/day":"M\\uc6d4 d\\uc77c","Short time":"tt h:mm","Long time":"tt h:mm:ss","Year/month":\'yyyy"\\ub144" M"\\uc6d4"\'}},"ko"),addLocale({name:"nl-be",months:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december",""],monthsDeclined:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december",""],monthsShort:["jan","feb","mrt","apr","mei","jun","jul","aug","sep","okt","nov","dec",""],days:["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"],daysShort:["zo","ma","di","wo","do","vr","za"],quarters:["1","2","3","4"],amPm:["",""],amPmShort:["",""],era:"A.D.",thousandSeparator:".",decimalSeparator:",",formats:{Percent:"###,###,##0.00%;-###,###,##0.00%",Currency:"\\u20ac ###,###,##0.00;\\u20ac -###,###,##0.00","Short date":"d/MM/yyyy","Long date":"dddd d MMMM yyyy","Month/day":"d MMMM","Short time":"H:mm","Long time":"H:mm:ss","Year/month":"MMMM yyyy"}},"nl"),addLocale({name:"nl-nl",months:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december",""],monthsDeclined:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december",""],monthsShort:["jan","feb","mrt","apr","mei","jun","jul","aug","sep","okt","nov","dec",""],days:["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"],daysShort:["zo","ma","di","wo","do","vr","za"],quarters:["1","2","3","4"],amPm:["",""],amPmShort:["",""],era:"n.Chr.",thousandSeparator:".",decimalSeparator:",",formats:{Percent:"###,###,##0.00%;-###,###,##0.00%",Currency:"\\u20ac ###,###,##0.00;\\u20ac -###,###,##0.00","Short date":"d-M-yyyy","Long date":"dddd d MMMM yyyy","Month/day":"d MMMM","Short time":"HH:mm","Long time":"HH:mm:ss","Year/month":"MMMM yyyy"}}),addLocale({name:"pt-br",months:["janeiro","fevereiro","mar\\xe7o","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro",""],monthsDeclined:["janeiro","fevereiro","mar\\xe7o","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro",""],monthsShort:["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez",""],days:["domingo","segunda-feira","ter\\xe7a-feira","quarta-feira","quinta-feira","sexta-feira","s\\xe1bado"],daysShort:["dom","seg","ter","qua","qui","sex","s\\xe1b"],quarters:["Q1","Q2","Q3","Q4"],amPm:["",""],amPmShort:["",""],era:"d.C.",thousandSeparator:".",decimalSeparator:",",formats:{Percent:"###,###,##0.00%;-###,###,##0.00%",Currency:"R$ ###,###,##0.00;-R$ ###,###,##0.00","Short date":"dd/MM/yyyy","Long date":\'dddd, d" de "MMMM" de "yyyy\',"Month/day":\'d "de" MMMM\',"Short time":"HH:mm","Long time":"HH:mm:ss","Year/month":\'MMMM" de "yyyy\'}}),addLocale({name:"ru-ru",months:["\\u042f\\u043d\\u0432\\u0430\\u0440\\u044c","\\u0424\\u0435\\u0432\\u0440\\u0430\\u043b\\u044c","\\u041c\\u0430\\u0440\\u0442","\\u0410\\u043f\\u0440\\u0435\\u043b\\u044c","\\u041c\\u0430\\u0439","\\u0418\\u044e\\u043d\\u044c","\\u0418\\u044e\\u043b\\u044c","\\u0410\\u0432\\u0433\\u0443\\u0441\\u0442","\\u0421\\u0435\\u043d\\u0442\\u044f\\u0431\\u0440\\u044c","\\u041e\\u043a\\u0442\\u044f\\u0431\\u0440\\u044c","\\u041d\\u043e\\u044f\\u0431\\u0440\\u044c","\\u0414\\u0435\\u043a\\u0430\\u0431\\u0440\\u044c",""],monthsDeclined:["\\u044f\\u043d\\u0432\\u0430\\u0440\\u044f","\\u0444\\u0435\\u0432\\u0440\\u0430\\u043b\\u044f","\\u043c\\u0430\\u0440\\u0442\\u0430","\\u0430\\u043f\\u0440\\u0435\\u043b\\u044f","\\u043c\\u0430\\u044f","\\u0438\\u044e\\u043d\\u044f","\\u0438\\u044e\\u043b\\u044f","\\u0430\\u0432\\u0433\\u0443\\u0441\\u0442\\u0430","\\u0441\\u0435\\u043d\\u0442\\u044f\\u0431\\u0440\\u044f","\\u043e\\u043a\\u0442\\u044f\\u0431\\u0440\\u044f","\\u043d\\u043e\\u044f\\u0431\\u0440\\u044f","\\u0434\\u0435\\u043a\\u0430\\u0431\\u0440\\u044f",""],monthsShort:["\\u044f\\u043d\\u0432","\\u0444\\u0435\\u0432","\\u043c\\u0430\\u0440","\\u0430\\u043f\\u0440","\\u043c\\u0430\\u0439","\\u0438\\u044e\\u043d","\\u0438\\u044e\\u043b","\\u0430\\u0432\\u0433","\\u0441\\u0435\\u043d","\\u043e\\u043a\\u0442","\\u043d\\u043e\\u044f","\\u0434\\u0435\\u043a",""],days:["\\u0432\\u043e\\u0441\\u043a\\u0440\\u0435\\u0441\\u0435\\u043d\\u044c\\u0435","\\u043f\\u043e\\u043d\\u0435\\u0434\\u0435\\u043b\\u044c\\u043d\\u0438\\u043a","\\u0432\\u0442\\u043e\\u0440\\u043d\\u0438\\u043a","\\u0441\\u0440\\u0435\\u0434\\u0430","\\u0447\\u0435\\u0442\\u0432\\u0435\\u0440\\u0433","\\u043f\\u044f\\u0442\\u043d\\u0438\\u0446\\u0430","\\u0441\\u0443\\u0431\\u0431\\u043e\\u0442\\u0430"],daysShort:["\\u0412\\u0441","\\u041f\\u043d","\\u0412\\u0442","\\u0421\\u0440","\\u0427\\u0442","\\u041f\\u0442","\\u0421\\u0431"],quarters:["1","2","3","4"],amPm:["",""],amPmShort:["",""],era:"A.D.",thousandSeparator:"\\xa0",decimalSeparator:",",formats:{Percent:"###,###,##0.00%;-###,###,##0.00%",Currency:"###,###,##0.00 \\u20bd;-###,###,##0.00 \\u20bd","Short date":"dd.MM.yyyy","Long date":\'d MMMM yyyy "\\u0433."\',"Month/day":"MMMM dd","Short time":"H:mm","Long time":"H:mm:ss","Year/month":"MMMM yyyy"}},"ru"),addLocale({name:"zh-cn",months:["\\u4e00\\u6708","\\u4e8c\\u6708","\\u4e09\\u6708","\\u56db\\u6708","\\u4e94\\u6708","\\u516d\\u6708","\\u4e03\\u6708","\\u516b\\u6708","\\u4e5d\\u6708","\\u5341\\u6708","\\u5341\\u4e00\\u6708","\\u5341\\u4e8c\\u6708",""],monthsDeclined:["\\u4e00\\u6708","\\u4e8c\\u6708","\\u4e09\\u6708","\\u56db\\u6708","\\u4e94\\u6708","\\u516d\\u6708","\\u4e03\\u6708","\\u516b\\u6708","\\u4e5d\\u6708","\\u5341\\u6708","\\u5341\\u4e00\\u6708","\\u5341\\u4e8c\\u6708",""],monthsShort:["\\u4e00\\u6708","\\u4e8c\\u6708","\\u4e09\\u6708","\\u56db\\u6708","\\u4e94\\u6708","\\u516d\\u6708","\\u4e03\\u6708","\\u516b\\u6708","\\u4e5d\\u6708","\\u5341\\u6708","\\u5341\\u4e00\\u6708","\\u5341\\u4e8c\\u6708",""],days:["\\u661f\\u671f\\u65e5","\\u661f\\u671f\\u4e00","\\u661f\\u671f\\u4e8c","\\u661f\\u671f\\u4e09","\\u661f\\u671f\\u56db","\\u661f\\u671f\\u4e94","\\u661f\\u671f\\u516d"],daysShort:["\\u5468\\u65e5","\\u5468\\u4e00","\\u5468\\u4e8c","\\u5468\\u4e09","\\u5468\\u56db","\\u5468\\u4e94","\\u5468\\u516d"],quarters:["\\u4e00\\u5b63\\u5ea6","\\u4e8c\\u5b63\\u5ea6","\\u4e09\\u5b63\\u5ea6","\\u56db\\u5b63\\u5ea6"],amPm:["\\u4e0a\\u5348","\\u4e0b\\u5348"],amPmShort:["\\u4e0a","\\u4e0b"],era:"\\u516c\\u5143",thousandSeparator:",",decimalSeparator:".",formats:{Percent:"###,###,##0.00%;-###,###,##0.00%",Currency:"\\xa5###,###,##0.00;\\xa5-###,###,##0.00","Short date":"yyyy/M/d","Long date":\'yyyy"\\u5e74"M"\\u6708"d"\\u65e5"\',"Month/day":\'M"\\u6708"d"\\u65e5"\',"Short time":"H:mm","Long time":"H:mm:ss","Year/month":\'yyyy"\\u5e74"M"\\u6708"\'}},"zh","cn"),addLocale({name:"zh-hk",months:["\\u4e00\\u6708","\\u4e8c\\u6708","\\u4e09\\u6708","\\u56db\\u6708","\\u4e94\\u6708","\\u516d\\u6708","\\u4e03\\u6708","\\u516b\\u6708","\\u4e5d\\u6708","\\u5341\\u6708","\\u5341\\u4e00\\u6708","\\u5341\\u4e8c\\u6708",""],monthsDeclined:["\\u4e00\\u6708","\\u4e8c\\u6708","\\u4e09\\u6708","\\u56db\\u6708","\\u4e94\\u6708","\\u516d\\u6708","\\u4e03\\u6708","\\u516b\\u6708","\\u4e5d\\u6708","\\u5341\\u6708","\\u5341\\u4e00\\u6708","\\u5341\\u4e8c\\u6708",""],monthsShort:["\\u4e00\\u6708","\\u4e8c\\u6708","\\u4e09\\u6708","\\u56db\\u6708","\\u4e94\\u6708","\\u516d\\u6708","\\u4e03\\u6708","\\u516b\\u6708","\\u4e5d\\u6708","\\u5341\\u6708","\\u5341\\u4e00\\u6708","\\u5341\\u4e8c\\u6708",""],days:["\\u661f\\u671f\\u65e5","\\u661f\\u671f\\u4e00","\\u661f\\u671f\\u4e8c","\\u661f\\u671f\\u4e09","\\u661f\\u671f\\u56db","\\u661f\\u671f\\u4e94","\\u661f\\u671f\\u516d"],daysShort:["\\u9031\\u65e5","\\u9031\\u4e00","\\u9031\\u4e8c","\\u9031\\u4e09","\\u9031\\u56db","\\u9031\\u4e94","\\u9031\\u516d"],quarters:["1","2","3","4"],amPm:["\\u4e0a\\u5348","\\u4e0b\\u5348"],amPmShort:["\\u4e0a","\\u4e0b"],era:"\\u516c\\u5143",thousandSeparator:",",decimalSeparator:".",formats:{Percent:"###,###,##0.00%;-###,###,##0.00%",Currency:"HK$###,###,##0.00;(HK$###,###,##0.00)","Short date":"d/M/yyyy","Long date":\'yyyy"\\u5e74"M"\\u6708"d"\\u65e5"\',"Month/day":"M\\u6708d\\u65e5","Short time":"H:mm","Long time":"H:mm:ss","Year/month":\'yyyy"\\u5e74"M"\\u6708"\'}}),addLocale({name:"zh-mo",months:["\\u4e00\\u6708","\\u4e8c\\u6708","\\u4e09\\u6708","\\u56db\\u6708","\\u4e94\\u6708","\\u516d\\u6708","\\u4e03\\u6708","\\u516b\\u6708","\\u4e5d\\u6708","\\u5341\\u6708","\\u5341\\u4e00\\u6708","\\u5341\\u4e8c\\u6708",""],monthsDeclined:["\\u4e00\\u6708","\\u4e8c\\u6708","\\u4e09\\u6708","\\u56db\\u6708","\\u4e94\\u6708","\\u516d\\u6708","\\u4e03\\u6708","\\u516b\\u6708","\\u4e5d\\u6708","\\u5341\\u6708","\\u5341\\u4e00\\u6708","\\u5341\\u4e8c\\u6708",""],monthsShort:["\\u4e00\\u6708","\\u4e8c\\u6708","\\u4e09\\u6708","\\u56db\\u6708","\\u4e94\\u6708","\\u516d\\u6708","\\u4e03\\u6708","\\u516b\\u6708","\\u4e5d\\u6708","\\u5341\\u6708","\\u5341\\u4e00\\u6708","\\u5341\\u4e8c\\u6708",""],days:["\\u661f\\u671f\\u65e5","\\u661f\\u671f\\u4e00","\\u661f\\u671f\\u4e8c","\\u661f\\u671f\\u4e09","\\u661f\\u671f\\u56db","\\u661f\\u671f\\u4e94","\\u661f\\u671f\\u516d"],daysShort:["\\u9031\\u65e5","\\u9031\\u4e00","\\u9031\\u4e8c","\\u9031\\u4e09","\\u9031\\u56db","\\u9031\\u4e94","\\u9031\\u516d"],quarters:["1","2","3","4"],amPm:["\\u4e0a\\u5348","\\u4e0b\\u5348"],amPmShort:["\\u4e0a","\\u4e0b"],era:"\\u516c\\u5143",thousandSeparator:",",decimalSeparator:".",formats:{Percent:"###,###,##0.00%;-###,###,##0.00%",Currency:"MOP###,###,##0.00;-MOP###,###,##0.00","Short date":"d/M/yyyy","Long date":\'yyyy"\\u5e74"M"\\u6708"d"\\u65e5"\',"Month/day":"M\\u6708d\\u65e5","Short time":"H:mm","Long time":"H:mm:ss","Year/month":\'yyyy"\\u5e74"M"\\u6708"\'}}),addLocale({name:"zh-sg",months:["\\u4e00\\u6708","\\u4e8c\\u6708","\\u4e09\\u6708","\\u56db\\u6708","\\u4e94\\u6708","\\u516d\\u6708","\\u4e03\\u6708","\\u516b\\u6708","\\u4e5d\\u6708","\\u5341\\u6708","\\u5341\\u4e00\\u6708","\\u5341\\u4e8c\\u6708",""],monthsDeclined:["\\u4e00\\u6708","\\u4e8c\\u6708","\\u4e09\\u6708","\\u56db\\u6708","\\u4e94\\u6708","\\u516d\\u6708","\\u4e03\\u6708","\\u516b\\u6708","\\u4e5d\\u6708","\\u5341\\u6708","\\u5341\\u4e00\\u6708","\\u5341\\u4e8c\\u6708",""],monthsShort:["\\u4e00\\u6708","\\u4e8c\\u6708","\\u4e09\\u6708","\\u56db\\u6708","\\u4e94\\u6708","\\u516d\\u6708","\\u4e03\\u6708","\\u516b\\u6708","\\u4e5d\\u6708","\\u5341\\u6708","\\u5341\\u4e00\\u6708","\\u5341\\u4e8c\\u6708",""],days:["\\u661f\\u671f\\u65e5","\\u661f\\u671f\\u4e00","\\u661f\\u671f\\u4e8c","\\u661f\\u671f\\u4e09","\\u661f\\u671f\\u56db","\\u661f\\u671f\\u4e94","\\u661f\\u671f\\u516d"],daysShort:["\\u5468\\u65e5","\\u5468\\u4e00","\\u5468\\u4e8c","\\u5468\\u4e09","\\u5468\\u56db","\\u5468\\u4e94","\\u5468\\u516d"],quarters:["1","2","3","4"],amPm:["\\u4e0a\\u5348","\\u4e0b\\u5348"],amPmShort:["\\u4e0a","\\u4e0b"],era:"\\u516c\\u5143",thousandSeparator:",",decimalSeparator:".",formats:{Percent:"###,###,##0.00%;-###,###,##0.00%",Currency:"$###,###,##0.00;-$###,###,##0.00","Short date":"d/M/yyyy","Long date":\'yyyy"\\u5e74"M"\\u6708"d"\\u65e5"\',"Month/day":"M\\u6708d\\u65e5","Short time":"tt h:mm","Long time":"tt h:mm:ss","Year/month":\'yyyy"\\u5e74"M"\\u6708"\'}}),addLocale({name:"zh-tw",months:["\\u4e00\\u6708","\\u4e8c\\u6708","\\u4e09\\u6708","\\u56db\\u6708","\\u4e94\\u6708","\\u516d\\u6708","\\u4e03\\u6708","\\u516b\\u6708","\\u4e5d\\u6708","\\u5341\\u6708","\\u5341\\u4e00\\u6708","\\u5341\\u4e8c\\u6708",""],monthsDeclined:["\\u4e00\\u6708","\\u4e8c\\u6708","\\u4e09\\u6708","\\u56db\\u6708","\\u4e94\\u6708","\\u516d\\u6708","\\u4e03\\u6708","\\u516b\\u6708","\\u4e5d\\u6708","\\u5341\\u6708","\\u5341\\u4e00\\u6708","\\u5341\\u4e8c\\u6708",""],monthsShort:["\\u4e00\\u6708","\\u4e8c\\u6708","\\u4e09\\u6708","\\u56db\\u6708","\\u4e94\\u6708","\\u516d\\u6708","\\u4e03\\u6708","\\u516b\\u6708","\\u4e5d\\u6708","\\u5341\\u6708","\\u5341\\u4e00\\u6708","\\u5341\\u4e8c\\u6708",""],days:["\\u661f\\u671f\\u65e5","\\u661f\\u671f\\u4e00","\\u661f\\u671f\\u4e8c","\\u661f\\u671f\\u4e09","\\u661f\\u671f\\u56db","\\u661f\\u671f\\u4e94","\\u661f\\u671f\\u516d"],daysShort:["\\u9031\\u65e5","\\u9031\\u4e00","\\u9031\\u4e8c","\\u9031\\u4e09","\\u9031\\u56db","\\u9031\\u4e94","\\u9031\\u516d"],quarters:["1","2","3","4"],amPm:["\\u4e0a\\u5348","\\u4e0b\\u5348"],amPmShort:["\\u4e0a","\\u4e0b"],era:"\\u897f\\u5143",thousandSeparator:",",decimalSeparator:".",formats:{Percent:"###,###,##0.00%;-###,###,##0.00%",Currency:"NT$###,###,##0.00;-NT$###,###,##0.00","Short date":"yyyy/M/d","Long date":\'yyyy"\\u5e74"M"\\u6708"d"\\u65e5"\',"Month/day":"M\\u6708d\\u65e5","Short time":"tt hh:mm","Long time":"tt hh:mm:ss","Year/month":\'yyyy"\\u5e74"M"\\u6708"\'}});"undefined"==typeof navigator||(navigator.language||navigator.userLanguage||"en-us").toLowerCase();var kanjidate={};!function(exports){function ge(year1,month1,day1,year2,month2,day2){return year1>year2||!(year1<year2)&&(month1>month2||!(month1<month2)&&day1>=day2)}function gengouToAlpha(gengou){switch(gengou){case"\\u4ee4\\u548c":return"Reiwa";case"\\u5e73\\u6210":return"Heisei";case"\\u662d\\u548c":return"Shouwa";case"\\u5927\\u6b63":return"Taishou";case"\\u660e\\u6cbb":return"Meiji";default:throw new Error("unknown gengou: "+gengou)}}var zenkakuDigits=["\\uff10","\\uff11","\\uff12","\\uff13","\\uff14","\\uff15","\\uff16","\\uff17","\\uff18","\\uff19"],alphaDigits=["0","1","2","3","4","5","6","7","8","9"];function alphaDigitToZenkaku(ch){var i=alphaDigits.indexOf(ch);return i>=0?zenkakuDigits[i]:ch}function isDateObject(obj){return obj instanceof Date}function toGengou(year,month,day){return ge(year,month,day,2019,5,1)?{gengou:"\\u4ee4\\u548c",nen:year-2018}:ge(year,month,day,1989,1,8)?{gengou:"\\u5e73\\u6210",nen:year-1988}:ge(year,month,day,1926,12,25)?{gengou:"\\u662d\\u548c",nen:year-1925}:ge(year,month,day,1912,7,30)?{gengou:"\\u5927\\u6b63",nen:year-1911}:ge(year,month,day,1873,1,1)?{gengou:"\\u660e\\u6cbb",nen:year-1867}:{gengou:"\\u897f\\u66a6",nen:year}}exports.toGengou=toGengou,exports.fromGengou=function(gengou,nen){if((nen=Math.floor(+nen))<0)throw new Error("invalid nen: "+nen);switch(gengou){case"\\u4ee4\\u548c":return 2018+nen;case"\\u5e73\\u6210":return 1988+nen;case"\\u662d\\u548c":return 1925+nen;case"\\u5927\\u6b63":return 1911+nen;case"\\u660e\\u6cbb":return 1867+nen;case"\\u897f\\u66a6":return nen;default:throw new Error("invalid gengou: "+gengou)}};var youbi=["\\u65e5","\\u6708","\\u706b","\\u6c34","\\u6728","\\u91d1","\\u571f"];function KanjiDate(date){this.year=date.getFullYear(),this.month=date.getMonth()+1,this.day=date.getDate(),this.hour=date.getHours(),this.minute=date.getMinutes(),this.second=date.getSeconds(),this.msec=date.getMilliseconds(),this.dayOfWeek=date.getDay();var g=toGengou(this.year,this.month,this.day);this.gengou=g.gengou,this.nen=g.nen,this.youbi=youbi[this.dayOfWeek]}function KanjiDateExplicit(year,month,day,hour,minute,second,millisecond){return void 0===hour&&(hour=0),void 0===minute&&(minute=0),void 0===second&&(second=0),void 0===millisecond&&(millisecond=0),new KanjiDate(new Date(year,month-1,day,hour,minute,second,millisecond))}function KanjiDateFromString(str){var m;if(m=str.match(/^(\\d{4})-(\\d{2})-(\\d{2})$/))return KanjiDateExplicit(+m[1],+m[2],+m[3]);if(m=str.match(/^(\\d{4})-(\\d{2})-(\\d{2}) (\\d{2}):(\\d{2}):(\\d{2})$/))return KanjiDateExplicit(+m[1],+m[2],+m[3],+m[4],+m[5],+m[6]);throw new Error("cannot convert to KanjiDate")}exports.toYoubi=function(dayOfWeek){return youbi[dayOfWeek]};var format1="{G}{N}\\u5e74{M}\\u6708{D}\\u65e5\\uff08{W}\\uff09",format14="{Y}-{M:2}-{D:2} {h:2}:{m:2}:{s:2}";function numberPart(num,opts){var zenkaku=!1,width=1;opts.forEach((function(opt){switch(opt){case"1":width=1;break;case"2":width=2;break;case"z":zenkaku=!0}}));var result=num.toString();return zenkaku&&(result=result.split("").map(alphaDigitToZenkaku).join("")),width>1&&num<10&&(result=(zenkaku?"\\uff10":"0")+result),result}function format(formatStr,kdate){var result,output=[];return(result=[],formatStr.split(/(\\{[^}]+)\\}/).forEach((function(part){if(""!==part)if("{"===part[0]){var token={opts:[]},colon=(part=part.substring(1)).indexOf(":");if(part.indexOf(":")>=0){token.part=part.substring(0,colon);var optStr=part.substring(colon+1).trim();""!==optStr&&(optStr.indexOf(",")>=0?token.opts=optStr.split(/\\s*,\\s*/):token.opts=[optStr])}else token.part=part;result.push(token)}else result.push(part)})),result).forEach((function(token){if("string"==typeof token)output.push(token);else switch(token.part){case"G":output.push(function(kdate,opts){var style="2";switch(opts.forEach((function(opt){["2","1","a","alpha"].indexOf(opt)>=0&&(style=opt)})),style){case"2":return kdate.gengou;case"1":return kdate.gengou[0];case"a":return gengouToAlpha(kdate.gengou)[0];case"alpha":return gengouToAlpha(kdate.gengou);default:return kdate.gengou}}(kdate,token.opts));break;case"N":output.push(function(kdate,opts){return 1===kdate.nen&&opts.indexOf("g")>=0?"\\u5143":numberPart(kdate.nen,opts)}(kdate,token.opts));break;case"M":output.push(numberPart(kdate.month,token.opts));break;case"D":output.push(numberPart(kdate.day,token.opts));break;case"W":output.push(function(kdate,opts){var style;switch(opts.forEach((function(opt){["1","2","3","alpha"].indexOf(opt)>=0&&(style=opt)})),style){case"1":return kdate.youbi;case"2":return kdate.youbi+"\\u66dc";case"3":return kdate.youbi+"\\u66dc\\u65e5";case"alpha":return dayOfWeek[kdate.dayOfWeek];default:return kdate.youbi}}(kdate,token.opts));break;case"h":output.push((hour=kdate.hour,opts=token.opts,ampm=!1,opts.indexOf("12")>=0&&(ampm=!0,opts=function(opts,what){for(var result=[],i=0;i<opts.length;i++){var opt=opts[i];opt!==what&&result.push(opt)}return result}(opts,"12")),ampm&&(hour%=12),numberPart(hour,opts)));break;case"m":output.push(numberPart(kdate.minute,token.opts));break;case"s":output.push(numberPart(kdate.second,token.opts));break;case"a":output.push(function(kdate,opts){var style="kanji";opts.forEach((function(opt){switch(opt){case"am/pm":style="am/pm";break;case"AM/PM":style="AM/PM"}}));var am=kdate.hour<12;switch(style){case"kanji":return am?"\\u5348\\u524d":"\\u5348\\u5f8c";case"am/pm":return am?"am":"pm";case"AM/PM":return am?"AM":"PM";default:throw new Error("unknown style for AM/PM")}}(kdate,token.opts));break;case"Y":output.push((year=kdate.year,token.opts,year.toString()))}var year,hour,opts,ampm})),output.join("")}exports.f1=format1,exports.f2="{G}{N}\\u5e74{M}\\u6708{D}\\u65e5",exports.f3="{G:a}{N}.{M}.{D}",exports.f4="{G}{N:2}\\u5e74{M:2}\\u6708{D:2}\\u65e5\\uff08{W}\\uff09",exports.f5="{G}{N:2}\\u5e74{M:2}\\u6708{D:2}\\u65e5",exports.f6="{G:a}{N:2}.{M:2}.{D:2}",exports.f7="{G}{N}\\u5e74{M}\\u6708{D}\\u65e5\\uff08{W}\\uff09 {a}{h:12}\\u6642{m}\\u5206{s}\\u79d2",exports.f8="{G}{N:2}\\u5e74{M:2}\\u6708{D:2}\\u65e5\\uff08{W}\\uff09 {a}{h:12,2}\\u6642{m:2}\\u5206{s:2}\\u79d2",exports.f9="{G}{N}\\u5e74{M}\\u6708{D}\\u65e5\\uff08{W}\\uff09 {a}{h:12}\\u6642{m}\\u5206",exports.f10="{G}{N:2}\\u5e74{M:2}\\u6708{D:2}\\u65e5\\uff08{W}\\uff09 {a}{h:12,2}\\u6642{m:2}\\u5206",exports.f11="{G}{N:z}\\u5e74{M:z}\\u6708{D:z}\\u65e5",exports.f12="{G}{N:z,2}\\u5e74{M:z,2}\\u6708{D:z,2}\\u65e5",exports.f13="{Y}-{M:2}-{D:2}",exports.f14=format14,exports.fSqlDate="{Y}-{M:2}-{D:2}",exports.fSqlDateTime=format14,exports.format=function(){var formatStr,args,i,narg=arguments.length;if(0===narg)return format(format1,new KanjiDate(new Date));if(1===narg)return format(format1,cvt(arguments[0]));for(null==(formatStr=arguments[0])&&(formatStr=format1),args=[],i=1;i<arguments.length;i++)args.push(arguments[i]);return 1===args.length?format(formatStr,cvt(args[0])):format(formatStr,KanjiDateExplicit.apply(null,args));function cvt(x){if(isDateObject(x))return new KanjiDate(x);if("string"==typeof x)return KanjiDateFromString(x);throw new Error("cannot convert to KanjiDate")}}}(kanjidate);const GENGOU_DATE_START=new Date(Date.UTC(1868,8,7)),KANJIDATE_MIN_SUPPORTED=new Date(Date.UTC(1873,0,1)),jpDate={getEra(date,isAplhabeticalEra){if(date<GENGOU_DATE_START)throw new Error(`${date} is incorrect gengou date. The Gengou calendar begins on September 8, 1868.`);return date<KANJIDATE_MIN_SUPPORTED&&(date=KANJIDATE_MIN_SUPPORTED),isAplhabeticalEra?kanjidate.format("{G:a}",date.getFullYear(),date.getMonth()+1,date.getDate()):kanjidate.toGengou(date.getFullYear(),date.getMonth()+1,date.getDate()).gengou},getYear(date,pattern,fn,previousPattern){let jpYear=date.getFullYear();if(previousPattern&&(previousPattern.startsWith("g")||previousPattern.startsWith("G"))){if(date<GENGOU_DATE_START)throw new Error(`${date} is incorrect gengou date. The Gengou calendar begins on September 8, 1868.`);if(jpYear=date<KANJIDATE_MIN_SUPPORTED?jpYear-GENGOU_DATE_START.getFullYear()+1:kanjidate.toGengou(date.getFullYear(),date.getMonth()+1,date.getDate()).nen,1===jpYear&&pattern.startsWith("Y")&&previousPattern.startsWith("g"))return"\\u5143"}return fn(pattern.length<=2?jpYear%100:jpYear,pattern.length)}},currencyCodes={"ar-AE":"AED","ps-AF":"AFN","sq-AL":"ALL","hy-AM":"AMD","nl-CW":"ANG","ln-AO":"AOA","es-AR":"ARS","en-AU":"AUD","nl-AW":"AWG","az-Cyrl-AZ":"AZN","bs-Cyrl-BA":"BAM","en-BB":"BBD","bn-BD":"BDT","bg-BG":"BGN","ar-BH":"BHD","rn-BI":"BIF","en-BM":"BMD","ms-BN":"BND","es-BO":"BOB","pt-BR":"BRL","en-BS":"BSD","dz-BT":"BTN","en-BW":"BWP","ru-BY":"BYR","en-BZ":"BZD","fr-CA":"CAD","lu-CD":"CDF","rm-CH":"CHF","es-CL":"CLP","ii-CN":"CNY","es-CO":"COP","es-CR":"CRC","es-CU":"CUP","pt-CV":"CVE","en-CZ":"CZK","ar-DJ":"DJF","da-DK":"DKK","es-DO":"DOP","kab-DZ":"DZD","ar-EG":"EGP","ar-ER":"ERN","om-ET":"ETB","en-DE":"EUR","en-FJ":"FJD","en-FK":"FKP","en-GB":"GBP","ka-GE":"GEL","ak-GH":"GHS","en-GG":"GGP","en-GI":"GIP","en-GM":"GMD","fr-GN":"GNF","es-GT":"GTQ","en-GY":"GYD","zh-HK":"HKD","es-HN":"HNL","hr-HR":"HRK","fr-HT":"HTG","en-HU":"HUF","id-ID":"IDR","ar-IL":"ILS","kok-IN":"INR","ar-IQ":"IQD","fa-IR":"IRR","en-IS":"ISK","en-JM":"JMD","ar-JO":"JOD","ja-JP":"JPY","saq-KE":"KES","ru-KG":"KGS","km-KH":"KHR","ar-KM":"KMF","ko-KP":"KPW","ko-KR":"KRW","ar-KW":"KWD","en-KY":"KYD","kk-KZ":"KZT","lo-LA":"LAK","ar-LB":"LBP","ta-LK":"LKR","vai-Latn-LR":"LRD","en-LT":"LTL","en-LV":"LVL","ar-LY":"LYD","ar-MA":"MAD","ru-MD":"MDL","mg-MG":"MGA","sq-MK":"MKD","my-MM":"MMK","mn-Cyrl-MN":"MNT","zh-Hant-MO":"MOP","ar-MR":"MRO","en-MU":"MUR","en-MW":"MWK","es-MX":"MXN","ms-Latn-MY":"MYR","mgh-MZ":"MZN","naq-NA":"NAD","ha-Latn-NG":"NGN","es-NI":"NIO","nn-NO":"NOK","ne-NP":"NPR","en-NZ":"NZD","ar-OM":"OMR","es-PA":"PAB","es-PE":"PEN","en-PG":"PGK","es-PH":"PHP","pa-Arab-PK":"PKR","en-PL":"PLN","es-PY":"PYG","ar-QA":"QAR","en-RO":"RON","sr-Latn-RS":"RSD","ru-RU":"RUB","rw-RW":"RWF","ar-SA":"SAR","en-SB":"SBD","en-SC":"SCR","ar-SD":"SDG","sv-SE":"SEK","ms-Latn-SG":"SGD","en-SH":"SHP","en-SL":"SLL","ar-SO":"SOS","nl-SR":"SRD","pt-ST":"STD","ar-SY":"SYP","en-SZ":"SZL","th-TH":"THB","tg-Cyrl-TJ":"TJS","tk-TM":"TMT","ar-TN":"TND","to-TO":"TOP","tr-TR":"TRY","en-TT":"TTD","zh-Hant-TW":"TWD","sw-TZ":"TZS","ru-UA":"UAH","teo-UG":"UGX","en-US":"USD","es-UY":"UYU","uz-Cyrl-UZ":"UZS","es-VE":"VEF","vi-VN":"VND","en-VU":"VUV","en-WS":"WST","ar-YE":"YER","en-LS":"ZAR","af-ZA":"ZMW","am-ET":"ETB","ar-DZ":"DZD","bn-IN":"INR","bo-CN":"CNY","br-FR":"EUR","ca-ES":"EUR","co-FR":"EUR","cs-CZ":"CZK","cy-GB":"GBP","de-AT":"EUR","de-CH":"CHF","de-DE":"EUR","de-LI":"CHF","de-LU":"EUR","el-GR":"EUR","en-CA":"CAD","en-IE":"EUR","en-IN":"INR","en-MY":"MYR","en-PH":"PHP","en-SG":"SGD","en-ZA":"ZAR","en-ZW":"USD","es-EC":"USD","es-ES":"EUR","es-PR":"USD","es-SV":"USD","es-US":"USD","es-EE":"USD","fi-FI":"EUR","fil-PH":"PHP","fo-FO":"DKK","fr-BE":"EUR","fr-CH":"EUR","fr-FR":"EUR","fr-LU":"EUR","fr-MC":"EUR","fy-NL":"EUR","ga-IE":"EUR","gl-ES":"EUR","gu-IN":"INR","he-IL":"ILS","hi-IN":"INR","hr-BA":"BAM","hu-HU":"HUF","ig-NG":"NGN","is-IS":"ISK","it-CH":"EUR","it-IT":"EUR","kl-GL":"DKK","kn-IN":"INR","ky-KG":"KGS","lb-LU":"EUR","lt-LT":"EUR","lv-LV":"EUR","mi-NZ":"NZD","mk-MK":"MKD","ml-IN":"INR","mr-IN":"INR","ms-MY":"MYR","mt-MT":"EUR","nb-NO":"NOK","nl-BE":"EUR","nl-NL":"EUR","oc-FR":"EUR","or-IN":"INR","pa-IN":"INR","pl-PL":"PLN","pt-PT":"EUR","rp-RO":"USD","sa-IN":"INR","se-FI":"EUR","se-NO":"NOK","se-SE":"SEK","si-LK":"LKR","sk-SK":"EUR","sl-SL":"EUR","sv-FI":"EUR","sw-KE":"KES","syr-SY":"SYP","ta-IN":"INR","te-IN":"INR","tn-ZA":"ZAR","ug-CN":"CNY","uk-UA":"UAH","ur-PK":"PKR","wo-SN":"XOF","xh-ZA":"ZAR","yo-NG":"NGN","zh-CN":"CNY","zh-MO":"CNY","zh-SG":"SGD","zh-TW":"TWD","zu-ZA":"ZAR"};function buildDateTimeFormatInfo(locale){var _a,_b;const dateFormats={weekDay:Intl.DateTimeFormat(locale,{weekday:"long"}),weekDayShort:Intl.DateTimeFormat(locale,{weekday:"short"}),monthDay:Intl.DateTimeFormat(locale,{month:"long"}),monthDayShort:Intl.DateTimeFormat(locale,{month:"short"}),dateLong:Intl.DateTimeFormat(locale,{dateStyle:"long"}),timeShort:Intl.DateTimeFormat(locale,{timeStyle:"short"}),hours12:Intl.DateTimeFormat(locale,{hour12:!0,hour:"numeric"}),yearEra:Intl.DateTimeFormat("ja-JP"===locale?"ja-JP-u-ca-japanese":locale,{year:"numeric",era:"short"})},customDate=locale.startsWith("ja-JP")?{getCustomEra:date=>{var _a,_b;return null!==(_b=null===(_a=dateFormats.yearEra.formatToParts(date).find((p=>"era"===p.type)))||void 0===_a?void 0:_a.value)&&void 0!==_b?_b:""},getCustomYear:(date,pattern,fn,previousPattern)=>jpDate.getYear(date,pattern,fn,previousPattern)}:{},januarySunday=dateTimeFactory_createFromJsDate(new Date("2022-01-02T00:00:00Z")),weekDays=[...Array(7).keys()].map((d=>januarySunday.add(d,"days").toDate())),yearMonths=[...Array(12).keys()].map((d=>januarySunday.add(d,"months").toDate())),amPm=[januarySunday.startOfDay().add(1,"hours").toDate(),januarySunday.startOfDay().add(13,"hours").toDate()];return Object.assign({months:yearMonths.map((date=>dateFormats.monthDay.format(date))),monthsDeclined:yearMonths.map((date=>{var _a,_b;return null!==(_b=null===(_a=dateFormats.dateLong.formatToParts(date).find((obj=>"month"===obj.type)))||void 0===_a?void 0:_a.value)&&void 0!==_b?_b:""})),monthsShort:yearMonths.map((date=>dateFormats.monthDayShort.format(date))),days:weekDays.map((date=>dateFormats.weekDay.format(date))),daysShort:weekDays.map((date=>dateFormats.weekDayShort.format(date))),quarters:getQuarters(locale),amPm:amPm.map((date=>{var _a,_b;return null!==(_b=null===(_a=dateFormats.hours12.formatToParts(date).find((p=>"dayPeriod"===p.type)))||void 0===_a?void 0:_a.value)&&void 0!==_b?_b:""})),amPmShort:amPm.map((date=>{var _a,_b;return null!==(_b=null===(_a=dateFormats.hours12.formatToParts(date).find((p=>"dayPeriod"===p.type)))||void 0===_a?void 0:_a.value.charAt(0))&&void 0!==_b?_b:""})),era:null!==(_b=null===(_a=dateFormats.yearEra.formatToParts(new Date).find((p=>"era"===p.type)))||void 0===_a?void 0:_a.value)&&void 0!==_b?_b:""},customDate)}function getQuarters(locale){switch(locale){case"en-US":case"ja-JP":case"en-GB":case"pt-BR":case"en-CA":return["Q1","Q2","Q3","Q4"];case"zh-CN":return["\\u4e00\\u5b63\\u5ea6","\\u4e8c\\u5b63\\u5ea6","\\u4e09\\u5b63\\u5ea6","\\u56db\\u5b63\\u5ea6"];default:return["1","2","3","4"]}}function buildNumberFormatInfo(locale){var _a,_b;const parts=Intl.NumberFormat(locale).formatToParts(1000.1),decimalSeparator=null===(_a=parts.find((p=>"decimal"===p.type)))||void 0===_a?void 0:_a.value,thousandSeparator=null===(_b=parts.find((p=>"group"===p.type)))||void 0===_b?void 0:_b.value;return{decimalSeparator:null!=decimalSeparator?decimalSeparator:"."!==thousandSeparator?".":",",thousandSeparator:null!=thousandSeparator?thousandSeparator:""}}const localesCache={},localeProvider=(providers=[{getLocale(locale){const localeData=locales[locale.toLowerCase()];if(!localeData)return null;const dateFormats={"Short date":localeData.formats["Short date"],"Long date":localeData.formats["Long date"],"Month/day":localeData.formats["Month/day"],"Short time":localeData.formats["Short time"],"Long time":localeData.formats["Long time"],"Year/month":localeData.formats["Year/month"]},numberFormats={Percent:localeData.formats.Percent,Currency:localeData.formats.Currency},customDate=locale.startsWith("ja-JP")?{getCustomEra:(date,isAplhabeticalEra)=>jpDate.getEra(date,isAplhabeticalEra),getCustomYear:(date,pattern,fn,previousPattern)=>jpDate.getYear(date,pattern,fn,previousPattern)}:{};return{DateTime:{FormatInfo:Object.assign(Object.assign({},localeData),customDate),Format(value,formatKey){const pattern=dateFormats[formatKey];if(!pattern)throw new Error("Invalid DateTime format alias.");return formatDateTimeWithPattern(value,pattern,localeData,!1)}},Number:{FormatInfo:localeData,Format(value,formatKey,precision){const pattern=numberFormats[formatKey];if(!pattern)throw new Error("Invalid Number format alias.");return formatNumberWithPattern(value,null!=precision?specifyPrecision(pattern,precision):pattern,localeData)}}}}},{getLocale(locale){var _a,_b;const cached=localesCache[locale.toLowerCase()];if(cached)return cached;try{if(0===Intl.DateTimeFormat.supportedLocalesOf([locale],{localeMatcher:"lookup"}).length||0===Intl.NumberFormat.supportedLocalesOf([locale],{localeMatcher:"lookup"}).length)return null}catch(_c){return null}const dateFormats={dateLong:Intl.DateTimeFormat(locale,{dateStyle:"full"}),dateShort:Intl.DateTimeFormat(locale,{dateStyle:"short"}),timeLong:Intl.DateTimeFormat(locale,{timeStyle:"medium"}),timeShort:Intl.DateTimeFormat(locale,{timeStyle:"short"}),monthDay:Intl.DateTimeFormat(locale,{month:"long",day:"numeric"}),yearMonth:Intl.DateTimeFormat(locale,{year:"numeric",month:"long"})},currencyCode=null!==(_b=null===(_a=Object.entries(currencyCodes).find((kvPair=>locale.toLowerCase().startsWith(kvPair[0].toLowerCase()))))||void 0===_a?void 0:_a[1])&&void 0!==_b?_b:"USD",result={DateTime:{FormatInfo:buildDateTimeFormatInfo(locale),Format(value,formatKey){switch(formatKey){case"Short date":return dateFormats.dateShort.format(value);case"Long date":return dateFormats.dateLong.format(value);case"Short time":return dateFormats.timeShort.format(value);case"Long time":return dateFormats.timeLong.format(value);case"Month/day":return dateFormats.monthDay.format(value);case"Year/month":return dateFormats.yearMonth.format(value);default:throw new Error("Invalid DateTime format alias.")}}},Number:{FormatInfo:buildNumberFormatInfo(locale),Format(value,formatKey,precision){const precisionFormat={minimumFractionDigits:null!=precision?precision:2,maximumFractionDigits:null!=precision?precision:2};switch(formatKey){case"Currency":return Intl.NumberFormat(locale,Object.assign(Object.assign({},precisionFormat),{style:"currency",currency:currencyCode})).format(value);case"Percent":return Intl.NumberFormat(locale,Object.assign(Object.assign({},precisionFormat),{style:"percent"})).format(value);default:throw new Error("Invalid Number format alias.")}}}};return localesCache[locale.toLowerCase()]=result,result}}],{getLocale(locale){for(const provider of providers){const loc=provider.getLocale(locale);if(loc)return loc}return null}});var providers;const browserLocale="undefined"!=typeof navigator&&(navigator.language||navigator.userLanguage)||"en-US",fallbackLocales="en-US"===browserLocale?["en-US"]:[browserLocale,"en-US"];function formatValue(value,locale,format){if(Array.isArray(value))return value.map((val=>formatValue(val,locale,format))).join(", ");if(null==value)return"";const localesList="r"===(null==format?void 0:format.toLowerCase())?["en-US"]:locale?[locale,...fallbackLocales.filter((l=>l!==locale))]:fallbackLocales;let localeInfo=null;for(const l of localesList)if(localeInfo=localeProvider.getLocale(l),localeInfo)break;if(null==localeInfo)throw new Error(`Unable to format value: none of locales \'${localesList}\' can be resolved.`);if(isVariant$2(value))switch(value.Type){case"Date":case"TimeSpan":return formatDateTime(value.Value.toDate(),format,localeInfo.DateTime);case"Decimal":case"Double":case"Float":case"Int32":case"Int64":return formatNumber(value.Value,format,localeInfo.Number);default:return Convert$1.toString(value)}return format&&"string"==typeof value&&function(value,format){return pattern=format,dateTimeFormatKeys.includes(pattern)&&(value=>value&&value.length>11&&"-"===value[4]&&"-"===value[7]&&"T"===value[10]&&iso8601.test(value))(value);var pattern}(value,format)&&(value=dateTimeFactory_createFromString(value)),dateTimeFactory_isDateTime(value)?formatDateTime(value.toDate(),format,localeInfo.DateTime):"string"==typeof value?value||"":"number"==typeof value?formatNumber(value,format,localeInfo.Number):"boolean"==typeof value?value?"True":"False":`${value}`}const iso8601=/^(-?(?:[1-9][0-9]*)?[0-9]{4})-(1[0-2]|0[1-9])-(3[01]|0[1-9]|[12][0-9])T(2[0-3]|[01][0-9]):([0-5][0-9]):([0-5][0-9])(.[0-9]+)?(Z)?$/;const ISOformat$1={ISO_8601:!0},dateTimeFormats=[ISOformat$1,"MM/dd/YYYY","MM/dd/YYYY HH:mm","MM/dd/YYYY HH:mm:ss","YYYY-MM-ddTHH:mm:ss.fffffff","YYYY-MM-dd HH:mm:sszzz","YYYY-MM-ddTHH:mm:ss","HH:mm","HH:mm:ss"],timeFormats=["H:m","H:m:s","htt","h tt","h:mtt","h:m tt","h:m:stt","h:m:s tt"];function vbRound(n){const v=Math.trunc(n);return v+(Math.abs(n-v)>.5?1:0)*Math.sign(n)}function getNumberValue(v,integer=!1){switch(v.Type){case"Bool":return v.Value?-1:0;case"Int32":case"Int64":case"UInt64":case"Float":case"Double":case"Decimal":return v.Value;case"String":return function(s,integer=!1){if(!(integer?/^\\-?[0-9]+$/:/^\\-?[0-9]+(\\.[0-9]*)?$/).test(s))throw new Error(`Invalid number format: ${s}`);const result=parseFloat(s);if(isNaN(result))throw new Error(`Invalid number format: ${s}`);if(!isFinite(result))throw new Error(`Number overflow: ${s}`);return result}(v.Value,integer);case"Object":case"Date":case"TimeSpan":throw new Error(`Invalid conversion: ${v.Type} to number`);default:return 0}}function getBooleanValue(v){switch(v.Type){case"Bool":return v.Value;case"Int32":case"Int64":case"UInt64":case"Float":case"Double":case"Decimal":return 0!==v.Value;case"Null":return!1;case"String":return function(s){const t=s.trim();if("False"===t)return!1;if("True"===t)return!0;const n=parseFloat(t);if(!isNaN(n)&&isFinite(n))return 0!==n;throw new Error(`Invalid boolean format: ${s}`)}(v.Value);case"Object":return null!==v.Value;case"TimeSpan":case"Date":return 0!==v.Value.valueOf();default:return!1}}function getStringValue$2(v){switch(v.Type){case"Null":return"";case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":return formatValue(v,null,null);case"String":return v.Value;case"TimeSpan":case"Date":return formatValue(v,null,null);case"Bool":return v.Value?"True":"False";default:return""}}var operators$1=Object.freeze({__proto__:null,Not:function(v){switch(v.Type){case"Null":return Create$3(-1);case"Bool":return Create$3(0==getNumberValue(v));case"Int32":case"Int64":case"UInt64":return Create$3(~v.Value);case"Float":case"Double":case"Decimal":return Create$3(~vbRound(v.Value));case"String":return Create$3(~getNumberValue(v));case"TimeSpan":case"Date":case"Object":default:throw new Error(`Invalid operation: ! ${v.Type}`)}},BitwiseShiftLeft:function(v,shift){switch(v.Type){case"Null":case"Bool":case"Int32":case"Int64":case"UInt64":case"Float":case"Double":case"Decimal":case"String":return Create$3(getNumberValue(v)<<getNumberValue(shift));case"TimeSpan":case"Date":case"Object":default:throw new Error(`Invalid operation: << ${v.Type}`)}},BitwiseShiftRight:function(v,shift){switch(v.Type){case"Null":case"Bool":case"Int32":case"Int64":case"UInt64":case"Float":case"Double":case"Decimal":case"String":return Create$3(getNumberValue(v)>>getNumberValue(shift));case"TimeSpan":case"Date":case"Object":default:throw new Error(`Invalid operation: >> ${v.Type}`)}},UnaryMinus:function(v){switch(v.Type){case"Null":return Zero$2;case"Bool":case"Int32":case"Int64":case"UInt64":case"Float":case"Double":case"Decimal":case"String":case"TimeSpan":case"Date":return Create$3(-getNumberValue(v));case"Object":default:throw new Error(`Invalid operation: - ${v.Type}`)}},UnaryPlus:function(v){switch(v.Type){case"Null":return Zero$2;case"Bool":case"Int32":case"Int64":case"UInt64":case"Float":case"Double":case"Decimal":case"String":case"TimeSpan":case"Date":return Create$3(getNumberValue(v));case"Object":default:throw new Error(`Invalid operation: + ${v.Type}`)}},Plus:function(a,b){switch(a.Type){case"Null":switch(b.Type){case"Null":return Zero$2;case"Bool":case"String":case"Enum":return Create$3(getNumberValue(b));case"Int32":case"Int64":case"UInt64":case"Double":case"Float":case"Decimal":case"TimeSpan":return b;default:throw new Error(`Invalid operation: ${a.Type} + ${b.Type}`)}case"Bool":case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":switch(b.Type){case"Null":return Create$3(getNumberValue(a));case"Bool":case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":case"String":return Create$3(getNumberValue(a)+getNumberValue(b));default:throw new Error(`Invalid operation: ${a.Type} + ${b.Type}`)}case"TimeSpan":switch(b.Type){case"Null":return a;default:throw new Error(`Invalid operation: ${a.Type} + ${b.Type}`)}case"Date":switch(b.Type){case"Date":case"String":return Create$3(getStringValue$2(a)+getStringValue$2(b));default:throw new Error(`Invalid operation: ${a.Type} + ${b.Type}`)}case"String":switch(b.Type){case"Null":case"Bool":case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":return Create$3(getNumberValue(a)+getNumberValue(b));case"Date":return Create$3(a.Value+getStringValue$2(b));default:return Create$3(getStringValue$2(a)+getStringValue$2(b))}default:throw new Error(`Invalid operation: ${a.Type} + ${b.Type}`)}},Minus:function(a,b){switch(a.Type){case"Null":switch(b.Type){case"Null":return Zero$2;case"Bool":case"String":case"Enum":case"Int32":case"Int64":case"UInt64":case"Double":case"Float":case"Decimal":case"TimeSpan":return Create$3(-getNumberValue(b));default:throw new Error(`Invalid operation: ${a.Type} - ${b.Type}`)}case"Bool":case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":switch(b.Type){case"Null":return Create$3(getNumberValue(a));case"Bool":case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":case"String":return Create$3(getNumberValue(a)-getNumberValue(b));default:throw new Error(`Invalid operation: ${a.Type} - ${b.Type}`)}case"TimeSpan":switch(b.Type){case"Null":return a;default:throw new Error(`Invalid operation: ${a.Type} - ${b.Type}`)}case"Date":throw b.Type,new Error(`Invalid operation: ${a.Type} - ${b.Type}`);case"String":switch(b.Type){case"Null":case"Bool":case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":case"String":return Create$3(getNumberValue(a)-getNumberValue(b));default:throw new Error(`Invalid operation: ${a.Type} - ${b.Type}`)}default:throw new Error(`Invalid operation: ${a.Type} - ${b.Type}`)}},Mult:function(a,b){switch(a.Type){case"Null":switch(b.Type){case"Null":case"Bool":case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":return Zero$2;case"String":return Create$3(0*getNumberValue(b));default:throw new Error(`Invalid operation: ${a.Type} * ${b.Type}`)}case"Bool":case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":case"String":switch(b.Type){case"Null":case"Bool":case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":case"String":return Create$3(getNumberValue(a)*getNumberValue(b));default:throw new Error(`Invalid operation: ${a.Type} * ${b.Type}`)}default:throw new Error(`Invalid operation: ${a.Type} * ${b.Type}`)}},Divide:function(a,b){if(0===getNumberValue(b))throw new Error("Invalid operation: division by zero");switch(a.Type){case"Null":switch(b.Type){case"Null":return Create$3(Number.NaN);case"Bool":case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":case"String":return Create$3(0/getNumberValue(b));default:throw new Error(`Invalid operation: ${a.Type} / ${b.Type}`)}case"Bool":case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":case"String":switch(b.Type){case"Null":case"Bool":case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":case"String":return Create$3(getNumberValue(a)/getNumberValue(b));default:throw new Error(`Invalid operation: ${a.Type} / ${b.Type}`)}default:throw new Error(`Invalid operation: ${a.Type} / ${b.Type}`)}},IntegralDivide:function(a,b){if(0===getNumberValue(b))throw new Error("Invalid operation: division by zero");switch(a.Type){case"Null":switch(b.Type){case"Null":return Create$3(Number.NaN);case"Bool":case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":case"String":return Create$3(0/getNumberValue(b));default:throw new Error(`Invalid operation: ${a.Type}  ${b.Type}`)}case"Bool":case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":case"String":switch(b.Type){case"Null":case"Bool":case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":case"String":return Create$3(Math.trunc(vbRound(getNumberValue(a))/vbRound(getNumberValue(b))));default:throw new Error(`Invalid operation: ${a.Type} / ${b.Type}`)}default:throw new Error(`Invalid operation: ${a.Type}  ${b.Type}`)}},Mod:function(a,b){if(0===getNumberValue(b))throw new Error("Invalid operation: division by zero");switch(a.Type){case"Null":switch(b.Type){case"Bool":if(b.Value)return Zero$2;throw new Error(`Invalid operation: ${a.Type} % ${b.Type}`);case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":return Zero$2;case"String":return Create$3(0*getNumberValue(b));default:throw new Error(`Invalid operation: ${a.Type} % ${b.Type}`)}case"Bool":case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":case"String":switch(b.Type){case"Null":case"Bool":case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":case"String":return Create$3(getNumberValue(a)%getNumberValue(b));default:throw new Error(`Invalid operation: ${a.Type} % ${b.Type}`)}default:throw new Error(`Invalid operation: ${a.Type} % ${b.Type}`)}},Pow:function(a,b){switch(a.Type){case"Null":switch(b.Type){case"Null":case"Bool":case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":return Zero$2;case"String":return Create$3(0*getNumberValue(b));default:throw new Error(`Invalid operation: ${a.Type} ^ ${b.Type}`)}case"Bool":case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":case"String":switch(b.Type){case"Null":case"Bool":case"Int32":case"Int64":case"Enum":case"UInt64":case"Double":case"Float":case"Decimal":case"String":return Create$3(Math.pow(getNumberValue(a),getNumberValue(b)));default:throw new Error(`Invalid operation: ${a.Type} ^ ${b.Type}`)}default:throw new Error(`Invalid operation: ${a.Type} ^ ${b.Type}`)}},Xor:function(a,b){return"Bool"===a.Type&&"Bool"===b.Type?a.Value!==b.Value?True:False:Create$3(getNumberValue(a)^getNumberValue(b))},Or:function(a,b){return"Bool"===a.Type&&"Bool"===b.Type?a.Value||b.Value?True:False:Create$3(getNumberValue(a)|getNumberValue(b))},And:function(a,b){return"Bool"===a.Type&&"Bool"===b.Type?a.Value&&b.Value?True:False:Create$3(getNumberValue(a)&getNumberValue(b))}});function compareBoolean(a,b){return!a&&b?-1:a&&!b?1:0}function compareString(a,b){const i=a.localeCompare(b);return i<0?-1:i>0?1:0}function Compare$1(a,b){switch(a.Type){case"Null":switch(b.Type){case"Null":return 0;case"Bool":case"Int32":case"Int64":case"UInt64":case"Float":case"Double":case"Decimal":return-getNumberValue(b);case"TimeSpan":case"Date":return-b.Value.valueOf();case"String":return compareString("",b.Value);default:return-1}case"Bool":switch(b.Type){case"Null":case"Bool":case"Int32":case"Int64":case"UInt64":case"Float":case"Double":case"Decimal":return getNumberValue(a)-getNumberValue(b);case"String":return compareBoolean(a.Value,getBooleanValue(b));default:throw new Error(`Invalid comparison: ${a.Type} and ${b.Type}`)}case"Int32":case"Int64":case"UInt64":case"Float":case"Double":case"Decimal":switch(b.Type){case"Null":case"Bool":case"Int32":case"Int64":case"UInt64":case"Float":case"Double":case"Decimal":case"String":return getNumberValue(a)-getNumberValue(b);default:throw new Error(`Invalid comparison: ${a.Type} and ${b.Type}`)}case"Object":switch(b.Type){case"Null":case"Object":return 1;default:throw new Error(`Invalid comparison: ${a.Type} and ${b.Type}`)}case"String":switch(b.Type){case"Null":return a.Value.localeCompare("");case"Bool":return compareBoolean(getBooleanValue(a),b.Value);case"Int32":case"Int64":case"UInt64":case"Float":case"Double":case"Decimal":return getNumberValue(a)-getNumberValue(b);case"String":return compareString(a.Value,b.Value);default:throw new Error(`Invalid comparison: ${a.Type} and ${b.Type}`)}case"Date":switch(b.Type){case"Date":return a.Value.valueOf()-b.Value.valueOf();default:throw new Error(`Invalid comparison: ${a.Type} and ${b.Type}`)}case"TimeSpan":case"Enum":default:throw new Error(`Invalid comparison: ${a.Type} and ${b.Type}`)}}var comparison=Object.freeze({__proto__:null,Compare:Compare$1,Equals:(a,b)=>Create$3(0===Compare$1(a,b)),NotEquals:(a,b)=>Create$3(0!==Compare$1(a,b)),LessThan:(a,b)=>Create$3(Compare$1(a,b)<0),GreaterThan:(a,b)=>Create$3(Compare$1(a,b)>0),LessOrEqual:(a,b)=>Create$3(Compare$1(a,b)<=0),GreaterOrEqual:(a,b)=>Create$3(Compare$1(a,b)>=0)});const Operators=Object.assign({},operators$1),Comparison$1=Object.assign({},comparison),Null$3={Type:"Null",Value:null},DBNull={Type:"Object",Value:{}},Zero$2={Type:"Int32",Value:0},True={Type:"Bool",Value:!0},False={Type:"Bool",Value:!1},IsNull=v=>"Null"===v.Type;function isVariant$2(v){return void 0!==v.Type&&void 0!==v.Value&&(isNumericVariant(v)||"Null"===v.Type&&null===v.Value||"Bool"===v.Type&&"boolean"==typeof v.Value||("TimeSpan"===v.Type||"Date"===v.Type)&&dateTimeFactory_isDateTime(v.Value)||("String"===v.Type||"Enum"===v.Type)&&"string"==typeof v.Value||"Object"===v.Type&&"object"==typeof v.Value)}function isNumericVariant(v){return void 0!==v.Type&&void 0!==v.Value&&("Int32"===v.Type||"Int64"===v.Type||"UInt64"===v.Type||"Float"===v.Type||"Double"===v.Type||"Decimal"===v.Type)&&"number"==typeof v.Value}function isObjectVariant(v){return void 0!==v.Type&&void 0!==v.Value&&"Object"===v.Type&&"object"==typeof v.Value}function isStringVariant(v){return void 0!==v.Type&&void 0!==v.Value&&"String"===v.Type&&"string"==typeof v.Value}function isTimeVariant(v){return void 0!==v.Type&&void 0!==v.Value&&("TimeSpan"===v.Type||"Date"===v.Type)&&dateTimeFactory_isDateTime(v.Value)}function Create$3(value,exactType=null,forceCast=!1){if(exactType){if("Bool"!==exactType&&"Date"!==exactType&&"Decimal"!==exactType&&"Double"!==exactType&&"Enum"!==exactType&&"Float"!==exactType&&"Int32"!==exactType&&"Int64"!==exactType&&"Null"!==exactType&&"Object"!==exactType&&"String"!==exactType&&"TimeSpan"!==exactType&&"UInt64"!==exactType)throw new Error(`Unknown variant Type: ${exactType}`);const v={Type:exactType,Value:value};if(isVariant$2(v))return v;{if(!forceCast)throw new Error(`Type mismatch: ${value} is not instance of ${exactType}`);const source=Create$3(value);switch(exactType){case"Bool":return Create$3(Convert$1.toBoolean(source),exactType);case"Null":return Null$3;case"Int32":case"Int64":case"UInt64":return Create$3(Convert$1.toInteger(source),exactType);case"Float":case"Double":case"Decimal":return Create$3(Convert$1.toDouble(source),exactType);case"String":return Create$3(Convert$1.toString(source),exactType);case"Date":return Create$3(Convert$1.toDate(source),exactType);case"TimeSpan":return Create$3(Convert$1.toTimeSpan(source),exactType);default:throw new Error(`Type mismatch: cannot convert ${value} to type ${exactType}`)}}}if(null==value)return Null$3;if(isVariant$2(value))return value;if("boolean"==typeof value)return{Type:"Bool",Value:value};if("object"==typeof value){if(dateTimeFactory_isDateTime(value))return{Type:"Date",Value:value};if(value instanceof Date){const dateValue=dateTimeFactory_createFromJsDate(value);return null!=dateValue?{Type:"Date",Value:dateValue}:Null$3}return{Type:"Object",Value:value}}if("string"==typeof value)return{Type:"String",Value:value};if("number"==typeof value)return Number.isInteger(value)?{Type:"Int64",Value:value}:{Type:"Double",Value:value};throw new Error(`Invalid argument: unable to create variant from \'${typeof value}\'.`)}const toSafeValue=v=>{switch(v.Type){case"Date":case"TimeSpan":return v.Value;case"Object":if(v===DBNull)return null;if(v.Value instanceof Array)return v.Value.map((val=>toSafeValue(Create$3(val))));throw new Error("Cannot convert Object to safe value");default:return v.Value}},Convert$1={toBoolean:v=>{if("String"===v.Type){const t=v.Value.trim().toLowerCase();if("false"===t)return!1;if("true"===t)return!0;const n=parseFloat(t);if(!isNaN(n)&&isFinite(n))return 0!==n}return getBooleanValue(v)},toString:v=>getStringValue$2(v),toChar:v=>isStringVariant(v)?v.Value[0]||"":String.fromCharCode(getNumberValue(v)),toInteger:v=>vbRound(getNumberValue(v,!0)),toDouble:v=>getNumberValue(v),toDate:v=>{switch(v.Type){case"Date":return v.Value;case"String":return function(s){if(s){const m=dateTimeFactory_createFromString(s,[ISOformat$1],!0);if(null!=m)return m}throw new Error(`Invalid date format: ${s}`)}(v.Value);case"Object":if(v.Value instanceof Date){const dateValue=dateTimeFactory_createFromJsDate(v.Value);if(null!=dateValue)return dateValue}default:throw new Error(`Invalid conversion: ${v.Type} to date`)}},toTimeSpan:v=>{switch(v.Type){case"TimeSpan":return v.Value;case"String":throw new Error("Not implemented");default:throw new Error(`Invalid conversion: ${v.Type} to timespan`)}},toSafeValue:toSafeValue};var VariantUtils=Object.freeze({__proto__:null,Operators:Operators,Comparison:Comparison$1,Null:Null$3,DBNull:DBNull,Zero:Zero$2,True:True,False:False,IsNull:IsNull,IsNullOrEmptyString:v=>IsNull(v)||"String"===v.Type&&""===v.Value,isVariant:isVariant$2,isNumericVariant:isNumericVariant,isBoolVariant:function(v){return void 0!==v.Type&&void 0!==v.Value&&"Bool"===v.Type&&"boolean"==typeof v.Value},isObjectVariant:isObjectVariant,isStringVariant:isStringVariant,isTimeVariant:isTimeVariant,Create:Create$3,Convert:Convert$1});class ExpressionNode{constructor(evaluate,Children,Token){this.evaluate=evaluate,this.Children=Children,this.Token=Token,this.Eval=function(ctx){return this.evaluate(ctx,this.Children)},this.EvalConst=function(){return this.evaluate({Data:{}},this.Children)},this.Contains=function(tokenName,tokenType){return!((!tokenType||this.Token.type!==tokenType)&&tokenType||!(null===tokenName||"string"==typeof tokenName&&this.Token.value===tokenName||"object"==typeof tokenName&&"value"!==this.Token.type&&this.Token.value.match(tokenName)))||this.Children.some((c=>c.Contains(tokenName,tokenType)))},this.ToString=function(){switch(this.Token.type){case"variable":case"constant":return this.Token.value;case"function":const functionName=this.Token.value;return functionName&&"."===functionName[0]?`${this.Children[0].ToString()}${this.Token.value}(${this.Children.slice(1).map((c=>c.ToString())).join(",")})`:`${this.Token.value}(${this.Children.map((c=>c.ToString())).join(",")})`;case"operator":return 1===this.Token.arity?`(${this.Token.value}(${this.Children[0].ToString()}))`:`((${this.Children[0].ToString()})${this.Token.value}(${this.Children[1].ToString()}))`;case"value":switch(this.Token.value.Type){case"String":return`"${this.Token.value.Value.replace(/"/g,\'""\')}"`;case"Date":return`#${Convert$1.toString(this.Token.value)}#`;case"Object":throw new Error(`[expression] cannot serialize object to string: ${this.Token.value.Value}`);default:return`${this.Token.value.Value}`}default:return""}},this.ReplaceChildren=function(childern){return new ExpressionNode(this.evaluate,childern,this.Token)},this.Simplify=function(){if("function"===this.Token.type||"operator"===this.Token.type){if(!this.Contains(null,"variable")){const result=this.EvalConst();return new ExpressionNode((()=>result),[],{value:result,type:"value"})}return new ExpressionNode(this.evaluate,this.Children.map((child=>child.Simplify())),this.Token)}return this}}}function mapValues(obj,callback){const result={};return Object.keys(obj||{}).forEach((key=>{result[key]=callback(obj[key])})),result}function mapKeys(obj,callback){const result={};return Object.keys(obj||{}).forEach((key=>{result[callback(key)]=obj[key]})),result}function mapKeysDeep(obj,callback){if(null==obj||"object"!=typeof obj)return obj;if(isVariant$2(obj))return obj===DBNull?obj:{Type:obj.Type,Value:Array.isArray(obj.Value)?obj.Value.map((item=>mapKeysDeep(item,callback))):mapKeysDeep(obj.Value,callback)};const result={};return Object.keys(obj||{}).forEach((key=>{result[callback(key)]=Array.isArray(obj[key])?obj[key].map((item=>mapKeysDeep(item,callback))):mapKeysDeep(obj[key],callback)})),result}const getValueByKey=(obj,key)=>obj[key];function isPositive(n){if(n<0)throw new Error(`Can not convert ${n} to unsigned`);return n}const convert={ToBoolean:args=>Create$3(Convert$1.toBoolean(args[1]),"Bool"),ToByte:args=>Create$3(isPositive(convertToNumber(args[1],Convert$1.toInteger)),"Int32"),ToInt16:args=>Create$3(convertToNumber(args[1],Convert$1.toInteger),"Int32"),ToInt32:args=>Create$3(convertToNumber(args[1],Convert$1.toInteger),"Int32"),ToInt64:args=>Create$3(convertToNumber(args[1],Convert$1.toInteger),"Int64"),ToUInt16:args=>Create$3(isPositive(convertToNumber(args[1],Convert$1.toInteger)),"UInt64"),ToUInt32:args=>Create$3(isPositive(convertToNumber(args[1],Convert$1.toInteger)),"UInt64"),ToUInt64:args=>Create$3(isPositive(convertToNumber(args[1],Convert$1.toInteger)),"UInt64"),ToDecimal:args=>Create$3(convertToNumber(args[1],Convert$1.toDouble),"Decimal"),ToDouble:args=>Create$3(convertToNumber(args[1],Convert$1.toDouble),"Double"),ToSingle:args=>Create$3(convertToNumber(args[1],Convert$1.toDouble),"Float"),ToString:args=>Create$3(Convert$1.toString(args[1]),"String"),ToDateTime:args=>Create$3(Convert$1.toDate(args[1]),"Date"),ToChar:args=>Create$3(Convert$1.toChar(args[1]),"String"),IsDBNull:args=>args[1]===DBNull?True:False};function convertToNumber(val,conversionFunc){return"Bool"===val.Type?val.Value?1:0:conversionFunc(val)}function getNumericValue$2(v){if(isNumericVariant(v))return Convert$1.toDouble(v);throw new Error(`Type mismatch: ${v.Value} is not a number`)}const math={Abs:args=>Create$3(Math.abs(getNumericValue$2(args[1]))),Ceiling:args=>Create$3(Math.ceil(getNumericValue$2(args[1]))),Floor:args=>Create$3(Math.floor(getNumericValue$2(args[1]))),Truncate:args=>Create$3(Math.trunc(getNumericValue$2(args[1]))),Round:args=>Create$3(2===args.length?Math.round(getNumericValue$2(args[1])):Math.round(getNumericValue$2(args[1])*Math.pow(10,getNumericValue$2(args[2])))/Math.pow(10,getNumericValue$2(args[2]))),Sign:args=>Create$3(Math.sign(getNumericValue$2(args[1]))),Sin:args=>Create$3(Math.sin(getNumericValue$2(args[1]))),Cos:args=>Create$3(Math.cos(getNumericValue$2(args[1]))),Tan:args=>Create$3(Math.tan(getNumericValue$2(args[1]))),Sinh:args=>Create$3(Math.sinh(getNumericValue$2(args[1]))),Cosh:args=>Create$3(Math.cosh(getNumericValue$2(args[1]))),Tanh:args=>Create$3(Math.tanh(getNumericValue$2(args[1]))),Asin:args=>Create$3(Math.asin(getNumericValue$2(args[1]))),Acos:args=>Create$3(Math.acos(getNumericValue$2(args[1]))),Atan:args=>Create$3(Math.atan(getNumericValue$2(args[1]))),Pow:args=>Create$3(Math.pow(getNumericValue$2(args[1]),getNumericValue$2(args[2]))),Min:args=>Create$3(Math.min(...args.slice(1).map(getNumericValue$2))),Max:args=>Create$3(Math.max(...args.slice(1).map(getNumericValue$2))),Sqrt:args=>Create$3(Math.sqrt(getNumericValue$2(args[1]))),Log:args=>Create$3(2===args.length?Math.log(getNumericValue$2(args[1])):Math.log(getNumericValue$2(args[1]))/Math.log(getNumericValue$2(args[2]))),Log10:args=>Create$3(Math.log10(getNumericValue$2(args[1]))),Exp:args=>Create$3(Math.exp(getNumericValue$2(args[1]))),Atan2:args=>Create$3(Math.atan2(getNumericValue$2(args[1]),getNumericValue$2(args[2]))),IEEERemainder:args=>{return Create$3((dividend=getNumericValue$2(args[1]),divisor=getNumericValue$2(args[2]),dividend-divisor*Math.round(dividend/divisor)));var dividend,divisor},BigMul:args=>Create$3(getNumericValue$2(args[1])*getNumericValue$2(args[2]),"Int64",!0),Fix:args=>Create$3(Math.trunc(getNumericValue$2(args[1])),args[1].Type)};const information={IsNumeric:args=>function(v){if(IsNull(v))return False;try{return Convert$1.toDouble(v),True}catch(_a){return False}}(args[1]),IsDate:args=>function(v){try{return Convert$1.toDate(v),True}catch(_a){return False}}(args[1]),IsNothing:args=>{return v=args[1],IsNull(v)?True:False;var v},IsError:args=>(args[1],False),IsArray:args=>{return(v=args[1])&&"Object"===v.Type&&Array.isArray(v.Value)?True:False;var v}};const ISOformat={ISO_8601:!0},Locale=localeProvider.getLocale("en-US").DateTime.FormatInfo;function getTimeValue(v){if(isVariant$2(v))return Convert$1.toDate(v).clone();throw new Error(`Type mismatch: ${v} is not a valid value`)}function getNumericValue$1(v){if(isVariant$2(v))return Convert$1.toDouble(v);throw new Error(`Type mismatch: ${v} is not a valid number`)}function getStringValue$1(v){if(isVariant$2(v))return Convert$1.toString(v);throw new Error(`Type mismatch: ${v} is not a valid value`)}const classFunctionsImpl$1={Year:args=>Create$3(getTimeValue(args[1]).year()),Month:args=>Create$3(getTimeValue(args[1]).month()+1),Day:args=>Create$3(getTimeValue(args[1]).date()),Weekday:args=>function(dateTime,firstDayOfWeek){const firstDay=firstDayOfWeek?getNumericValue$1(firstDayOfWeek):1;if(firstDay<1||firstDay>7)throw new Error("FirstDayOfWeek is less than 1 or greater than 7");const temp=getTimeValue(dateTime).day()-firstDay+2;return Create$3(temp>0?temp:temp+7)}(args[1],args[2]),Hour:args=>Create$3(getTimeValue(args[1]).hour()),Minute:args=>Create$3(getTimeValue(args[1]).minute()),Second:args=>Create$3(getTimeValue(args[1]).second()),DateValue:args=>Create$3(getTimeValue(args[1]).startOfDay()),TimeValue:args=>Create$3(parse$1(args[1],[...dateTimeFormats,...timeFormats]).Value.getTime()),AddDays:args=>Create$3(getTimeValue(args[1]).add(getNumericValue$1(args[2]),"days")),AddHours:args=>Create$3(getTimeValue(args[1]).add(getNumericValue$1(args[2]),"hours")),AddMilliseconds:args=>Create$3(getTimeValue(args[1]).add(getNumericValue$1(args[2]),"milliseconds")),AddMinutes:args=>Create$3(getTimeValue(args[1]).add(getNumericValue$1(args[2]),"minutes")),AddMonths:args=>Create$3(getTimeValue(args[1]).add(getNumericValue$1(args[2]),"months")),AddSeconds:args=>Create$3(getTimeValue(args[1]).add(getNumericValue$1(args[2]),"seconds")),AddYears:args=>Create$3(getTimeValue(args[1]).add(getNumericValue$1(args[2]),"years"))},values={Now:()=>Create$3(dateTimeFactory_create()),TimeOfDay:()=>Create$3(dateTimeFactory_create()),Today:()=>Create$3(dateTimeFactory_create().startOfDay()),TimeString:()=>Create$3(dateTimeFactory_create().format("HH:mm:ss")),DateString:()=>Create$3(dateTimeFactory_create().format("YYYY-MM-dd")),Timer:()=>Create$3(dateTimeFactory_create().dateDiff("s",dateTimeFactory_create().startOfDay()))},functions$1=Object.assign(Object.assign(Object.assign({},values),classFunctionsImpl$1),{TimeSerial:args=>Create$3(dateTimeFactory_createFromArray([1,0,1,getNumericValue$1(args[1]),getNumericValue$1(args[2]),getNumericValue$1(args[3])]),"Date",!0),DateSerial:args=>Create$3(dateTimeFactory_createFromArray([getNumericValue$1(args[1]),getNumericValue$1(args[2])-1,getNumericValue$1(args[3]),0,0,0]),"Date",!0),MonthName:args=>function(monthVar,abbrevateVar){const month=getNumericValue$1(monthVar);if(month<1||month>12)throw new Error("Month is less than 1 or greater than 12");return Create$3((abbrevateVar&&Convert$1.toBoolean(abbrevateVar)?Locale.monthsShort:Locale.months)[month-1])}(args[1],args[2]),WeekdayName:args=>function(weekdayVar,abbrevateVar,firstDayOfWeek){const dayNumber=getNumericValue$1(weekdayVar),firstDay=firstDayOfWeek?getNumericValue$1(firstDayOfWeek):1;if(dayNumber<1||dayNumber>7)throw new Error("Weekday is less than 1 or greater than 7");if(firstDay<1||firstDay>7)throw new Error("FirstDayOfWeek is less than 1 or greater than 7");const temp=dayNumber+firstDay-1,weekday=temp>7?temp-7:temp;return Create$3((abbrevateVar&&Convert$1.toBoolean(abbrevateVar)?Locale.daysShort:Locale.days)[weekday-1])}(args[1],args[2],args[3]),Parse:args=>function(variant,format){return parse$1(variant,format?[getStringValue$1(format)]:dateTimeFormats)}(args[1],args[2]),DatePart:args=>Create$3(function(intervalVar,dateVar,firstDayOfWeek,firstWeekOfYear){const interval=getStringValue$1(intervalVar),firstDay=firstDayOfWeek?getNumericValue$1(firstDayOfWeek):void 0,firstWeek=firstWeekOfYear?getNumericValue$1(firstWeekOfYear):void 0;return getTimeValue(dateVar).datePart(interval,firstDay,firstWeek)}(args[1],args[2],args[3],args[4])),DateAdd:args=>Create$3(function(intervalVar,numberVar,dateVar){const interval=getStringValue$1(intervalVar),num=getNumericValue$1(numberVar),date=getTimeValue(dateVar);switch(interval){case"yyyy":return date.add(num,"years");case"q":return date.add(num,"quarters");case"m":return date.add(num,"months");case"y":case"d":case"w":return date.add(num,"days");case"ww":return date.add(num,"weeks");case"h":return date.add(num,"hours");case"n":return date.add(num,"minutes");case"s":return date.add(num,"seconds");default:throw new Error(`"${intervalVar.Value}" is not valid interval value for DateAdd() function`)}}(args[1],args[2],args[3])),DateDiff:args=>Create$3(function(intervalVar,date1Var,date2Var,firstDayOfWeek){const interval=getStringValue$1(intervalVar),firstDay=firstDayOfWeek?getNumericValue$1(firstDayOfWeek):void 0,date1=getTimeValue(date1Var);return getTimeValue(date2Var).dateDiff(interval,date1,firstDay)}(args[1],args[2],args[3],args[4])),Quarter:args=>Create$3(quarter(args[1])),QuarterName:args=>{return Create$3((dateVar=args[1],Locale.quarters[quarter(dateVar)-1]));var dateVar}}),classFunctions$1=mapKeys(mapValues(classFunctionsImpl$1,(f=>args=>f(((args,functionName)=>{if("Date"!==args[1].Type)throw new Error(`[expression evaluator] function ${functionName}() not found in ${args[1].Type}`);return args})(args,f.name)))),(key=>`.${key}`));function parse$1(str,formats){if("Date"===str.Type)return str;const value=dateTimeFactory_createFromString(getStringValue$1(str),formats,!0);if(null==value)throw new Error(`Cannot parse date "${str.Value}"`);return Create$3(value)}function quarter(dateVar){const month=getTimeValue(dateVar).month();return Math.floor(month/3)+1}const maxValue=Create$3(dateTimeFactory_createFromString("9999-12-31T23:59:59.9999999Z",[ISOformat])),minValue=Create$3(dateTimeFactory_createFromString("0001-01-01T00:00:00.0000000Z",[ISOformat])),variables=Object.assign(Object.assign(Object.assign({},values),mapKeys(values,(name=>`DateTime.${name}`))),{"DateTime.MaxValue":()=>maxValue,"DateTime.MinValue":()=>minValue});function getStringValue(v){if(isVariant$2(v))return Convert$1.toString(v);throw new Error(`Type mismatch: ${v} is not a valid value`)}function getNumericValue(v){if(isNumericVariant(v))return Convert$1.toDouble(v);throw new Error(`Type mismatch: ${v.Value} is not a number`)}const escapeSymbols=/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g,classFunctionsImpl={Trim:args=>Create$3(getStringValue(args[1]).trim()),TrimStart:args=>Create$3(getStringValue(args[1]).replace(/^[\\s\\uFEFF\\xA0]+/g,"")),TrimEnd:args=>Create$3(getStringValue(args[1]).replace(/[\\s\\uFEFF\\xA0]+$/g,"")),Substring:args=>Create$3(getStringValue(args[1]).substr(getNumericValue(args[2]),args[3]?getNumericValue(args[3]):void 0)),ToLower:args=>Create$3(getStringValue(args[1]).toLowerCase()),ToUpper:args=>Create$3(getStringValue(args[1]).toUpperCase()),StartsWith:args=>Create$3(getStringValue(args[1]).startsWith(getStringValue(args[2]))),EndsWith:args=>Create$3(getStringValue(args[1]).endsWith(getStringValue(args[2]))),IndexOf:args=>Create$3(getStringValue(args[1]).indexOf(getStringValue(args[2]),args[3]?getNumericValue(args[3]):void 0)),LastIndexOf:args=>Create$3(getStringValue(args[1]).lastIndexOf(getStringValue(args[2]),args[3]?getNumericValue(args[3]):void 0)),Replace:args=>Create$3(getStringValue(args[1]).replace(new RegExp(getStringValue(args[2]).replace(escapeSymbols,"\\\\$&"),"g"),getStringValue(args[3])))},functions={Trim:classFunctionsImpl.Trim,TrimStart:classFunctionsImpl.TrimStart,TrimEnd:classFunctionsImpl.TrimEnd,Substring:classFunctionsImpl.Substring,ToLower:classFunctionsImpl.ToLower,ToUpper:classFunctionsImpl.ToUpper,StartsWith:classFunctionsImpl.StartsWith,EndsWith:classFunctionsImpl.EndsWith,LastIndexOf:classFunctionsImpl.LastIndexOf,Replace:classFunctionsImpl.Replace},classFunctions=mapKeys(mapValues(classFunctionsImpl,(f=>args=>f(((args,functionName)=>{if("String"!==args[1].Type)throw new Error(`[expression evaluator] function ${functionName}() not found in ${args[1].Type}`);return args})(args,f.name)))),(key=>`.${key}`));const padLeft=(value,length)=>{let str=value.toString();for(;str.length<length;)str=" "+str;return str};class Record{constructor(Index,FieldNameIndex,data){this.Index=Index,this.FieldNameIndex=FieldNameIndex,this.data=data}get Count(){return this.data.length}MakeCopy(index){return new Record(index,this.FieldNameIndex,this.data)}GetByIndex(index){const result=this.data[index];if(!result)throw new Error(`Index out of range: ${index}`);return result}GetByName(name){const fieldIndex=getValueByKey(this.FieldNameIndex,name);return void 0===fieldIndex?Null$3:this.data[fieldIndex]||Null$3}*[Symbol.iterator](){const fieldNames=Object.keys(this.FieldNameIndex);for(let i=0;i<this.data.length;i++){const key=fieldNames.find((f=>this.FieldNameIndex[f]===i))||"";yield{Key:key,Value:this.data[i]}}}}function getValueFromContainer(path,data){if(0===path.length)return Create$3(data);const id=path.shift();if(!data)return Null$3;if("value"===id&&0===path.length&&isObjectVariant(data)&&Array.isArray(data.Value))return data;if(isVariant$2(data)){const propertyValue=function(propertyName,obj){const propertyNameLower=propertyName.toLowerCase();switch(obj.Type){case"String":if("length"===propertyNameLower)return Create$3(Convert$1.toString(obj).length);break;case"Object":if("length"===propertyNameLower&&Array.isArray(obj.Value))return Create$3(obj.Value.length)}return}(id,data);if(propertyValue)return propertyValue}const container=isObjectVariant(data)?data.Value:data;if(container instanceof Record){const value=container.GetByName(id);return value?getValueFromContainer(path,Create$3({Value:value,Name:id})):Null$3}return getValueFromContainer(path,Create$3("value"===id&&"Value"in container?container.Value:"name"===id&&"Name"in container?container.Name:"type"===id&&"Type"in container?container.Type:getValueByKey(container,id)))}Record.Empty=new Record(0,{},[]);const checkArgsCount=(count,args,result)=>{if(args.length!==count)throw new Error(`[syntax error] ${1===count?"u":"bi"}nary operator used as unary`);return result},boolOpArg=v=>{if("String"===v.Type)throw new Error(`Invalid operation: ${v.Value} is not boolean`);return Convert$1.toBoolean(v)},operators=mapValues({"^":{priority:3.6,calc:args=>checkArgsCount(2,args,Operators.Pow(args[0],args[1]))},"*":{priority:3.5,calc:args=>checkArgsCount(2,args,Operators.Mult(args[0],args[1]))},"/":{priority:3.5,calc:args=>checkArgsCount(2,args,Operators.Divide(args[0],args[1]))},"\\\\":{priority:3.4,calc:args=>checkArgsCount(2,args,Operators.IntegralDivide(args[0],args[1]))},mod:{priority:3.3,calc:args=>checkArgsCount(2,args,Operators.Mod(args[0],args[1]))},"+":{priority:3.2,calc:args=>1===args.length?Operators.UnaryPlus(args[0]):Operators.Plus(args[0],args[1])},"-":{priority:3.2,calc:args=>1===args.length?Operators.UnaryMinus(args[0]):Operators.Minus(args[0],args[1])},"&":{priority:3.1,calc:args=>checkArgsCount(2,args,Create$3(`${Convert$1.toString(args[0])}${Convert$1.toString(args[1])}`))},"<<":{priority:3,calc:args=>checkArgsCount(2,args,Operators.BitwiseShiftLeft(args[0],args[1]))},">>":{priority:3,calc:args=>checkArgsCount(2,args,Operators.BitwiseShiftRight(args[0],args[1]))},"<":{priority:2,calc:args=>checkArgsCount(2,args,Comparison$1.LessThan(args[0],args[1]))},">":{priority:2,calc:args=>checkArgsCount(2,args,Comparison$1.GreaterThan(args[0],args[1]))},"<=":{priority:2,calc:args=>checkArgsCount(2,args,Comparison$1.LessOrEqual(args[0],args[1]))},">=":{priority:2,calc:args=>checkArgsCount(2,args,Comparison$1.GreaterOrEqual(args[0],args[1]))},"=":{priority:2,calc:args=>checkArgsCount(2,args,Comparison$1.Equals(args[0],args[1]))},"<>":{priority:2,calc:args=>checkArgsCount(2,args,Comparison$1.NotEquals(args[0],args[1]))},is:{priority:2,calc:args=>checkArgsCount(2,args,Comparison$1.Equals(args[0],args[1]))},like:{priority:2,calc:args=>{if(2!==args.length)throw new Error("[syntax error] binary operator LIKE is used as unary");if(args.some((a=>"String"!==a.Type)))throw new Error("[expression evaluator] invalid operation: LIKE arguments must be string");return function(pattern){let regex="^",isGroup=!1,isEmptyGroup=!1;for(let i=0;i<pattern.length;i++){const c=pattern[i];"]"!==c?(isEmptyGroup=!1,"["!==c?regex+="?"!==c||isGroup?"*"!==c||isGroup?"#"!==c||isGroup?(".{}()?/\\\\*+^$".indexOf(c)>-1?"\\\\":"")+c:"\\\\d":".*":".":isGroup?regex+="\\\\"+c:(regex+=c,isGroup=!0,isEmptyGroup=!0,"!"===pattern[i+1]&&(regex+="^",isEmptyGroup=!1,i++))):isGroup?(regex+=c,isGroup=!1,isEmptyGroup&&(regex=regex.substr(0,regex.length-2))):(regex+="\\\\"+c,isEmptyGroup=!1)}return regex+="$",new RegExp(regex)}(Convert$1.toString(args[1])).test(Convert$1.toString(args[0]))?True:False}},not:{priority:1.3,calc:args=>checkArgsCount(1,args,Operators.Not(args[0]))},and:{priority:1.2,calc:args=>checkArgsCount(2,args,Operators.And(args[0],args[1]))},andalso:{priority:1.2,calc:args=>checkArgsCount(2,args,boolOpArg(args[0])&&boolOpArg(args[1])?True:False)},or:{priority:1.1,calc:args=>checkArgsCount(2,args,Operators.Or(args[0],args[1]))},orelse:{priority:1.1,calc:args=>checkArgsCount(2,args,boolOpArg(args[0])||boolOpArg(args[1])?True:False)},xor:{priority:1,calc:args=>checkArgsCount(2,args,Operators.Xor(args[0],args[1]))}},(o=>({priority:o.priority,calc:(ctx,args)=>o.calc(args.map((arg=>arg.Eval(ctx))))}))),mapFunctions=f=>(ctx,args)=>f(args.map((arg=>arg.Eval(ctx)))),toStringFunction=(ctx,args)=>{if(null!==args[0]&&void 0!==args[0]){const argsValues=args.map((a=>a.Eval(ctx)));return Create$3(formatValue(argsValues[0],null,null!==argsValues[1]&&void 0!==argsValues[1]?Convert$1.toString(argsValues[1]):null))}return""},containsFunction=args=>Create$3(Convert$1.toString(args[0]).indexOf(Convert$1.toString(args[1]))>=0),predefinedFunctions=mapKeys(Object.assign(Object.assign({},mapValues(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({InStr:args=>Create$3(Convert$1.toString(args[0]).indexOf(Convert$1.toString(args[1]))+1),Contains:containsFunction,".Contains":containsFunction,".GetLength":args=>{if("Object"!==args[0].Type&&!Array.isArray(args[0].Value))throw new Error(`[expression evaluator] ${args[0].Value} is not array`);if(args[1]&&0!==Convert$1.toInteger(args[1]))throw new Error("[expression evaluator] multi-dimensional arrays not supported");return Create$3(args[0].Value.length)},Len:args=>IsNull(args[0])?Null$3:Create$3(Convert$1.toString(args[0]).length),Partition:function(args){if(4!==args.length)throw new Error("[syntax error] Partition function: must have 4 arguments");if(args.some(IsNull))return Null$3;const number=Convert$1.toDouble(args[0]),start=Convert$1.toInteger(args[1]),stop=Convert$1.toInteger(args[2]),interval=Convert$1.toInteger(args[3]);if(start<0)throw new Error("[expression evaluator] Partition function: Start cannot be less than 0");if(stop<=start)throw new Error("[expression evaluator] Partition function: Stop cannot be less than or equal to Start");if(interval<1)throw new Error("[expression evaluator] Partition function: Interval cannot be less than 1");const digits=stop.toString().length;if(number<start)return Create$3(`:${padLeft(start-1,digits)}`);if(number>stop)return Create$3(`${padLeft(stop+1,digits)}:`);const first=Math.trunc((number-start)/interval)*interval+start;return Create$3(`${padLeft(first,digits)}:${padLeft(first+interval-1,digits)}`)},Chr:args=>{const charCode=Convert$1.toInteger(args[0]);if(charCode>=0&&charCode<=255)return Create$3(String.fromCharCode(charCode));throw new Error(`[expression evaluator] Char code must be from 0 to 255 but was ${charCode}`)},Join:args=>{if("Object"!==args[0].Type)return Create$3(Convert$1.toString(args[0]));const values=args[0].Value;if(!Array.isArray(values))throw new Error("First argument of Join() function must be array");const delimeter=args.length>1?Convert$1.toString(args[1]):" ";return Create$3(values.map((value=>Convert$1.toString(Create$3(value)))).join(delimeter))},Split:args=>{const expression=Convert$1.toString(args[0]),delimiter=args.length>1?Convert$1.toString(args[1]):" ",limit=args.length>2?Convert$1.toInteger(args[2]):-1;if(0===expression.length)return Create$3([]);if(0===delimiter.length)return Create$3([expression]);return Create$3(-1===limit?expression.split(delimiter):expression.split(delimiter,limit))},CStr:args=>{const arg=args[0];if(isTimeVariant(arg)){if(1===arg.Value.year()&&0===arg.Value.month()&&1===arg.Value.date())return Create$3(formatValue(arg,null,"T"));if(0===arg.Value.hour()&&0===arg.Value.minute()&&0===arg.Value.second())return Create$3(formatValue(arg,null,"d"))}return Create$3(Convert$1.toString(arg))},IndexOf:args=>{const arg=args[0];switch(arg.Type){case"String":return classFunctions[".IndexOf"]([Null$3,...args]);case"Object":if(Array.isArray(arg.Value))return function(args){var _a,_b;const arr=args[0].Value,target=args[1],start=null!==(_b=null===(_a=args[2])||void 0===_a?void 0:_a.Value)&&void 0!==_b?_b:0;if("number"!=typeof start)throw new Error("[expression evaluator] start argument of IndexOf function must be number");for(let i=start;i<arr.length;i++)if(Comparison$1.Equals(Create$3(arr[i]),target).Value)return Create$3(i);return Create$3(-1)}(args);default:throw new Error("[expression evaluator] IndexOf function must be called on String or Array")}}},mapValues(convert,(f=>args=>f([staticLibs.Convert,...args])))),mapValues(math,(f=>args=>f([staticLibs.Math,...args])))),mapValues(information,(f=>args=>f([staticLibs.Information,...args])))),mapValues(functions$1,(f=>args=>f([staticLibs.DateTime,...args])))),mapValues(classFunctions$1,(f=>args=>f([staticLibs.DateTime,...args])))),mapValues(functions,(f=>args=>f([staticLibs.String,...args])))),mapValues(classFunctions,(f=>args=>f([staticLibs.String,...args])))),mapFunctions)),{Format:toStringFunction,ToString:toStringFunction,".ToString":toStringFunction,".Item":(ctx,args)=>{if(2!==args.length)throw new Error("[syntax error] Item function must have 1 argument");const source=args[0].Eval(ctx),key=`${args[1].Eval(ctx).Value}`.toLowerCase();if(!key)throw new Error("[expression evaluator] Item function argument must be not empty");if(!isObjectVariant(source)&&!isStringVariant(source))throw new Error("[expression evaluator] Item function must be called on container");return getValueFromContainer([key],source)},Fields:(ctx,args)=>{if(!ctx.Data.fields)throw new Error("[expression evaluator] Fields collection is not provided");const fieldName=`${args[0].Eval(ctx).Value}`.toLowerCase();if(!fieldName)throw new Error("[expression evaluator] Field name must be not empty");return getValueFromContainer([fieldName],ctx.Data.fields)},IIf:(ctx,args)=>Convert$1.toBoolean(args[0].Eval(ctx))?args[1].Eval(ctx):args[2].Eval(ctx),Choose:(ctx,args)=>args[Convert$1.toInteger(args[0].Eval(ctx))].Eval(ctx),Switch:(ctx,args)=>{for(let i=0;i<args.length;i+=2)if(!0===Convert$1.toBoolean(args[i].Eval(ctx)))return args[i+1].Eval(ctx);return Null$3}}),(name=>name.toLowerCase())),staticLibs=mapKeys({Math:mapKeys(mapValues(math,mapFunctions),(name=>name.toLowerCase())),Convert:mapKeys(mapValues(convert,mapFunctions),(name=>name.toLowerCase())),Information:mapKeys(mapValues(information,mapFunctions),(name=>name.toLowerCase())),DateTime:mapKeys(mapValues(functions$1,mapFunctions),(name=>name.toLowerCase())),String:mapKeys(mapValues(classFunctions,mapFunctions),(name=>name.toLowerCase().replace(/^\\./,"")))},(name=>name.toLowerCase())),predefinedConstants=mapKeys(Object.assign(Object.assign({},mapValues(staticLibs,(lib=>Create$3(lib)))),{E:Create$3(Math.E),PI:Create$3(Math.PI),"Math.E":Create$3(Math.E),"Math.PI":Create$3(Math.PI),Nothing:Null$3,Null:Null$3,"DBNull.Value":DBNull,"System.DBNull.Value":DBNull,"Double.MinValue":Create$3(-Infinity),"Double.MaxValue":Create$3(17976931348623157e292),"Decimal.MinValue":Create$3(-7922816251426434e13),"Decimal.MaxValue":Create$3(7922816251426434e13),"Int32.MinValue":Create$3(-2147483648),"Int32.MaxValue":Create$3(2147483647),vbCrLf:Create$3("\\r\\n")}),(name=>name.toLowerCase())),predefinedVariables=mapKeys(Object.assign({},variables),(name=>name.toLowerCase()));let customCodeStoreInstance={};const CustomCodeInternal_registerFunctions=customCode=>{customCodeStoreInstance=Object.assign(Object.assign({},customCodeStoreInstance),customCode)};function parse(stringTokens,functions,constants,variables,unescapeQuotes=!0){const peek=a=>a[a.length-1],stack=[],wereValues=[],argCount=[];let previousToken;return function(tokens){const remixedTokensInt=[],remixedTokens=[];for(let i=0;i<tokens.length;i++){const token=tokens[i];"variable"===token.type&&".!".includes(token.value[0])?(remixedTokensInt.push({type:"function",value:".item",arity:1,raw:token.raw}),remixedTokensInt.push({type:"left_bracket",value:"("}),remixedTokensInt.push({type:"value",value:Create$3(token.value.replace(/^[\\.!]/,"")),raw:token.raw}),remixedTokensInt.push({type:"right_bracket",value:")"})):remixedTokensInt.push(token)}for(let i=0;i<remixedTokensInt.length-1;i++){const token=remixedTokensInt[i];if("function"===token.type&&".!".includes(token.value[0])){const parents=[];let stop=!1,brackets=0;for(;!stop;){const current=remixedTokens.pop();if(!current){stop=!0;continue}"left_bracket"===current.type?brackets++:"right_bracket"===current.type&&brackets--;const next=remixedTokens[remixedTokens.length-1];0!==brackets||next&&"function"===next.type||(stop=!0),parents.push(current)}parents.reverse(),remixedTokens.push(remixedTokensInt[i]),remixedTokens.push(remixedTokensInt[i+1]),parents.length&&(remixedTokens.push(...parents),"right_bracket"!==remixedTokensInt[i+2].type&&remixedTokens.push({type:"separator",value:","})),i++}else remixedTokens.push(token)}return remixedTokensInt.length>0&&remixedTokens.push(remixedTokensInt[remixedTokensInt.length-1]),remixedTokens}(stringTokens.map(((tokenName,i,a)=>function(lexem,nextLexem,functions,constants,variables,unescapeQuotes=!0){const tokenNameLower=lexem.token.toLowerCase(),wrap=type=>{let value=lexem.token;("variable"===type||type.includes("function"))&&(value=value.replace(/\\!/g,"."));const valueFloat=parseFloat(value);if(isNaN(valueFloat)){if("true"===tokenNameLower||"false"===tokenNameLower)value="true"===tokenNameLower;else if(lexem&&\'"\'===lexem.token[0])value=lexem.token.replace(/^"|"$/g,""),unescapeQuotes&&(value=value.replace(/""/g,\'"\'));else if(lexem&&"#"===lexem.token[0]){const date=dateTimeFactory_createFromString(lexem.token.replace(/^#|#$/g,""),dateTimeFormats,!0);value=null!=date?date:lexem.token}}else value=valueFloat;switch(type){case"value":return{value:Create$3(value),type:type,raw:lexem};case"operator":case"function":return{value:value.toLowerCase(),type:type,arity:0,raw:lexem};default:return{value:value.toLowerCase(),type:type,raw:lexem}}};return null==(t=lexem.token)||"string"!=typeof t||!isNaN(parseFloat(t))&&isFinite(parseFloat(t))||"true"===t.toLowerCase()||"false"===t.toLowerCase()||t.length>0&&(\'"\'===t[0]||"#"===t[0])?wrap("value"):tokenNameLower in constants?wrap("constant"):!(tokenNameLower.replace(/\\!/g,".")in functions)||tokenNameLower.replace(/\\!/g,".")in variables||nextLexem&&"("===nextLexem.token||nextLexem&&"."===nextLexem.token[0]?tokenNameLower in operators?wrap("operator"):","===lexem.token?wrap("separator"):"("===lexem.token?wrap("left_bracket"):")"===lexem.token?wrap("right_bracket"):nextLexem&&"("===nextLexem.token?wrap("function"):wrap("variable"):wrap("value");var t}(tokenName,a[i+1],functions,constants,variables,unescapeQuotes)))).reduce(((output,t,i)=>{if(0===i&&"="===t.value)return output;const token=t;switch(token.type){case"variable":case"constant":case"value":output.push(token),wereValues.length>0&&(wereValues.pop(),wereValues.push(!0));break;case"function":token.arity=1,stack.push(token),argCount.push(0),wereValues.length>0&&(wereValues.pop(),wereValues.push(!0)),wereValues.push(!1);break;case"separator":for(;stack.length>0&&"left_bracket"!==peek(stack).type;){const v=stack.pop();void 0!==v&&output.push(v)}if(wereValues.pop()){let a=argCount.pop();void 0!==a&&(a++,argCount.push(a))}wereValues.push(!1);break;case"operator":if(previousToken&&"operator"!==previousToken.type&&"left_bracket"!==previousToken.type&&"separator"!==previousToken.type)for(token.arity=2;stack.length>0&&"operator"===peek(stack).type&&operators[token.value.toString().toLowerCase()].priority<=operators[peek(stack).value.toString().toLowerCase()].priority;){const v=stack.pop();void 0!==v&&output.push(v)}else token.arity=1;stack.push(token);break;case"left_bracket":if(previousToken&&"variable"===previousToken.type)throw new Error(`[expression compiler] Syntax error at token: ${previousToken.value.toString()}`);stack.push(token);break;case"right_bracket":for(;stack.length>0&&"left_bracket"!==peek(stack).type;){const v=stack.pop();void 0!==v&&output.push(v)}if(stack.pop(),stack.length>0&&"function"===peek(stack).type){const f=stack.pop();let a=argCount.pop();wereValues.pop()&&void 0!==a&&a++,void 0!==f&&void 0!==a&&(f.arity=a,output.push(f))}}return previousToken=token,output}),[]).concat(stack.reverse())}function getValue(name,values,specialVariables){const path=name.split(".");if(specialVariables){const byFullName=getValueByKey(specialVariables,name);if(byFullName)return byFullName(values,name);const byRootName=getValueByKey(specialVariables,path[0]);if(byRootName)return byRootName(values,name)}return getValueFromContainer(name.split("."),values.Data)}const makeExpressionNode=(evaluate,children,token)=>new ExpressionNode(evaluate,children,token);function createTreeBuilder(customFunctions,customVariables,customConstants){const functions=mapKeysDeep(Object.assign(Object.assign({},predefinedFunctions),customFunctions),(key=>key.toLowerCase())),constants=mapKeysDeep(Object.assign(Object.assign({},predefinedConstants),customConstants),(key=>key.toLowerCase())),variables=mapKeysDeep(Object.assign(Object.assign({},predefinedVariables),customVariables),(key=>key.toLowerCase()));return expression=>{if(expression&&"string"==typeof expression&&expression.trim().startsWith("=")){const constantsWithCustomCode=Object.assign(Object.assign({},constants),function(){const mappedFunctions={};return Object.entries(customCodeStoreInstance).forEach((([functionName,func])=>{mappedFunctions[functionName.toLowerCase()]=(ctx,args)=>{const evaluatedArgs=args.slice(1).map((arg=>arg.Eval(ctx).Value)).map((arg=>Array.isArray(arg)?arg.map((value=>isVariant$2(value)?value.Value:value)):arg));let result=null;try{result=func(...evaluatedArgs)}catch(e){throw new Error(`[custom code expression]: Code.${functionName}()\\nexception: ${e instanceof Error?e.message:`${e}`}`)}switch(typeof result){case"boolean":case"number":case"string":case"undefined":return Tools.Variant.Create(result);case"object":if(Array.isArray(result))return Tools.Variant.Create(result.map((value=>Tools.Variant.Create(value))));if(result instanceof Promise)throw new Error(`[custom code expression]: Code.${functionName}()\\nasync functions are not supported`);return Tools.Variant.Create(result);default:throw new Error(`[custom code expression]: Code.${functionName}()\\nunsupported return value type: ${typeof result}`)}}})),{code:Tools.Variant.Create(mappedFunctions)}}());return function(rpnTokens,functions,constants,specialVariables){const stack=[];for(let i=0;i<rpnTokens.length;i++){const token=rpnTokens[i];switch(token.type){case"value":stack.push(makeExpressionNode((()=>token.value),[],token));break;case"variable":stack.push(makeExpressionNode((ctx=>{const value=getValue(token.value,ctx,specialVariables);if(void 0===value)throw new Error(`[expression evaluator] Variable value not provided: ${token.value}`);return value}),[],token));break;case"constant":stack.push(makeExpressionNode((()=>constants[token.value.toLowerCase()]),[],token));break;case"function":const functionArgs=[];for(let j=0;j<token.arity;j++)functionArgs.push(stack.pop());functionArgs.reverse();const functionName=token.value;functionName.startsWith(".")?stack.push(makeExpressionNode(((ctx,args)=>{const firstArg=args[0]&&args[0].Eval(ctx);let func="Object"===firstArg.Type&&getValueByKey(firstArg.Value,functionName.replace(/^\\./,""));if(!func||"function"!=typeof func){if(!functions[functionName])throw new Error(`[expression evaluator] Function ${functionName} not found in ${args[0]&&args[0].Token.value}`);func=functions[functionName]}return func(ctx,args)}),functionArgs,token)):stack.push(makeExpressionNode(((ctx,fa)=>{if(!functions[functionName])throw new Error(`[expression compiler] Function not found: ${functionName}`);return functions[functionName](ctx,fa)}),functionArgs,token));break;case"operator":const operatorArgs=[];for(let j=0;j<token.arity;j++)operatorArgs.push(stack.pop());operatorArgs.reverse();const operatorName=token.value;if(!operators[operatorName])throw new Error(`[expression compiler] Operator not found: ${token.value}`);stack.push(makeExpressionNode(((ctx,args)=>operators[operatorName].calc(ctx,args)),operatorArgs,token));break;default:throw new Error(`[expression compiler] Unexpected token type: ${token.type}`)}}if(1===stack.length)return stack[0];throw new Error("[expression compiler] Compilation error")}(parse(tokenize(expression),functions,constantsWithCustomCode,variables),functions,constantsWithCustomCode,variables)}return makeExpressionNode((()=>Create$3(expression)),[],{type:"value",value:Create$3(expression)})}}!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){if(!u&&commonjsRequire)return commonjsRequire(o);if(i)return i(o,!0);var f=new Error("Cannot find module \'"+o+"\'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,(function(e){var n=t[o][1][e];return s(n||e)}),l,l.exports,e,t,n,r)}return n[o].exports}for(var i=commonjsRequire,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){module.exports=function(XRegExp){var REGEX_DATA="xregexp",subParts=/(\\()(?!\\?)|\\\\([1-9]\\d*)|\\\\[\\s\\S]|\\[(?:[^\\\\\\]]|\\\\[\\s\\S])*\\]/g,parts=XRegExp.union([/\\({{([\\w$]+)}}\\)|{{([\\w$]+)}}/,subParts],"g",{conjunction:"or"});function deanchor(pattern){var leadingAnchor=/^(?:\\(\\?:\\))*\\^/,trailingAnchor=/\\$(?:\\(\\?:\\))*$/;return leadingAnchor.test(pattern)&&trailingAnchor.test(pattern)&&trailingAnchor.test(pattern.replace(/\\\\[\\s\\S]/g,""))?pattern.replace(leadingAnchor,"").replace(trailingAnchor,""):pattern}function asXRegExp(value,addFlagX){var flags=addFlagX?"x":"";return XRegExp.isRegExp(value)?value[REGEX_DATA]&&value[REGEX_DATA].captureNames?value:XRegExp(value.source,flags):XRegExp(value,flags)}XRegExp.build=function(pattern,subs,flags){var addFlagX=(flags=flags||"").indexOf("x")>-1,inlineFlags=/^\\(\\?([\\w$]+)\\)/.exec(pattern);inlineFlags&&(flags=XRegExp._clipDuplicates(flags+inlineFlags[1]));var data={};for(var p in subs)if(subs.hasOwnProperty(p)){var sub=asXRegExp(subs[p],addFlagX);data[p]={pattern:deanchor(sub.source),names:sub[REGEX_DATA].captureNames||[]}}var numPriorCaps,patternAsRegex=asXRegExp(pattern,addFlagX),numCaps=0,numOuterCaps=0,outerCapsMap=[0],outerCapNames=patternAsRegex[REGEX_DATA].captureNames||[],output=patternAsRegex.source.replace(parts,(function($0,$1,$2,$3,$4){var capName,intro,localCapIndex,subName=$1||$2;if(subName){if(!data.hasOwnProperty(subName))throw new ReferenceError("Undefined property "+$0);return $1?(capName=outerCapNames[numOuterCaps],outerCapsMap[++numOuterCaps]=++numCaps,intro="(?<"+(capName||subName)+">"):intro="(?:",numPriorCaps=numCaps,intro+data[subName].pattern.replace(subParts,(function(match,paren,backref){if(paren){if(capName=data[subName].names[numCaps-numPriorCaps],++numCaps,capName)return"(?<"+capName+">"}else if(backref)return localCapIndex=+backref-1,data[subName].names[localCapIndex]?"\\\\k<"+data[subName].names[localCapIndex]+">":"\\\\"+(+backref+numPriorCaps);return match}))+")"}if($3){if(capName=outerCapNames[numOuterCaps],outerCapsMap[++numOuterCaps]=++numCaps,capName)return"(?<"+capName+">"}else if($4)return outerCapNames[localCapIndex=+$4-1]?"\\\\k<"+outerCapNames[localCapIndex]+">":"\\\\"+outerCapsMap[+$4];return $0}));return XRegExp(output,flags)}}},{}],2:[function(require,module,exports){module.exports=function(XRegExp){function row(name,value,start,end){return{name:name,value:value,start:start,end:end}}XRegExp.matchRecursive=function(str,left,right,flags,options){options=options||{};var outerStart,innerStart,leftMatch,rightMatch,esc,global=(flags=flags||"").indexOf("g")>-1,sticky=flags.indexOf("y")>-1,basicFlags=flags.replace(/y/g,""),escapeChar=options.escapeChar,vN=options.valueNames,output=[],openTokens=0,delimStart=0,delimEnd=0,lastOuterEnd=0;if(left=XRegExp(left,basicFlags),right=XRegExp(right,basicFlags),escapeChar){if(escapeChar.length>1)throw new Error("Cannot use more than one escape character");escapeChar=XRegExp.escape(escapeChar),esc=new RegExp("(?:"+escapeChar+"[\\\\S\\\\s]|(?:(?!"+XRegExp.union([left,right],"",{conjunction:"or"}).source+")[^"+escapeChar+"])+)+",flags.replace(/[^imu]+/g,""))}for(;;){if(escapeChar&&(delimEnd+=(XRegExp.exec(str,esc,delimEnd,"sticky")||[""])[0].length),leftMatch=XRegExp.exec(str,left,delimEnd),rightMatch=XRegExp.exec(str,right,delimEnd),leftMatch&&rightMatch&&(leftMatch.index<=rightMatch.index?rightMatch=null:leftMatch=null),leftMatch||rightMatch)delimEnd=(delimStart=(leftMatch||rightMatch).index)+(leftMatch||rightMatch)[0].length;else if(!openTokens)break;if(sticky&&!openTokens&&delimStart>lastOuterEnd)break;if(leftMatch)openTokens||(outerStart=delimStart,innerStart=delimEnd),++openTokens;else{if(!rightMatch||!openTokens)throw new Error("Unbalanced delimiter found in string");if(!--openTokens&&(vN?(vN[0]&&outerStart>lastOuterEnd&&output.push(row(vN[0],str.slice(lastOuterEnd,outerStart),lastOuterEnd,outerStart)),vN[1]&&output.push(row(vN[1],str.slice(outerStart,innerStart),outerStart,innerStart)),vN[2]&&output.push(row(vN[2],str.slice(innerStart,delimStart),innerStart,delimStart)),vN[3]&&output.push(row(vN[3],str.slice(delimStart,delimEnd),delimStart,delimEnd))):output.push(str.slice(innerStart,delimStart)),lastOuterEnd=delimEnd,!global))break}delimStart===delimEnd&&++delimEnd}return global&&!sticky&&vN&&vN[0]&&str.length>lastOuterEnd&&output.push(row(vN[0],str.slice(lastOuterEnd),lastOuterEnd,str.length)),output}}},{}],3:[function(require,module,exports){module.exports=function(XRegExp){var unicode={},dec=XRegExp._dec,hex=XRegExp._hex,pad4=XRegExp._pad4;function normalize(name){return name.replace(/[- _]+/g,"").toLowerCase()}function charCode(chr){var esc=/^\\\\[xu](.+)/.exec(chr);return esc?dec(esc[1]):chr.charCodeAt("\\\\"===chr.charAt(0)?1:0)}function invertBmp(range){var output="",lastEnd=-1;return XRegExp.forEach(range,/(\\\\x..|\\\\u....|\\\\?[\\s\\S])(?:-(\\\\x..|\\\\u....|\\\\?[\\s\\S]))?/,(function(m){var start=charCode(m[1]);start>lastEnd+1&&(output+="\\\\u"+pad4(hex(lastEnd+1)),start>lastEnd+2&&(output+="-\\\\u"+pad4(hex(start-1)))),lastEnd=charCode(m[2]||m[1])})),lastEnd<65535&&(output+="\\\\u"+pad4(hex(lastEnd+1)),lastEnd<65534&&(output+="-\\\\uFFFF")),output}function cacheInvertedBmp(slug){var prop="b!";return unicode[slug][prop]||(unicode[slug][prop]=invertBmp(unicode[slug].bmp))}function buildAstral(slug,isNegated){var item=unicode[slug],combined="";return item.bmp&&!item.isBmpLast&&(combined="["+item.bmp+"]"+(item.astral?"|":"")),item.astral&&(combined+=item.astral),item.isBmpLast&&item.bmp&&(combined+=(item.astral?"|":"")+"["+item.bmp+"]"),isNegated?"(?:(?!"+combined+")(?:[\\ud800-\\udbff][\\udc00-\\udfff]|[\\0-\\uffff]))":"(?:"+combined+")"}function cacheAstral(slug,isNegated){var prop=isNegated?"a!":"a=";return unicode[slug][prop]||(unicode[slug][prop]=buildAstral(slug,isNegated))}XRegExp.addToken(/\\\\([pP])(?:{(\\^?)([^}]*)}|([A-Za-z]))/,(function(match,scope,flags){var ERR_DOUBLE_NEG="Invalid double negation ",ERR_UNKNOWN_NAME="Unknown Unicode token ",ERR_UNKNOWN_REF="Unicode token missing data ",ERR_ASTRAL_ONLY="Astral mode required for Unicode token ",ERR_ASTRAL_IN_CLASS="Astral mode does not support Unicode tokens within character classes",isNegated="P"===match[1]||!!match[2],isAstralMode=flags.indexOf("A")>-1,slug=normalize(match[4]||match[3]),item=unicode[slug];if("P"===match[1]&&match[2])throw new SyntaxError(ERR_DOUBLE_NEG+match[0]);if(!unicode.hasOwnProperty(slug))throw new SyntaxError(ERR_UNKNOWN_NAME+match[0]);if(item.inverseOf){if(slug=normalize(item.inverseOf),!unicode.hasOwnProperty(slug))throw new ReferenceError(ERR_UNKNOWN_REF+match[0]+" -> "+item.inverseOf);item=unicode[slug],isNegated=!isNegated}if(!item.bmp&&!isAstralMode)throw new SyntaxError(ERR_ASTRAL_ONLY+match[0]);if(isAstralMode){if("class"===scope)throw new SyntaxError(ERR_ASTRAL_IN_CLASS);return cacheAstral(slug,isNegated)}return"class"===scope?isNegated?cacheInvertedBmp(slug):item.bmp:(isNegated?"[^":"[")+item.bmp+"]"}),{scope:"all",optionalFlags:"A",leadChar:"\\\\"}),XRegExp.addUnicodeData=function(data){for(var item,ERR_NO_NAME="Unicode token requires name",ERR_NO_DATA="Unicode token has no character data ",i=0;i<data.length;++i){if(!(item=data[i]).name)throw new Error(ERR_NO_NAME);if(!(item.inverseOf||item.bmp||item.astral))throw new Error(ERR_NO_DATA+item.name);unicode[normalize(item.name)]=item,item.alias&&(unicode[normalize(item.alias)]=item)}XRegExp.cache.flush("patterns")},XRegExp._getUnicodeProperty=function(name){var slug=normalize(name);return unicode[slug]}}},{}],4:[function(require,module,exports){module.exports=function(XRegExp){if(!XRegExp.addUnicodeData)throw new ReferenceError("Unicode Base must be loaded before Unicode Blocks");XRegExp.addUnicodeData([{name:"InAdlam",astral:"\\ud83a[\\udd00-\\udd5f]"},{name:"InAegean_Numbers",astral:"\\ud800[\\udd00-\\udd3f]"},{name:"InAhom",astral:"\\ud805[\\udf00-\\udf3f]"},{name:"InAlchemical_Symbols",astral:"\\ud83d[\\udf00-\\udf7f]"},{name:"InAlphabetic_Presentation_Forms",bmp:"\\ufb00-\\ufb4f"},{name:"InAnatolian_Hieroglyphs",astral:"\\ud811[\\udc00-\\ude7f]"},{name:"InAncient_Greek_Musical_Notation",astral:"\\ud834[\\ude00-\\ude4f]"},{name:"InAncient_Greek_Numbers",astral:"\\ud800[\\udd40-\\udd8f]"},{name:"InAncient_Symbols",astral:"\\ud800[\\udd90-\\uddcf]"},{name:"InArabic",bmp:"\\u0600-\\u06ff"},{name:"InArabic_Extended_A",bmp:"\\u08a0-\\u08ff"},{name:"InArabic_Mathematical_Alphabetic_Symbols",astral:"\\ud83b[\\ude00-\\udeff]"},{name:"InArabic_Presentation_Forms_A",bmp:"\\ufb50-\\ufdff"},{name:"InArabic_Presentation_Forms_B",bmp:"\\ufe70-\\ufeff"},{name:"InArabic_Supplement",bmp:"\\u0750-\\u077f"},{name:"InArmenian",bmp:"\\u0530-\\u058f"},{name:"InArrows",bmp:"\\u2190-\\u21ff"},{name:"InAvestan",astral:"\\ud802[\\udf00-\\udf3f]"},{name:"InBalinese",bmp:"\\u1b00-\\u1b7f"},{name:"InBamum",bmp:"\\ua6a0-\\ua6ff"},{name:"InBamum_Supplement",astral:"\\ud81a[\\udc00-\\ude3f]"},{name:"InBasic_Latin",bmp:"\\0-\\x7f"},{name:"InBassa_Vah",astral:"\\ud81a[\\uded0-\\udeff]"},{name:"InBatak",bmp:"\\u1bc0-\\u1bff"},{name:"InBengali",bmp:"\\u0980-\\u09ff"},{name:"InBhaiksuki",astral:"\\ud807[\\udc00-\\udc6f]"},{name:"InBlock_Elements",bmp:"\\u2580-\\u259f"},{name:"InBopomofo",bmp:"\\u3100-\\u312f"},{name:"InBopomofo_Extended",bmp:"\\u31a0-\\u31bf"},{name:"InBox_Drawing",bmp:"\\u2500-\\u257f"},{name:"InBrahmi",astral:"\\ud804[\\udc00-\\udc7f]"},{name:"InBraille_Patterns",bmp:"\\u2800-\\u28ff"},{name:"InBuginese",bmp:"\\u1a00-\\u1a1f"},{name:"InBuhid",bmp:"\\u1740-\\u175f"},{name:"InByzantine_Musical_Symbols",astral:"\\ud834[\\udc00-\\udcff]"},{name:"InCJK_Compatibility",bmp:"\\u3300-\\u33ff"},{name:"InCJK_Compatibility_Forms",bmp:"\\ufe30-\\ufe4f"},{name:"InCJK_Compatibility_Ideographs",bmp:"\\uf900-\\ufaff"},{name:"InCJK_Compatibility_Ideographs_Supplement",astral:"\\ud87e[\\udc00-\\ude1f]"},{name:"InCJK_Radicals_Supplement",bmp:"\\u2e80-\\u2eff"},{name:"InCJK_Strokes",bmp:"\\u31c0-\\u31ef"},{name:"InCJK_Symbols_and_Punctuation",bmp:"\\u3000-\\u303f"},{name:"InCJK_Unified_Ideographs",bmp:"\\u4e00-\\u9fff"},{name:"InCJK_Unified_Ideographs_Extension_A",bmp:"\\u3400-\\u4dbf"},{name:"InCJK_Unified_Ideographs_Extension_B",astral:"[\\ud840-\\ud868][\\udc00-\\udfff]|\\ud869[\\udc00-\\udedf]"},{name:"InCJK_Unified_Ideographs_Extension_C",astral:"\\ud869[\\udf00-\\udfff]|[\\ud86a-\\ud86c][\\udc00-\\udfff]|\\ud86d[\\udc00-\\udf3f]"},{name:"InCJK_Unified_Ideographs_Extension_D",astral:"\\ud86d[\\udf40-\\udfff]|\\ud86e[\\udc00-\\udc1f]"},{name:"InCJK_Unified_Ideographs_Extension_E",astral:"\\ud86e[\\udc20-\\udfff]|[\\ud86f-\\ud872][\\udc00-\\udfff]|\\ud873[\\udc00-\\udeaf]"},{name:"InCarian",astral:"\\ud800[\\udea0-\\udedf]"},{name:"InCaucasian_Albanian",astral:"\\ud801[\\udd30-\\udd6f]"},{name:"InChakma",astral:"\\ud804[\\udd00-\\udd4f]"},{name:"InCham",bmp:"\\uaa00-\\uaa5f"},{name:"InCherokee",bmp:"\\u13a0-\\u13ff"},{name:"InCherokee_Supplement",bmp:"\\uab70-\\uabbf"},{name:"InCombining_Diacritical_Marks",bmp:"\\u0300-\\u036f"},{name:"InCombining_Diacritical_Marks_Extended",bmp:"\\u1ab0-\\u1aff"},{name:"InCombining_Diacritical_Marks_Supplement",bmp:"\\u1dc0-\\u1dff"},{name:"InCombining_Diacritical_Marks_for_Symbols",bmp:"\\u20d0-\\u20ff"},{name:"InCombining_Half_Marks",bmp:"\\ufe20-\\ufe2f"},{name:"InCommon_Indic_Number_Forms",bmp:"\\ua830-\\ua83f"},{name:"InControl_Pictures",bmp:"\\u2400-\\u243f"},{name:"InCoptic",bmp:"\\u2c80-\\u2cff"},{name:"InCoptic_Epact_Numbers",astral:"\\ud800[\\udee0-\\udeff]"},{name:"InCounting_Rod_Numerals",astral:"\\ud834[\\udf60-\\udf7f]"},{name:"InCuneiform",astral:"\\ud808[\\udc00-\\udfff]"},{name:"InCuneiform_Numbers_and_Punctuation",astral:"\\ud809[\\udc00-\\udc7f]"},{name:"InCurrency_Symbols",bmp:"\\u20a0-\\u20cf"},{name:"InCypriot_Syllabary",astral:"\\ud802[\\udc00-\\udc3f]"},{name:"InCyrillic",bmp:"\\u0400-\\u04ff"},{name:"InCyrillic_Extended_A",bmp:"\\u2de0-\\u2dff"},{name:"InCyrillic_Extended_B",bmp:"\\ua640-\\ua69f"},{name:"InCyrillic_Extended_C",bmp:"\\u1c80-\\u1c8f"},{name:"InCyrillic_Supplement",bmp:"\\u0500-\\u052f"},{name:"InDeseret",astral:"\\ud801[\\udc00-\\udc4f]"},{name:"InDevanagari",bmp:"\\u0900-\\u097f"},{name:"InDevanagari_Extended",bmp:"\\ua8e0-\\ua8ff"},{name:"InDingbats",bmp:"\\u2700-\\u27bf"},{name:"InDomino_Tiles",astral:"\\ud83c[\\udc30-\\udc9f]"},{name:"InDuployan",astral:"\\ud82f[\\udc00-\\udc9f]"},{name:"InEarly_Dynastic_Cuneiform",astral:"\\ud809[\\udc80-\\udd4f]"},{name:"InEgyptian_Hieroglyphs",astral:"\\ud80c[\\udc00-\\udfff]|\\ud80d[\\udc00-\\udc2f]"},{name:"InElbasan",astral:"\\ud801[\\udd00-\\udd2f]"},{name:"InEmoticons",astral:"\\ud83d[\\ude00-\\ude4f]"},{name:"InEnclosed_Alphanumeric_Supplement",astral:"\\ud83c[\\udd00-\\uddff]"},{name:"InEnclosed_Alphanumerics",bmp:"\\u2460-\\u24ff"},{name:"InEnclosed_CJK_Letters_and_Months",bmp:"\\u3200-\\u32ff"},{name:"InEnclosed_Ideographic_Supplement",astral:"\\ud83c[\\ude00-\\udeff]"},{name:"InEthiopic",bmp:"\\u1200-\\u137f"},{name:"InEthiopic_Extended",bmp:"\\u2d80-\\u2ddf"},{name:"InEthiopic_Extended_A",bmp:"\\uab00-\\uab2f"},{name:"InEthiopic_Supplement",bmp:"\\u1380-\\u139f"},{name:"InGeneral_Punctuation",bmp:"\\u2000-\\u206f"},{name:"InGeometric_Shapes",bmp:"\\u25a0-\\u25ff"},{name:"InGeometric_Shapes_Extended",astral:"\\ud83d[\\udf80-\\udfff]"},{name:"InGeorgian",bmp:"\\u10a0-\\u10ff"},{name:"InGeorgian_Supplement",bmp:"\\u2d00-\\u2d2f"},{name:"InGlagolitic",bmp:"\\u2c00-\\u2c5f"},{name:"InGlagolitic_Supplement",astral:"\\ud838[\\udc00-\\udc2f]"},{name:"InGothic",astral:"\\ud800[\\udf30-\\udf4f]"},{name:"InGrantha",astral:"\\ud804[\\udf00-\\udf7f]"},{name:"InGreek_Extended",bmp:"\\u1f00-\\u1fff"},{name:"InGreek_and_Coptic",bmp:"\\u0370-\\u03ff"},{name:"InGujarati",bmp:"\\u0a80-\\u0aff"},{name:"InGurmukhi",bmp:"\\u0a00-\\u0a7f"},{name:"InHalfwidth_and_Fullwidth_Forms",bmp:"\\uff00-\\uffef"},{name:"InHangul_Compatibility_Jamo",bmp:"\\u3130-\\u318f"},{name:"InHangul_Jamo",bmp:"\\u1100-\\u11ff"},{name:"InHangul_Jamo_Extended_A",bmp:"\\ua960-\\ua97f"},{name:"InHangul_Jamo_Extended_B",bmp:"\\ud7b0-\\ud7ff"},{name:"InHangul_Syllables",bmp:"\\uac00-\\ud7af"},{name:"InHanunoo",bmp:"\\u1720-\\u173f"},{name:"InHatran",astral:"\\ud802[\\udce0-\\udcff]"},{name:"InHebrew",bmp:"\\u0590-\\u05ff"},{name:"InHigh_Private_Use_Surrogates",bmp:"\\udb80-\\udbff"},{name:"InHigh_Surrogates",bmp:"\\ud800-\\udb7f"},{name:"InHiragana",bmp:"\\u3040-\\u309f"},{name:"InIPA_Extensions",bmp:"\\u0250-\\u02af"},{name:"InIdeographic_Description_Characters",bmp:"\\u2ff0-\\u2fff"},{name:"InIdeographic_Symbols_and_Punctuation",astral:"\\ud81b[\\udfe0-\\udfff]"},{name:"InImperial_Aramaic",astral:"\\ud802[\\udc40-\\udc5f]"},{name:"InInscriptional_Pahlavi",astral:"\\ud802[\\udf60-\\udf7f]"},{name:"InInscriptional_Parthian",astral:"\\ud802[\\udf40-\\udf5f]"},{name:"InJavanese",bmp:"\\ua980-\\ua9df"},{name:"InKaithi",astral:"\\ud804[\\udc80-\\udccf]"},{name:"InKana_Supplement",astral:"\\ud82c[\\udc00-\\udcff]"},{name:"InKanbun",bmp:"\\u3190-\\u319f"},{name:"InKangxi_Radicals",bmp:"\\u2f00-\\u2fdf"},{name:"InKannada",bmp:"\\u0c80-\\u0cff"},{name:"InKatakana",bmp:"\\u30a0-\\u30ff"},{name:"InKatakana_Phonetic_Extensions",bmp:"\\u31f0-\\u31ff"},{name:"InKayah_Li",bmp:"\\ua900-\\ua92f"},{name:"InKharoshthi",astral:"\\ud802[\\ude00-\\ude5f]"},{name:"InKhmer",bmp:"\\u1780-\\u17ff"},{name:"InKhmer_Symbols",bmp:"\\u19e0-\\u19ff"},{name:"InKhojki",astral:"\\ud804[\\ude00-\\ude4f]"},{name:"InKhudawadi",astral:"\\ud804[\\udeb0-\\udeff]"},{name:"InLao",bmp:"\\u0e80-\\u0eff"},{name:"InLatin_Extended_Additional",bmp:"\\u1e00-\\u1eff"},{name:"InLatin_Extended_A",bmp:"\\u0100-\\u017f"},{name:"InLatin_Extended_B",bmp:"\\u0180-\\u024f"},{name:"InLatin_Extended_C",bmp:"\\u2c60-\\u2c7f"},{name:"InLatin_Extended_D",bmp:"\\ua720-\\ua7ff"},{name:"InLatin_Extended_E",bmp:"\\uab30-\\uab6f"},{name:"InLatin_1_Supplement",bmp:"\\x80-\\xff"},{name:"InLepcha",bmp:"\\u1c00-\\u1c4f"},{name:"InLetterlike_Symbols",bmp:"\\u2100-\\u214f"},{name:"InLimbu",bmp:"\\u1900-\\u194f"},{name:"InLinear_A",astral:"\\ud801[\\ude00-\\udf7f]"},{name:"InLinear_B_Ideograms",astral:"\\ud800[\\udc80-\\udcff]"},{name:"InLinear_B_Syllabary",astral:"\\ud800[\\udc00-\\udc7f]"},{name:"InLisu",bmp:"\\ua4d0-\\ua4ff"},{name:"InLow_Surrogates",bmp:"\\udc00-\\udfff"},{name:"InLycian",astral:"\\ud800[\\ude80-\\ude9f]"},{name:"InLydian",astral:"\\ud802[\\udd20-\\udd3f]"},{name:"InMahajani",astral:"\\ud804[\\udd50-\\udd7f]"},{name:"InMahjong_Tiles",astral:"\\ud83c[\\udc00-\\udc2f]"},{name:"InMalayalam",bmp:"\\u0d00-\\u0d7f"},{name:"InMandaic",bmp:"\\u0840-\\u085f"},{name:"InManichaean",astral:"\\ud802[\\udec0-\\udeff]"},{name:"InMarchen",astral:"\\ud807[\\udc70-\\udcbf]"},{name:"InMathematical_Alphanumeric_Symbols",astral:"\\ud835[\\udc00-\\udfff]"},{name:"InMathematical_Operators",bmp:"\\u2200-\\u22ff"},{name:"InMeetei_Mayek",bmp:"\\uabc0-\\uabff"},{name:"InMeetei_Mayek_Extensions",bmp:"\\uaae0-\\uaaff"},{name:"InMende_Kikakui",astral:"\\ud83a[\\udc00-\\udcdf]"},{name:"InMeroitic_Cursive",astral:"\\ud802[\\udda0-\\uddff]"},{name:"InMeroitic_Hieroglyphs",astral:"\\ud802[\\udd80-\\udd9f]"},{name:"InMiao",astral:"\\ud81b[\\udf00-\\udf9f]"},{name:"InMiscellaneous_Mathematical_Symbols_A",bmp:"\\u27c0-\\u27ef"},{name:"InMiscellaneous_Mathematical_Symbols_B",bmp:"\\u2980-\\u29ff"},{name:"InMiscellaneous_Symbols",bmp:"\\u2600-\\u26ff"},{name:"InMiscellaneous_Symbols_and_Arrows",bmp:"\\u2b00-\\u2bff"},{name:"InMiscellaneous_Symbols_and_Pictographs",astral:"\\ud83c[\\udf00-\\udfff]|\\ud83d[\\udc00-\\uddff]"},{name:"InMiscellaneous_Technical",bmp:"\\u2300-\\u23ff"},{name:"InModi",astral:"\\ud805[\\ude00-\\ude5f]"},{name:"InModifier_Tone_Letters",bmp:"\\ua700-\\ua71f"},{name:"InMongolian",bmp:"\\u1800-\\u18af"},{name:"InMongolian_Supplement",astral:"\\ud805[\\ude60-\\ude7f]"},{name:"InMro",astral:"\\ud81a[\\ude40-\\ude6f]"},{name:"InMultani",astral:"\\ud804[\\ude80-\\udeaf]"},{name:"InMusical_Symbols",astral:"\\ud834[\\udd00-\\uddff]"},{name:"InMyanmar",bmp:"\\u1000-\\u109f"},{name:"InMyanmar_Extended_A",bmp:"\\uaa60-\\uaa7f"},{name:"InMyanmar_Extended_B",bmp:"\\ua9e0-\\ua9ff"},{name:"InNKo",bmp:"\\u07c0-\\u07ff"},{name:"InNabataean",astral:"\\ud802[\\udc80-\\udcaf]"},{name:"InNew_Tai_Lue",bmp:"\\u1980-\\u19df"},{name:"InNewa",astral:"\\ud805[\\udc00-\\udc7f]"},{name:"InNumber_Forms",bmp:"\\u2150-\\u218f"},{name:"InOgham",bmp:"\\u1680-\\u169f"},{name:"InOl_Chiki",bmp:"\\u1c50-\\u1c7f"},{name:"InOld_Hungarian",astral:"\\ud803[\\udc80-\\udcff]"},{name:"InOld_Italic",astral:"\\ud800[\\udf00-\\udf2f]"},{name:"InOld_North_Arabian",astral:"\\ud802[\\ude80-\\ude9f]"},{name:"InOld_Permic",astral:"\\ud800[\\udf50-\\udf7f]"},{name:"InOld_Persian",astral:"\\ud800[\\udfa0-\\udfdf]"},{name:"InOld_South_Arabian",astral:"\\ud802[\\ude60-\\ude7f]"},{name:"InOld_Turkic",astral:"\\ud803[\\udc00-\\udc4f]"},{name:"InOptical_Character_Recognition",bmp:"\\u2440-\\u245f"},{name:"InOriya",bmp:"\\u0b00-\\u0b7f"},{name:"InOrnamental_Dingbats",astral:"\\ud83d[\\ude50-\\ude7f]"},{name:"InOsage",astral:"\\ud801[\\udcb0-\\udcff]"},{name:"InOsmanya",astral:"\\ud801[\\udc80-\\udcaf]"},{name:"InPahawh_Hmong",astral:"\\ud81a[\\udf00-\\udf8f]"},{name:"InPalmyrene",astral:"\\ud802[\\udc60-\\udc7f]"},{name:"InPau_Cin_Hau",astral:"\\ud806[\\udec0-\\udeff]"},{name:"InPhags_pa",bmp:"\\ua840-\\ua87f"},{name:"InPhaistos_Disc",astral:"\\ud800[\\uddd0-\\uddff]"},{name:"InPhoenician",astral:"\\ud802[\\udd00-\\udd1f]"},{name:"InPhonetic_Extensions",bmp:"\\u1d00-\\u1d7f"},{name:"InPhonetic_Extensions_Supplement",bmp:"\\u1d80-\\u1dbf"},{name:"InPlaying_Cards",astral:"\\ud83c[\\udca0-\\udcff]"},{name:"InPrivate_Use_Area",bmp:"\\ue000-\\uf8ff"},{name:"InPsalter_Pahlavi",astral:"\\ud802[\\udf80-\\udfaf]"},{name:"InRejang",bmp:"\\ua930-\\ua95f"},{name:"InRumi_Numeral_Symbols",astral:"\\ud803[\\ude60-\\ude7f]"},{name:"InRunic",bmp:"\\u16a0-\\u16ff"},{name:"InSamaritan",bmp:"\\u0800-\\u083f"},{name:"InSaurashtra",bmp:"\\ua880-\\ua8df"},{name:"InSharada",astral:"\\ud804[\\udd80-\\udddf]"},{name:"InShavian",astral:"\\ud801[\\udc50-\\udc7f]"},{name:"InShorthand_Format_Controls",astral:"\\ud82f[\\udca0-\\udcaf]"},{name:"InSiddham",astral:"\\ud805[\\udd80-\\uddff]"},{name:"InSinhala",bmp:"\\u0d80-\\u0dff"},{name:"InSinhala_Archaic_Numbers",astral:"\\ud804[\\udde0-\\uddff]"},{name:"InSmall_Form_Variants",bmp:"\\ufe50-\\ufe6f"},{name:"InSora_Sompeng",astral:"\\ud804[\\udcd0-\\udcff]"},{name:"InSpacing_Modifier_Letters",bmp:"\\u02b0-\\u02ff"},{name:"InSpecials",bmp:"\\ufff0-\\uffff"},{name:"InSundanese",bmp:"\\u1b80-\\u1bbf"},{name:"InSundanese_Supplement",bmp:"\\u1cc0-\\u1ccf"},{name:"InSuperscripts_and_Subscripts",bmp:"\\u2070-\\u209f"},{name:"InSupplemental_Arrows_A",bmp:"\\u27f0-\\u27ff"},{name:"InSupplemental_Arrows_B",bmp:"\\u2900-\\u297f"},{name:"InSupplemental_Arrows_C",astral:"\\ud83e[\\udc00-\\udcff]"},{name:"InSupplemental_Mathematical_Operators",bmp:"\\u2a00-\\u2aff"},{name:"InSupplemental_Punctuation",bmp:"\\u2e00-\\u2e7f"},{name:"InSupplemental_Symbols_and_Pictographs",astral:"\\ud83e[\\udd00-\\uddff]"},{name:"InSupplementary_Private_Use_Area_A",astral:"[\\udb80-\\udbbf][\\udc00-\\udfff]"},{name:"InSupplementary_Private_Use_Area_B",astral:"[\\udbc0-\\udbff][\\udc00-\\udfff]"},{name:"InSutton_SignWriting",astral:"\\ud836[\\udc00-\\udeaf]"},{name:"InSyloti_Nagri",bmp:"\\ua800-\\ua82f"},{name:"InSyriac",bmp:"\\u0700-\\u074f"},{name:"InTagalog",bmp:"\\u1700-\\u171f"},{name:"InTagbanwa",bmp:"\\u1760-\\u177f"},{name:"InTags",astral:"\\udb40[\\udc00-\\udc7f]"},{name:"InTai_Le",bmp:"\\u1950-\\u197f"},{name:"InTai_Tham",bmp:"\\u1a20-\\u1aaf"},{name:"InTai_Viet",bmp:"\\uaa80-\\uaadf"},{name:"InTai_Xuan_Jing_Symbols",astral:"\\ud834[\\udf00-\\udf5f]"},{name:"InTakri",astral:"\\ud805[\\ude80-\\udecf]"},{name:"InTamil",bmp:"\\u0b80-\\u0bff"},{name:"InTangut",astral:"[\\ud81c-\\ud821][\\udc00-\\udfff]"},{name:"InTangut_Components",astral:"\\ud822[\\udc00-\\udeff]"},{name:"InTelugu",bmp:"\\u0c00-\\u0c7f"},{name:"InThaana",bmp:"\\u0780-\\u07bf"},{name:"InThai",bmp:"\\u0e00-\\u0e7f"},{name:"InTibetan",bmp:"\\u0f00-\\u0fff"},{name:"InTifinagh",bmp:"\\u2d30-\\u2d7f"},{name:"InTirhuta",astral:"\\ud805[\\udc80-\\udcdf]"},{name:"InTransport_and_Map_Symbols",astral:"\\ud83d[\\ude80-\\udeff]"},{name:"InUgaritic",astral:"\\ud800[\\udf80-\\udf9f]"},{name:"InUnified_Canadian_Aboriginal_Syllabics",bmp:"\\u1400-\\u167f"},{name:"InUnified_Canadian_Aboriginal_Syllabics_Extended",bmp:"\\u18b0-\\u18ff"},{name:"InVai",bmp:"\\ua500-\\ua63f"},{name:"InVariation_Selectors",bmp:"\\ufe00-\\ufe0f"},{name:"InVariation_Selectors_Supplement",astral:"\\udb40[\\udd00-\\uddef]"},{name:"InVedic_Extensions",bmp:"\\u1cd0-\\u1cff"},{name:"InVertical_Forms",bmp:"\\ufe10-\\ufe1f"},{name:"InWarang_Citi",astral:"\\ud806[\\udca0-\\udcff]"},{name:"InYi_Radicals",bmp:"\\ua490-\\ua4cf"},{name:"InYi_Syllables",bmp:"\\ua000-\\ua48f"},{name:"InYijing_Hexagram_Symbols",bmp:"\\u4dc0-\\u4dff"}])}},{}],5:[function(require,module,exports){module.exports=function(XRegExp){if(!XRegExp.addUnicodeData)throw new ReferenceError("Unicode Base must be loaded before Unicode Categories");XRegExp.addUnicodeData([{name:"C",alias:"Other",isBmpLast:!0,bmp:"\\0-\\x1f\\x7f-\\x9f\\xad\\u0378\\u0379\\u0380-\\u0383\\u038b\\u038d\\u03a2\\u0530\\u0557\\u0558\\u0560\\u0588\\u058b\\u058c\\u0590\\u05c8-\\u05cf\\u05eb-\\u05ef\\u05f5-\\u0605\\u061c\\u061d\\u06dd\\u070e\\u070f\\u074b\\u074c\\u07b2-\\u07bf\\u07fb-\\u07ff\\u082e\\u082f\\u083f\\u085c\\u085d\\u085f-\\u089f\\u08b5\\u08be-\\u08d3\\u08e2\\u0984\\u098d\\u098e\\u0991\\u0992\\u09a9\\u09b1\\u09b3-\\u09b5\\u09ba\\u09bb\\u09c5\\u09c6\\u09c9\\u09ca\\u09cf-\\u09d6\\u09d8-\\u09db\\u09de\\u09e4\\u09e5\\u09fc-\\u0a00\\u0a04\\u0a0b-\\u0a0e\\u0a11\\u0a12\\u0a29\\u0a31\\u0a34\\u0a37\\u0a3a\\u0a3b\\u0a3d\\u0a43-\\u0a46\\u0a49\\u0a4a\\u0a4e-\\u0a50\\u0a52-\\u0a58\\u0a5d\\u0a5f-\\u0a65\\u0a76-\\u0a80\\u0a84\\u0a8e\\u0a92\\u0aa9\\u0ab1\\u0ab4\\u0aba\\u0abb\\u0ac6\\u0aca\\u0ace\\u0acf\\u0ad1-\\u0adf\\u0ae4\\u0ae5\\u0af2-\\u0af8\\u0afa-\\u0b00\\u0b04\\u0b0d\\u0b0e\\u0b11\\u0b12\\u0b29\\u0b31\\u0b34\\u0b3a\\u0b3b\\u0b45\\u0b46\\u0b49\\u0b4a\\u0b4e-\\u0b55\\u0b58-\\u0b5b\\u0b5e\\u0b64\\u0b65\\u0b78-\\u0b81\\u0b84\\u0b8b-\\u0b8d\\u0b91\\u0b96-\\u0b98\\u0b9b\\u0b9d\\u0ba0-\\u0ba2\\u0ba5-\\u0ba7\\u0bab-\\u0bad\\u0bba-\\u0bbd\\u0bc3-\\u0bc5\\u0bc9\\u0bce\\u0bcf\\u0bd1-\\u0bd6\\u0bd8-\\u0be5\\u0bfb-\\u0bff\\u0c04\\u0c0d\\u0c11\\u0c29\\u0c3a-\\u0c3c\\u0c45\\u0c49\\u0c4e-\\u0c54\\u0c57\\u0c5b-\\u0c5f\\u0c64\\u0c65\\u0c70-\\u0c77\\u0c84\\u0c8d\\u0c91\\u0ca9\\u0cb4\\u0cba\\u0cbb\\u0cc5\\u0cc9\\u0cce-\\u0cd4\\u0cd7-\\u0cdd\\u0cdf\\u0ce4\\u0ce5\\u0cf0\\u0cf3-\\u0d00\\u0d04\\u0d0d\\u0d11\\u0d3b\\u0d3c\\u0d45\\u0d49\\u0d50-\\u0d53\\u0d64\\u0d65\\u0d80\\u0d81\\u0d84\\u0d97-\\u0d99\\u0db2\\u0dbc\\u0dbe\\u0dbf\\u0dc7-\\u0dc9\\u0dcb-\\u0dce\\u0dd5\\u0dd7\\u0de0-\\u0de5\\u0df0\\u0df1\\u0df5-\\u0e00\\u0e3b-\\u0e3e\\u0e5c-\\u0e80\\u0e83\\u0e85\\u0e86\\u0e89\\u0e8b\\u0e8c\\u0e8e-\\u0e93\\u0e98\\u0ea0\\u0ea4\\u0ea6\\u0ea8\\u0ea9\\u0eac\\u0eba\\u0ebe\\u0ebf\\u0ec5\\u0ec7\\u0ece\\u0ecf\\u0eda\\u0edb\\u0ee0-\\u0eff\\u0f48\\u0f6d-\\u0f70\\u0f98\\u0fbd\\u0fcd\\u0fdb-\\u0fff\\u10c6\\u10c8-\\u10cc\\u10ce\\u10cf\\u1249\\u124e\\u124f\\u1257\\u1259\\u125e\\u125f\\u1289\\u128e\\u128f\\u12b1\\u12b6\\u12b7\\u12bf\\u12c1\\u12c6\\u12c7\\u12d7\\u1311\\u1316\\u1317\\u135b\\u135c\\u137d-\\u137f\\u139a-\\u139f\\u13f6\\u13f7\\u13fe\\u13ff\\u169d-\\u169f\\u16f9-\\u16ff\\u170d\\u1715-\\u171f\\u1737-\\u173f\\u1754-\\u175f\\u176d\\u1771\\u1774-\\u177f\\u17de\\u17df\\u17ea-\\u17ef\\u17fa-\\u17ff\\u180e\\u180f\\u181a-\\u181f\\u1878-\\u187f\\u18ab-\\u18af\\u18f6-\\u18ff\\u191f\\u192c-\\u192f\\u193c-\\u193f\\u1941-\\u1943\\u196e\\u196f\\u1975-\\u197f\\u19ac-\\u19af\\u19ca-\\u19cf\\u19db-\\u19dd\\u1a1c\\u1a1d\\u1a5f\\u1a7d\\u1a7e\\u1a8a-\\u1a8f\\u1a9a-\\u1a9f\\u1aae\\u1aaf\\u1abf-\\u1aff\\u1b4c-\\u1b4f\\u1b7d-\\u1b7f\\u1bf4-\\u1bfb\\u1c38-\\u1c3a\\u1c4a-\\u1c4c\\u1c89-\\u1cbf\\u1cc8-\\u1ccf\\u1cf7\\u1cfa-\\u1cff\\u1df6-\\u1dfa\\u1f16\\u1f17\\u1f1e\\u1f1f\\u1f46\\u1f47\\u1f4e\\u1f4f\\u1f58\\u1f5a\\u1f5c\\u1f5e\\u1f7e\\u1f7f\\u1fb5\\u1fc5\\u1fd4\\u1fd5\\u1fdc\\u1ff0\\u1ff1\\u1ff5\\u1fff\\u200b-\\u200f\\u202a-\\u202e\\u2060-\\u206f\\u2072\\u2073\\u208f\\u209d-\\u209f\\u20bf-\\u20cf\\u20f1-\\u20ff\\u218c-\\u218f\\u23ff\\u2427-\\u243f\\u244b-\\u245f\\u2b74\\u2b75\\u2b96\\u2b97\\u2bba-\\u2bbc\\u2bc9\\u2bd2-\\u2beb\\u2bf0-\\u2bff\\u2c2f\\u2c5f\\u2cf4-\\u2cf8\\u2d26\\u2d28-\\u2d2c\\u2d2e\\u2d2f\\u2d68-\\u2d6e\\u2d71-\\u2d7e\\u2d97-\\u2d9f\\u2da7\\u2daf\\u2db7\\u2dbf\\u2dc7\\u2dcf\\u2dd7\\u2ddf\\u2e45-\\u2e7f\\u2e9a\\u2ef4-\\u2eff\\u2fd6-\\u2fef\\u2ffc-\\u2fff\\u3040\\u3097\\u3098\\u3100-\\u3104\\u312e-\\u3130\\u318f\\u31bb-\\u31bf\\u31e4-\\u31ef\\u321f\\u32ff\\u4db6-\\u4dbf\\u9fd6-\\u9fff\\ua48d-\\ua48f\\ua4c7-\\ua4cf\\ua62c-\\ua63f\\ua6f8-\\ua6ff\\ua7af\\ua7b8-\\ua7f6\\ua82c-\\ua82f\\ua83a-\\ua83f\\ua878-\\ua87f\\ua8c6-\\ua8cd\\ua8da-\\ua8df\\ua8fe\\ua8ff\\ua954-\\ua95e\\ua97d-\\ua97f\\ua9ce\\ua9da-\\ua9dd\\ua9ff\\uaa37-\\uaa3f\\uaa4e\\uaa4f\\uaa5a\\uaa5b\\uaac3-\\uaada\\uaaf7-\\uab00\\uab07\\uab08\\uab0f\\uab10\\uab17-\\uab1f\\uab27\\uab2f\\uab66-\\uab6f\\uabee\\uabef\\uabfa-\\uabff\\ud7a4-\\ud7af\\ud7c7-\\ud7ca\\ud7fc-\\uf8ff\\ufa6e\\ufa6f\\ufada-\\ufaff\\ufb07-\\ufb12\\ufb18-\\ufb1c\\ufb37\\ufb3d\\ufb3f\\ufb42\\ufb45\\ufbc2-\\ufbd2\\ufd40-\\ufd4f\\ufd90\\ufd91\\ufdc8-\\ufdef\\ufdfe\\ufdff\\ufe1a-\\ufe1f\\ufe53\\ufe67\\ufe6c-\\ufe6f\\ufe75\\ufefd-\\uff00\\uffbf-\\uffc1\\uffc8\\uffc9\\uffd0\\uffd1\\uffd8\\uffd9\\uffdd-\\uffdf\\uffe7\\uffef-\\ufffb\\ufffe\\uffff",astral:"\\ud800[\\udc0c\\udc27\\udc3b\\udc3e\\udc4e\\udc4f\\udc5e-\\udc7f\\udcfb-\\udcff\\udd03-\\udd06\\udd34-\\udd36\\udd8f\\udd9c-\\udd9f\\udda1-\\uddcf\\uddfe-\\ude7f\\ude9d-\\ude9f\\uded1-\\udedf\\udefc-\\udeff\\udf24-\\udf2f\\udf4b-\\udf4f\\udf7b-\\udf7f\\udf9e\\udfc4-\\udfc7\\udfd6-\\udfff]|\\ud801[\\udc9e\\udc9f\\udcaa-\\udcaf\\udcd4-\\udcd7\\udcfc-\\udcff\\udd28-\\udd2f\\udd64-\\udd6e\\udd70-\\uddff\\udf37-\\udf3f\\udf56-\\udf5f\\udf68-\\udfff]|\\ud802[\\udc06\\udc07\\udc09\\udc36\\udc39-\\udc3b\\udc3d\\udc3e\\udc56\\udc9f-\\udca6\\udcb0-\\udcdf\\udcf3\\udcf6-\\udcfa\\udd1c-\\udd1e\\udd3a-\\udd3e\\udd40-\\udd7f\\uddb8-\\uddbb\\uddd0\\uddd1\\ude04\\ude07-\\ude0b\\ude14\\ude18\\ude34-\\ude37\\ude3b-\\ude3e\\ude48-\\ude4f\\ude59-\\ude5f\\udea0-\\udebf\\udee7-\\udeea\\udef7-\\udeff\\udf36-\\udf38\\udf56\\udf57\\udf73-\\udf77\\udf92-\\udf98\\udf9d-\\udfa8\\udfb0-\\udfff]|\\ud803[\\udc49-\\udc7f\\udcb3-\\udcbf\\udcf3-\\udcf9\\udd00-\\ude5f\\ude7f-\\udfff]|\\ud804[\\udc4e-\\udc51\\udc70-\\udc7e\\udcbd\\udcc2-\\udccf\\udce9-\\udcef\\udcfa-\\udcff\\udd35\\udd44-\\udd4f\\udd77-\\udd7f\\uddce\\uddcf\\udde0\\uddf5-\\uddff\\ude12\\ude3f-\\ude7f\\ude87\\ude89\\ude8e\\ude9e\\udeaa-\\udeaf\\udeeb-\\udeef\\udefa-\\udeff\\udf04\\udf0d\\udf0e\\udf11\\udf12\\udf29\\udf31\\udf34\\udf3a\\udf3b\\udf45\\udf46\\udf49\\udf4a\\udf4e\\udf4f\\udf51-\\udf56\\udf58-\\udf5c\\udf64\\udf65\\udf6d-\\udf6f\\udf75-\\udfff]|\\ud805[\\udc5a\\udc5c\\udc5e-\\udc7f\\udcc8-\\udccf\\udcda-\\udd7f\\uddb6\\uddb7\\uddde-\\uddff\\ude45-\\ude4f\\ude5a-\\ude5f\\ude6d-\\ude7f\\udeb8-\\udebf\\udeca-\\udeff\\udf1a-\\udf1c\\udf2c-\\udf2f\\udf40-\\udfff]|\\ud806[\\udc00-\\udc9f\\udcf3-\\udcfe\\udd00-\\udebf\\udef9-\\udfff]|\\ud807[\\udc09\\udc37\\udc46-\\udc4f\\udc6d-\\udc6f\\udc90\\udc91\\udca8\\udcb7-\\udfff]|\\ud808[\\udf9a-\\udfff]|\\ud809[\\udc6f\\udc75-\\udc7f\\udd44-\\udfff]|[\\ud80a\\ud80b\\ud80e-\\ud810\\ud812-\\ud819\\ud823-\\ud82b\\ud82d\\ud82e\\ud830-\\ud833\\ud837\\ud839\\ud83f\\ud874-\\ud87d\\ud87f-\\udb3f\\udb41-\\udbff][\\udc00-\\udfff]|\\ud80d[\\udc2f-\\udfff]|\\ud811[\\ude47-\\udfff]|\\ud81a[\\ude39-\\ude3f\\ude5f\\ude6a-\\ude6d\\ude70-\\udecf\\udeee\\udeef\\udef6-\\udeff\\udf46-\\udf4f\\udf5a\\udf62\\udf78-\\udf7c\\udf90-\\udfff]|\\ud81b[\\udc00-\\udeff\\udf45-\\udf4f\\udf7f-\\udf8e\\udfa0-\\udfdf\\udfe1-\\udfff]|\\ud821[\\udfed-\\udfff]|\\ud822[\\udef3-\\udfff]|\\ud82c[\\udc02-\\udfff]|\\ud82f[\\udc6b-\\udc6f\\udc7d-\\udc7f\\udc89-\\udc8f\\udc9a\\udc9b\\udca0-\\udfff]|\\ud834[\\udcf6-\\udcff\\udd27\\udd28\\udd73-\\udd7a\\udde9-\\uddff\\ude46-\\udeff\\udf57-\\udf5f\\udf72-\\udfff]|\\ud835[\\udc55\\udc9d\\udca0\\udca1\\udca3\\udca4\\udca7\\udca8\\udcad\\udcba\\udcbc\\udcc4\\udd06\\udd0b\\udd0c\\udd15\\udd1d\\udd3a\\udd3f\\udd45\\udd47-\\udd49\\udd51\\udea6\\udea7\\udfcc\\udfcd]|\\ud836[\\ude8c-\\ude9a\\udea0\\udeb0-\\udfff]|\\ud838[\\udc07\\udc19\\udc1a\\udc22\\udc25\\udc2b-\\udfff]|\\ud83a[\\udcc5\\udcc6\\udcd7-\\udcff\\udd4b-\\udd4f\\udd5a-\\udd5d\\udd60-\\udfff]|\\ud83b[\\udc00-\\uddff\\ude04\\ude20\\ude23\\ude25\\ude26\\ude28\\ude33\\ude38\\ude3a\\ude3c-\\ude41\\ude43-\\ude46\\ude48\\ude4a\\ude4c\\ude50\\ude53\\ude55\\ude56\\ude58\\ude5a\\ude5c\\ude5e\\ude60\\ude63\\ude65\\ude66\\ude6b\\ude73\\ude78\\ude7d\\ude7f\\ude8a\\ude9c-\\udea0\\udea4\\udeaa\\udebc-\\udeef\\udef2-\\udfff]|\\ud83c[\\udc2c-\\udc2f\\udc94-\\udc9f\\udcaf\\udcb0\\udcc0\\udcd0\\udcf6-\\udcff\\udd0d-\\udd0f\\udd2f\\udd6c-\\udd6f\\uddad-\\udde5\\ude03-\\ude0f\\ude3c-\\ude3f\\ude49-\\ude4f\\ude52-\\udeff]|\\ud83d[\\uded3-\\udedf\\udeed-\\udeef\\udef7-\\udeff\\udf74-\\udf7f\\udfd5-\\udfff]|\\ud83e[\\udc0c-\\udc0f\\udc48-\\udc4f\\udc5a-\\udc5f\\udc88-\\udc8f\\udcae-\\udd0f\\udd1f\\udd28-\\udd2f\\udd31\\udd32\\udd3f\\udd4c-\\udd4f\\udd5f-\\udd7f\\udd92-\\uddbf\\uddc1-\\udfff]|\\ud869[\\uded7-\\udeff]|\\ud86d[\\udf35-\\udf3f]|\\ud86e[\\udc1e\\udc1f]|\\ud873[\\udea2-\\udfff]|\\ud87e[\\ude1e-\\udfff]|\\udb40[\\udc00-\\udcff\\uddf0-\\udfff]"},{name:"Cc",alias:"Control",bmp:"\\0-\\x1f\\x7f-\\x9f"},{name:"Cf",alias:"Format",bmp:"\\xad\\u0600-\\u0605\\u061c\\u06dd\\u070f\\u08e2\\u180e\\u200b-\\u200f\\u202a-\\u202e\\u2060-\\u2064\\u2066-\\u206f\\ufeff\\ufff9-\\ufffb",astral:"\\ud804\\udcbd|\\ud82f[\\udca0-\\udca3]|\\ud834[\\udd73-\\udd7a]|\\udb40[\\udc01\\udc20-\\udc7f]"},{name:"Cn",alias:"Unassigned",bmp:"\\u0378\\u0379\\u0380-\\u0383\\u038b\\u038d\\u03a2\\u0530\\u0557\\u0558\\u0560\\u0588\\u058b\\u058c\\u0590\\u05c8-\\u05cf\\u05eb-\\u05ef\\u05f5-\\u05ff\\u061d\\u070e\\u074b\\u074c\\u07b2-\\u07bf\\u07fb-\\u07ff\\u082e\\u082f\\u083f\\u085c\\u085d\\u085f-\\u089f\\u08b5\\u08be-\\u08d3\\u0984\\u098d\\u098e\\u0991\\u0992\\u09a9\\u09b1\\u09b3-\\u09b5\\u09ba\\u09bb\\u09c5\\u09c6\\u09c9\\u09ca\\u09cf-\\u09d6\\u09d8-\\u09db\\u09de\\u09e4\\u09e5\\u09fc-\\u0a00\\u0a04\\u0a0b-\\u0a0e\\u0a11\\u0a12\\u0a29\\u0a31\\u0a34\\u0a37\\u0a3a\\u0a3b\\u0a3d\\u0a43-\\u0a46\\u0a49\\u0a4a\\u0a4e-\\u0a50\\u0a52-\\u0a58\\u0a5d\\u0a5f-\\u0a65\\u0a76-\\u0a80\\u0a84\\u0a8e\\u0a92\\u0aa9\\u0ab1\\u0ab4\\u0aba\\u0abb\\u0ac6\\u0aca\\u0ace\\u0acf\\u0ad1-\\u0adf\\u0ae4\\u0ae5\\u0af2-\\u0af8\\u0afa-\\u0b00\\u0b04\\u0b0d\\u0b0e\\u0b11\\u0b12\\u0b29\\u0b31\\u0b34\\u0b3a\\u0b3b\\u0b45\\u0b46\\u0b49\\u0b4a\\u0b4e-\\u0b55\\u0b58-\\u0b5b\\u0b5e\\u0b64\\u0b65\\u0b78-\\u0b81\\u0b84\\u0b8b-\\u0b8d\\u0b91\\u0b96-\\u0b98\\u0b9b\\u0b9d\\u0ba0-\\u0ba2\\u0ba5-\\u0ba7\\u0bab-\\u0bad\\u0bba-\\u0bbd\\u0bc3-\\u0bc5\\u0bc9\\u0bce\\u0bcf\\u0bd1-\\u0bd6\\u0bd8-\\u0be5\\u0bfb-\\u0bff\\u0c04\\u0c0d\\u0c11\\u0c29\\u0c3a-\\u0c3c\\u0c45\\u0c49\\u0c4e-\\u0c54\\u0c57\\u0c5b-\\u0c5f\\u0c64\\u0c65\\u0c70-\\u0c77\\u0c84\\u0c8d\\u0c91\\u0ca9\\u0cb4\\u0cba\\u0cbb\\u0cc5\\u0cc9\\u0cce-\\u0cd4\\u0cd7-\\u0cdd\\u0cdf\\u0ce4\\u0ce5\\u0cf0\\u0cf3-\\u0d00\\u0d04\\u0d0d\\u0d11\\u0d3b\\u0d3c\\u0d45\\u0d49\\u0d50-\\u0d53\\u0d64\\u0d65\\u0d80\\u0d81\\u0d84\\u0d97-\\u0d99\\u0db2\\u0dbc\\u0dbe\\u0dbf\\u0dc7-\\u0dc9\\u0dcb-\\u0dce\\u0dd5\\u0dd7\\u0de0-\\u0de5\\u0df0\\u0df1\\u0df5-\\u0e00\\u0e3b-\\u0e3e\\u0e5c-\\u0e80\\u0e83\\u0e85\\u0e86\\u0e89\\u0e8b\\u0e8c\\u0e8e-\\u0e93\\u0e98\\u0ea0\\u0ea4\\u0ea6\\u0ea8\\u0ea9\\u0eac\\u0eba\\u0ebe\\u0ebf\\u0ec5\\u0ec7\\u0ece\\u0ecf\\u0eda\\u0edb\\u0ee0-\\u0eff\\u0f48\\u0f6d-\\u0f70\\u0f98\\u0fbd\\u0fcd\\u0fdb-\\u0fff\\u10c6\\u10c8-\\u10cc\\u10ce\\u10cf\\u1249\\u124e\\u124f\\u1257\\u1259\\u125e\\u125f\\u1289\\u128e\\u128f\\u12b1\\u12b6\\u12b7\\u12bf\\u12c1\\u12c6\\u12c7\\u12d7\\u1311\\u1316\\u1317\\u135b\\u135c\\u137d-\\u137f\\u139a-\\u139f\\u13f6\\u13f7\\u13fe\\u13ff\\u169d-\\u169f\\u16f9-\\u16ff\\u170d\\u1715-\\u171f\\u1737-\\u173f\\u1754-\\u175f\\u176d\\u1771\\u1774-\\u177f\\u17de\\u17df\\u17ea-\\u17ef\\u17fa-\\u17ff\\u180f\\u181a-\\u181f\\u1878-\\u187f\\u18ab-\\u18af\\u18f6-\\u18ff\\u191f\\u192c-\\u192f\\u193c-\\u193f\\u1941-\\u1943\\u196e\\u196f\\u1975-\\u197f\\u19ac-\\u19af\\u19ca-\\u19cf\\u19db-\\u19dd\\u1a1c\\u1a1d\\u1a5f\\u1a7d\\u1a7e\\u1a8a-\\u1a8f\\u1a9a-\\u1a9f\\u1aae\\u1aaf\\u1abf-\\u1aff\\u1b4c-\\u1b4f\\u1b7d-\\u1b7f\\u1bf4-\\u1bfb\\u1c38-\\u1c3a\\u1c4a-\\u1c4c\\u1c89-\\u1cbf\\u1cc8-\\u1ccf\\u1cf7\\u1cfa-\\u1cff\\u1df6-\\u1dfa\\u1f16\\u1f17\\u1f1e\\u1f1f\\u1f46\\u1f47\\u1f4e\\u1f4f\\u1f58\\u1f5a\\u1f5c\\u1f5e\\u1f7e\\u1f7f\\u1fb5\\u1fc5\\u1fd4\\u1fd5\\u1fdc\\u1ff0\\u1ff1\\u1ff5\\u1fff\\u2065\\u2072\\u2073\\u208f\\u209d-\\u209f\\u20bf-\\u20cf\\u20f1-\\u20ff\\u218c-\\u218f\\u23ff\\u2427-\\u243f\\u244b-\\u245f\\u2b74\\u2b75\\u2b96\\u2b97\\u2bba-\\u2bbc\\u2bc9\\u2bd2-\\u2beb\\u2bf0-\\u2bff\\u2c2f\\u2c5f\\u2cf4-\\u2cf8\\u2d26\\u2d28-\\u2d2c\\u2d2e\\u2d2f\\u2d68-\\u2d6e\\u2d71-\\u2d7e\\u2d97-\\u2d9f\\u2da7\\u2daf\\u2db7\\u2dbf\\u2dc7\\u2dcf\\u2dd7\\u2ddf\\u2e45-\\u2e7f\\u2e9a\\u2ef4-\\u2eff\\u2fd6-\\u2fef\\u2ffc-\\u2fff\\u3040\\u3097\\u3098\\u3100-\\u3104\\u312e-\\u3130\\u318f\\u31bb-\\u31bf\\u31e4-\\u31ef\\u321f\\u32ff\\u4db6-\\u4dbf\\u9fd6-\\u9fff\\ua48d-\\ua48f\\ua4c7-\\ua4cf\\ua62c-\\ua63f\\ua6f8-\\ua6ff\\ua7af\\ua7b8-\\ua7f6\\ua82c-\\ua82f\\ua83a-\\ua83f\\ua878-\\ua87f\\ua8c6-\\ua8cd\\ua8da-\\ua8df\\ua8fe\\ua8ff\\ua954-\\ua95e\\ua97d-\\ua97f\\ua9ce\\ua9da-\\ua9dd\\ua9ff\\uaa37-\\uaa3f\\uaa4e\\uaa4f\\uaa5a\\uaa5b\\uaac3-\\uaada\\uaaf7-\\uab00\\uab07\\uab08\\uab0f\\uab10\\uab17-\\uab1f\\uab27\\uab2f\\uab66-\\uab6f\\uabee\\uabef\\uabfa-\\uabff\\ud7a4-\\ud7af\\ud7c7-\\ud7ca\\ud7fc-\\ud7ff\\ufa6e\\ufa6f\\ufada-\\ufaff\\ufb07-\\ufb12\\ufb18-\\ufb1c\\ufb37\\ufb3d\\ufb3f\\ufb42\\ufb45\\ufbc2-\\ufbd2\\ufd40-\\ufd4f\\ufd90\\ufd91\\ufdc8-\\ufdef\\ufdfe\\ufdff\\ufe1a-\\ufe1f\\ufe53\\ufe67\\ufe6c-\\ufe6f\\ufe75\\ufefd\\ufefe\\uff00\\uffbf-\\uffc1\\uffc8\\uffc9\\uffd0\\uffd1\\uffd8\\uffd9\\uffdd-\\uffdf\\uffe7\\uffef-\\ufff8\\ufffe\\uffff",astral:"\\ud800[\\udc0c\\udc27\\udc3b\\udc3e\\udc4e\\udc4f\\udc5e-\\udc7f\\udcfb-\\udcff\\udd03-\\udd06\\udd34-\\udd36\\udd8f\\udd9c-\\udd9f\\udda1-\\uddcf\\uddfe-\\ude7f\\ude9d-\\ude9f\\uded1-\\udedf\\udefc-\\udeff\\udf24-\\udf2f\\udf4b-\\udf4f\\udf7b-\\udf7f\\udf9e\\udfc4-\\udfc7\\udfd6-\\udfff]|\\ud801[\\udc9e\\udc9f\\udcaa-\\udcaf\\udcd4-\\udcd7\\udcfc-\\udcff\\udd28-\\udd2f\\udd64-\\udd6e\\udd70-\\uddff\\udf37-\\udf3f\\udf56-\\udf5f\\udf68-\\udfff]|\\ud802[\\udc06\\udc07\\udc09\\udc36\\udc39-\\udc3b\\udc3d\\udc3e\\udc56\\udc9f-\\udca6\\udcb0-\\udcdf\\udcf3\\udcf6-\\udcfa\\udd1c-\\udd1e\\udd3a-\\udd3e\\udd40-\\udd7f\\uddb8-\\uddbb\\uddd0\\uddd1\\ude04\\ude07-\\ude0b\\ude14\\ude18\\ude34-\\ude37\\ude3b-\\ude3e\\ude48-\\ude4f\\ude59-\\ude5f\\udea0-\\udebf\\udee7-\\udeea\\udef7-\\udeff\\udf36-\\udf38\\udf56\\udf57\\udf73-\\udf77\\udf92-\\udf98\\udf9d-\\udfa8\\udfb0-\\udfff]|\\ud803[\\udc49-\\udc7f\\udcb3-\\udcbf\\udcf3-\\udcf9\\udd00-\\ude5f\\ude7f-\\udfff]|\\ud804[\\udc4e-\\udc51\\udc70-\\udc7e\\udcc2-\\udccf\\udce9-\\udcef\\udcfa-\\udcff\\udd35\\udd44-\\udd4f\\udd77-\\udd7f\\uddce\\uddcf\\udde0\\uddf5-\\uddff\\ude12\\ude3f-\\ude7f\\ude87\\ude89\\ude8e\\ude9e\\udeaa-\\udeaf\\udeeb-\\udeef\\udefa-\\udeff\\udf04\\udf0d\\udf0e\\udf11\\udf12\\udf29\\udf31\\udf34\\udf3a\\udf3b\\udf45\\udf46\\udf49\\udf4a\\udf4e\\udf4f\\udf51-\\udf56\\udf58-\\udf5c\\udf64\\udf65\\udf6d-\\udf6f\\udf75-\\udfff]|\\ud805[\\udc5a\\udc5c\\udc5e-\\udc7f\\udcc8-\\udccf\\udcda-\\udd7f\\uddb6\\uddb7\\uddde-\\uddff\\ude45-\\ude4f\\ude5a-\\ude5f\\ude6d-\\ude7f\\udeb8-\\udebf\\udeca-\\udeff\\udf1a-\\udf1c\\udf2c-\\udf2f\\udf40-\\udfff]|\\ud806[\\udc00-\\udc9f\\udcf3-\\udcfe\\udd00-\\udebf\\udef9-\\udfff]|\\ud807[\\udc09\\udc37\\udc46-\\udc4f\\udc6d-\\udc6f\\udc90\\udc91\\udca8\\udcb7-\\udfff]|\\ud808[\\udf9a-\\udfff]|\\ud809[\\udc6f\\udc75-\\udc7f\\udd44-\\udfff]|[\\ud80a\\ud80b\\ud80e-\\ud810\\ud812-\\ud819\\ud823-\\ud82b\\ud82d\\ud82e\\ud830-\\ud833\\ud837\\ud839\\ud83f\\ud874-\\ud87d\\ud87f-\\udb3f\\udb41-\\udb7f][\\udc00-\\udfff]|\\ud80d[\\udc2f-\\udfff]|\\ud811[\\ude47-\\udfff]|\\ud81a[\\ude39-\\ude3f\\ude5f\\ude6a-\\ude6d\\ude70-\\udecf\\udeee\\udeef\\udef6-\\udeff\\udf46-\\udf4f\\udf5a\\udf62\\udf78-\\udf7c\\udf90-\\udfff]|\\ud81b[\\udc00-\\udeff\\udf45-\\udf4f\\udf7f-\\udf8e\\udfa0-\\udfdf\\udfe1-\\udfff]|\\ud821[\\udfed-\\udfff]|\\ud822[\\udef3-\\udfff]|\\ud82c[\\udc02-\\udfff]|\\ud82f[\\udc6b-\\udc6f\\udc7d-\\udc7f\\udc89-\\udc8f\\udc9a\\udc9b\\udca4-\\udfff]|\\ud834[\\udcf6-\\udcff\\udd27\\udd28\\udde9-\\uddff\\ude46-\\udeff\\udf57-\\udf5f\\udf72-\\udfff]|\\ud835[\\udc55\\udc9d\\udca0\\udca1\\udca3\\udca4\\udca7\\udca8\\udcad\\udcba\\udcbc\\udcc4\\udd06\\udd0b\\udd0c\\udd15\\udd1d\\udd3a\\udd3f\\udd45\\udd47-\\udd49\\udd51\\udea6\\udea7\\udfcc\\udfcd]|\\ud836[\\ude8c-\\ude9a\\udea0\\udeb0-\\udfff]|\\ud838[\\udc07\\udc19\\udc1a\\udc22\\udc25\\udc2b-\\udfff]|\\ud83a[\\udcc5\\udcc6\\udcd7-\\udcff\\udd4b-\\udd4f\\udd5a-\\udd5d\\udd60-\\udfff]|\\ud83b[\\udc00-\\uddff\\ude04\\ude20\\ude23\\ude25\\ude26\\ude28\\ude33\\ude38\\ude3a\\ude3c-\\ude41\\ude43-\\ude46\\ude48\\ude4a\\ude4c\\ude50\\ude53\\ude55\\ude56\\ude58\\ude5a\\ude5c\\ude5e\\ude60\\ude63\\ude65\\ude66\\ude6b\\ude73\\ude78\\ude7d\\ude7f\\ude8a\\ude9c-\\udea0\\udea4\\udeaa\\udebc-\\udeef\\udef2-\\udfff]|\\ud83c[\\udc2c-\\udc2f\\udc94-\\udc9f\\udcaf\\udcb0\\udcc0\\udcd0\\udcf6-\\udcff\\udd0d-\\udd0f\\udd2f\\udd6c-\\udd6f\\uddad-\\udde5\\ude03-\\ude0f\\ude3c-\\ude3f\\ude49-\\ude4f\\ude52-\\udeff]|\\ud83d[\\uded3-\\udedf\\udeed-\\udeef\\udef7-\\udeff\\udf74-\\udf7f\\udfd5-\\udfff]|\\ud83e[\\udc0c-\\udc0f\\udc48-\\udc4f\\udc5a-\\udc5f\\udc88-\\udc8f\\udcae-\\udd0f\\udd1f\\udd28-\\udd2f\\udd31\\udd32\\udd3f\\udd4c-\\udd4f\\udd5f-\\udd7f\\udd92-\\uddbf\\uddc1-\\udfff]|\\ud869[\\uded7-\\udeff]|\\ud86d[\\udf35-\\udf3f]|\\ud86e[\\udc1e\\udc1f]|\\ud873[\\udea2-\\udfff]|\\ud87e[\\ude1e-\\udfff]|\\udb40[\\udc00\\udc02-\\udc1f\\udc80-\\udcff\\uddf0-\\udfff]|[\\udbbf\\udbff][\\udffe\\udfff]"},{name:"Co",alias:"Private_Use",bmp:"\\ue000-\\uf8ff",astral:"[\\udb80-\\udbbe\\udbc0-\\udbfe][\\udc00-\\udfff]|[\\udbbf\\udbff][\\udc00-\\udffd]"},{name:"Cs",alias:"Surrogate",bmp:"\\ud800-\\udfff"},{name:"L",alias:"Letter",bmp:"A-Za-z\\xaa\\xb5\\xba\\xc0-\\xd6\\xd8-\\xf6\\xf8-\\u02c1\\u02c6-\\u02d1\\u02e0-\\u02e4\\u02ec\\u02ee\\u0370-\\u0374\\u0376\\u0377\\u037a-\\u037d\\u037f\\u0386\\u0388-\\u038a\\u038c\\u038e-\\u03a1\\u03a3-\\u03f5\\u03f7-\\u0481\\u048a-\\u052f\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05d0-\\u05ea\\u05f0-\\u05f2\\u0620-\\u064a\\u066e\\u066f\\u0671-\\u06d3\\u06d5\\u06e5\\u06e6\\u06ee\\u06ef\\u06fa-\\u06fc\\u06ff\\u0710\\u0712-\\u072f\\u074d-\\u07a5\\u07b1\\u07ca-\\u07ea\\u07f4\\u07f5\\u07fa\\u0800-\\u0815\\u081a\\u0824\\u0828\\u0840-\\u0858\\u08a0-\\u08b4\\u08b6-\\u08bd\\u0904-\\u0939\\u093d\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098c\\u098f\\u0990\\u0993-\\u09a8\\u09aa-\\u09b0\\u09b2\\u09b6-\\u09b9\\u09bd\\u09ce\\u09dc\\u09dd\\u09df-\\u09e1\\u09f0\\u09f1\\u0a05-\\u0a0a\\u0a0f\\u0a10\\u0a13-\\u0a28\\u0a2a-\\u0a30\\u0a32\\u0a33\\u0a35\\u0a36\\u0a38\\u0a39\\u0a59-\\u0a5c\\u0a5e\\u0a72-\\u0a74\\u0a85-\\u0a8d\\u0a8f-\\u0a91\\u0a93-\\u0aa8\\u0aaa-\\u0ab0\\u0ab2\\u0ab3\\u0ab5-\\u0ab9\\u0abd\\u0ad0\\u0ae0\\u0ae1\\u0af9\\u0b05-\\u0b0c\\u0b0f\\u0b10\\u0b13-\\u0b28\\u0b2a-\\u0b30\\u0b32\\u0b33\\u0b35-\\u0b39\\u0b3d\\u0b5c\\u0b5d\\u0b5f-\\u0b61\\u0b71\\u0b83\\u0b85-\\u0b8a\\u0b8e-\\u0b90\\u0b92-\\u0b95\\u0b99\\u0b9a\\u0b9c\\u0b9e\\u0b9f\\u0ba3\\u0ba4\\u0ba8-\\u0baa\\u0bae-\\u0bb9\\u0bd0\\u0c05-\\u0c0c\\u0c0e-\\u0c10\\u0c12-\\u0c28\\u0c2a-\\u0c39\\u0c3d\\u0c58-\\u0c5a\\u0c60\\u0c61\\u0c80\\u0c85-\\u0c8c\\u0c8e-\\u0c90\\u0c92-\\u0ca8\\u0caa-\\u0cb3\\u0cb5-\\u0cb9\\u0cbd\\u0cde\\u0ce0\\u0ce1\\u0cf1\\u0cf2\\u0d05-\\u0d0c\\u0d0e-\\u0d10\\u0d12-\\u0d3a\\u0d3d\\u0d4e\\u0d54-\\u0d56\\u0d5f-\\u0d61\\u0d7a-\\u0d7f\\u0d85-\\u0d96\\u0d9a-\\u0db1\\u0db3-\\u0dbb\\u0dbd\\u0dc0-\\u0dc6\\u0e01-\\u0e30\\u0e32\\u0e33\\u0e40-\\u0e46\\u0e81\\u0e82\\u0e84\\u0e87\\u0e88\\u0e8a\\u0e8d\\u0e94-\\u0e97\\u0e99-\\u0e9f\\u0ea1-\\u0ea3\\u0ea5\\u0ea7\\u0eaa\\u0eab\\u0ead-\\u0eb0\\u0eb2\\u0eb3\\u0ebd\\u0ec0-\\u0ec4\\u0ec6\\u0edc-\\u0edf\\u0f00\\u0f40-\\u0f47\\u0f49-\\u0f6c\\u0f88-\\u0f8c\\u1000-\\u102a\\u103f\\u1050-\\u1055\\u105a-\\u105d\\u1061\\u1065\\u1066\\u106e-\\u1070\\u1075-\\u1081\\u108e\\u10a0-\\u10c5\\u10c7\\u10cd\\u10d0-\\u10fa\\u10fc-\\u1248\\u124a-\\u124d\\u1250-\\u1256\\u1258\\u125a-\\u125d\\u1260-\\u1288\\u128a-\\u128d\\u1290-\\u12b0\\u12b2-\\u12b5\\u12b8-\\u12be\\u12c0\\u12c2-\\u12c5\\u12c8-\\u12d6\\u12d8-\\u1310\\u1312-\\u1315\\u1318-\\u135a\\u1380-\\u138f\\u13a0-\\u13f5\\u13f8-\\u13fd\\u1401-\\u166c\\u166f-\\u167f\\u1681-\\u169a\\u16a0-\\u16ea\\u16f1-\\u16f8\\u1700-\\u170c\\u170e-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176c\\u176e-\\u1770\\u1780-\\u17b3\\u17d7\\u17dc\\u1820-\\u1877\\u1880-\\u1884\\u1887-\\u18a8\\u18aa\\u18b0-\\u18f5\\u1900-\\u191e\\u1950-\\u196d\\u1970-\\u1974\\u1980-\\u19ab\\u19b0-\\u19c9\\u1a00-\\u1a16\\u1a20-\\u1a54\\u1aa7\\u1b05-\\u1b33\\u1b45-\\u1b4b\\u1b83-\\u1ba0\\u1bae\\u1baf\\u1bba-\\u1be5\\u1c00-\\u1c23\\u1c4d-\\u1c4f\\u1c5a-\\u1c7d\\u1c80-\\u1c88\\u1ce9-\\u1cec\\u1cee-\\u1cf1\\u1cf5\\u1cf6\\u1d00-\\u1dbf\\u1e00-\\u1f15\\u1f18-\\u1f1d\\u1f20-\\u1f45\\u1f48-\\u1f4d\\u1f50-\\u1f57\\u1f59\\u1f5b\\u1f5d\\u1f5f-\\u1f7d\\u1f80-\\u1fb4\\u1fb6-\\u1fbc\\u1fbe\\u1fc2-\\u1fc4\\u1fc6-\\u1fcc\\u1fd0-\\u1fd3\\u1fd6-\\u1fdb\\u1fe0-\\u1fec\\u1ff2-\\u1ff4\\u1ff6-\\u1ffc\\u2071\\u207f\\u2090-\\u209c\\u2102\\u2107\\u210a-\\u2113\\u2115\\u2119-\\u211d\\u2124\\u2126\\u2128\\u212a-\\u212d\\u212f-\\u2139\\u213c-\\u213f\\u2145-\\u2149\\u214e\\u2183\\u2184\\u2c00-\\u2c2e\\u2c30-\\u2c5e\\u2c60-\\u2ce4\\u2ceb-\\u2cee\\u2cf2\\u2cf3\\u2d00-\\u2d25\\u2d27\\u2d2d\\u2d30-\\u2d67\\u2d6f\\u2d80-\\u2d96\\u2da0-\\u2da6\\u2da8-\\u2dae\\u2db0-\\u2db6\\u2db8-\\u2dbe\\u2dc0-\\u2dc6\\u2dc8-\\u2dce\\u2dd0-\\u2dd6\\u2dd8-\\u2dde\\u2e2f\\u3005\\u3006\\u3031-\\u3035\\u303b\\u303c\\u3041-\\u3096\\u309d-\\u309f\\u30a1-\\u30fa\\u30fc-\\u30ff\\u3105-\\u312d\\u3131-\\u318e\\u31a0-\\u31ba\\u31f0-\\u31ff\\u3400-\\u4db5\\u4e00-\\u9fd5\\ua000-\\ua48c\\ua4d0-\\ua4fd\\ua500-\\ua60c\\ua610-\\ua61f\\ua62a\\ua62b\\ua640-\\ua66e\\ua67f-\\ua69d\\ua6a0-\\ua6e5\\ua717-\\ua71f\\ua722-\\ua788\\ua78b-\\ua7ae\\ua7b0-\\ua7b7\\ua7f7-\\ua801\\ua803-\\ua805\\ua807-\\ua80a\\ua80c-\\ua822\\ua840-\\ua873\\ua882-\\ua8b3\\ua8f2-\\ua8f7\\ua8fb\\ua8fd\\ua90a-\\ua925\\ua930-\\ua946\\ua960-\\ua97c\\ua984-\\ua9b2\\ua9cf\\ua9e0-\\ua9e4\\ua9e6-\\ua9ef\\ua9fa-\\ua9fe\\uaa00-\\uaa28\\uaa40-\\uaa42\\uaa44-\\uaa4b\\uaa60-\\uaa76\\uaa7a\\uaa7e-\\uaaaf\\uaab1\\uaab5\\uaab6\\uaab9-\\uaabd\\uaac0\\uaac2\\uaadb-\\uaadd\\uaae0-\\uaaea\\uaaf2-\\uaaf4\\uab01-\\uab06\\uab09-\\uab0e\\uab11-\\uab16\\uab20-\\uab26\\uab28-\\uab2e\\uab30-\\uab5a\\uab5c-\\uab65\\uab70-\\uabe2\\uac00-\\ud7a3\\ud7b0-\\ud7c6\\ud7cb-\\ud7fb\\uf900-\\ufa6d\\ufa70-\\ufad9\\ufb00-\\ufb06\\ufb13-\\ufb17\\ufb1d\\ufb1f-\\ufb28\\ufb2a-\\ufb36\\ufb38-\\ufb3c\\ufb3e\\ufb40\\ufb41\\ufb43\\ufb44\\ufb46-\\ufbb1\\ufbd3-\\ufd3d\\ufd50-\\ufd8f\\ufd92-\\ufdc7\\ufdf0-\\ufdfb\\ufe70-\\ufe74\\ufe76-\\ufefc\\uff21-\\uff3a\\uff41-\\uff5a\\uff66-\\uffbe\\uffc2-\\uffc7\\uffca-\\uffcf\\uffd2-\\uffd7\\uffda-\\uffdc",astral:"\\ud800[\\udc00-\\udc0b\\udc0d-\\udc26\\udc28-\\udc3a\\udc3c\\udc3d\\udc3f-\\udc4d\\udc50-\\udc5d\\udc80-\\udcfa\\ude80-\\ude9c\\udea0-\\uded0\\udf00-\\udf1f\\udf30-\\udf40\\udf42-\\udf49\\udf50-\\udf75\\udf80-\\udf9d\\udfa0-\\udfc3\\udfc8-\\udfcf]|\\ud801[\\udc00-\\udc9d\\udcb0-\\udcd3\\udcd8-\\udcfb\\udd00-\\udd27\\udd30-\\udd63\\ude00-\\udf36\\udf40-\\udf55\\udf60-\\udf67]|\\ud802[\\udc00-\\udc05\\udc08\\udc0a-\\udc35\\udc37\\udc38\\udc3c\\udc3f-\\udc55\\udc60-\\udc76\\udc80-\\udc9e\\udce0-\\udcf2\\udcf4\\udcf5\\udd00-\\udd15\\udd20-\\udd39\\udd80-\\uddb7\\uddbe\\uddbf\\ude00\\ude10-\\ude13\\ude15-\\ude17\\ude19-\\ude33\\ude60-\\ude7c\\ude80-\\ude9c\\udec0-\\udec7\\udec9-\\udee4\\udf00-\\udf35\\udf40-\\udf55\\udf60-\\udf72\\udf80-\\udf91]|\\ud803[\\udc00-\\udc48\\udc80-\\udcb2\\udcc0-\\udcf2]|\\ud804[\\udc03-\\udc37\\udc83-\\udcaf\\udcd0-\\udce8\\udd03-\\udd26\\udd50-\\udd72\\udd76\\udd83-\\uddb2\\uddc1-\\uddc4\\uddda\\udddc\\ude00-\\ude11\\ude13-\\ude2b\\ude80-\\ude86\\ude88\\ude8a-\\ude8d\\ude8f-\\ude9d\\ude9f-\\udea8\\udeb0-\\udede\\udf05-\\udf0c\\udf0f\\udf10\\udf13-\\udf28\\udf2a-\\udf30\\udf32\\udf33\\udf35-\\udf39\\udf3d\\udf50\\udf5d-\\udf61]|\\ud805[\\udc00-\\udc34\\udc47-\\udc4a\\udc80-\\udcaf\\udcc4\\udcc5\\udcc7\\udd80-\\uddae\\uddd8-\\udddb\\ude00-\\ude2f\\ude44\\ude80-\\udeaa\\udf00-\\udf19]|\\ud806[\\udca0-\\udcdf\\udcff\\udec0-\\udef8]|\\ud807[\\udc00-\\udc08\\udc0a-\\udc2e\\udc40\\udc72-\\udc8f]|\\ud808[\\udc00-\\udf99]|\\ud809[\\udc80-\\udd43]|[\\ud80c\\ud81c-\\ud820\\ud840-\\ud868\\ud86a-\\ud86c\\ud86f-\\ud872][\\udc00-\\udfff]|\\ud80d[\\udc00-\\udc2e]|\\ud811[\\udc00-\\ude46]|\\ud81a[\\udc00-\\ude38\\ude40-\\ude5e\\uded0-\\udeed\\udf00-\\udf2f\\udf40-\\udf43\\udf63-\\udf77\\udf7d-\\udf8f]|\\ud81b[\\udf00-\\udf44\\udf50\\udf93-\\udf9f\\udfe0]|\\ud821[\\udc00-\\udfec]|\\ud822[\\udc00-\\udef2]|\\ud82c[\\udc00\\udc01]|\\ud82f[\\udc00-\\udc6a\\udc70-\\udc7c\\udc80-\\udc88\\udc90-\\udc99]|\\ud835[\\udc00-\\udc54\\udc56-\\udc9c\\udc9e\\udc9f\\udca2\\udca5\\udca6\\udca9-\\udcac\\udcae-\\udcb9\\udcbb\\udcbd-\\udcc3\\udcc5-\\udd05\\udd07-\\udd0a\\udd0d-\\udd14\\udd16-\\udd1c\\udd1e-\\udd39\\udd3b-\\udd3e\\udd40-\\udd44\\udd46\\udd4a-\\udd50\\udd52-\\udea5\\udea8-\\udec0\\udec2-\\udeda\\udedc-\\udefa\\udefc-\\udf14\\udf16-\\udf34\\udf36-\\udf4e\\udf50-\\udf6e\\udf70-\\udf88\\udf8a-\\udfa8\\udfaa-\\udfc2\\udfc4-\\udfcb]|\\ud83a[\\udc00-\\udcc4\\udd00-\\udd43]|\\ud83b[\\ude00-\\ude03\\ude05-\\ude1f\\ude21\\ude22\\ude24\\ude27\\ude29-\\ude32\\ude34-\\ude37\\ude39\\ude3b\\ude42\\ude47\\ude49\\ude4b\\ude4d-\\ude4f\\ude51\\ude52\\ude54\\ude57\\ude59\\ude5b\\ude5d\\ude5f\\ude61\\ude62\\ude64\\ude67-\\ude6a\\ude6c-\\ude72\\ude74-\\ude77\\ude79-\\ude7c\\ude7e\\ude80-\\ude89\\ude8b-\\ude9b\\udea1-\\udea3\\udea5-\\udea9\\udeab-\\udebb]|\\ud869[\\udc00-\\uded6\\udf00-\\udfff]|\\ud86d[\\udc00-\\udf34\\udf40-\\udfff]|\\ud86e[\\udc00-\\udc1d\\udc20-\\udfff]|\\ud873[\\udc00-\\udea1]|\\ud87e[\\udc00-\\ude1d]"},{name:"Ll",alias:"Lowercase_Letter",bmp:"a-z\\xb5\\xdf-\\xf6\\xf8-\\xff\\u0101\\u0103\\u0105\\u0107\\u0109\\u010b\\u010d\\u010f\\u0111\\u0113\\u0115\\u0117\\u0119\\u011b\\u011d\\u011f\\u0121\\u0123\\u0125\\u0127\\u0129\\u012b\\u012d\\u012f\\u0131\\u0133\\u0135\\u0137\\u0138\\u013a\\u013c\\u013e\\u0140\\u0142\\u0144\\u0146\\u0148\\u0149\\u014b\\u014d\\u014f\\u0151\\u0153\\u0155\\u0157\\u0159\\u015b\\u015d\\u015f\\u0161\\u0163\\u0165\\u0167\\u0169\\u016b\\u016d\\u016f\\u0171\\u0173\\u0175\\u0177\\u017a\\u017c\\u017e-\\u0180\\u0183\\u0185\\u0188\\u018c\\u018d\\u0192\\u0195\\u0199-\\u019b\\u019e\\u01a1\\u01a3\\u01a5\\u01a8\\u01aa\\u01ab\\u01ad\\u01b0\\u01b4\\u01b6\\u01b9\\u01ba\\u01bd-\\u01bf\\u01c6\\u01c9\\u01cc\\u01ce\\u01d0\\u01d2\\u01d4\\u01d6\\u01d8\\u01da\\u01dc\\u01dd\\u01df\\u01e1\\u01e3\\u01e5\\u01e7\\u01e9\\u01eb\\u01ed\\u01ef\\u01f0\\u01f3\\u01f5\\u01f9\\u01fb\\u01fd\\u01ff\\u0201\\u0203\\u0205\\u0207\\u0209\\u020b\\u020d\\u020f\\u0211\\u0213\\u0215\\u0217\\u0219\\u021b\\u021d\\u021f\\u0221\\u0223\\u0225\\u0227\\u0229\\u022b\\u022d\\u022f\\u0231\\u0233-\\u0239\\u023c\\u023f\\u0240\\u0242\\u0247\\u0249\\u024b\\u024d\\u024f-\\u0293\\u0295-\\u02af\\u0371\\u0373\\u0377\\u037b-\\u037d\\u0390\\u03ac-\\u03ce\\u03d0\\u03d1\\u03d5-\\u03d7\\u03d9\\u03db\\u03dd\\u03df\\u03e1\\u03e3\\u03e5\\u03e7\\u03e9\\u03eb\\u03ed\\u03ef-\\u03f3\\u03f5\\u03f8\\u03fb\\u03fc\\u0430-\\u045f\\u0461\\u0463\\u0465\\u0467\\u0469\\u046b\\u046d\\u046f\\u0471\\u0473\\u0475\\u0477\\u0479\\u047b\\u047d\\u047f\\u0481\\u048b\\u048d\\u048f\\u0491\\u0493\\u0495\\u0497\\u0499\\u049b\\u049d\\u049f\\u04a1\\u04a3\\u04a5\\u04a7\\u04a9\\u04ab\\u04ad\\u04af\\u04b1\\u04b3\\u04b5\\u04b7\\u04b9\\u04bb\\u04bd\\u04bf\\u04c2\\u04c4\\u04c6\\u04c8\\u04ca\\u04cc\\u04ce\\u04cf\\u04d1\\u04d3\\u04d5\\u04d7\\u04d9\\u04db\\u04dd\\u04df\\u04e1\\u04e3\\u04e5\\u04e7\\u04e9\\u04eb\\u04ed\\u04ef\\u04f1\\u04f3\\u04f5\\u04f7\\u04f9\\u04fb\\u04fd\\u04ff\\u0501\\u0503\\u0505\\u0507\\u0509\\u050b\\u050d\\u050f\\u0511\\u0513\\u0515\\u0517\\u0519\\u051b\\u051d\\u051f\\u0521\\u0523\\u0525\\u0527\\u0529\\u052b\\u052d\\u052f\\u0561-\\u0587\\u13f8-\\u13fd\\u1c80-\\u1c88\\u1d00-\\u1d2b\\u1d6b-\\u1d77\\u1d79-\\u1d9a\\u1e01\\u1e03\\u1e05\\u1e07\\u1e09\\u1e0b\\u1e0d\\u1e0f\\u1e11\\u1e13\\u1e15\\u1e17\\u1e19\\u1e1b\\u1e1d\\u1e1f\\u1e21\\u1e23\\u1e25\\u1e27\\u1e29\\u1e2b\\u1e2d\\u1e2f\\u1e31\\u1e33\\u1e35\\u1e37\\u1e39\\u1e3b\\u1e3d\\u1e3f\\u1e41\\u1e43\\u1e45\\u1e47\\u1e49\\u1e4b\\u1e4d\\u1e4f\\u1e51\\u1e53\\u1e55\\u1e57\\u1e59\\u1e5b\\u1e5d\\u1e5f\\u1e61\\u1e63\\u1e65\\u1e67\\u1e69\\u1e6b\\u1e6d\\u1e6f\\u1e71\\u1e73\\u1e75\\u1e77\\u1e79\\u1e7b\\u1e7d\\u1e7f\\u1e81\\u1e83\\u1e85\\u1e87\\u1e89\\u1e8b\\u1e8d\\u1e8f\\u1e91\\u1e93\\u1e95-\\u1e9d\\u1e9f\\u1ea1\\u1ea3\\u1ea5\\u1ea7\\u1ea9\\u1eab\\u1ead\\u1eaf\\u1eb1\\u1eb3\\u1eb5\\u1eb7\\u1eb9\\u1ebb\\u1ebd\\u1ebf\\u1ec1\\u1ec3\\u1ec5\\u1ec7\\u1ec9\\u1ecb\\u1ecd\\u1ecf\\u1ed1\\u1ed3\\u1ed5\\u1ed7\\u1ed9\\u1edb\\u1edd\\u1edf\\u1ee1\\u1ee3\\u1ee5\\u1ee7\\u1ee9\\u1eeb\\u1eed\\u1eef\\u1ef1\\u1ef3\\u1ef5\\u1ef7\\u1ef9\\u1efb\\u1efd\\u1eff-\\u1f07\\u1f10-\\u1f15\\u1f20-\\u1f27\\u1f30-\\u1f37\\u1f40-\\u1f45\\u1f50-\\u1f57\\u1f60-\\u1f67\\u1f70-\\u1f7d\\u1f80-\\u1f87\\u1f90-\\u1f97\\u1fa0-\\u1fa7\\u1fb0-\\u1fb4\\u1fb6\\u1fb7\\u1fbe\\u1fc2-\\u1fc4\\u1fc6\\u1fc7\\u1fd0-\\u1fd3\\u1fd6\\u1fd7\\u1fe0-\\u1fe7\\u1ff2-\\u1ff4\\u1ff6\\u1ff7\\u210a\\u210e\\u210f\\u2113\\u212f\\u2134\\u2139\\u213c\\u213d\\u2146-\\u2149\\u214e\\u2184\\u2c30-\\u2c5e\\u2c61\\u2c65\\u2c66\\u2c68\\u2c6a\\u2c6c\\u2c71\\u2c73\\u2c74\\u2c76-\\u2c7b\\u2c81\\u2c83\\u2c85\\u2c87\\u2c89\\u2c8b\\u2c8d\\u2c8f\\u2c91\\u2c93\\u2c95\\u2c97\\u2c99\\u2c9b\\u2c9d\\u2c9f\\u2ca1\\u2ca3\\u2ca5\\u2ca7\\u2ca9\\u2cab\\u2cad\\u2caf\\u2cb1\\u2cb3\\u2cb5\\u2cb7\\u2cb9\\u2cbb\\u2cbd\\u2cbf\\u2cc1\\u2cc3\\u2cc5\\u2cc7\\u2cc9\\u2ccb\\u2ccd\\u2ccf\\u2cd1\\u2cd3\\u2cd5\\u2cd7\\u2cd9\\u2cdb\\u2cdd\\u2cdf\\u2ce1\\u2ce3\\u2ce4\\u2cec\\u2cee\\u2cf3\\u2d00-\\u2d25\\u2d27\\u2d2d\\ua641\\ua643\\ua645\\ua647\\ua649\\ua64b\\ua64d\\ua64f\\ua651\\ua653\\ua655\\ua657\\ua659\\ua65b\\ua65d\\ua65f\\ua661\\ua663\\ua665\\ua667\\ua669\\ua66b\\ua66d\\ua681\\ua683\\ua685\\ua687\\ua689\\ua68b\\ua68d\\ua68f\\ua691\\ua693\\ua695\\ua697\\ua699\\ua69b\\ua723\\ua725\\ua727\\ua729\\ua72b\\ua72d\\ua72f-\\ua731\\ua733\\ua735\\ua737\\ua739\\ua73b\\ua73d\\ua73f\\ua741\\ua743\\ua745\\ua747\\ua749\\ua74b\\ua74d\\ua74f\\ua751\\ua753\\ua755\\ua757\\ua759\\ua75b\\ua75d\\ua75f\\ua761\\ua763\\ua765\\ua767\\ua769\\ua76b\\ua76d\\ua76f\\ua771-\\ua778\\ua77a\\ua77c\\ua77f\\ua781\\ua783\\ua785\\ua787\\ua78c\\ua78e\\ua791\\ua793-\\ua795\\ua797\\ua799\\ua79b\\ua79d\\ua79f\\ua7a1\\ua7a3\\ua7a5\\ua7a7\\ua7a9\\ua7b5\\ua7b7\\ua7fa\\uab30-\\uab5a\\uab60-\\uab65\\uab70-\\uabbf\\ufb00-\\ufb06\\ufb13-\\ufb17\\uff41-\\uff5a",astral:"\\ud801[\\udc28-\\udc4f\\udcd8-\\udcfb]|\\ud803[\\udcc0-\\udcf2]|\\ud806[\\udcc0-\\udcdf]|\\ud835[\\udc1a-\\udc33\\udc4e-\\udc54\\udc56-\\udc67\\udc82-\\udc9b\\udcb6-\\udcb9\\udcbb\\udcbd-\\udcc3\\udcc5-\\udccf\\udcea-\\udd03\\udd1e-\\udd37\\udd52-\\udd6b\\udd86-\\udd9f\\uddba-\\uddd3\\uddee-\\ude07\\ude22-\\ude3b\\ude56-\\ude6f\\ude8a-\\udea5\\udec2-\\udeda\\udedc-\\udee1\\udefc-\\udf14\\udf16-\\udf1b\\udf36-\\udf4e\\udf50-\\udf55\\udf70-\\udf88\\udf8a-\\udf8f\\udfaa-\\udfc2\\udfc4-\\udfc9\\udfcb]|\\ud83a[\\udd22-\\udd43]"},{name:"Lm",alias:"Modifier_Letter",bmp:"\\u02b0-\\u02c1\\u02c6-\\u02d1\\u02e0-\\u02e4\\u02ec\\u02ee\\u0374\\u037a\\u0559\\u0640\\u06e5\\u06e6\\u07f4\\u07f5\\u07fa\\u081a\\u0824\\u0828\\u0971\\u0e46\\u0ec6\\u10fc\\u17d7\\u1843\\u1aa7\\u1c78-\\u1c7d\\u1d2c-\\u1d6a\\u1d78\\u1d9b-\\u1dbf\\u2071\\u207f\\u2090-\\u209c\\u2c7c\\u2c7d\\u2d6f\\u2e2f\\u3005\\u3031-\\u3035\\u303b\\u309d\\u309e\\u30fc-\\u30fe\\ua015\\ua4f8-\\ua4fd\\ua60c\\ua67f\\ua69c\\ua69d\\ua717-\\ua71f\\ua770\\ua788\\ua7f8\\ua7f9\\ua9cf\\ua9e6\\uaa70\\uaadd\\uaaf3\\uaaf4\\uab5c-\\uab5f\\uff70\\uff9e\\uff9f",astral:"\\ud81a[\\udf40-\\udf43]|\\ud81b[\\udf93-\\udf9f\\udfe0]"},{name:"Lo",alias:"Other_Letter",bmp:"\\xaa\\xba\\u01bb\\u01c0-\\u01c3\\u0294\\u05d0-\\u05ea\\u05f0-\\u05f2\\u0620-\\u063f\\u0641-\\u064a\\u066e\\u066f\\u0671-\\u06d3\\u06d5\\u06ee\\u06ef\\u06fa-\\u06fc\\u06ff\\u0710\\u0712-\\u072f\\u074d-\\u07a5\\u07b1\\u07ca-\\u07ea\\u0800-\\u0815\\u0840-\\u0858\\u08a0-\\u08b4\\u08b6-\\u08bd\\u0904-\\u0939\\u093d\\u0950\\u0958-\\u0961\\u0972-\\u0980\\u0985-\\u098c\\u098f\\u0990\\u0993-\\u09a8\\u09aa-\\u09b0\\u09b2\\u09b6-\\u09b9\\u09bd\\u09ce\\u09dc\\u09dd\\u09df-\\u09e1\\u09f0\\u09f1\\u0a05-\\u0a0a\\u0a0f\\u0a10\\u0a13-\\u0a28\\u0a2a-\\u0a30\\u0a32\\u0a33\\u0a35\\u0a36\\u0a38\\u0a39\\u0a59-\\u0a5c\\u0a5e\\u0a72-\\u0a74\\u0a85-\\u0a8d\\u0a8f-\\u0a91\\u0a93-\\u0aa8\\u0aaa-\\u0ab0\\u0ab2\\u0ab3\\u0ab5-\\u0ab9\\u0abd\\u0ad0\\u0ae0\\u0ae1\\u0af9\\u0b05-\\u0b0c\\u0b0f\\u0b10\\u0b13-\\u0b28\\u0b2a-\\u0b30\\u0b32\\u0b33\\u0b35-\\u0b39\\u0b3d\\u0b5c\\u0b5d\\u0b5f-\\u0b61\\u0b71\\u0b83\\u0b85-\\u0b8a\\u0b8e-\\u0b90\\u0b92-\\u0b95\\u0b99\\u0b9a\\u0b9c\\u0b9e\\u0b9f\\u0ba3\\u0ba4\\u0ba8-\\u0baa\\u0bae-\\u0bb9\\u0bd0\\u0c05-\\u0c0c\\u0c0e-\\u0c10\\u0c12-\\u0c28\\u0c2a-\\u0c39\\u0c3d\\u0c58-\\u0c5a\\u0c60\\u0c61\\u0c80\\u0c85-\\u0c8c\\u0c8e-\\u0c90\\u0c92-\\u0ca8\\u0caa-\\u0cb3\\u0cb5-\\u0cb9\\u0cbd\\u0cde\\u0ce0\\u0ce1\\u0cf1\\u0cf2\\u0d05-\\u0d0c\\u0d0e-\\u0d10\\u0d12-\\u0d3a\\u0d3d\\u0d4e\\u0d54-\\u0d56\\u0d5f-\\u0d61\\u0d7a-\\u0d7f\\u0d85-\\u0d96\\u0d9a-\\u0db1\\u0db3-\\u0dbb\\u0dbd\\u0dc0-\\u0dc6\\u0e01-\\u0e30\\u0e32\\u0e33\\u0e40-\\u0e45\\u0e81\\u0e82\\u0e84\\u0e87\\u0e88\\u0e8a\\u0e8d\\u0e94-\\u0e97\\u0e99-\\u0e9f\\u0ea1-\\u0ea3\\u0ea5\\u0ea7\\u0eaa\\u0eab\\u0ead-\\u0eb0\\u0eb2\\u0eb3\\u0ebd\\u0ec0-\\u0ec4\\u0edc-\\u0edf\\u0f00\\u0f40-\\u0f47\\u0f49-\\u0f6c\\u0f88-\\u0f8c\\u1000-\\u102a\\u103f\\u1050-\\u1055\\u105a-\\u105d\\u1061\\u1065\\u1066\\u106e-\\u1070\\u1075-\\u1081\\u108e\\u10d0-\\u10fa\\u10fd-\\u1248\\u124a-\\u124d\\u1250-\\u1256\\u1258\\u125a-\\u125d\\u1260-\\u1288\\u128a-\\u128d\\u1290-\\u12b0\\u12b2-\\u12b5\\u12b8-\\u12be\\u12c0\\u12c2-\\u12c5\\u12c8-\\u12d6\\u12d8-\\u1310\\u1312-\\u1315\\u1318-\\u135a\\u1380-\\u138f\\u1401-\\u166c\\u166f-\\u167f\\u1681-\\u169a\\u16a0-\\u16ea\\u16f1-\\u16f8\\u1700-\\u170c\\u170e-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176c\\u176e-\\u1770\\u1780-\\u17b3\\u17dc\\u1820-\\u1842\\u1844-\\u1877\\u1880-\\u1884\\u1887-\\u18a8\\u18aa\\u18b0-\\u18f5\\u1900-\\u191e\\u1950-\\u196d\\u1970-\\u1974\\u1980-\\u19ab\\u19b0-\\u19c9\\u1a00-\\u1a16\\u1a20-\\u1a54\\u1b05-\\u1b33\\u1b45-\\u1b4b\\u1b83-\\u1ba0\\u1bae\\u1baf\\u1bba-\\u1be5\\u1c00-\\u1c23\\u1c4d-\\u1c4f\\u1c5a-\\u1c77\\u1ce9-\\u1cec\\u1cee-\\u1cf1\\u1cf5\\u1cf6\\u2135-\\u2138\\u2d30-\\u2d67\\u2d80-\\u2d96\\u2da0-\\u2da6\\u2da8-\\u2dae\\u2db0-\\u2db6\\u2db8-\\u2dbe\\u2dc0-\\u2dc6\\u2dc8-\\u2dce\\u2dd0-\\u2dd6\\u2dd8-\\u2dde\\u3006\\u303c\\u3041-\\u3096\\u309f\\u30a1-\\u30fa\\u30ff\\u3105-\\u312d\\u3131-\\u318e\\u31a0-\\u31ba\\u31f0-\\u31ff\\u3400-\\u4db5\\u4e00-\\u9fd5\\ua000-\\ua014\\ua016-\\ua48c\\ua4d0-\\ua4f7\\ua500-\\ua60b\\ua610-\\ua61f\\ua62a\\ua62b\\ua66e\\ua6a0-\\ua6e5\\ua78f\\ua7f7\\ua7fb-\\ua801\\ua803-\\ua805\\ua807-\\ua80a\\ua80c-\\ua822\\ua840-\\ua873\\ua882-\\ua8b3\\ua8f2-\\ua8f7\\ua8fb\\ua8fd\\ua90a-\\ua925\\ua930-\\ua946\\ua960-\\ua97c\\ua984-\\ua9b2\\ua9e0-\\ua9e4\\ua9e7-\\ua9ef\\ua9fa-\\ua9fe\\uaa00-\\uaa28\\uaa40-\\uaa42\\uaa44-\\uaa4b\\uaa60-\\uaa6f\\uaa71-\\uaa76\\uaa7a\\uaa7e-\\uaaaf\\uaab1\\uaab5\\uaab6\\uaab9-\\uaabd\\uaac0\\uaac2\\uaadb\\uaadc\\uaae0-\\uaaea\\uaaf2\\uab01-\\uab06\\uab09-\\uab0e\\uab11-\\uab16\\uab20-\\uab26\\uab28-\\uab2e\\uabc0-\\uabe2\\uac00-\\ud7a3\\ud7b0-\\ud7c6\\ud7cb-\\ud7fb\\uf900-\\ufa6d\\ufa70-\\ufad9\\ufb1d\\ufb1f-\\ufb28\\ufb2a-\\ufb36\\ufb38-\\ufb3c\\ufb3e\\ufb40\\ufb41\\ufb43\\ufb44\\ufb46-\\ufbb1\\ufbd3-\\ufd3d\\ufd50-\\ufd8f\\ufd92-\\ufdc7\\ufdf0-\\ufdfb\\ufe70-\\ufe74\\ufe76-\\ufefc\\uff66-\\uff6f\\uff71-\\uff9d\\uffa0-\\uffbe\\uffc2-\\uffc7\\uffca-\\uffcf\\uffd2-\\uffd7\\uffda-\\uffdc",astral:"\\ud800[\\udc00-\\udc0b\\udc0d-\\udc26\\udc28-\\udc3a\\udc3c\\udc3d\\udc3f-\\udc4d\\udc50-\\udc5d\\udc80-\\udcfa\\ude80-\\ude9c\\udea0-\\uded0\\udf00-\\udf1f\\udf30-\\udf40\\udf42-\\udf49\\udf50-\\udf75\\udf80-\\udf9d\\udfa0-\\udfc3\\udfc8-\\udfcf]|\\ud801[\\udc50-\\udc9d\\udd00-\\udd27\\udd30-\\udd63\\ude00-\\udf36\\udf40-\\udf55\\udf60-\\udf67]|\\ud802[\\udc00-\\udc05\\udc08\\udc0a-\\udc35\\udc37\\udc38\\udc3c\\udc3f-\\udc55\\udc60-\\udc76\\udc80-\\udc9e\\udce0-\\udcf2\\udcf4\\udcf5\\udd00-\\udd15\\udd20-\\udd39\\udd80-\\uddb7\\uddbe\\uddbf\\ude00\\ude10-\\ude13\\ude15-\\ude17\\ude19-\\ude33\\ude60-\\ude7c\\ude80-\\ude9c\\udec0-\\udec7\\udec9-\\udee4\\udf00-\\udf35\\udf40-\\udf55\\udf60-\\udf72\\udf80-\\udf91]|\\ud803[\\udc00-\\udc48]|\\ud804[\\udc03-\\udc37\\udc83-\\udcaf\\udcd0-\\udce8\\udd03-\\udd26\\udd50-\\udd72\\udd76\\udd83-\\uddb2\\uddc1-\\uddc4\\uddda\\udddc\\ude00-\\ude11\\ude13-\\ude2b\\ude80-\\ude86\\ude88\\ude8a-\\ude8d\\ude8f-\\ude9d\\ude9f-\\udea8\\udeb0-\\udede\\udf05-\\udf0c\\udf0f\\udf10\\udf13-\\udf28\\udf2a-\\udf30\\udf32\\udf33\\udf35-\\udf39\\udf3d\\udf50\\udf5d-\\udf61]|\\ud805[\\udc00-\\udc34\\udc47-\\udc4a\\udc80-\\udcaf\\udcc4\\udcc5\\udcc7\\udd80-\\uddae\\uddd8-\\udddb\\ude00-\\ude2f\\ude44\\ude80-\\udeaa\\udf00-\\udf19]|\\ud806[\\udcff\\udec0-\\udef8]|\\ud807[\\udc00-\\udc08\\udc0a-\\udc2e\\udc40\\udc72-\\udc8f]|\\ud808[\\udc00-\\udf99]|\\ud809[\\udc80-\\udd43]|[\\ud80c\\ud81c-\\ud820\\ud840-\\ud868\\ud86a-\\ud86c\\ud86f-\\ud872][\\udc00-\\udfff]|\\ud80d[\\udc00-\\udc2e]|\\ud811[\\udc00-\\ude46]|\\ud81a[\\udc00-\\ude38\\ude40-\\ude5e\\uded0-\\udeed\\udf00-\\udf2f\\udf63-\\udf77\\udf7d-\\udf8f]|\\ud81b[\\udf00-\\udf44\\udf50]|\\ud821[\\udc00-\\udfec]|\\ud822[\\udc00-\\udef2]|\\ud82c[\\udc00\\udc01]|\\ud82f[\\udc00-\\udc6a\\udc70-\\udc7c\\udc80-\\udc88\\udc90-\\udc99]|\\ud83a[\\udc00-\\udcc4]|\\ud83b[\\ude00-\\ude03\\ude05-\\ude1f\\ude21\\ude22\\ude24\\ude27\\ude29-\\ude32\\ude34-\\ude37\\ude39\\ude3b\\ude42\\ude47\\ude49\\ude4b\\ude4d-\\ude4f\\ude51\\ude52\\ude54\\ude57\\ude59\\ude5b\\ude5d\\ude5f\\ude61\\ude62\\ude64\\ude67-\\ude6a\\ude6c-\\ude72\\ude74-\\ude77\\ude79-\\ude7c\\ude7e\\ude80-\\ude89\\ude8b-\\ude9b\\udea1-\\udea3\\udea5-\\udea9\\udeab-\\udebb]|\\ud869[\\udc00-\\uded6\\udf00-\\udfff]|\\ud86d[\\udc00-\\udf34\\udf40-\\udfff]|\\ud86e[\\udc00-\\udc1d\\udc20-\\udfff]|\\ud873[\\udc00-\\udea1]|\\ud87e[\\udc00-\\ude1d]"},{name:"Lt",alias:"Titlecase_Letter",bmp:"\\u01c5\\u01c8\\u01cb\\u01f2\\u1f88-\\u1f8f\\u1f98-\\u1f9f\\u1fa8-\\u1faf\\u1fbc\\u1fcc\\u1ffc"},{name:"Lu",alias:"Uppercase_Letter",bmp:"A-Z\\xc0-\\xd6\\xd8-\\xde\\u0100\\u0102\\u0104\\u0106\\u0108\\u010a\\u010c\\u010e\\u0110\\u0112\\u0114\\u0116\\u0118\\u011a\\u011c\\u011e\\u0120\\u0122\\u0124\\u0126\\u0128\\u012a\\u012c\\u012e\\u0130\\u0132\\u0134\\u0136\\u0139\\u013b\\u013d\\u013f\\u0141\\u0143\\u0145\\u0147\\u014a\\u014c\\u014e\\u0150\\u0152\\u0154\\u0156\\u0158\\u015a\\u015c\\u015e\\u0160\\u0162\\u0164\\u0166\\u0168\\u016a\\u016c\\u016e\\u0170\\u0172\\u0174\\u0176\\u0178\\u0179\\u017b\\u017d\\u0181\\u0182\\u0184\\u0186\\u0187\\u0189-\\u018b\\u018e-\\u0191\\u0193\\u0194\\u0196-\\u0198\\u019c\\u019d\\u019f\\u01a0\\u01a2\\u01a4\\u01a6\\u01a7\\u01a9\\u01ac\\u01ae\\u01af\\u01b1-\\u01b3\\u01b5\\u01b7\\u01b8\\u01bc\\u01c4\\u01c7\\u01ca\\u01cd\\u01cf\\u01d1\\u01d3\\u01d5\\u01d7\\u01d9\\u01db\\u01de\\u01e0\\u01e2\\u01e4\\u01e6\\u01e8\\u01ea\\u01ec\\u01ee\\u01f1\\u01f4\\u01f6-\\u01f8\\u01fa\\u01fc\\u01fe\\u0200\\u0202\\u0204\\u0206\\u0208\\u020a\\u020c\\u020e\\u0210\\u0212\\u0214\\u0216\\u0218\\u021a\\u021c\\u021e\\u0220\\u0222\\u0224\\u0226\\u0228\\u022a\\u022c\\u022e\\u0230\\u0232\\u023a\\u023b\\u023d\\u023e\\u0241\\u0243-\\u0246\\u0248\\u024a\\u024c\\u024e\\u0370\\u0372\\u0376\\u037f\\u0386\\u0388-\\u038a\\u038c\\u038e\\u038f\\u0391-\\u03a1\\u03a3-\\u03ab\\u03cf\\u03d2-\\u03d4\\u03d8\\u03da\\u03dc\\u03de\\u03e0\\u03e2\\u03e4\\u03e6\\u03e8\\u03ea\\u03ec\\u03ee\\u03f4\\u03f7\\u03f9\\u03fa\\u03fd-\\u042f\\u0460\\u0462\\u0464\\u0466\\u0468\\u046a\\u046c\\u046e\\u0470\\u0472\\u0474\\u0476\\u0478\\u047a\\u047c\\u047e\\u0480\\u048a\\u048c\\u048e\\u0490\\u0492\\u0494\\u0496\\u0498\\u049a\\u049c\\u049e\\u04a0\\u04a2\\u04a4\\u04a6\\u04a8\\u04aa\\u04ac\\u04ae\\u04b0\\u04b2\\u04b4\\u04b6\\u04b8\\u04ba\\u04bc\\u04be\\u04c0\\u04c1\\u04c3\\u04c5\\u04c7\\u04c9\\u04cb\\u04cd\\u04d0\\u04d2\\u04d4\\u04d6\\u04d8\\u04da\\u04dc\\u04de\\u04e0\\u04e2\\u04e4\\u04e6\\u04e8\\u04ea\\u04ec\\u04ee\\u04f0\\u04f2\\u04f4\\u04f6\\u04f8\\u04fa\\u04fc\\u04fe\\u0500\\u0502\\u0504\\u0506\\u0508\\u050a\\u050c\\u050e\\u0510\\u0512\\u0514\\u0516\\u0518\\u051a\\u051c\\u051e\\u0520\\u0522\\u0524\\u0526\\u0528\\u052a\\u052c\\u052e\\u0531-\\u0556\\u10a0-\\u10c5\\u10c7\\u10cd\\u13a0-\\u13f5\\u1e00\\u1e02\\u1e04\\u1e06\\u1e08\\u1e0a\\u1e0c\\u1e0e\\u1e10\\u1e12\\u1e14\\u1e16\\u1e18\\u1e1a\\u1e1c\\u1e1e\\u1e20\\u1e22\\u1e24\\u1e26\\u1e28\\u1e2a\\u1e2c\\u1e2e\\u1e30\\u1e32\\u1e34\\u1e36\\u1e38\\u1e3a\\u1e3c\\u1e3e\\u1e40\\u1e42\\u1e44\\u1e46\\u1e48\\u1e4a\\u1e4c\\u1e4e\\u1e50\\u1e52\\u1e54\\u1e56\\u1e58\\u1e5a\\u1e5c\\u1e5e\\u1e60\\u1e62\\u1e64\\u1e66\\u1e68\\u1e6a\\u1e6c\\u1e6e\\u1e70\\u1e72\\u1e74\\u1e76\\u1e78\\u1e7a\\u1e7c\\u1e7e\\u1e80\\u1e82\\u1e84\\u1e86\\u1e88\\u1e8a\\u1e8c\\u1e8e\\u1e90\\u1e92\\u1e94\\u1e9e\\u1ea0\\u1ea2\\u1ea4\\u1ea6\\u1ea8\\u1eaa\\u1eac\\u1eae\\u1eb0\\u1eb2\\u1eb4\\u1eb6\\u1eb8\\u1eba\\u1ebc\\u1ebe\\u1ec0\\u1ec2\\u1ec4\\u1ec6\\u1ec8\\u1eca\\u1ecc\\u1ece\\u1ed0\\u1ed2\\u1ed4\\u1ed6\\u1ed8\\u1eda\\u1edc\\u1ede\\u1ee0\\u1ee2\\u1ee4\\u1ee6\\u1ee8\\u1eea\\u1eec\\u1eee\\u1ef0\\u1ef2\\u1ef4\\u1ef6\\u1ef8\\u1efa\\u1efc\\u1efe\\u1f08-\\u1f0f\\u1f18-\\u1f1d\\u1f28-\\u1f2f\\u1f38-\\u1f3f\\u1f48-\\u1f4d\\u1f59\\u1f5b\\u1f5d\\u1f5f\\u1f68-\\u1f6f\\u1fb8-\\u1fbb\\u1fc8-\\u1fcb\\u1fd8-\\u1fdb\\u1fe8-\\u1fec\\u1ff8-\\u1ffb\\u2102\\u2107\\u210b-\\u210d\\u2110-\\u2112\\u2115\\u2119-\\u211d\\u2124\\u2126\\u2128\\u212a-\\u212d\\u2130-\\u2133\\u213e\\u213f\\u2145\\u2183\\u2c00-\\u2c2e\\u2c60\\u2c62-\\u2c64\\u2c67\\u2c69\\u2c6b\\u2c6d-\\u2c70\\u2c72\\u2c75\\u2c7e-\\u2c80\\u2c82\\u2c84\\u2c86\\u2c88\\u2c8a\\u2c8c\\u2c8e\\u2c90\\u2c92\\u2c94\\u2c96\\u2c98\\u2c9a\\u2c9c\\u2c9e\\u2ca0\\u2ca2\\u2ca4\\u2ca6\\u2ca8\\u2caa\\u2cac\\u2cae\\u2cb0\\u2cb2\\u2cb4\\u2cb6\\u2cb8\\u2cba\\u2cbc\\u2cbe\\u2cc0\\u2cc2\\u2cc4\\u2cc6\\u2cc8\\u2cca\\u2ccc\\u2cce\\u2cd0\\u2cd2\\u2cd4\\u2cd6\\u2cd8\\u2cda\\u2cdc\\u2cde\\u2ce0\\u2ce2\\u2ceb\\u2ced\\u2cf2\\ua640\\ua642\\ua644\\ua646\\ua648\\ua64a\\ua64c\\ua64e\\ua650\\ua652\\ua654\\ua656\\ua658\\ua65a\\ua65c\\ua65e\\ua660\\ua662\\ua664\\ua666\\ua668\\ua66a\\ua66c\\ua680\\ua682\\ua684\\ua686\\ua688\\ua68a\\ua68c\\ua68e\\ua690\\ua692\\ua694\\ua696\\ua698\\ua69a\\ua722\\ua724\\ua726\\ua728\\ua72a\\ua72c\\ua72e\\ua732\\ua734\\ua736\\ua738\\ua73a\\ua73c\\ua73e\\ua740\\ua742\\ua744\\ua746\\ua748\\ua74a\\ua74c\\ua74e\\ua750\\ua752\\ua754\\ua756\\ua758\\ua75a\\ua75c\\ua75e\\ua760\\ua762\\ua764\\ua766\\ua768\\ua76a\\ua76c\\ua76e\\ua779\\ua77b\\ua77d\\ua77e\\ua780\\ua782\\ua784\\ua786\\ua78b\\ua78d\\ua790\\ua792\\ua796\\ua798\\ua79a\\ua79c\\ua79e\\ua7a0\\ua7a2\\ua7a4\\ua7a6\\ua7a8\\ua7aa-\\ua7ae\\ua7b0-\\ua7b4\\ua7b6\\uff21-\\uff3a",astral:"\\ud801[\\udc00-\\udc27\\udcb0-\\udcd3]|\\ud803[\\udc80-\\udcb2]|\\ud806[\\udca0-\\udcbf]|\\ud835[\\udc00-\\udc19\\udc34-\\udc4d\\udc68-\\udc81\\udc9c\\udc9e\\udc9f\\udca2\\udca5\\udca6\\udca9-\\udcac\\udcae-\\udcb5\\udcd0-\\udce9\\udd04\\udd05\\udd07-\\udd0a\\udd0d-\\udd14\\udd16-\\udd1c\\udd38\\udd39\\udd3b-\\udd3e\\udd40-\\udd44\\udd46\\udd4a-\\udd50\\udd6c-\\udd85\\udda0-\\uddb9\\uddd4-\\udded\\ude08-\\ude21\\ude3c-\\ude55\\ude70-\\ude89\\udea8-\\udec0\\udee2-\\udefa\\udf1c-\\udf34\\udf56-\\udf6e\\udf90-\\udfa8\\udfca]|\\ud83a[\\udd00-\\udd21]"},{name:"M",alias:"Mark",bmp:"\\u0300-\\u036f\\u0483-\\u0489\\u0591-\\u05bd\\u05bf\\u05c1\\u05c2\\u05c4\\u05c5\\u05c7\\u0610-\\u061a\\u064b-\\u065f\\u0670\\u06d6-\\u06dc\\u06df-\\u06e4\\u06e7\\u06e8\\u06ea-\\u06ed\\u0711\\u0730-\\u074a\\u07a6-\\u07b0\\u07eb-\\u07f3\\u0816-\\u0819\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0859-\\u085b\\u08d4-\\u08e1\\u08e3-\\u0903\\u093a-\\u093c\\u093e-\\u094f\\u0951-\\u0957\\u0962\\u0963\\u0981-\\u0983\\u09bc\\u09be-\\u09c4\\u09c7\\u09c8\\u09cb-\\u09cd\\u09d7\\u09e2\\u09e3\\u0a01-\\u0a03\\u0a3c\\u0a3e-\\u0a42\\u0a47\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a70\\u0a71\\u0a75\\u0a81-\\u0a83\\u0abc\\u0abe-\\u0ac5\\u0ac7-\\u0ac9\\u0acb-\\u0acd\\u0ae2\\u0ae3\\u0b01-\\u0b03\\u0b3c\\u0b3e-\\u0b44\\u0b47\\u0b48\\u0b4b-\\u0b4d\\u0b56\\u0b57\\u0b62\\u0b63\\u0b82\\u0bbe-\\u0bc2\\u0bc6-\\u0bc8\\u0bca-\\u0bcd\\u0bd7\\u0c00-\\u0c03\\u0c3e-\\u0c44\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55\\u0c56\\u0c62\\u0c63\\u0c81-\\u0c83\\u0cbc\\u0cbe-\\u0cc4\\u0cc6-\\u0cc8\\u0cca-\\u0ccd\\u0cd5\\u0cd6\\u0ce2\\u0ce3\\u0d01-\\u0d03\\u0d3e-\\u0d44\\u0d46-\\u0d48\\u0d4a-\\u0d4d\\u0d57\\u0d62\\u0d63\\u0d82\\u0d83\\u0dca\\u0dcf-\\u0dd4\\u0dd6\\u0dd8-\\u0ddf\\u0df2\\u0df3\\u0e31\\u0e34-\\u0e3a\\u0e47-\\u0e4e\\u0eb1\\u0eb4-\\u0eb9\\u0ebb\\u0ebc\\u0ec8-\\u0ecd\\u0f18\\u0f19\\u0f35\\u0f37\\u0f39\\u0f3e\\u0f3f\\u0f71-\\u0f84\\u0f86\\u0f87\\u0f8d-\\u0f97\\u0f99-\\u0fbc\\u0fc6\\u102b-\\u103e\\u1056-\\u1059\\u105e-\\u1060\\u1062-\\u1064\\u1067-\\u106d\\u1071-\\u1074\\u1082-\\u108d\\u108f\\u109a-\\u109d\\u135d-\\u135f\\u1712-\\u1714\\u1732-\\u1734\\u1752\\u1753\\u1772\\u1773\\u17b4-\\u17d3\\u17dd\\u180b-\\u180d\\u1885\\u1886\\u18a9\\u1920-\\u192b\\u1930-\\u193b\\u1a17-\\u1a1b\\u1a55-\\u1a5e\\u1a60-\\u1a7c\\u1a7f\\u1ab0-\\u1abe\\u1b00-\\u1b04\\u1b34-\\u1b44\\u1b6b-\\u1b73\\u1b80-\\u1b82\\u1ba1-\\u1bad\\u1be6-\\u1bf3\\u1c24-\\u1c37\\u1cd0-\\u1cd2\\u1cd4-\\u1ce8\\u1ced\\u1cf2-\\u1cf4\\u1cf8\\u1cf9\\u1dc0-\\u1df5\\u1dfb-\\u1dff\\u20d0-\\u20f0\\u2cef-\\u2cf1\\u2d7f\\u2de0-\\u2dff\\u302a-\\u302f\\u3099\\u309a\\ua66f-\\ua672\\ua674-\\ua67d\\ua69e\\ua69f\\ua6f0\\ua6f1\\ua802\\ua806\\ua80b\\ua823-\\ua827\\ua880\\ua881\\ua8b4-\\ua8c5\\ua8e0-\\ua8f1\\ua926-\\ua92d\\ua947-\\ua953\\ua980-\\ua983\\ua9b3-\\ua9c0\\ua9e5\\uaa29-\\uaa36\\uaa43\\uaa4c\\uaa4d\\uaa7b-\\uaa7d\\uaab0\\uaab2-\\uaab4\\uaab7\\uaab8\\uaabe\\uaabf\\uaac1\\uaaeb-\\uaaef\\uaaf5\\uaaf6\\uabe3-\\uabea\\uabec\\uabed\\ufb1e\\ufe00-\\ufe0f\\ufe20-\\ufe2f",astral:"\\ud800[\\uddfd\\udee0\\udf76-\\udf7a]|\\ud802[\\ude01-\\ude03\\ude05\\ude06\\ude0c-\\ude0f\\ude38-\\ude3a\\ude3f\\udee5\\udee6]|\\ud804[\\udc00-\\udc02\\udc38-\\udc46\\udc7f-\\udc82\\udcb0-\\udcba\\udd00-\\udd02\\udd27-\\udd34\\udd73\\udd80-\\udd82\\uddb3-\\uddc0\\uddca-\\uddcc\\ude2c-\\ude37\\ude3e\\udedf-\\udeea\\udf00-\\udf03\\udf3c\\udf3e-\\udf44\\udf47\\udf48\\udf4b-\\udf4d\\udf57\\udf62\\udf63\\udf66-\\udf6c\\udf70-\\udf74]|\\ud805[\\udc35-\\udc46\\udcb0-\\udcc3\\uddaf-\\uddb5\\uddb8-\\uddc0\\udddc\\udddd\\ude30-\\ude40\\udeab-\\udeb7\\udf1d-\\udf2b]|\\ud807[\\udc2f-\\udc36\\udc38-\\udc3f\\udc92-\\udca7\\udca9-\\udcb6]|\\ud81a[\\udef0-\\udef4\\udf30-\\udf36]|\\ud81b[\\udf51-\\udf7e\\udf8f-\\udf92]|\\ud82f[\\udc9d\\udc9e]|\\ud834[\\udd65-\\udd69\\udd6d-\\udd72\\udd7b-\\udd82\\udd85-\\udd8b\\uddaa-\\uddad\\ude42-\\ude44]|\\ud836[\\ude00-\\ude36\\ude3b-\\ude6c\\ude75\\ude84\\ude9b-\\ude9f\\udea1-\\udeaf]|\\ud838[\\udc00-\\udc06\\udc08-\\udc18\\udc1b-\\udc21\\udc23\\udc24\\udc26-\\udc2a]|\\ud83a[\\udcd0-\\udcd6\\udd44-\\udd4a]|\\udb40[\\udd00-\\uddef]"},{name:"Mc",alias:"Spacing_Mark",bmp:"\\u0903\\u093b\\u093e-\\u0940\\u0949-\\u094c\\u094e\\u094f\\u0982\\u0983\\u09be-\\u09c0\\u09c7\\u09c8\\u09cb\\u09cc\\u09d7\\u0a03\\u0a3e-\\u0a40\\u0a83\\u0abe-\\u0ac0\\u0ac9\\u0acb\\u0acc\\u0b02\\u0b03\\u0b3e\\u0b40\\u0b47\\u0b48\\u0b4b\\u0b4c\\u0b57\\u0bbe\\u0bbf\\u0bc1\\u0bc2\\u0bc6-\\u0bc8\\u0bca-\\u0bcc\\u0bd7\\u0c01-\\u0c03\\u0c41-\\u0c44\\u0c82\\u0c83\\u0cbe\\u0cc0-\\u0cc4\\u0cc7\\u0cc8\\u0cca\\u0ccb\\u0cd5\\u0cd6\\u0d02\\u0d03\\u0d3e-\\u0d40\\u0d46-\\u0d48\\u0d4a-\\u0d4c\\u0d57\\u0d82\\u0d83\\u0dcf-\\u0dd1\\u0dd8-\\u0ddf\\u0df2\\u0df3\\u0f3e\\u0f3f\\u0f7f\\u102b\\u102c\\u1031\\u1038\\u103b\\u103c\\u1056\\u1057\\u1062-\\u1064\\u1067-\\u106d\\u1083\\u1084\\u1087-\\u108c\\u108f\\u109a-\\u109c\\u17b6\\u17be-\\u17c5\\u17c7\\u17c8\\u1923-\\u1926\\u1929-\\u192b\\u1930\\u1931\\u1933-\\u1938\\u1a19\\u1a1a\\u1a55\\u1a57\\u1a61\\u1a63\\u1a64\\u1a6d-\\u1a72\\u1b04\\u1b35\\u1b3b\\u1b3d-\\u1b41\\u1b43\\u1b44\\u1b82\\u1ba1\\u1ba6\\u1ba7\\u1baa\\u1be7\\u1bea-\\u1bec\\u1bee\\u1bf2\\u1bf3\\u1c24-\\u1c2b\\u1c34\\u1c35\\u1ce1\\u1cf2\\u1cf3\\u302e\\u302f\\ua823\\ua824\\ua827\\ua880\\ua881\\ua8b4-\\ua8c3\\ua952\\ua953\\ua983\\ua9b4\\ua9b5\\ua9ba\\ua9bb\\ua9bd-\\ua9c0\\uaa2f\\uaa30\\uaa33\\uaa34\\uaa4d\\uaa7b\\uaa7d\\uaaeb\\uaaee\\uaaef\\uaaf5\\uabe3\\uabe4\\uabe6\\uabe7\\uabe9\\uabea\\uabec",astral:"\\ud804[\\udc00\\udc02\\udc82\\udcb0-\\udcb2\\udcb7\\udcb8\\udd2c\\udd82\\uddb3-\\uddb5\\uddbf\\uddc0\\ude2c-\\ude2e\\ude32\\ude33\\ude35\\udee0-\\udee2\\udf02\\udf03\\udf3e\\udf3f\\udf41-\\udf44\\udf47\\udf48\\udf4b-\\udf4d\\udf57\\udf62\\udf63]|\\ud805[\\udc35-\\udc37\\udc40\\udc41\\udc45\\udcb0-\\udcb2\\udcb9\\udcbb-\\udcbe\\udcc1\\uddaf-\\uddb1\\uddb8-\\uddbb\\uddbe\\ude30-\\ude32\\ude3b\\ude3c\\ude3e\\udeac\\udeae\\udeaf\\udeb6\\udf20\\udf21\\udf26]|\\ud807[\\udc2f\\udc3e\\udca9\\udcb1\\udcb4]|\\ud81b[\\udf51-\\udf7e]|\\ud834[\\udd65\\udd66\\udd6d-\\udd72]"},{name:"Me",alias:"Enclosing_Mark",bmp:"\\u0488\\u0489\\u1abe\\u20dd-\\u20e0\\u20e2-\\u20e4\\ua670-\\ua672"},{name:"Mn",alias:"Nonspacing_Mark",bmp:"\\u0300-\\u036f\\u0483-\\u0487\\u0591-\\u05bd\\u05bf\\u05c1\\u05c2\\u05c4\\u05c5\\u05c7\\u0610-\\u061a\\u064b-\\u065f\\u0670\\u06d6-\\u06dc\\u06df-\\u06e4\\u06e7\\u06e8\\u06ea-\\u06ed\\u0711\\u0730-\\u074a\\u07a6-\\u07b0\\u07eb-\\u07f3\\u0816-\\u0819\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0859-\\u085b\\u08d4-\\u08e1\\u08e3-\\u0902\\u093a\\u093c\\u0941-\\u0948\\u094d\\u0951-\\u0957\\u0962\\u0963\\u0981\\u09bc\\u09c1-\\u09c4\\u09cd\\u09e2\\u09e3\\u0a01\\u0a02\\u0a3c\\u0a41\\u0a42\\u0a47\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a70\\u0a71\\u0a75\\u0a81\\u0a82\\u0abc\\u0ac1-\\u0ac5\\u0ac7\\u0ac8\\u0acd\\u0ae2\\u0ae3\\u0b01\\u0b3c\\u0b3f\\u0b41-\\u0b44\\u0b4d\\u0b56\\u0b62\\u0b63\\u0b82\\u0bc0\\u0bcd\\u0c00\\u0c3e-\\u0c40\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55\\u0c56\\u0c62\\u0c63\\u0c81\\u0cbc\\u0cbf\\u0cc6\\u0ccc\\u0ccd\\u0ce2\\u0ce3\\u0d01\\u0d41-\\u0d44\\u0d4d\\u0d62\\u0d63\\u0dca\\u0dd2-\\u0dd4\\u0dd6\\u0e31\\u0e34-\\u0e3a\\u0e47-\\u0e4e\\u0eb1\\u0eb4-\\u0eb9\\u0ebb\\u0ebc\\u0ec8-\\u0ecd\\u0f18\\u0f19\\u0f35\\u0f37\\u0f39\\u0f71-\\u0f7e\\u0f80-\\u0f84\\u0f86\\u0f87\\u0f8d-\\u0f97\\u0f99-\\u0fbc\\u0fc6\\u102d-\\u1030\\u1032-\\u1037\\u1039\\u103a\\u103d\\u103e\\u1058\\u1059\\u105e-\\u1060\\u1071-\\u1074\\u1082\\u1085\\u1086\\u108d\\u109d\\u135d-\\u135f\\u1712-\\u1714\\u1732-\\u1734\\u1752\\u1753\\u1772\\u1773\\u17b4\\u17b5\\u17b7-\\u17bd\\u17c6\\u17c9-\\u17d3\\u17dd\\u180b-\\u180d\\u1885\\u1886\\u18a9\\u1920-\\u1922\\u1927\\u1928\\u1932\\u1939-\\u193b\\u1a17\\u1a18\\u1a1b\\u1a56\\u1a58-\\u1a5e\\u1a60\\u1a62\\u1a65-\\u1a6c\\u1a73-\\u1a7c\\u1a7f\\u1ab0-\\u1abd\\u1b00-\\u1b03\\u1b34\\u1b36-\\u1b3a\\u1b3c\\u1b42\\u1b6b-\\u1b73\\u1b80\\u1b81\\u1ba2-\\u1ba5\\u1ba8\\u1ba9\\u1bab-\\u1bad\\u1be6\\u1be8\\u1be9\\u1bed\\u1bef-\\u1bf1\\u1c2c-\\u1c33\\u1c36\\u1c37\\u1cd0-\\u1cd2\\u1cd4-\\u1ce0\\u1ce2-\\u1ce8\\u1ced\\u1cf4\\u1cf8\\u1cf9\\u1dc0-\\u1df5\\u1dfb-\\u1dff\\u20d0-\\u20dc\\u20e1\\u20e5-\\u20f0\\u2cef-\\u2cf1\\u2d7f\\u2de0-\\u2dff\\u302a-\\u302d\\u3099\\u309a\\ua66f\\ua674-\\ua67d\\ua69e\\ua69f\\ua6f0\\ua6f1\\ua802\\ua806\\ua80b\\ua825\\ua826\\ua8c4\\ua8c5\\ua8e0-\\ua8f1\\ua926-\\ua92d\\ua947-\\ua951\\ua980-\\ua982\\ua9b3\\ua9b6-\\ua9b9\\ua9bc\\ua9e5\\uaa29-\\uaa2e\\uaa31\\uaa32\\uaa35\\uaa36\\uaa43\\uaa4c\\uaa7c\\uaab0\\uaab2-\\uaab4\\uaab7\\uaab8\\uaabe\\uaabf\\uaac1\\uaaec\\uaaed\\uaaf6\\uabe5\\uabe8\\uabed\\ufb1e\\ufe00-\\ufe0f\\ufe20-\\ufe2f",astral:"\\ud800[\\uddfd\\udee0\\udf76-\\udf7a]|\\ud802[\\ude01-\\ude03\\ude05\\ude06\\ude0c-\\ude0f\\ude38-\\ude3a\\ude3f\\udee5\\udee6]|\\ud804[\\udc01\\udc38-\\udc46\\udc7f-\\udc81\\udcb3-\\udcb6\\udcb9\\udcba\\udd00-\\udd02\\udd27-\\udd2b\\udd2d-\\udd34\\udd73\\udd80\\udd81\\uddb6-\\uddbe\\uddca-\\uddcc\\ude2f-\\ude31\\ude34\\ude36\\ude37\\ude3e\\udedf\\udee3-\\udeea\\udf00\\udf01\\udf3c\\udf40\\udf66-\\udf6c\\udf70-\\udf74]|\\ud805[\\udc38-\\udc3f\\udc42-\\udc44\\udc46\\udcb3-\\udcb8\\udcba\\udcbf\\udcc0\\udcc2\\udcc3\\uddb2-\\uddb5\\uddbc\\uddbd\\uddbf\\uddc0\\udddc\\udddd\\ude33-\\ude3a\\ude3d\\ude3f\\ude40\\udeab\\udead\\udeb0-\\udeb5\\udeb7\\udf1d-\\udf1f\\udf22-\\udf25\\udf27-\\udf2b]|\\ud807[\\udc30-\\udc36\\udc38-\\udc3d\\udc3f\\udc92-\\udca7\\udcaa-\\udcb0\\udcb2\\udcb3\\udcb5\\udcb6]|\\ud81a[\\udef0-\\udef4\\udf30-\\udf36]|\\ud81b[\\udf8f-\\udf92]|\\ud82f[\\udc9d\\udc9e]|\\ud834[\\udd67-\\udd69\\udd7b-\\udd82\\udd85-\\udd8b\\uddaa-\\uddad\\ude42-\\ude44]|\\ud836[\\ude00-\\ude36\\ude3b-\\ude6c\\ude75\\ude84\\ude9b-\\ude9f\\udea1-\\udeaf]|\\ud838[\\udc00-\\udc06\\udc08-\\udc18\\udc1b-\\udc21\\udc23\\udc24\\udc26-\\udc2a]|\\ud83a[\\udcd0-\\udcd6\\udd44-\\udd4a]|\\udb40[\\udd00-\\uddef]"},{name:"N",alias:"Number",bmp:"0-9\\xb2\\xb3\\xb9\\xbc-\\xbe\\u0660-\\u0669\\u06f0-\\u06f9\\u07c0-\\u07c9\\u0966-\\u096f\\u09e6-\\u09ef\\u09f4-\\u09f9\\u0a66-\\u0a6f\\u0ae6-\\u0aef\\u0b66-\\u0b6f\\u0b72-\\u0b77\\u0be6-\\u0bf2\\u0c66-\\u0c6f\\u0c78-\\u0c7e\\u0ce6-\\u0cef\\u0d58-\\u0d5e\\u0d66-\\u0d78\\u0de6-\\u0def\\u0e50-\\u0e59\\u0ed0-\\u0ed9\\u0f20-\\u0f33\\u1040-\\u1049\\u1090-\\u1099\\u1369-\\u137c\\u16ee-\\u16f0\\u17e0-\\u17e9\\u17f0-\\u17f9\\u1810-\\u1819\\u1946-\\u194f\\u19d0-\\u19da\\u1a80-\\u1a89\\u1a90-\\u1a99\\u1b50-\\u1b59\\u1bb0-\\u1bb9\\u1c40-\\u1c49\\u1c50-\\u1c59\\u2070\\u2074-\\u2079\\u2080-\\u2089\\u2150-\\u2182\\u2185-\\u2189\\u2460-\\u249b\\u24ea-\\u24ff\\u2776-\\u2793\\u2cfd\\u3007\\u3021-\\u3029\\u3038-\\u303a\\u3192-\\u3195\\u3220-\\u3229\\u3248-\\u324f\\u3251-\\u325f\\u3280-\\u3289\\u32b1-\\u32bf\\ua620-\\ua629\\ua6e6-\\ua6ef\\ua830-\\ua835\\ua8d0-\\ua8d9\\ua900-\\ua909\\ua9d0-\\ua9d9\\ua9f0-\\ua9f9\\uaa50-\\uaa59\\uabf0-\\uabf9\\uff10-\\uff19",astral:"\\ud800[\\udd07-\\udd33\\udd40-\\udd78\\udd8a\\udd8b\\udee1-\\udefb\\udf20-\\udf23\\udf41\\udf4a\\udfd1-\\udfd5]|\\ud801[\\udca0-\\udca9]|\\ud802[\\udc58-\\udc5f\\udc79-\\udc7f\\udca7-\\udcaf\\udcfb-\\udcff\\udd16-\\udd1b\\uddbc\\uddbd\\uddc0-\\uddcf\\uddd2-\\uddff\\ude40-\\ude47\\ude7d\\ude7e\\ude9d-\\ude9f\\udeeb-\\udeef\\udf58-\\udf5f\\udf78-\\udf7f\\udfa9-\\udfaf]|\\ud803[\\udcfa-\\udcff\\ude60-\\ude7e]|\\ud804[\\udc52-\\udc6f\\udcf0-\\udcf9\\udd36-\\udd3f\\uddd0-\\uddd9\\udde1-\\uddf4\\udef0-\\udef9]|\\ud805[\\udc50-\\udc59\\udcd0-\\udcd9\\ude50-\\ude59\\udec0-\\udec9\\udf30-\\udf3b]|\\ud806[\\udce0-\\udcf2]|\\ud807[\\udc50-\\udc6c]|\\ud809[\\udc00-\\udc6e]|\\ud81a[\\ude60-\\ude69\\udf50-\\udf59\\udf5b-\\udf61]|\\ud834[\\udf60-\\udf71]|\\ud835[\\udfce-\\udfff]|\\ud83a[\\udcc7-\\udccf\\udd50-\\udd59]|\\ud83c[\\udd00-\\udd0c]"},{name:"Nd",alias:"Decimal_Number",bmp:"0-9\\u0660-\\u0669\\u06f0-\\u06f9\\u07c0-\\u07c9\\u0966-\\u096f\\u09e6-\\u09ef\\u0a66-\\u0a6f\\u0ae6-\\u0aef\\u0b66-\\u0b6f\\u0be6-\\u0bef\\u0c66-\\u0c6f\\u0ce6-\\u0cef\\u0d66-\\u0d6f\\u0de6-\\u0def\\u0e50-\\u0e59\\u0ed0-\\u0ed9\\u0f20-\\u0f29\\u1040-\\u1049\\u1090-\\u1099\\u17e0-\\u17e9\\u1810-\\u1819\\u1946-\\u194f\\u19d0-\\u19d9\\u1a80-\\u1a89\\u1a90-\\u1a99\\u1b50-\\u1b59\\u1bb0-\\u1bb9\\u1c40-\\u1c49\\u1c50-\\u1c59\\ua620-\\ua629\\ua8d0-\\ua8d9\\ua900-\\ua909\\ua9d0-\\ua9d9\\ua9f0-\\ua9f9\\uaa50-\\uaa59\\uabf0-\\uabf9\\uff10-\\uff19",astral:"\\ud801[\\udca0-\\udca9]|\\ud804[\\udc66-\\udc6f\\udcf0-\\udcf9\\udd36-\\udd3f\\uddd0-\\uddd9\\udef0-\\udef9]|\\ud805[\\udc50-\\udc59\\udcd0-\\udcd9\\ude50-\\ude59\\udec0-\\udec9\\udf30-\\udf39]|\\ud806[\\udce0-\\udce9]|\\ud807[\\udc50-\\udc59]|\\ud81a[\\ude60-\\ude69\\udf50-\\udf59]|\\ud835[\\udfce-\\udfff]|\\ud83a[\\udd50-\\udd59]"},{name:"Nl",alias:"Letter_Number",bmp:"\\u16ee-\\u16f0\\u2160-\\u2182\\u2185-\\u2188\\u3007\\u3021-\\u3029\\u3038-\\u303a\\ua6e6-\\ua6ef",astral:"\\ud800[\\udd40-\\udd74\\udf41\\udf4a\\udfd1-\\udfd5]|\\ud809[\\udc00-\\udc6e]"},{name:"No",alias:"Other_Number",bmp:"\\xb2\\xb3\\xb9\\xbc-\\xbe\\u09f4-\\u09f9\\u0b72-\\u0b77\\u0bf0-\\u0bf2\\u0c78-\\u0c7e\\u0d58-\\u0d5e\\u0d70-\\u0d78\\u0f2a-\\u0f33\\u1369-\\u137c\\u17f0-\\u17f9\\u19da\\u2070\\u2074-\\u2079\\u2080-\\u2089\\u2150-\\u215f\\u2189\\u2460-\\u249b\\u24ea-\\u24ff\\u2776-\\u2793\\u2cfd\\u3192-\\u3195\\u3220-\\u3229\\u3248-\\u324f\\u3251-\\u325f\\u3280-\\u3289\\u32b1-\\u32bf\\ua830-\\ua835",astral:"\\ud800[\\udd07-\\udd33\\udd75-\\udd78\\udd8a\\udd8b\\udee1-\\udefb\\udf20-\\udf23]|\\ud802[\\udc58-\\udc5f\\udc79-\\udc7f\\udca7-\\udcaf\\udcfb-\\udcff\\udd16-\\udd1b\\uddbc\\uddbd\\uddc0-\\uddcf\\uddd2-\\uddff\\ude40-\\ude47\\ude7d\\ude7e\\ude9d-\\ude9f\\udeeb-\\udeef\\udf58-\\udf5f\\udf78-\\udf7f\\udfa9-\\udfaf]|\\ud803[\\udcfa-\\udcff\\ude60-\\ude7e]|\\ud804[\\udc52-\\udc65\\udde1-\\uddf4]|\\ud805[\\udf3a\\udf3b]|\\ud806[\\udcea-\\udcf2]|\\ud807[\\udc5a-\\udc6c]|\\ud81a[\\udf5b-\\udf61]|\\ud834[\\udf60-\\udf71]|\\ud83a[\\udcc7-\\udccf]|\\ud83c[\\udd00-\\udd0c]"},{name:"P",alias:"Punctuation",bmp:"!-#%-\\\\x2A,-/:;\\\\x3F@\\\\x5B-\\\\x5D_\\\\x7B}\\xa1\\xa7\\xab\\xb6\\xb7\\xbb\\xbf\\u037e\\u0387\\u055a-\\u055f\\u0589\\u058a\\u05be\\u05c0\\u05c3\\u05c6\\u05f3\\u05f4\\u0609\\u060a\\u060c\\u060d\\u061b\\u061e\\u061f\\u066a-\\u066d\\u06d4\\u0700-\\u070d\\u07f7-\\u07f9\\u0830-\\u083e\\u085e\\u0964\\u0965\\u0970\\u0af0\\u0df4\\u0e4f\\u0e5a\\u0e5b\\u0f04-\\u0f12\\u0f14\\u0f3a-\\u0f3d\\u0f85\\u0fd0-\\u0fd4\\u0fd9\\u0fda\\u104a-\\u104f\\u10fb\\u1360-\\u1368\\u1400\\u166d\\u166e\\u169b\\u169c\\u16eb-\\u16ed\\u1735\\u1736\\u17d4-\\u17d6\\u17d8-\\u17da\\u1800-\\u180a\\u1944\\u1945\\u1a1e\\u1a1f\\u1aa0-\\u1aa6\\u1aa8-\\u1aad\\u1b5a-\\u1b60\\u1bfc-\\u1bff\\u1c3b-\\u1c3f\\u1c7e\\u1c7f\\u1cc0-\\u1cc7\\u1cd3\\u2010-\\u2027\\u2030-\\u2043\\u2045-\\u2051\\u2053-\\u205e\\u207d\\u207e\\u208d\\u208e\\u2308-\\u230b\\u2329\\u232a\\u2768-\\u2775\\u27c5\\u27c6\\u27e6-\\u27ef\\u2983-\\u2998\\u29d8-\\u29db\\u29fc\\u29fd\\u2cf9-\\u2cfc\\u2cfe\\u2cff\\u2d70\\u2e00-\\u2e2e\\u2e30-\\u2e44\\u3001-\\u3003\\u3008-\\u3011\\u3014-\\u301f\\u3030\\u303d\\u30a0\\u30fb\\ua4fe\\ua4ff\\ua60d-\\ua60f\\ua673\\ua67e\\ua6f2-\\ua6f7\\ua874-\\ua877\\ua8ce\\ua8cf\\ua8f8-\\ua8fa\\ua8fc\\ua92e\\ua92f\\ua95f\\ua9c1-\\ua9cd\\ua9de\\ua9df\\uaa5c-\\uaa5f\\uaade\\uaadf\\uaaf0\\uaaf1\\uabeb\\ufd3e\\ufd3f\\ufe10-\\ufe19\\ufe30-\\ufe52\\ufe54-\\ufe61\\ufe63\\ufe68\\ufe6a\\ufe6b\\uff01-\\uff03\\uff05-\\uff0a\\uff0c-\\uff0f\\uff1a\\uff1b\\uff1f\\uff20\\uff3b-\\uff3d\\uff3f\\uff5b\\uff5d\\uff5f-\\uff65",astral:"\\ud800[\\udd00-\\udd02\\udf9f\\udfd0]|\\ud801\\udd6f|\\ud802[\\udc57\\udd1f\\udd3f\\ude50-\\ude58\\ude7f\\udef0-\\udef6\\udf39-\\udf3f\\udf99-\\udf9c]|\\ud804[\\udc47-\\udc4d\\udcbb\\udcbc\\udcbe-\\udcc1\\udd40-\\udd43\\udd74\\udd75\\uddc5-\\uddc9\\uddcd\\udddb\\udddd-\\udddf\\ude38-\\ude3d\\udea9]|\\ud805[\\udc4b-\\udc4f\\udc5b\\udc5d\\udcc6\\uddc1-\\uddd7\\ude41-\\ude43\\ude60-\\ude6c\\udf3c-\\udf3e]|\\ud807[\\udc41-\\udc45\\udc70\\udc71]|\\ud809[\\udc70-\\udc74]|\\ud81a[\\ude6e\\ude6f\\udef5\\udf37-\\udf3b\\udf44]|\\ud82f\\udc9f|\\ud836[\\ude87-\\ude8b]|\\ud83a[\\udd5e\\udd5f]"},{name:"Pc",alias:"Connector_Punctuation",bmp:"_\\u203f\\u2040\\u2054\\ufe33\\ufe34\\ufe4d-\\ufe4f\\uff3f"},{name:"Pd",alias:"Dash_Punctuation",bmp:"\\\\x2D\\u058a\\u05be\\u1400\\u1806\\u2010-\\u2015\\u2e17\\u2e1a\\u2e3a\\u2e3b\\u2e40\\u301c\\u3030\\u30a0\\ufe31\\ufe32\\ufe58\\ufe63\\uff0d"},{name:"Pe",alias:"Close_Punctuation",bmp:"\\\\x29\\\\x5D}\\u0f3b\\u0f3d\\u169c\\u2046\\u207e\\u208e\\u2309\\u230b\\u232a\\u2769\\u276b\\u276d\\u276f\\u2771\\u2773\\u2775\\u27c6\\u27e7\\u27e9\\u27eb\\u27ed\\u27ef\\u2984\\u2986\\u2988\\u298a\\u298c\\u298e\\u2990\\u2992\\u2994\\u2996\\u2998\\u29d9\\u29db\\u29fd\\u2e23\\u2e25\\u2e27\\u2e29\\u3009\\u300b\\u300d\\u300f\\u3011\\u3015\\u3017\\u3019\\u301b\\u301e\\u301f\\ufd3e\\ufe18\\ufe36\\ufe38\\ufe3a\\ufe3c\\ufe3e\\ufe40\\ufe42\\ufe44\\ufe48\\ufe5a\\ufe5c\\ufe5e\\uff09\\uff3d\\uff5d\\uff60\\uff63"},{name:"Pf",alias:"Final_Punctuation",bmp:"\\xbb\\u2019\\u201d\\u203a\\u2e03\\u2e05\\u2e0a\\u2e0d\\u2e1d\\u2e21"},{name:"Pi",alias:"Initial_Punctuation",bmp:"\\xab\\u2018\\u201b\\u201c\\u201f\\u2039\\u2e02\\u2e04\\u2e09\\u2e0c\\u2e1c\\u2e20"},{name:"Po",alias:"Other_Punctuation",bmp:"!-#%-\'\\\\x2A,\\\\x2E/:;\\\\x3F@\\\\x5C\\xa1\\xa7\\xb6\\xb7\\xbf\\u037e\\u0387\\u055a-\\u055f\\u0589\\u05c0\\u05c3\\u05c6\\u05f3\\u05f4\\u0609\\u060a\\u060c\\u060d\\u061b\\u061e\\u061f\\u066a-\\u066d\\u06d4\\u0700-\\u070d\\u07f7-\\u07f9\\u0830-\\u083e\\u085e\\u0964\\u0965\\u0970\\u0af0\\u0df4\\u0e4f\\u0e5a\\u0e5b\\u0f04-\\u0f12\\u0f14\\u0f85\\u0fd0-\\u0fd4\\u0fd9\\u0fda\\u104a-\\u104f\\u10fb\\u1360-\\u1368\\u166d\\u166e\\u16eb-\\u16ed\\u1735\\u1736\\u17d4-\\u17d6\\u17d8-\\u17da\\u1800-\\u1805\\u1807-\\u180a\\u1944\\u1945\\u1a1e\\u1a1f\\u1aa0-\\u1aa6\\u1aa8-\\u1aad\\u1b5a-\\u1b60\\u1bfc-\\u1bff\\u1c3b-\\u1c3f\\u1c7e\\u1c7f\\u1cc0-\\u1cc7\\u1cd3\\u2016\\u2017\\u2020-\\u2027\\u2030-\\u2038\\u203b-\\u203e\\u2041-\\u2043\\u2047-\\u2051\\u2053\\u2055-\\u205e\\u2cf9-\\u2cfc\\u2cfe\\u2cff\\u2d70\\u2e00\\u2e01\\u2e06-\\u2e08\\u2e0b\\u2e0e-\\u2e16\\u2e18\\u2e19\\u2e1b\\u2e1e\\u2e1f\\u2e2a-\\u2e2e\\u2e30-\\u2e39\\u2e3c-\\u2e3f\\u2e41\\u2e43\\u2e44\\u3001-\\u3003\\u303d\\u30fb\\ua4fe\\ua4ff\\ua60d-\\ua60f\\ua673\\ua67e\\ua6f2-\\ua6f7\\ua874-\\ua877\\ua8ce\\ua8cf\\ua8f8-\\ua8fa\\ua8fc\\ua92e\\ua92f\\ua95f\\ua9c1-\\ua9cd\\ua9de\\ua9df\\uaa5c-\\uaa5f\\uaade\\uaadf\\uaaf0\\uaaf1\\uabeb\\ufe10-\\ufe16\\ufe19\\ufe30\\ufe45\\ufe46\\ufe49-\\ufe4c\\ufe50-\\ufe52\\ufe54-\\ufe57\\ufe5f-\\ufe61\\ufe68\\ufe6a\\ufe6b\\uff01-\\uff03\\uff05-\\uff07\\uff0a\\uff0c\\uff0e\\uff0f\\uff1a\\uff1b\\uff1f\\uff20\\uff3c\\uff61\\uff64\\uff65",astral:"\\ud800[\\udd00-\\udd02\\udf9f\\udfd0]|\\ud801\\udd6f|\\ud802[\\udc57\\udd1f\\udd3f\\ude50-\\ude58\\ude7f\\udef0-\\udef6\\udf39-\\udf3f\\udf99-\\udf9c]|\\ud804[\\udc47-\\udc4d\\udcbb\\udcbc\\udcbe-\\udcc1\\udd40-\\udd43\\udd74\\udd75\\uddc5-\\uddc9\\uddcd\\udddb\\udddd-\\udddf\\ude38-\\ude3d\\udea9]|\\ud805[\\udc4b-\\udc4f\\udc5b\\udc5d\\udcc6\\uddc1-\\uddd7\\ude41-\\ude43\\ude60-\\ude6c\\udf3c-\\udf3e]|\\ud807[\\udc41-\\udc45\\udc70\\udc71]|\\ud809[\\udc70-\\udc74]|\\ud81a[\\ude6e\\ude6f\\udef5\\udf37-\\udf3b\\udf44]|\\ud82f\\udc9f|\\ud836[\\ude87-\\ude8b]|\\ud83a[\\udd5e\\udd5f]"},{name:"Ps",alias:"Open_Punctuation",bmp:"\\\\x28\\\\x5B\\\\x7B\\u0f3a\\u0f3c\\u169b\\u201a\\u201e\\u2045\\u207d\\u208d\\u2308\\u230a\\u2329\\u2768\\u276a\\u276c\\u276e\\u2770\\u2772\\u2774\\u27c5\\u27e6\\u27e8\\u27ea\\u27ec\\u27ee\\u2983\\u2985\\u2987\\u2989\\u298b\\u298d\\u298f\\u2991\\u2993\\u2995\\u2997\\u29d8\\u29da\\u29fc\\u2e22\\u2e24\\u2e26\\u2e28\\u2e42\\u3008\\u300a\\u300c\\u300e\\u3010\\u3014\\u3016\\u3018\\u301a\\u301d\\ufd3f\\ufe17\\ufe35\\ufe37\\ufe39\\ufe3b\\ufe3d\\ufe3f\\ufe41\\ufe43\\ufe47\\ufe59\\ufe5b\\ufe5d\\uff08\\uff3b\\uff5b\\uff5f\\uff62"},{name:"S",alias:"Symbol",bmp:"\\\\x24\\\\x2B<->\\\\x5E`\\\\x7C~\\xa2-\\xa6\\xa8\\xa9\\xac\\xae-\\xb1\\xb4\\xb8\\xd7\\xf7\\u02c2-\\u02c5\\u02d2-\\u02df\\u02e5-\\u02eb\\u02ed\\u02ef-\\u02ff\\u0375\\u0384\\u0385\\u03f6\\u0482\\u058d-\\u058f\\u0606-\\u0608\\u060b\\u060e\\u060f\\u06de\\u06e9\\u06fd\\u06fe\\u07f6\\u09f2\\u09f3\\u09fa\\u09fb\\u0af1\\u0b70\\u0bf3-\\u0bfa\\u0c7f\\u0d4f\\u0d79\\u0e3f\\u0f01-\\u0f03\\u0f13\\u0f15-\\u0f17\\u0f1a-\\u0f1f\\u0f34\\u0f36\\u0f38\\u0fbe-\\u0fc5\\u0fc7-\\u0fcc\\u0fce\\u0fcf\\u0fd5-\\u0fd8\\u109e\\u109f\\u1390-\\u1399\\u17db\\u1940\\u19de-\\u19ff\\u1b61-\\u1b6a\\u1b74-\\u1b7c\\u1fbd\\u1fbf-\\u1fc1\\u1fcd-\\u1fcf\\u1fdd-\\u1fdf\\u1fed-\\u1fef\\u1ffd\\u1ffe\\u2044\\u2052\\u207a-\\u207c\\u208a-\\u208c\\u20a0-\\u20be\\u2100\\u2101\\u2103-\\u2106\\u2108\\u2109\\u2114\\u2116-\\u2118\\u211e-\\u2123\\u2125\\u2127\\u2129\\u212e\\u213a\\u213b\\u2140-\\u2144\\u214a-\\u214d\\u214f\\u218a\\u218b\\u2190-\\u2307\\u230c-\\u2328\\u232b-\\u23fe\\u2400-\\u2426\\u2440-\\u244a\\u249c-\\u24e9\\u2500-\\u2767\\u2794-\\u27c4\\u27c7-\\u27e5\\u27f0-\\u2982\\u2999-\\u29d7\\u29dc-\\u29fb\\u29fe-\\u2b73\\u2b76-\\u2b95\\u2b98-\\u2bb9\\u2bbd-\\u2bc8\\u2bca-\\u2bd1\\u2bec-\\u2bef\\u2ce5-\\u2cea\\u2e80-\\u2e99\\u2e9b-\\u2ef3\\u2f00-\\u2fd5\\u2ff0-\\u2ffb\\u3004\\u3012\\u3013\\u3020\\u3036\\u3037\\u303e\\u303f\\u309b\\u309c\\u3190\\u3191\\u3196-\\u319f\\u31c0-\\u31e3\\u3200-\\u321e\\u322a-\\u3247\\u3250\\u3260-\\u327f\\u328a-\\u32b0\\u32c0-\\u32fe\\u3300-\\u33ff\\u4dc0-\\u4dff\\ua490-\\ua4c6\\ua700-\\ua716\\ua720\\ua721\\ua789\\ua78a\\ua828-\\ua82b\\ua836-\\ua839\\uaa77-\\uaa79\\uab5b\\ufb29\\ufbb2-\\ufbc1\\ufdfc\\ufdfd\\ufe62\\ufe64-\\ufe66\\ufe69\\uff04\\uff0b\\uff1c-\\uff1e\\uff3e\\uff40\\uff5c\\uff5e\\uffe0-\\uffe6\\uffe8-\\uffee\\ufffc\\ufffd",astral:"\\ud800[\\udd37-\\udd3f\\udd79-\\udd89\\udd8c-\\udd8e\\udd90-\\udd9b\\udda0\\uddd0-\\uddfc]|\\ud802[\\udc77\\udc78\\udec8]|\\ud805\\udf3f|\\ud81a[\\udf3c-\\udf3f\\udf45]|\\ud82f\\udc9c|\\ud834[\\udc00-\\udcf5\\udd00-\\udd26\\udd29-\\udd64\\udd6a-\\udd6c\\udd83\\udd84\\udd8c-\\udda9\\uddae-\\udde8\\ude00-\\ude41\\ude45\\udf00-\\udf56]|\\ud835[\\udec1\\udedb\\udefb\\udf15\\udf35\\udf4f\\udf6f\\udf89\\udfa9\\udfc3]|\\ud836[\\udc00-\\uddff\\ude37-\\ude3a\\ude6d-\\ude74\\ude76-\\ude83\\ude85\\ude86]|\\ud83b[\\udef0\\udef1]|\\ud83c[\\udc00-\\udc2b\\udc30-\\udc93\\udca0-\\udcae\\udcb1-\\udcbf\\udcc1-\\udccf\\udcd1-\\udcf5\\udd10-\\udd2e\\udd30-\\udd6b\\udd70-\\uddac\\udde6-\\ude02\\ude10-\\ude3b\\ude40-\\ude48\\ude50\\ude51\\udf00-\\udfff]|\\ud83d[\\udc00-\\uded2\\udee0-\\udeec\\udef0-\\udef6\\udf00-\\udf73\\udf80-\\udfd4]|\\ud83e[\\udc00-\\udc0b\\udc10-\\udc47\\udc50-\\udc59\\udc60-\\udc87\\udc90-\\udcad\\udd10-\\udd1e\\udd20-\\udd27\\udd30\\udd33-\\udd3e\\udd40-\\udd4b\\udd50-\\udd5e\\udd80-\\udd91\\uddc0]"},{name:"Sc",alias:"Currency_Symbol",bmp:"\\\\x24\\xa2-\\xa5\\u058f\\u060b\\u09f2\\u09f3\\u09fb\\u0af1\\u0bf9\\u0e3f\\u17db\\u20a0-\\u20be\\ua838\\ufdfc\\ufe69\\uff04\\uffe0\\uffe1\\uffe5\\uffe6"},{name:"Sk",alias:"Modifier_Symbol",bmp:"\\\\x5E`\\xa8\\xaf\\xb4\\xb8\\u02c2-\\u02c5\\u02d2-\\u02df\\u02e5-\\u02eb\\u02ed\\u02ef-\\u02ff\\u0375\\u0384\\u0385\\u1fbd\\u1fbf-\\u1fc1\\u1fcd-\\u1fcf\\u1fdd-\\u1fdf\\u1fed-\\u1fef\\u1ffd\\u1ffe\\u309b\\u309c\\ua700-\\ua716\\ua720\\ua721\\ua789\\ua78a\\uab5b\\ufbb2-\\ufbc1\\uff3e\\uff40\\uffe3",astral:"\\ud83c[\\udffb-\\udfff]"},{name:"Sm",alias:"Math_Symbol",bmp:"\\\\x2B<->\\\\x7C~\\xac\\xb1\\xd7\\xf7\\u03f6\\u0606-\\u0608\\u2044\\u2052\\u207a-\\u207c\\u208a-\\u208c\\u2118\\u2140-\\u2144\\u214b\\u2190-\\u2194\\u219a\\u219b\\u21a0\\u21a3\\u21a6\\u21ae\\u21ce\\u21cf\\u21d2\\u21d4\\u21f4-\\u22ff\\u2320\\u2321\\u237c\\u239b-\\u23b3\\u23dc-\\u23e1\\u25b7\\u25c1\\u25f8-\\u25ff\\u266f\\u27c0-\\u27c4\\u27c7-\\u27e5\\u27f0-\\u27ff\\u2900-\\u2982\\u2999-\\u29d7\\u29dc-\\u29fb\\u29fe-\\u2aff\\u2b30-\\u2b44\\u2b47-\\u2b4c\\ufb29\\ufe62\\ufe64-\\ufe66\\uff0b\\uff1c-\\uff1e\\uff5c\\uff5e\\uffe2\\uffe9-\\uffec",astral:"\\ud835[\\udec1\\udedb\\udefb\\udf15\\udf35\\udf4f\\udf6f\\udf89\\udfa9\\udfc3]|\\ud83b[\\udef0\\udef1]"},{name:"So",alias:"Other_Symbol",bmp:"\\xa6\\xa9\\xae\\xb0\\u0482\\u058d\\u058e\\u060e\\u060f\\u06de\\u06e9\\u06fd\\u06fe\\u07f6\\u09fa\\u0b70\\u0bf3-\\u0bf8\\u0bfa\\u0c7f\\u0d4f\\u0d79\\u0f01-\\u0f03\\u0f13\\u0f15-\\u0f17\\u0f1a-\\u0f1f\\u0f34\\u0f36\\u0f38\\u0fbe-\\u0fc5\\u0fc7-\\u0fcc\\u0fce\\u0fcf\\u0fd5-\\u0fd8\\u109e\\u109f\\u1390-\\u1399\\u1940\\u19de-\\u19ff\\u1b61-\\u1b6a\\u1b74-\\u1b7c\\u2100\\u2101\\u2103-\\u2106\\u2108\\u2109\\u2114\\u2116\\u2117\\u211e-\\u2123\\u2125\\u2127\\u2129\\u212e\\u213a\\u213b\\u214a\\u214c\\u214d\\u214f\\u218a\\u218b\\u2195-\\u2199\\u219c-\\u219f\\u21a1\\u21a2\\u21a4\\u21a5\\u21a7-\\u21ad\\u21af-\\u21cd\\u21d0\\u21d1\\u21d3\\u21d5-\\u21f3\\u2300-\\u2307\\u230c-\\u231f\\u2322-\\u2328\\u232b-\\u237b\\u237d-\\u239a\\u23b4-\\u23db\\u23e2-\\u23fe\\u2400-\\u2426\\u2440-\\u244a\\u249c-\\u24e9\\u2500-\\u25b6\\u25b8-\\u25c0\\u25c2-\\u25f7\\u2600-\\u266e\\u2670-\\u2767\\u2794-\\u27bf\\u2800-\\u28ff\\u2b00-\\u2b2f\\u2b45\\u2b46\\u2b4d-\\u2b73\\u2b76-\\u2b95\\u2b98-\\u2bb9\\u2bbd-\\u2bc8\\u2bca-\\u2bd1\\u2bec-\\u2bef\\u2ce5-\\u2cea\\u2e80-\\u2e99\\u2e9b-\\u2ef3\\u2f00-\\u2fd5\\u2ff0-\\u2ffb\\u3004\\u3012\\u3013\\u3020\\u3036\\u3037\\u303e\\u303f\\u3190\\u3191\\u3196-\\u319f\\u31c0-\\u31e3\\u3200-\\u321e\\u322a-\\u3247\\u3250\\u3260-\\u327f\\u328a-\\u32b0\\u32c0-\\u32fe\\u3300-\\u33ff\\u4dc0-\\u4dff\\ua490-\\ua4c6\\ua828-\\ua82b\\ua836\\ua837\\ua839\\uaa77-\\uaa79\\ufdfd\\uffe4\\uffe8\\uffed\\uffee\\ufffc\\ufffd",astral:"\\ud800[\\udd37-\\udd3f\\udd79-\\udd89\\udd8c-\\udd8e\\udd90-\\udd9b\\udda0\\uddd0-\\uddfc]|\\ud802[\\udc77\\udc78\\udec8]|\\ud805\\udf3f|\\ud81a[\\udf3c-\\udf3f\\udf45]|\\ud82f\\udc9c|\\ud834[\\udc00-\\udcf5\\udd00-\\udd26\\udd29-\\udd64\\udd6a-\\udd6c\\udd83\\udd84\\udd8c-\\udda9\\uddae-\\udde8\\ude00-\\ude41\\ude45\\udf00-\\udf56]|\\ud836[\\udc00-\\uddff\\ude37-\\ude3a\\ude6d-\\ude74\\ude76-\\ude83\\ude85\\ude86]|\\ud83c[\\udc00-\\udc2b\\udc30-\\udc93\\udca0-\\udcae\\udcb1-\\udcbf\\udcc1-\\udccf\\udcd1-\\udcf5\\udd10-\\udd2e\\udd30-\\udd6b\\udd70-\\uddac\\udde6-\\ude02\\ude10-\\ude3b\\ude40-\\ude48\\ude50\\ude51\\udf00-\\udffa]|\\ud83d[\\udc00-\\uded2\\udee0-\\udeec\\udef0-\\udef6\\udf00-\\udf73\\udf80-\\udfd4]|\\ud83e[\\udc00-\\udc0b\\udc10-\\udc47\\udc50-\\udc59\\udc60-\\udc87\\udc90-\\udcad\\udd10-\\udd1e\\udd20-\\udd27\\udd30\\udd33-\\udd3e\\udd40-\\udd4b\\udd50-\\udd5e\\udd80-\\udd91\\uddc0]"},{name:"Z",alias:"Separator",bmp:" \\xa0\\u1680\\u2000-\\u200a\\u2028\\u2029\\u202f\\u205f\\u3000"},{name:"Zl",alias:"Line_Separator",bmp:"\\u2028"},{name:"Zp",alias:"Paragraph_Separator",bmp:"\\u2029"},{name:"Zs",alias:"Space_Separator",bmp:" \\xa0\\u1680\\u2000-\\u200a\\u202f\\u205f\\u3000"}])}},{}],6:[function(require,module,exports){module.exports=function(XRegExp){if(!XRegExp.addUnicodeData)throw new ReferenceError("Unicode Base must be loaded before Unicode Properties");var unicodeData=[{name:"ASCII",bmp:"\\0-\\x7f"},{name:"Alphabetic",bmp:"A-Za-z\\xaa\\xb5\\xba\\xc0-\\xd6\\xd8-\\xf6\\xf8-\\u02c1\\u02c6-\\u02d1\\u02e0-\\u02e4\\u02ec\\u02ee\\u0345\\u0370-\\u0374\\u0376\\u0377\\u037a-\\u037d\\u037f\\u0386\\u0388-\\u038a\\u038c\\u038e-\\u03a1\\u03a3-\\u03f5\\u03f7-\\u0481\\u048a-\\u052f\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05b0-\\u05bd\\u05bf\\u05c1\\u05c2\\u05c4\\u05c5\\u05c7\\u05d0-\\u05ea\\u05f0-\\u05f2\\u0610-\\u061a\\u0620-\\u0657\\u0659-\\u065f\\u066e-\\u06d3\\u06d5-\\u06dc\\u06e1-\\u06e8\\u06ed-\\u06ef\\u06fa-\\u06fc\\u06ff\\u0710-\\u073f\\u074d-\\u07b1\\u07ca-\\u07ea\\u07f4\\u07f5\\u07fa\\u0800-\\u0817\\u081a-\\u082c\\u0840-\\u0858\\u08a0-\\u08b4\\u08b6-\\u08bd\\u08d4-\\u08df\\u08e3-\\u08e9\\u08f0-\\u093b\\u093d-\\u094c\\u094e-\\u0950\\u0955-\\u0963\\u0971-\\u0983\\u0985-\\u098c\\u098f\\u0990\\u0993-\\u09a8\\u09aa-\\u09b0\\u09b2\\u09b6-\\u09b9\\u09bd-\\u09c4\\u09c7\\u09c8\\u09cb\\u09cc\\u09ce\\u09d7\\u09dc\\u09dd\\u09df-\\u09e3\\u09f0\\u09f1\\u0a01-\\u0a03\\u0a05-\\u0a0a\\u0a0f\\u0a10\\u0a13-\\u0a28\\u0a2a-\\u0a30\\u0a32\\u0a33\\u0a35\\u0a36\\u0a38\\u0a39\\u0a3e-\\u0a42\\u0a47\\u0a48\\u0a4b\\u0a4c\\u0a51\\u0a59-\\u0a5c\\u0a5e\\u0a70-\\u0a75\\u0a81-\\u0a83\\u0a85-\\u0a8d\\u0a8f-\\u0a91\\u0a93-\\u0aa8\\u0aaa-\\u0ab0\\u0ab2\\u0ab3\\u0ab5-\\u0ab9\\u0abd-\\u0ac5\\u0ac7-\\u0ac9\\u0acb\\u0acc\\u0ad0\\u0ae0-\\u0ae3\\u0af9\\u0b01-\\u0b03\\u0b05-\\u0b0c\\u0b0f\\u0b10\\u0b13-\\u0b28\\u0b2a-\\u0b30\\u0b32\\u0b33\\u0b35-\\u0b39\\u0b3d-\\u0b44\\u0b47\\u0b48\\u0b4b\\u0b4c\\u0b56\\u0b57\\u0b5c\\u0b5d\\u0b5f-\\u0b63\\u0b71\\u0b82\\u0b83\\u0b85-\\u0b8a\\u0b8e-\\u0b90\\u0b92-\\u0b95\\u0b99\\u0b9a\\u0b9c\\u0b9e\\u0b9f\\u0ba3\\u0ba4\\u0ba8-\\u0baa\\u0bae-\\u0bb9\\u0bbe-\\u0bc2\\u0bc6-\\u0bc8\\u0bca-\\u0bcc\\u0bd0\\u0bd7\\u0c00-\\u0c03\\u0c05-\\u0c0c\\u0c0e-\\u0c10\\u0c12-\\u0c28\\u0c2a-\\u0c39\\u0c3d-\\u0c44\\u0c46-\\u0c48\\u0c4a-\\u0c4c\\u0c55\\u0c56\\u0c58-\\u0c5a\\u0c60-\\u0c63\\u0c80-\\u0c83\\u0c85-\\u0c8c\\u0c8e-\\u0c90\\u0c92-\\u0ca8\\u0caa-\\u0cb3\\u0cb5-\\u0cb9\\u0cbd-\\u0cc4\\u0cc6-\\u0cc8\\u0cca-\\u0ccc\\u0cd5\\u0cd6\\u0cde\\u0ce0-\\u0ce3\\u0cf1\\u0cf2\\u0d01-\\u0d03\\u0d05-\\u0d0c\\u0d0e-\\u0d10\\u0d12-\\u0d3a\\u0d3d-\\u0d44\\u0d46-\\u0d48\\u0d4a-\\u0d4c\\u0d4e\\u0d54-\\u0d57\\u0d5f-\\u0d63\\u0d7a-\\u0d7f\\u0d82\\u0d83\\u0d85-\\u0d96\\u0d9a-\\u0db1\\u0db3-\\u0dbb\\u0dbd\\u0dc0-\\u0dc6\\u0dcf-\\u0dd4\\u0dd6\\u0dd8-\\u0ddf\\u0df2\\u0df3\\u0e01-\\u0e3a\\u0e40-\\u0e46\\u0e4d\\u0e81\\u0e82\\u0e84\\u0e87\\u0e88\\u0e8a\\u0e8d\\u0e94-\\u0e97\\u0e99-\\u0e9f\\u0ea1-\\u0ea3\\u0ea5\\u0ea7\\u0eaa\\u0eab\\u0ead-\\u0eb9\\u0ebb-\\u0ebd\\u0ec0-\\u0ec4\\u0ec6\\u0ecd\\u0edc-\\u0edf\\u0f00\\u0f40-\\u0f47\\u0f49-\\u0f6c\\u0f71-\\u0f81\\u0f88-\\u0f97\\u0f99-\\u0fbc\\u1000-\\u1036\\u1038\\u103b-\\u103f\\u1050-\\u1062\\u1065-\\u1068\\u106e-\\u1086\\u108e\\u109c\\u109d\\u10a0-\\u10c5\\u10c7\\u10cd\\u10d0-\\u10fa\\u10fc-\\u1248\\u124a-\\u124d\\u1250-\\u1256\\u1258\\u125a-\\u125d\\u1260-\\u1288\\u128a-\\u128d\\u1290-\\u12b0\\u12b2-\\u12b5\\u12b8-\\u12be\\u12c0\\u12c2-\\u12c5\\u12c8-\\u12d6\\u12d8-\\u1310\\u1312-\\u1315\\u1318-\\u135a\\u135f\\u1380-\\u138f\\u13a0-\\u13f5\\u13f8-\\u13fd\\u1401-\\u166c\\u166f-\\u167f\\u1681-\\u169a\\u16a0-\\u16ea\\u16ee-\\u16f8\\u1700-\\u170c\\u170e-\\u1713\\u1720-\\u1733\\u1740-\\u1753\\u1760-\\u176c\\u176e-\\u1770\\u1772\\u1773\\u1780-\\u17b3\\u17b6-\\u17c8\\u17d7\\u17dc\\u1820-\\u1877\\u1880-\\u18aa\\u18b0-\\u18f5\\u1900-\\u191e\\u1920-\\u192b\\u1930-\\u1938\\u1950-\\u196d\\u1970-\\u1974\\u1980-\\u19ab\\u19b0-\\u19c9\\u1a00-\\u1a1b\\u1a20-\\u1a5e\\u1a61-\\u1a74\\u1aa7\\u1b00-\\u1b33\\u1b35-\\u1b43\\u1b45-\\u1b4b\\u1b80-\\u1ba9\\u1bac-\\u1baf\\u1bba-\\u1be5\\u1be7-\\u1bf1\\u1c00-\\u1c35\\u1c4d-\\u1c4f\\u1c5a-\\u1c7d\\u1c80-\\u1c88\\u1ce9-\\u1cec\\u1cee-\\u1cf3\\u1cf5\\u1cf6\\u1d00-\\u1dbf\\u1de7-\\u1df4\\u1e00-\\u1f15\\u1f18-\\u1f1d\\u1f20-\\u1f45\\u1f48-\\u1f4d\\u1f50-\\u1f57\\u1f59\\u1f5b\\u1f5d\\u1f5f-\\u1f7d\\u1f80-\\u1fb4\\u1fb6-\\u1fbc\\u1fbe\\u1fc2-\\u1fc4\\u1fc6-\\u1fcc\\u1fd0-\\u1fd3\\u1fd6-\\u1fdb\\u1fe0-\\u1fec\\u1ff2-\\u1ff4\\u1ff6-\\u1ffc\\u2071\\u207f\\u2090-\\u209c\\u2102\\u2107\\u210a-\\u2113\\u2115\\u2119-\\u211d\\u2124\\u2126\\u2128\\u212a-\\u212d\\u212f-\\u2139\\u213c-\\u213f\\u2145-\\u2149\\u214e\\u2160-\\u2188\\u24b6-\\u24e9\\u2c00-\\u2c2e\\u2c30-\\u2c5e\\u2c60-\\u2ce4\\u2ceb-\\u2cee\\u2cf2\\u2cf3\\u2d00-\\u2d25\\u2d27\\u2d2d\\u2d30-\\u2d67\\u2d6f\\u2d80-\\u2d96\\u2da0-\\u2da6\\u2da8-\\u2dae\\u2db0-\\u2db6\\u2db8-\\u2dbe\\u2dc0-\\u2dc6\\u2dc8-\\u2dce\\u2dd0-\\u2dd6\\u2dd8-\\u2dde\\u2de0-\\u2dff\\u2e2f\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303c\\u3041-\\u3096\\u309d-\\u309f\\u30a1-\\u30fa\\u30fc-\\u30ff\\u3105-\\u312d\\u3131-\\u318e\\u31a0-\\u31ba\\u31f0-\\u31ff\\u3400-\\u4db5\\u4e00-\\u9fd5\\ua000-\\ua48c\\ua4d0-\\ua4fd\\ua500-\\ua60c\\ua610-\\ua61f\\ua62a\\ua62b\\ua640-\\ua66e\\ua674-\\ua67b\\ua67f-\\ua6ef\\ua717-\\ua71f\\ua722-\\ua788\\ua78b-\\ua7ae\\ua7b0-\\ua7b7\\ua7f7-\\ua801\\ua803-\\ua805\\ua807-\\ua80a\\ua80c-\\ua827\\ua840-\\ua873\\ua880-\\ua8c3\\ua8c5\\ua8f2-\\ua8f7\\ua8fb\\ua8fd\\ua90a-\\ua92a\\ua930-\\ua952\\ua960-\\ua97c\\ua980-\\ua9b2\\ua9b4-\\ua9bf\\ua9cf\\ua9e0-\\ua9e4\\ua9e6-\\ua9ef\\ua9fa-\\ua9fe\\uaa00-\\uaa36\\uaa40-\\uaa4d\\uaa60-\\uaa76\\uaa7a\\uaa7e-\\uaabe\\uaac0\\uaac2\\uaadb-\\uaadd\\uaae0-\\uaaef\\uaaf2-\\uaaf5\\uab01-\\uab06\\uab09-\\uab0e\\uab11-\\uab16\\uab20-\\uab26\\uab28-\\uab2e\\uab30-\\uab5a\\uab5c-\\uab65\\uab70-\\uabea\\uac00-\\ud7a3\\ud7b0-\\ud7c6\\ud7cb-\\ud7fb\\uf900-\\ufa6d\\ufa70-\\ufad9\\ufb00-\\ufb06\\ufb13-\\ufb17\\ufb1d-\\ufb28\\ufb2a-\\ufb36\\ufb38-\\ufb3c\\ufb3e\\ufb40\\ufb41\\ufb43\\ufb44\\ufb46-\\ufbb1\\ufbd3-\\ufd3d\\ufd50-\\ufd8f\\ufd92-\\ufdc7\\ufdf0-\\ufdfb\\ufe70-\\ufe74\\ufe76-\\ufefc\\uff21-\\uff3a\\uff41-\\uff5a\\uff66-\\uffbe\\uffc2-\\uffc7\\uffca-\\uffcf\\uffd2-\\uffd7\\uffda-\\uffdc",astral:"\\ud800[\\udc00-\\udc0b\\udc0d-\\udc26\\udc28-\\udc3a\\udc3c\\udc3d\\udc3f-\\udc4d\\udc50-\\udc5d\\udc80-\\udcfa\\udd40-\\udd74\\ude80-\\ude9c\\udea0-\\uded0\\udf00-\\udf1f\\udf30-\\udf4a\\udf50-\\udf7a\\udf80-\\udf9d\\udfa0-\\udfc3\\udfc8-\\udfcf\\udfd1-\\udfd5]|\\ud801[\\udc00-\\udc9d\\udcb0-\\udcd3\\udcd8-\\udcfb\\udd00-\\udd27\\udd30-\\udd63\\ude00-\\udf36\\udf40-\\udf55\\udf60-\\udf67]|\\ud802[\\udc00-\\udc05\\udc08\\udc0a-\\udc35\\udc37\\udc38\\udc3c\\udc3f-\\udc55\\udc60-\\udc76\\udc80-\\udc9e\\udce0-\\udcf2\\udcf4\\udcf5\\udd00-\\udd15\\udd20-\\udd39\\udd80-\\uddb7\\uddbe\\uddbf\\ude00-\\ude03\\ude05\\ude06\\ude0c-\\ude13\\ude15-\\ude17\\ude19-\\ude33\\ude60-\\ude7c\\ude80-\\ude9c\\udec0-\\udec7\\udec9-\\udee4\\udf00-\\udf35\\udf40-\\udf55\\udf60-\\udf72\\udf80-\\udf91]|\\ud803[\\udc00-\\udc48\\udc80-\\udcb2\\udcc0-\\udcf2]|\\ud804[\\udc00-\\udc45\\udc82-\\udcb8\\udcd0-\\udce8\\udd00-\\udd32\\udd50-\\udd72\\udd76\\udd80-\\uddbf\\uddc1-\\uddc4\\uddda\\udddc\\ude00-\\ude11\\ude13-\\ude34\\ude37\\ude3e\\ude80-\\ude86\\ude88\\ude8a-\\ude8d\\ude8f-\\ude9d\\ude9f-\\udea8\\udeb0-\\udee8\\udf00-\\udf03\\udf05-\\udf0c\\udf0f\\udf10\\udf13-\\udf28\\udf2a-\\udf30\\udf32\\udf33\\udf35-\\udf39\\udf3d-\\udf44\\udf47\\udf48\\udf4b\\udf4c\\udf50\\udf57\\udf5d-\\udf63]|\\ud805[\\udc00-\\udc41\\udc43-\\udc45\\udc47-\\udc4a\\udc80-\\udcc1\\udcc4\\udcc5\\udcc7\\udd80-\\uddb5\\uddb8-\\uddbe\\uddd8-\\udddd\\ude00-\\ude3e\\ude40\\ude44\\ude80-\\udeb5\\udf00-\\udf19\\udf1d-\\udf2a]|\\ud806[\\udca0-\\udcdf\\udcff\\udec0-\\udef8]|\\ud807[\\udc00-\\udc08\\udc0a-\\udc36\\udc38-\\udc3e\\udc40\\udc72-\\udc8f\\udc92-\\udca7\\udca9-\\udcb6]|\\ud808[\\udc00-\\udf99]|\\ud809[\\udc00-\\udc6e\\udc80-\\udd43]|[\\ud80c\\ud81c-\\ud820\\ud840-\\ud868\\ud86a-\\ud86c\\ud86f-\\ud872][\\udc00-\\udfff]|\\ud80d[\\udc00-\\udc2e]|\\ud811[\\udc00-\\ude46]|\\ud81a[\\udc00-\\ude38\\ude40-\\ude5e\\uded0-\\udeed\\udf00-\\udf36\\udf40-\\udf43\\udf63-\\udf77\\udf7d-\\udf8f]|\\ud81b[\\udf00-\\udf44\\udf50-\\udf7e\\udf93-\\udf9f\\udfe0]|\\ud821[\\udc00-\\udfec]|\\ud822[\\udc00-\\udef2]|\\ud82c[\\udc00\\udc01]|\\ud82f[\\udc00-\\udc6a\\udc70-\\udc7c\\udc80-\\udc88\\udc90-\\udc99\\udc9e]|\\ud835[\\udc00-\\udc54\\udc56-\\udc9c\\udc9e\\udc9f\\udca2\\udca5\\udca6\\udca9-\\udcac\\udcae-\\udcb9\\udcbb\\udcbd-\\udcc3\\udcc5-\\udd05\\udd07-\\udd0a\\udd0d-\\udd14\\udd16-\\udd1c\\udd1e-\\udd39\\udd3b-\\udd3e\\udd40-\\udd44\\udd46\\udd4a-\\udd50\\udd52-\\udea5\\udea8-\\udec0\\udec2-\\udeda\\udedc-\\udefa\\udefc-\\udf14\\udf16-\\udf34\\udf36-\\udf4e\\udf50-\\udf6e\\udf70-\\udf88\\udf8a-\\udfa8\\udfaa-\\udfc2\\udfc4-\\udfcb]|\\ud838[\\udc00-\\udc06\\udc08-\\udc18\\udc1b-\\udc21\\udc23\\udc24\\udc26-\\udc2a]|\\ud83a[\\udc00-\\udcc4\\udd00-\\udd43\\udd47]|\\ud83b[\\ude00-\\ude03\\ude05-\\ude1f\\ude21\\ude22\\ude24\\ude27\\ude29-\\ude32\\ude34-\\ude37\\ude39\\ude3b\\ude42\\ude47\\ude49\\ude4b\\ude4d-\\ude4f\\ude51\\ude52\\ude54\\ude57\\ude59\\ude5b\\ude5d\\ude5f\\ude61\\ude62\\ude64\\ude67-\\ude6a\\ude6c-\\ude72\\ude74-\\ude77\\ude79-\\ude7c\\ude7e\\ude80-\\ude89\\ude8b-\\ude9b\\udea1-\\udea3\\udea5-\\udea9\\udeab-\\udebb]|\\ud83c[\\udd30-\\udd49\\udd50-\\udd69\\udd70-\\udd89]|\\ud869[\\udc00-\\uded6\\udf00-\\udfff]|\\ud86d[\\udc00-\\udf34\\udf40-\\udfff]|\\ud86e[\\udc00-\\udc1d\\udc20-\\udfff]|\\ud873[\\udc00-\\udea1]|\\ud87e[\\udc00-\\ude1d]"},{name:"Any",isBmpLast:!0,bmp:"\\0-\\uffff",astral:"[\\ud800-\\udbff][\\udc00-\\udfff]"},{name:"Default_Ignorable_Code_Point",bmp:"\\xad\\u034f\\u061c\\u115f\\u1160\\u17b4\\u17b5\\u180b-\\u180e\\u200b-\\u200f\\u202a-\\u202e\\u2060-\\u206f\\u3164\\ufe00-\\ufe0f\\ufeff\\uffa0\\ufff0-\\ufff8",astral:"\\ud82f[\\udca0-\\udca3]|\\ud834[\\udd73-\\udd7a]|[\\udb40-\\udb43][\\udc00-\\udfff]"},{name:"Lowercase",bmp:"a-z\\xaa\\xb5\\xba\\xdf-\\xf6\\xf8-\\xff\\u0101\\u0103\\u0105\\u0107\\u0109\\u010b\\u010d\\u010f\\u0111\\u0113\\u0115\\u0117\\u0119\\u011b\\u011d\\u011f\\u0121\\u0123\\u0125\\u0127\\u0129\\u012b\\u012d\\u012f\\u0131\\u0133\\u0135\\u0137\\u0138\\u013a\\u013c\\u013e\\u0140\\u0142\\u0144\\u0146\\u0148\\u0149\\u014b\\u014d\\u014f\\u0151\\u0153\\u0155\\u0157\\u0159\\u015b\\u015d\\u015f\\u0161\\u0163\\u0165\\u0167\\u0169\\u016b\\u016d\\u016f\\u0171\\u0173\\u0175\\u0177\\u017a\\u017c\\u017e-\\u0180\\u0183\\u0185\\u0188\\u018c\\u018d\\u0192\\u0195\\u0199-\\u019b\\u019e\\u01a1\\u01a3\\u01a5\\u01a8\\u01aa\\u01ab\\u01ad\\u01b0\\u01b4\\u01b6\\u01b9\\u01ba\\u01bd-\\u01bf\\u01c6\\u01c9\\u01cc\\u01ce\\u01d0\\u01d2\\u01d4\\u01d6\\u01d8\\u01da\\u01dc\\u01dd\\u01df\\u01e1\\u01e3\\u01e5\\u01e7\\u01e9\\u01eb\\u01ed\\u01ef\\u01f0\\u01f3\\u01f5\\u01f9\\u01fb\\u01fd\\u01ff\\u0201\\u0203\\u0205\\u0207\\u0209\\u020b\\u020d\\u020f\\u0211\\u0213\\u0215\\u0217\\u0219\\u021b\\u021d\\u021f\\u0221\\u0223\\u0225\\u0227\\u0229\\u022b\\u022d\\u022f\\u0231\\u0233-\\u0239\\u023c\\u023f\\u0240\\u0242\\u0247\\u0249\\u024b\\u024d\\u024f-\\u0293\\u0295-\\u02b8\\u02c0\\u02c1\\u02e0-\\u02e4\\u0345\\u0371\\u0373\\u0377\\u037a-\\u037d\\u0390\\u03ac-\\u03ce\\u03d0\\u03d1\\u03d5-\\u03d7\\u03d9\\u03db\\u03dd\\u03df\\u03e1\\u03e3\\u03e5\\u03e7\\u03e9\\u03eb\\u03ed\\u03ef-\\u03f3\\u03f5\\u03f8\\u03fb\\u03fc\\u0430-\\u045f\\u0461\\u0463\\u0465\\u0467\\u0469\\u046b\\u046d\\u046f\\u0471\\u0473\\u0475\\u0477\\u0479\\u047b\\u047d\\u047f\\u0481\\u048b\\u048d\\u048f\\u0491\\u0493\\u0495\\u0497\\u0499\\u049b\\u049d\\u049f\\u04a1\\u04a3\\u04a5\\u04a7\\u04a9\\u04ab\\u04ad\\u04af\\u04b1\\u04b3\\u04b5\\u04b7\\u04b9\\u04bb\\u04bd\\u04bf\\u04c2\\u04c4\\u04c6\\u04c8\\u04ca\\u04cc\\u04ce\\u04cf\\u04d1\\u04d3\\u04d5\\u04d7\\u04d9\\u04db\\u04dd\\u04df\\u04e1\\u04e3\\u04e5\\u04e7\\u04e9\\u04eb\\u04ed\\u04ef\\u04f1\\u04f3\\u04f5\\u04f7\\u04f9\\u04fb\\u04fd\\u04ff\\u0501\\u0503\\u0505\\u0507\\u0509\\u050b\\u050d\\u050f\\u0511\\u0513\\u0515\\u0517\\u0519\\u051b\\u051d\\u051f\\u0521\\u0523\\u0525\\u0527\\u0529\\u052b\\u052d\\u052f\\u0561-\\u0587\\u13f8-\\u13fd\\u1c80-\\u1c88\\u1d00-\\u1dbf\\u1e01\\u1e03\\u1e05\\u1e07\\u1e09\\u1e0b\\u1e0d\\u1e0f\\u1e11\\u1e13\\u1e15\\u1e17\\u1e19\\u1e1b\\u1e1d\\u1e1f\\u1e21\\u1e23\\u1e25\\u1e27\\u1e29\\u1e2b\\u1e2d\\u1e2f\\u1e31\\u1e33\\u1e35\\u1e37\\u1e39\\u1e3b\\u1e3d\\u1e3f\\u1e41\\u1e43\\u1e45\\u1e47\\u1e49\\u1e4b\\u1e4d\\u1e4f\\u1e51\\u1e53\\u1e55\\u1e57\\u1e59\\u1e5b\\u1e5d\\u1e5f\\u1e61\\u1e63\\u1e65\\u1e67\\u1e69\\u1e6b\\u1e6d\\u1e6f\\u1e71\\u1e73\\u1e75\\u1e77\\u1e79\\u1e7b\\u1e7d\\u1e7f\\u1e81\\u1e83\\u1e85\\u1e87\\u1e89\\u1e8b\\u1e8d\\u1e8f\\u1e91\\u1e93\\u1e95-\\u1e9d\\u1e9f\\u1ea1\\u1ea3\\u1ea5\\u1ea7\\u1ea9\\u1eab\\u1ead\\u1eaf\\u1eb1\\u1eb3\\u1eb5\\u1eb7\\u1eb9\\u1ebb\\u1ebd\\u1ebf\\u1ec1\\u1ec3\\u1ec5\\u1ec7\\u1ec9\\u1ecb\\u1ecd\\u1ecf\\u1ed1\\u1ed3\\u1ed5\\u1ed7\\u1ed9\\u1edb\\u1edd\\u1edf\\u1ee1\\u1ee3\\u1ee5\\u1ee7\\u1ee9\\u1eeb\\u1eed\\u1eef\\u1ef1\\u1ef3\\u1ef5\\u1ef7\\u1ef9\\u1efb\\u1efd\\u1eff-\\u1f07\\u1f10-\\u1f15\\u1f20-\\u1f27\\u1f30-\\u1f37\\u1f40-\\u1f45\\u1f50-\\u1f57\\u1f60-\\u1f67\\u1f70-\\u1f7d\\u1f80-\\u1f87\\u1f90-\\u1f97\\u1fa0-\\u1fa7\\u1fb0-\\u1fb4\\u1fb6\\u1fb7\\u1fbe\\u1fc2-\\u1fc4\\u1fc6\\u1fc7\\u1fd0-\\u1fd3\\u1fd6\\u1fd7\\u1fe0-\\u1fe7\\u1ff2-\\u1ff4\\u1ff6\\u1ff7\\u2071\\u207f\\u2090-\\u209c\\u210a\\u210e\\u210f\\u2113\\u212f\\u2134\\u2139\\u213c\\u213d\\u2146-\\u2149\\u214e\\u2170-\\u217f\\u2184\\u24d0-\\u24e9\\u2c30-\\u2c5e\\u2c61\\u2c65\\u2c66\\u2c68\\u2c6a\\u2c6c\\u2c71\\u2c73\\u2c74\\u2c76-\\u2c7d\\u2c81\\u2c83\\u2c85\\u2c87\\u2c89\\u2c8b\\u2c8d\\u2c8f\\u2c91\\u2c93\\u2c95\\u2c97\\u2c99\\u2c9b\\u2c9d\\u2c9f\\u2ca1\\u2ca3\\u2ca5\\u2ca7\\u2ca9\\u2cab\\u2cad\\u2caf\\u2cb1\\u2cb3\\u2cb5\\u2cb7\\u2cb9\\u2cbb\\u2cbd\\u2cbf\\u2cc1\\u2cc3\\u2cc5\\u2cc7\\u2cc9\\u2ccb\\u2ccd\\u2ccf\\u2cd1\\u2cd3\\u2cd5\\u2cd7\\u2cd9\\u2cdb\\u2cdd\\u2cdf\\u2ce1\\u2ce3\\u2ce4\\u2cec\\u2cee\\u2cf3\\u2d00-\\u2d25\\u2d27\\u2d2d\\ua641\\ua643\\ua645\\ua647\\ua649\\ua64b\\ua64d\\ua64f\\ua651\\ua653\\ua655\\ua657\\ua659\\ua65b\\ua65d\\ua65f\\ua661\\ua663\\ua665\\ua667\\ua669\\ua66b\\ua66d\\ua681\\ua683\\ua685\\ua687\\ua689\\ua68b\\ua68d\\ua68f\\ua691\\ua693\\ua695\\ua697\\ua699\\ua69b-\\ua69d\\ua723\\ua725\\ua727\\ua729\\ua72b\\ua72d\\ua72f-\\ua731\\ua733\\ua735\\ua737\\ua739\\ua73b\\ua73d\\ua73f\\ua741\\ua743\\ua745\\ua747\\ua749\\ua74b\\ua74d\\ua74f\\ua751\\ua753\\ua755\\ua757\\ua759\\ua75b\\ua75d\\ua75f\\ua761\\ua763\\ua765\\ua767\\ua769\\ua76b\\ua76d\\ua76f-\\ua778\\ua77a\\ua77c\\ua77f\\ua781\\ua783\\ua785\\ua787\\ua78c\\ua78e\\ua791\\ua793-\\ua795\\ua797\\ua799\\ua79b\\ua79d\\ua79f\\ua7a1\\ua7a3\\ua7a5\\ua7a7\\ua7a9\\ua7b5\\ua7b7\\ua7f8-\\ua7fa\\uab30-\\uab5a\\uab5c-\\uab65\\uab70-\\uabbf\\ufb00-\\ufb06\\ufb13-\\ufb17\\uff41-\\uff5a",astral:"\\ud801[\\udc28-\\udc4f\\udcd8-\\udcfb]|\\ud803[\\udcc0-\\udcf2]|\\ud806[\\udcc0-\\udcdf]|\\ud835[\\udc1a-\\udc33\\udc4e-\\udc54\\udc56-\\udc67\\udc82-\\udc9b\\udcb6-\\udcb9\\udcbb\\udcbd-\\udcc3\\udcc5-\\udccf\\udcea-\\udd03\\udd1e-\\udd37\\udd52-\\udd6b\\udd86-\\udd9f\\uddba-\\uddd3\\uddee-\\ude07\\ude22-\\ude3b\\ude56-\\ude6f\\ude8a-\\udea5\\udec2-\\udeda\\udedc-\\udee1\\udefc-\\udf14\\udf16-\\udf1b\\udf36-\\udf4e\\udf50-\\udf55\\udf70-\\udf88\\udf8a-\\udf8f\\udfaa-\\udfc2\\udfc4-\\udfc9\\udfcb]|\\ud83a[\\udd22-\\udd43]"},{name:"Noncharacter_Code_Point",bmp:"\\ufdd0-\\ufdef\\ufffe\\uffff",astral:"[\\ud83f\\ud87f\\ud8bf\\ud8ff\\ud93f\\ud97f\\ud9bf\\ud9ff\\uda3f\\uda7f\\udabf\\udaff\\udb3f\\udb7f\\udbbf\\udbff][\\udffe\\udfff]"},{name:"Uppercase",bmp:"A-Z\\xc0-\\xd6\\xd8-\\xde\\u0100\\u0102\\u0104\\u0106\\u0108\\u010a\\u010c\\u010e\\u0110\\u0112\\u0114\\u0116\\u0118\\u011a\\u011c\\u011e\\u0120\\u0122\\u0124\\u0126\\u0128\\u012a\\u012c\\u012e\\u0130\\u0132\\u0134\\u0136\\u0139\\u013b\\u013d\\u013f\\u0141\\u0143\\u0145\\u0147\\u014a\\u014c\\u014e\\u0150\\u0152\\u0154\\u0156\\u0158\\u015a\\u015c\\u015e\\u0160\\u0162\\u0164\\u0166\\u0168\\u016a\\u016c\\u016e\\u0170\\u0172\\u0174\\u0176\\u0178\\u0179\\u017b\\u017d\\u0181\\u0182\\u0184\\u0186\\u0187\\u0189-\\u018b\\u018e-\\u0191\\u0193\\u0194\\u0196-\\u0198\\u019c\\u019d\\u019f\\u01a0\\u01a2\\u01a4\\u01a6\\u01a7\\u01a9\\u01ac\\u01ae\\u01af\\u01b1-\\u01b3\\u01b5\\u01b7\\u01b8\\u01bc\\u01c4\\u01c7\\u01ca\\u01cd\\u01cf\\u01d1\\u01d3\\u01d5\\u01d7\\u01d9\\u01db\\u01de\\u01e0\\u01e2\\u01e4\\u01e6\\u01e8\\u01ea\\u01ec\\u01ee\\u01f1\\u01f4\\u01f6-\\u01f8\\u01fa\\u01fc\\u01fe\\u0200\\u0202\\u0204\\u0206\\u0208\\u020a\\u020c\\u020e\\u0210\\u0212\\u0214\\u0216\\u0218\\u021a\\u021c\\u021e\\u0220\\u0222\\u0224\\u0226\\u0228\\u022a\\u022c\\u022e\\u0230\\u0232\\u023a\\u023b\\u023d\\u023e\\u0241\\u0243-\\u0246\\u0248\\u024a\\u024c\\u024e\\u0370\\u0372\\u0376\\u037f\\u0386\\u0388-\\u038a\\u038c\\u038e\\u038f\\u0391-\\u03a1\\u03a3-\\u03ab\\u03cf\\u03d2-\\u03d4\\u03d8\\u03da\\u03dc\\u03de\\u03e0\\u03e2\\u03e4\\u03e6\\u03e8\\u03ea\\u03ec\\u03ee\\u03f4\\u03f7\\u03f9\\u03fa\\u03fd-\\u042f\\u0460\\u0462\\u0464\\u0466\\u0468\\u046a\\u046c\\u046e\\u0470\\u0472\\u0474\\u0476\\u0478\\u047a\\u047c\\u047e\\u0480\\u048a\\u048c\\u048e\\u0490\\u0492\\u0494\\u0496\\u0498\\u049a\\u049c\\u049e\\u04a0\\u04a2\\u04a4\\u04a6\\u04a8\\u04aa\\u04ac\\u04ae\\u04b0\\u04b2\\u04b4\\u04b6\\u04b8\\u04ba\\u04bc\\u04be\\u04c0\\u04c1\\u04c3\\u04c5\\u04c7\\u04c9\\u04cb\\u04cd\\u04d0\\u04d2\\u04d4\\u04d6\\u04d8\\u04da\\u04dc\\u04de\\u04e0\\u04e2\\u04e4\\u04e6\\u04e8\\u04ea\\u04ec\\u04ee\\u04f0\\u04f2\\u04f4\\u04f6\\u04f8\\u04fa\\u04fc\\u04fe\\u0500\\u0502\\u0504\\u0506\\u0508\\u050a\\u050c\\u050e\\u0510\\u0512\\u0514\\u0516\\u0518\\u051a\\u051c\\u051e\\u0520\\u0522\\u0524\\u0526\\u0528\\u052a\\u052c\\u052e\\u0531-\\u0556\\u10a0-\\u10c5\\u10c7\\u10cd\\u13a0-\\u13f5\\u1e00\\u1e02\\u1e04\\u1e06\\u1e08\\u1e0a\\u1e0c\\u1e0e\\u1e10\\u1e12\\u1e14\\u1e16\\u1e18\\u1e1a\\u1e1c\\u1e1e\\u1e20\\u1e22\\u1e24\\u1e26\\u1e28\\u1e2a\\u1e2c\\u1e2e\\u1e30\\u1e32\\u1e34\\u1e36\\u1e38\\u1e3a\\u1e3c\\u1e3e\\u1e40\\u1e42\\u1e44\\u1e46\\u1e48\\u1e4a\\u1e4c\\u1e4e\\u1e50\\u1e52\\u1e54\\u1e56\\u1e58\\u1e5a\\u1e5c\\u1e5e\\u1e60\\u1e62\\u1e64\\u1e66\\u1e68\\u1e6a\\u1e6c\\u1e6e\\u1e70\\u1e72\\u1e74\\u1e76\\u1e78\\u1e7a\\u1e7c\\u1e7e\\u1e80\\u1e82\\u1e84\\u1e86\\u1e88\\u1e8a\\u1e8c\\u1e8e\\u1e90\\u1e92\\u1e94\\u1e9e\\u1ea0\\u1ea2\\u1ea4\\u1ea6\\u1ea8\\u1eaa\\u1eac\\u1eae\\u1eb0\\u1eb2\\u1eb4\\u1eb6\\u1eb8\\u1eba\\u1ebc\\u1ebe\\u1ec0\\u1ec2\\u1ec4\\u1ec6\\u1ec8\\u1eca\\u1ecc\\u1ece\\u1ed0\\u1ed2\\u1ed4\\u1ed6\\u1ed8\\u1eda\\u1edc\\u1ede\\u1ee0\\u1ee2\\u1ee4\\u1ee6\\u1ee8\\u1eea\\u1eec\\u1eee\\u1ef0\\u1ef2\\u1ef4\\u1ef6\\u1ef8\\u1efa\\u1efc\\u1efe\\u1f08-\\u1f0f\\u1f18-\\u1f1d\\u1f28-\\u1f2f\\u1f38-\\u1f3f\\u1f48-\\u1f4d\\u1f59\\u1f5b\\u1f5d\\u1f5f\\u1f68-\\u1f6f\\u1fb8-\\u1fbb\\u1fc8-\\u1fcb\\u1fd8-\\u1fdb\\u1fe8-\\u1fec\\u1ff8-\\u1ffb\\u2102\\u2107\\u210b-\\u210d\\u2110-\\u2112\\u2115\\u2119-\\u211d\\u2124\\u2126\\u2128\\u212a-\\u212d\\u2130-\\u2133\\u213e\\u213f\\u2145\\u2160-\\u216f\\u2183\\u24b6-\\u24cf\\u2c00-\\u2c2e\\u2c60\\u2c62-\\u2c64\\u2c67\\u2c69\\u2c6b\\u2c6d-\\u2c70\\u2c72\\u2c75\\u2c7e-\\u2c80\\u2c82\\u2c84\\u2c86\\u2c88\\u2c8a\\u2c8c\\u2c8e\\u2c90\\u2c92\\u2c94\\u2c96\\u2c98\\u2c9a\\u2c9c\\u2c9e\\u2ca0\\u2ca2\\u2ca4\\u2ca6\\u2ca8\\u2caa\\u2cac\\u2cae\\u2cb0\\u2cb2\\u2cb4\\u2cb6\\u2cb8\\u2cba\\u2cbc\\u2cbe\\u2cc0\\u2cc2\\u2cc4\\u2cc6\\u2cc8\\u2cca\\u2ccc\\u2cce\\u2cd0\\u2cd2\\u2cd4\\u2cd6\\u2cd8\\u2cda\\u2cdc\\u2cde\\u2ce0\\u2ce2\\u2ceb\\u2ced\\u2cf2\\ua640\\ua642\\ua644\\ua646\\ua648\\ua64a\\ua64c\\ua64e\\ua650\\ua652\\ua654\\ua656\\ua658\\ua65a\\ua65c\\ua65e\\ua660\\ua662\\ua664\\ua666\\ua668\\ua66a\\ua66c\\ua680\\ua682\\ua684\\ua686\\ua688\\ua68a\\ua68c\\ua68e\\ua690\\ua692\\ua694\\ua696\\ua698\\ua69a\\ua722\\ua724\\ua726\\ua728\\ua72a\\ua72c\\ua72e\\ua732\\ua734\\ua736\\ua738\\ua73a\\ua73c\\ua73e\\ua740\\ua742\\ua744\\ua746\\ua748\\ua74a\\ua74c\\ua74e\\ua750\\ua752\\ua754\\ua756\\ua758\\ua75a\\ua75c\\ua75e\\ua760\\ua762\\ua764\\ua766\\ua768\\ua76a\\ua76c\\ua76e\\ua779\\ua77b\\ua77d\\ua77e\\ua780\\ua782\\ua784\\ua786\\ua78b\\ua78d\\ua790\\ua792\\ua796\\ua798\\ua79a\\ua79c\\ua79e\\ua7a0\\ua7a2\\ua7a4\\ua7a6\\ua7a8\\ua7aa-\\ua7ae\\ua7b0-\\ua7b4\\ua7b6\\uff21-\\uff3a",astral:"\\ud801[\\udc00-\\udc27\\udcb0-\\udcd3]|\\ud803[\\udc80-\\udcb2]|\\ud806[\\udca0-\\udcbf]|\\ud835[\\udc00-\\udc19\\udc34-\\udc4d\\udc68-\\udc81\\udc9c\\udc9e\\udc9f\\udca2\\udca5\\udca6\\udca9-\\udcac\\udcae-\\udcb5\\udcd0-\\udce9\\udd04\\udd05\\udd07-\\udd0a\\udd0d-\\udd14\\udd16-\\udd1c\\udd38\\udd39\\udd3b-\\udd3e\\udd40-\\udd44\\udd46\\udd4a-\\udd50\\udd6c-\\udd85\\udda0-\\uddb9\\uddd4-\\udded\\ude08-\\ude21\\ude3c-\\ude55\\ude70-\\ude89\\udea8-\\udec0\\udee2-\\udefa\\udf1c-\\udf34\\udf56-\\udf6e\\udf90-\\udfa8\\udfca]|\\ud83a[\\udd00-\\udd21]|\\ud83c[\\udd30-\\udd49\\udd50-\\udd69\\udd70-\\udd89]"},{name:"White_Space",bmp:"\\t-\\r \\x85\\xa0\\u1680\\u2000-\\u200a\\u2028\\u2029\\u202f\\u205f\\u3000"}];unicodeData.push({name:"Assigned",inverseOf:"Cn"}),XRegExp.addUnicodeData(unicodeData)}},{}],7:[function(require,module,exports){module.exports=function(XRegExp){if(!XRegExp.addUnicodeData)throw new ReferenceError("Unicode Base must be loaded before Unicode Scripts");XRegExp.addUnicodeData([{name:"Adlam",astral:"\\ud83a[\\udd00-\\udd4a\\udd50-\\udd59\\udd5e\\udd5f]"},{name:"Ahom",astral:"\\ud805[\\udf00-\\udf19\\udf1d-\\udf2b\\udf30-\\udf3f]"},{name:"Anatolian_Hieroglyphs",astral:"\\ud811[\\udc00-\\ude46]"},{name:"Arabic",bmp:"\\u0600-\\u0604\\u0606-\\u060b\\u060d-\\u061a\\u061e\\u0620-\\u063f\\u0641-\\u064a\\u0656-\\u066f\\u0671-\\u06dc\\u06de-\\u06ff\\u0750-\\u077f\\u08a0-\\u08b4\\u08b6-\\u08bd\\u08d4-\\u08e1\\u08e3-\\u08ff\\ufb50-\\ufbc1\\ufbd3-\\ufd3d\\ufd50-\\ufd8f\\ufd92-\\ufdc7\\ufdf0-\\ufdfd\\ufe70-\\ufe74\\ufe76-\\ufefc",astral:"\\ud803[\\ude60-\\ude7e]|\\ud83b[\\ude00-\\ude03\\ude05-\\ude1f\\ude21\\ude22\\ude24\\ude27\\ude29-\\ude32\\ude34-\\ude37\\ude39\\ude3b\\ude42\\ude47\\ude49\\ude4b\\ude4d-\\ude4f\\ude51\\ude52\\ude54\\ude57\\ude59\\ude5b\\ude5d\\ude5f\\ude61\\ude62\\ude64\\ude67-\\ude6a\\ude6c-\\ude72\\ude74-\\ude77\\ude79-\\ude7c\\ude7e\\ude80-\\ude89\\ude8b-\\ude9b\\udea1-\\udea3\\udea5-\\udea9\\udeab-\\udebb\\udef0\\udef1]"},{name:"Armenian",bmp:"\\u0531-\\u0556\\u0559-\\u055f\\u0561-\\u0587\\u058a\\u058d-\\u058f\\ufb13-\\ufb17"},{name:"Avestan",astral:"\\ud802[\\udf00-\\udf35\\udf39-\\udf3f]"},{name:"Balinese",bmp:"\\u1b00-\\u1b4b\\u1b50-\\u1b7c"},{name:"Bamum",bmp:"\\ua6a0-\\ua6f7",astral:"\\ud81a[\\udc00-\\ude38]"},{name:"Bassa_Vah",astral:"\\ud81a[\\uded0-\\udeed\\udef0-\\udef5]"},{name:"Batak",bmp:"\\u1bc0-\\u1bf3\\u1bfc-\\u1bff"},{name:"Bengali",bmp:"\\u0980-\\u0983\\u0985-\\u098c\\u098f\\u0990\\u0993-\\u09a8\\u09aa-\\u09b0\\u09b2\\u09b6-\\u09b9\\u09bc-\\u09c4\\u09c7\\u09c8\\u09cb-\\u09ce\\u09d7\\u09dc\\u09dd\\u09df-\\u09e3\\u09e6-\\u09fb"},{name:"Bhaiksuki",astral:"\\ud807[\\udc00-\\udc08\\udc0a-\\udc36\\udc38-\\udc45\\udc50-\\udc6c]"},{name:"Bopomofo",bmp:"\\u02ea\\u02eb\\u3105-\\u312d\\u31a0-\\u31ba"},{name:"Brahmi",astral:"\\ud804[\\udc00-\\udc4d\\udc52-\\udc6f\\udc7f]"},{name:"Braille",bmp:"\\u2800-\\u28ff"},{name:"Buginese",bmp:"\\u1a00-\\u1a1b\\u1a1e\\u1a1f"},{name:"Buhid",bmp:"\\u1740-\\u1753"},{name:"Canadian_Aboriginal",bmp:"\\u1400-\\u167f\\u18b0-\\u18f5"},{name:"Carian",astral:"\\ud800[\\udea0-\\uded0]"},{name:"Caucasian_Albanian",astral:"\\ud801[\\udd30-\\udd63\\udd6f]"},{name:"Chakma",astral:"\\ud804[\\udd00-\\udd34\\udd36-\\udd43]"},{name:"Cham",bmp:"\\uaa00-\\uaa36\\uaa40-\\uaa4d\\uaa50-\\uaa59\\uaa5c-\\uaa5f"},{name:"Cherokee",bmp:"\\u13a0-\\u13f5\\u13f8-\\u13fd\\uab70-\\uabbf"},{name:"Common",bmp:"\\0-@\\\\x5B-`\\\\x7B-\\xa9\\xab-\\xb9\\xbb-\\xbf\\xd7\\xf7\\u02b9-\\u02df\\u02e5-\\u02e9\\u02ec-\\u02ff\\u0374\\u037e\\u0385\\u0387\\u0589\\u0605\\u060c\\u061b\\u061c\\u061f\\u0640\\u06dd\\u08e2\\u0964\\u0965\\u0e3f\\u0fd5-\\u0fd8\\u10fb\\u16eb-\\u16ed\\u1735\\u1736\\u1802\\u1803\\u1805\\u1cd3\\u1ce1\\u1ce9-\\u1cec\\u1cee-\\u1cf3\\u1cf5\\u1cf6\\u2000-\\u200b\\u200e-\\u2064\\u2066-\\u2070\\u2074-\\u207e\\u2080-\\u208e\\u20a0-\\u20be\\u2100-\\u2125\\u2127-\\u2129\\u212c-\\u2131\\u2133-\\u214d\\u214f-\\u215f\\u2189-\\u218b\\u2190-\\u23fe\\u2400-\\u2426\\u2440-\\u244a\\u2460-\\u27ff\\u2900-\\u2b73\\u2b76-\\u2b95\\u2b98-\\u2bb9\\u2bbd-\\u2bc8\\u2bca-\\u2bd1\\u2bec-\\u2bef\\u2e00-\\u2e44\\u2ff0-\\u2ffb\\u3000-\\u3004\\u3006\\u3008-\\u3020\\u3030-\\u3037\\u303c-\\u303f\\u309b\\u309c\\u30a0\\u30fb\\u30fc\\u3190-\\u319f\\u31c0-\\u31e3\\u3220-\\u325f\\u327f-\\u32cf\\u3358-\\u33ff\\u4dc0-\\u4dff\\ua700-\\ua721\\ua788-\\ua78a\\ua830-\\ua839\\ua92e\\ua9cf\\uab5b\\ufd3e\\ufd3f\\ufe10-\\ufe19\\ufe30-\\ufe52\\ufe54-\\ufe66\\ufe68-\\ufe6b\\ufeff\\uff01-\\uff20\\uff3b-\\uff40\\uff5b-\\uff65\\uff70\\uff9e\\uff9f\\uffe0-\\uffe6\\uffe8-\\uffee\\ufff9-\\ufffd",astral:"\\ud800[\\udd00-\\udd02\\udd07-\\udd33\\udd37-\\udd3f\\udd90-\\udd9b\\uddd0-\\uddfc\\udee1-\\udefb]|\\ud82f[\\udca0-\\udca3]|\\ud834[\\udc00-\\udcf5\\udd00-\\udd26\\udd29-\\udd66\\udd6a-\\udd7a\\udd83\\udd84\\udd8c-\\udda9\\uddae-\\udde8\\udf00-\\udf56\\udf60-\\udf71]|\\ud835[\\udc00-\\udc54\\udc56-\\udc9c\\udc9e\\udc9f\\udca2\\udca5\\udca6\\udca9-\\udcac\\udcae-\\udcb9\\udcbb\\udcbd-\\udcc3\\udcc5-\\udd05\\udd07-\\udd0a\\udd0d-\\udd14\\udd16-\\udd1c\\udd1e-\\udd39\\udd3b-\\udd3e\\udd40-\\udd44\\udd46\\udd4a-\\udd50\\udd52-\\udea5\\udea8-\\udfcb\\udfce-\\udfff]|\\ud83c[\\udc00-\\udc2b\\udc30-\\udc93\\udca0-\\udcae\\udcb1-\\udcbf\\udcc1-\\udccf\\udcd1-\\udcf5\\udd00-\\udd0c\\udd10-\\udd2e\\udd30-\\udd6b\\udd70-\\uddac\\udde6-\\uddff\\ude01\\ude02\\ude10-\\ude3b\\ude40-\\ude48\\ude50\\ude51\\udf00-\\udfff]|\\ud83d[\\udc00-\\uded2\\udee0-\\udeec\\udef0-\\udef6\\udf00-\\udf73\\udf80-\\udfd4]|\\ud83e[\\udc00-\\udc0b\\udc10-\\udc47\\udc50-\\udc59\\udc60-\\udc87\\udc90-\\udcad\\udd10-\\udd1e\\udd20-\\udd27\\udd30\\udd33-\\udd3e\\udd40-\\udd4b\\udd50-\\udd5e\\udd80-\\udd91\\uddc0]|\\udb40[\\udc01\\udc20-\\udc7f]"},{name:"Coptic",bmp:"\\u03e2-\\u03ef\\u2c80-\\u2cf3\\u2cf9-\\u2cff"},{name:"Cuneiform",astral:"\\ud808[\\udc00-\\udf99]|\\ud809[\\udc00-\\udc6e\\udc70-\\udc74\\udc80-\\udd43]"},{name:"Cypriot",astral:"\\ud802[\\udc00-\\udc05\\udc08\\udc0a-\\udc35\\udc37\\udc38\\udc3c\\udc3f]"},{name:"Cyrillic",bmp:"\\u0400-\\u0484\\u0487-\\u052f\\u1c80-\\u1c88\\u1d2b\\u1d78\\u2de0-\\u2dff\\ua640-\\ua69f\\ufe2e\\ufe2f"},{name:"Deseret",astral:"\\ud801[\\udc00-\\udc4f]"},{name:"Devanagari",bmp:"\\u0900-\\u0950\\u0953-\\u0963\\u0966-\\u097f\\ua8e0-\\ua8fd"},{name:"Duployan",astral:"\\ud82f[\\udc00-\\udc6a\\udc70-\\udc7c\\udc80-\\udc88\\udc90-\\udc99\\udc9c-\\udc9f]"},{name:"Egyptian_Hieroglyphs",astral:"\\ud80c[\\udc00-\\udfff]|\\ud80d[\\udc00-\\udc2e]"},{name:"Elbasan",astral:"\\ud801[\\udd00-\\udd27]"},{name:"Ethiopic",bmp:"\\u1200-\\u1248\\u124a-\\u124d\\u1250-\\u1256\\u1258\\u125a-\\u125d\\u1260-\\u1288\\u128a-\\u128d\\u1290-\\u12b0\\u12b2-\\u12b5\\u12b8-\\u12be\\u12c0\\u12c2-\\u12c5\\u12c8-\\u12d6\\u12d8-\\u1310\\u1312-\\u1315\\u1318-\\u135a\\u135d-\\u137c\\u1380-\\u1399\\u2d80-\\u2d96\\u2da0-\\u2da6\\u2da8-\\u2dae\\u2db0-\\u2db6\\u2db8-\\u2dbe\\u2dc0-\\u2dc6\\u2dc8-\\u2dce\\u2dd0-\\u2dd6\\u2dd8-\\u2dde\\uab01-\\uab06\\uab09-\\uab0e\\uab11-\\uab16\\uab20-\\uab26\\uab28-\\uab2e"},{name:"Georgian",bmp:"\\u10a0-\\u10c5\\u10c7\\u10cd\\u10d0-\\u10fa\\u10fc-\\u10ff\\u2d00-\\u2d25\\u2d27\\u2d2d"},{name:"Glagolitic",bmp:"\\u2c00-\\u2c2e\\u2c30-\\u2c5e",astral:"\\ud838[\\udc00-\\udc06\\udc08-\\udc18\\udc1b-\\udc21\\udc23\\udc24\\udc26-\\udc2a]"},{name:"Gothic",astral:"\\ud800[\\udf30-\\udf4a]"},{name:"Grantha",astral:"\\ud804[\\udf00-\\udf03\\udf05-\\udf0c\\udf0f\\udf10\\udf13-\\udf28\\udf2a-\\udf30\\udf32\\udf33\\udf35-\\udf39\\udf3c-\\udf44\\udf47\\udf48\\udf4b-\\udf4d\\udf50\\udf57\\udf5d-\\udf63\\udf66-\\udf6c\\udf70-\\udf74]"},{name:"Greek",bmp:"\\u0370-\\u0373\\u0375-\\u0377\\u037a-\\u037d\\u037f\\u0384\\u0386\\u0388-\\u038a\\u038c\\u038e-\\u03a1\\u03a3-\\u03e1\\u03f0-\\u03ff\\u1d26-\\u1d2a\\u1d5d-\\u1d61\\u1d66-\\u1d6a\\u1dbf\\u1f00-\\u1f15\\u1f18-\\u1f1d\\u1f20-\\u1f45\\u1f48-\\u1f4d\\u1f50-\\u1f57\\u1f59\\u1f5b\\u1f5d\\u1f5f-\\u1f7d\\u1f80-\\u1fb4\\u1fb6-\\u1fc4\\u1fc6-\\u1fd3\\u1fd6-\\u1fdb\\u1fdd-\\u1fef\\u1ff2-\\u1ff4\\u1ff6-\\u1ffe\\u2126\\uab65",astral:"\\ud800[\\udd40-\\udd8e\\udda0]|\\ud834[\\ude00-\\ude45]"},{name:"Gujarati",bmp:"\\u0a81-\\u0a83\\u0a85-\\u0a8d\\u0a8f-\\u0a91\\u0a93-\\u0aa8\\u0aaa-\\u0ab0\\u0ab2\\u0ab3\\u0ab5-\\u0ab9\\u0abc-\\u0ac5\\u0ac7-\\u0ac9\\u0acb-\\u0acd\\u0ad0\\u0ae0-\\u0ae3\\u0ae6-\\u0af1\\u0af9"},{name:"Gurmukhi",bmp:"\\u0a01-\\u0a03\\u0a05-\\u0a0a\\u0a0f\\u0a10\\u0a13-\\u0a28\\u0a2a-\\u0a30\\u0a32\\u0a33\\u0a35\\u0a36\\u0a38\\u0a39\\u0a3c\\u0a3e-\\u0a42\\u0a47\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a59-\\u0a5c\\u0a5e\\u0a66-\\u0a75"},{name:"Han",bmp:"\\u2e80-\\u2e99\\u2e9b-\\u2ef3\\u2f00-\\u2fd5\\u3005\\u3007\\u3021-\\u3029\\u3038-\\u303b\\u3400-\\u4db5\\u4e00-\\u9fd5\\uf900-\\ufa6d\\ufa70-\\ufad9",astral:"[\\ud840-\\ud868\\ud86a-\\ud86c\\ud86f-\\ud872][\\udc00-\\udfff]|\\ud869[\\udc00-\\uded6\\udf00-\\udfff]|\\ud86d[\\udc00-\\udf34\\udf40-\\udfff]|\\ud86e[\\udc00-\\udc1d\\udc20-\\udfff]|\\ud873[\\udc00-\\udea1]|\\ud87e[\\udc00-\\ude1d]"},{name:"Hangul",bmp:"\\u1100-\\u11ff\\u302e\\u302f\\u3131-\\u318e\\u3200-\\u321e\\u3260-\\u327e\\ua960-\\ua97c\\uac00-\\ud7a3\\ud7b0-\\ud7c6\\ud7cb-\\ud7fb\\uffa0-\\uffbe\\uffc2-\\uffc7\\uffca-\\uffcf\\uffd2-\\uffd7\\uffda-\\uffdc"},{name:"Hanunoo",bmp:"\\u1720-\\u1734"},{name:"Hatran",astral:"\\ud802[\\udce0-\\udcf2\\udcf4\\udcf5\\udcfb-\\udcff]"},{name:"Hebrew",bmp:"\\u0591-\\u05c7\\u05d0-\\u05ea\\u05f0-\\u05f4\\ufb1d-\\ufb36\\ufb38-\\ufb3c\\ufb3e\\ufb40\\ufb41\\ufb43\\ufb44\\ufb46-\\ufb4f"},{name:"Hiragana",bmp:"\\u3041-\\u3096\\u309d-\\u309f",astral:"\\ud82c\\udc01|\\ud83c\\ude00"},{name:"Imperial_Aramaic",astral:"\\ud802[\\udc40-\\udc55\\udc57-\\udc5f]"},{name:"Inherited",bmp:"\\u0300-\\u036f\\u0485\\u0486\\u064b-\\u0655\\u0670\\u0951\\u0952\\u1ab0-\\u1abe\\u1cd0-\\u1cd2\\u1cd4-\\u1ce0\\u1ce2-\\u1ce8\\u1ced\\u1cf4\\u1cf8\\u1cf9\\u1dc0-\\u1df5\\u1dfb-\\u1dff\\u200c\\u200d\\u20d0-\\u20f0\\u302a-\\u302d\\u3099\\u309a\\ufe00-\\ufe0f\\ufe20-\\ufe2d",astral:"\\ud800[\\uddfd\\udee0]|\\ud834[\\udd67-\\udd69\\udd7b-\\udd82\\udd85-\\udd8b\\uddaa-\\uddad]|\\udb40[\\udd00-\\uddef]"},{name:"Inscriptional_Pahlavi",astral:"\\ud802[\\udf60-\\udf72\\udf78-\\udf7f]"},{name:"Inscriptional_Parthian",astral:"\\ud802[\\udf40-\\udf55\\udf58-\\udf5f]"},{name:"Javanese",bmp:"\\ua980-\\ua9cd\\ua9d0-\\ua9d9\\ua9de\\ua9df"},{name:"Kaithi",astral:"\\ud804[\\udc80-\\udcc1]"},{name:"Kannada",bmp:"\\u0c80-\\u0c83\\u0c85-\\u0c8c\\u0c8e-\\u0c90\\u0c92-\\u0ca8\\u0caa-\\u0cb3\\u0cb5-\\u0cb9\\u0cbc-\\u0cc4\\u0cc6-\\u0cc8\\u0cca-\\u0ccd\\u0cd5\\u0cd6\\u0cde\\u0ce0-\\u0ce3\\u0ce6-\\u0cef\\u0cf1\\u0cf2"},{name:"Katakana",bmp:"\\u30a1-\\u30fa\\u30fd-\\u30ff\\u31f0-\\u31ff\\u32d0-\\u32fe\\u3300-\\u3357\\uff66-\\uff6f\\uff71-\\uff9d",astral:"\\ud82c\\udc00"},{name:"Kayah_Li",bmp:"\\ua900-\\ua92d\\ua92f"},{name:"Kharoshthi",astral:"\\ud802[\\ude00-\\ude03\\ude05\\ude06\\ude0c-\\ude13\\ude15-\\ude17\\ude19-\\ude33\\ude38-\\ude3a\\ude3f-\\ude47\\ude50-\\ude58]"},{name:"Khmer",bmp:"\\u1780-\\u17dd\\u17e0-\\u17e9\\u17f0-\\u17f9\\u19e0-\\u19ff"},{name:"Khojki",astral:"\\ud804[\\ude00-\\ude11\\ude13-\\ude3e]"},{name:"Khudawadi",astral:"\\ud804[\\udeb0-\\udeea\\udef0-\\udef9]"},{name:"Lao",bmp:"\\u0e81\\u0e82\\u0e84\\u0e87\\u0e88\\u0e8a\\u0e8d\\u0e94-\\u0e97\\u0e99-\\u0e9f\\u0ea1-\\u0ea3\\u0ea5\\u0ea7\\u0eaa\\u0eab\\u0ead-\\u0eb9\\u0ebb-\\u0ebd\\u0ec0-\\u0ec4\\u0ec6\\u0ec8-\\u0ecd\\u0ed0-\\u0ed9\\u0edc-\\u0edf"},{name:"Latin",bmp:"A-Za-z\\xaa\\xba\\xc0-\\xd6\\xd8-\\xf6\\xf8-\\u02b8\\u02e0-\\u02e4\\u1d00-\\u1d25\\u1d2c-\\u1d5c\\u1d62-\\u1d65\\u1d6b-\\u1d77\\u1d79-\\u1dbe\\u1e00-\\u1eff\\u2071\\u207f\\u2090-\\u209c\\u212a\\u212b\\u2132\\u214e\\u2160-\\u2188\\u2c60-\\u2c7f\\ua722-\\ua787\\ua78b-\\ua7ae\\ua7b0-\\ua7b7\\ua7f7-\\ua7ff\\uab30-\\uab5a\\uab5c-\\uab64\\ufb00-\\ufb06\\uff21-\\uff3a\\uff41-\\uff5a"},{name:"Lepcha",bmp:"\\u1c00-\\u1c37\\u1c3b-\\u1c49\\u1c4d-\\u1c4f"},{name:"Limbu",bmp:"\\u1900-\\u191e\\u1920-\\u192b\\u1930-\\u193b\\u1940\\u1944-\\u194f"},{name:"Linear_A",astral:"\\ud801[\\ude00-\\udf36\\udf40-\\udf55\\udf60-\\udf67]"},{name:"Linear_B",astral:"\\ud800[\\udc00-\\udc0b\\udc0d-\\udc26\\udc28-\\udc3a\\udc3c\\udc3d\\udc3f-\\udc4d\\udc50-\\udc5d\\udc80-\\udcfa]"},{name:"Lisu",bmp:"\\ua4d0-\\ua4ff"},{name:"Lycian",astral:"\\ud800[\\ude80-\\ude9c]"},{name:"Lydian",astral:"\\ud802[\\udd20-\\udd39\\udd3f]"},{name:"Mahajani",astral:"\\ud804[\\udd50-\\udd76]"},{name:"Malayalam",bmp:"\\u0d01-\\u0d03\\u0d05-\\u0d0c\\u0d0e-\\u0d10\\u0d12-\\u0d3a\\u0d3d-\\u0d44\\u0d46-\\u0d48\\u0d4a-\\u0d4f\\u0d54-\\u0d63\\u0d66-\\u0d7f"},{name:"Mandaic",bmp:"\\u0840-\\u085b\\u085e"},{name:"Manichaean",astral:"\\ud802[\\udec0-\\udee6\\udeeb-\\udef6]"},{name:"Marchen",astral:"\\ud807[\\udc70-\\udc8f\\udc92-\\udca7\\udca9-\\udcb6]"},{name:"Meetei_Mayek",bmp:"\\uaae0-\\uaaf6\\uabc0-\\uabed\\uabf0-\\uabf9"},{name:"Mende_Kikakui",astral:"\\ud83a[\\udc00-\\udcc4\\udcc7-\\udcd6]"},{name:"Meroitic_Cursive",astral:"\\ud802[\\udda0-\\uddb7\\uddbc-\\uddcf\\uddd2-\\uddff]"},{name:"Meroitic_Hieroglyphs",astral:"\\ud802[\\udd80-\\udd9f]"},{name:"Miao",astral:"\\ud81b[\\udf00-\\udf44\\udf50-\\udf7e\\udf8f-\\udf9f]"},{name:"Modi",astral:"\\ud805[\\ude00-\\ude44\\ude50-\\ude59]"},{name:"Mongolian",bmp:"\\u1800\\u1801\\u1804\\u1806-\\u180e\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18aa",astral:"\\ud805[\\ude60-\\ude6c]"},{name:"Mro",astral:"\\ud81a[\\ude40-\\ude5e\\ude60-\\ude69\\ude6e\\ude6f]"},{name:"Multani",astral:"\\ud804[\\ude80-\\ude86\\ude88\\ude8a-\\ude8d\\ude8f-\\ude9d\\ude9f-\\udea9]"},{name:"Myanmar",bmp:"\\u1000-\\u109f\\ua9e0-\\ua9fe\\uaa60-\\uaa7f"},{name:"Nabataean",astral:"\\ud802[\\udc80-\\udc9e\\udca7-\\udcaf]"},{name:"New_Tai_Lue",bmp:"\\u1980-\\u19ab\\u19b0-\\u19c9\\u19d0-\\u19da\\u19de\\u19df"},{name:"Newa",astral:"\\ud805[\\udc00-\\udc59\\udc5b\\udc5d]"},{name:"Nko",bmp:"\\u07c0-\\u07fa"},{name:"Ogham",bmp:"\\u1680-\\u169c"},{name:"Ol_Chiki",bmp:"\\u1c50-\\u1c7f"},{name:"Old_Hungarian",astral:"\\ud803[\\udc80-\\udcb2\\udcc0-\\udcf2\\udcfa-\\udcff]"},{name:"Old_Italic",astral:"\\ud800[\\udf00-\\udf23]"},{name:"Old_North_Arabian",astral:"\\ud802[\\ude80-\\ude9f]"},{name:"Old_Permic",astral:"\\ud800[\\udf50-\\udf7a]"},{name:"Old_Persian",astral:"\\ud800[\\udfa0-\\udfc3\\udfc8-\\udfd5]"},{name:"Old_South_Arabian",astral:"\\ud802[\\ude60-\\ude7f]"},{name:"Old_Turkic",astral:"\\ud803[\\udc00-\\udc48]"},{name:"Oriya",bmp:"\\u0b01-\\u0b03\\u0b05-\\u0b0c\\u0b0f\\u0b10\\u0b13-\\u0b28\\u0b2a-\\u0b30\\u0b32\\u0b33\\u0b35-\\u0b39\\u0b3c-\\u0b44\\u0b47\\u0b48\\u0b4b-\\u0b4d\\u0b56\\u0b57\\u0b5c\\u0b5d\\u0b5f-\\u0b63\\u0b66-\\u0b77"},{name:"Osage",astral:"\\ud801[\\udcb0-\\udcd3\\udcd8-\\udcfb]"},{name:"Osmanya",astral:"\\ud801[\\udc80-\\udc9d\\udca0-\\udca9]"},{name:"Pahawh_Hmong",astral:"\\ud81a[\\udf00-\\udf45\\udf50-\\udf59\\udf5b-\\udf61\\udf63-\\udf77\\udf7d-\\udf8f]"},{name:"Palmyrene",astral:"\\ud802[\\udc60-\\udc7f]"},{name:"Pau_Cin_Hau",astral:"\\ud806[\\udec0-\\udef8]"},{name:"Phags_Pa",bmp:"\\ua840-\\ua877"},{name:"Phoenician",astral:"\\ud802[\\udd00-\\udd1b\\udd1f]"},{name:"Psalter_Pahlavi",astral:"\\ud802[\\udf80-\\udf91\\udf99-\\udf9c\\udfa9-\\udfaf]"},{name:"Rejang",bmp:"\\ua930-\\ua953\\ua95f"},{name:"Runic",bmp:"\\u16a0-\\u16ea\\u16ee-\\u16f8"},{name:"Samaritan",bmp:"\\u0800-\\u082d\\u0830-\\u083e"},{name:"Saurashtra",bmp:"\\ua880-\\ua8c5\\ua8ce-\\ua8d9"},{name:"Sharada",astral:"\\ud804[\\udd80-\\uddcd\\uddd0-\\udddf]"},{name:"Shavian",astral:"\\ud801[\\udc50-\\udc7f]"},{name:"Siddham",astral:"\\ud805[\\udd80-\\uddb5\\uddb8-\\udddd]"},{name:"SignWriting",astral:"\\ud836[\\udc00-\\ude8b\\ude9b-\\ude9f\\udea1-\\udeaf]"},{name:"Sinhala",bmp:"\\u0d82\\u0d83\\u0d85-\\u0d96\\u0d9a-\\u0db1\\u0db3-\\u0dbb\\u0dbd\\u0dc0-\\u0dc6\\u0dca\\u0dcf-\\u0dd4\\u0dd6\\u0dd8-\\u0ddf\\u0de6-\\u0def\\u0df2-\\u0df4",astral:"\\ud804[\\udde1-\\uddf4]"},{name:"Sora_Sompeng",astral:"\\ud804[\\udcd0-\\udce8\\udcf0-\\udcf9]"},{name:"Sundanese",bmp:"\\u1b80-\\u1bbf\\u1cc0-\\u1cc7"},{name:"Syloti_Nagri",bmp:"\\ua800-\\ua82b"},{name:"Syriac",bmp:"\\u0700-\\u070d\\u070f-\\u074a\\u074d-\\u074f"},{name:"Tagalog",bmp:"\\u1700-\\u170c\\u170e-\\u1714"},{name:"Tagbanwa",bmp:"\\u1760-\\u176c\\u176e-\\u1770\\u1772\\u1773"},{name:"Tai_Le",bmp:"\\u1950-\\u196d\\u1970-\\u1974"},{name:"Tai_Tham",bmp:"\\u1a20-\\u1a5e\\u1a60-\\u1a7c\\u1a7f-\\u1a89\\u1a90-\\u1a99\\u1aa0-\\u1aad"},{name:"Tai_Viet",bmp:"\\uaa80-\\uaac2\\uaadb-\\uaadf"},{name:"Takri",astral:"\\ud805[\\ude80-\\udeb7\\udec0-\\udec9]"},{name:"Tamil",bmp:"\\u0b82\\u0b83\\u0b85-\\u0b8a\\u0b8e-\\u0b90\\u0b92-\\u0b95\\u0b99\\u0b9a\\u0b9c\\u0b9e\\u0b9f\\u0ba3\\u0ba4\\u0ba8-\\u0baa\\u0bae-\\u0bb9\\u0bbe-\\u0bc2\\u0bc6-\\u0bc8\\u0bca-\\u0bcd\\u0bd0\\u0bd7\\u0be6-\\u0bfa"},{name:"Tangut",astral:"\\ud81b\\udfe0|[\\ud81c-\\ud820][\\udc00-\\udfff]|\\ud821[\\udc00-\\udfec]|\\ud822[\\udc00-\\udef2]"},{name:"Telugu",bmp:"\\u0c00-\\u0c03\\u0c05-\\u0c0c\\u0c0e-\\u0c10\\u0c12-\\u0c28\\u0c2a-\\u0c39\\u0c3d-\\u0c44\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55\\u0c56\\u0c58-\\u0c5a\\u0c60-\\u0c63\\u0c66-\\u0c6f\\u0c78-\\u0c7f"},{name:"Thaana",bmp:"\\u0780-\\u07b1"},{name:"Thai",bmp:"\\u0e01-\\u0e3a\\u0e40-\\u0e5b"},{name:"Tibetan",bmp:"\\u0f00-\\u0f47\\u0f49-\\u0f6c\\u0f71-\\u0f97\\u0f99-\\u0fbc\\u0fbe-\\u0fcc\\u0fce-\\u0fd4\\u0fd9\\u0fda"},{name:"Tifinagh",bmp:"\\u2d30-\\u2d67\\u2d6f\\u2d70\\u2d7f"},{name:"Tirhuta",astral:"\\ud805[\\udc80-\\udcc7\\udcd0-\\udcd9]"},{name:"Ugaritic",astral:"\\ud800[\\udf80-\\udf9d\\udf9f]"},{name:"Vai",bmp:"\\ua500-\\ua62b"},{name:"Warang_Citi",astral:"\\ud806[\\udca0-\\udcf2\\udcff]"},{name:"Yi",bmp:"\\ua000-\\ua48c\\ua490-\\ua4c6"}])}},{}],8:[function(require,module,exports){var XRegExp=require("./xregexp");require("./addons/build")(XRegExp),require("./addons/matchrecursive")(XRegExp),require("./addons/unicode-base")(XRegExp),require("./addons/unicode-blocks")(XRegExp),require("./addons/unicode-categories")(XRegExp),require("./addons/unicode-properties")(XRegExp),require("./addons/unicode-scripts")(XRegExp),module.exports=XRegExp},{"./addons/build":1,"./addons/matchrecursive":2,"./addons/unicode-base":3,"./addons/unicode-blocks":4,"./addons/unicode-categories":5,"./addons/unicode-properties":6,"./addons/unicode-scripts":7,"./xregexp":9}],9:[function(require,module,exports){var REGEX_DATA="xregexp",features={astral:!1,natives:!1},nativ={exec:RegExp.prototype.exec,test:RegExp.prototype.test,match:String.prototype.match,replace:String.prototype.replace,split:String.prototype.split},fixed={},regexCache={},patternCache={},tokens=[],defaultScope="default",classScope="class",nativeTokens={default:/\\\\(?:0(?:[0-3][0-7]{0,2}|[4-7][0-7]?)?|[1-9]\\d*|x[\\dA-Fa-f]{2}|u(?:[\\dA-Fa-f]{4}|{[\\dA-Fa-f]+})|c[A-Za-z]|[\\s\\S])|\\(\\?(?:[:=!]|<[=!])|[?*+]\\?|{\\d+(?:,\\d*)?}\\??|[\\s\\S]/,class:/\\\\(?:[0-3][0-7]{0,2}|[4-7][0-7]?|x[\\dA-Fa-f]{2}|u(?:[\\dA-Fa-f]{4}|{[\\dA-Fa-f]+})|c[A-Za-z]|[\\s\\S])|[\\s\\S]/},replacementToken=/\\$(?:{([\\w$]+)}|(\\d\\d?|[\\s\\S]))/g,correctExecNpcg=void 0===nativ.exec.call(/()??/,"")[1],hasFlagsProp=void 0!==/x/.flags,toString={}.toString;function hasNativeFlag(flag){var isSupported=!0;try{new RegExp("",flag)}catch(exception){isSupported=!1}return isSupported}var hasNativeU=hasNativeFlag("u"),hasNativeY=hasNativeFlag("y"),registeredFlags={g:!0,i:!0,m:!0,u:hasNativeU,y:hasNativeY};function augment(regex,captureNames,xSource,xFlags,isInternalOnly){var p;if(regex[REGEX_DATA]={captureNames:captureNames},isInternalOnly)return regex;if(regex.__proto__)regex.__proto__=XRegExp.prototype;else for(p in XRegExp.prototype)regex[p]=XRegExp.prototype[p];return regex[REGEX_DATA].source=xSource,regex[REGEX_DATA].flags=xFlags?xFlags.split("").sort().join(""):xFlags,regex}function clipDuplicates(str){return nativ.replace.call(str,/([\\s\\S])(?=[\\s\\S]*\\1)/g,"")}function copyRegex(regex,options){if(!XRegExp.isRegExp(regex))throw new TypeError("Type RegExp expected");var xData=regex[REGEX_DATA]||{},flags=getNativeFlags(regex),flagsToAdd="",flagsToRemove="",xregexpSource=null,xregexpFlags=null;return(options=options||{}).removeG&&(flagsToRemove+="g"),options.removeY&&(flagsToRemove+="y"),flagsToRemove&&(flags=nativ.replace.call(flags,new RegExp("["+flagsToRemove+"]+","g"),"")),options.addG&&(flagsToAdd+="g"),options.addY&&(flagsToAdd+="y"),flagsToAdd&&(flags=clipDuplicates(flags+flagsToAdd)),options.isInternalOnly||(void 0!==xData.source&&(xregexpSource=xData.source),null!=xData.flags&&(xregexpFlags=flagsToAdd?clipDuplicates(xData.flags+flagsToAdd):xData.flags)),regex=augment(new RegExp(options.source||regex.source,flags),hasNamedCapture(regex)?xData.captureNames.slice(0):null,xregexpSource,xregexpFlags,options.isInternalOnly)}function dec(hex){return parseInt(hex,16)}function getContextualTokenSeparator(match,scope,flags){return"("===match.input.charAt(match.index-1)||")"===match.input.charAt(match.index+match[0].length)||isPatternNext(match.input,match.index+match[0].length,flags,"[?*+]|{\\\\d+(?:,\\\\d*)?}")?"":"(?:)"}function getNativeFlags(regex){return hasFlagsProp?regex.flags:nativ.exec.call(/\\/([a-z]*)$/i,RegExp.prototype.toString.call(regex))[1]}function hasNamedCapture(regex){return!(!regex[REGEX_DATA]||!regex[REGEX_DATA].captureNames)}function hex(dec){return parseInt(dec,10).toString(16)}function indexOf(array,value){var i,len=array.length;for(i=0;i<len;++i)if(array[i]===value)return i;return-1}function isPatternNext(pattern,pos,flags,needlePattern){var inlineCommentPattern="\\\\(\\\\?#[^)]*\\\\)",lineCommentPattern="#[^#\\\\n]*",patternsToIgnore=flags.indexOf("x")>-1?["\\\\s",lineCommentPattern,inlineCommentPattern]:[inlineCommentPattern];return nativ.test.call(new RegExp("^(?:"+patternsToIgnore.join("|")+")*(?:"+needlePattern+")"),pattern.slice(pos))}function isType(value,type){return toString.call(value)==="[object "+type+"]"}function pad4(str){for(;str.length<4;)str="0"+str;return str}function prepareFlags(pattern,flags){var i;if(clipDuplicates(flags)!==flags)throw new SyntaxError("Invalid duplicate regex flag "+flags);for(pattern=nativ.replace.call(pattern,/^\\(\\?([\\w$]+)\\)/,(function($0,$1){if(nativ.test.call(/[gy]/,$1))throw new SyntaxError("Cannot use flag g or y in mode modifier "+$0);return flags=clipDuplicates(flags+$1),""})),i=0;i<flags.length;++i)if(!registeredFlags[flags.charAt(i)])throw new SyntaxError("Unknown regex flag "+flags.charAt(i));return{pattern:pattern,flags:flags}}function prepareOptions(value){var options={};return isType(value,"String")?(XRegExp.forEach(value,/[^\\s,]+/,(function(match){options[match]=!0})),options):value}function registerFlag(flag){if(!/^[\\w$]$/.test(flag))throw new Error("Flag must be a single character A-Za-z0-9_$");registeredFlags[flag]=!0}function runTokens(pattern,flags,pos,scope,context){for(var match,t,i=tokens.length,leadChar=pattern.charAt(pos),result=null;i--;)if(!((t=tokens[i]).leadChar&&t.leadChar!==leadChar||t.scope!==scope&&"all"!==t.scope||t.flag&&-1===flags.indexOf(t.flag))&&(match=XRegExp.exec(pattern,t.regex,pos,"sticky"))){result={matchLength:match[0].length,output:t.handler.call(context,match,scope,flags),reparse:t.reparse};break}return result}function setAstral(on){features.astral=on}function setNatives(on){RegExp.prototype.exec=(on?fixed:nativ).exec,RegExp.prototype.test=(on?fixed:nativ).test,String.prototype.match=(on?fixed:nativ).match,String.prototype.replace=(on?fixed:nativ).replace,String.prototype.split=(on?fixed:nativ).split,features.natives=on}function toObject(value){if(null==value)throw new TypeError("Cannot convert null or undefined to object");return value}function XRegExp(pattern,flags){if(XRegExp.isRegExp(pattern)){if(void 0!==flags)throw new TypeError("Cannot supply flags when copying a RegExp");return copyRegex(pattern)}if(pattern=void 0===pattern?"":String(pattern),flags=void 0===flags?"":String(flags),XRegExp.isInstalled("astral")&&-1===flags.indexOf("A")&&(flags+="A"),patternCache[pattern]||(patternCache[pattern]={}),!patternCache[pattern][flags]){for(var result,context={hasNamedCapture:!1,captureNames:[]},scope=defaultScope,output="",pos=0,applied=prepareFlags(pattern,flags),appliedPattern=applied.pattern,appliedFlags=applied.flags;pos<appliedPattern.length;){do{(result=runTokens(appliedPattern,appliedFlags,pos,scope,context))&&result.reparse&&(appliedPattern=appliedPattern.slice(0,pos)+result.output+appliedPattern.slice(pos+result.matchLength))}while(result&&result.reparse);if(result)output+=result.output,pos+=result.matchLength||1;else{var token=XRegExp.exec(appliedPattern,nativeTokens[scope],pos,"sticky")[0];output+=token,pos+=token.length,"["===token&&scope===defaultScope?scope=classScope:"]"===token&&scope===classScope&&(scope=defaultScope)}}patternCache[pattern][flags]={pattern:nativ.replace.call(output,/(?:\\(\\?:\\))+/g,"(?:)"),flags:nativ.replace.call(appliedFlags,/[^gimuy]+/g,""),captures:context.hasNamedCapture?context.captureNames:null}}var generated=patternCache[pattern][flags];return augment(new RegExp(generated.pattern,generated.flags),generated.captures,pattern,flags)}XRegExp.prototype=new RegExp,XRegExp.version="3.2.0",XRegExp._clipDuplicates=clipDuplicates,XRegExp._hasNativeFlag=hasNativeFlag,XRegExp._dec=dec,XRegExp._hex=hex,XRegExp._pad4=pad4,XRegExp.addToken=function(regex,handler,options){var i,optionalFlags=(options=options||{}).optionalFlags;if(options.flag&&registerFlag(options.flag),optionalFlags)for(optionalFlags=nativ.split.call(optionalFlags,""),i=0;i<optionalFlags.length;++i)registerFlag(optionalFlags[i]);tokens.push({regex:copyRegex(regex,{addG:!0,addY:hasNativeY,isInternalOnly:!0}),handler:handler,scope:options.scope||defaultScope,flag:options.flag,reparse:options.reparse,leadChar:options.leadChar}),XRegExp.cache.flush("patterns")},XRegExp.cache=function(pattern,flags){return regexCache[pattern]||(regexCache[pattern]={}),regexCache[pattern][flags]||(regexCache[pattern][flags]=XRegExp(pattern,flags))},XRegExp.cache.flush=function(cacheName){"patterns"===cacheName?patternCache={}:regexCache={}},XRegExp.escape=function(str){return nativ.replace.call(toObject(str),/[-\\[\\]{}()*+?.,\\\\^$|#\\s]/g,"\\\\$&")},XRegExp.exec=function(str,regex,pos,sticky){var match,r2,cacheKey="g",addY=!1,fakeY=!1;return(addY=hasNativeY&&!!(sticky||regex.sticky&&!1!==sticky))?cacheKey+="y":sticky&&(fakeY=!0,cacheKey+="FakeY"),regex[REGEX_DATA]=regex[REGEX_DATA]||{},pos=pos||0,(r2=regex[REGEX_DATA][cacheKey]||(regex[REGEX_DATA][cacheKey]=copyRegex(regex,{addG:!0,addY:addY,source:fakeY?regex.source+"|()":void 0,removeY:!1===sticky,isInternalOnly:!0}))).lastIndex=pos,match=fixed.exec.call(r2,str),fakeY&&match&&""===match.pop()&&(match=null),regex.global&&(regex.lastIndex=match?r2.lastIndex:0),match},XRegExp.forEach=function(str,regex,callback){for(var match,pos=0,i=-1;match=XRegExp.exec(str,regex,pos);)callback(match,++i,str,regex),pos=match.index+(match[0].length||1)},XRegExp.globalize=function(regex){return copyRegex(regex,{addG:!0})},XRegExp.install=function(options){options=prepareOptions(options),!features.astral&&options.astral&&setAstral(!0),!features.natives&&options.natives&&setNatives(!0)},XRegExp.isInstalled=function(feature){return!!features[feature]},XRegExp.isRegExp=function(value){return"[object RegExp]"===toString.call(value)},XRegExp.match=function(str,regex,scope){var result,r2,global=regex.global&&"one"!==scope||"all"===scope,cacheKey=(global?"g":"")+(regex.sticky?"y":"")||"noGY";return regex[REGEX_DATA]=regex[REGEX_DATA]||{},r2=regex[REGEX_DATA][cacheKey]||(regex[REGEX_DATA][cacheKey]=copyRegex(regex,{addG:!!global,removeG:"one"===scope,isInternalOnly:!0})),result=nativ.match.call(toObject(str),r2),regex.global&&(regex.lastIndex="one"===scope&&result?result.index+result[0].length:0),global?result||[]:result&&result[0]},XRegExp.matchChain=function(str,chain){return function recurseChain(values,level){var item=chain[level].regex?chain[level]:{regex:chain[level]},matches=[];function addMatch(match){if(item.backref){if(!(match.hasOwnProperty(item.backref)||+item.backref<match.length))throw new ReferenceError("Backreference to undefined group: "+item.backref);matches.push(match[item.backref]||"")}else matches.push(match[0])}for(var i=0;i<values.length;++i)XRegExp.forEach(values[i],item.regex,addMatch);return level!==chain.length-1&&matches.length?recurseChain(matches,level+1):matches}([str],0)},XRegExp.replace=function(str,search,replacement,scope){var result,isRegex=XRegExp.isRegExp(search),global=search.global&&"one"!==scope||"all"===scope,cacheKey=(global?"g":"")+(search.sticky?"y":"")||"noGY",s2=search;return isRegex?(search[REGEX_DATA]=search[REGEX_DATA]||{},s2=search[REGEX_DATA][cacheKey]||(search[REGEX_DATA][cacheKey]=copyRegex(search,{addG:!!global,removeG:"one"===scope,isInternalOnly:!0}))):global&&(s2=new RegExp(XRegExp.escape(String(search)),"g")),result=fixed.replace.call(toObject(str),s2,replacement),isRegex&&search.global&&(search.lastIndex=0),result},XRegExp.replaceEach=function(str,replacements){var i,r;for(i=0;i<replacements.length;++i)r=replacements[i],str=XRegExp.replace(str,r[0],r[1],r[2]);return str},XRegExp.split=function(str,separator,limit){return fixed.split.call(toObject(str),separator,limit)},XRegExp.test=function(str,regex,pos,sticky){return!!XRegExp.exec(str,regex,pos,sticky)},XRegExp.uninstall=function(options){options=prepareOptions(options),features.astral&&options.astral&&setAstral(!1),features.natives&&options.natives&&setNatives(!1)},XRegExp.union=function(patterns,flags,options){var numPriorCaptures,captureNames,conjunction=(options=options||{}).conjunction||"or",numCaptures=0;function rewrite(match,paren,backref){var name=captureNames[numCaptures-numPriorCaptures];if(paren){if(++numCaptures,name)return"(?<"+name+">"}else if(backref)return"\\\\"+(+backref+numPriorCaptures);return match}if(!isType(patterns,"Array")||!patterns.length)throw new TypeError("Must provide a nonempty array of patterns to merge");for(var pattern,parts=/(\\()(?!\\?)|\\\\([1-9]\\d*)|\\\\[\\s\\S]|\\[(?:[^\\\\\\]]|\\\\[\\s\\S])*\\]/g,output=[],i=0;i<patterns.length;++i)pattern=patterns[i],XRegExp.isRegExp(pattern)?(numPriorCaptures=numCaptures,captureNames=pattern[REGEX_DATA]&&pattern[REGEX_DATA].captureNames||[],output.push(nativ.replace.call(XRegExp(pattern.source).source,parts,rewrite))):output.push(XRegExp.escape(pattern));var separator="none"===conjunction?"":"|";return XRegExp(output.join(separator),flags)},fixed.exec=function(str){var name,r2,i,origLastIndex=this.lastIndex,match=nativ.exec.apply(this,arguments);if(match){if(!correctExecNpcg&&match.length>1&&indexOf(match,"")>-1&&(r2=copyRegex(this,{removeG:!0,isInternalOnly:!0}),nativ.replace.call(String(str).slice(match.index),r2,(function(){var i,len=arguments.length;for(i=1;i<len-2;++i)void 0===arguments[i]&&(match[i]=void 0)}))),this[REGEX_DATA]&&this[REGEX_DATA].captureNames)for(i=1;i<match.length;++i)(name=this[REGEX_DATA].captureNames[i-1])&&(match[name]=match[i]);this.global&&!match[0].length&&this.lastIndex>match.index&&(this.lastIndex=match.index)}return this.global||(this.lastIndex=origLastIndex),match},fixed.test=function(str){return!!fixed.exec.call(this,str)},fixed.match=function(regex){var result;if(XRegExp.isRegExp(regex)){if(regex.global)return result=nativ.match.apply(this,arguments),regex.lastIndex=0,result}else regex=new RegExp(regex);return fixed.exec.call(regex,toObject(this))},fixed.replace=function(search,replacement){var origLastIndex,captureNames,result,isRegex=XRegExp.isRegExp(search);return isRegex?(search[REGEX_DATA]&&(captureNames=search[REGEX_DATA].captureNames),origLastIndex=search.lastIndex):search+="",result=isType(replacement,"Function")?nativ.replace.call(String(this),search,(function(){var i,args=arguments;if(captureNames)for(args[0]=new String(args[0]),i=0;i<captureNames.length;++i)captureNames[i]&&(args[0][captureNames[i]]=args[i+1]);return isRegex&&search.global&&(search.lastIndex=args[args.length-2]+args[0].length),replacement.apply(void 0,args)})):nativ.replace.call(null==this?this:String(this),search,(function(){var args=arguments;return nativ.replace.call(String(replacement),replacementToken,(function($0,$1,$2){var n;if($1){if((n=+$1)<=args.length-3)return args[n]||"";if((n=captureNames?indexOf(captureNames,$1):-1)<0)throw new SyntaxError("Backreference to undefined group "+$0);return args[n+1]||""}if("$"===$2)return"$";if("&"===$2||0==+$2)return args[0];if("`"===$2)return args[args.length-1].slice(0,args[args.length-2]);if("\'"===$2)return args[args.length-1].slice(args[args.length-2]+args[0].length);if($2=+$2,!isNaN($2)){if($2>args.length-3)throw new SyntaxError("Backreference to undefined group "+$0);return args[$2]||""}throw new SyntaxError("Invalid token "+$0)}))})),isRegex&&(search.global?search.lastIndex=0:search.lastIndex=origLastIndex),result},fixed.split=function(separator,limit){if(!XRegExp.isRegExp(separator))return nativ.split.apply(this,arguments);var lastLength,str=String(this),output=[],origLastIndex=separator.lastIndex,lastLastIndex=0;return limit=(void 0===limit?-1:limit)>>>0,XRegExp.forEach(str,separator,(function(match){match.index+match[0].length>lastLastIndex&&(output.push(str.slice(lastLastIndex,match.index)),match.length>1&&match.index<str.length&&Array.prototype.push.apply(output,match.slice(1)),lastLength=match[0].length,lastLastIndex=match.index+lastLength)})),lastLastIndex===str.length?nativ.test.call(separator,"")&&!lastLength||output.push(""):output.push(str.slice(lastLastIndex)),separator.lastIndex=origLastIndex,output.length>limit?output.slice(0,limit):output},XRegExp.addToken(/\\\\([ABCE-RTUVXYZaeg-mopqyz]|c(?![A-Za-z])|u(?![\\dA-Fa-f]{4}|{[\\dA-Fa-f]+})|x(?![\\dA-Fa-f]{2}))/,(function(match,scope){if("B"===match[1]&&scope===defaultScope)return match[0];throw new SyntaxError("Invalid escape "+match[0])}),{scope:"all",leadChar:"\\\\"}),XRegExp.addToken(/\\\\u{([\\dA-Fa-f]+)}/,(function(match,scope,flags){var code=dec(match[1]);if(code>1114111)throw new SyntaxError("Invalid Unicode code point "+match[0]);if(code<=65535)return"\\\\u"+pad4(hex(code));if(hasNativeU&&flags.indexOf("u")>-1)return match[0];throw new SyntaxError("Cannot use Unicode code point above \\\\u{FFFF} without flag u")}),{scope:"all",leadChar:"\\\\"}),XRegExp.addToken(/\\[(\\^?)\\]/,(function(match){return match[1]?"[\\\\s\\\\S]":"\\\\b\\\\B"}),{leadChar:"["}),XRegExp.addToken(/\\(\\?#[^)]*\\)/,getContextualTokenSeparator,{leadChar:"("}),XRegExp.addToken(/\\s+|#[^\\n]*\\n?/,getContextualTokenSeparator,{flag:"x"}),XRegExp.addToken(/\\./,(function(){return"[\\\\s\\\\S]"}),{flag:"s",leadChar:"."}),XRegExp.addToken(/\\\\k<([\\w$]+)>/,(function(match){var index=isNaN(match[1])?indexOf(this.captureNames,match[1])+1:+match[1],endIndex=match.index+match[0].length;if(!index||index>this.captureNames.length)throw new SyntaxError("Backreference to undefined group "+match[0]);return"\\\\"+index+(endIndex===match.input.length||isNaN(match.input.charAt(endIndex))?"":"(?:)")}),{leadChar:"\\\\"}),XRegExp.addToken(/\\\\(\\d+)/,(function(match,scope){if(!(scope===defaultScope&&/^[1-9]/.test(match[1])&&+match[1]<=this.captureNames.length)&&"0"!==match[1])throw new SyntaxError("Cannot use octal escape or backreference to undefined group "+match[0]);return match[0]}),{scope:"all",leadChar:"\\\\"}),XRegExp.addToken(/\\(\\?P?<([\\w$]+)>/,(function(match){if(!isNaN(match[1]))throw new SyntaxError("Cannot use integer as capture name "+match[0]);if("length"===match[1]||"__proto__"===match[1])throw new SyntaxError("Cannot use reserved word as capture name "+match[0]);if(indexOf(this.captureNames,match[1])>-1)throw new SyntaxError("Cannot use same name for multiple groups "+match[0]);return this.captureNames.push(match[1]),this.hasNamedCapture=!0,"("}),{leadChar:"("}),XRegExp.addToken(/\\((?!\\?)/,(function(match,scope,flags){return flags.indexOf("n")>-1?"(?:":(this.captureNames.push(null),"(")}),{optionalFlags:"n",leadChar:"("}),module.exports=XRegExp},{}]},{},[8])(8);class RecordSet{constructor(Records=[],getAggregateDataProvider=null){this.Records=Records,this.getAggregateDataProvider=getAggregateDataProvider}get AggregateDataProvider(){return this._aggregateDataProvider||(this._aggregateDataProvider=null!==this.getAggregateDataProvider?this.getAggregateDataProvider():null)}FirstOrDefault(){for(let record of this.Records)return record;return Record.Empty}Any(){for(let record of this.Records)return!!record;return!1}*[Symbol.iterator](){for(let record of this.Records)yield record}}RecordSet.Empty=new RecordSet([]);const Tools={tokenize:tokenize,mergeTokens:function(tokens){return tokens.reduce(((p,c)=>p+(c&&".!".includes(c[0])||!p?"":" ")+c),"")},Variant:VariantUtils,replaceNode:function replaceNode(tree,predicate,replace){return predicate(tree)?replace(tree):tree.ReplaceChildren(tree.Children.map((n=>replaceNode(n,predicate,replace))))},containsNode:function containsNode(tree,predicate){return!!predicate(tree)||tree.Children.map((n=>containsNode(n,predicate))).filter((n=>!0===n)).length>0},getValueByKey:getValueByKey},emptyCtx={Data:{}};function LazyMap(source,mapFunction){return{*[Symbol.iterator](){let index=0;for(let item of source)yield mapFunction(item,index),index++}}}function LazyMapMany(source,mapFunction){return{*[Symbol.iterator](){for(let item of source)yield*mapFunction(item)}}}function LazyFilter(source,predicate){return{*[Symbol.iterator](){for(let item of source)predicate(item)&&(yield item)}}}function IterableOrderBy(source,keySelector,comparer){return{*[Symbol.iterator](){for(let item of Array.from(source).sort(((a,b)=>comparer(keySelector(a),keySelector(b)))))yield item}}}function LazyZipEx(first,second,selector){return{*[Symbol.iterator](){let index=0;const it1=(first||[])[Symbol.iterator](),it2=(second||[])[Symbol.iterator]();let r1=it1.next(),r2=it2.next();for(;!r1.done&&!r2.done;)yield selector(index++,r1.value,r2.value),r1=it1.next(),r2=it2.next()}}}function LazyTakeWhile(source,predicate){return{*[Symbol.iterator](){for(let item of source){if(!predicate(item))return;yield item}}}}function IterableFirst(iterable){if(!iterable)return null;for(let item of iterable)return item;return null}function IterableLast(iterable){if(!iterable)return null;let lastItem=null;for(let item of iterable)lastItem=item;return lastItem}function IterableAny(iterable,predicate){if(!iterable)return!1;for(let item of iterable)if(!predicate||predicate(item))return!0;return!1}function IterableFind(iterable,predicate){let index=0;for(let item of iterable){if(predicate(item))return{Item:item,Index:index};index++}return{Item:null,Index:-1}}function IterableToArray(iterable){return Array.from(iterable)}function IterableGroupBy(source,keyFunction){const groups=new Map;for(let item of source){const key=keyFunction(item);groups.has(key)?groups.get(key).push(item):groups.set(key,[item])}return{*[Symbol.iterator](){for(let group of groups.entries())yield group}}}function IterableCount(iterable){let count=0;for(let _ of iterable)count++;return count}function Memoize$1(iterable){const iterator=iterable[Symbol.iterator](),cache=[];return{*[Symbol.iterator](){let index=-1;for(;;)if(index++,index<cache.length)yield cache[index];else{const next=iterator.next();if(next.done)return;cache[index]=next.value,yield next.value}}}}function toMemoizeList(source){const _list=[],_enumerator=source[Symbol.iterator]();let _cached=!1;function*getIterator(){if(_cached){for(const item of _list)yield item;return}let index=0;for(;;)if(index<_list.length)yield _list[index++];else if(cacheItem(),index<_list.length)yield _list[index++];else if(_cached)return}function cacheItem(){if(_cached)return;const next=_enumerator.next();next.done?_cached=!0:_list.push(next.value)}function count(){return _cached?_list.length:IterableCount({[Symbol.iterator]:getIterator})}return{getItem:function(i){if(_cached||i<_list.length)return _list[i];for(;;){if(cacheItem(),i<_list.length)return _list[i];if(_cached)break}throw new Error(\'ArgumentOutOfRangeException: "index"\')},get length(){return count()},[Symbol.iterator]:getIterator}}var DataTree;!function(DataTree){DataTree.IsTablix=dataRegion=>!!(dataRegion&&dataRegion.Body&&dataRegion.ColumnMembers&&dataRegion.RowMembers),DataTree.IsList=dataRegion=>!!dataRegion&&!!dataRegion.Groups,DataTree.IsEmpty=scope=>!(scope&&(scope.Regions&&0!==scope.Regions.length||scope["@"]&&0!==scope["@"].length)),DataTree.Makers={Scope:(values,regions,id=0)=>({Id:id,"@":values,get Regions(){return"function"==typeof regions&&(regions=regions()),regions||[]}}),List:(scope,groups,name=null)=>{let groupsValue=null;return{Name:name,Scope:scope,get Groups(){return groupsValue||(groupsValue=("function"==typeof groups?toMemoizeList(groups()):groups)||[]),groupsValue}}},TablixMember:(header,isCollection,id,members)=>{let membersValue=null;return{Header:header||{"@":[],Regions:[],Id:0},Id:id>-1?id:void 0,IsCollection:isCollection,get Members(){return membersValue||(membersValue=("function"==typeof members?toMemoizeList(members()):members)||[]),membersValue}}},TablixRow:cells=>({Cells:cells}),Tablix:(corner,columnMembers,rowMembers,body,name=null)=>{let bodyValue=null;return{Scope:corner,ColumnMembers:columnMembers,RowMembers:rowMembers,Name:name,get Body(){return bodyValue||(bodyValue=("function"==typeof body?toMemoizeList(body()):body)||[]),bodyValue}}}}}(DataTree||(DataTree={}));const GetCollectionItem=(collection,index)=>Array.isArray(collection)?collection[index]:collection.getItem(index);var Def;!function(Def){Def.EmptyContent={Fields:[],Regions:[]},Def.IsEmptyContent=content=>!(content.Fields&&0!==content.Fields.length||content.Regions&&0!==content.Regions.length),Def.Makers={Report:(name,content)=>({type:"report",Name:name,Content:content,Filters:[]}),DataSet:(name,filters,content,fieldNames=[],parameters=[])=>({type:"dataset",Name:name,Filters:filters,Content:content,FieldNames:fieldNames,Parameters:parameters}),Parameter:(name,value)=>({Name:name,Value:value}),SimpleRegion:(name,filters,content)=>({type:"simpleregion",Name:name,Filters:filters,Content:content}),Content:(fields,regions=[])=>({Fields:fields,Regions:regions}),ContentEmpty:{Fields:[],Regions:[]},List:(name,content,filters,group,sort,groupContent,hasEmptyGroups)=>{const list={type:"list",Name:name,Filters:filters,Sort:sort,Content:content,GroupContent:groupContent,Group:group};return hasEmptyGroups&&(list.HandleEmptyGroups=hasEmptyGroups),list},Sort:(expression,direction)=>({Expression:expression,Direction:direction}),Filter:(expression,op,values)=>({Expression:expression,Op:op,Values:values}),Group:(name,groupExpressions,filters,parent="")=>({Name:name,GroupExpressions:groupExpressions||[],Filters:filters||[],Parent:parent}),Subreport:(name,report,parameters,content)=>({type:"subreport",Name:name,Filters:[],Content:content,Report:report,Parameters:parameters}),Tablix:(name,filters,columnMembers,rowMembers,content,body,sorts=null)=>({type:"tablix",Name:name,Filters:filters||[],Content:content||Def.EmptyContent,ColumnMembers:columnMembers||[],RowMembers:rowMembers||[],Body:body||[],Sorts:sorts}),TablixMember:(group,sort,header,members)=>({Group:group,Sort:sort,Header:header,Members:members}),TablixRow:cells=>({Cells:cells||[]})}}(Def||(Def={}));const AggregateFunctionNames=["Sum","Avg","Max","Min","Count","CountDistinct","CountRows","StDev","StDevP","Var","VarP","First","Last","Aggregate","Median","Mode","DistinctSum","AggregateIf","ToArray"],AggregateFunctionNamesLower=AggregateFunctionNames.map((f=>f.toLowerCase()));function ParseAggregateFunction(functionName){const index=AggregateFunctionNamesLower.indexOf(functionName.toLowerCase().trim());return index<0?"Empty":AggregateFunctionNames[index]}const map$2=transform=>function*(source){let counter=0;for(const item of source)yield transform(item,counter++)},filter$1=predicate=>function*(source){for(const item of source)predicate(item)&&(yield item)};function first$1(source){for(let item of source)return item;return null}function last$1(source){let lastItem=null;for(let item of source)lastItem=item;return lastItem}function any$1(source){for(let _ of source)return!0;return!1}const zip$1=selector=>function*(first,second){let index=0;const it1=(first||[])[Symbol.iterator](),it2=(second||[])[Symbol.iterator]();let r1=it1.next(),r2=it2.next();for(;!r1.done&&!r2.done;)yield selector(r1.value,r2.value,index++),r1=it1.next(),r2=it2.next()},zipTuple$1=zip$1(((f,t)=>[f,t])),asIndexed$1=map$2(((item,index)=>({index:index,item:item}))),toArray$1=Array.from;const iterable$1={map:map$2,mapMany:transform=>function*(source){for(let item of source)yield*transform(item)},filter:filter$1,first:first$1,last:last$1,any:any$1,findFirst:predicate=>source=>first$1(filter$1(predicate)(source)),findLast:predicate=>source=>last$1(filter$1(predicate)(source)),findAny:predicate=>source=>any$1(filter$1(predicate)(source)),zip:zip$1,zipTuple:zipTuple$1,asIndexed:asIndexed$1,orderBy:(keySelector,comparer)=>function*(source){for(let item of Array.from(source).sort(((a,b)=>comparer(keySelector(a),keySelector(b)))))yield item},takeWhile:predicate=>function*(source){for(let item of source){if(!predicate(item))return;yield item}},toArray:toArray$1,groupBy:keyFunction=>function*(source){const groups=new Map;for(let item of source){const key=keyFunction(item);groups.has(key)?groups.get(key).push(item):groups.set(key,[item])}for(let group of groups.entries())yield group},count:function(source){let count=0;for(let _ of source)count++;return count},memoize:function*(iterable){const iterator=iterable[Symbol.iterator](),cache=[];let index=-1;for(;;)if(index++,index<cache.length)yield cache[index];else{const next=iterator.next();if(next.done)return;cache[index]=next.value,yield next.value}},skip:skipCount=>function*(source){let counter=0;for(const item of source)counter++>=skipCount&&(yield item)}};class MapEx{constructor(comparer=((a,b)=>a===b)){this.comparer=comparer,this.map=new Map}hasKey(key){return null!==this.getKey(key)}set(key,value){const existingKey=this.getKey(key);this.map.set(null!==existingKey?existingKey:key,value)}get(key){const existingKey=this.getKey(key);return existingKey&&this.map.get(existingKey)||null}entries(){return this.map.entries()}values(){return this.map.values()}clear(){this.map.clear()}size(){return this.map.size}getKey(key){for(const v of this.map.keys())if(this.comparer(v,key))return v;return null}}function isNotNull$1(x){return null!==x}function mapDictionary(d1,map){return Object.keys(d1).reduce(((res,pName)=>{const val=d1[pName];return res[pName]=map(val,pName),res}),{})}class VariantSet{constructor(){this._values=[]}has(value){for(let v of this._values)if(Tools.Variant.Comparison.Equals(v,value).Value)return!0;return!1}add(value){this.has(value)||this._values.push(value)}values(){return this._values}size(){return this._values.length}clear(){this._values=[]}}class VariantMap extends MapEx{constructor(){super(((a,b)=>Tools.Variant.Comparison.Equals(a,b).Value))}}const Create$2=Tools.Variant.Create,Null$2=Tools.Variant.Null,Zero$1=Tools.Variant.Zero,op=Tools.Variant.Operators,con=Tools.Variant.Convert,checkAggrType=(aggr,fn)=>{if(!aggr)throw new Error("incompatible aggregates combine: aggregate is null");if(aggr.Function!==fn)throw new Error(`incompatible aggregates combine: "${fn}" and "${aggr.Function}"`)};function MakeAggregate(aggrFunc){switch(aggrFunc){case"AggregateIf":return makeAggregateIf();case"Avg":return makeAverage();case"Count":return makeCount();case"CountDistinct":return makeCountDistinct();case"CountRows":return makeCountRows();case"DistinctSum":return makeDistinctSum();case"First":return makeFirst();case"Last":return makeLast();case"Max":return makeMax();case"Median":return makeMedian();case"Min":return makeMin();case"Mode":return makeMode();case"StDev":return makeStDev();case"StDevP":return makeStDevP();case"Sum":return makeSum();case"ToArray":return makeToArray();case"Var":return makeVar();case"VarP":return makeVarP();case"Aggregate":default:return{Function:"Empty",GetValue:()=>Tools.Variant.Null,Accumulate:()=>{},Combine:aggregate=>(checkAggrType(aggregate,"Empty"),aggregate),GetState:()=>[],SetState:()=>{}}}}function makeFirst(){let value=Null$2;return{Function:"First",GetValue:()=>value,Accumulate:arg=>{"Null"===value.Type&&arg[0]&&(value=arg[0])},Combine:aggregate=>{checkAggrType(aggregate,"First");const newAggr=makeFirst();return newAggr.SetState(["Null"===value.Type?aggregate.GetState()[0]:value]),newAggr},GetState:()=>"Null"===value.Type?[]:[value],SetState:values=>{values.length>0&&(value=values[0])}}}function makeLast(){let value=Null$2;return{Function:"Last",GetValue:()=>value,Accumulate:arg=>{arg[0]&&(value=arg[0])},Combine:aggregate=>{checkAggrType(aggregate,"Last");const newAggr=makeLast(),v=aggregate.GetState()[0];return newAggr.SetState(["Null"===v.Type?value:v]),newAggr},GetState:()=>"Null"===value.Type?[]:[value],SetState:values=>{values.length>0&&(value=values[0])}}}function makeSum(){let value=Null$2;return{Function:"Sum",GetValue:()=>value,Accumulate:arg=>{arg[0]&&null!==arg[0].Value&&""!==arg[0].Value&&(value=op.Plus(value,arg[0]))},Combine:aggregate=>{checkAggrType(aggregate,"Sum");const newAggr=makeSum();return newAggr.SetState([op.Plus(value,aggregate.GetValue())]),newAggr},GetState:()=>"Null"===value.Type?[]:[value],SetState:values=>{values.length>0&&(value=values[0])}}}function makeAverage(){let sum=Null$2,count=Create$2(0);return{Function:"Avg",GetValue:()=>count.Value>0?op.Divide(sum,count):Null$2,Accumulate:arg=>{arg[0]&&null!==arg[0].Value&&""!==arg[0].Value&&(sum=op.Plus(sum,arg[0]),count=Create$2(count.Value+1))},Combine:aggregate=>{checkAggrType(aggregate,"Avg");const newAggr=makeAverage(),state=aggregate.GetState();return newAggr.SetState([op.Plus(sum,state[0]),op.Plus(count,state[1])]),newAggr},GetState:()=>[sum,count],SetState:values=>{sum=values[0],count=values[1]}}}function makeMax(){let value=Null$2;return{Function:"Max",GetValue:()=>value,Accumulate:arg=>{arg[0]&&null!==arg[0].Value&&""!==arg[0].Value&&("Null"===value.Type||Tools.Variant.Comparison.LessThan(value,arg[0]).Value)&&(value=arg[0])},Combine:aggregate=>{if(checkAggrType(aggregate,"Max"),"Null"===value.Type)return aggregate;const newAggr=makeMax();return newAggr.SetState([Tools.Variant.Comparison.LessThan(value,aggregate.GetValue()).Value?aggregate.GetValue():value]),newAggr},GetState:()=>"Null"===value.Type?[]:[value],SetState:values=>{values.length>0&&(value=values[0])}}}function makeMin(){let value=Null$2;return{Function:"Min",GetValue:()=>value,Accumulate:arg=>{arg[0]&&null!==arg[0].Value&&""!==arg[0].Value&&("Null"===value.Type||Tools.Variant.Comparison.GreaterThan(value,arg[0]).Value)&&(value=arg[0])},Combine:aggregate=>{if(checkAggrType(aggregate,"Min"),"Null"===value.Type)return aggregate;const newAggr=makeMin();return newAggr.SetState([Tools.Variant.Comparison.LessThan(value,aggregate.GetValue()).Value?value:aggregate.GetValue()]),newAggr},GetState:()=>"Null"===value.Type?[]:[value],SetState:values=>{values.length>0&&(value=values[0])}}}function makeCount(){let value=Zero$1;return{Function:"Count",GetValue:()=>value,Accumulate:arg=>{arg[0]&&null!==arg[0].Value&&""!==arg[0].Value&&(value=Create$2(con.toDouble(value)+1))},Combine:aggregate=>{checkAggrType(aggregate,"Count");const newAggr=makeCount();return newAggr.SetState([op.Plus(value,aggregate.GetValue())]),newAggr},GetState:()=>[value],SetState:values=>{value=values[0]}}}function makeCountDistinct(){const distinctValues=new VariantSet;return{Function:"CountDistinct",GetValue:()=>Create$2(distinctValues.size()),Accumulate:arg=>{arg[0]&&null!==arg[0].Value&&""!==arg[0].Value&&distinctValues.add(arg[0])},Combine:aggregate=>{checkAggrType(aggregate,"CountDistinct");const newAggr=makeCountDistinct();return newAggr.SetState(distinctValues.values().concat(aggregate.GetState())),newAggr},GetState:()=>distinctValues.values(),SetState:values=>{distinctValues.clear(),values.forEach((v=>distinctValues.add(v)))}}}function makeCountRows(){let value=Zero$1;return{Function:"CountRows",GetValue:()=>value,Accumulate:()=>{value=Create$2(value.Value+1)},Combine:aggregate=>{checkAggrType(aggregate,"CountRows");const newAggr=makeCountRows();return newAggr.SetState([op.Plus(value,aggregate.GetValue())]),newAggr},GetState:()=>[value],SetState:values=>{value=values[0]}}}function makeDistinctSum(){const distinctValues=new VariantMap;let value=Null$2;return{Function:"DistinctSum",GetValue:()=>0===distinctValues.size()?Null$2:("Null"===value.Type&&(value=Array.from(distinctValues.values()).reduce(((p,c)=>op.Plus(p,c)),Zero$1)),value),Accumulate:data=>{const key=data[0],val=data[1];key&&null!==key.Value&&val&&null!==val.Value&&""!==val.Value&&(distinctValues.hasKey(key)||(distinctValues.set(key,val),value=Null$2))},Combine:aggregate=>{checkAggrType(aggregate,"DistinctSum");const newAggr=makeDistinctSum(),arr=[];for(let p of distinctValues.entries())arr.push(p[0],p[1]);return newAggr.SetState(arr.concat(aggregate.GetState())),newAggr},GetState:()=>{const arr=[];for(let p of distinctValues.entries())arr.push(p[0],p[1]);return arr},SetState:state=>{distinctValues.clear();for(let i=0;i+1<state.length;i+=2)distinctValues.set(state[i],state[i+1])}}}function makeMedian(){let unsorted=!0,values=[];return{Function:"Median",GetValue:()=>{unsorted&&(values.sort(Tools.Variant.Comparison.Compare),unsorted=!1);const n=values.length;if(0===n)return Null$2;if(0!=(1&n))return values[(n-1)/2];const i=n/2|0;return op.Divide(op.Plus(values[i-1],values[i]),Create$2(2))},Accumulate:arg=>{arg[0]&&null!==arg[0].Value&&""!==arg[0].Value&&(values.push(arg[0]),unsorted=!0)},Combine:aggregate=>{checkAggrType(aggregate,"Median");const newAggr=makeMedian();return newAggr.SetState(values.concat(aggregate.GetState())),newAggr},GetState:()=>(unsorted&&(values.sort(Tools.Variant.Comparison.Compare),unsorted=!1),values),SetState:vals=>{values=[...vals],values.sort(Tools.Variant.Comparison.Compare),unsorted=!1}}}function makeMode(){let _mostFrequentItem={Key:Null$2,Value:0};const values=new VariantMap,checkValue=(key,value)=>{_mostFrequentItem.Value<value&&(_mostFrequentItem={Key:key,Value:value})};return{Function:"Mode",GetValue:()=>_mostFrequentItem.Key,Accumulate:arg=>{arg[0]&&null!==arg[0].Value&&(values.hasKey(arg[0])?(values.set(arg[0],(values.get(arg[0])||0)+1),checkValue(arg[0],values.get(arg[0])||0)):(values.set(arg[0],1),checkValue(arg[0],1)))},Combine:aggregate=>{checkAggrType(aggregate,"Mode");const newAggr=makeMode(),arr=[];for(let p of values.entries())arr.push(p[0],Create$2(p[1]));return newAggr.SetState(arr.concat(aggregate.GetState())),newAggr},GetState:()=>{const arr=[];for(let p of values.entries())arr.push(p[0],Create$2(p[1]));return arr},SetState:state=>{_mostFrequentItem={Key:Null$2,Value:0},values.clear();for(let i=0;i+1<state.length;i+=2){const key=state[i],value=con.toDouble(state[i+1]);values.set(key,value),checkValue(key,value)}}}}function makeToArray(){let values=[];return{Function:"ToArray",GetValue:()=>Create$2(values.map((v=>v.Value))),Accumulate:arg=>{arg[0]&&null!==arg[0].Value&&values.push(arg[0])},Combine:aggregate=>{checkAggrType(aggregate,"ToArray");const newAggr=makeToArray();return newAggr.SetState(values.concat(aggregate.GetState())),newAggr},GetState:()=>values,SetState:state=>{values=[...state]}}}function makeAggregateIf(){let aggregate=null;return{Function:"AggregateIf",GetValue:()=>aggregate?aggregate.GetValue():Null$2,Accumulate:data=>{con.toBoolean(data[0])&&(aggregate||(aggregate=MakeAggregate(ParseAggregateFunction(con.toString(data[1])))),aggregate.Accumulate(data.slice(2)))},Combine:aggr=>{checkAggrType(aggr,"AggregateIf");const newAggr=makeAggregateIf();return aggregate?(newAggr.SetState([Create$2(aggr.Function),...aggregate.Combine(aggr).GetState()]),newAggr):aggr},GetState:()=>aggregate?[Create$2(aggregate.Function),...aggregate.GetState()]:[],SetState:state=>{if(state&&0!==state.length){const fn=ParseAggregateFunction(con.toString(state[0]));aggregate=MakeAggregate(fn),aggregate.SetState(state.slice(1))}else aggregate=null}}}function makeVar(){let sum=Zero$1,sumOfSquares=Zero$1,count=0;return{Function:"Var",GetValue:()=>calcVariance(sum,sumOfSquares,count),Accumulate:arg=>{const value=arg[0];value&&"Null"!==value.Type&&""!==value.Value&&(sum=op.Plus(sum,value),sumOfSquares=op.Plus(sumOfSquares,op.Mult(value,value)),count++)},Combine:aggregate=>{checkAggrType(aggregate,"Var");const newAggr=makeVar(),state=aggregate.GetState();return newAggr.SetState([op.Plus(sum,state[0]),op.Plus(sumOfSquares,state[1]),op.Plus(Create$2(count),state[2])]),newAggr},GetState:()=>0===count?[]:[sum,sumOfSquares,Create$2(count)],SetState:state=>{state&&0!==state.length?(sum=state[0],sumOfSquares=state[1],count=con.toDouble(state[2])):(sum=Zero$1,sumOfSquares=Zero$1,count=0)}}}function makeVarP(){let sum=Zero$1,sumOfSquares=Zero$1,count=0;return{Function:"VarP",GetValue:()=>calcPopulationVariance(sum,sumOfSquares,count),Accumulate:arg=>{const value=arg[0];value&&"Null"!==value.Type&&""!==value.Value&&(sum=op.Plus(sum,value),sumOfSquares=op.Plus(sumOfSquares,op.Mult(value,value)),count++)},Combine:aggregate=>{checkAggrType(aggregate,"VarP");const newAggr=makeVarP(),state=aggregate.GetState();return newAggr.SetState([op.Plus(sum,state[0]),op.Plus(sumOfSquares,state[1]),op.Plus(Create$2(count),state[2])]),newAggr},GetState:()=>0===count?[]:[sum,sumOfSquares,Create$2(count)],SetState:state=>{state&&0!==state.length?(sum=state[0],sumOfSquares=state[1],count=con.toDouble(state[2])):(sum=Zero$1,sumOfSquares=Zero$1,count=0)}}}function makeStDev(){let sum=Zero$1,sumOfSquares=Zero$1,count=0;return{Function:"StDev",GetValue:()=>{const v=calcVariance(sum,sumOfSquares,count);return"Null"===v.Type?v:Create$2(Math.sqrt(con.toDouble(v)))},Accumulate:arg=>{const value=arg[0];value&&"Null"!==value.Type&&""!==value.Value&&(sum=op.Plus(sum,value),sumOfSquares=op.Plus(sumOfSquares,op.Mult(value,value)),count++)},Combine:aggregate=>{checkAggrType(aggregate,"StDev");const newAggr=makeStDev(),state=aggregate.GetState();return newAggr.SetState([op.Plus(sum,state[0]),op.Plus(sumOfSquares,state[1]),op.Plus(Create$2(count),state[2])]),newAggr},GetState:()=>0===count?[]:[sum,sumOfSquares,Create$2(count)],SetState:state=>{state&&0!==state.length?(sum=state[0],sumOfSquares=state[1],count=con.toDouble(state[2])):(sum=Zero$1,sumOfSquares=Zero$1,count=0)}}}function makeStDevP(){let sum=Zero$1,sumOfSquares=Zero$1,count=0;return{Function:"StDevP",GetValue:()=>{const v=calcPopulationVariance(sum,sumOfSquares,count);return"Null"===v.Type?v:Create$2(Math.sqrt(con.toDouble(v)))},Accumulate:arg=>{const value=arg[0];value&&"Null"!==value.Type&&""!==value.Value&&(sum=op.Plus(sum,value),sumOfSquares=op.Plus(sumOfSquares,op.Mult(value,value)),count++)},Combine:aggregate=>{checkAggrType(aggregate,"StDevP");const newAggr=makeStDevP(),state=aggregate.GetState();return newAggr.SetState([op.Plus(sum,state[0]),op.Plus(sumOfSquares,state[1]),op.Plus(Create$2(count),state[2])]),newAggr},GetState:()=>0===count?[]:[sum,sumOfSquares,Create$2(count)],SetState:state=>{state&&0!==state.length?(sum=state[0],sumOfSquares=state[1],count=con.toDouble(state[2])):(sum=Zero$1,sumOfSquares=Zero$1,count=0)}}}function calcVariance(sum,sumOfSquares,count){if(0===count||1===count)return Null$2;const vCount=Create$2(count);return op.Divide(op.Minus(op.Mult(vCount,sumOfSquares),op.Mult(sum,sum)),Create$2(count*(count-1)))}function calcPopulationVariance(sum,sumOfSquares,count){if(0===count)return Null$2;if(1===count)return Create$2(0);const vCount=Create$2(count);return op.Divide(op.Minus(op.Mult(vCount,sumOfSquares),op.Mult(sum,sum)),Create$2(count*count))}function MakeIndexedFilter(def,dataSet,parentDataSet){const filters=def.Filters||[],emptyContent=Def.Makers.Content([]);if(filters.length>0&&filters.every((x=>"Equal"===x.Op&&1===x.Values.length))){const mem=new WeakMap,fieldsFns=MakeFieldsFn$1(filters.map((x=>x.Expression)),emptyContent,dataSet),valueExprsFns=MakeFieldsFn$1(filters.map((x=>x.Values[0])),emptyContent,parentDataSet);return members=>{let index=mem.get(members);if(index||(index=function(members,indexExprs){const idx=new MapEx(ArrayComparer);for(const member of members){const key=indexExprs(member);idx.hasKey(key)?idx.get(key).push(member):idx.set(key,[member])}return idx}(members,fieldsFns),mem.set(members,index)),0===index.size())return[];const firstMember=IterableFirst(members),key=firstMember&&valueExprsFns(firstMember.ParentQueryContext);return key&&index.hasKey(key)?index.get(key):[]}}return Make(filters,(f=>MakeFieldsFn$1(f,emptyContent,dataSet)),(infos=>{const fns=MakeFieldsFn$1(infos,emptyContent,parentDataSet);return scope=>fns(scope.ParentQueryContext)}))}function ArrayComparer(a,b){return a.length===b.length&&a.every(((value,index)=>Tools.Variant.Comparison.Equals(value,b[index]).Value))}function Validate(filters,scope){if(filters)switch(scope){case"DataSet":case"DataRegion":if(IterableAny(filters,IsInvalidForRegion)){throw new Error(`Aggregate functions cannot be used in ${"DataSet"===scope?"data set":"data region"} filters`)}break;case"Group":if(IterableAny(filters,IsInvalidForGroup))throw new Error("Invalid expressions used in group filters.");break;default:throw new Error("filters validation: scope")}}const IsInvalidForRegion=filter=>[filter.Expression].concat(filter.Values).some(IsInvalidForRegionExpr),IsInvalidForRegionExpr=e=>IsInvalid(e,UnsupportedRegionFuncs),IsInvalidForGroup=filter=>[filter.Expression].concat(filter.Values).some(IsInvalidForGroupExpr),IsInvalidForGroupExpr=e=>IsInvalid(e,UnsupportedGroupFuncs),UnsupportedRegionFuncs=new RegExp("^"+AggregateFunctionNames.concat(["CumulativeTotal"]).join("|")+"$","gi"),UnsupportedGroupFuncs=/^CumulativeTotal$/gi;function IsInvalid(e,unsupportedFuncs){const node=compiler(e);return node.Contains(unsupportedFuncs,"function")||node.Contains(/^ReportItems(\\.|!|$)/i,"variable")}const Comparison=Tools.Variant.Comparison,Convert=Tools.Variant.Convert,compiler$1=function(customFunctions,customVariables,customConstants){const treeBuilder=createTreeBuilder(customFunctions,customVariables,customConstants);return expression=>{const expressionTree=treeBuilder(expression);return(rootNode=expressionTree).Contains(null,"variable")||rootNode.Contains(null,"function")?ctx=>expressionTree.Eval(ctx):expressionTree.Eval(emptyCtx);var rootNode}}(),Empty=members=>members;function Apply$2(data,filter){if(null===filter)return data;const items=filter(LazyMap(data.Data.Records,(rec=>data.MakeContextWithData(new RecordSet([rec])))));return data.MakeContextWithData(new RecordSet(LazyMap(items,(m=>m.Data.FirstOrDefault()))))}function MakeRegionFilter(def,dataSet=null,parentDataSet=null){return def&&def.Filters&&0!==def.Filters.length?(Validate(def.Filters,"DataRegion"),parentDataSet&&dataSet&&parentDataSet!==dataSet?MakeIndexedFilter(def,dataSet,parentDataSet):Make(def.Filters,(f=>MakeFieldsFn$1(f,Def.Makers.Content([]),dataSet)))):null}function MakeGroupFilter(def,content,dataSet){return def&&def.Filters&&0!==def.Filters.length?function(filter,content,dataSet=null){return null==filter||0==filter.length?Empty:Make(filter,(f=>MakeFieldsFn$1(f,content,dataSet)))}(def.Filters,content,dataSet):Empty}function MakeFieldsFn$1(fields,content,dataSet){const cc=MakeCompileContext(dataSet),fns=fields.map((f=>compile(f,cc)));return ctx=>fns.map((fn=>fn(ctx)))}function Make(filters,compile,compileRight=null){if(!filters||0===filters.length)return Empty;if(1===filters.length)return MakeSingle(filters[0],compile,compileRight);const fns=filters.map((filter=>MakeSingle(filter,compile,compileRight)));return members=>fns.reduce(((current,fn)=>fn(current)),members)}function MakeSingle(filter,compileLeft,compileRight=null){compileRight||(compileRight=compileLeft);const evalLeft=compileLeft([filter.Expression]),evalRight=compileRight(filter.Values.map((v=>v)));return fn=function(op,evalFn){switch(op){case"Equal":case"NotEqual":case"GreaterThan":case"GreaterThanOrEqual":case"LessThan":case"LessThanOrEqual":case"Like":case"NotLike":case"In":case"Between":case"NotBetween":case"BetweenExclusive":const predicate=(fn=function(op){switch(op){case"Equal":return args=>Comparison.Equals(args[0],args[1]).Value;case"NotEqual":return args=>{try{return!Comparison.Equals(args[0],args[1]).Value}catch(err){return!0}};case"GreaterThan":return args=>Comparison.GreaterThan(args[0],args[1]).Value;case"GreaterThanOrEqual":return args=>Comparison.GreaterOrEqual(args[0],args[1]).Value;case"LessThan":return args=>Comparison.LessThan(args[0],args[1]).Value;case"LessThanOrEqual":return args=>Comparison.LessOrEqual(args[0],args[1]).Value;case"Like":return args=>{const compiled=compiler$1(`="${Convert.toString(args[0]).toLowerCase()}" Like "${Convert.toString(args[1]).toLowerCase()}"`);return Convert.toBoolean("function"==typeof compiled?compiled({Data:{}}):compiled)};case"NotLike":return args=>{const compiled=compiler$1(`="${Convert.toString(args[0]).toLowerCase()}" Like "${Convert.toString(args[1]).toLowerCase()}"`);return!Convert.toBoolean("function"==typeof compiled?compiled({Data:{}}):compiled)};case"In":return args=>{const values=[];return args.slice(1).forEach((arg=>{"Object"===arg.Type&&Array.isArray(arg.Value)?values.push(...arg.Value.map((v=>Tools.Variant.Create(v)))):values.push(arg)})),values.some((t=>{try{return Comparison.Equals(t,args[0]).Value}catch(err){return!1}}))};case"Between":return args=>Comparison.GreaterOrEqual(args[0],args[1]).Value&&Comparison.LessOrEqual(args[0],args[2]).Value;case"NotBetween":return args=>!(Comparison.GreaterOrEqual(args[0],args[1]).Value&&Comparison.LessOrEqual(args[0],args[2]).Value);case"BetweenExclusive":return args=>Comparison.GreaterThan(args[0],args[1]).Value&&Comparison.LessThan(args[0],args[2]).Value;default:throw new Error(`Operator ${op} is not supported`)}}(op),args=>{try{return fn(args)}catch(err){return!1}});return members=>LazyFilter(members,(member=>predicate(evalFn(member))));case"TopN":return members=>TopN(members,evalFn,!1);case"BottomN":return members=>BottomN(members,evalFn,!1);case"TopPercent":return members=>TopN(members,evalFn,!0);case"BottomPercent":return members=>BottomN(members,evalFn,!0);default:throw new Error(`Operator ${op} is not supported`)}var fn}(filter.Op,(ctx=>evalLeft(ctx).concat(evalRight(ctx)))),members=>{try{return fn(members)}catch(err){return[]}};var fn}function TopN(set,selector,percent){return CapacityFilter(set,selector,!0,percent)}function BottomN(set,selector,percent){return CapacityFilter(set,selector,!1,percent)}function CapacityFilter(set,selector,top,percent){const buffer=[],bufferComparer=(a,b)=>top?Comparison.Compare(b.Key,a.Key):Comparison.Compare(a.Key,b.Key);let index=0,n=0,first=!0,count=0;if(percent){const list=IterableToArray(set);count=list.length,set=list}for(const item of set){const vals=selector(item);if(first){if(percent){const p=Convert.toDouble(vals[1]);n=Math.round(p*count/100)}else n=Convert.toInteger(vals[1]);if(n<=0)return[];first=!1}buffer.push({Key:vals[0],Value:{Index:index++,Item:item}}),buffer.sort(bufferComparer),buffer.length>n&&buffer.splice(buffer.length-1,1)}return LazyMap(IterableOrderBy(buffer,(it=>it.Value.Index),((a,b)=>a-b)),(it=>it.Value.Item))}const Compare=Tools.Variant.Comparison.Compare,NoSort=members=>members,MakeCompareFn=getDirection=>(x,y)=>{for(let i=0;i<x.length;i++){const t=Compare(x[i],y[i]);if(0!==t)return"Descending"===getDirection(i)?-1*t:t}return 0};function MakeSortContextFn(sort,groupContent=null,dataSet=null){if(!sort||0===sort.length)return NoSort;if(null==groupContent&&(groupContent=Def.Makers.ContentEmpty),1===sort.length&&Def.IsEmptyContent(groupContent))return function(sort,dataSet=null){var cc=MakeCompileContext(dataSet),fn=compile(sort.Expression,cc);return function(sort,evalFn){switch(sort.Direction){case"Ascending":return members=>IterableOrderBy(members,evalFn,Compare);case"Descending":return members=>IterableOrderBy(members,evalFn,((x,y)=>-Compare(x,y)));default:throw new Error("ArgumentOutOfRangeException")}}(sort,(ctx=>fn(ctx)))}(sort[0],dataSet);const fields=sort.map((s=>s.Expression));return MakeSortFn$2(sort,MakeFieldsFn$1(fields,0,dataSet))}function MakeSortFn$2(sort,evalFn){return 0===sort.length?NoSort:members=>{const comparer=MakeCompareFn((i=>sort[i].Direction));return IterableOrderBy(members,evalFn,comparer)}}function Apply$1(data,sort){if(!sort)return data;const items=sort(LazyMap(data.Data.Records,(rec=>data.MakeContextWithData(new RecordSet([rec]))))),recs=LazyMap(items,(m=>m.Data.FirstOrDefault()));return data.MakeContextWithData(new RecordSet(LazyMap(recs,((r,i)=>r.MakeCopy(i)))))}function MakeFn$2(grp){if(!grp||!grp.Parent)return null;if(!grp.GroupExpressions||0===grp.GroupExpressions.length)throw new Error("No group expression.");const keyIdx=IndexOfAggregate(grp.GroupExpressions[0]),parentIdx=IndexOfAggregate(grp.Parent);return keyIdx==parentIdx?null:(items,scope)=>function(items,keyFn,parentKeyFn){let list=Array.from(LazyMap(items,(t=>({Key:keyFn(t),ParentKey:parentKeyFn(t),Data:t}))));if(list.length<=1)return list.map((t=>[0,t.Data]));list=Array.from(function(items){const list=Array.from(items),loopItemKeys=function(items){const list=Array.from(items),tree=new Map(list.map((t=>[t.Key,t]))),handledItemKeys=[],loopItemKeys=[];for(const item of list){let current=item;const history=[current.Key];for(;null!==current.ParentKey&&tree.has(current.ParentKey)&&!(handledItemKeys.indexOf(current.ParentKey)>=0);){if(history.indexOf(current.ParentKey)>=0){loopItemKeys.push(item.Key);break}current=tree.get(current.ParentKey),history.push(current.Key)}for(const key of history)handledItemKeys.push(key)}return loopItemKeys}(list);for(let i=0;i<list.length;i++)if(loopItemKeys.indexOf(list[i].Key)>=0){const oldItem=list[i];list[i]={Key:oldItem.Key,ParentKey:null,Data:oldItem.Data}}return list}(list));const kidmap=new Map(LazyMap(LazyFilter(IterableGroupBy(list,(t=>t.ParentKey)),(([tKey,_])=>null!==tKey)),(([tKey,t])=>[tKey,Array.from(t)]))),lookup=new Map(list.map((t=>[t.Key,t])));return OrderByLevelPrivate(list.filter((it=>null===it.ParentKey||!lookup.has(it.ParentKey))),kidmap,0)}(items,MakeKeyFn(scope,keyIdx),MakeKeyFn(scope,parentIdx))}function MakeKeyFn(getScope,fieldIndex){return t=>getScope(t)["@"][fieldIndex].GetValue().Value}function IndexOfAggregate(defExpr){const expr=compiler(defExpr),fnToken="function"===expr.Token.type?expr.Token:null,fn=null!==fnToken?expr:null;if(null===fnToken||"."===fnToken.value[0])throw new Error("InvalidOperationException");if(fnToken.value.toLowerCase()!=="GetAggregate".toLowerCase())throw new Error("InvalidOperationException");return SafeEval$1(fn.Children[0]).Value}function*OrderByLevelPrivate(items,kidmap,level){for(const it of items){yield[level,it.Data];const kids=kidmap.get(it.Key)||[];for(const t of OrderByLevelPrivate(kids,kidmap,level+1))yield t}}const IsLeafMember=member=>!member.Members||0===member.Members.length;function MakeIdFn(getLeafMembers){let iterator=null;const map=new Map;let index=0;return member=>{if(iterator||(iterator=getLeafMembers()[Symbol.iterator]()),map.has(member))return map.get(member);let current=iterator.next();for(;!current.done;){if(current.value===member)return index++;map.set(current.value,index++),current=iterator.next()}throw new Error("Bad code path")}}function GetLeafsFn(getRoots,isLeaf,getChildren,leavesFirst=!1){let leafs=null;return()=>(leafs||(leafs=Memoize$1(CollectLeafNodes(getRoots(),isLeaf,getChildren,leavesFirst))),leafs)}function CollectLeafNodes(members,isLeaf,getChildren,leavesFirst=!1){return{*[Symbol.iterator](){if(leavesFirst){for(let leaf of LazyFilter(members,(m=>isLeaf(m))))yield leaf;for(let branch of LazyFilter(members,(m=>!isLeaf(m))))for(let dataMember of CollectLeafNodes(getChildren(branch),isLeaf,getChildren,!0))yield dataMember}else for(let tablixDataMember of members)if(isLeaf(tablixDataMember))yield tablixDataMember;else for(let dataMember of CollectLeafNodes(getChildren(tablixDataMember),isLeaf,getChildren))yield dataMember}}}function FlattenMembers(members,arr=[]){return arr.push(...members),members.forEach((m=>FlattenMembers(m.Members||[],arr))),arr}function Intersect(first,second,indexSelector){return 0===first.length||0===second.length?[]:{*[Symbol.iterator](){yield*Math.abs(first.length-second.length)<=100?function*(first,second,indexSelector){let i1=0,i2=0,i=0,index=0;for(;i1<first.length&&i2<second.length;){const a=first[i1],b=second[i2],ai=indexSelector(a),bi=indexSelector(b);ai==bi?(0!=i&&ai==index||(i++,index=ai,yield a),i1++,i2++):ai<bi?i1++:i2++}}(first,second,indexSelector):function*(first,second,indexSelector){if(first.length>second.length){const t=first;first=second,second=t}const compare=(x,y)=>{const a=indexSelector(x),b=indexSelector(y);return Tools.Variant.isVariant(a)&&Tools.Variant.isVariant(b)?Tools.Variant.Comparison.Compare(a,b):a<b?-1:a>b?1:0};let start=0;for(let i=0;i<first.length;i++){const it=first[i],j=BinarySearch(second,start,second.length-start,it,compare);j>=0&&(start=j,0!==i&&indexSelector(first[i-1])==indexSelector(it)||(yield it))}}(first,second,indexSelector)}}}function BinarySearch(array,index,length,value,compare){let lower=index,upper=index+length-1;for(;lower<=upper;){const middle=lower+(upper-lower>>1),result=compare(array[middle],value);if(0===result)return middle;result<0?lower=middle+1:upper=middle-1}return~lower}function Apply(items,sort,getItem){if(null==sort||0==sort.length)return items;const comparer=MakeCompareFn((i=>sort[i].Direction));return Array.from(IterableOrderBy(items,(g=>sort.map((t=>getItem(g)["@"][t.FieldIndex].GetValue()))),comparer))}function DataTreeSortApply(groups,sort){return Apply(groups,sort,(g=>g))}function DataTreeSortApplyTablix(members,sort){return Apply(members,sort,(m=>m.Header))}function GetLastTablixContext$1(ctx){let result=null,context=ctx;for(;context.Parent;)context=context.Parent,DataTree.IsTablix(context.Region)&&(result=context);return result}function FindCellScope(nearestContext,distance){let currentContext=nearestContext;for(let i=0;i<distance;i++)currentContext=currentContext&&currentContext.Parent;return currentContext}const MakeCellAggregateKey=(index,row,col)=>`CellAggregateKey(${index},${row},${col})`,MakeCellAggregateKeyByScopeCell=key=>`CellAggregateKey(${ScopeCellAggregateKey.getIndex(key)},${ScopeCellAggregateKey.getRow(key)},${ScopeCellAggregateKey.getCol(key)})`,ScopeCellAggregateKey={getIndex:key=>+key.slice("ScopeCellAggregateKey(".length).split(",")[0],getRow:key=>+key.slice("ScopeCellAggregateKey(".length).split(",")[1],getCol:key=>+key.slice("ScopeCellAggregateKey(".length).split(",")[2]};function MakeCellFn(dtg,compileContext,content,original){const runningValues=[],scopeFn=MakeScopeFn$1(dtg,compileContext,content,original,runningValues);return ctx=>(function(ctx,cellRunningValues){for(let key of cellRunningValues){let scopeContext=null;if(ScopeCellAggregateKey.getRow(key)>-1&&(scopeContext=FindCellScope(ctx.Parent,ScopeCellAggregateKey.getRow(key))),ScopeCellAggregateKey.getCol(key)>-1&&(scopeContext=FindCellScope(ctx.Column,ScopeCellAggregateKey.getCol(key))),scopeContext||(scopeContext=GetLastTablixContext$1(ctx)),scopeContext&&scopeContext.ScopeCellRunningValues[key]){const aggKey=MakeCellAggregateKeyByScopeCell(key);if(!ctx.CellRunningValues[aggKey]){const value=scopeContext.ScopeCellRunningValues[key].Combine(ctx.Scope["@"][ScopeCellAggregateKey.getIndex(key)]);ctx.CellRunningValues[aggKey]=value,scopeContext.ScopeCellRunningValues[key]=value}}else{const value=ctx.Scope["@"][ScopeCellAggregateKey.getIndex(key)];ctx.CellRunningValues[MakeCellAggregateKeyByScopeCell(key)]=value,scopeContext.ScopeCellRunningValues[key]=value}}}(ctx,runningValues),scopeFn(ctx))}const MakeMemberIndexFn=()=>{let index=0;return member=>IsLeafMember(member)?index++:-1};function MakeTablixFn(dtg,compileContext,def,original){const columnIdx=MakeMemberIndexFn(),rowIdx=MakeMemberIndexFn(),scopeFn=MakeScopeFn$1(dtg,compileContext,def.Content,original.Content),columnFns=MakeMemberFns(dtg,compileContext,def.ColumnMembers,original.ColumnMembers,columnIdx),rowFns=MakeMemberFns(dtg,compileContext,def.RowMembers,original.RowMembers,rowIdx),bodyFns=IterableToArray(LazyZipEx(def.Body,original.Body,((i,row1,row2)=>IterableToArray(LazyZipEx(row1.Cells,row2.Cells,((j,cell1,cell2)=>MakeCellFn(dtg,Object.assign(Object.assign({},MakeCompileContext$1(compileContext)),{Row:i,Column:j,Tablix:compileContext,Name:def.Name}),cell1,cell2)))))));return ctx=>{let columnMembers=[],rowMembers=[];const getColumnLeafs=GetLeafsFn((()=>columnMembers),(m=>IsLeafTxMember$1(m)),(m=>m.MakeMembers()),!1),getRowLeafs=GetLeafsFn((()=>rowMembers),(m=>IsLeafTxMember$1(m)),(m=>m.MakeMembers()),!0),columnIdFn=MakeIdFn(getColumnLeafs),rowIdFn=MakeIdFn(getRowLeafs),tablix=ctx.Region,scope=scopeFn(ctx);return columnMembers=IterableToArray(LazyZipEx(columnFns,tablix.ColumnMembers,((i,fn,m)=>fn(MakeEvalContextByMember(m,ctx),columnIdFn)))),rowMembers=IterableToArray(LazyZipEx(rowFns,tablix.RowMembers,((i,fn,m)=>fn(MakeEvalContextByMember(m,ctx),rowIdFn)))),DataTree.Makers.Tablix(scope,columnMembers.map(MakeTablixMember$1),rowMembers.map(MakeTablixMember$1),(()=>{const columnLeafs=IterableToArray(getColumnLeafs());return LazyMap(getRowLeafs(),(rowMember=>function(tablix,rowMember,columnLeafs,bodyFns){const row=GetCollectionItem(tablix.Body,rowMember.AggregateId),cells=new Array(columnLeafs.length);let prevCell=null;for(let j=0;j<cells.length;j++){const columnMember=columnLeafs[j],ex=MakeEvalContextByScope(row.Cells[columnMember.AggregateId],rowMember.Context,prevCell,columnMember.Context);cells[j]=bodyFns[rowMember.DefIndex][columnMember.DefIndex](ex),prevCell=ex}return DataTree.Makers.TablixRow(cells)}(tablix,rowMember,columnLeafs,bodyFns)))}),def.Name)}}function CreateTxMember$1(context,header,isCollection,defIndex,aggregateId,idFn,makeMembers){return{Context:context,DefIndex:defIndex,Header:header,IsCollection:isCollection,IdFn:idFn,MakeMembers:Once$1(makeMembers),AggregateId:aggregateId,_id:-1}}function Once$1(fn){let result=null;return()=>(result||(result=Memoize$1(fn())),result)}const IsLeafTxMember$1=m=>!m.IsCollection&&m.DefIndex>=0;function MakeTablixMember$1(m){return DataTree.Makers.TablixMember(m.Header,m.IsCollection,(m=>IsLeafTxMember$1(m)?(m._id<0&&(m._id=m.IdFn(m)),m._id):-1)(m),(()=>LazyMap(m.MakeMembers(),MakeTablixMember$1)))}function MakeMemberFns(dtg,compileContext,members,original,idx){return IterableToArray(LazyZipEx(members,original,((i,m1,m2)=>function(dtg,compileContext,def,original,idx){const defIndex=idx(def),filterFn=MakeFilterFn(dtg,compileContext,def.Group||null),sortFn=MakeSortFn$1(dtg,compileContext,def.Sort||[]),headerFn=MakeScopeFn$1(dtg,compileContext,def.Header||Def.EmptyContent,original.Header||Def.EmptyContent),membersFn=IterableToArray(MakeMemberFns(dtg,compileContext,def.Members||[],original.Members||[],idx)),levelFn=def.Group?MakeFn$2(def.Group):null,isDetail=original.Group&&0===(original.Group.GroupExpressions||[]).length;return(ctx,idFn)=>{const member=ctx.Member;if(member.IsCollection){const makeMembers=()=>{let members=member.Members;if(dtg.InteractiveSort){const sort=GetSort(ctx,dtg.InteractiveSort,original.Header||Def.EmptyContent);sort&&(members=DataTreeSortApplyTablix(IterableToArray(members),isDetail?sort.filter((s=>!s.SortExpressionScope)):sort.filter((s=>def.Group&&s.SortExpressionScope===def.Group.Name))))}let levels=null;if(null!==levelFn){const pairs=IterableToArray(levelFn(members,(m=>m.Header)));members=pairs.map((([_,value])=>value)),levels=pairs.map((([key,_])=>key))}let contexts=function(parent,members,levels){return{*[Symbol.iterator](){let prev=null,i=0;for(let m of members){const level=levels?levels[i]:0,current=MakeEvalContextByMember(m,parent,prev);if(current.Level=level,current.GroupIndex=i,levels){const index=i;current.GetDescendants=()=>GetDescendants$1(members,levels,index)}yield current,prev=current,i++}}}}(ctx.Parent,members,levels);contexts=sortFn(filterFn(contexts));let prevCell=null;return LazyMap(contexts,(mx=>{const m=mx.Member;return CreateTxMember$1(mx,headerFn(mx),!1,defIndex,void 0===m.Id?-1:m.Id,idFn,(()=>LazyZipEx(membersFn,m.Members,((i,fn,t)=>fn(prevCell=MakeEvalContextByMember(t,mx,prevCell),idFn)))))}))};return CreateTxMember$1(ctx,null,!0,-1,-1,idFn,makeMembers)}const header=headerFn(ctx);return CreateTxMember$1(ctx,header,!1,defIndex,void 0===member.Id?-1:member.Id,idFn,(()=>LazyZipEx(membersFn,member.Members,((i,fn,m)=>fn(MakeEvalContextByMember(m,ctx),idFn)))))}}(dtg,MakeCompileContext$1(compileContext),m1,m2,idx))))}function GetDescendants$1(members,levels,index){return{*[Symbol.iterator](){const level=levels[index];for(let i=index+1;i<members.length&&!(levels[i]<=level);i++)yield GetCollectionItem(members,i).Header}}}function FindPreviousImpl(current,path){if(path.length>0&&"Tablix"===path[0].Type)return function(expressionContext,path){var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l,_m,_o,_p,_q,_r;const tablix=GetTablix(expressionContext);path=path.slice(1);const isColumn="Column"==(null===(_a=path[0])||void 0===_a?void 0:_a.Type),isHeader=!expressionContext.Column;isColumn&&isHeader&&(path=path.slice(1));const scopePath=[];let currentContext=expressionContext,scopeFound=!1,parentFound=!1;for(const pathItem of path){switch(pathItem.Type){case"Scope":scopeFound=!0;break;case"Member":scopePath.push(ScopePathItemIdx(pathItem.Indexes[0]));break;case"Group":if(scopeFound){if(null==currentContext?void 0:currentContext.Previous){currentContext=currentContext.Previous,parentFound=!0;break}scopePath.push(ScopePathItemLast()),currentContext=null!==(_c=null==currentContext?void 0:currentContext.Parent)&&void 0!==_c?_c:null}else{const currentMember=null==currentContext?void 0:currentContext.Member;if((null==currentMember?void 0:currentMember.Header)&&currentMember.Header["@"].length>0){const scopeGroupingValues=currentMember.Header["@"].map((x=>x.GetValue()));scopePath.push(ScopePathItemValues(scopeGroupingValues))}currentContext=null!==(_b=null==currentContext?void 0:currentContext.Parent)&&void 0!==_b?_b:null}break;case"Column":currentContext=null!==(_d=null==currentContext?void 0:currentContext.Column)&&void 0!==_d?_d:null;break;default:currentContext=null!==(_e=null==currentContext?void 0:currentContext.Parent)&&void 0!==_e?_e:null}if(parentFound)break}if(!parentFound)return null;let curMem=null!==(_f=null==currentContext?void 0:currentContext.Member)&&void 0!==_f?_f:null;for(;scopePath.length>0;){const pathItem=scopePath.pop(),members=curMem?IterableToArray(curMem.Members):isColumn?tablix.ColumnMembers:tablix.RowMembers;switch(pathItem.Type){case"Index":curMem=members[pathItem.Index];break;case"Last":curMem=members[members.length-1];break;case"Values":curMem=null!==(_g=members.find((x=>pathItem.ScopeValues.length===x.Header["@"].length&&x.Header["@"].every(((y,i)=>Tools.Variant.Comparison.Equals(y.GetValue(),pathItem.ScopeValues[i]).Value)))))&&void 0!==_g?_g:null}curMem&&!curMem.IsCollection&&(currentContext=MakeEvalContextByMember(curMem,currentContext))}return curMem?isHeader?MakeEvalContextByScope(curMem.Header,currentContext):(null!==(_h=curMem.Id)&&void 0!==_h?_h:-1)<0?null:isColumn?MakeEvalContextByScope(GetCollectionItem(tablix.Body,null!==(_l=null===(_k=null===(_j=expressionContext.Parent)||void 0===_j?void 0:_j.Member)||void 0===_k?void 0:_k.Id)&&void 0!==_l?_l:-1).Cells[null!==(_m=curMem.Id)&&void 0!==_m?_m:-1],expressionContext.Parent,null,currentContext):MakeEvalContextByScope(GetCollectionItem(tablix.Body,null!==(_o=curMem.Id)&&void 0!==_o?_o:-1).Cells[null!==(_r=null===(_q=null===(_p=expressionContext.Column)||void 0===_p?void 0:_p.Member)||void 0===_q?void 0:_q.Id)&&void 0!==_r?_r:-1],currentContext):null}(current,path);let{previous:parent,searchKeys:searchKeys}=function(scope,path){const searchKeys=[];for(let param of path){if(!scope)break;const keys=[];param.IsRegion||keys.push(...param.Indexes.filter((_=>scope&&scope.Scope)).map((t=>scope.Scope["@"][t].GetValue()))),searchKeys.push(keys),scope=scope.Parent}return{previous:scope,searchKeys:searchKeys}}(current,path);if(!parent)return null;const previous=function(ctx){let previous=ctx.Previous;if(previous)return previous;let level=1,parent=ctx.Parent;for(;parent&&(previous=parent.Previous,!previous);)parent=parent.Parent,(null==parent?void 0:parent.Region)&&level++;if(previous){for(;level>0;){const last=previous?IterableLast(previous.Children):null;if(!last)break;previous=last,level--}return previous}return null}(parent);if(!previous)return null;searchKeys.reverse(),path=[...path].reverse();let evalContext=previous,scope=previous.Scope,region=previous.Region;for(var i=0;i<path.length;i++){const param=path[i];if(param.IsRegion){if(!scope)return null;if(region=DataTree.IsList(scope.Regions[param.Indexes[0]])?scope.Regions[param.Indexes[0]]:null,!region)return null;evalContext=MakeEvalContextByRegion(region,evalContext)}else{if(!region)return null;if(scope=IterableFind(region.Groups,(g=>{var ctx=MakeEvalContextByScope(g,evalContext);return Eq(param.Indexes.map((t=>ctx.Scope["@"][t].GetValue())),searchKeys[i])})).Item,!scope)return null;evalContext=MakeEvalContextByScope(scope,evalContext)}}return scope?evalContext:null}const ScopePathItemValues=values=>({Type:"Values",ScopeValues:values,Index:-1}),ScopePathItemLast=()=>({Type:"Last",ScopeValues:[],Index:-1}),ScopePathItemIdx=idx=>({Type:"Index",ScopeValues:[],Index:idx});function Eq(arr,other){if(!arr)return null===other;if(!other)return!1;if(arr.length!==other.length)return!1;for(let i=0;i<arr.length;i++){const ieq=arr[i];if(isVariant(ieq)){if(!Tools.Variant.Comparison.Equals(ieq,other[i]).Value)return!1;if(!ieq.Equals(other[i]))return!1}else if(arr[i]===other[i])return!1}return!0}function _isPlaceholder(a){return null!=a&&"object"==typeof a&&!0===a["@@functional/placeholder"]}function _curry1(fn){return function f1(a){return 0===arguments.length||_isPlaceholder(a)?f1:fn.apply(this,arguments)}}function _curry2(fn){return function f2(a,b){switch(arguments.length){case 0:return f2;case 1:return _isPlaceholder(a)?f2:_curry1((function(_b){return fn(a,_b)}));default:return _isPlaceholder(a)&&_isPlaceholder(b)?f2:_isPlaceholder(a)?_curry1((function(_a){return fn(_a,b)})):_isPlaceholder(b)?_curry1((function(_b){return fn(a,_b)})):fn(a,b)}}}function _arity(n,fn){switch(n){case 0:return function(){return fn.apply(this,arguments)};case 1:return function(a0){return fn.apply(this,arguments)};case 2:return function(a0,a1){return fn.apply(this,arguments)};case 3:return function(a0,a1,a2){return fn.apply(this,arguments)};case 4:return function(a0,a1,a2,a3){return fn.apply(this,arguments)};case 5:return function(a0,a1,a2,a3,a4){return fn.apply(this,arguments)};case 6:return function(a0,a1,a2,a3,a4,a5){return fn.apply(this,arguments)};case 7:return function(a0,a1,a2,a3,a4,a5,a6){return fn.apply(this,arguments)};case 8:return function(a0,a1,a2,a3,a4,a5,a6,a7){return fn.apply(this,arguments)};case 9:return function(a0,a1,a2,a3,a4,a5,a6,a7,a8){return fn.apply(this,arguments)};case 10:return function(a0,a1,a2,a3,a4,a5,a6,a7,a8,a9){return fn.apply(this,arguments)};default:throw new Error("First argument to _arity must be a non-negative integer no greater than ten")}}function _curry3(fn){return function f3(a,b,c){switch(arguments.length){case 0:return f3;case 1:return _isPlaceholder(a)?f3:_curry2((function(_b,_c){return fn(a,_b,_c)}));case 2:return _isPlaceholder(a)&&_isPlaceholder(b)?f3:_isPlaceholder(a)?_curry2((function(_a,_c){return fn(_a,b,_c)})):_isPlaceholder(b)?_curry2((function(_b,_c){return fn(a,_b,_c)})):_curry1((function(_c){return fn(a,b,_c)}));default:return _isPlaceholder(a)&&_isPlaceholder(b)&&_isPlaceholder(c)?f3:_isPlaceholder(a)&&_isPlaceholder(b)?_curry2((function(_a,_b){return fn(_a,_b,c)})):_isPlaceholder(a)&&_isPlaceholder(c)?_curry2((function(_a,_c){return fn(_a,b,_c)})):_isPlaceholder(b)&&_isPlaceholder(c)?_curry2((function(_b,_c){return fn(a,_b,_c)})):_isPlaceholder(a)?_curry1((function(_a){return fn(_a,b,c)})):_isPlaceholder(b)?_curry1((function(_b){return fn(a,_b,c)})):_isPlaceholder(c)?_curry1((function(_c){return fn(a,b,_c)})):fn(a,b,c)}}}var _isArray=Array.isArray||function(val){return null!=val&&val.length>=0&&"[object Array]"===Object.prototype.toString.call(val)};var _isArrayLike=_curry1((function(x){return!!_isArray(x)||!!x&&("object"==typeof x&&(!function(x){return"[object String]"===Object.prototype.toString.call(x)}(x)&&(0===x.length||x.length>0&&(x.hasOwnProperty(0)&&x.hasOwnProperty(x.length-1)))))})),symIterator="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator";function _createReduce(arrayReduce,methodReduce,iterableReduce){return function(xf,acc,list){if(_isArrayLike(list))return arrayReduce(xf,acc,list);if(null==list)return acc;if("function"==typeof list["fantasy-land/reduce"])return methodReduce(xf,acc,list,"fantasy-land/reduce");if(null!=list[symIterator])return iterableReduce(xf,acc,list[symIterator]());if("function"==typeof list.next)return iterableReduce(xf,acc,list);if("function"==typeof list.reduce)return methodReduce(xf,acc,list,"reduce");throw new TypeError("reduce: list must be array or iterable")}}function _xArrayReduce(xf,acc,list){for(var idx=0,len=list.length;idx<len;){if((acc=xf["@@transducer/step"](acc,list[idx]))&&acc["@@transducer/reduced"]){acc=acc["@@transducer/value"];break}idx+=1}return xf["@@transducer/result"](acc)}var bind=_curry2((function(fn,thisObj){return _arity(fn.length,(function(){return fn.apply(thisObj,arguments)}))}));function _xIterableReduce(xf,acc,iter){for(var step=iter.next();!step.done;){if((acc=xf["@@transducer/step"](acc,step.value))&&acc["@@transducer/reduced"]){acc=acc["@@transducer/value"];break}step=iter.next()}return xf["@@transducer/result"](acc)}function _xMethodReduce(xf,acc,obj,methodName){return xf["@@transducer/result"](obj[methodName](bind(xf["@@transducer/step"],xf),acc))}var _xReduce=_createReduce(_xArrayReduce,_xMethodReduce,_xIterableReduce),XWrap=function(){function XWrap(fn){this.f=fn}return XWrap.prototype["@@transducer/init"]=function(){throw new Error("init not implemented on XWrap")},XWrap.prototype["@@transducer/result"]=function(acc){return acc},XWrap.prototype["@@transducer/step"]=function(acc,x){return this.f(acc,x)},XWrap}();var reduce=_curry3((function(xf,acc,list){return _xReduce("function"==typeof xf?new XWrap(xf):xf,acc,list)}));function _pipe(f,g){return function(){return g.call(this,f.apply(this,arguments))}}function _checkForMethod(methodname,fn){return function(){var length=arguments.length;if(0===length)return fn();var obj=arguments[length-1];return _isArray(obj)||"function"!=typeof obj[methodname]?fn.apply(this,arguments):obj[methodname].apply(obj,Array.prototype.slice.call(arguments,0,length-1))}}var tail=_curry1(_checkForMethod("tail",_curry3(_checkForMethod("slice",(function(fromIndex,toIndex,list){return Array.prototype.slice.call(list,fromIndex,toIndex)})))(1,1/0)));function pipe(){if(0===arguments.length)throw new Error("pipe requires at least one argument");return _arity(arguments[0].length,reduce(_pipe,arguments[0],tail(arguments)))}const toExprSafeValue=Tools.Variant.Convert.toSafeValue;function stringifyDates(value){return dateTimeFactory_isDateTime(value)?{DataType:"Date",Value:value.toISOString()}:value instanceof Array?value.map((v=>stringifyDates(v))):"object"==typeof value&&null!=value?mapDictionary(value,(v=>stringifyDates(v))):value}const variantSerializer_serialize=value=>value===Tools.Variant.DBNull?null:stringifyDates(value.Value),Zero=Tools.Variant.Zero,Null$1=Tools.Variant.Null,CreateVariant=Tools.Variant.Create;function MakeCompileContext$1(parent=null){return parent?{Parent:parent,Tablix:null,Name:"",Row:parent.Row,Column:parent.Column,RunningValues:[],ScopeRunningValues:[]}:{Parent:null,Tablix:null,Name:"",Row:0,Column:0,RunningValues:[],ScopeRunningValues:[]}}function MakeEvalContextByScope(scope,parent=null,previous=null,column=null,expressionContext=null,scopeRunningValues=null){const ec={Scope:scope,Parent:parent,Previous:previous,Column:column,Member:null,RunningValues:{},CellRunningValues:{},ScopeCellRunningValues:{},ScopeRunningValues:previous?previous.ScopeRunningValues:scopeRunningValues,App:!expressionContext&&parent?parent&&parent.App||null:expressionContext,Children:[],Data:RecordSet.Empty,GetDescendants:()=>[],Level:0,Region:null,GroupIndex:-1};return ec.Children=LazyMapMany(scope?scope.Regions:[],(r=>LazyMap(r.Groups,(g=>MakeEvalContextByScope(g,ec))))),function(ctx){if(ctx.Previous)for(let key in ctx.Previous.RunningValues){const numKey=parseInt(key),runningValue=ctx.Previous.RunningValues[key];if(null===ctx.ScopeRunningValues||ctx.ScopeRunningValues.indexOf(numKey)>-1){const prevAggregateValue=runningValue,thisValue=ctx.Scope["@"][numKey],thisAggValue=prevAggregateValue.Combine(thisValue);ctx.RunningValues[key]=thisAggValue}else{const thisValue=ctx.Scope["@"][numKey];ctx.RunningValues[key]=thisValue}}}(ec),ec}function MakeEvalContextByRegion(region,parent=null,previous=null,expressionContext=null,scopeRunningValues=null){return Object.assign(Object.assign({},MakeEvalContextByScope(region.Scope,parent,previous,null,expressionContext,scopeRunningValues)),{Region:region})}function MakeEvalContextByMember(member,parent=null,previous=null){return Object.assign(Object.assign({},MakeEvalContextByScope(member.Header,parent,previous)),{Member:member})}function GetLevel(ctx,parent,axis){if(null==axis&&null==parent&&ctx.Column){const colLevel=GetLevel(ctx.Column,0,0);if(0!==colLevel.Value)return colLevel}parent=null!=parent?parent:0;let scope=0===(axis=null!=axis?axis:0)?ctx:ctx.Column;for(;null!==scope&&parent-- >0;)scope=scope.Parent;return null===scope||DataTree.IsEmpty(scope.Scope)?null!==ctx.Column?CreateVariant(function(column){let level=column.Level;var context=column.Parent;for(;0===level&&null!==context;)level=context.Level,context=context.Parent;return level}(ctx.Column)):Zero:CreateVariant(scope.Level)}function GetTablix(ctx){return pipe(iterable$1.map((x=>x.Region)),iterable$1.filter(DataTree.IsTablix),iterable$1.first)(Recursive(ctx,(p=>p.Parent)))}function GetLeaf(currentMember){for(;currentMember.Members.length>0;)currentMember=GetCollectionItem(currentMember.Members,0);return currentMember}function FindParent(parent,ctx){return pipe(iterable$1.filter((p=>{var _a;return!(null===(_a=p.Member)||void 0===_a?void 0:_a.IsCollection)})),iterable$1.skip(parent),iterable$1.first)(Recursive(ctx,(p=>p.Parent)))}function Generate(report,original,tree,interactiveSort=null,ctx=null,makeContext=null){return MakeRegionFn$1({InteractiveSort:interactiveSort,MakeContext:makeContext},MakeCompileContext$1(),report,original)(MakeEvalContextByRegion(tree,null,null,ctx))}function MakeRegionFn$1(dtg,compileContext,region,original){switch(region.type){case"list":return function(dtg,compileContext,def,original){const scopeFn=MakeScopeFn$1(dtg,compileContext,def.Content,original.Content),itemCompileContext=MakeCompileContext$1(compileContext),itemFn=MakeScopeFn$1(dtg,itemCompileContext,def.GroupContent,original.GroupContent),isDetail=null!=def.Group&&0===(def.Group.GroupExpressions||[]).length,filterFn=MakeFilterFn(dtg,compileContext,def.Group),sortFn=MakeSortFn$1(dtg,compileContext,def.Sort),levelFn=MakeFn$2(def.Group);return ctx=>{const list=ctx.Region,scope=scopeFn(ctx);return DataTree.Makers.List(scope,(()=>{let items=list.Groups;if(null!==dtg.InteractiveSort){const sort=GetSort(ctx,dtg.InteractiveSort,original.GroupContent);null!=sort&&(items=DataTreeSortApply(Array.from(items),isDetail?sort.filter((s=>!s.SortExpressionScope)):sort.filter((s=>s.SortExpressionScope===def.Group.Name))))}let levels=null;if(null!==levelFn){const pairs=Array.from(levelFn(items,(t=>t)));items=pairs.map((([_,value])=>value)),levels=pairs.map((([key,_])=>key))}return LazyMap(sortFn(filterFn(function*(parent,items,levels,scopeRunningValues){let prev=null,i=0;for(let item of items){const level=null!==levels?levels[i]:0,current=MakeEvalContextByScope(item,parent,prev,null,null,scopeRunningValues);if(current.Level=level,current.GroupIndex=i,null!==levels){const index=i;current.GetDescendants=()=>GetDescendants(items,levels,index)}yield current,prev=current,i++}}(ctx,items,levels,itemCompileContext.ScopeRunningValues))),(c=>itemFn(c)))}),list.Name)}}(dtg,compileContext,region,original);case"tablix":return MakeTablixFn(dtg,compileContext,region,original);case"subreport":return function(dtg,compileContext,def,original){const scopeFn=MakeScopeFn$1(dtg,compileContext,def.Content,original.Content),reportFn=MakeRegionFn$1(dtg,MakeCompileContext$1(compileContext),def.Report,original.Report);return ctx=>{const region=ctx.Region,scope=scopeFn(ctx);let groups=[];const rptScope=GetCollectionItem(region.Groups,0);if(rptScope){const args=def.Parameters.map((p=>({Name:p.Name,Eval:compile(p.Value)}))).map((p=>({Name:p.Name,Value:p.Eval(ctx)}))),subReportContext=dtg.MakeContext&&dtg.MakeContext(def.Report,args),rptRegion=DataTree.Makers.List(rptScope,[],def.Name);groups=[reportFn(MakeEvalContextByRegion(rptRegion,null,null,subReportContext&&subReportContext.ExpressionContext)).Scope]}return DataTree.Makers.List(scope,groups,region.Name)}}(dtg,compileContext,region,original);default:return function(dtg,compileContext,def,original){const scopeFn=MakeScopeFn$1(dtg,compileContext,def.Content,original.Content);return ctx=>{const scope=scopeFn(ctx);return DataTree.Makers.List(scope,[],ctx.Region.Name)}}(dtg,compileContext,region,original)}}function MakeScopeFn$1(dtg,compileContext,content,original,cellRunningValues=null){if(!content||Def.IsEmptyContent(content))return ctx=>DataTree.Makers.Scope([],[],ctx.Scope.Id);const fieldFns=content.Fields.map((f=>function(compileContext,expression,cellRunningValues){return function(compileContext,exp,cellRunningValues){if(null===exp)return;const expression=compiler(exp);CompileNode(compileContext,expression,cellRunningValues)}(compileContext,expression,cellRunningValues),compile(expression)}(compileContext,f,cellRunningValues))),regionFns=Array.from(LazyZipEx(content.Regions,original.Regions,((i,r1,r2)=>MakeRegionFn$1(dtg,MakeCompileContext$1(compileContext),r1,r2))));return ctx=>{if(!ctx.Previous)for(let i of compileContext.RunningValues)if(ctx.Scope){const startValue=ctx.Scope["@"][i];ctx.RunningValues[i]=startValue}const values=fieldFns.map((fn=>fn(ctx))).map((v=>(v=>stringifyDates(toExprSafeValue(v)))(v)));return DataTree.Makers.Scope(values,(()=>IterableToArray(LazyZipEx(regionFns,ctx.Scope.Regions,((i,fn,r)=>fn(MakeEvalContextByRegion(r,ctx,null,null,compileContext.ScopeRunningValues)))))),ctx.Scope.Id)}}function CompileNode(compileContext,expression,cellRunningValues){var index,rowScopeDistance,colScopeDistance,row,col,name;if(expression)if("function"===expression.Token.type&&"."!==expression.Token.value[0]&&"getrunningvalue"==expression.Token.value.toLowerCase()){let currentConext=compileContext;const aggregateIndexes=expression.Children.map((a=>Tools.Variant.Convert.toInteger(SafeEval$1(a))));for(let i=0;i<aggregateIndexes.length;i++){const index=aggregateIndexes[i];if(currentConext.RunningValues.push(index),i<aggregateIndexes.length-1&&currentConext.ScopeRunningValues.push(index),currentConext=currentConext.Parent,!currentConext)break}}else if("function"===expression.Token.type&&"."!==expression.Token.value[0]&&"getcellrunningvalue"==expression.Token.value.toLowerCase()&&cellRunningValues){const args=expression.Children.map((a=>Tools.Variant.Convert.toInteger(SafeEval$1(a))));if(cellRunningValues.push((index=args[0],rowScopeDistance=args[1],colScopeDistance=args[2],row=compileContext.Row,col=compileContext.Column,name=compileContext.Name,`ScopeCellAggregateKey(${index},${rowScopeDistance},${colScopeDistance},${row},${col},${name})`)),args.length>3&&compileContext.Tablix){let currentConext=compileContext.Tablix.Parent;const aggregateIndexes=expression.Children.slice(3).map((a=>Tools.Variant.Convert.toInteger(SafeEval$1(a))));for(let index of aggregateIndexes){if(!currentConext)break;currentConext.RunningValues.push(index),currentConext.ScopeRunningValues.push(index),currentConext=currentConext.Parent}}}else if("function"===expression.Token.type||"operator"===expression.Token.type)for(let arg of expression.Children)CompileNode(compileContext,arg,cellRunningValues)}function*GetDescendants(items,levels,index){const level=levels[index];for(let i=index+1;i<items.length&&!(levels[i]<=level);i++)yield GetCollectionItem(items,i)}function MakeFilterFn(dtg,compileContext,grp){return null!==grp&&grp.Filters&&0!=grp.Filters.length?Make(grp.Filters,(f=>MakeFieldsFn(dtg,compileContext,f))):Empty}function MakeSortFn$1(dtg,compileContext,sort){if(0==sort.length)return NoSort;const fieldsFn=MakeFieldsFn(dtg,compileContext,sort.map((s=>s.Expression)));return MakeSortFn$2(sort,fieldsFn)}function MakeFieldsFn(dtg,compileContext,fields){const content={Fields:fields,Regions:[]},scopeFn=MakeScopeFn$1(dtg,compileContext,content,content);return ctx=>scopeFn(ctx)["@"].map((t=>CreateVariant(t)))}function GetSort(ctx,store,details){if(null==store||0==Object.keys(store).length)return null;const fields=[],list=[];let scope=ctx;for(;null!=scope;){if(null==scope.Scope)throw new Error("Scope undefined.");const sort=store[scope.Scope.Id];if(sort)for(const f of sort){const sortExpr=compiler(f.SortExpression),agg="function"===sortExpr.Token.type?Describe(sortExpr):null;if(null!=agg&&agg.IsScopeSpecified&&agg.ScopeName!=f.SortExpressionScope)continue;if(fields.indexOf(f.SortExpression)>=0)continue;const detailsFields=details.Fields.map(compiler),i=null==agg||null==agg.Arguments||0==agg.Arguments.length?IndexOfListField(detailsFields,sortExpr):detailsFields.findIndex((fld=>{const fnToken="function"===fld.Token.type?fld.Token:null;return null!==fnToken&&0===fnToken.value.localeCompare(agg.Func,void 0,{sensitivity:"accent"})&&fld.Children.length>0&&fld.Children[0].ToString()===agg.Arguments[0].ToString()}));i>=0&&(list.push({SortExpressionScope:f.SortExpressionScope,FieldIndex:i,Direction:f.Direction}),fields.push(f.SortExpression))}scope=scope.Parent}return 0===list.length?null:list}function IndexOfListField(fields,field){return fields.findIndex((f=>{const functionEx="function"===f.Token.type?f:null;return null!==functionEx&&functionEx.Children.length>0?functionEx.Children[0].ToString()===field.ToString():f.ToString()===field.ToString()}))}function*Recursive(obj,getNext){for(;null!=obj;)yield obj,obj=getNext(obj)}const Create$1=Tools.Variant.Create,isVariant$1=Tools.Variant.isVariant,Null=Tools.Variant.Null,MakeEvaluationContext=(data,ctx)=>({Data:{fields:data,parameters:ctx.App&&ctx.App.Parameters},Context:ctx});function MakeCompileContext(dataSet){if(null===dataSet||null===dataSet.FieldNames)return null;return{FiledNameIndex:dataSet.FieldNames.reduce(((o,exp,i)=>Object.assign(Object.assign({},o),{[i]:exp})),{}),AggregateDataProvider:null}}const customFunctions={GetAggregate:(ctx,args)=>{const resolvedArgs=args.map((a=>SafeEval$1(a,ctx))).map((v=>v.Value));return function(ctx,index,parent,axis,recursive){let scope=0==axis?ctx:ctx.Column;for(;null!=scope&&parent-- >0;)scope=scope.Parent;if(null==scope||null==scope.Scope)return Null$1;let agg=scope.Scope["@"][index];return recursive&&(agg=IterableToArray(scope.GetDescendants()).reduce(((a,b)=>a.Combine(b["@"][index])),agg)),agg.GetValue()}(ctx.Context,resolvedArgs[0]||0,resolvedArgs[1]||0,resolvedArgs[2]||0,!!resolvedArgs[3]||!1)},GetRegionAggregate:(ctx,args)=>{const resolvedArgs=args.map((a=>SafeEval$1(a,ctx).Value));return function(ctx,index,parent,region){let scope=ctx;for(;scope&&parent-- >0;)scope=scope.Parent;return scope&&scope.Scope?scope.Scope.Regions[region].Scope["@"][index].GetValue():Null$1}(ctx.Context,resolvedArgs[0]||0,resolvedArgs[1]||0,resolvedArgs[2]||0)},GetRunningValue:(ctx,args)=>{const resolvedArgs=args.map((a=>SafeEval$1(a,ctx).Value));return ctx.Context?function(scope,aggregateIndexes){if(0===aggregateIndexes.length)return Tools.Variant.Null;let valueAggregate=scope.RunningValues[aggregateIndexes[0]],currentScope=scope.Parent;return aggregateIndexes.slice(1,Math.max(aggregateIndexes.length-1,1)).forEach((i=>{if(currentScope){const aggregate=currentScope.Previous?currentScope.Previous.RunningValues[i]:null;currentScope=currentScope.Parent,aggregate&&(valueAggregate=valueAggregate?valueAggregate.Combine(aggregate):aggregate)}})),null===valueAggregate?Tools.Variant.Null:valueAggregate.GetValue()}(ctx.Context,resolvedArgs):Null},GetCellRunningValue:(ctx,args)=>{const resolvedArgs=args.map((a=>SafeEval$1(a,ctx).Value));return ctx.Context?function(scope,data){let currentScope=scope,valueAggregate=null;return currentScope=GetLastTablixContext$1(currentScope),currentScope=currentScope&&currentScope.Parent,currentScope&&currentScope.Previous&&data.slice(3).forEach((i=>{if(currentScope){const aggregate=currentScope.Previous?currentScope.RunningValues[i]:null;currentScope=currentScope.Parent,aggregate&&(valueAggregate=valueAggregate?valueAggregate.Combine(aggregate):aggregate)}})),valueAggregate?valueAggregate.Combine(scope.CellRunningValues[MakeCellAggregateKey(data[0],data[1],data[2])]).GetValue():scope.CellRunningValues[MakeCellAggregateKey(data[0],data[1],data[2])].GetValue()}(ctx.Context,resolvedArgs):Null},GetCrossAggregate:(ctx,args)=>{const resolvedArgs=args.map((a=>SafeEval$1(a,ctx))).map((v=>v.Value));if(5!==resolvedArgs.length)throw new Error("Invalid arguments list for CrossAggregate function");return function(ctx,rowMemberId,rowDistance,colMemberId,colDistance,exprIndex){const tablix=GetTablix(ctx);if(null===tablix)return Null$1;const rowParentContext=FindParent(rowDistance,ctx.Parent);if(null===rowParentContext)return Null$1;const colParentContext=FindParent(colDistance,ctx.Column);if(null===colParentContext)return Null$1;const rowId=0===rowDistance?ctx.Parent.Member.Id:GetLeaf(GetCollectionItem(rowParentContext.Member.Members,rowMemberId)).Id,colId=0===colDistance?ctx.Column.Member.Id:GetLeaf(GetCollectionItem(colParentContext.Member.Members,colMemberId)).Id;return GetCollectionItem(tablix.Body,rowId).Cells[colId]["@"][exprIndex].GetValue()}(ctx.Context,resolvedArgs[0],resolvedArgs[1],resolvedArgs[2],resolvedArgs[3],resolvedArgs[4])},RowNumber:ctx=>ctx.Context?Create$1(ctx.Context.RowNumber):Null,Level:(ctx,args)=>{const resolvedArgs=args.map((a=>SafeEval$1(a,ctx))).map((v=>v.Value));return GetLevel(ctx.Context,resolvedArgs[0],resolvedArgs[1])},Previous:(ctx,args)=>{const resolvedArgs=args.map((a=>SafeEval$1(a,ctx))),path=(1<args.length&&resolvedArgs[1].Value||"").split(";").map((s=>s.trim())).filter((ts=>ts.length>0)).map((ts=>(ts=>{const arg=ts.split("_"),type="R"===arg[0]?"Region":"C"===arg[0]?"Column":"G"===arg[0]?"Group":"M"===arg[0]?"Member":"S"===arg[0]?"Scope":"T"===arg[0]?"Tablix":"Parent";return{IsRegion:"Region"===type,Indexes:"Region"===type||"Group"===type||"Member"===type?arg[1].split(",").filter((a=>a.length>0)).map((a=>parseInt(a))):[],Type:type}})(ts)));if(null===ctx.Context)return Null;const prev=function(ctx,path){return FindPreviousImpl(ctx,path)}(ctx.Context,path);return null!==prev?SafeEval$1(args[0],MakeEvaluationContext(prev.Data.FirstOrDefault(),prev)):Null},Lookup:(ctx,args)=>{if(4!==args.length)throw new Error("Invalid arguments list for Lookup function");const dataSetName=Tools.Variant.Convert.toString(SafeEval$1(args[3])),sourceKeyFn=args[0],valueFn=args[2],context=ctx.Context;if(context&&context.LookupStore){const sourceKey=SafeEval$1(sourceKeyFn,ctx),targetKeyFn=r=>SafeEval$1(args[1],MakeEvaluationContext(r,context)),lookupRecord=context.LookupStore.LookupRecord(dataSetName,args[1].ToString(),targetKeyFn,sourceKey);if(lookupRecord)return SafeEval$1(valueFn,MakeEvaluationContext(lookupRecord,context))}return Null},LookupSet:(ctx,args)=>{if(4!==args.length)throw new Error("Invalid arguments list for LookupSet function");const dataSetName=Tools.Variant.Convert.toString(SafeEval$1(args[3])),sourceKeyFn=args[0],valueFn=args[2],context=ctx.Context;if(context&&context.LookupStore){const sourceKey=SafeEval$1(sourceKeyFn,ctx),targetKeyFn=r=>SafeEval$1(args[1],MakeEvaluationContext(r,context)),lookupRecords=context.LookupStore.LookupRecords(dataSetName,targetKeyFn,sourceKey);if(lookupRecords)return Create$1(Array.from(lookupRecords).map((record=>SafeEval$1(valueFn,MakeEvaluationContext(record,context)))))}return Null},GetGroupIndex:(ctx,args)=>{var _a;const indexes=args.map((a=>SafeEval$1(a,ctx))).map((v=>v.Value)),distance=indexes.length>0?indexes[0]:-1,axis=indexes.length>1?indexes[1]:-1;return null!==(_a=function(ctx,distance,axis){if(!ctx.Parent)return Null$1;const result=function(ctx,distance,axis){let context=0===axis?ctx:null==ctx?void 0:ctx.Column;if(distance<0||!context)return null;let step=0;for(;context.Parent;){if(step==distance)return context;context=context.Parent,step++}return null}(ctx,distance,axis);return!result||result.GroupIndex<0?Null$1:Tools.Variant.Create(result.GroupIndex)}(ctx.Context,distance,axis))&&void 0!==_a?_a:Null}};AggregateFunctionNames.concat(["RunningValue"]).forEach((aggFunction=>customFunctions[aggFunction]=(ctx,args)=>function(fn,args){return ctx=>{const scope=ctx.Data;if(!scope||"Empty"===fn)return Tools.Variant.Null;switch(fn){case"First":const first=IterableFirst(scope.Records);return null==first?Tools.Variant.Null:SafeEval$1(args[0],MakeEvaluationContext(first,ctx));case"Last":const last=IterableLast(scope.Records);return null==last?Tools.Variant.Null:SafeEval$1(args[0],MakeEvaluationContext(last,ctx));case"ToArray":const arrayValues=LazyFilter(LazyMap(scope.Records,(r=>SafeEval$1(args[0],MakeEvaluationContext(r,ctx)))),(val=>"Null"!==val.Type));return Tools.Variant.Create(IterableToArray(arrayValues).map((v=>v.Value)));case"CountRows":return Tools.Variant.Create(IterableCount(scope.Records));case"Count":const values=LazyFilter(LazyMap(scope.Records,(r=>SafeEval$1(args[0],MakeEvaluationContext(r,ctx)))),(val=>"Null"!==val.Type));return Tools.Variant.Create(IterableToArray(values).length);case"Sum":case"Avg":case"Min":case"Max":case"Median":case"Mode":case"CountDistinct":case"Var":case"VarP":case"StDev":case"StDevP":{const context=ctx,evaluate=(arg,dataScope)=>{const aggregate=MakeAggregate(fn),data=LazyMap(dataScope.Records,(record=>{const recordScope=MakeContext(record,context,ctx.App);return SafeEval$1(arg,MakeEvaluationContext(recordScope.Data.FirstOrDefault(),ctx))}));for(let val of data)aggregate.Accumulate([val]);return aggregate.GetValue()};if(context&&context.ParentContext){if(context.ParentContext.Cache.has(args[0]))return context.ParentContext.Cache.get(args[0]);const result=evaluate(args[0],context.ParentContext.Data);return context.ParentContext.Cache.set(args[0],result),result}return evaluate(args[0],scope)}default:{const aggregate=MakeAggregate(fn),data=LazyMap(scope.Records,(record=>{const recordScope=MakeContext(record,null,ctx.App);return args.map((a=>SafeEval$1(a,MakeEvaluationContext(recordScope.Data.FirstOrDefault(),ctx))))}));for(let vals of data)aggregate.Accumulate(vals);return aggregate.GetValue()}}}}(aggFunction,args)(ctx.Context)));const compilerImpl=createTreeBuilder(customFunctions),compiler=expression=>{try{return compilerImpl(`${expression}`)}catch(err){return console.warn(err.message),compilerImpl("=Null")}};function compile(expression,cc=null){if(null===expression)return()=>Null;if(isVariant$1(expression))return()=>expression;if("string"!=typeof expression||"="!==expression.trim()[0])return()=>Create$1(expression);const compiled=compiler(expression);return ctx=>SafeEval$1(compiled,MakeEvaluationContext(ctx.Data.FirstOrDefault(),ctx))}function SafeEval$1(node,ctx){try{return ctx?node.Eval(ctx):node.EvalConst()}catch(err){return console.warn(err.message),Null}}function MakeContext(record,parentContext=null,app=null,lookupStore=null,rowNumber=0){return{App:app,Data:new RecordSet(null===record?[]:[record]),RowNumber:rowNumber,Cache:new Map,ParentContext:parentContext,LookupStore:lookupStore}}const MakeAggregateInfo=(func,args,scopeName=null,isNothingScope=!1,isRecursive=!1)=>({Func:func,Arguments:args,ScopeName:scopeName,IsNothingScope:isNothingScope,IsRecursive:isRecursive,IsScopeSpecified:isNothingScope||!!scopeName});function ToExpressionString(aggregateInfo){const args=aggregateInfo.Arguments.map((t=>t.ToString())).join(","),scopeArg=aggregateInfo.IsScopeSpecified?aggregateInfo.IsNothingScope?",Nothing":","+(aggregateInfo.ScopeName||""):"",recursiveArg=aggregateInfo.IsRecursive?",Recursive":"";return`=${aggregateInfo.Func}(${args}${scopeArg}${recursiveArg})`}const First=expr=>MakeAggregateInfo("First",[expr]);function Describe(expr){if(null===expr)return null;const functionName=ParseAggregateFunction(expr.Token.value.toString());return"Empty"===functionName||AggregateFunctionNames.indexOf(functionName)<0?null:DescribeImpl(functionName,expr.Children)}function DescribeImpl(functionName,args,isRunningValue=!1){if("Empty"===functionName||AggregateFunctionNames.indexOf(functionName)<0)return null;const count=function(fn,args,evalString){switch(fn){case"CountRows":return 0;case"DistinctSum":return 2;case"AggregateIf":if(args.length<2)return-1;const a=evalString(args[1]);return AggregateFunctionNames.indexOf(a)<0||"AggregateIf"===a?-1:"CountRows"===a?2:"DistinctSum"===a?4:3;default:return 1}}(functionName,args,EvalScopeName);if(count<0||count>0&&args.length<count)return null;const params=function(args,index){let isRecursive=!1,isNothingScope=!1,scopeName="";for(let state=0;state<3&&index<args.length;index++){const s=EvalScopeName(args[index]),sLower=s.toLowerCase();switch(state){case 0:"simple"===sLower||"recursive"===sLower?(isRecursive="recursive"===sLower,state=1):(isNothingScope="constant"===args[index].Token.type&&"nothing"===args[index].Token.value.toString().toLowerCase(),scopeName=isNothingScope?"":s,state=2);break;case 1:isNothingScope="constant"===args[index].Token.type&&"nothing"===args[index].Token.value.toString().toLowerCase(),scopeName=isNothingScope?"":s,state=3;break;case 2:isRecursive="recursive"===sLower,state=3}}return{isRecursive:isRecursive,isNothingScope:isNothingScope,scopeName:scopeName}}(args,count);if(isRunningValue){if(params.isRecursive)return null;params.isNothingScope=!params.scopeName}return{Func:functionName,Arguments:count===args.length?args:args.slice(0,count),ScopeName:params.scopeName,IsNothingScope:params.isNothingScope,IsRecursive:params.isRecursive,IsScopeSpecified:params.isNothingScope||!!params.scopeName}}function DescribeRowNumber(expr){const{scope:scope,isNothingScope:isNothingScope}=function(expression){let scope="",isNothingScope=!1;!expression||"constant"===expression.Token.type&&"nothing"===expression.Token.value.toLowerCase()?(scope="",isNothingScope=!0):scope=EvalScopeName(expression);return{scope:scope,isNothingScope:isNothingScope}}(expr.Children.length>0?expr.Children[0]:null);return{Func:"Count",Arguments:[compiler("=1")],ScopeName:scope,IsNothingScope:isNothingScope,IsRecursive:!1,IsScopeSpecified:isNothingScope||!!scope}}function EvalScopeName(e){return"constant"===e.Token.type||"variable"===e.Token.type?e.Token.value:Tools.Variant.Convert.toString(SafeEval$1(e))}const DefaultCrossScope={Member:{},Index:-1,Fields:[]};const MakeAggregateScope_ByRegion=(region,parent=null,index=0,adp=null)=>({Region:region,Name:region.Name,Parent:parent,Index:index,AggregateDataProvider:adp,Aggregates:[],Regions:[],Column:null,Group:null,TablixPosition:"None",MemberIndex:-1,IsDetail:!1,CrossScope:null,SkipInResult:!1}),MakeAggregateScope_ByColumn=(name,parent=null,column=null,position="None",memberIndex=-1)=>({Region:null,Name:name,Parent:parent,Index:0,AggregateDataProvider:null,Aggregates:[],Regions:[],Column:column,Group:null,TablixPosition:position,MemberIndex:memberIndex,IsDetail:!1,CrossScope:null,SkipInResult:!1}),MakeAggregateScope_ByGroup=(grp,parent=null,crossScope=null,skipInResult=!1,position="None",memberIndex=-1)=>({Region:null,Name:grp?grp.Name:"",Parent:parent,Index:0,AggregateDataProvider:parent?parent.AggregateDataProvider:null,Aggregates:[],Regions:[],Column:null,Group:grp||null,TablixPosition:position,MemberIndex:memberIndex,IsDetail:!!grp&&0===(grp.GroupExpressions||[]).length,CrossScope:crossScope,SkipInResult:skipInResult});function InsertAggregate(aggregateScope,agg){let i=aggregateScope.Aggregates.findIndex((a=>((a,b)=>a&&b&&a.Func===b.Func&&a.IsNothingScope===b.IsNothingScope&&a.IsRecursive===b.IsRecursive&&a.IsScopeSpecified===b.IsScopeSpecified&&a.ScopeName===b.ScopeName&&a.Arguments.length===b.Arguments.length&&a.Arguments.every(((arg,i)=>b.Arguments[i].ToString()===arg.ToString())))(a,agg)));return i>=0||(i=aggregateScope.Aggregates.length,aggregateScope.Aggregates.push(agg)),i}function MakeFields(aggregateScope){return aggregateScope.Aggregates.map(ToExpressionString)}function ResolveScope(current,name,makeResult){return[current,current.Column].map(((from,axis)=>ResolveScopeByPredicate(from,(t=>t.Name.toLowerCase()===(name||"").toLowerCase()),((scope,steps)=>makeResult(scope,steps,axis))))).find((t=>null!=t))}function ResolveScopeByPredicate(scope,predicate,makeResult){let steps=0;for(;null!=scope;){if(predicate(scope))return makeResult(scope,steps);scope=scope.Parent,steps++}return null}function SelfAndAncestors(scope){return{*[Symbol.iterator](){for(;scope;)yield scope,scope=scope.Parent}}}function ResolveAggregateFunction(provider,expr){if(null===provider)return"Empty";if("variable"===expr.Token.type){const match=expr.Token.value.toString().match(/^Fields[\\.!](.+)\\.Value$/i);match&&match[0]&&provider.GetAggregateFunction(match[0])}return"Empty"}function RequestRunningValue(scope,aggregate){if(scope.Region&&"report"===scope.Region.type)return RequestAggregate(scope,aggregate);if(scope.Column)return function(scope,agg){if(!agg.IsScopeSpecified||agg.IsNothingScope){let parent=scope.Parent;parent=function(scope){let result=null,context=scope;for(;context&&context.Parent;)context=context.Parent,context.Region&&"tablix"===context.Region.type&&(result=context);return result}(parent);const scopes=IterableToArray(LazyTakeWhile(SelfAndAncestors(parent.Parent),(t=>!(t.Region&&"dataset"===t.Region.type))));return scopes.length>0?`=GetCellRunningValue(${InsertAggregate(scope,agg)},-1,-1,${MakeArgs(scopes,agg)})`:`=GetCellRunningValue(${InsertAggregate(scope,agg)},-1,-1)`}const rowHeight=DistanceToScope(scope.Parent,agg.ScopeName||""),colHeight=DistanceToScope(scope.Column,agg.ScopeName||"");return-1==rowHeight&&-1==colHeight?"=Nothing":`=GetCellRunningValue(${InsertAggregate(scope,agg)},${rowHeight},${colHeight})`}(scope,aggregate);return`=GetRunningValue(${MakeArgs(function(scope,agg){if(!agg.IsScopeSpecified)return[scope];if(agg.IsNothingScope)return IterableToArray(LazyTakeWhile(SelfAndAncestors(scope),(t=>!(t.Region&&"dataset"===t.Region.type))));const list=[];let tempScope=scope;for(;tempScope;){if(list.push(tempScope),tempScope.Name.toLowerCase()===(agg.ScopeName||"").toLowerCase()||tempScope.Regions.some((r=>r.Name.toLowerCase()===(agg.ScopeName||"").toLowerCase())))return list;tempScope=tempScope.Parent}return[scope]}(scope,aggregate),aggregate)})`}function MakeArgs(scopes,agg){return IterableToArray(LazyMap(scopes,(t=>InsertAggregate(t,agg).toString()))).join(", ")}function DistanceToScope(scope,name){let distance=0;for(;scope;){if(scope.Name.toLowerCase()===name.toLowerCase())return distance;scope=scope.Parent,distance++}return-1}function RequestPrevious(scope,fn){var _a;const firstArg=fn.Children[0];!function(fn){if("function"!==fn.Token.type)return;if("previous"===fn.Token.value.toLowerCase())throw new Error("Previous function cannot contain nested Previous function.");if("aggregate"===fn.Token.value.toLowerCase())throw new Error("Previous function cannot contain nested Aggregate function.");if("level"===fn.Token.value.toLowerCase())throw new Error("Previous function cannot contain nested Level function.");if("inscope"===fn.Token.value.toLowerCase())throw new Error("Previous function cannot contain nested InScope function.");const agg=Describe(fn);if(agg){if(agg.IsRecursive)throw new Error("Previous function cannot contain nested recursive aggregates.");if("Aggregate"===agg.Func)throw new Error("Previous function cannot contain nested Aggregate function.")}}(firstArg);const nestedAgg=ContainsAggregates(firstArg)?RequestAggregates(scope,firstArg):RequestAggregate(scope,MakeAggregateInfo("Last",[firstArg]));const scopeName=fn.Children[1]?EvalScopeName(fn.Children[1]):null;let path=scopeName||"None"!==scope.TablixPosition?null!==(_a=BuildPath(scope,scopeName))&&void 0!==_a?_a:BuildPath(scope,scopeName,!0):"";return"ColumnHeader"===scope.TablixPosition&&(path=`C;${null!=path?path:""}`),"None"!==scope.TablixPosition&&(path=`T;${null!=path?path:""}`),`=${fn.Token.value}(${clearExp(nestedAgg)},"${path}")`}function BuildPath(scope,scopeName,vertical=!1){var _a,_b;let path="";if(vertical&&(path+="C;",scope=null!==(_a=null==scope?void 0:scope.Column)&&void 0!==_a?_a:null),!scope)return null;let scopeFound=!1;for(let current of SelfAndAncestors(scope)){if(!(scopeFound||scopeName&&current.Name.toLowerCase()!==scopeName.toLowerCase())){if(scopeFound=!0,"None"===scope.TablixPosition)break;path+="S;"}if("tablix"===(null===(_b=current.Region)||void 0===_b?void 0:_b.type))break;current.Group?path+=`G_${MakeGroupKey(current,current.Group)};`:current.Region?path+=`R_${current.Index};`:path+="P;",current.MemberIndex>=0&&(path+=`M_${current.MemberIndex};`)}return scopeFound?path:null}function MakeGroupKey(parent,grp){return(grp.GroupExpressions||[]).map((expr=>RequestAggregate(parent,First(compiler(expr))))).filter((keyFn=>null!==keyFn)).map((keyFn=>compiler(keyFn).Children[0])).filter((arg=>!!arg)).map((arg=>arg.ToString())).join(",")}function FindScope(scope,aggScopeName){let distance=0;for(;null!==scope&&scope.Name.toLowerCase()!==aggScopeName.toLowerCase();)scope=scope.Parent,distance++;return{scope:scope,distance:distance}}const Exprs={Zero:"=0",Level:"=Level()",EmptyString:\'=""\',Nothing:"=Nothing"};function RequestExpression(scope,expr){return RequestExpressionNode(scope,compiler(expr))}function RequestExpressionNode(scope,expressionNode){return!ContainsAggregates(expressionNode,!1,scope)&&((e=expressionNode)&&e.Contains(fieldsRefRegexp,"variable"))?RequestAggregate(scope,First(expressionNode)):RequestAggregates(scope,expressionNode);var e}function RequestAggregates(scope,expr){if(null!==scope){const func=ResolveAggregateFunction(scope.AggregateDataProvider,expr);if("Empty"!==func)return RequestAggregate(scope,MakeAggregateInfo(func,[expr],scope.Name))}if("function"===expr.Token.type){const functionName=expr.Token.value.toLowerCase();if("."===functionName[0]){const target=RequestExpressionNode(scope,expr.Children[0]),args=expr.Children.slice(1).map((a=>RequestExpressionNode(scope,a)));return`=${clearExp(target)}${expr.Token.value}(${args.map(clearExp).join(",")})`}{let agg=Describe(expr);if(null!==agg){if(scope&&scope.IsDetail&&!agg.IsScopeSpecified&&null!==scope.Parent){let parent=scope.Parent;for(;parent&&!parent.Name;)parent=parent.Parent;parent&&parent.Name&&(agg=MakeAggregateInfo(agg.Func,agg.Arguments,parent.Name,!1,agg.IsRecursive))}return RequestAggregate(scope,agg)}if("previous"===functionName)return RequestPrevious(scope,expr);if("level"===functionName){const scopeName=expr.Children.length>0?EvalScopeName(expr.Children[0]):"";return function(current,scopeName){if(!scopeName){const t=pipe(SelfAndAncestors,iterable$1.asIndexed,iterable$1.findFirst((p=>null!==p.item.Group&&!!p.item.Group.Parent)))(current);return null!==t?`=Level(${t.index})`:Exprs.Level}const expr=ResolveScope(current,scopeName,((scope,steps,axis)=>`=Level(${steps}, ${axis})`));return null==expr?Exprs.Zero:expr}(scope,scopeName)}if("runningvalue"===functionName)return agg=function(expr){if(expr.Children.length<2)return null;const fn=ParseAggregateFunction(EvalScopeName(expr.Children[1]));switch(fn){case"Empty":case"Aggregate":case"First":case"Last":return null}return DescribeImpl(fn,"DistinctSum"===fn?[expr.Children[0],expr.Children[0]].concat(expr.Children.slice(2)):[expr.Children[0]].concat(expr.Children.slice(2)),!0)}(expr),agg?RequestRunningValue(scope,agg):"=Nothing";if("rownumber"===functionName)return agg=DescribeRowNumber(expr),RequestRunningValue(scope,agg);if("crossaggregate"===functionName)return function(scope,fn){var _a,_b,_c,_d;if(fn.Children.length<4)return console.warn(`The CrossAggregate function must be invoked with 4 arguments but invoked with ${fn.Children.length}: ${null===(_a=fn.Token.raw)||void 0===_a?void 0:_a.expression}`),Exprs.Nothing;const aggType=fn.Children[1].EvalConst().Value,aggExpression=fn.Children[0].ToString(),columnScopeName=EvalScopeName(fn.Children[2]),rowScopeName=EvalScopeName(fn.Children[3]),{scope:rowScope,distance:rowDistance}=FindScope(scope.Parent,rowScopeName),{scope:columnScope,distance:colDistance}=FindScope(scope.Column,columnScopeName);if(null==rowScope||null==columnScope)return console.warn(`Invalid scope specified for the CrossAggregate function: ${null===(_b=fn.Token.raw)||void 0===_b?void 0:_b.expression}`),Exprs.Nothing;if("tablix"===(null===(_c=rowScope.Region)||void 0===_c?void 0:_c.type)){const agg=Describe(compiler(`=${aggType}(${aggExpression}, ${columnScopeName})`));return agg?RequestAggregate(scope,agg):Exprs.Nothing}if("tablix"===(null===(_d=columnScope.Region)||void 0===_d?void 0:_d.type)){const agg=Describe(compiler(`=${aggType}(${aggExpression}, ${rowScopeName})`));return agg?RequestAggregate(scope,agg):Exprs.Nothing}if(0===rowDistance&&0===colDistance){const agg=Describe(compiler(`=${aggType}(${aggExpression})`));return agg?RequestAggregate(scope,agg):Exprs.Nothing}if(null===rowScope.CrossScope||null===columnScope.CrossScope)return Exprs.EmptyString;const aggregateScope=0===rowDistance?columnScope:rowScope,exprIndex=function(expr,fields){const idx=fields.indexOf(expr);return idx>=0?idx:(fields.push(expr),fields.length-1)}(compiler(`=${aggType}(${aggExpression})`),aggregateScope.CrossScope.Fields);return`=GetCrossAggregate(${rowScope.CrossScope.Index},${rowDistance},${columnScope.CrossScope.Index},${colDistance},${exprIndex})`}(scope,expr);if("groupindex"===functionName){const groupName=expr.Children.length>0?EvalScopeName(expr.Children[0]):scope.Name;return function(currentScope,scopeName){let axis=0,distance=GetScopeDistance(currentScope,scopeName);distance<0&&scopeName&&currentScope.Column&&(axis=1,distance=GetScopeDistance(currentScope.Column,scopeName));return`=GetGroupIndex(${distance}, ${axis})`}(scope,groupName)}}const args=expr.Children.map((a=>RequestExpressionNode(scope,a)));return`=${expr.Token.value}(${args.map(clearExp).join(",")})`}if("operator"===expr.Token.type){if(1===expr.Token.arity){const right=expr.Children[0]&&RequestExpressionNode(scope,expr.Children[0]);return`=${expr.Token.value} (${clearExp(right)})`}{const left=expr.Children[0]&&RequestExpressionNode(scope,expr.Children[0]),right=expr.Children[1]&&RequestExpressionNode(scope,expr.Children[1]);return`=(${clearExp(left)}) ${expr.Token.value} (${clearExp(right)})`}}return`=${expr.ToString()}`}function RequestAggregate(current,agg){if(!agg.IsScopeSpecified)return InsertAndMakeExpr(agg,current);let expr;return agg.IsNothingScope?(expr=ResolveScopeByPredicate(current,(t=>null!==t.Region&&"dataset"===t.Region.type),((scope,steps)=>InsertAndMakeExpr(agg,scope,steps))),expr||InvalidScope(current,agg)):(expr=ResolveScope(current,agg.ScopeName,((scope,steps,axis)=>InsertAndMakeExpr(agg,scope,steps,axis))),null!=expr?expr:(expr=function(scope,name,makeResult){let steps=0;for(;null!==scope;){const i=scope.Regions.findIndex((t=>t.Name.toLowerCase()===(name||"").toLowerCase()));if(i>=0)return makeResult(scope.Regions[i],steps,i);scope=scope.Parent,steps++}return null}(current,agg.ScopeName,((scope,steps,region)=>`=GetRegionAggregate(${InsertAggregate(scope,agg)}, ${steps}, ${region})`)),expr||InvalidScope(current,agg)))}function InsertAndMakeExpr(agg,scope,steps=0,axis=0){const recursive=agg.IsRecursive?1:0,i=InsertAggregate(scope,agg=MakeAggregateInfo(agg.Func,agg.Arguments));let optionalArgs=[steps,axis,recursive];optionalArgs.reverse(),optionalArgs=optionalArgs.slice(optionalArgs.findIndex((t=>0!==t))),optionalArgs.reverse();return`=GetAggregate(${i}${optionalArgs.length>0?","+optionalArgs.join(","):""})`}function InvalidScope(scope,agg){return InsertAndMakeExpr(agg,scope)}const aggregateRegexp=new RegExp(`^(${AggregateFunctionNames.concat(["level","runningvalue","rownumber","previous","crossaggregate","groupindex"]).join("|")})$`,"i");function ContainsAggregates(e,withScope=!1,scope=null){return null!==e&&""!==e.Token.value&&!!e.Contains(aggregateRegexp,"function")}const fieldsRefRegexp=/^Fields(\\.|!|$)/i;function GetScopeDistance(initialScope,scopeName){let distance=0,scope=initialScope;for(;scope;){if(!scopeName&&scope.Name||scope.Name&&scope.Name.toLowerCase()===scopeName.toLowerCase())return distance;scope=scope.Parent,distance++}return-1}function clearExp(expr){return expr&&"="===expr[0]?expr.replace("=",""):expr}function MakeLookupStore(getRecordSet){const _indexes={};return{LookupRecord:(dataSetName,indexId,keyFn,key)=>{if(!getRecordSet)return null;const index=((dataSetName,indexId,keyFn)=>{_indexes[dataSetName]||(_indexes[dataSetName]=new Map);const dataSetIndex=_indexes[dataSetName];if(!dataSetIndex.has(indexId)){const recordSet=getRecordSet(dataSetName);if(!recordSet)return null;const index=new VariantMap;for(const record of recordSet){const key=keyFn(record);Tools.Variant.IsNull(key)||index.hasKey(key)||index.set(key,record)}dataSetIndex.set(indexId,index)}return dataSetIndex.get(indexId)||null})(dataSetName,indexId,keyFn);return index&&index.get(key)},LookupRecords:function(dataSetName,keyFn,key){return getRecordSet?{*[Symbol.iterator](){const recordSet=getRecordSet(dataSetName);if(recordSet)for(const record of recordSet){const keyVal=keyFn(record);Tools.Variant.Comparison.Equals(keyVal,key).Value&&(yield record)}}}:null}}}function MakeRecordSetKey(name,parameters){return`[${name}>${parameters.map((p=>`(${p.Name}|${p.Value.Type}|${p.Value.Value})`)).join("#")}]`}function MakeRecordSetProvider(getDataSet,data=null,agg=null){return{GetDataSet:getDataSet,Data:data,Agg:agg,LookupStore:MakeLookupStore((x=>getDataSet(MakeRecordSetKey(x,[]))))}}function MakeRow(cells,skipInResult=!1){return{Cells:cells,SkipInResult:skipInResult}}const MakeIdxFn=()=>{let i=0;return member=>IsLeafMember(member)?i++:-1};function TablixImpl(tablix){const rowIdx=MakeIdxFn(),columnIdx=MakeIdxFn(),leafColumnScopes=[],body=[],crossMembersByGroupName=new Map;function ProcessColumnMember(parent,member,memberIndex,crossScope=!1){const scope=MakeAggregateScope_ByGroup(member.Group,parent,FindCrossContext(member),crossScope,"ColumnHeader",memberIndex),content=ProcessContent(scope,member.Header),kids=(member.Members||[]).map(((m,i)=>ProcessColumnMember(scope,m,i))),crossMemberCtx=crossMembersByGroupName.get(scope.Name);if(crossMemberCtx&&crossMemberCtx.Member!==member){const crossMember=ProcessColumnMember(scope,crossMemberCtx.Member,-1,!0);kids.push(crossMember)}return columnIdx(member)>=0&&leafColumnScopes.push(scope),{Scope:scope,Members:kids,Content:content,Group:member.Group?ProcessGroup(scope,member.Group):null,Sort:member.Group?ProcessSort(scope,member.Sort):null}}function ProcessRowMember(parent,member,memberIndex){const scope=MakeAggregateScope_ByGroup(member.Group,parent,FindCrossContext(member),!1,"RowHeader",memberIndex),content=ProcessContent(scope,member.Header);let kids=(member.Members||[]).map(((m,i)=>ProcessRowMember(scope,m,i)));const idx=rowIdx(member);if(idx>=0&&tablix.Body.length>0){const row=tablix.Body[idx];let columnCrossOffset=0;const cells=leafColumnScopes.map(((colScope,i)=>{if(colScope.SkipInResult)return columnCrossOffset++,NoResultContent(colScope.Parent.CrossScope.Fields);return ProcessContent(MakeAggregateScope_ByColumn("",scope,colScope,"Body"),row.Cells[i-columnCrossOffset])}));body.push(MakeRow(cells))}if(null!==scope.CrossScope&&member!==scope.CrossScope.Member){const crossMember=function(parent,member){const scope=MakeAggregateScope_ByGroup(member.Group,parent,FindCrossContext(member),!0),content=ProcessContent(scope,member.Header);return{Scope:scope,Members:[],Content:content,Group:member.Group?ProcessGroup(scope,member.Group):null,Sort:member.Group?ProcessSort(scope,member.Sort):null}}(scope,scope.CrossScope.Member),cells=leafColumnScopes.map(((colScope,i)=>NoResultContent(scope.CrossScope.Fields)));body.push(function(cells){return MakeRow(cells,!0)}(cells)),kids=kids.concat([crossMember])}return{Scope:scope,Members:kids,Content:content,Group:member.Group?ProcessGroup(scope,member.Group):null,Sort:member.Group?ProcessSort(scope,member.Sort):null}}const NoResultContent=fields=>({Aggregate:Def.Makers.Content(fields.map((f=>{var _a;return null===(_a=f.Token.raw)||void 0===_a?void 0:_a.expression}))),Result:null});function*Disassemble(expr){switch(yield expr,expr.Token.type){case"operator":for(const operand of expr.Children)for(const e of Disassemble(operand))yield e;break;case"function":{for(const e of flatten(expr.Children.map((a=>Disassemble(a)))))yield e;const functionName=expr.Token.value;if(functionName&&"."===functionName[0])for(const e of Disassemble(expr.Children[0]))yield e;break}}}function flatten(arr){const res=[];for(const subArr of arr)res.push(...subArr);return res}function FindMember(tablixColumnMembers,rowScopeName){var _a;for(const m of tablixColumnMembers){if((null===(_a=m.Group)||void 0===_a?void 0:_a.Name)===rowScopeName)return m;if(null!=m.Members){const child=FindMember(m.Members,rowScopeName);if(null!==child)return child}}return null}function FindCrossContext(member){var _a;const crossContext=!!(null===(_a=member.Group)||void 0===_a?void 0:_a.Name)&&crossMembersByGroupName.get(member.Group.Name);return crossContext||null}return function(parent,index){const scope=MakeAggregateScope_ByRegion(tablix,parent,index),content=ProcessContent(scope,tablix.Content),filters=tablix.Filters||[],sort=ProcessSort(scope,tablix.Sorts);!function(tablixBody){const fields=flatten(tablixBody.map((r=>r.Cells))).map((c=>{var _a;return null!==(_a=c.Fields)&&void 0!==_a?_a:[]})),exprNodes=flatten(fields).map((f=>compiler(f))),exprArr=flatten(exprNodes.map(Disassemble)),bodyExpressions=[];for(const expressionNode of exprArr)"function"===expressionNode.Token.type&&4===expressionNode.Children.length&&"crossaggregate"===expressionNode.Token.value&&bodyExpressions.push(expressionNode);for(const expr of bodyExpressions){const columnScopeName=EvalScopeName(expr.Children[2]),rowScopeName=EvalScopeName(expr.Children[3]),rowParent=FindMember(tablix.RowMembers,rowScopeName),columnParent=FindMember(tablix.ColumnMembers,columnScopeName);if(!(null===rowParent||null===columnParent||IsLeafMember(rowParent)&&IsLeafMember(columnParent))){if(!crossMembersByGroupName.has(rowScopeName))if(IsLeafMember(rowParent))crossMembersByGroupName.set(rowScopeName,Object.assign(Object.assign({},DefaultCrossScope),{Member:rowParent}));else{const member=Def.Makers.TablixMember(null,null,Def.Makers.Content([Exprs.EmptyString]),[]);crossMembersByGroupName.set(rowScopeName,{Member:member,Index:rowParent.Members.length,Fields:[]})}if(!crossMembersByGroupName.has(columnScopeName))if(IsLeafMember(columnParent))crossMembersByGroupName.set(columnScopeName,Object.assign(Object.assign({},DefaultCrossScope),{Member:columnParent}));else{const member=Def.Makers.TablixMember(null,null,Def.Makers.Content([Exprs.EmptyString]),[]);crossMembersByGroupName.set(columnScopeName,{Member:member,Index:columnParent.Members.length,Fields:[]})}}}}(tablix.Body);const columnMembers=tablix.ColumnMembers.map(((m,i)=>ProcessColumnMember(scope,m,i))),rowMembers=tablix.RowMembers.map(((m,i)=>ProcessRowMember(scope,m,i)));return{Aggregate:Def.Makers.Tablix(tablix.Name,filters,columnMembers.map(MakeAggregateMember),rowMembers.map(MakeAggregateMember),CompleteContent(scope,content.Aggregate),body.map((r=>Def.Makers.TablixRow(r.Cells.map((t=>t.Aggregate)).filter(isNotNull$1)))),sort.Aggregate),Result:Def.Makers.Tablix(tablix.Name,null,columnMembers.filter((m=>!m.Scope.SkipInResult)).map(MakeResultMember),rowMembers.filter((m=>!m.Scope.SkipInResult)).map(MakeResultMember),content.Result,body.filter((r=>!r.SkipInResult)).map((r=>Def.Makers.TablixRow(r.Cells.map((c=>c.Result)).filter(isNotNull$1)))),sort.Aggregate)}}}function MakeAggregateMember(mem){const header=CompleteContent(mem.Scope,mem.Content.Aggregate);return Def.Makers.TablixMember(mem.Group&&mem.Group.Aggregate,mem.Sort&&mem.Sort.Aggregate,header,mem.Members.map(MakeAggregateMember))}function MakeResultMember(mem){return Def.Makers.TablixMember(mem.Group&&mem.Group.Result,mem.Sort&&mem.Sort.Result,mem.Content.Result,mem.Members.filter((m=>!m.Scope.SkipInResult)).map(MakeResultMember))}function Process(report,rsp=null){const t=ProcessRegion(null,report,0,rsp);return{Aggregate:t.Aggregate,Result:t.Result}}function ProcessRegion(parent,region,index=0,rsp=null){if("tablix"===region.type){return TablixImpl(region)(parent,index)}let scope=null;parent&&(scope=parent.Regions.find((t=>t.Name==region.Name))||null),scope||(scope=MakeAggregateScope_ByRegion(region,parent,index,null!=rsp&&null!==rsp.Data?()=>rsp.Data.AggregateDataProvider:null)),scope.Regions.push(...(region.Content&&region.Content.Regions||[]).map(((r,i)=>MakeAggregateScope_ByRegion(r,scope,i,null!==rsp&&null!==r&&"dataset"===r.type?()=>function(provider,dataSetName){if(null!==provider.Agg)return provider.Agg(dataSetName);const ds=provider.GetDataSet(MakeRecordSetKey(dataSetName,[]));return ds&&ds.AggregateDataProvider?ds.AggregateDataProvider:null}(rsp,r.Name):null))));const filters=region.Filters||[],content=ProcessContent(scope,region.Content,rsp);if("list"===region.type){const groupScope=MakeAggregateScope_ByGroup(region.Group,scope),sort=ProcessSort(groupScope,region.Sort),grp=ProcessGroup(groupScope,region.Group),groupContent=ProcessContent(groupScope,region.GroupContent,rsp),listContent=CompleteContent(scope,content.Aggregate);return{Aggregate:Def.Makers.List(region.Name,listContent,filters,grp.Aggregate,sort.Aggregate,groupContent.Aggregate,!!region.HandleEmptyGroups),Result:Def.Makers.List(region.Name,content.Result,[],grp.Result,sort.Result,groupContent.Result,!!region.HandleEmptyGroups)}}if("dataset"===region.type){const parameterRes=(region.Parameters||[]).map((parameter=>Def.Makers.Parameter(parameter.Name,RequestExpression(scope,parameter.Value))));return{Aggregate:Def.Makers.DataSet(region.Name,filters,content.Aggregate,region.FieldNames,region.Parameters),Result:Def.Makers.DataSet(region.Name,[],content.Result,region.FieldNames,parameterRes)}}if("report"===region.type)return{Aggregate:Def.Makers.Report(region.Name,content.Aggregate),Result:Def.Makers.Report(region.Name,content.Result)};if("subreport"===region.type){const t=Process(region.Report),parameterRes=(region.Parameters||[]).map((parameter=>Def.Makers.Parameter(parameter.Name,RequestExpression(scope,parameter.Value))));return{Aggregate:Def.Makers.Subreport(region.Name,t.Aggregate,region.Parameters,Def.Makers.Content(content.Aggregate&&content.Aggregate.Fields||[])),Result:Def.Makers.Subreport(region.Name,t.Result,parameterRes,Def.Makers.Content(content.Result&&content.Result.Fields||[]))}}return{Aggregate:Def.Makers.SimpleRegion(region.Name,filters,content.Aggregate),Result:Def.Makers.SimpleRegion(region.Name,[],content.Result)}}function ProcessGroup(scope,grp){if(null==grp)return{Aggregate:null,Result:null};const filters=function(scope,grp){if(null===grp)return{Aggregate:null,Result:null};Validate(grp.Filters,"Group");const first=[],second=[];for(let f of grp.Filters||[])IsSimpleFilter(f)?first.push(f):second.push(Def.Makers.Filter(RequestExpression(scope,f.Expression),f.Op,f.Values.map((v=>RequestExpression(scope,v)))));return{Aggregate:first,Result:second}}(scope,grp);let groupBy=grp.GroupExpressions||[],parent=grp.Parent;if(parent){if(1!==groupBy.length)throw Error("Parent is only allowed if the grouping has exactly one group expression.");groupBy=[RequestExpression(scope,groupBy[0])],parent=RequestExpression(scope,parent)}return{Aggregate:Def.Makers.Group(grp.Name,grp.GroupExpressions,filters.Aggregate),Result:Def.Makers.Group(grp.Name,groupBy,filters.Result,parent)}}function IsSimpleFilter(filter){return!ContainsAggregates(compiler(filter.Expression),!0)&&filter.Values.every((e=>!ContainsAggregates(compiler(filter.Expression),!0)))}function ProcessSort(scope,sort){if(!sort)return{Aggregate:null,Result:null};const first=[],second=[];for(let s of sort)ContainsAggregates(compiler(s.Expression),!0)?second.push(Def.Makers.Sort(RequestExpression(scope,s.Expression),s.Direction)):first.push(s);return{Aggregate:first,Result:second}}function ProcessContent(scope,content,rsp=null){if(!content)return{Aggregate:null,Result:null};const fields=(content.Fields||[]).map((f=>RequestExpression(scope,f))),regions=(content.Regions||[]).map(((r,i)=>ProcessRegion(scope,r,i,rsp)));return{Aggregate:Def.Makers.Content(MakeFields(scope),regions.map((r=>r.Aggregate))),Result:Def.Makers.Content(fields,regions.map((r=>r.Result)))}}function CompleteContent(scope,content){return Def.Makers.Content(MakeFields(scope),content&&content.Regions||[])}function MakeFn$1(dataSet,def,handleEmptyGroups=!1){if(!def)return t=>[t];if(!def.GroupExpressions||0==def.GroupExpressions.length)return handleEmptyGroups?ctx=>[ctx.MakeContextWithData(new RecordSet(ctx.Data.Records))]:ctx=>LazyMap(ctx.Data.Records,(r=>ctx.MakeContextWithData(new RecordSet([r]))));const cc=MakeCompileContext(dataSet),fields=(def.GroupExpressions||[]).map((e=>compile(e,cc)));let rowNumber=1;return ctx=>LazyMap(IterableGroupBy(ctx.Data.Records,(record=>{let tx=MakeContext(record,null,ctx.ExpressionContext,null,rowNumber++),vals=fields.map((fn=>fn(tx)));return 1===vals.length?vals[0].Value:makeMultiKey(vals)})),(([_,g])=>ctx.MakeContextWithData(new RecordSet(g))))}const makeMultiKey=vals=>`MultiKey(${vals.map((v=>`{${v.Type}|${v.Value}}`)).join(";")})`;function MakeFn(context,fields){const aggrs=fields.map((f=>function(cc,expr){const fieldAggFunc=cc&&ResolveAggregateFunction(cc.AggregateDataProvider,expr)||"Empty";if("Empty"!==fieldAggFunc)return{Func:fieldAggFunc,Args:expr.Children,IsSingleArgument:isSingleArgument(fieldAggFunc)};const agg=Describe("function"===expr.Token.type?expr:compiler(`=First(${expr.ToString()})`));return{Func:agg.Func,Args:agg.Arguments,IsSingleArgument:isSingleArgument(agg.Func)}}(context,f)));if(0===aggrs.length)return()=>[];const onlyFirst=aggrs.every((a=>"First"===a.Func));return exc=>{const aggregates=aggrs.map((a=>MakeAggregate(a.Func))),parentContext=function(scope,app=null,lookupStore=null){if(!scope)throw new Error("scope is null");return{App:app,Data:scope,RowNumber:0,Cache:new Map,ParentContext:null,LookupStore:lookupStore}}(exc.Data,exc.ExpressionContext,exc.DataSets.LookupStore);if(IterableAny(exc.Data.Records)){for(let record of exc.Data.Records)if(Accumulate(MakeContext(record,parentContext,exc.ExpressionContext,exc.DataSets.LookupStore),aggrs,aggregates),onlyFirst)break}else Accumulate(MakeContext(null,parentContext,exc.ExpressionContext,exc.DataSets.LookupStore),aggrs,aggregates);return aggregates}}function Accumulate(ctx,aggrs,aggregates){const evalCtx=MakeEvaluationContext(ctx.Data.FirstOrDefault(),ctx);for(let i=0;i<aggrs.length;i++){const aggr=aggrs[i];if(ctx.Data.Any()||"First"===aggr.Func||"Last"===aggr.Func)if(aggr.IsSingleArgument){const val=SafeEval$1(aggr.Args[0],evalCtx);if("Object"==val.Type&&isAggregate(val.Value))aggregates[i]=aggregates[i].Combine(val.Value);else if("Object"===val.Type&&Array.isArray(val.Value))for(const item of val.Value)aggregates[i].Accumulate([item]);else aggregates[i].Accumulate([val])}else{const vals=aggr.Args.map((t=>SafeEval$1(t,evalCtx)));aggregates[i].Accumulate(vals)}}}const isAggregate=obj=>obj.Function&&obj.GetState&&obj.Accumulate&&obj.SetState&&obj.Combine,isSingleArgument=func=>"Sum"===func||"Avg"===func||"Max"===func||"Min"===func||"Count"===func||"CountDistinct"===func||"StDev"===func||"StDevP"===func||"Var"===func||"VarP"===func||"First"===func||"Last"===func||"Median"===func||"Mode"===func;const MakeIndexFn=()=>{let i=0;return member=>IsLeafMember(member)?i++:-1};function MakeTablix(dpu,dataSet,tablix,parentDataSet=null){const cornerFn=MakeScopeFn(dpu,dataSet,tablix.Content),tablixFilter=MakeRegionFilter(tablix,dataSet,parentDataSet),sortFn=MakeSortContextFn(tablix.Sorts||[],null,dataSet),colLeafIndex=MakeIndexFn(),rowLeafIndex=MakeIndexFn(),colFns=MakeMembers(dpu,dataSet,tablix.ColumnMembers,colLeafIndex),rowFns=MakeMembers(dpu,dataSet,tablix.RowMembers,rowLeafIndex),bodyFns=tablix.Body.map((row=>row.Cells.map((cell=>MakeScopeFn(dpu,dataSet,cell))))),is2D=FlattenMembers(tablix.ColumnMembers).some((t=>!!t&&!!t.Group));return exc=>{exc=Apply$1(exc=Apply$2(exc,tablixFilter),sortFn);const corner=cornerFn(exc),rootCtx=exc.MakeContext(corner.Id);let columnMembers=[],rowMembers=[];const getColumnLeafs=GetLeafsFn((()=>columnMembers),IsLeafTxMember,(m=>m.MakeMembers(m.Data)),!1),getRowLeafs=GetLeafsFn((()=>rowMembers),IsLeafTxMember,(m=>m.MakeMembers(m.Data)),!0),colId=MakeIdFn(getColumnLeafs),rowId=MakeIdFn(getRowLeafs);columnMembers=colFns.map((fn=>fn(rootCtx,colId))),rowMembers=rowFns.map((fn=>fn(rootCtx,rowId)));const columnsData=columnMembers.map((m=>MakeTablixMember(m,rootCtx))),rowsData=rowMembers.map((m=>MakeTablixMember(m,rootCtx))),colScopes=LazyMap(GetLeafsFn((()=>columnsData),(m=>void 0!==m.Id&&m.Id>=0),(m=>m.Members),!1)(),(m=>m.Header.Id)),rowScopes=LazyMap(GetLeafsFn((()=>rowsData),(m=>void 0!==m.Id&&m.Id>=0),(m=>m.Members),!0)(),(m=>m.Header.Id)),rootScopeId=corner.Id;return DataTree.Makers.Tablix(corner,columnsData,rowsData,(()=>{const columns=IterableToArray(LazyZipEx(getColumnLeafs(),colScopes,((i,m,c)=>({Member:m,ScopeId:c}))));return LazyMap(LazyZipEx(getRowLeafs(),rowScopes,((i,m,c)=>({Member:m,ScopeId:c}))),(rowLeaf=>{const rowMember=rowLeaf.Member,rowMemberData=is2D?rowMember.Data:null,cells=columns.map((column=>{const columnMember=column.Member,cellFn=bodyFns[rowMember.DefIndex][columnMember.DefIndex],data=is2D?function(rowMember,colMember){const rs1=rowMember?IterableToArray(rowMember.Records):[],rs2=colMember?IterableToArray(colMember.Records):[],records=Intersect(rs1,rs2,(t=>t.Index));return new RecordSet(records)}(rowMemberData,columnMember.Data):rowMember.Data;var rowScopeId,colScopeId;return cellFn(exc.MakeContextWithData(data,(rowScopeId=rowLeaf.ScopeId,colScopeId=column.ScopeId,rowScopeId===rootScopeId?colScopeId:colScopeId===rootScopeId?rowScopeId:null)))}));return DataTree.Makers.TablixRow(cells)}))}),tablix.Name)}}function Once(fn){let result=null;return d=>(result||(result=Memoize$1(fn(d))),result)}function CreateTxMember(idFn,def,data,makeMembers){return{Data:data,DefIndex:def.DefIndex,Header:def.HeaderFn,IsCollection:def.IsCollection,IdFn:idFn,MakeMembers:Once(makeMembers),_id:-1}}const IsLeafTxMember=m=>!m.IsCollection&&m.DefIndex>=0;function MakeTablixMember(m,ctx){const header=m.Header?m.Header(ctx.MakeContextWithData(m.Data,ctx.ScopeId)):null,childScopeId=header?header.Id:null,childCtx=Object.assign(Object.assign({},MakeExecutionContext(ctx,ctx.Data)),{ScopeId:childScopeId});return DataTree.Makers.TablixMember(header,m.IsCollection,(m=>IsLeafTxMember(m)?(m._id<0&&(m._id=m.IdFn(m)),m._id):-1)(m),(()=>LazyMap(m.MakeMembers(m.Data),(mb=>MakeTablixMember(mb,childCtx)))))}const MakeMembers=(dpu,dataSet,members,idx)=>IterableToArray(LazyMap(members,(m=>function(dpu,dataSet,def,idx){const isDynamic=!!def.Group,groupFn=MakeFn$1(dataSet,def.Group),filter=MakeGroupFilter(def.Group||null,def.Header||Def.EmptyContent,dataSet),sort=MakeSortContextFn(def.Sort,def.Header||Def.EmptyContent,dataSet),childFns=MakeMembers(dpu,dataSet,def.Members||[],idx),memberDef={DefIndex:idx(def),HeaderFn:MakeScopeFn(dpu,dataSet,def.Header||Def.EmptyContent),IsCollection:!1},collectionDef={DefIndex:-1,HeaderFn:null,IsCollection:!0};return(ctx,idFn)=>isDynamic?CreateTxMember(null,collectionDef,null,(()=>LazyMap(sort(filter(groupFn(ctx))),(member=>CreateTxMember(idFn,memberDef,member.Data,(d=>childFns.map((fn=>fn(ctx.MakeContextWithData(d),idFn))))))))):(def.Sort&&def.Sort.length>0&&(ctx=Apply$1(ctx,sort)),CreateTxMember(idFn,memberDef,ctx.Data,(d=>childFns.map((fn=>fn(ctx,idFn))))))}(dpu,dataSet,m,idx))));const toLowerCaseParameters=dataParameters=>dataParameters.map((p=>Object.assign(Object.assign({},p),{Name:p.Name.toLowerCase()})));function Run(report,makeContext,dataParameters,sortState=null){if(!report)throw new Error("Report is null");const reportCtx=makeContext(report,toLowerCaseParameters(dataParameters)),defs=Process(report,reportCtx.DataSets),agg=function(report,makeContext,rc){if(null===report)throw new Error("Report is null");let scopeId=0;return MakeReportRegionFn({makeContext:makeContext,nextScopeId:()=>++scopeId},null,report)(rc,null)}(defs.Aggregate,makeContext,reportCtx),data=Generate(defs.Result,defs.Aggregate,agg,sortState,reportCtx.ExpressionContext,makeContext);return{AggregateTree:{Definition:defs.Aggregate,Data:agg.Scope},DataTree:{Definition:defs.Result,Data:data.Scope}}}function MakeExecutionContextByRecordSet(dataSets,data,expressionContext,parentQueryContext=null){const exprContext=expressionContext||{Culture:"",Parameters:{}},ec={App:exprContext,ScopeId:null,DataSets:dataSets||MakeRecordSetProvider((()=>null)),Data:data||RecordSet.Empty,ExpressionContext:exprContext,ParentQueryContext:parentQueryContext,MakeContextWithData:(data,scopeId=null)=>Object.assign(Object.assign({},MakeExecutionContext(ec,data)),{ScopeId:scopeId}),MakeContext:(scopeId=null)=>Object.assign(Object.assign({},MakeExecutionContext(ec,ec.Data)),{ScopeId:scopeId})};return ec}function MakeExecutionContext(current,data){const ec={App:current.App,ScopeId:null,DataSets:current.DataSets,Data:data,ExpressionContext:current.ExpressionContext,ParentQueryContext:current.ParentQueryContext,MakeContextWithData:(data,scopeId=null)=>Object.assign(Object.assign({},MakeExecutionContext(ec,data)),{ScopeId:scopeId}),MakeContext:(scopeId=null)=>Object.assign(Object.assign({},MakeExecutionContext(ec,ec.Data)),{ScopeId:scopeId})};return ec}function MakeReportRegionFn(dpu,dataSet,def){const regionFn=MakeSimpleRegionFn(dpu,dataSet,def);return(rc,ctx)=>{let exectx=MakeExecutionContextByRecordSet(rc.DataSets,rc.DataSets.Data,rc.ExpressionContext,ctx);if(null!==rc.DataSets.Data){exectx=Apply$2(exectx,MakeRegionFilter(def.Content.Regions.filter((region=>"dataset"===region.type))[0]))}return regionFn(exectx)}}function MakeSimpleRegionFn(dpu,dataSet,def){const scopeFn=MakeScopeFn(dpu,dataSet,def.Content),filter=MakeRegionFilter(def,dataSet);return exc=>{const data=Apply$2(exc,filter);return{Scope:scopeFn(data),Name:def.Name,Groups:[]}}}function MakeScopeFn(dpu,dataSet,cell,parentDataSet=null){if(!cell||Def.IsEmptyContent(cell))return ctx=>({Id:ctx&&null!==ctx.ScopeId?ctx.ScopeId:dpu.nextScopeId(),"@":[],Regions:[]});const fields=MakeFn(MakeCompileContext(dataSet),cell.Fields.map((f=>compiler(f)))),regions=cell.Regions.map((r=>function(dpu,dataSet,def,parentDataSet){return"list"===def.type?function(dpu,dataSet,def,parentDataSet=null){const scopeFn=MakeScopeFn(dpu,dataSet,def.Content),groupScopeFn=MakeScopeFn(dpu,dataSet,def.GroupContent),listFilter=MakeRegionFilter(def,dataSet,parentDataSet),sortFn=MakeSortFn(dpu,dataSet,def);return exc=>{let data=Apply$2(exc,listFilter);const members=LazyFilter(sortFn(data),(d=>d.Data.Any()));data=MergeContexts(members,data.DataSets,data.ExpressionContext);const scope=scopeFn(data);return DataTree.Makers.List(scope,(()=>{let groups=LazyMap(members,(member=>groupScopeFn(member)));return def.HandleEmptyGroups&&!IterableAny(groups)&&(groups=[groupScopeFn(data)]),groups}),def.Name)}}(dpu,dataSet,def,parentDataSet):"tablix"===def.type?MakeTablix(dpu,dataSet,def,parentDataSet):"subreport"===def.type?function(dpu,dataSet,def){const scopeFn=MakeScopeFn(dpu,dataSet,def.Content),cc=MakeCompileContext(dataSet),parameters=(def.Parameters||[]).map((p=>({Name:p.Name,Eval:compile(p.Value,cc)}))),reportFn=MakeReportRegionFn(dpu,null,def.Report);return exc=>{const args=parameters.map((p=>({Name:p.Name,Value:p.Eval(exc)}))),scope=scopeFn(exc);try{const rc=dpu.makeContext(def.Report,args),report=reportFn(rc,exc);return DataTree.Makers.List(scope,[report.Scope],def.Name)}catch(err){return DataTree.Makers.List(scope,[],def.Name)}}}(dpu,dataSet,def):"dataset"===def.type?function(dpu,def,parentDataSet){const scopeFn=MakeScopeFn(dpu,def,def.Content,parentDataSet);if(Def.IsEmptyContent(def.Content))return()=>DataTree.Makers.List(scopeFn(null),[],def.Name);const filter=MakeRegionFilter(def,def),cc=MakeCompileContext(parentDataSet),parameters=def.Parameters.map((p=>({Name:p.Name,Eval:compile(p.Value,cc)})));return exc=>{const args=parameters.map((p=>({Name:p.Name,Value:p.Eval(exc)}))),dataSet=exc.DataSets.GetDataSet(MakeRecordSetKey(def.Name,args),exc.Data,null==parentDataSet?void 0:parentDataSet.Name),data=Apply$2(MakeExecutionContextByRecordSet(exc.DataSets,dataSet,exc.ExpressionContext,exc),filter),scope=scopeFn(data);return DataTree.Makers.List(scope,[],def.Name)}}(dpu,def,dataSet):MakeSimpleRegionFn(dpu,dataSet,def)}(dpu,dataSet,r,parentDataSet)));return ctx=>{const id=ctx.ScopeId||dpu.nextScopeId();return DataTree.Makers.Scope(fields(ctx),(()=>regions.map((fn=>fn(ctx.MakeContext(id))))),id)}}function MakeSortFn(dpu,dataSet,def){const groupFn=MakeFn$1(dataSet,def.Group,def.HandleEmptyGroups),groupFilter=MakeGroupFilter(def.Group,def.GroupContent,dataSet),sort=MakeSortContextFn(def.Sort,def.GroupContent,dataSet);return exc=>{let data=groupFilter(groupFn(exc));const lists=def.GroupContent.Regions.filter((r=>"list"===r.type));return 1==lists.length&&lists[0].GroupContent.Regions.length>0&&(data=Array.from(LazyMap(data,(d=>MergeContexts(MakeSortFn(dpu,dataSet,lists[0])(d),exc.DataSets,exc.ExpressionContext))))),sort(data)}}function MergeContexts(contexts,dataSets,expressionContext){return MakeExecutionContextByRecordSet(dataSets,new RecordSet(LazyMapMany(contexts,(ctx=>ctx.Data))),expressionContext)}function DumpScope(data){return Object.assign(Object.assign({},data),{Regions:data.Regions.map(DumpDataRegion)})}function DumpDataRegion(data){return data.Groups?function(data){return Object.assign(Object.assign({},data),{Scope:DumpScope(data.Scope),Groups:Array.from(data.Groups).map(DumpScope)})}(data):function(data){return Object.assign(Object.assign({},data),{Scope:DumpScope(data.Scope),Body:Array.from(data.Body).map((r=>({Cells:r.Cells.map(DumpScope)}))),RowMembers:data.RowMembers.map(DumpTablixMember),ColumnMembers:data.ColumnMembers.map(DumpTablixMember)})}(data)}function DumpTablixMember(data){return Object.assign(Object.assign({},data),{Header:DumpScope(data.Header),Members:Array.from(data.Members).map(DumpTablixMember)})}const Create=Tools.Variant.Create,isVariant=Tools.Variant.isVariant;function throwErr(err){throw err}const map$1=transform=>function*(source){let counter=0,next=source.next();for(;!next.done;)yield transform(next.value,counter++),next=source.next()},filter=predicate=>function*(source){for(const item of source)predicate(item)&&(yield item)};function first(source){const firstItem=source.next();return firstItem.done?void 0:firstItem.value}function last(source){let lastItem;for(const item of source)lastItem=item;return lastItem}function any(source){for(const _ of source)return!0;return!1}const zip=selector=>function*(first,second){let index=0;const it1=(first||[])[Symbol.iterator](),it2=(second||[])[Symbol.iterator]();let r1=it1.next(),r2=it2.next();for(;!r1.done&&!r2.done;)yield selector(r1.value,r2.value,index++),r1=it1.next(),r2=it2.next()},zipTuple=zip(((f,t)=>[f,t])),asIndexed=map$1(((item,index)=>({index:index,item:item}))),toArray=Array.from;const iterable={map:map$1,mapMany:transform=>function*(source){for(const item of source)yield*transform(item)},filter:filter,first:first,last:last,any:any,findFirst:predicate=>source=>first(filter(predicate)(source)),findLast:predicate=>source=>last(filter(predicate)(source)),findAny:predicate=>source=>any(filter(predicate)(source)),zip:zip,zipTuple:zipTuple,asIndexed:asIndexed,orderBy:(keySelector,comparer)=>function*(source){for(const item of Array.from(source).sort(((a,b)=>comparer(keySelector(a),keySelector(b)))))yield item},takeWhile:predicate=>function*(source){for(const item of source){if(!predicate(item))return;yield item}},toArray:toArray,groupBy:keyFunction=>function*(source){const groups=new Map;for(const item of source){const key=keyFunction(item);groups.has(key)?groups.get(key).push(item):groups.set(key,[item])}for(const group of groups.entries())yield group},count:function(source){let count=0;for(const _ of source)count++;return count},memoize:function*(iterable){const iterator=iterable[Symbol.iterator](),cache=[];let index=-1;for(;;)if(index++,index<cache.length)yield cache[index];else{const next=iterator.next();if(next.done)return;cache[index]=next.value,yield next.value}},skip:skipCount=>function*(source){let counter=0;for(const item of source)counter++>=skipCount&&(yield item)},join:function*(...iterables){for(const it of iterables)yield*it}},columnRegex=/^([^\\[\\]\\(\\)]+)()()$|^([^\\[\\]\\(\\)]+)\\((\\w+)\\)()$|^([^\\[\\]\\(\\)]+)\\((\\w+)\\[(\\d+)\\]\\)$|^([^\\[\\]\\(\\)]+)()\\[(\\d+)\\]$/;function parseColumns(columnHeaders){let namelessColomnIndex=0;const generateName=colomnIndex=>`Column${colomnIndex}`,isNameTaken=colomnName=>columnHeaders.some((name=>name===colomnName));return columnHeaders.map((col=>{if(null===col){do{namelessColomnIndex++}while(isNameTaken(generateName(namelessColomnIndex)));return{name:generateName(namelessColomnIndex),type:"String",width:0}}const matches=columnRegex.exec(col||"");if(matches){const found=matches.findIndex(((v,i)=>i>0&&void 0!==v));if(found>-1)return{name:matches[found].trim(),type:matches[found+1]||"String",width:parseInt(matches[found+2]||"0")}}throw throwErr({key:"csvdataprovider.header-parse",headerValue:null!=col?col:void 0})}))}function buildHeader(lines,input,settings,connectionStringColumns){let columns;const headerColumns=parseColumns(settings.HasHeaders&&iterable.first(lines)||[]);if(connectionStringColumns.length>0)columns=connectionStringColumns;else if(headerColumns.length>0)columns=headerColumns;else{columns=splitLineDelimited(settings)(readLines(settings)(input).next().value||"").map(((_,i)=>({name:`Column${i+1}`,type:"String",width:0})))}const header={nameIndex:{},types:columns.map((col=>col.type))};return columns.forEach(((col,i)=>{header.nameIndex[col.name]=i})),header}const readLines=settings=>function*(csv){let index=0,lineCount=0;for(;index<csv.length;){let line="";for(;index<csv.length&&!csv.startsWith(settings.RowsSeparator,index);)line+=csv[index],index++;index+=settings.RowsSeparator.length,lineCount++,lineCount<=settings.DataStartLine||0===line.length&&settings.JoinRowsSeparators||(yield line)}},splitLineDelimited=settings=>line=>{const trimmedLine=(line||"").trim(),parts=[];let part="",quote=!1;for(let i=0;i<trimmedLine.length;i++){const c=trimmedLine[i];trimmedLine.startsWith(settings.TextQualifier,i)?(i+=settings.TextQualifier.length-1,trimmedLine.startsWith(settings.TextQualifier,i+1)?i+=settings.TextQualifier.length:quote=!quote,part+=settings.TextQualifier):quote?part+=c:trimmedLine.startsWith(settings.ColumnsSeparator,i)?(i+=settings.ColumnsSeparator.length-1,(part.length>0||!settings.JoinColumnsSeparators)&&parts.push(part),part=""):trimmedLine.startsWith(settings.EscapeCharSymbol,i)?(i+=settings.EscapeCharSymbol.length,part+=trimmedLine[i]):part+=c}return parts.push(part),parts.map((p=>""===p||"DBNull"===p?null:" "===p?"":p.startsWith(settings.TextQualifier)&&p.endsWith(settings.TextQualifier)?p.substr(settings.TextQualifier.length,p.length-2*settings.TextQualifier.length):p))},splitLineFixed=rxFixedColumns=>line=>line.split(rxFixedColumns).map((s=>s.trim())).slice(1,-1);function SafeEval(node,ctx){try{return ctx?node.Eval(ctx):node.EvalConst()}catch(err){return console.warn(err instanceof Error?err.message:`${err}`),Tools.Variant.Null}}function isNotNull(x){return null!=x}function toDictionary(arr,getKey,getValue){return arr.map((it=>[getKey(it),getValue(it)])).reduce(((res,kvPair)=>(res[kvPair[0]]=kvPair[1],res)),{})}createTreeBuilder();const success=value=>({kind:"success",value:value}),failure=error=>({kind:"failure",error:error});function fetchText(uri,options={},webResProvider){return __awaiter(this,void 0,void 0,(function*(){const result=yield webResProvider.getData(Object.assign(Object.assign({method:"get"},options),{uri:uri}));if("failure"===result.kind){const error=result.error;return failure({key:"fetch-failed",uri:uri,responseStatus:error.status,responseText:error.message})}return success(result.value)}))}function fetchTextSync(uri,options={},webResProvider){const result=webResProvider.getDataSync(Object.assign(Object.assign({method:"get"},options),{uri:uri}));if("failure"===result.kind){const error=result.error;return failure({key:"fetch-failed",uri:uri,responseStatus:error.status,responseText:error.message})}return success(result.value)}function toFetchOptions(httpSource){const{kind:kind,endpoint:endpoint,method:method}=httpSource,requestInit=__rest(httpSource,["kind","endpoint","method"]);return Object.assign({method:null==method?void 0:method.type,body:"post"===(null==method?void 0:method.type)?method.body:void 0},requestInit)}const dataFieldPattern=/(.+?)(\\[(.+?)(\\|(.+))?\\])?$/;function toDataFieldDescriptor(value){var _a;const parts=value.match(dataFieldPattern);if(!parts)return{Name:value,LowerCaseName:value.toLowerCase(),Type:null};const name=(parts[1]||"").trim();return{Name:name,LowerCaseName:name.toLowerCase(),Type:mapDataType(parts[3]),Format:null!==(_a=parts[5])&&void 0!==_a?_a:void 0}}function mapDataType(type){let variantType=function(type){switch(type){case"Null":case"Bool":case"Int32":case"Int64":case"UInt64":case"Float":case"Double":case"Decimal":case"TimeSpan":case"Date":case"String":case"Enum":case"Object":return type;default:return null}}(type);if(null===variantType)switch(type){case"Number":variantType="Double"}return variantType}function getParseDateFieldsFn(descriptors,defaultDateFormats){const dateFieldsFormats=toDictionary(descriptors.map(((d,index)=>"Date"===d.Type?{index:index,format:d.Format}:null)).filter(isNotNull),(({index:index})=>index),(({format:format})=>format?[format]:defaultDateFormats));return Object.keys(dateFieldsFormats).length>0?(fieldsDateFormats=dateFieldsFormats,dataFieldsRow=>dataFieldsRow.map(((value,index)=>{const dateFormats=fieldsDateFormats[index];if(!dateFormats)return value;const dateValue=dateTimeFactory_isDateTime(value)?value:dateTimeFactory_createFromString(`${value}`,dateFormats,!0);return null==dateValue?void 0:dateValue.toDate()}))):a=>a;var fieldsDateFormats}const map=fn=>r=>"success"==r.kind?success(fn(r.value)):r,createPipe=r=>({map:f=>createPipe(map(f)(r)),then:f=>createPipe((f=>r=>(r=>"failure"==r.kind?r:r.value)(map(f)(r)))(f)(r)),result:r});function getResultOrThrowAsync(fn){return(...args)=>__awaiter(this,void 0,void 0,(function*(){const result=yield fn(...args);if("failure"===result.kind)throw result.error;return result.value}))}function getEmbeddedCsv(source){return source.data?success(source.data):failure({key:"dataprovider.no-data"})}function getText(source,webResProvider){return __awaiter(this,void 0,void 0,(function*(){return"http"===source.kind?function(source,webResProvider){return __awaiter(this,void 0,void 0,(function*(){return yield fetchText(source.endpoint,toFetchOptions(source),webResProvider)}))}(source,webResProvider):getEmbeddedCsv(source)}))}function getTextSync(source,webResProvider){return"http"===source.kind?function(source,webResProvider){return fetchTextSync(source.endpoint,toFetchOptions(source),webResProvider)}(source,webResProvider):getEmbeddedCsv(source)}const csvDataProvider={openReader:(settings,fields,webResProvider)=>__awaiter(void 0,void 0,void 0,(function*(){return createPipe(yield getText(settings.source,webResProvider)).map(getCsvReader(settings.dataParserOptions,fields.map((f=>f.DataField)))).result})),openReaderSync:(settings,fields,webResProvider)=>createPipe(getTextSync(settings.source,webResProvider)).map(getCsvReader(settings.dataParserOptions,fields.map((f=>f.DataField)))).result},getCsvReader=(settings,dataFields)=>data=>{const dataReader=function(input,settings){const connectionStringLine=splitLineDelimited({ColumnsSeparator:",",TextQualifier:\'"\',EscapeCharSymbol:"\\\\",JoinColumnsSeparators:!1})(settings.Columns),connectionStringColumns=parseColumns(connectionStringLine.some((col=>col))?connectionStringLine:[]),columnWidths=connectionStringColumns.map((c=>c.width)).filter((w=>0!==w)),splitLine=0===columnWidths.length?splitLineDelimited(settings):splitLineFixed(new RegExp("^"+columnWidths.map((w=>`(.{0,${w}})`)).join("")));return pipe(readLines(settings),iterable.map(splitLine),(lines=>({header:buildHeader(lines,input,settings,connectionStringColumns),lines:lines})))(input)}(data,settings);if(0===dataFields.length)for(let[key,value]of Object.entries(dataReader.header.nameIndex))dataFields[value]=key;const descriptors=dataFields.map(toDataFieldDescriptor).map((d=>d.Type?d:Object.assign(Object.assign({},d),{Type:mapDataType(dataReader.header.types[dataReader.header.nameIndex[d.Name]])}))),parseDates=getParseDateFieldsFn(descriptors,settings.defaultDateFormats);return{descriptors:descriptors,records:pipe(iterable.map((dataRow=>descriptors.map((d=>dataRow[dataReader.header.nameIndex[d.Name]])))),iterable.map(parseDates))(dataReader.lines)}};function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function _construct(Parent,args,Class){return(_construct=_isNativeReflectConstruct()?Reflect.construct:function(Parent,args,Class){var a=[null];a.push.apply(a,args);var instance=new(Function.bind.apply(Parent,a));return Class&&_setPrototypeOf(instance,Class.prototype),instance}).apply(null,arguments)}function _wrapNativeSuper(Class){var _cache="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(Class){if(null===Class||(fn=Class,-1===Function.toString.call(fn).indexOf("[native code]")))return Class;var fn;if("function"!=typeof Class)throw new TypeError("Super expression must either be null or a function");if(void 0!==_cache){if(_cache.has(Class))return _cache.get(Class);_cache.set(Class,Wrapper)}function Wrapper(){return _construct(Class,arguments,_getPrototypeOf(this).constructor)}return Wrapper.prototype=Object.create(Class.prototype,{constructor:{value:Wrapper,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(Wrapper,Class)})(Class)}function _possibleConstructorReturn(self,call){return!call||"object"!=typeof call&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn\'t been initialised - super() hasn\'t been called");return self}(self):call}function _toConsumableArray(arr){return function(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||_unsupportedIterableToArray(arr)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var hasOwnProp=Object.prototype.hasOwnProperty;function push(arr,item){return(arr=arr.slice()).push(item),arr}function unshift(item,arr){return(arr=arr.slice()).unshift(item),arr}var NewError=function(_Error){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(NewError,_wrapNativeSuper(Error));var Derived,hasNativeReflectConstruct,_super=(Derived=NewError,hasNativeReflectConstruct=_isNativeReflectConstruct(),function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)});function NewError(value){var _this;return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,NewError),(_this=_super.call(this,\'JSONPath should not be called with "new" (it prevents return of (unwrapped) scalar values)\')).avoidNew=!0,_this.value=value,_this.name="NewError",_this}return NewError}();function JSONPath(opts,expr,obj,callback,otherTypeCallback){if(!(this instanceof JSONPath))try{return new JSONPath(opts,expr,obj,callback,otherTypeCallback)}catch(e){if(!e.avoidNew)throw e;return e.value}"string"==typeof opts&&(otherTypeCallback=callback,callback=obj,obj=expr,expr=opts,opts=null);var optObj=opts&&"object"===_typeof(opts);if(opts=opts||{},this.json=opts.json||obj,this.path=opts.path||expr,this.resultType=opts.resultType||"value",this.flatten=opts.flatten||!1,this.wrap=!hasOwnProp.call(opts,"wrap")||opts.wrap,this.sandbox=opts.sandbox||{},this.preventEval=opts.preventEval||!1,this.parent=opts.parent||null,this.parentProperty=opts.parentProperty||null,this.callback=opts.callback||callback||null,this.otherTypeCallback=opts.otherTypeCallback||otherTypeCallback||function(){throw new TypeError("You must supply an otherTypeCallback callback option with the @other() operator.")},!1!==opts.autostart){var args={path:optObj?opts.path:expr};optObj?"json"in opts&&(args.json=opts.json):args.json=obj;var ret=this.evaluate(args);if(!ret||"object"!==_typeof(ret))throw new NewError(ret);return ret}}JSONPath.prototype.evaluate=function(expr,json,callback,otherTypeCallback){var _this2=this,currParent=this.parent,currParentProperty=this.parentProperty,flatten=this.flatten,wrap=this.wrap;if(this.currResultType=this.resultType,this.currPreventEval=this.preventEval,this.currSandbox=this.sandbox,callback=callback||this.callback,this.currOtherTypeCallback=otherTypeCallback||this.otherTypeCallback,json=json||this.json,(expr=expr||this.path)&&"object"===_typeof(expr)&&!Array.isArray(expr)){if(!expr.path&&""!==expr.path)throw new TypeError(\'You must supply a "path" property when providing an object argument to JSONPath.evaluate().\');if(!hasOwnProp.call(expr,"json"))throw new TypeError(\'You must supply a "json" property when providing an object argument to JSONPath.evaluate().\');json=expr.json,flatten=hasOwnProp.call(expr,"flatten")?expr.flatten:flatten,this.currResultType=hasOwnProp.call(expr,"resultType")?expr.resultType:this.currResultType,this.currSandbox=hasOwnProp.call(expr,"sandbox")?expr.sandbox:this.currSandbox,wrap=hasOwnProp.call(expr,"wrap")?expr.wrap:wrap,this.currPreventEval=hasOwnProp.call(expr,"preventEval")?expr.preventEval:this.currPreventEval,callback=hasOwnProp.call(expr,"callback")?expr.callback:callback,this.currOtherTypeCallback=hasOwnProp.call(expr,"otherTypeCallback")?expr.otherTypeCallback:this.currOtherTypeCallback,currParent=hasOwnProp.call(expr,"parent")?expr.parent:currParent,currParentProperty=hasOwnProp.call(expr,"parentProperty")?expr.parentProperty:currParentProperty,expr=expr.path}if(currParent=currParent||null,currParentProperty=currParentProperty||null,Array.isArray(expr)&&(expr=JSONPath.toPathString(expr)),(expr||""===expr)&&json){var exprList=JSONPath.toPathArray(expr);"$"===exprList[0]&&exprList.length>1&&exprList.shift(),this._hasParentSelector=null;var result=this._trace(exprList,json,["$"],currParent,currParentProperty,callback).filter((function(ea){return ea&&!ea.isParentSelector}));return result.length?wrap||1!==result.length||result[0].hasArrExpr?result.reduce((function(rslt,ea){var valOrPath=_this2._getPreferredOutput(ea);return flatten&&Array.isArray(valOrPath)?rslt=rslt.concat(valOrPath):rslt.push(valOrPath),rslt}),[]):this._getPreferredOutput(result[0]):wrap?[]:void 0}},JSONPath.prototype._getPreferredOutput=function(ea){var resultType=this.currResultType;switch(resultType){case"all":var path=Array.isArray(ea.path)?ea.path:JSONPath.toPathArray(ea.path);return ea.pointer=JSONPath.toPointer(path),ea.path="string"==typeof ea.path?ea.path:JSONPath.toPathString(ea.path),ea;case"value":case"parent":case"parentProperty":return ea[resultType];case"path":return JSONPath.toPathString(ea[resultType]);case"pointer":return JSONPath.toPointer(ea.path);default:throw new TypeError("Unknown result type")}},JSONPath.prototype._handleCallback=function(fullRetObj,callback,type){if(callback){var preferredOutput=this._getPreferredOutput(fullRetObj);fullRetObj.path="string"==typeof fullRetObj.path?fullRetObj.path:JSONPath.toPathString(fullRetObj.path),callback(preferredOutput,type,fullRetObj)}},JSONPath.prototype._trace=function(expr,val,path,parent,parentPropName,callback,hasArrExpr,literalPriority){var retObj,_this3=this;if(!expr.length)return retObj={path:path,value:val,parent:parent,parentProperty:parentPropName,hasArrExpr:hasArrExpr},this._handleCallback(retObj,callback,"value"),retObj;var loc=expr[0],x=expr.slice(1),ret=[];function addRet(elems){Array.isArray(elems)?elems.forEach((function(t){ret.push(t)})):ret.push(elems)}if(("string"!=typeof loc||literalPriority)&&val&&hasOwnProp.call(val,loc))addRet(this._trace(x,val[loc],push(path,loc),val,loc,callback,hasArrExpr));else if("*"===loc)this._walk(loc,x,val,path,parent,parentPropName,callback,(function(m,l,_x,v,p,par,pr,cb){addRet(_this3._trace(unshift(m,_x),v,p,par,pr,cb,!0,!0))}));else if(".."===loc)addRet(this._trace(x,val,path,parent,parentPropName,callback,hasArrExpr)),this._walk(loc,x,val,path,parent,parentPropName,callback,(function(m,l,_x,v,p,par,pr,cb){"object"===_typeof(v[m])&&addRet(_this3._trace(unshift(l,_x),v[m],push(p,m),v,m,cb,!0))}));else{if("^"===loc)return this._hasParentSelector=!0,{path:path.slice(0,-1),expr:x,isParentSelector:!0};if("~"===loc)return retObj={path:push(path,loc),value:parentPropName,parent:parent,parentProperty:null},this._handleCallback(retObj,callback,"property"),retObj;if("$"===loc)addRet(this._trace(x,val,path,null,null,callback,hasArrExpr));else if(/^(\\x2D?[0-9]*):(\\x2D?[0-9]*):?([0-9]*)$/.test(loc))addRet(this._slice(loc,x,val,path,parent,parentPropName,callback));else if(0===loc.indexOf("?(")){if(this.currPreventEval)throw new Error("Eval [?(expr)] prevented in JSONPath expression.");this._walk(loc,x,val,path,parent,parentPropName,callback,(function(m,l,_x,v,p,par,pr,cb){_this3._eval(l.replace(/^\\?\\(((?:[\\0-\\t\\x0B\\f\\x0E-\\u2027\\u202A-\\uD7FF\\uE000-\\uFFFF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF])*?)\\)$/,"$1"),v[m],m,p,par,pr)&&addRet(_this3._trace(unshift(m,_x),v,p,par,pr,cb,!0))}))}else if("("===loc[0]){if(this.currPreventEval)throw new Error("Eval [(expr)] prevented in JSONPath expression.");addRet(this._trace(unshift(this._eval(loc,val,path[path.length-1],path.slice(0,-1),parent,parentPropName),x),val,path,parent,parentPropName,callback,hasArrExpr))}else if("@"===loc[0]){var addType=!1,valueType=loc.slice(1,-2);switch(valueType){case"scalar":val&&["object","function"].includes(_typeof(val))||(addType=!0);break;case"boolean":case"string":case"undefined":case"function":_typeof(val)===valueType&&(addType=!0);break;case"integer":!Number.isFinite(val)||val%1||(addType=!0);break;case"number":Number.isFinite(val)&&(addType=!0);break;case"nonFinite":"number"!=typeof val||Number.isFinite(val)||(addType=!0);break;case"object":val&&_typeof(val)===valueType&&(addType=!0);break;case"array":Array.isArray(val)&&(addType=!0);break;case"other":addType=this.currOtherTypeCallback(val,path,parent,parentPropName);break;case"null":null===val&&(addType=!0);break;default:throw new TypeError("Unknown value type "+valueType)}if(addType)return retObj={path:path,value:val,parent:parent,parentProperty:parentPropName},this._handleCallback(retObj,callback,"value"),retObj}else if("`"===loc[0]&&val&&hasOwnProp.call(val,loc.slice(1))){var locProp=loc.slice(1);addRet(this._trace(x,val[locProp],push(path,locProp),val,locProp,callback,hasArrExpr,!0))}else if(loc.includes(",")){var _step,_iterator=function(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function(){};return{s:F,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(e){throw e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function(){it=it.call(o)},n:function(){var step=it.next();return normalCompletion=step.done,step},e:function(e){didErr=!0,err=e},f:function(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}(loc.split(","));try{for(_iterator.s();!(_step=_iterator.n()).done;){var part=_step.value;addRet(this._trace(unshift(part,x),val,path,parent,parentPropName,callback,!0))}}catch(err){_iterator.e(err)}finally{_iterator.f()}}else!literalPriority&&val&&hasOwnProp.call(val,loc)&&addRet(this._trace(x,val[loc],push(path,loc),val,loc,callback,hasArrExpr,!0))}if(this._hasParentSelector)for(var t=0;t<ret.length;t++){var rett=ret[t];if(rett&&rett.isParentSelector){var tmp=this._trace(rett.expr,val,rett.path,parent,parentPropName,callback,hasArrExpr);if(Array.isArray(tmp)){ret[t]=tmp[0];for(var tl=tmp.length,tt=1;tt<tl;tt++)t++,ret.splice(t,0,tmp[tt])}else ret[t]=tmp}}return ret},JSONPath.prototype._walk=function(loc,expr,val,path,parent,parentPropName,callback,f){if(Array.isArray(val))for(var n=val.length,i=0;i<n;i++)f(i,loc,expr,val,path,parent,parentPropName,callback);else val&&"object"===_typeof(val)&&Object.keys(val).forEach((function(m){f(m,loc,expr,val,path,parent,parentPropName,callback)}))},JSONPath.prototype._slice=function(loc,expr,val,path,parent,parentPropName,callback){if(Array.isArray(val)){var len=val.length,parts=loc.split(":"),step=parts[2]&&Number.parseInt(parts[2])||1,start=parts[0]&&Number.parseInt(parts[0])||0,end=parts[1]&&Number.parseInt(parts[1])||len;start=start<0?Math.max(0,start+len):Math.min(len,start),end=end<0?Math.max(0,end+len):Math.min(len,end);for(var ret=[],i=start;i<end;i+=step){this._trace(unshift(i,expr),val,path,parent,parentPropName,callback,!0).forEach((function(t){ret.push(t)}))}return ret}},JSONPath.prototype._eval=function(code,_v,_vname,path,parent,parentPropName){code.includes("@parentProperty")&&(this.currSandbox._$_parentProperty=parentPropName,code=code.replace(/@parentProperty/g,"_$_parentProperty")),code.includes("@parent")&&(this.currSandbox._$_parent=parent,code=code.replace(/@parent/g,"_$_parent")),code.includes("@property")&&(this.currSandbox._$_property=_vname,code=code.replace(/@property/g,"_$_property")),code.includes("@path")&&(this.currSandbox._$_path=JSONPath.toPathString(path.concat([_vname])),code=code.replace(/@path/g,"_$_path")),code.includes("@root")&&(this.currSandbox._$_root=this.json,code=code.replace(/@root/g,"_$_root")),/@([\\t-\\r \\)\\.\\[\\xA0\\u1680\\u2000-\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000\\uFEFF])/.test(code)&&(this.currSandbox._$_v=_v,code=code.replace(/@([\\t-\\r \\)\\.\\[\\xA0\\u1680\\u2000-\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000\\uFEFF])/g,"_$_v$1"));try{return this.vm.runInNewContext(code,this.currSandbox)}catch(e){throw console.log(e),new Error("jsonPath: "+e.message+": "+code)}},JSONPath.cache={},JSONPath.toPathString=function(pathArr){for(var x=pathArr,n=x.length,p="$",i=1;i<n;i++)/^(~|\\^|@(?:[\\0-\\t\\x0B\\f\\x0E-\\u2027\\u202A-\\uD7FF\\uE000-\\uFFFF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF])*?\\(\\))$/.test(x[i])||(p+=/^[\\*0-9]+$/.test(x[i])?"["+x[i]+"]":"[\'"+x[i]+"\']");return p},JSONPath.toPointer=function(pointer){for(var x=pointer,n=x.length,p="",i=1;i<n;i++)/^(~|\\^|@(?:[\\0-\\t\\x0B\\f\\x0E-\\u2027\\u202A-\\uD7FF\\uE000-\\uFFFF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF])*?\\(\\))$/.test(x[i])||(p+="/"+x[i].toString().replace(/~/g,"~0").replace(/\\//g,"~1"));return p},JSONPath.toPathArray=function(expr){var cache=JSONPath.cache;if(cache[expr])return cache[expr].concat();var subx=[],exprList=expr.replace(/@(?:null|boolean|number|string|integer|undefined|nonFinite|scalar|array|object|function|other)\\(\\)/g,";$&;").replace(/[\'\\[](\\??\\((?:[\\0-\\t\\x0B\\f\\x0E-\\u2027\\u202A-\\uD7FF\\uE000-\\uFFFF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF])*?\\))[\'\\]]/g,(function($0,$1){return"[#"+(subx.push($1)-1)+"]"})).replace(/\\[["\']((?:(?![\'\\]])[\\s\\S])*)["\']\\]/g,(function($0,prop){return"[\'"+prop.replace(/\\./g,"%@%").replace(/~/g,"%%@@%%")+"\']"})).replace(/~/g,";~;").replace(/["\']?\\.["\']?(?!(?:(?!\\[)[\\s\\S])*\\])|\\[["\']?/g,";").replace(/%@%/g,".").replace(/%%@@%%/g,"~").replace(/(?:;)?(\\^+)(?:;)?/g,(function($0,ups){return";"+ups.split("").join(";")+";"})).replace(/;;;|;;/g,";..;").replace(/;$|\'?\\]|\'$/g,"").split(";").map((function(exp){var match=exp.match(/#([0-9]+)/);return match&&match[1]?subx[match[1]]:exp}));return cache[expr]=exprList,cache[expr].concat()};function buildDataFieldsMap(obj){const dfMap={};return isDataObject(obj)&&Object.keys(obj).forEach((key=>{dfMap[key.toLowerCase()]={originalKey:key,props:buildDataFieldsMap(obj[key])}})),dfMap}function isDataObject(value){return"object"==typeof value&&null!==value&&!Array.isArray(value)}function makeJsonReader(dataFields,optionsDateFormats){return(data,query)=>{const dataValues=query?JSONPath({json:data,path:query.replace(/^\\$\\.\\[/,"$[")}):data;let dataIterator=function(values){return null==values||void 0===values[Symbol.iterator]?[][Symbol.iterator]():values[Symbol.iterator]()}(dataValues);const first=iterable.first(dataIterator),dataFieldsDictionary=Array.isArray(dataValues)?buildDataFieldsMap(first):{};0===dataFields.length&&(dataFields=isDataObject(first)?Object.keys(first):["Field1"]),dataIterator=iterable.join(void 0!==first?[first]:[],dataIterator);const descriptors=dataFields.map(toDataFieldDescriptor),defaultDateFormats=[{ISO_8601:!0},...optionsDateFormats],parseDates=getParseDateFieldsFn(descriptors,defaultDateFormats),recordsPipe=pipe(iterable.map((dataRow=>1!==dataFields.length||isDataObject(dataRow)?descriptors.map((d=>isDataObject(dataRow)?function(obj,path="",dataFieldsMapRef){if(null==obj)return obj;if(dataFieldsMapRef[path]&&void 0!==obj[dataFieldsMapRef[path].originalKey])return obj[dataFieldsMapRef[path].originalKey];const originalKey=Object.keys(obj).find((key=>key.toLowerCase()===path));if(originalKey)return dataFieldsMapRef[path]={originalKey:originalKey,props:buildDataFieldsMap(obj[originalKey])},obj[originalKey];const pathParts=path.split("."),lastPartIndex=pathParts.length-1;return function find(root,firstPartIndex,dfMapRef){for(let index=lastPartIndex;index>=firstPartIndex;index--){const key=(start=firstPartIndex,end=index,pathParts.slice(start,end+1).join("."));if(void 0===dfMapRef[key]){const originalKey=Object.keys(root).find((k=>k.toLowerCase()===key));if(!originalKey)continue;dfMapRef[key]={originalKey:originalKey,props:buildDataFieldsMap(root[originalKey])}}const value=root[dfMapRef[key].originalKey];if("object"!=typeof value||null===value||Array.isArray(value)){if(void 0!==value&&index===lastPartIndex)return value}else{const result=find(value,index+1,dfMapRef[key].props);if(void 0!==result)return result}}var start,end}(obj,0,dataFieldsMapRef)}(dataRow,d.LowerCaseName,dataFieldsDictionary):null)):[dataRow])),iterable.map(parseDates));return{descriptors:descriptors,records:recordsPipe(dataIterator)}}}function getEmbeddedJson(source){if(source.data.startsWith("@@")){const varName=source.data.substring(2),data=window[varName];return null==data?failure({key:"jsondataprovider.no-global-data",globalPath:`window[\'${varName}\']`,globalValue:`${data}`}):success(data)}return source.data?parseJSON(source.data):failure({key:"dataprovider.no-data"})}function getJson(source,webResProvider){return __awaiter(this,void 0,void 0,(function*(){return"http"===source.kind?function(source,webResProvider){return __awaiter(this,void 0,void 0,(function*(){const fetched=yield fetchText(source.endpoint,toFetchOptions(source),webResProvider);return createPipe(fetched).then((d=>parseJSON(d))).result}))}(source,webResProvider):getEmbeddedJson(source)}))}function getJsonSync(source,webResProvider){return"http"===source.kind?function(source,webResProvider){const fetched=fetchTextSync(source.endpoint,toFetchOptions(source),webResProvider);return createPipe(fetched).then((d=>parseJSON(d))).result}(source,webResProvider):getEmbeddedJson(source)}JSONPath.prototype.vm={runInNewContext:function(expr,context){var keys=Object.keys(context),funcs=[];!function(source,target,conditionCb){for(var il=source.length,i=0;i<il;i++)conditionCb(source[i])&&target.push(source.splice(i--,1)[0])}(keys,funcs,(function(key){return"function"==typeof context[key]}));var values=keys.map((function(vr,i){return context[vr]})),funcString=funcs.reduce((function(s,func){var fString=context[func].toString();return/function/.test(fString)||(fString="function "+fString),"var "+func+"="+fString+";"+s}),"");/(["\'])use strict\\1/.test(expr=funcString+expr)||keys.includes("arguments")||(expr="var arguments = undefined;"+expr);var lastStatementEnd=(expr=expr.replace(/;[\\t-\\r \\xA0\\u1680\\u2000-\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000\\uFEFF]*$/,"")).lastIndexOf(";"),code=lastStatementEnd>-1?expr.slice(0,lastStatementEnd+1)+" return "+expr.slice(lastStatementEnd+1):" return "+expr;return _construct(Function,_toConsumableArray(keys).concat([code])).apply(void 0,_toConsumableArray(values))}};const createReader=(options,fields)=>data=>makeJsonReader(fields.map((f=>f.DataField)),options.defaultDateFormats)(data,options.jpath);function parseJSON(jsonString){try{return success(JSON.parse(jsonString))}catch(e){return throwErr({key:"json-parse",jsonString:jsonString,message:e.message})}}const webResourceProvider={getData(requestInfo){return __awaiter(this,void 0,void 0,(function*(){const{uri:uri}=requestInfo,options=__rest(requestInfo,["uri"]);let response,responseText;try{response=yield fetch(uri,options),responseText=yield response.text()}catch(err){return failure({message:err instanceof Error?err.message:`${err}`})}return response.ok?success(responseText):failure({status:response.status,message:responseText})}))},getDataSync(requestInfo){const{uri:uri}=requestInfo,options=__rest(requestInfo,["uri"]),request=new XMLHttpRequest;request.withCredentials="include"===options.credentials;try{request.open(options.method,uri,!1);const headers=options.headers||{};for(const headerKey of Object.keys(headers))request.setRequestHeader(headerKey,headers[headerKey]);request.send("post"===options.method&&options.body?options.body:null)}catch(err){return failure({message:err instanceof Error?err.message:`${err}`})}return 200===request.status?success(request.responseText):failure({status:request.status,message:request.responseText})}},dataReaders={json:{openReader:(settings,fields,webResProvider)=>__awaiter(void 0,void 0,void 0,(function*(){return createPipe(yield getJson(settings.source,webResProvider)).map(createReader(settings.dataParserOptions,fields)).result})),openReaderSync:(settings,fields,webResProvider)=>createPipe(getJsonSync(settings.source,webResProvider)).map(createReader(settings.dataParserOptions,fields)).result},csv:csvDataProvider};function getDataProvider(connection,webResProvider=webResourceProvider){const parserOptions=connection.dataParserOptions;if("json"===parserOptions.dataFormat){const dataReader=dataReaders[parserOptions.dataFormat],settings=Object.assign(Object.assign({},connection),{dataParserOptions:parserOptions.options});return{openReader:fields=>dataReader.openReader(settings,fields,webResProvider),openReaderSync:fields=>dataReader.openReaderSync(settings,fields,webResProvider)}}{const dataReader=dataReaders[parserOptions.dataFormat],settings=Object.assign(Object.assign({},connection),{dataParserOptions:parserOptions.options});return{openReader:fields=>dataReader.openReader(settings,fields,webResProvider),openReaderSync:fields=>dataReader.openReaderSync(settings,fields,webResProvider)}}}function MakeDataReaderFactory(dataSet){const dataFieldsDs=Object.assign(Object.assign({},dataSet),{Fields:dataSet.Fields.filter((f=>f.DataField))}),computedFields=dataSet.Fields.filter((f=>!f.DataField&&f.Value)),fields=dataSet.Fields.map((f=>f.Name)),fieldsIndex={};for(let i=0;i<fields.length;i++)fieldsIndex[fields[i]]=i;const dataFields=dataFieldsDs.Fields.map((f=>f.Name)),resolveComputed=function(computedFields,dataFields){const compiledFields=function(fields,dataFields){const sorted=[],fieldNames=dataFields.map((f=>f.toLowerCase()));let outstanding=fields,canResolve=[];do{canResolve=outstanding.filter((f=>canResolveComputedField(f.Value,fieldNames))),sorted.push(...canResolve),fieldNames.push(...canResolve.map((f=>f.Name.toLowerCase()))),outstanding=outstanding.filter((f=>canResolve.indexOf(f)<0))}while(canResolve.length);return sorted.push(...outstanding.map((f=>Object.assign(Object.assign({},f),{Value:"=Nothing"})))),sorted}(computedFields,dataFields).map((field=>[field.Name,treeBuilder(field.Value)]));return(dataFields,evalCtx)=>{if(!compiledFields.length)return[];const fields={},dataCtx=Object.assign(Object.assign({},evalCtx),{Data:Object.assign(Object.assign({},evalCtx.Data),{fields:fields})});for(let i=0;i<dataFields.length;i++){const[fName,fValue]=dataFields[i];fields[fName]={Name:fName,Value:fValue}}const computedNameValues=[];for(const[name,exprTree]of compiledFields){const computed=SafeEval(exprTree,dataCtx).Value;computedNameValues.push([name,computed]),fields[name]={Name:name,Value:computed}}return computedNameValues}}(computedFields,dataFields);return evalCtx=>{const recordsPipe=pipe(iterable.map((dataFieldsRow=>{const dataRow=[];for(let i=0;i<dataFields.length;i++)dataRow[fieldsIndex[dataFields[i]]]=dataFieldsRow[i];return resolveComputed(dataFields.map((df=>[df,dataRow[fieldsIndex[df]]])),evalCtx).forEach((([name,value])=>{dataRow[fieldsIndex[name]]=value})),dataRow})),iterable.asIndexed);return{open:getDataFields=>__awaiter(this,void 0,void 0,(function*(){const dataReader=yield getDataFields(dataFieldsDs);return{types:fields.map((f=>dataFields.indexOf(f)>=0?dataReader.descriptors[dataFields.indexOf(f)].Type:null)),records:recordsPipe(dataReader.records)}})),openSync:getDataFields=>{const dataReader=getDataFields(dataFieldsDs);return{types:fields.map((f=>dataFields.indexOf(f)>=0?dataReader.descriptors[dataFields.indexOf(f)].Type:null)),records:recordsPipe(dataReader.records)}}}}}const treeBuilder=createTreeBuilder();function canResolveComputedField(expr,fieldNames){const exprTree=treeBuilder(expr);return!Tools.containsNode(exprTree,(node=>{if("variable"!==node.Token.type)return!1;const path=node.Token.value.split(/\\.|!/);if("fields"===path[0].toLowerCase()&&path.length>1){const name=path[1].toLowerCase();if(fieldNames.indexOf(name)<0)return!0}return!1}))}function isRecordSet(value){return"function"!=typeof value}function buildNestedDataSet(dataSetName,dataSetFields,dataReader,parent){const openJsonReader=data=>ds=>makeJsonReader(ds.Fields.map((f=>f.DataField)),[])(data);return(parentData,parentName)=>{if(parentName!==parent.datasetName)throw new Error(`Data processing error: invalid dataset hierarchy. "${dataSetName}" must be "${parent.datasetName}" child, but is "${parentName}" child.`);const[first,...parentRecordsRest]=parentData||[];if(!first)return[];const data=first.GetByName(parent.fieldName),firstReader=dataReader.openSync(openJsonReader(data.Value)),{types:types,records:firstRecords}=firstReader;return Memoize(GetRecordset({types:types,records:function*(){yield*firstRecords;for(const parentRecord of parentRecordsRest){const data=parentRecord.GetByName(parent.fieldName);yield*dataReader.openSync(openJsonReader(data.Value)).records}}()},dataSetFields))}}function Memoize(iterable){const iterator=iterable[Symbol.iterator](),cache=[];return{*[Symbol.iterator](){let index=-1;for(;;)if(index++,index<cache.length)yield cache[index];else{const next=iterator.next();if(next.done)return;cache[index]=next.value,yield next.value}}}}function*GetRecordset(dataReader,fields){const fieldNameIndex={};for(let i=0;i<fields.length;i++)fieldNameIndex[fields[i].Name]=i;for(const record of dataReader.records)yield new Record(record.index,fieldNameIndex,record.item.map(((c,i)=>parseVariant(c,dataReader.types[i]))))}function parseVariant(value,type){if(null==value)return Create(value);const lowerCaseValue="object"==typeof value?lowerKeysDeep(value):value;try{return null===type?Create(lowerCaseValue):Create(lowerCaseValue,type,!0)}catch(err){return Create(lowerCaseValue)}}function lowerKeysDeep(obj){if(null==obj||"object"!=typeof obj||obj instanceof Date||dateTimeFactory_isDateTime(obj))return obj;if(Array.isArray(obj))return obj.map(lowerKeysDeep);const result={};return Object.keys(obj||{}).forEach((key=>{result[key.toLowerCase()]=lowerKeysDeep(obj[key])})),result}class ReportDataProvider{constructor(reportName,reports,webResProvider){this.reportName=reportName,this.reports=reports,this.webResProvider=webResProvider;const getMakeReportContextFn=function(webResourceProvider){return function(reports={}){return __awaiter(this,void 0,void 0,(function*(){const reportsDatasets=new Map;for(const name of Object.keys(reports)){const report=reports[name];if(!report)continue;const subDataSets=yield makeDatasets(report);reportsDatasets.set(name,subDataSets)}const reportScopeCache={};return(report,dataParameters)=>{const reportKey=MakeRecordSetKey(report.Name,dataParameters);let reportScope=reportScopeCache[reportKey];if(!reportScope){const data=new Map,dynamicData={},datasets=reportsDatasets.get(report.Name);datasets&&(Object.keys(datasets.static).forEach((key=>{const ds=datasets.static[key];data.set(MakeRecordSetKey(key,[]),isRecordSet(ds)?new RecordSet(ds):(d,parent)=>new RecordSet(ds(d,parent)))})),Object.keys(datasets.dynamic).forEach((key=>{const dynamicDs=datasets.dynamic[key];dynamicData[MakeRecordSetKey(key,[])]=dataParams=>{const ds=dynamicDs(dataParams);return isRecordSet(ds)?new RecordSet(ds):(d,parent)=>new RecordSet(ds(d,parent))}})));const resolveDynamicData=key=>{const dynamicDataFn=dynamicData[key];if(!dynamicDataFn)return null;const dFn=dynamicDataFn(dataParameters);return data.set(key,dFn),dFn};let defaultData=iterable.findFirst((d=>isRecordSet(d)))(data.values())||null;if(!defaultData)for(const dKey of Object.keys(dynamicData)){let dData=null;try{dData=resolveDynamicData(dKey)}catch(_a){continue}if(dData&&isRecordSet(dData)){defaultData=dData;break}}reportScope=MakeRecordSetProvider(((key,parentData,parentName)=>{const dataFn=data.has(key)?data.get(key):resolveDynamicData(key),dataRecords=null==dataFn||isRecordSet(dataFn)?dataFn||null:dataFn(parentData,parentName);return dataRecords?new RecordSet(dataRecords):null}),defaultData),reportScopeCache[reportKey]=reportScope}return{DataSets:reportScope,ExpressionContext:{Culture:"",Parameters:dataParameters.reduce(((p,{Name:Name,Value:Value})=>(p[Name]=Value,p)),{})}}}}))};function makeDatasets(dataSets){return __awaiter(this,void 0,void 0,(function*(){const staticDataSets={},dynamicDataSets={};for(const dataSetInfo of dataSets.static){const dataSet=dataSetInfo.Info,dataReader=MakeDataReaderFactory(dataSet)({Data:{}});if("datasource"===dataSet.Source.kind){const dp=getDataProvider(dataSet.Source.datasource,webResourceProvider),recordSet=Memoize(GetRecordset(yield dataReader.open((ds=>getResultOrThrowAsync(dp.openReader)(ds.Fields))),dataSet.Fields));staticDataSets[dataSetInfo.Name]=recordSet}else staticDataSets[dataSetInfo.Name]=buildNestedDataSet(dataSetInfo.Name,dataSet.Fields,dataReader,dataSet.Source.parent)}for(const dataSetInfo of dataSets.dynamic)dynamicDataSets[dataSetInfo.Name]=dataParams=>{const dataSet=dataSetInfo.GetInfo(dataParams),evalContext={Data:{parameters:toDictionary(dataParams,(p=>p.Name.toLowerCase()),(p=>p))}},dataReader=MakeDataReaderFactory(dataSet)(evalContext);if("datasource"===dataSet.Source.kind){const dp=getDataProvider(dataSet.Source.datasource,webResourceProvider);return Memoize(GetRecordset(dataReader.openSync((ds=>{return(fn=dp.openReaderSync,(...args)=>{const result=fn(...args);if("failure"===result.kind)throw result.error;return result.value})(ds.Fields);var fn})),dataSet.Fields))}return buildNestedDataSet(dataSetInfo.Name,dataSet.Fields,dataReader,dataSet.Source.parent)};return{static:staticDataSets,dynamic:dynamicDataSets}}))}}(webResProvider);this.makeReportContextFn=()=>__awaiter(this,void 0,void 0,(function*(){const reportContextFn=yield getMakeReportContextFn(reports);return(report,parameters)=>reportContextFn(report,parameters)}))}getRecordSet(dataSetName,parameters){return __awaiter(this,void 0,void 0,(function*(){const makeContext=yield this.getReportContextFn();return dataSetName?makeContext(Def.Makers.Report(this.reportName,Def.EmptyContent),parameters).DataSets.GetDataSet(MakeRecordSetKey(dataSetName,[])):makeContext(Def.Makers.Report(this.reportName,Def.EmptyContent),parameters).DataSets.Data}))}getRawRecordSet(dataSetName,parameters){var _a,_b,_c;return __awaiter(this,void 0,void 0,(function*(){const report=this.reports[this.reportName];if(!report)return null;const dataSet=null!==(_b=null===(_a=report.static.find((ds=>ds.Name===dataSetName)))||void 0===_a?void 0:_a.Info)&&void 0!==_b?_b:null===(_c=report.dynamic.find((ds=>ds.Name===dataSetName)))||void 0===_c?void 0:_c.GetInfo(parameters);if(!dataSet)return null;if("datasource"===dataSet.Source.kind){const dp=getDataProvider(dataSet.Source.datasource,this.webResProvider);return yield getResultOrThrowAsync(dp.openReader)(dataSet.Fields.filter((f=>f.DataField)))}return null}))}fetchReportData(query,parameters){return __awaiter(this,void 0,void 0,(function*(){const makeContext=yield this.getReportContextFn(),dataParameters=Object.keys(parameters||{}).map((key=>{const value=parameters[key];return{Name:key,Value:Create(value)}})),result=Run(query,makeContext,dataParameters);return new ReportData(result,makeContext,dataParameters)}))}getReportContextFn(){var _a;return null!==(_a=this.reportContextFn)&&void 0!==_a?_a:this.reportContextFn=this.makeReportContextFn()}}class ReportData{constructor(data,makeContext,dataParameters){this.data=data,this.makeContext=makeContext,this.dataParameters=dataParameters,this.dataTree=data.DataTree.Data}applySort(viewerSortState){return __awaiter(this,void 0,void 0,(function*(){const sortState=function(viewerSortState){const sortState={};for(const scopeIdkey of Object.keys(viewerSortState)){const scopeId=scopeIdkey,scopeSortState=viewerSortState[scopeId],scopeSorts=[];for(const SortExpressionScope of Object.keys(scopeSortState)){const sortItem=scopeSortState[SortExpressionScope];scopeSorts.push({SortExpressionScope:SortExpressionScope,SortExpression:sortItem.Expression,Direction:sortItem.Direction})}sortState[scopeId]=scopeSorts}return sortState}(viewerSortState);return function(aggregateTree,resultDef,interactiveSorts,makeContext=null,dataParameters=[]){return{Definition:resultDef,Data:Generate(resultDef,aggregateTree.Definition,{Name:null,Scope:aggregateTree.Data,Groups:[]},interactiveSorts,null!=makeContext?makeContext(resultDef,toLowerCaseParameters(dataParameters)).ExpressionContext:null,makeContext).Scope}}(this.data.AggregateTree,this.data.DataTree.Definition,sortState,this.makeContext,this.dataParameters).Data}))}}const ctx=self,_snapshots=[];function postResponse(key,instanceId,requestId,getResult){return __awaiter(this,void 0,void 0,(function*(){const result=yield function(fn){return(...args)=>__awaiter(this,void 0,void 0,(function*(){try{return success(yield fn(...args))}catch(err){return failure(err instanceof Error?{key:"generic-error",message:err.message}:err)}}))}(getResult)();ctx.postMessage([`${key}_response`,instanceId,requestId,result])}))}ctx.addEventListener("message",(e=>__awaiter(void 0,void 0,void 0,(function*(){if(!Array.isArray(e.data))return;const[message_kind,instanceId,...data]=e.data;if("string"!=typeof message_kind||!message_kind.endsWith("_request"))return;const request_kind=message_kind.substring(0,message_kind.length-"_request".length);if("fetchReportData"===request_kind){const[requestId,...args]=data,[reportName,reports,...restArgs]=args;postResponse(request_kind,instanceId,requestId,(()=>__awaiter(void 0,void 0,void 0,(function*(){const rdp=new ReportDataProvider(reportName,reports,makeWebResProvider(instanceId)),result=yield rdp.fetchReportData(...restArgs);return{id:_snapshots.push(result)-1,dataTree:DumpScope(result.dataTree)}}))))}else if("getRecordSet"===request_kind){const[requestId,...args]=data,[reportName,reports,...restArgs]=args;postResponse(request_kind,instanceId,requestId,(()=>__awaiter(void 0,void 0,void 0,(function*(){const rdp=new ReportDataProvider(reportName,reports,makeWebResProvider(instanceId)),resultRecordSet=yield rdp.getRecordSet(...restArgs);return resultRecordSet&&Array.from(resultRecordSet).map((rec=>Object.assign(Object.assign({},rec),{data:rec.data.map(variantSerializer_serialize)})))}))))}else if("getRawRecordSet"===request_kind){const[requestId,...args]=data,[reportName,reports,...restArgs]=args;postResponse(request_kind,instanceId,requestId,(()=>__awaiter(void 0,void 0,void 0,(function*(){const rdp=new ReportDataProvider(reportName,reports,makeWebResProvider(instanceId)),resultRecordSet=yield rdp.getRawRecordSet(...restArgs);return resultRecordSet&&Object.assign(Object.assign({},resultRecordSet),{records:Array.from(resultRecordSet.records)})}))))}else if("applySort"===request_kind){const snapshot=_snapshots[instanceId],[requestId,sortState]=data;postResponse(request_kind,instanceId,requestId,(()=>__awaiter(void 0,void 0,void 0,(function*(){return DumpScope(yield snapshot.applySort(sortState))}))))}else if("registerFunctions"===request_kind){const[requestId,serializedFunctions]=data,functions={};Object.entries(JSON.parse(serializedFunctions)).forEach((([functionName,functionBody])=>{functions[functionName]=new Function("return "+functionBody)()})),CustomCodeInternal_registerFunctions(functions),postResponse(request_kind,instanceId,requestId,(()=>__awaiter(void 0,void 0,void 0,(function*(){}))))}}))));let request_counter=0;const makeWebResProvider=instanceId=>({getData(dataInfo){return __awaiter(this,void 0,void 0,(function*(){const requestId=request_counter++;return new Promise(((resolve,reject)=>{const getResponse=e=>{const[message_kind,messageInstanceId,...data]=e.data;if("fetch_response"!==message_kind||messageInstanceId!==instanceId)return;const[responseId,response]=data;responseId===requestId&&(ctx.removeEventListener("message",getResponse),resolve(response))};ctx.addEventListener("message",getResponse),ctx.postMessage(["fetch_request",instanceId,requestId,dataInfo])}))}))},getDataSync(){throw new Error("Internal Error: Sync Fetch in Worker Not Supported.")}});\n'],{type:"text/javascript"}),blobURL=URL.createObjectURL(blob);var callback;return _worker=new Worker(blobURL),registerCustomCodeInWorker(),callback=registerCustomCodeInWorker,onRegisteredCallbacks.add(callback),_worker}let instance_counter=0,request_counter=0;class AsyncReportDataProvider{constructor(reportName,reports,webResProvider){this.reportName=reportName,this.reports=reports,this._id=instance_counter++,this._disposables=[],this.dispose=()=>{this._disposables.forEach((fn=>fn()))};const worker=getWorker();this._disposables.push(function(worker,instanceId,webResProvider){const onFetchMessage=e=>__awaiter(this,void 0,void 0,(function*(){const[message_kind,messageInstanceId,...data]=e.data;if("fetch_request"!==message_kind||messageInstanceId!==instanceId)return;const[requestId,dataInfo]=data,response=yield webResProvider.getData(dataInfo);worker.postMessage(["fetch_response",instanceId,requestId,response])}));return worker.addEventListener("message",onFetchMessage),()=>{worker.removeEventListener("message",onFetchMessage)}}(worker,this._id,webResProvider))}getRecordSet(dataSetName,parameters){return __awaiter(this,void 0,void 0,(function*(){yield isCustomCodeRegistered();const records=yield sendRequest("getRecordSet",this._id,[this.reportName,this.reports,dataSetName,parameters]);return records&&new RecordSet(records.map((({Index:Index,FieldNameIndex:FieldNameIndex,data:data})=>new Record(Index,FieldNameIndex,data.map((v=>Create$2(variantSerializer.deserialize(v))))))))}))}getRawRecordSet(dataSetName,parameters){return __awaiter(this,void 0,void 0,(function*(){return yield isCustomCodeRegistered(),yield sendRequest("getRawRecordSet",this._id,[this.reportName,this.reports,dataSetName,parameters])}))}fetchReportData(query,parameters){return __awaiter(this,void 0,void 0,(function*(){yield isCustomCodeRegistered();const{id:id,dataTree:dataTree}=yield sendRequest("fetchReportData",this._id,[this.reportName,this.reports,query,parameters]);return new AsyncReportData(dataTree,id)}))}}class AsyncReportData{constructor(dataTree,snapshotId){this.dataTree=dataTree,this.snapshotId=snapshotId}applySort(viewerSortState){return __awaiter(this,void 0,void 0,(function*(){return yield sendRequest("applySort",this.snapshotId,[viewerSortState])}))}}function sendRequest(requestKind,instanceId,args){return __awaiter(this,void 0,void 0,(function*(){const requestId=request_counter++,worker=getWorker(),response=new Promise(((resolve,reject)=>{const unsubscribe=[],onError=e=>{unsubscribe.forEach((fn=>fn())),reject(e.error)};unsubscribe.push((()=>worker.removeEventListener("error",onError))),worker.addEventListener("error",onError);const onMessageError=e=>{unsubscribe.forEach((fn=>fn())),reject(e)};unsubscribe.push((()=>worker.removeEventListener("messageerror",onMessageError))),worker.addEventListener("messageerror",onMessageError);const onResponse=e=>{const[message_kind,messageInstanceId,...data]=e.data;if(message_kind!==`${requestKind}_response`||messageInstanceId!==instanceId)return;const[responseId,responseData]=data;responseId===requestId&&(unsubscribe.forEach((fn=>fn())),"success"===responseData.kind?resolve(responseData.value):reject(responseData.error))};unsubscribe.push((()=>worker.removeEventListener("message",onResponse))),worker.addEventListener("message",onResponse)}));return worker.postMessage([`${requestKind}_request`,instanceId,requestId,...args]),yield response}))}class ReportDataProvider{constructor(reportName,reports,webResProvider){this.reportName=reportName,this.reports=reports,this.webResProvider=webResProvider;const getMakeReportContextFn=function(webResourceProvider){return function(reports={}){return __awaiter(this,void 0,void 0,(function*(){const reportsDatasets=new Map;for(const name of Object.keys(reports)){const report=reports[name];if(!report)continue;const subDataSets=yield makeDatasets(report);reportsDatasets.set(name,subDataSets)}const reportScopeCache={};return(report,dataParameters)=>{const reportKey=MakeRecordSetKey(report.Name,dataParameters);let reportScope=reportScopeCache[reportKey];if(!reportScope){const data=new Map,dynamicData={},datasets=reportsDatasets.get(report.Name);datasets&&(Object.keys(datasets.static).forEach((key=>{const ds=datasets.static[key];data.set(MakeRecordSetKey(key,[]),isRecordSet(ds)?new RecordSet(ds):(d,parent)=>new RecordSet(ds(d,parent)))})),Object.keys(datasets.dynamic).forEach((key=>{const dynamicDs=datasets.dynamic[key];dynamicData[MakeRecordSetKey(key,[])]=dataParams=>{const ds=dynamicDs(dataParams);return isRecordSet(ds)?new RecordSet(ds):(d,parent)=>new RecordSet(ds(d,parent))}})));const resolveDynamicData=key=>{const dynamicDataFn=dynamicData[key];if(!dynamicDataFn)return null;const dFn=dynamicDataFn(dataParameters);return data.set(key,dFn),dFn};let defaultData=iterable.findFirst((d=>isRecordSet(d)))(data.values())||null;if(!defaultData)for(const dKey of Object.keys(dynamicData)){let dData=null;try{dData=resolveDynamicData(dKey)}catch(_a){continue}if(dData&&isRecordSet(dData)){defaultData=dData;break}}reportScope=MakeRecordSetProvider(((key,parentData,parentName)=>{const dataFn=data.has(key)?data.get(key):resolveDynamicData(key),dataRecords=null==dataFn||isRecordSet(dataFn)?dataFn||null:dataFn(parentData,parentName);return dataRecords?new RecordSet(dataRecords):null}),defaultData),reportScopeCache[reportKey]=reportScope}return{DataSets:reportScope,ExpressionContext:{Culture:"",Parameters:dataParameters.reduce(((p,{Name:Name,Value:Value})=>(p[Name]=Value,p)),{})}}}}))};function makeDatasets(dataSets){return __awaiter(this,void 0,void 0,(function*(){const staticDataSets={},dynamicDataSets={};for(const dataSetInfo of dataSets.static){const dataSet=dataSetInfo.Info,dataReader=MakeDataReaderFactory(dataSet)({Data:{}});if("datasource"===dataSet.Source.kind){const dp=getDataProvider(dataSet.Source.datasource,webResourceProvider),recordSet=Memoize(GetRecordset(yield dataReader.open((ds=>getResultOrThrowAsync(dp.openReader)(ds.Fields))),dataSet.Fields));staticDataSets[dataSetInfo.Name]=recordSet}else staticDataSets[dataSetInfo.Name]=buildNestedDataSet(dataSetInfo.Name,dataSet.Fields,dataReader,dataSet.Source.parent)}for(const dataSetInfo of dataSets.dynamic)dynamicDataSets[dataSetInfo.Name]=dataParams=>{const dataSet=dataSetInfo.GetInfo(dataParams),evalContext={Data:{parameters:toDictionary(dataParams,(p=>p.Name.toLowerCase()),(p=>p))}},dataReader=MakeDataReaderFactory(dataSet)(evalContext);if("datasource"===dataSet.Source.kind){const dp=getDataProvider(dataSet.Source.datasource,webResourceProvider);return Memoize(GetRecordset(dataReader.openSync((ds=>{return(fn=dp.openReaderSync,(...args)=>{const result=fn(...args);if("failure"===result.kind)throw result.error;return result.value})(ds.Fields);var fn})),dataSet.Fields))}return buildNestedDataSet(dataSetInfo.Name,dataSet.Fields,dataReader,dataSet.Source.parent)};return{static:staticDataSets,dynamic:dynamicDataSets}}))}}(webResProvider);this.makeReportContextFn=()=>__awaiter(this,void 0,void 0,(function*(){const reportContextFn=yield getMakeReportContextFn(reports);return(report,parameters)=>reportContextFn(report,parameters)}))}getRecordSet(dataSetName,parameters){return __awaiter(this,void 0,void 0,(function*(){const makeContext=yield this.getReportContextFn();return dataSetName?makeContext(Def.Makers.Report(this.reportName,Def.EmptyContent),parameters).DataSets.GetDataSet(MakeRecordSetKey(dataSetName,[])):makeContext(Def.Makers.Report(this.reportName,Def.EmptyContent),parameters).DataSets.Data}))}getRawRecordSet(dataSetName,parameters){var _a,_b,_c;return __awaiter(this,void 0,void 0,(function*(){const report=this.reports[this.reportName];if(!report)return null;const dataSet=null!==(_b=null===(_a=report.static.find((ds=>ds.Name===dataSetName)))||void 0===_a?void 0:_a.Info)&&void 0!==_b?_b:null===(_c=report.dynamic.find((ds=>ds.Name===dataSetName)))||void 0===_c?void 0:_c.GetInfo(parameters);if(!dataSet)return null;if("datasource"===dataSet.Source.kind){const dp=getDataProvider(dataSet.Source.datasource,this.webResProvider);return yield getResultOrThrowAsync(dp.openReader)(dataSet.Fields.filter((f=>f.DataField)))}return null}))}fetchReportData(query,parameters){return __awaiter(this,void 0,void 0,(function*(){const makeContext=yield this.getReportContextFn(),dataParameters=Object.keys(parameters||{}).map((key=>{const value=parameters[key];return{Name:key,Value:Create$2(value)}})),result=Run(query,makeContext,dataParameters);return new ReportData(result,makeContext,dataParameters)}))}getReportContextFn(){var _a;return null!==(_a=this.reportContextFn)&&void 0!==_a?_a:this.reportContextFn=this.makeReportContextFn()}}class ReportData{constructor(data,makeContext,dataParameters){this.data=data,this.makeContext=makeContext,this.dataParameters=dataParameters,this.dataTree=data.DataTree.Data}applySort(viewerSortState){return __awaiter(this,void 0,void 0,(function*(){const sortState=function(viewerSortState){const sortState={};for(const scopeIdkey of Object.keys(viewerSortState)){const scopeId=scopeIdkey,scopeSortState=viewerSortState[scopeId],scopeSorts=[];for(const SortExpressionScope of Object.keys(scopeSortState)){const sortItem=scopeSortState[SortExpressionScope];scopeSorts.push({SortExpressionScope:SortExpressionScope,SortExpression:sortItem.Expression,Direction:sortItem.Direction})}sortState[scopeId]=scopeSorts}return sortState}(viewerSortState);return function(aggregateTree,resultDef,interactiveSorts,makeContext=null,dataParameters=[]){return{Definition:resultDef,Data:Generate(resultDef,aggregateTree.Definition,{Name:null,Scope:aggregateTree.Data,Groups:[]},interactiveSorts,null!=makeContext?makeContext(resultDef,toLowerCaseParameters(dataParameters)).ExpressionContext:null,makeContext).Scope}}(this.data.AggregateTree,this.data.DataTree.Definition,sortState,this.makeContext,this.dataParameters).Data}))}}function readDataRecords(dataSource,dataSet,getResourceUri,webResProvider=webResourceProvider){return __awaiter(this,void 0,void 0,(function*(){const report=cjs$1.Model.Report.decode({DataSets:[dataSet],DataSources:[dataSource]});return"error"===report.type?null:yield createReportDataProvider("Report",{Report:report.value},getResourceUri,webResProvider).getRawRecordSet(dataSet.Name,[])}))}function createReportDataProvider(reportName,reports,getResourceUri,webResProvider=webResourceProvider,runInWorker=!0){const reportsInfo=mapDictionary(reports,(r=>r&&function(dataSets,dataSources,getResourceUri){const staticDataSets=[],dynamicDataSets=[],dataSetsWithParent=function(dataSets){function parseParentRef(dataSourceName){const groups=/^\$dataset:(.*)\/(.*)$/.exec(dataSourceName);return 3===(null==groups?void 0:groups.length)?{datasetName:groups[1],fieldName:groups[2].toLowerCase()}:null}const nestedDataSets=dataSets.map((d=>Object.assign({},d)));return nestedDataSets.forEach((dataSet=>{const parent=parseParentRef(dataSet.Query.DataSourceName);if(!parent)return;const parentDataSet=dataSets.find((ds=>isEqualCaseIns(ds.Name,parent.datasetName)));(null==parentDataSet?void 0:parentDataSet.Fields.find((f=>isEqualCaseIns(f.Name,parent.fieldName))))?dataSet.parent=parent:process.env.debug&&console.log(`DataSet field reference '${dataSet.Query.DataSourceName}' can't be resolved.`)})),nestedDataSets}(dataSets);for(const dataSet of dataSetsWithParent||[]){const dataSource=dataSources.find((ds=>isEqualCaseIns(ds.Name,dataSet.Query.DataSourceName)));if(dataSource&&isDataSourceDynamic(dataSource)||isDataSetDynamic(dataSet))dynamicDataSets.push({Name:dataSet.Name,GetInfo:dataParams=>{const evaluateExpr=makeExpressionEvaluator({Data:{parameters:toDictionary(dataParams,(p=>p.Name.toLowerCase()),(p=>p))}}),dataSetResolved=Object.assign(Object.assign({},dataSet),{Query:Object.assign(Object.assign({},dataSet.Query),{CommandText:evaluateExpr(dataSet.Query.CommandText)})});if(dataSet.parent)return{Source:{kind:"parent",parent:dataSet.parent},Fields:dataSet.Fields.map((f=>Object.assign(Object.assign({},f),{Name:f.Name.toLowerCase()})))};if(!dataSource)return throwErr({key:"unknown-datasource",dataSourceName:dataSet.Query.DataSourceName});return makeDataSetInfo(dataSetResolved,Object.assign(Object.assign({},dataSource),{ConnectionProperties:Object.assign(Object.assign({},dataSource.ConnectionProperties),{ConnectString:evaluateExpr(dataSource.ConnectionProperties.ConnectString)})}),getResourceUri)}});else if(dataSet.parent)staticDataSets.push({Name:dataSet.Name,Info:{Source:{kind:"parent",parent:dataSet.parent},Fields:dataSet.Fields.map((f=>Object.assign(Object.assign({},f),{Name:f.Name.toLowerCase()})))}});else{if(!dataSource)return throwErr({key:"unknown-datasource",dataSourceName:dataSet.Query.DataSourceName});staticDataSets.push({Name:dataSet.Name,Info:makeDataSetInfo(dataSet,dataSource,getResourceUri)})}}return{static:staticDataSets,dynamic:dynamicDataSets}}(r.DataSets,r.DataSources,getResourceUri)));if(runInWorker&&"createObjectURL"in URL){if(0===flatten$2([...Object.keys(reportsInfo).map((k=>{var _a;return null===(_a=reportsInfo[k])||void 0===_a?void 0:_a.dynamic})).filter(isNotNull$1)]).length)return new AsyncReportDataProvider(reportName,reportsInfo,webResProvider)}return new ReportDataProvider(reportName,reportsInfo,webResProvider)}function makeDataSetInfo(dataSet,dataSource,getResourceUri){const settingsResult=function(providerName,connectionString,commandText){const providerKey=providerName.toLowerCase();switch(providerKey){case"json":case"jsonembed":case"csv":case"csvembed":case"testing":return dataProviderSettingsParser[providerKey](connectionString,commandText);default:return failure({key:"unknown-dataprovider",providerName:providerName})}}(dataSource.ConnectionProperties.DataProvider,dataSource.ConnectionProperties.ConnectString,dataSet.Query.CommandText);"failure"==settingsResult.kind&&throwErr(settingsResult.error);let settings=settingsResult.value;return"http"===settings.source.kind&&getResourceUri&&(settings=Object.assign(Object.assign({},settings),{source:Object.assign(Object.assign({},settings.source),{endpoint:getResourceUri(settings.source.endpoint)})})),{Source:{kind:"datasource",datasource:settings},Fields:dataSet.Fields.map((f=>Object.assign(Object.assign({},f),{Name:f.Name.toLowerCase()})))}}class PageReport{constructor(options={}){this._parameters={},this._context={},this.i18n=options.i18n||i18next;const{memoizeData:memoizeData,language:language}=options;if(!1===memoizeData)this.webResourceProvider=webResourceProvider;else{const memo=memoizeData;memo&&"object"==typeof memo&&memo.getData&&memo.getDataSync?this.webResourceProvider=memo:this.webResourceProvider=function(){let memo={};return{getData(requestInfo){return __awaiter(this,void 0,void 0,(function*(){const key=makeKey(requestInfo);if(memo[key])return success(memo[key]);const result=yield webResourceProvider.getData(requestInfo);return"success"===result.kind&&(memo[key]=result.value),result}))},getDataSync(requestInfo){const key=makeKey(requestInfo);if(memo[key])return success(memo[key]);const result=webResourceProvider.getDataSync(requestInfo);return"success"===result.kind&&(memo[key]=result.value),result},dropCache(){memo={}}}}()}language&&this.i18n.changeLanguage(language),this._instance=PageReportInternal.loadDefinition({Body:{}},{},this.i18n,this.webResourceProvider)}get viewSettings(){return this._instance.viewSettings}get name(){return this._context.ReportName||this._instance.name}get parameters(){return this._parameters}get reportParameters(){return{applySteps:steps=>this._instance.applyParameters(this._parameters,steps),validate:()=>this._instance.validateParameters(this._parameters),getValuesFor:(knownValues,requiredParameters)=>this._instance.parameters.getValues(wrapWithArray(knownValues),requiredParameters),getValues:()=>Object.entries(this._parameters).reduce(((p,[name,parameter])=>{var _a;return p[name]={values:parameter.values,validValues:parameter.isValidValuesLoaded?{loaded:!0,values:parameter.validValues.map((vv=>({label:vv.label,value:vv.value})))}:{loaded:!1},status:parameter.state===ParameterStatus.ok?{isValid:!0}:{isValid:!1,error:null!==(_a=parameter.errorMessage)&&void 0!==_a?_a:""}},p}),{}),getDescriptors:()=>Object.entries(this._parameters).reduce(((p,[name,parameter])=>(p[name]=parameter.descriptor,p)),{})}}get resourceLocator(){return this._instance.resourceLocator}static get LicenseKey(){return getLicenseKey()}static set LicenseKey(value){setLicenseKey(value)}load(report,options={}){var _a;return __awaiter(this,void 0,void 0,(function*(){const{environment:environment,resourceLocator:resourceLocator,reportParameters:reportParameters}=options;this._context=environment||{};const lic=yield resolveLicense();4!==lic.Type&&0!==lic.Type&&3!==lic.Type||(report=function(reason,language){const tb=createTextBox("rsn"),defaultReport=createFplReport();return Object.assign(Object.assign({},defaultReport),{Name:"LicenseError",FixedPage:Object.assign(Object.assign({},defaultReport.FixedPage),{Pages:[Object.assign(Object.assign({},defaultReport.FixedPage.Pages[0]),{ReportItems:[Object.assign(Object.assign({},tb),{Value:getNagMessage(language,reason),Left:"0in",Top:"0in",Height:"1.19in",Width:"5.2in",Style:Object.assign(Object.assign({},tb.Style),{VerticalAlign:"Middle"})})]})]}),Page:{PageWidth:"5.5in",PageHeight:"1.2in",TopMargin:"0in",BottomMargin:"0in",LeftMargin:"0.2in",RightMargin:"0in"}})}(lic.Type,this.i18n.language)),this._instance="string"==typeof report?yield PageReportInternal.loadUri(report,resourceLocator,this.i18n,this.webResourceProvider):PageReportInternal.loadDefinition(report,resourceLocator,this.i18n,this.webResourceProvider),this._parameters=toDictionary(this._instance.parameters.descriptors,(d=>d.name),(d=>({values:[],descriptor:d,validValues:[],state:ParameterStatus.expectValue,errorMessage:null,isValidValuesLoaded:!1}))),(null==reportParameters?void 0:reportParameters.some((p=>{var _a;return 1===p.Value.length&&p.Value[0]===selectAll&&(null===(_a=this._parameters[p.Name])||void 0===_a?void 0:_a.descriptor.multiValue)})))&&(yield this._instance.resolveParametersValues(this._parameters)),yield this.reportParameters.applySteps(null!==(_a=null==reportParameters?void 0:reportParameters.map((p=>({Type:"Set",Name:p.Name,Value:p.Value}))))&&void 0!==_a?_a:[])}))}validateParameters(){return this._instance.validateParameters(this._parameters)}execData(requiredParams){return __awaiter(this,void 0,void 0,(function*(){const values=mapParametersValues(applySelectAll(this._parameters));return yield this._instance.parameters.getValues(wrapWithArray(values),requiredParams)}))}resolveParametersValues(requiredParams){return __awaiter(this,void 0,void 0,(function*(){return this._instance.resolveParametersValues(this._parameters,requiredParams)}))}run(){return __awaiter(this,void 0,void 0,(function*(){return yield this._instance.createDocument(mapParametersValues(applySelectAll(this._parameters)),this._context)}))}}class PageReportInternal{constructor(definition,resourceLocator,i18n,webResourceProvider){this.definition=definition,this.resourceLocator=resourceLocator,this.i18n=i18n,this.webResourceProvider=webResourceProvider,this.getResourceUri=resourceLocator.getResourceUri;const dataProvider=this.makeReportDataProvider({[this.definition.Name]:this.definition},!(parameters=this.definition.ReportParameters,parameters.some((p=>{var _a,_b,_c,_d;return isCodeExpression(null===(_a=p.DefaultValue.DataSetReference)||void 0===_a?void 0:_a.LabelField)||isCodeExpression(null===(_b=p.DefaultValue.DataSetReference)||void 0===_b?void 0:_b.ValueField)||isCodeExpression(null===(_c=p.ValidValues.DataSetReference)||void 0===_c?void 0:_c.LabelField)||isCodeExpression(null===(_d=p.ValidValues.DataSetReference)||void 0===_d?void 0:_d.ValueField)}))||hasCustomCodeInDatasets(this.definition.DataSets)));var parameters;this.parametersManager=function(reportDef,dataFetcher){const descriptors=mapDescriptors(reportDef.ReportParameters,reportDef.DataSources,reportDef.DataSets);return{descriptors:descriptors,getValues:(values,requiredParams)=>__awaiter(this,void 0,void 0,(function*(){return yield getParametersValues(descriptors,reportDef.DataSets,dataFetcher,values,requiredParams)}))}}(this.definition,dataProvider),this.viewSettings=function(def){var _a,_b,_c,_d,_e;const isFPL=!!def.FixedPage||1===(null===(_a=def.ReportSections)||void 0===_a?void 0:_a.length)&&"FixedPage"===def.ReportSections[0].Type,viewerMode="Dashboard"===(null===(_c=null===(_b=def.CustomProperties)||void 0===_b?void 0:_b.find((cp=>"ViewerType"===cp.Name)))||void 0===_c?void 0:_c.Value)?"Dashboard":"Report",parametersView=null===(_e=null===(_d=def.CustomProperties)||void 0===_d?void 0:_d.find((cp=>"ParametersView"===cp.Name)))||void 0===_e?void 0:_e.Value;return{restrictViewTypes:isFPL?["PrintLayout"]:"Dashboard"===viewerMode?["Pageless"]:["PrintLayout","Galley"],parametersView:parametersView}}(this.definition)}get name(){return this.definition.Name}get parameters(){return this.parametersManager}static loadUri(uri,resourceLocator={},i18n,webResourceProvider){var _a;return __awaiter(this,void 0,void 0,(function*(){const resLocator=resourceLocator.fork||resourceLocator.getResource||resourceLocator.getResourceUri?makeFullResourceLocator(resourceLocator):createDefaultResourceLocator();let reportDef=null;try{reportDef=yield resLocator.getResource(uri)}catch(e){if(e instanceof HttpRequestError&&"invalid_response"===(null===(_a=e.details)||void 0===_a?void 0:_a.type))throw new Error(i18n.t("core:errors.report-invalid",{defaultValue:'Report "{{reportUri}}" is invalid: {{error}}',reportUri:uri,error:e.message,interpolation:{escapeValue:!1}}));{const message=e instanceof Error?e.message:`${e}`;throw new Error(i18n.t("core:errors.report-not-available",{defaultValue:'Report "{{reportUri}}" is not available: {{error}}',reportUri:uri,error:message,interpolation:{escapeValue:!1}}))}}if(null==reportDef)throw new Error(i18n.t("core:errors.report-not-available",{defaultValue:'Report "{{reportUri}}" is not available: {{error}}',reportUri:uri,error:null,interpolation:{escapeValue:!1}}));return this.loadDefinition(reportDef,resLocator.fork(uri),i18n,webResourceProvider)}))}static loadDefinition(reportDefinition,resourceLocator={},i18n,webResourceProvider){const resLocator=resourceLocator.fork||resourceLocator.getResource||resourceLocator.getResourceUri?makeFullResourceLocator(resourceLocator):createDefaultResourceLocator();return new PageReportInternal(decodeReport(reportDefinition),resLocator,i18n,webResourceProvider)}makeReportDataProvider(reports,runInWorker){const dataProvider=withLocalizedErrors(this.i18n)(createReportDataProvider)(this.definition.Name,reports,this.getResourceUri,this.webResourceProvider,runInWorker);return function(i18n,provider){const localizeErrors=withLocalizedErrorsAsync(i18n);return{fetchReportData:localizeErrors(provider.fetchReportData.bind(provider)),getRecordSet:localizeErrors(provider.getRecordSet.bind(provider)),getRawRecordSet:localizeErrors(provider.getRawRecordSet.bind(provider))}}(this.i18n,dataProvider)}validateParameters(parameters){return mapDictionary(validateParameters(parameters),(value=>value.message?Object.assign(Object.assign({},value),{message:this.i18n.t(value.message)}):value))}createDocument(parameters={},ctx={}){return __awaiter(this,void 0,void 0,(function*(){const reportDef=function(definition,parameters){const themeURI=resolveParameters(definition.ThemeUri,parameters);return Object.assign(Object.assign({},definition),{ThemeUri:themeURI.startsWith("=")?"":themeURI,DataSources:definition.DataSources.map((dSource=>Object.assign(Object.assign({},dSource),{ConnectionProperties:Object.assign(Object.assign({},dSource.ConnectionProperties),{ConnectString:resolveParameters(dSource.ConnectionProperties.ConnectString,parameters)})}))),DataSets:definition.DataSets.map((dSet=>Object.assign(Object.assign({},dSet),{Query:Object.assign(Object.assign({},dSet.Query),{CommandText:resolveParameters(dSet.Query.CommandText,parameters)})})))})}(this.definition,parameters);return PageDocument.create(reportDef,ctx,this.resourceLocator,parameters,((subreportStore,runInWorker)=>__awaiter(this,void 0,void 0,(function*(){return this.makeReportDataProvider(Object.assign(Object.assign({},subreportStore),{[`${reportDef.Name}`]:reportDef}),runInWorker)}))),this.i18n)}))}resolveParametersValues(parametersRef,requiredParams){return __awaiter(this,void 0,void 0,(function*(){const values=mapParametersValues(parametersRef);let requiredParameters={};(requiredParams||Object.keys(parametersRef)).forEach((name=>requiredParameters[name]={fields:[]}));const resolved=yield this.parameters.getValues(wrapWithArray(values),requiredParameters);for(const pName of Object.keys(resolved))parametersRef[pName]=Object.assign(Object.assign({},parametersRef[pName]),{values:resolved[pName].values,validValues:resolved[pName].validValues})}))}applyParameters(parametersRef,steps){return __awaiter(this,void 0,void 0,(function*(){for(const paramAction of steps){if(!parametersRef.hasOwnProperty(paramAction.Name))continue;const descriptor=parametersRef[paramAction.Name].descriptor;switch(paramAction.Type){case"Set":{const newValue=paramAction.Value;descriptor.multiValue?parametersRef[paramAction.Name].values=Array.isArray(newValue)?newValue:[]:parametersRef[paramAction.Name].values=[newValue];break}case"Toggle":{const value=paramAction.Value,currentValues=parametersRef[paramAction.Name].values;descriptor.multiValue?parametersRef[paramAction.Name].values=currentValues.includes(value)?currentValues.filter((v=>v!==value)):[...currentValues,value]:parametersRef[paramAction.Name].values=currentValues[0]===value?[]:[value];break}case"Reset":parametersRef[paramAction.Name].values=[]}}yield this.resolveParametersValues(parametersRef)}))}}function mapParametersValues(pp){return mapDictionary(function(d,filter){return Object.keys(d).reduce(((res,pName)=>{const val=d[pName];return filter(val)&&(res[pName]=val),res}),{})}(pp,(val=>val.values&&val.values.length>0)),(val=>val.descriptor.multiValue?val.values:val.values[0]))}function applySelectAll(params){return mapDictionary(params,(val=>{var _a;return val.descriptor.multiValue&&1===(null===(_a=val.values)||void 0===_a?void 0:_a.length)&&val.values[0]===selectAll?Object.assign(Object.assign({},val),{values:val.validValues.map((vv=>vv.value))}):val}))}function wrapWithArray(pp){return mapDictionary(pp,(val=>Array.isArray(val)?val:[val]))}var rdlxparams=Object.freeze({__proto__:null,get ParameterStatus(){return ParameterStatus}});const CultureInfo={registerCulture(identifier,data){addLocale(data,identifier)}};var e=[],t=[];!function(n,r){if(n&&"undefined"!=typeof document){var a,s=!0===r.prepend?"prepend":"append",d=!0===r.singleTag,i="string"==typeof r.container?document.querySelector(r.container):document.getElementsByTagName("head")[0];if(d){var u=e.indexOf(i);-1===u&&(u=e.push(i)-1,t[u]={}),a=t[u]&&t[u][s]?t[u][s]:t[u][s]=c()}else a=c();65279===n.charCodeAt(0)&&(n=n.substring(1)),a.styleSheet?a.styleSheet.cssText+=n:a.appendChild(document.createTextNode(n))}function c(){var e=document.createElement("style");if(e.setAttribute("type","text/css"),r.attributes)for(var t=Object.keys(r.attributes),n=0;n<t.length;n++)e.setAttribute(t[n],r.attributes[t[n]]);var a="prepend"===s?"afterbegin":"beforeend";return i.insertAdjacentElement(a,e),e}}('.arjs-reportPage, .arjs-reportPage * {\r\n\tbox-sizing: border-box;\r\n\t-moz-box-sizing: border-box;\r\n\t-webkit-box-sizing: border-box;\r\n}\r\n\r\n@media screen {\r\n\t.arjs-hide-screen {\r\n\t\tvisibility: hidden;\r\n\t}\r\n}\r\n\r\n@media print {\r\n\t.arjs-hide-paper {\r\n\t\tvisibility: hidden;\r\n\t}\r\n}\r\n\r\n.arjs-reportPage {\r\n\tbackground-color: white;\r\n\tcolor: black;\r\n\tfont-family: Arial;\r\n\tfont-size: 10pt;\r\n\tfont-weight: normal;\r\n\tfont-style: normal;\r\n\ttext-rendering: optimizeSpeed;\r\n\ttext-decoration-skip-ink: none;\r\n}\r\n\r\n.arjs-canvasItem {\r\n\tposition: absolute;\r\n}\r\n.arjs-itemContent {\r\n\tposition: absolute;\r\n}\r\n.arjs-stack_vert {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n}\r\n.arjs-stack_horz {\r\n\tdisplay: flex;\r\n\tflex-direction: row;\r\n}\r\n.arjs-listItem {\r\n\tposition: relative;\r\n}\r\n.arjs-section {\r\n\tposition: relative;\r\n}\r\n.arjs-placeItem {\r\n\tposition: absolute;\r\n\tz-index: inherit;\r\n}\r\n.arjs-tableItem {\r\n\tborder-collapse: collapse;\r\n\ttable-layout: fixed;\r\n}\r\n.arjs-tableCell {\r\n\tpadding: 0;\r\n\tvertical-align: top;\r\n}\r\n@-moz-document url-prefix() {\r\n\t.arjs-tableCell {\r\n\t\t height: 100%;\r\n\t }\r\n}\r\n.arjs-cellContent {\r\n\tposition: relative;\r\n\theight: 100%;\r\n\toverflow: hidden;\r\n}\r\n.arjs-cellContent > div {\r\n\tmin-height: 100%;\r\n\tmin-width: 100%;\r\n}\r\n.arjs-cbControl {\r\n\twidth: 12px;\r\n\theight: 12px;\r\n\tmin-width: 12px;\r\n\tmin-height: 12px;\r\n\tborder-width: 1px;\r\n\tborder-style: solid;\r\n}\r\n\r\n.arjs-cbCommon {\r\n\twidth: 100%;\r\n\theight: 100%;\r\n\toverflow: hidden;\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\tjustify-content: flex-start;\r\n\talign-items: center;\r\n\ttext-align: center;\r\n}\r\n\r\n.arjs-cbTopLeft {\r\n\talign-items: flex-start;\r\n\ttext-align: left;\r\n}\r\n\r\n.arjs-cbTopRight {\r\n\talign-items: flex-end;\r\n\ttext-align: right;\r\n}\r\n\r\n.arjs-cbMiddleLeft {\r\n\tflex-direction: row;\r\n\ttext-align: left;\r\n}\r\n\r\n.arjs-cbMiddleCenter {\r\n\tflex-direction: row;\r\n\tjustify-content: center;\r\n}\r\n\r\n.arjs-cbMiddleRight {\r\n\tflex-direction: row-reverse;\r\n\ttext-align: right;\r\n}\r\n\r\n.arjs-cbBottomLeft {\r\n\tflex-direction: column-reverse;\r\n\talign-items: flex-start;\r\n\ttext-align: left;\r\n}\r\n\r\n.arjs-cbBottomCenter {\r\n\tflex-direction: column-reverse;\r\n}\r\n\r\n.arjs-cbBottomRight {\r\n\tflex-direction: column-reverse;\r\n\talign-items: flex-end;\r\n\ttext-align: right;\r\n}\r\n\r\n.arjs-cbTextCommon {\r\n\twidth: 100%;\r\n}\r\n.arjs-cbPadding {\r\n\tpadding-bottom: 0.75pt;\r\n}\r\n\r\n.arjs-cbTextTopLeft, .arjs-cbTextBottomLeft {\r\n\tpadding-left: 14px;\r\n}\r\n\r\n.arjs-cbTextTopRight, .arjs-cbTextBottomRight {\r\n\tpadding-right: 14px;\r\n}\r\n\r\n.arjs-cbTextMiddleLeft {\r\n\tpadding-left: 2px;\r\n\twidth: calc(100% - 2px);\r\n}\r\n\r\n.arjs-cbTextMiddleCenter{\r\n\tposition: absolute;\r\n}\r\n\r\n.arjs-cbTextMiddleRight {\r\n\tpadding-right: 2px;\r\n\twidth: calc(100% - 2px);\r\n}\r\n\r\n.arjs-textBoxItem {\r\n\tdisplay: flex;\r\n\tposition: absolute;\r\n\toverflow: hidden;\r\n}\r\n\r\n.arjs-textBoxContent {\r\n\twidth: 100%;\r\n\tmax-height: 100%;\r\n\toverflow: hidden;\r\n\ttext-decoration-style: inherit;\r\n\ttext-decoration-line: inherit;\r\n\ttransform-origin: left top;\r\n}\r\n\r\n.arjs-hideOverflow {\r\n\toverflow: hidden;\r\n}\r\n\r\n.arjs-action {\r\n\tcursor: pointer;\r\n\ttext-decoration-style: inherit;\r\n\ttext-decoration-line: inherit;\r\n}\r\n\r\n.arjs-action.arjs-control {\r\n\tbackground-size: contain;\r\n\tbackground-repeat: no-repeat;\r\n\tdisplay: inline-block;\r\n}\r\n\r\n.arjs-action.arjs-control.arjs-toggle-placeholder, /* ARJ-3744. Remove this class after drop IE support */\r\n.arjs-action.arjs-control.arjs-toggle-expanded,\r\n.arjs-action.arjs-control.arjs-toggle-collapsed {\r\n\tmin-width: 15px;\r\n\tmin-height: 15px;\r\n}\r\n\r\n.arjs-action.arjs-control.arjs-sort-placeholder, /* ARJ-3744. Remove this class after drop IE support */\r\n.arjs-action.arjs-control.arjs-sort-variant,\r\n.arjs-action.arjs-control.arjs-sort-ascending,\r\n.arjs-action.arjs-control.arjs-sort-descending {\r\n\tmin-width: 18px;\r\n\tmin-height: 18px;\r\n}\r\n\r\n.arjs-toggle-expanded {\r\n\tbackground-image: url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZD0iTTE5LDEzSDEzVjE5SDExVjEzSDVWMTFIMTFWNUgxM1YxMUgxOVYxM1oiIC8+PC9zdmc+");\r\n}\r\n\r\n.arjs-toggle-collapsed {\r\n\tbackground-image: url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZD0iTTE5LDEzSDVWMTFIMTlWMTNaIiAvPjwvc3ZnPg==");\r\n}\r\n\r\n/* ARJ-3744. Remove this class after drop IE support */\r\n.arjs-icon-placeholder {\r\n\tbackground-image: url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiBoZWlnaHQ9IjI0IiB3aWR0aD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PC9zdmc+DQo=");\r\n}\r\n\r\n.arjs-sort-variant {\r\n\tbackground-image: url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZD0iTTEwLDEzVjExSDE4VjEzSDEwTTEwLDE5VjE3SDE0VjE5SDEwTTEwLDdWNUgyMlY3SDEwTTYsMTdIOC41TDUsMjAuNUwxLjUsMTdINFY3SDEuNUw1LDMuNUw4LjUsN0g2VjE3WiIgLz48L3N2Zz4=");\r\n}\r\n\r\n.arjs-sort-ascending {\r\n\tbackground-image: url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZD0iTTEwLDExVjEzSDE4VjExSDEwTTEwLDVWN0gxNFY1SDEwTTEwLDE3VjE5SDIyVjE3SDEwTTYsN0g4LjVMNSwzLjVMMS41LDdINFYyMEg2VjdaIiAvPjwvc3ZnPg==");\r\n}\r\n\r\n.arjs-sort-descending {\r\n\tbackground-image: url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZD0iTTEwLDEzVjExSDE4VjEzSDEwTTEwLDE5VjE3SDE0VjE5SDEwTTEwLDdWNUgyMlY3SDEwTTYsMTdIOC41TDUsMjAuNUwxLjUsMTdINFY0SDZWMTdaIiAvPjwvc3ZnPg==");\r\n}\r\n\r\n.arjs-tocLevelLabel {\r\n\ttext-decoration-style: inherit;\r\n\ttext-decoration-line: inherit;\r\n    white-space: pre-wrap;\r\n}\r\n\r\n.arjs-flex-wrap {\r\n\tdisplay: flex;\r\n\tflex-wrap: wrap;\r\n\tjustify-content: flex-start;\r\n}\r\n\r\n.arjs-barcode {\r\n\tdisplay: flex;\r\n}\r\n.arjs-barcode > div {\r\n\tflex: 1;\r\n}\r\n\r\n.arjs-flex-textitem {\r\n\tflex: 0 1 auto;\r\n\ttext-decoration-style: inherit;\r\n\ttext-decoration-line: inherit;\r\n\tpointer-events: none;\r\n}\r\n\r\n.arjs-flex-textfiller {\r\n\tflex: 1 1 auto;\r\n\tposition: relative;\r\n\toverflow: hidden;\r\n\ttext-decoration-style: inherit;\r\n\ttext-decoration-line: inherit;\r\n\tpointer-events: none;\r\n}\r\n\r\n.arjs-text-tab {\r\n\tdisplay: inline-block;\r\n\ttext-align: left;\r\n\ttext-decoration-style: inherit;\r\n\ttext-decoration-line: inherit;\r\n\tpointer-events: none;\r\n}\r\n\r\n.arjs-float-r {\r\n\tfloat: right;\r\n\ttext-decoration-style: inherit;\r\n\ttext-decoration-line: inherit;\r\n}\r\n\r\n.arjs-float-r-abs {\r\n\tdisplay: flex;\r\n\tflex-direction: row-reverse;\r\n\tposition: absolute;\r\n\tright: 0;\r\n\ttext-decoration-style: inherit;\r\n\ttext-decoration-line: inherit;\r\n}\r\n\r\n.arjs-char-wrap {\r\n\toverflow-wrap: break-word;\r\n\ttext-decoration-style: inherit;\r\n\ttext-decoration-line: inherit;\r\n}\r\n\r\n.arjs-bordersItem {\r\n\tpointer-events: none;\r\n}\r\n\r\n.arjs-errorMessage {\r\n\tfont-size: 10pt;\r\n\tcolor: Black;\r\n\tpadding: 2pt;\r\n}\r\n\r\n.arjs-inputField {\r\n\tdisplay: table-cell;\r\n\tvertical-align: middle;\r\n\theight: 100%;\r\n}\r\n\r\n.arjs-inputFieldBase {\r\n\tposition: relative;\r\n\tdisplay: table;\r\n\theight: 100%;\r\n\twidth: 100%;\r\n}\r\n\r\n.arjs-fullSize {\r\n\twidth: 100%;\r\n\theight: 100%;\r\n}\r\n\r\n.arjs-textRun {\r\n\toverflow: hidden;\r\n}\r\n\r\n.arjs-textLine {\r\n\twhite-space: nowrap;\r\n\tdisplay: block;\r\n\ttext-indent: initial;\r\n}\r\n\r\n.arjs-textLine:last-child {\r\n\ttext-align-last: auto;\r\n}\r\n\r\n.arjs-textLine:first-child {\r\n\ttext-indent: inherit;\r\n}\r\n\r\n.arjs-richtext-list-item {\r\n\tdisplay: flex;\r\n\talign-items: baseline;\r\n}\r\n\r\n.arjs-richtext-list-item__content {\r\n\tflex-grow: 1;  /* let the list item content take all available space */\r\n}\r\n\r\n.arjs-richtext-list-item__marker {\r\n\tdisplay: flex;\r\n\tjustify-content: flex-end;\r\n\ttext-indent: 0;\r\n}\r\n\r\n.arjs-upright {\r\n\t-webkit-text-combine: horizontal; /* Safari */\r\n\ttext-combine-upright: all;\r\n}\r\n\r\n.arjs-frozen-row {\r\n\tposition: relative;\r\n}\r\n\r\n.arjs-frozen-cell {\r\n\tposition: sticky;\r\n}\r\n\r\n.arjs-cell-outline-borders {\r\n\tborder-color: transparent !important;\r\n}\r\n\r\n.arjs-cell-outline-borders > div > div {\r\n\tposition: absolute;\r\n}\r\n\r\n.arjs-cell-outline-borders > div {\r\n\twidth: 100%;\r\n\theight: 100%;\r\n}\r\n\r\n.arjs-frozen-cell > div > div {\r\n\tleft: 0pt;\r\n\ttop: 0pt;\r\n}\r\n\r\n/* see node_modules/gc-dv/lib/gcdv.css */\r\n.gcdv-tooltip {\r\n    position: absolute;\r\n    z-index: 1000;\r\n    top: 0;\r\n    left: 0;\r\n    pointer-events: none;\r\n    max-width: 400px;\r\n    padding: 6px;\r\n    background-color: #ffffe5;\r\n    border: 1px solid rgba(0, 0, 0, .1);\r\n    border-radius: 6px;\r\n    box-shadow: 0 6px 12px rgba(0, 0, 0, .175);\r\n    box-sizing: border-box\r\n}\r\n',{});const Version="4.2.1";var Rdl=cjs$1.Rdl;export{CultureInfo,CustomCode,FontStore,PageDocument,PageReport,Rdl,VDomRenderer,Version,arjsStyles,getLicenseKey,noValue,rdlxparams as rdlxParams,readDataRecords,registerFont,selectAll,setLicenseKey,withLocalizedErrors,withLocalizedErrorsAsync};
